IssueLabelID,Title,Description.Element:Text,Title_Description.Element:Text,Label.Element:Text,Assignee,CreatedAt,ClosedAt
6129,[Question] Possible integration scenario using Event Hub streaming,"Hello all

I was able to find a couple of topics around Orleans Streaming + Event Hub but I haven't been able to find something around the scenario that I've just tried.

I'd like to integrate a couple of applications and I'd like to take advantage of the rewindable streaming support from Orleans+Event Hub. Direct connection between those products is not doable but the following setup seems to work fine. 

If each application bootstraps their own localhost silo and configure the same Event Hub stream provider they will be able to pass events between each other maintain their own cursor or if I start a new silo and create a new subscriber it will just ingest everything until it catches up. Fortunately this is exactly what I need.

Am I missing something? Is this a valid approach? What are the possible issues I can get into (from the Orleans standpoint/Event Hub standpoint)?



","[Question] Possible integration scenario using Event Hub streaming Hello all

I was able to find a couple of topics around Orleans Streaming + Event Hub but I haven't been able to find something around the scenario that I've just tried.

I'd like to integrate a couple of applications and I'd like to take advantage of the rewindable streaming support from Orleans+Event Hub. Direct connection between those products is not doable but the following setup seems to work fine. 

If each application bootstraps their own localhost silo and configure the same Event Hub stream provider they will be able to pass events between each other maintain their own cursor or if I start a new silo and create a new subscriber it will just ingest everything until it catches up. Fortunately this is exactly what I need.

Am I missing something? Is this a valid approach? What are the possible issues I can get into (from the Orleans standpoint/Event Hub standpoint)?



",question,sergeybykov,,
6128,InconsistentStateException happened when using single silo,"I am using direct client with single silo in same process in asp.net core。
Can this InconsistentStateException  occur in this situation?
net core ：3.0.0
Storage Provider：Azure table Persistence.AzureStorage
orleans：3.0.0","InconsistentStateException happened when using single silo I am using direct client with single silo in same process in asp.net core。
Can this InconsistentStateException  occur in this situation?
net core ：3.0.0
Storage Provider：Azure table Persistence.AzureStorage
orleans：3.0.0",,jason-bragg,,
6126,[WIP] DynamoDB: support extended membership protocol,"Implements the extended membership protocol for DynamoDB.

Fixes #6099 

Still need to go through testing.

I noticed a few things while implementing this:

1.  is getting a bit hard to read with all the low level dynamo db. It could be broken up but it may be better to use a higher level api. That type of refactoring seems outside the scope of this PR though.","[WIP] DynamoDB: support extended membership protocol Implements the extended membership protocol for DynamoDB.

Fixes #6099 

Still need to go through testing.

I noticed a few things while implementing this:

1.  is getting a bit hard to read with all the low level dynamo db. It could be broken up but it may be better to use a higher level api. That type of refactoring seems outside the scope of this PR though.",,ReubenBond,,
6125,Orleans.TestCluster cannot be used at the same time as the unit test. AspNetCore.TestServer is used at the same time.,"Orleans.TestCluster cannot be used at the same time as the unit test. AspNetCore.TestServer is used at the same time.
Is there any other solution?
","Orleans.TestCluster cannot be used at the same time as the unit test. AspNetCore.TestServer is used at the same time. Orleans.TestCluster cannot be used at the same time as the unit test. AspNetCore.TestServer is used at the same time.
Is there any other solution?
",,ReubenBond,,
6124,Fix a typo,,Fix a typo ,documentation,sergeybykov,16/11/2019 3:27,16/11/2019 3:44
6123,Testing GrainServices in Orleans 2.4.2,"Hi there! 

I'm a new bee in Orleans I just joined a team which uses this fantastic tech and now We're in charge of developing some tests **(version 2.4.2)**.

I got to this GrainService and using TestCluster in xUnit I just can't get to the service in the tests. This always returns NULL.

Here are some code from the classes:

Fixture configuring the service in the cluster silos:



I'm stock in this code with no success. What am I doing wrong? What am I missing here? 

Please help!

Thanks beforehands!





","Testing GrainServices in Orleans 2.4.2 Hi there! 

I'm a new bee in Orleans I just joined a team which uses this fantastic tech and now We're in charge of developing some tests **(version 2.4.2)**.

I got to this GrainService and using TestCluster in xUnit I just can't get to the service in the tests. This always returns NULL.

Here are some code from the classes:

Fixture configuring the service in the cluster silos:



I'm stock in this code with no success. What am I doing wrong? What am I missing here? 

Please help!

Thanks beforehands!





",,sergeybykov,,
6121,Remove 1.5 docs,Even though 1.5 docs aren't linked from the menu they still appear in search and cause more confusion than help. I think it's time to delete them for good.,Remove 1.5 docs Even though 1.5 docs aren't linked from the menu they still appear in search and cause more confusion than help. I think it's time to delete them for good.,documentation,sergeybykov,15/11/2019 7:57,15/11/2019 10:05
6120,SMS - PubSubRendezvous not active on silo - orleans 3,"We just recently updated to netcore3 and Orleans 3 and we have some critical issue with SMS it seems to happen mainly with the 
- K8's
- Redis as Storage Provider for SMS
- Silos Count: 9
- Server load 35-60%

Basically we had ended up reverting on prod from using Orleans 3 netcore3 for now as several services are not working correctly.

If you need anything else we be happy to help. Thanks
","SMS - PubSubRendezvous not active on silo - orleans 3 We just recently updated to netcore3 and Orleans 3 and we have some critical issue with SMS it seems to happen mainly with the 
- K8's
- Redis as Storage Provider for SMS
- Silos Count: 9
- Server load 35-60%

Basically we had ended up reverting on prod from using Orleans 3 netcore3 for now as several services are not working correctly.

If you need anything else we be happy to help. Thanks
",,sergeybykov,,
6119,Add a change missed in #6106,,Add a change missed in #6106 ,,ReubenBond,,
6118,Add information about Shared/Main SQL scripts,Fixes #6117.,Add information about Shared/Main SQL scripts Fixes #6117.,documentation,sergeybykov,14/11/2019 5:25,15/11/2019 10:05
6116,Can two grains of the same interface handle one reminder?,"Hi!

Suppose we have two grains implementing one grain interface.  creates a reminder that must be processed in a dummy way.

I hope for your help.","Can two grains of the same interface handle one reminder? Hi!

Suppose we have two grains implementing one grain interface.  creates a reminder that must be processed in a dummy way.

I hope for your help.",question,sergeybykov,,
6115,Transactions & OnActivateAsync,"Hello colleagues

As part of the investigation process for Olreans Transactions I've faced the following issue. One of my grains operates with streams. In order to work properly it requires streams to be resumed as part of ;

Both of them failed with the error displayed above. 

I'm wondering whether this is generally not supported or I'm doing something wrong. Could you please advise?

Thanks.

@sergeybykov @ReubenBond  @jason-bragg ","Transactions & OnActivateAsync Hello colleagues

As part of the investigation process for Olreans Transactions I've faced the following issue. One of my grains operates with streams. In order to work properly it requires streams to be resumed as part of ;

Both of them failed with the error displayed above. 

I'm wondering whether this is generally not supported or I'm doing something wrong. Could you please advise?

Thanks.

@sergeybykov @ReubenBond  @jason-bragg ",,jason-bragg,,
6114,Codegen ignores negative integer type codes for TypeCodeOverride attribute,"The grain interface and class codes could be a negative integer as returned by [Utils.CalculateIdHash](https://github.com/dotnet/orleans/blob/master/src/Orleans.Core/Utils/Utils.cs#L200) But codegen skips such codes and instead is falling back to re-calculation.
https://github.com/dotnet/orleans/blob/bc41bf386095a335b7ccaeda431b5ebf2fd9ac60/src/Orleans.Core/CodeGeneration/GrainInterfaceUtils.cs#L424

Having  is a nice workaround for system evolution scenarios where names/assemblies of the grain interfaces and classes may change and the ability to leave the old type code is crucial. It would be great if this could be patch fixed for 2.4.","Codegen ignores negative integer type codes for TypeCodeOverride attribute The grain interface and class codes could be a negative integer as returned by [Utils.CalculateIdHash](https://github.com/dotnet/orleans/blob/master/src/Orleans.Core/Utils/Utils.cs#L200) But codegen skips such codes and instead is falling back to re-calculation.
https://github.com/dotnet/orleans/blob/bc41bf386095a335b7ccaeda431b5ebf2fd9ac60/src/Orleans.Core/CodeGeneration/GrainInterfaceUtils.cs#L424

Having  is a nice workaround for system evolution scenarios where names/assemblies of the grain interfaces and classes may change and the ability to leave the old type code is crucial. It would be great if this could be patch fixed for 2.4.",,ReubenBond,,
6113,Issues after Orleans 3.0 upgrade running on a Service Fabric Cluster,"I recently upgraded to Orleans 3.0 nuget packages on our application which is deployed on a Service Fabric Cluster. After the upgrade when we run our benchmark tests for performance I am seeing a lot of exceptions being thrown:
It starts from 

types of messages. I am using the Azure Table Storage Clustering for both the client and server.","Issues after Orleans 3.0 upgrade running on a Service Fabric Cluster I recently upgraded to Orleans 3.0 nuget packages on our application which is deployed on a Service Fabric Cluster. After the upgrade when we run our benchmark tests for performance I am seeing a lot of exceptions being thrown:
It starts from 

types of messages. I am using the Azure Table Storage Clustering for both the client and server.",,sergeybykov,,
6108,Enable to the First Orleans application to be working,"Hello

I have followed the instruction from this link in order to create a simple Orleans application (https://dotnet.github.io/orleans/1.5/Tutorials/My-First-Orleans-Application.html)

However I get a error message saying



What part am I missing in order for the application to be working?

Thank you!","Enable to the First Orleans application to be working Hello

I have followed the instruction from this link in order to create a simple Orleans application (https://dotnet.github.io/orleans/1.5/Tutorials/My-First-Orleans-Application.html)

However I get a error message saying



What part am I missing in order for the application to be working?

Thank you!",documentation,sergeybykov,,
6107,Improve persistence doc page,"Fix an error in storage provider name.
Add a second provider for cart store.","Improve persistence doc page Fix an error in storage provider name.
Add a second provider for cart store.",,ReubenBond,,
6102,Fix routing of gateway count changed events to registered servi…,"Update the  services as handlers of the internal event. This fixes #6098.

Additionally when disposed remove the registered handlers in cases where the cluster client is disposed and registered handlers live longer.","Fix routing of gateway count changed events to registered servi… Update the  services as handlers of the internal event. This fixes #6098.

Additionally when disposed remove the registered handlers in cases where the cluster client is disposed and registered handlers live longer.",,ReubenBond,,
6099,DynamoDB clustering: support extended membership protocol,"The current implementation of the DynamoDB clustering provider only supports the initial membership protocol not the later [extension to the protocol](https://dotnet.github.io/orleans/Documentation/implementation/cluster_management.html#extension-to-totally-order-membership-views) to support totally ordered views of cluster membership.

It's important to support this so that the provider will function correctly.

See this PR which adds such support to Consul: https://github.com/dotnet/orleans/pull/6095","DynamoDB clustering: support extended membership protocol The current implementation of the DynamoDB clustering provider only supports the initial membership protocol not the later [extension to the protocol](https://dotnet.github.io/orleans/Documentation/implementation/cluster_management.html#extension-to-totally-order-membership-views) to support totally ordered views of cluster membership.

It's important to support this so that the provider will function correctly.

See this PR which adds such support to Consul: https://github.com/dotnet/orleans/pull/6095",help wanted,ReubenBond,8/11/2019 4:58,
6098,AddGatewayCountChangedHandler does not work," doesn't forward on the event like he does for connection lost - https://github.com/dotnet/orleans/blob/c683fa8f2fddf310c2dfc3c9cf43db4fb80be1ad/src/Orleans.Core/Runtime/OutsideRuntimeClient.cs#L121

This means there doesn't seem to be a simple way to know when a connection is re-established? Something that is necessary for client subscription to be resumed.","AddGatewayCountChangedHandler does not work  doesn't forward on the event like he does for connection lost - https://github.com/dotnet/orleans/blob/c683fa8f2fddf310c2dfc3c9cf43db4fb80be1ad/src/Orleans.Core/Runtime/OutsideRuntimeClient.cs#L121

This means there doesn't seem to be a simple way to know when a connection is re-established? Something that is necessary for client subscription to be resumed.",,ReubenBond,,
6096,Logger names for PubSubRendezvousGrain too fine grained,"I'm investigating a memory issue in our orleans cluster. While investigating a process dump I discovered there is a large amount of memory retained inside a dictionary in Microsoft.Extension.LoggingLoggerFactory. This dictionary keeps a mapping between LoggerName and logger. It seems that foreach stream event the PubSubRendezvousGrain is handling a new logger name and logger is created. 

In the dump the this dictionary contains over 40000 loggers which results in 26 MB of memory retention and I suspect it just keeps growing. For reference we use Serilog as logging provider.

Here some examples of created logger names:





","Logger names for PubSubRendezvousGrain too fine grained I'm investigating a memory issue in our orleans cluster. While investigating a process dump I discovered there is a large amount of memory retained inside a dictionary in Microsoft.Extension.LoggingLoggerFactory. This dictionary keeps a mapping between LoggerName and logger. It seems that foreach stream event the PubSubRendezvousGrain is handling a new logger name and logger is created. 

In the dump the this dictionary contains over 40000 loggers which results in 26 MB of memory retention and I suspect it just keeps growing. For reference we use Serilog as logging provider.

Here some examples of created logger names:





",,jason-bragg,,
6094,"No storage provider named ""xxx"" found loading grain type","orleans 3.0
I used as the  document say injected IPersistentState<TState> into the grain as constructor parameters  silo  has been configured with the name ""profileStore"".
but client throw an exception: No storage provider named ""xxx"" found loading grain type
inheriting from Grain< TState > This is still supported but is considered legacy. injected IPersistentState< TState > is it the recommended way?
Is there anything wrong here?

","No storage provider named ""xxx"" found loading grain type orleans 3.0
I used as the  document say injected IPersistentState<TState> into the grain as constructor parameters  silo  has been configured with the name ""profileStore"".
but client throw an exception: No storage provider named ""xxx"" found loading grain type
inheriting from Grain< TState > This is still supported but is considered legacy. injected IPersistentState< TState > is it the recommended way?
Is there anything wrong here?

",,sergeybykov,,
6093,IClusterClient in Azure App Service connecting to Silo in a VM,"I've got a Orleans silo running on a VM within a VNET with ip address & port 10.1.2.4:30000.
I have an Azure App Service which has been configured with VNET integration to the VM's VNET.
I've currently configured the Network Security Groups & OS Firewalls to allow all connections over the port ranges that the silo has been configured with.

When I attempt to connect a ClusterClient from the .net core web app running in the Azure App Service I get back:

Which indicates to me that the App Service is correctly VNET integrated.

I'm also able to successfully connect to the silo with a ClusterClient from my local machine (which has a VPN connection to the VNET) so there isn't an issue with the silo not accepting connections.

Is the IClusterClient meant to be able to run in an Azure App Service ? Does it maybe attempt to listen on a local socket which is not permitted according to the [Azure App Service restrictions](https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox#networking-restrictionsconsiderations)?

Is there some kind of work around that does not involve having to convert everything to run in the hugely complex Kubernetes/Docker nightmare or setting up IIS on virtual machines.","IClusterClient in Azure App Service connecting to Silo in a VM I've got a Orleans silo running on a VM within a VNET with ip address & port 10.1.2.4:30000.
I have an Azure App Service which has been configured with VNET integration to the VM's VNET.
I've currently configured the Network Security Groups & OS Firewalls to allow all connections over the port ranges that the silo has been configured with.

When I attempt to connect a ClusterClient from the .net core web app running in the Azure App Service I get back:

Which indicates to me that the App Service is correctly VNET integrated.

I'm also able to successfully connect to the silo with a ClusterClient from my local machine (which has a VPN connection to the VNET) so there isn't an issue with the silo not accepting connections.

Is the IClusterClient meant to be able to run in an Azure App Service ? Does it maybe attempt to listen on a local socket which is not permitted according to the [Azure App Service restrictions](https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox#networking-restrictionsconsiderations)?

Is there some kind of work around that does not involve having to convert everything to run in the hugely complex Kubernetes/Docker nightmare or setting up IIS on virtual machines.",,ReubenBond,,
6090,Found problems with cluster via Consul,"Hi 
Just tried using Orleans first time so I have several issues here when using Consul.
I'm using .NET Core 3.1 and starts silos on local machine.

1. After several silos restart Consul contains information about dead silos and Orleans is trying to reuse it every time. Looks like there is needed purging mechanism from key-value storage.
2. After restarting Consul agent (single in my testing environment) cluster become dead - silos do no register themself anymore and can not find others.

For starting Consul I'm using this command


Nothing special here just following your Hello World examples and connected to Consul so if you need my test application I can provide it with ease.","Found problems with cluster via Consul Hi 
Just tried using Orleans first time so I have several issues here when using Consul.
I'm using .NET Core 3.1 and starts silos on local machine.

1. After several silos restart Consul contains information about dead silos and Orleans is trying to reuse it every time. Looks like there is needed purging mechanism from key-value storage.
2. After restarting Consul agent (single in my testing environment) cluster become dead - silos do no register themself anymore and can not find others.

For starting Consul I'm using this command


Nothing special here just following your Hello World examples and connected to Consul so if you need my test application I can provide it with ease.",,ReubenBond,,
6089,SiloStatusChangeNotification being hit multiple times,"**Environment:**

- 4 Windows Servers (1 silo on each server)
- Consul Clustering
- Ado Reminders (MariaDB)

Current working orleans version 2.3.4 (no issues)
Issues reported once updated to orleans 2.4.3

**Reported Issue:**

MariaDb database being hit by large amounts of select reminders query. (643945 selects in 40min starting with an empty reminders table then eventually creating about 60 reminders)



This log is being called via this call stack: 

SiloStatusListenerManager.Participate.ProcessMembershipUpdates.NotifyObservers ->
VirtualBucketsRingProvider.SiloStatusChangeNotification.**AddServer**.NotifyLocalRangeSubscribers - > RangeChangeNotification.OnRangeChange.ReadAndUpdateReminders.ReadTableAndStartTimers

The log 'Starting VirtualBucketsRingProvider on silo' is only hit 4 times within the 40min session.

What is triggering Silo Status Change Notification? 





","SiloStatusChangeNotification being hit multiple times **Environment:**

- 4 Windows Servers (1 silo on each server)
- Consul Clustering
- Ado Reminders (MariaDB)

Current working orleans version 2.3.4 (no issues)
Issues reported once updated to orleans 2.4.3

**Reported Issue:**

MariaDb database being hit by large amounts of select reminders query. (643945 selects in 40min starting with an empty reminders table then eventually creating about 60 reminders)



This log is being called via this call stack: 

SiloStatusListenerManager.Participate.ProcessMembershipUpdates.NotifyObservers ->
VirtualBucketsRingProvider.SiloStatusChangeNotification.**AddServer**.NotifyLocalRangeSubscribers - > RangeChangeNotification.OnRangeChange.ReadAndUpdateReminders.ReadTableAndStartTimers

The log 'Starting VirtualBucketsRingProvider on silo' is only hit 4 times within the 40min session.

What is triggering Silo Status Change Notification? 





",,ReubenBond,,
6088,Lazy load with IPersistentState,There are a lot use cases when lazy load is preffered way to load the grain state. Will be very helpfull to have ability to configure the using of IPersistentState with lazy manner. Maybe to define new interface IDefferPersistentState or ILazyPersistentState,Lazy load with IPersistentState There are a lot use cases when lazy load is preffered way to load the grain state. Will be very helpfull to have ability to configure the using of IPersistentState with lazy manner. Maybe to define new interface IDefferPersistentState or ILazyPersistentState,,jason-bragg,,
6087,Rationale for StorageProvider attribute on grain implementation?,"I'm wondering about the rationale behind grain implementations needing to specify  is called (which I realize is used by Orleans but not part of it). The silo controls every other aspect of storage so to me ""where to store each grain"" seems like a natural fit as well.

I'm curious if I'm overlooking some benefit to this design and whether there might be interest in changing it (perhaps while still supporting the attribute for backwards compatibility).","Rationale for StorageProvider attribute on grain implementation? I'm wondering about the rationale behind grain implementations needing to specify  is called (which I realize is used by Orleans but not part of it). The silo controls every other aspect of storage so to me ""where to store each grain"" seems like a natural fit as well.

I'm curious if I'm overlooking some benefit to this design and whether there might be interest in changing it (perhaps while still supporting the attribute for backwards compatibility).",question,sergeybykov,,
6085,Saving references to Other grains,"Hey

I've trying out Orleans for some simple projects to get my head around.
I'd like to ask if this is an Orleans way to approach things.

I have Player and player can have multiple inventories (which in turn store multiple items).
Right now I have Player Grain and Inventory Grain. Player Grain can reference multiple Inventory grains.

1. Should I store Inventory Grains IDs inside PlayerState ?
2. Can I just store Inventory References inside PlayerState and will they be automatically serialized ?
3. Should I simply put everything into single grain (Player) ?
","Saving references to Other grains Hey

I've trying out Orleans for some simple projects to get my head around.
I'd like to ask if this is an Orleans way to approach things.

I have Player and player can have multiple inventories (which in turn store multiple items).
Right now I have Player Grain and Inventory Grain. Player Grain can reference multiple Inventory grains.

1. Should I store Inventory Grains IDs inside PlayerState ?
2. Can I just store Inventory References inside PlayerState and will they be automatically serialized ?
3. Should I simply put everything into single grain (Player) ?
",question,sergeybykov,,
6084,Null IIncomingGrainCallContext.ImplementationMethod when using ValueTuples,"Orleans version: 2.3.2

When using the following signature for a grain method



The context is fixed and works as expected.","Null IIncomingGrainCallContext.ImplementationMethod when using ValueTuples Orleans version: 2.3.2

When using the following signature for a grain method



The context is fixed and works as expected.",,ReubenBond,,
6077,Clustering audit log,"Hi

I would like to open a discussion:

For me the clustering is sometimes hard to understand and it would be very good to have some kind of an audit log like in kubernetes with high level messages that tell me the status of the cluster such as:

* Member <Hostname> (IP) has joined the cluster.
* Member <Hostname> (IP) is not reachable from <Hostname> (IP) <HostName> (IP) and ...

This could be very valuable because reading the logs can be hard and in case of cluster errors you can have thousand of consecutive errors that you need to filter out.

Just this morning my k8 has restarted my nodes because the health check became unhealthy and do not really understand the reason.

It would be great to have a IAuditLog interface that just logs it to the logger but can also be used to persist it to a database and then consumed by OrleansDashboard or so.

In case you are writing a product for others users like Squidex (https://github.com/squidex/squidex) it is hard to get good default values for the logs. Either it is too much or too less.

Or we need to be more careful with logging categories because class names are not a good source for categories especially when potentially dozens of classes are involved to do a job like clustering.

To be honest I have no idea what something like this means:

     Silo S10.0.0.22:11111:309992883 is rejecting message: Request S10.0.0.22:11111:309992883*stg/13/0000000d@S0000000d->S10.0.2.132:11111:309992903*stg/10/0000000a@S0000000a #1069522: . Reason = Recent (00:00:00.0755821 ago at 2019-10-30 06:20:30.534 GMT) connection failure trying to reach target silo S10.0.2.132:11111:309992903. Going to drop Request msg 1069522 without sending. CONNECTION_RETRY_DELAY = 00:00:01.


","Clustering audit log Hi

I would like to open a discussion:

For me the clustering is sometimes hard to understand and it would be very good to have some kind of an audit log like in kubernetes with high level messages that tell me the status of the cluster such as:

* Member <Hostname> (IP) has joined the cluster.
* Member <Hostname> (IP) is not reachable from <Hostname> (IP) <HostName> (IP) and ...

This could be very valuable because reading the logs can be hard and in case of cluster errors you can have thousand of consecutive errors that you need to filter out.

Just this morning my k8 has restarted my nodes because the health check became unhealthy and do not really understand the reason.

It would be great to have a IAuditLog interface that just logs it to the logger but can also be used to persist it to a database and then consumed by OrleansDashboard or so.

In case you are writing a product for others users like Squidex (https://github.com/squidex/squidex) it is hard to get good default values for the logs. Either it is too much or too less.

Or we need to be more careful with logging categories because class names are not a good source for categories especially when potentially dozens of classes are involved to do a job like clustering.

To be honest I have no idea what something like this means:

     Silo S10.0.0.22:11111:309992883 is rejecting message: Request S10.0.0.22:11111:309992883*stg/13/0000000d@S0000000d->S10.0.2.132:11111:309992903*stg/10/0000000a@S0000000a #1069522: . Reason = Recent (00:00:00.0755821 ago at 2019-10-30 06:20:30.534 GMT) connection failure trying to reach target silo S10.0.2.132:11111:309992903. Going to drop Request msg 1069522 without sending. CONNECTION_RETRY_DELAY = 00:00:01.


",,sergeybykov,,
6076,Upgrade to Orleans 3.0 from 2.* seems to incur performance issues,"An upgrade from 2 to 3.0 seems to make performance worse in two ways:

- The average request time is higher than before
- There are ""odd spikes"" that go from what would normally be 5ms-20ms to 500ms-1000ms. These seem to not be related to external dependencies

This is running on alpine nightly with dotnet core 3.0 running on AKS.

Screenshot of normal operations:

![normal](https://user-images.githubusercontent.com/5766347/67874630-7a960000-fb35-11e9-9d90-ddeaefeab405.png)

This is the kind of peaks we are experiencing now:

![peaks](https://user-images.githubusercontent.com/5766347/67874663-85509500-fb35-11e9-8601-93eb9c29e659.png)

Information about the system: 

- Load is not high (sub 1 transaction a second)
- Load is very even re-using the same grains
- Backend database has been scaled up but we still have issues
","Upgrade to Orleans 3.0 from 2.* seems to incur performance issues An upgrade from 2 to 3.0 seems to make performance worse in two ways:

- The average request time is higher than before
- There are ""odd spikes"" that go from what would normally be 5ms-20ms to 500ms-1000ms. These seem to not be related to external dependencies

This is running on alpine nightly with dotnet core 3.0 running on AKS.

Screenshot of normal operations:

![normal](https://user-images.githubusercontent.com/5766347/67874630-7a960000-fb35-11e9-9d90-ddeaefeab405.png)

This is the kind of peaks we are experiencing now:

![peaks](https://user-images.githubusercontent.com/5766347/67874663-85509500-fb35-11e9-8601-93eb9c29e659.png)

Information about the system: 

- Load is not high (sub 1 transaction a second)
- Load is very even re-using the same grains
- Backend database has been scaled up but we still have issues
",,ReubenBond,,
6075,[doc] Multiple language support,"I want to translate the docs to Chinese How can I start?
I prefer add some language identifier folders (en-us zh-cn and so on) to place the translated docs.
","[doc] Multiple language support I want to translate the docs to Chinese How can I start?
I prefer add some language identifier folders (en-us zh-cn and so on) to place the translated docs.
",documentation,sergeybykov,30/10/2019 10:45,
6073,error NETSDK1085 when creating package using dotnet cli 3.0.100,After updating ,error NETSDK1085 when creating package using dotnet cli 3.0.100 After updating ,,ReubenBond,,
6072,Removed silo status check before cleaing up system targets from…,Original code assumed producers only moved when their silo died.  This is not the case.,Removed silo status check before cleaing up system targets from… Original code assumed producers only moved when their silo died.  This is not the case.,,benjaminpetit,,
6071,Azure table grain storage inconsistent state on not found,Azure table grain storage returns inconsistent state if modifying state that does not exist.,Azure table grain storage inconsistent state on not found Azure table grain storage returns inconsistent state if modifying state that does not exist.,,ReubenBond,,
6070,Switch to System.Text.Json APIs,"The new [System.Text.Json](https://devblogs.microsoft.com/dotnet/try-the-new-system-text-json-apis/) API's provide a slight performance boost over Newtonsoft.Json and I believe the gap will get wider with further releases. This boost is even more prevalant if you serialize directly to and from UTF-8 bytes.

Are there any plans to migrate to this as the new default and possible enable the ability to switch between the two formats like in ASP.NET Core?","Switch to System.Text.Json APIs The new [System.Text.Json](https://devblogs.microsoft.com/dotnet/try-the-new-system-text-json-apis/) API's provide a slight performance boost over Newtonsoft.Json and I believe the gap will get wider with further releases. This boost is even more prevalant if you serialize directly to and from UTF-8 bytes.

Are there any plans to migrate to this as the new default and possible enable the ability to switch between the two formats like in ASP.NET Core?",,sergeybykov,,
6067,Nullable warning in generated code.,"Hi

I get the following warning in the *.g.cs files:



Could you disable it? It is enabled for the whole project.","Nullable warning in generated code. Hi

I get the following warning in the *.g.cs files:



Could you disable it? It is enabled for the whole project.",,ReubenBond,,
6065,Clean up docs for 3.0,,Clean up docs for 3.0 ,,ReubenBond,,
6060,Update README,,Update README ,,sergeybykov,,
6057,Improved activation queue monitoring,#NAME?,"Improved activation queue monitoring - Added load stages to prevent spamming logs under load.
- Added max lifetime and spike high load metrics",,ReubenBond,,
6053,Added consistent logging for all messages dropped due to expiry,,Added consistent logging for all messages dropped due to expiry ,,sergeybykov,,
6052,sending per grain info to storage system when saving,"When I was trying to implement a playfab based storage system for grains and also previously when I wanted to make some settings per grain (not per grain type) in a storage provider to save my data in a different manner the storage system couldn't do that.

Let's say we have a set of player grains.  
Also assume that for saving data for each user in playfab you need the user's ID which the grain has at runtime and it cannot be deduced from grain key how can we send this info to our storage provider when we initialize the grain/when calling WriteStateAsync so the provider can do its job? 

One easy/dirty way of solving it is to have an object argument for WriteStateAsync and ReadStateAsync but probably it can be done better.

@sergeybykov  @ReubenBond  I saw you were looking for feedback for Orleans 3 probably this is late for that but I hope still is useful","sending per grain info to storage system when saving When I was trying to implement a playfab based storage system for grains and also previously when I wanted to make some settings per grain (not per grain type) in a storage provider to save my data in a different manner the storage system couldn't do that.

Let's say we have a set of player grains.  
Also assume that for saving data for each user in playfab you need the user's ID which the grain has at runtime and it cannot be deduced from grain key how can we send this info to our storage provider when we initialize the grain/when calling WriteStateAsync so the provider can do its job? 

One easy/dirty way of solving it is to have an object argument for WriteStateAsync and ReadStateAsync but probably it can be done better.

@sergeybykov  @ReubenBond  I saw you were looking for feedback for Orleans 3 probably this is late for that but I hope still is useful",,jason-bragg,,
6051,Recommendation on Grain ID creation,"We are using Orleans and have a need to map Grains backing storage to a relational table structure that will be ad-hoc queried using SQL. The tables will have auto incremented ID's controlled defined by the table.

My question is how would you recommend creating these grains because GrainFactory.GetGrain<T>(..) requires an ID but we don't know the ID until we have saved the record into the database. ","Recommendation on Grain ID creation We are using Orleans and have a need to map Grains backing storage to a relational table structure that will be ad-hoc queried using SQL. The tables will have auto incremented ID's controlled defined by the table.

My question is how would you recommend creating these grains because GrainFactory.GetGrain<T>(..) requires an ID but we don't know the ID until we have saved the record into the database. ",,sergeybykov,,
6050,Update change log for 3.0.0-rc2,,Update change log for 3.0.0-rc2 ,,ReubenBond,,
6049,Remove SQL scripts from AdoNet NuGet packages,"Based on the discussion in #4867 this PR is a replacement for #6044. It removes SQL scripts from the AdoNet provider packages. The prevailing opinion is that we shouldn't have them pollute the AdoNet packages and that we don't even want a readme.md there.

We can separately decide how to let developers know where to find the scripts.","Remove SQL scripts from AdoNet NuGet packages Based on the discussion in #4867 this PR is a replacement for #6044. It removes SQL scripts from the AdoNet provider packages. The prevailing opinion is that we shouldn't have them pollute the AdoNet packages and that we don't even want a readme.md there.

We can separately decide how to let developers know where to find the scripts.",,ReubenBond,,
6047,Transactions: support larger state sizes in Azure Table Storage,This implementation retains backwards compatibility with existing stored data while adding support for states which are too large to fit into a single Azure Table Storage column (which holds a maximum of 32 * 1024 chars),Transactions: support larger state sizes in Azure Table Storage This implementation retains backwards compatibility with existing stored data while adding support for states which are too large to fit into a single Azure Table Storage column (which holds a maximum of 32 * 1024 chars),,jason-bragg,,
6046,Add separate SiloMessagingOptions.SystemResponseTimeout option,This PR adds an option to set the response timeout for  messages sent from a silo. The default value is 30s but in future that may be changed to a lower value such as 2s.,Add separate SiloMessagingOptions.SystemResponseTimeout option This PR adds an option to set the response timeout for  messages sent from a silo. The default value is 30s but in future that may be changed to a lower value such as 2s.,,sergeybykov,,
6045,Added structured logging,Implemented structured logging (see #5865) for the project OrleansProviders. Doing it project by project makes it a bit more manageable than to do the whole lot in one changeset.,Added structured logging Implemented structured logging (see #5865) for the project OrleansProviders. Doing it project by project makes it a bit more manageable than to do the whole lot in one changeset.,,ReubenBond,,
6041,Add warning message at startup,"Adding warning message at startup if debug level logging is set and recommends setting log level to info for production.

Addresses #5873 ","Add warning message at startup Adding warning message at startup if debug level logging is set and recommends setting log level to info for production.

Addresses #5873 ",,ReubenBond,,
6040,Orleans + ASP.NET co-hosting can cause NullReferenceException in ASP.NET,"This is specific to Orleans 3.0-rc1.

Currently both Orleans & Kestrel register an implementation for  (eg maybe Orleans + SignalR).

cc @davidfowl","Orleans + ASP.NET co-hosting can cause NullReferenceException in ASP.NET This is specific to Orleans 3.0-rc1.

Currently both Orleans & Kestrel register an implementation for  (eg maybe Orleans + SignalR).

cc @davidfowl",,ReubenBond,,
6038, Response did not arrive on time in 00:00:30 for message:System.TimeoutException,"Recently I have upgraded orleans from 1.5 to 2.4.1 and after that I have started seeing the exceptions related to TimeOut. 
Response did not arrive on time in 00:00:30 for message: Request *cli/413a36bd@01e05ea7->S:30000:308414169*grn/8A760B57/afd82dad #15058: . Target History is: <S:30000:308414169:*grn/8A760B57/afd82dad:>. 

Full StackTrace:

>System.TimeoutException:
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at Orleans.OrleansTaskExtentions+<<ToTypedTask>g__ConvertAsync|4_0>d1.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Filters.ActionFilterAttribute+<CallOnActionExecutedAsync>d__5.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Filters.ActionFilterAttribute+<CallOnActionExecutedAsync>d__5.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Filters.ActionFilterAttribute+<ExecuteActionFilterAsyncCore>d__0.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Controllers.ActionFilterResult+<ExecuteAsync>d__2.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Filters.AuthorizationFilterAttribute+<ExecuteAuthorizationFilterAsyncCore>d__2.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Controllers.ExceptionFilterResult+<ExecuteAsync>d__0.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
"," Response did not arrive on time in 00:00:30 for message:System.TimeoutException Recently I have upgraded orleans from 1.5 to 2.4.1 and after that I have started seeing the exceptions related to TimeOut. 
Response did not arrive on time in 00:00:30 for message: Request *cli/413a36bd@01e05ea7->S:30000:308414169*grn/8A760B57/afd82dad #15058: . Target History is: <S:30000:308414169:*grn/8A760B57/afd82dad:>. 

Full StackTrace:

>System.TimeoutException:
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at Orleans.OrleansTaskExtentions+<<ToTypedTask>g__ConvertAsync|4_0>d1.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Filters.ActionFilterAttribute+<CallOnActionExecutedAsync>d__5.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Filters.ActionFilterAttribute+<CallOnActionExecutedAsync>d__5.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Filters.ActionFilterAttribute+<ExecuteActionFilterAsyncCore>d__0.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Controllers.ActionFilterResult+<ExecuteAsync>d__2.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Filters.AuthorizationFilterAttribute+<ExecuteAuthorizationFilterAsyncCore>d__2.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (mscorlib Version=4.0.0.0 Culture=neutral PublicKeyToken=b77a5c561934e089)
   at System.Web.Http.Controllers.ExceptionFilterResult+<ExecuteAsync>d__0.MoveNext (System.Web.Http Version=5.2.3.0 Culture=neutral PublicKeyToken=31bf3856ad364e35)
",,sergeybykov,,
6036,NullReferenceException when calling GetReminder or GetReminders,"### Environment
**Affects:** 3.0.0-rc1
**Worked in:** 2.x
**Additional:** Uses the AdoNet reminder provider

### Reproduction:
1. Create a  every time works without issue.","NullReferenceException when calling GetReminder or GetReminders ### Environment
**Affects:** 3.0.0-rc1
**Worked in:** 2.x
**Additional:** Uses the AdoNet reminder provider

### Reproduction:
1. Create a  every time works without issue.",,ReubenBond,,
6033,Timeout exception using SMS as streaming provider,"Hi there

I am writing a turn-based game I have a GameGrain PlayerGrain and LiveUpdateGrain the GameGrain I use 

Do I have something wrong in the code?



","Timeout exception using SMS as streaming provider Hi there

I am writing a turn-based game I have a GameGrain PlayerGrain and LiveUpdateGrain the GameGrain I use 

Do I have something wrong in the code?



",,sergeybykov,,
6029,Cherry-picked fixes from master for 2.4.3,,Cherry-picked fixes from master for 2.4.3 ,,ReubenBond,,
6028,Could not load file or assembly 'Microsoft.Bcl.AsyncInterfaces Dependency missing in Orleans 3.0 RC1?,"I might be a bit quick to jump the gun but i wanted to try out orelans-3.0.0-RC1 after it got released. going from 3.0.0-Beta1 broke to me seems like Microsoft.Bcl.AsyncInterfaces is missing. 
got this error: 

installing it made it work however. Wanted to drop the info somewhere in case it got missing somewhere. Saw no info in the release notes about this","Could not load file or assembly 'Microsoft.Bcl.AsyncInterfaces, Dependency missing in Orleans 3.0 RC1? I might be a bit quick to jump the gun but i wanted to try out orelans-3.0.0-RC1 after it got released. going from 3.0.0-Beta1 broke to me seems like Microsoft.Bcl.AsyncInterfaces is missing. 
got this error: 

installing it made it work however. Wanted to drop the info somewhere in case it got missing somewhere. Saw no info in the release notes about this",,ReubenBond,,
6027,Update release notes for 3.0.0-rc1,,Update release notes for 3.0.0-rc1 ,,ReubenBond,,
6019,Fix AzureGossip_ConfigGossip to use UTC DateTime instead of local,,Fix AzureGossip_ConfigGossip to use UTC DateTime instead of local ,,ReubenBond,,
6011,Configure task scheduler?,"Hi

is it possible to configure the task scheduler somehow? 

The problem is that under high load the system can become unresponsive but some of the tasks would have a higher priority than others e.g. the health checks have a high priority.

Then the application can be restarted due to unresponsive health checks.","Configure task scheduler? Hi

is it possible to configure the task scheduler somehow? 

The problem is that under high load the system can become unresponsive but some of the tasks would have a higher priority than others e.g. the health checks have a high priority.

Then the application can be restarted due to unresponsive health checks.",,ReubenBond,,
6007,Avoid generating duplicate method id switch labels,"Fixes #5818

Fixes #5295","Avoid generating duplicate method id switch labels Fixes #5818

Fixes #5295",codegen,ReubenBond,4/10/2019 2:37,4/10/2019 9:15
6005,Use MemFree when MemAvailable is not present,"On Windows WSL1 there is no MemAvailable line in meminfo file.
Use MemFree which gives similiar information.","Use MemFree when MemAvailable is not present On Windows WSL1 there is no MemAvailable line in meminfo file.
Use MemFree which gives similiar information.",,ReubenBond,,
6001,Fix UTF8 encoding settings that appear to break execution of tests,,Fix UTF8 encoding settings that appear to break execution of tests ,,ReubenBond,,
6000,Remove InternalsVisibleTo set for extensions by making necessary internal types public,Fixes #4477.,Remove InternalsVisibleTo set for extensions by making necessary internal types public Fixes #4477.,,ReubenBond,,
5996,Support either Length or number of read bytes for IBinaryTokenStreamReader,"Hi

in 2.X I have written a custom stream as a wrapper around a IBinaryTokenStreamReader for a custom JSON.NET serializer.

https://github.com/Squidex/squidex/blob/master/src/Squidex.Infrastructure/Orleans/StreamReaderWrapper.cs#L59

The Length property has gone and therefore it is not possible to implement the Read method anymore.

I would either need:

1. A Length property in  should return the number of read bytes if count is too large.","Support either Length or number of read bytes for IBinaryTokenStreamReader Hi

in 2.X I have written a custom stream as a wrapper around a IBinaryTokenStreamReader for a custom JSON.NET serializer.

https://github.com/Squidex/squidex/blob/master/src/Squidex.Infrastructure/Orleans/StreamReaderWrapper.cs#L59

The Length property has gone and therefore it is not possible to implement the Read method anymore.

I would either need:

1. A Length property in  should return the number of read bytes if count is too large.",,ReubenBond,,
5995,Make TestClusterBuilder.AddSiloBuilderConfigurator and TestClusterBuilder.AddClientBuilderConfigurator fluent style APIs,Fixes #5617.,Make TestClusterBuilder.AddSiloBuilderConfigurator and TestClusterBuilder.AddClientBuilderConfigurator fluent style APIs Fixes #5617.,,ReubenBond,,
5993,Typecode not supported in cluster,"We recently updated to Orleans 2.4.2 + update SignalR.Orleans as well and in certain cases we are getting error such as 

![image](https://user-images.githubusercontent.com/3908723/65983209-4f0fef00-e47d-11e9-8fb2-b4489ecaa00a.png)

We should only have 1 cluster and all silos are all the same build and we dont use grain versioning either; Seeing slightly the code thats why it seems to be thrown if im correct however in our case it shouldn't be the case

","Typecode not supported in cluster We recently updated to Orleans 2.4.2 + update SignalR.Orleans as well and in certain cases we are getting error such as 

![image](https://user-images.githubusercontent.com/3908723/65983209-4f0fef00-e47d-11e9-8fb2-b4489ecaa00a.png)

We should only have 1 cluster and all silos are all the same build and we dont use grain versioning either; Seeing slightly the code thats why it seems to be thrown if im correct however in our case it shouldn't be the case

",,benjaminpetit,,
5985,Remove IMembershipOracle," is no longer used as it has been split up into smaller parts which are each responsible for less. We should remove it for 3.0

Fixes #5847","Remove IMembershipOracle  is no longer used as it has been split up into smaller parts which are each responsible for less. We should remove it for 3.0

Fixes #5847",,ReubenBond,,
5982,Checkpointing is not happening when using eventhub Orleans stream.,"Hi Team

We are using Orleans 2.2.4. We were trying out Azure Eventhub based Orleans stream. 

1. Although we are able to send and receive the messages to and from stream we noticed that checkpointing is not happening at configured timespan. If we stop the silo in between and re-run it we still see the old messages are pulled from eventhub. There are checkpoints created in Azure table when Silo starts but doesn't update in configured time span.
Attaching the sample code which produces this issue. Stream configuration is done in .

Can you please help with the configuration if we are missing something? We mostly did the configurations based on the tests written in Orleans code.
[Code to reproduce the issue](https://github.com/dotnet/orleans/files/3663200/OrleansStreamSample.zip)
","Checkpointing is not happening when using eventhub Orleans stream. Hi Team

We are using Orleans 2.2.4. We were trying out Azure Eventhub based Orleans stream. 

1. Although we are able to send and receive the messages to and from stream we noticed that checkpointing is not happening at configured timespan. If we stop the silo in between and re-run it we still see the old messages are pulled from eventhub. There are checkpoints created in Azure table when Silo starts but doesn't update in configured time span.
Attaching the sample code which produces this issue. Stream configuration is done in .

Can you please help with the configuration if we are missing something? We mostly did the configurations based on the tests written in Orleans code.
[Code to reproduce the issue](https://github.com/dotnet/orleans/files/3663200/OrleansStreamSample.zip)
",,jason-bragg,,
5981,Documentation for Stream balancers,"I am looking for documentation on eventhub stream's options . Please can you point me to that. 

Thanks.","Documentation for Stream balancers I am looking for documentation on eventhub stream's options . Please can you point me to that. 

Thanks.",,jason-bragg,,
5979,The client supports other languages,,The client supports other languages ,documentation,sergeybykov,,
5978,Exception deserialization failure,When the client does not refer to the server's Exception type Client will fail and timeout error will be raised.I think there should be a general approach.,Exception deserialization failure When the client does not refer to the server's Exception type Client will fail and timeout error will be raised.I think there should be a general approach.,,ReubenBond,,
5977,Add information about Task.Factory.StartNew gotchas in the docs,The current documentation about running tasks inside a grain (https://dotnet.github.io/orleans/Documentation/grains/external_tasks_and_grains.html) suggests to use  in this case.,Add information about Task.Factory.StartNew gotchas in the docs The current documentation about running tasks inside a grain (https://dotnet.github.io/orleans/Documentation/grains/external_tasks_and_grains.html) suggests to use  in this case.,documentation,ReubenBond,,
5973,Update preview dependency packages to final versions,,Update preview dependency packages to final versions ,,ReubenBond,,
5971,Disable analyzer tests,These tests appear to be blocking test execution on a regular basis. Let's disable them for now.,Disable analyzer tests These tests appear to be blocking test execution on a regular basis. Let's disable them for now.,,benjaminpetit,,
5970,Connecting to DynamoDB from Silo,"I'm trying to configure AWS DynamoDB for my Silo clustering and I'm always hitting the following exception: 
","Connecting to DynamoDB from Silo I'm trying to configure AWS DynamoDB for my Silo clustering and I'm always hitting the following exception: 
",,sergeybykov,,
5969,Is it safe to inject ITimerRegistry using DI?,"Hi everyone!

I found out that there is  as a grain what schedule does they participate? Can I be sure that timers that were created in the way I've shown above are scheduling in the correct way and never run concurrently with other tasks?","Is it safe to inject ITimerRegistry using DI? Hi everyone!

I found out that there is  as a grain what schedule does they participate? Can I be sure that timers that were created in the way I've shown above are scheduling in the correct way and never run concurrently with other tasks?",question,ReubenBond,,
5968,Possible false-positive error log message,"Hi!

I have received the next log messages with  which is less than 200 ms.

I would be very happy if you explain me what is happening here and whether I should worry about this.

Thanks.","Possible false-positive error log message Hi!

I have received the next log messages with  which is less than 200 ms.

I would be very happy if you explain me what is happening here and whether I should worry about this.

Thanks.",question,sergeybykov,,
5967,Add overloads to IBinaryTokenStreamWriter and IBinaryTokenStreamReader,"I am trying to incorporate messagepack for my serialization/deserialization but some overloads are missing on the serialization interfaces which would make this nicer:

.","Add overloads to IBinaryTokenStreamWriter and IBinaryTokenStreamReader I am trying to incorporate messagepack for my serialization/deserialization but some overloads are missing on the serialization interfaces which would make this nicer:

.",serialization,ReubenBond,,
5966,Extension not installed exception not necessary for streams,"Now that extensions can be automatically installed from the container at runtime there's no need for stream providers to install them at subscription or production time.  We should add the producer and consumer extensions to the container and remove this logic from the providers.

This both simplifies the provider logic and also removes the requirement for grains to initialize their stream usage at activation time.","Extension not installed exception not necessary for streams Now that extensions can be automatically installed from the container at runtime there's no need for stream providers to install them at subscription or production time.  We should add the producer and consumer extensions to the container and remove this logic from the providers.

This both simplifies the provider logic and also removes the requirement for grains to initialize their stream usage at activation time.",enhancement,jason-bragg,,
5965,[SMSProvider] When multiple subscription handlers throw an exception only the first exception can be caught,"Hi I'm using Orleans 2.4.0 and currently playing around with Orleans streams especially with the SMSProvider (FireAndForget - false).
Everything works fine but I'm losing detailed failure results when multiple subscription handlers throw an exception.
 _UnwrapAggregateExceptions = true|false (default = true current behavior)_","[SMSProvider] When multiple subscription handlers throw an exception, only the first exception can be caught Hi I'm using Orleans 2.4.0 and currently playing around with Orleans streams especially with the SMSProvider (FireAndForget - false).
Everything works fine but I'm losing detailed failure results when multiple subscription handlers throw an exception.
 _UnwrapAggregateExceptions = true|false (default = true current behavior)_",,sergeybykov,,
5964,Multiple message from  same stream cause  repetitive activation in consumer  ,"Hi

### Playground:

grain **A**  have a method to send message in 

if it is not miss config then may be there is regression like  #5086 

thank you
","Multiple message from  same stream cause  repetitive activation in consumer   Hi

### Playground:

grain **A**  have a method to send message in 

if it is not miss config then may be there is regression like  #5086 

thank you
",,sergeybykov,,
5963,Fix Connect blocked when ConnectAsync completed synchronously,"Fix for #5158

Acccodring to [documentation](https://docs.microsoft.com/en-us/dotnet/api/system.net.sockets.socket.connectasync?view=netcore-2.2) ","Fix Connect blocked when ConnectAsync completed synchronously Fix for #5158

Acccodring to [documentation](https://docs.microsoft.com/en-us/dotnet/api/system.net.sockets.socket.connectasync?view=netcore-2.2) ",,ReubenBond,,
5962,Custom Log Event Store,"Hi

I'm looking at implementing a custom storage provider - I would like to be storing the events for a Journaled Grains.  Could you please clarify if i need to implement a custom storage provider as well as the grains implement ICustomStorageInterface.

Also on storage providers whats the difference between IStorageProvider and IGrainStorage - i.e. when is the IProvider implementation of IStorageProvider  used?

I've been going through the documenation just a little confused at the moment. Thanks
Ross","Custom Log Event Store Hi

I'm looking at implementing a custom storage provider - I would like to be storing the events for a Journaled Grains.  Could you please clarify if i need to implement a custom storage provider as well as the grains implement ICustomStorageInterface.

Also on storage providers whats the difference between IStorageProvider and IGrainStorage - i.e. when is the IProvider implementation of IStorageProvider  used?

I've been going through the documenation just a little confused at the moment. Thanks
Ross",question,jason-bragg,,
5957,Demonstration package My-First-Orleans-Application.md does not compile,I spent an hour trying to get this simple demo application to compile. It seems there is something wrong with the references or packages. Surely having a simple step-by-step demo is a good idea for this project?,Demonstration package My-First-Orleans-Application.md does not compile I spent an hour trying to get this simple demo application to compile. It seems there is something wrong with the references or packages. Surely having a simple step-by-step demo is a good idea for this project?,documentation,sergeybykov,16/09/2019 20:59,
5948,WIP - Use opaque sequence token in message cache,"We now use opaque streamId sequence token and offsets in stream message cache.

This is intended to address https://github.com/dotnet/orleans/issues/5879
Will also help us move to more robust streamId.

PooledQueueCache is mostly ok but cruft translating opaque cached data to pre-existing types is a bit ick.

Also eviction strategy still has logic that shouldn't be there.

Getting this out for review but want to let the patterns bake for a bit before committing to this path.

@Frank-Krick","WIP - Use opaque sequence token in message cache We now use opaque streamId sequence token and offsets in stream message cache.

This is intended to address https://github.com/dotnet/orleans/issues/5879
Will also help us move to more robust streamId.

PooledQueueCache is mostly ok but cruft translating opaque cached data to pre-existing types is a bit ick.

Also eviction strategy still has logic that shouldn't be there.

Getting this out for review but want to let the patterns bake for a bit before committing to this path.

@Frank-Krick",work-in-progress,jason-bragg,13/09/2019 10:21,
5947,Exception thrown from constructor of stateless worker grain eventually freezes grain call,"I have found a bug that requires a silo restart to resolve (tested with Orleans versions 1.5.3 and 1.5.9).

You can simply reproduce the bug with the [_HelloWorld_](https://github.com/dotnet/orleans/tree/v1.5.9/Samples/HelloWorld) sample project.

I used the  method (throwing an exception from there) but in this case the bug does not occur. So I don't think this bug is related to https://github.com/dotnet/orleans/issues/4748.","Exception thrown from constructor of stateless worker grain eventually freezes grain call I have found a bug that requires a silo restart to resolve (tested with Orleans versions 1.5.3 and 1.5.9).

You can simply reproduce the bug with the [_HelloWorld_](https://github.com/dotnet/orleans/tree/v1.5.9/Samples/HelloWorld) sample project.

I used the  method (throwing an exception from there) but in this case the bug does not occur. So I don't think this bug is related to https://github.com/dotnet/orleans/issues/4748.",bug,benjaminpetit,,
5941,Double serialization/deserialization for exceptions thrown in Grains marked as transactional,When throwing custom exceptions in a transactional grain method the exception gets serialized and deserialized twice and then set as inner exception on a OrleansTransactionAbortedException. Is the double serialization/deserialization of the custom exception by design? Just trying to understand if this is a correct behaviour since this doesn't seem to be the case in a non transactional method.,Double serialization/deserialization for exceptions thrown in Grains marked as transactional When throwing custom exceptions in a transactional grain method the exception gets serialized and deserialized twice and then set as inner exception on a OrleansTransactionAbortedException. Is the double serialization/deserialization of the custom exception by design? Just trying to understand if this is a correct behaviour since this doesn't seem to be the case in a non transactional method.,,jason-bragg,,
5940,"Revert ""Bound retries for failed send in ClientMessageCenter and simplify (#5893)""",This PR (#5893) appears to have destabilized our reliability tests. Let's revert and redo it.,"Revert ""Bound retries for failed send in ClientMessageCenter and simplify (#5893)"" This PR (#5893) appears to have destabilized our reliability tests. Let's revert and redo it.",,ReubenBond,,
5939,Retain producer-side stream filtering,"**Background**

Producer-side stream filtering is to be removed in an upcoming revision of Orleans (per #5408).
See relevant Gitter excerpts below:
* [August 13 2019 3:04 PM](https://gitter.im/dotnet/orleans?at=5d535e35d03a7c63e62256d5)
* [August 14 2019 7:23 AM](https://gitter.im/dotnet/orleans?at=5d5443ad9507182477d9d6be)
* [August 14 2019 8:04 AM](https://gitter.im/dotnet/orleans?at=5d544d494e17537f522fbd4e)

In short the intent is to remove the feature due to maintainability and design-related concerns in the face of the pub-sub system becoming a public surface.
My understanding is that the primary design concern stems from the way the filter predicate is specified.  In the current implementation the identity of the filter predicate (represented by a class name and method name tuple) is supplied by the subscribing party. In addition to constraining  eligible predicates to  static methods the mechanism used to extract this identity employs delegates and leads to an undesirable dependency whereby the predicate function must be available to both producer and consumer. While this may appear fairly benign in the case in which both the producer and the consumer are grains this requirement becomes harder to justify when consuming streams from an Orleans client. 

**Advocating for retaining producer-side filtering** 

> Please note that the scenarios described below have been significantly simplified for the sake of brevity

We use per-grain streams to publish incremental grain state changes in a variation on event sourcing. Clients subscribe to these streams to render changes to grain state in real time. Upon subscribing a new client receives an optimized version of the change log allowing it to ""catch-up"" with the current grain state - we are currently using the feature in production to selectively deliver this class of messages to only the newly subscribed client. 

In addition to simple state(s) grains can hold collections - changes to these collections are similarly propagated to clients in real time. Clients can construct queries over these collections the results of which are also updated in real time - we are currently using the feature in production to selectively deliver initial query results to only the client that has made the query. 

Continuing to be able to filter such messages on the producer side is very important to us.

**Possible approaches to retaining producer-side filtering**
 
It appears that allowing arbitrary client-supplied predicates while addressing the coupling concern would require serializing the predicate closure provided by the consumer at subscription time and then deserializing and executing it on the producer side.
While serializers that could be used to implement such behavior exists (e.g. [FsPickler](https://github.com/mbraceproject/FsPickler) [Hyperion](https://github.com/akkadotnet/Hyperion)) It is unclear to me at this point whether the added complexity is warranted and how such complexity would impact the goal of having an easily-maintainable public pub-sub surface.

A more conservative approach would avoid passing predicate identity during subscription altogether and instead rely on the predicate being supplied on the producer side at the time of event emission. A subscriber would continue to be able to attach custom data to the subscription data that could be used on the producer side to affect predicate logic. 
It is of note that this approach while not requiring the subscriber to supply the predicate identity would continue to allow the subscriber to choose a specific predicate logic out of a well-known set of choices available producer-side by means of adequately constructed custom subscription data.

I am proposing adopting the latter approach based on its relative simplicity and on the fact that it allows for a straightforward migration path - please let me know if this would be acceptable in principle. If so I will try to modify the current implementation and tests accordingly and submit a PR

Please also let me know if you would like to discuss any of the above offline I am more than happy to do so.
","Retain producer-side stream filtering **Background**

Producer-side stream filtering is to be removed in an upcoming revision of Orleans (per #5408).
See relevant Gitter excerpts below:
* [August 13 2019 3:04 PM](https://gitter.im/dotnet/orleans?at=5d535e35d03a7c63e62256d5)
* [August 14 2019 7:23 AM](https://gitter.im/dotnet/orleans?at=5d5443ad9507182477d9d6be)
* [August 14 2019 8:04 AM](https://gitter.im/dotnet/orleans?at=5d544d494e17537f522fbd4e)

In short the intent is to remove the feature due to maintainability and design-related concerns in the face of the pub-sub system becoming a public surface.
My understanding is that the primary design concern stems from the way the filter predicate is specified.  In the current implementation the identity of the filter predicate (represented by a class name and method name tuple) is supplied by the subscribing party. In addition to constraining  eligible predicates to  static methods the mechanism used to extract this identity employs delegates and leads to an undesirable dependency whereby the predicate function must be available to both producer and consumer. While this may appear fairly benign in the case in which both the producer and the consumer are grains this requirement becomes harder to justify when consuming streams from an Orleans client. 

**Advocating for retaining producer-side filtering** 

> Please note that the scenarios described below have been significantly simplified for the sake of brevity

We use per-grain streams to publish incremental grain state changes in a variation on event sourcing. Clients subscribe to these streams to render changes to grain state in real time. Upon subscribing a new client receives an optimized version of the change log allowing it to ""catch-up"" with the current grain state - we are currently using the feature in production to selectively deliver this class of messages to only the newly subscribed client. 

In addition to simple state(s) grains can hold collections - changes to these collections are similarly propagated to clients in real time. Clients can construct queries over these collections the results of which are also updated in real time - we are currently using the feature in production to selectively deliver initial query results to only the client that has made the query. 

Continuing to be able to filter such messages on the producer side is very important to us.

**Possible approaches to retaining producer-side filtering**
 
It appears that allowing arbitrary client-supplied predicates while addressing the coupling concern would require serializing the predicate closure provided by the consumer at subscription time and then deserializing and executing it on the producer side.
While serializers that could be used to implement such behavior exists (e.g. [FsPickler](https://github.com/mbraceproject/FsPickler) [Hyperion](https://github.com/akkadotnet/Hyperion)) It is unclear to me at this point whether the added complexity is warranted and how such complexity would impact the goal of having an easily-maintainable public pub-sub surface.

A more conservative approach would avoid passing predicate identity during subscription altogether and instead rely on the predicate being supplied on the producer side at the time of event emission. A subscriber would continue to be able to attach custom data to the subscription data that could be used on the producer side to affect predicate logic. 
It is of note that this approach while not requiring the subscriber to supply the predicate identity would continue to allow the subscriber to choose a specific predicate logic out of a well-known set of choices available producer-side by means of adequately constructed custom subscription data.

I am proposing adopting the latter approach based on its relative simplicity and on the fact that it allows for a straightforward migration path - please let me know if this would be acceptable in principle. If so I will try to modify the current implementation and tests accordingly and submit a PR

Please also let me know if you would like to discuss any of the above offline I am more than happy to do so.
",,jason-bragg,,
5938,How to setup connectivity between silo and client if first one lives in docker container and second does not?,Is it possible to setup Orleans cluster the way silos deployed under docker container while Orleans client (service that calls grains) to be a regular Windows service? The problem I experince in the configuration is that silos register themselves under docker subnet ips in a membership table (MongoDb in my case) and then client tries to call gateway (port 11111) with their own docker ips but dockers are not accessible under their own ip from host system at least I do not know how to configure it. Instead the gateway accessible under host machine ip with 11111 port if you map it to a host port when running docker container. However client reads docker container IPs from mongo not their host ips.  Anyone have an idea on how to get around it or set it up properly? Thanks,"How to setup connectivity between silo and client, if first one lives in docker container and second does not? Is it possible to setup Orleans cluster the way silos deployed under docker container while Orleans client (service that calls grains) to be a regular Windows service? The problem I experince in the configuration is that silos register themselves under docker subnet ips in a membership table (MongoDb in my case) and then client tries to call gateway (port 11111) with their own docker ips but dockers are not accessible under their own ip from host system at least I do not know how to configure it. Instead the gateway accessible under host machine ip with 11111 port if you map it to a host port when running docker container. However client reads docker container IPs from mongo not their host ips.  Anyone have an idea on how to get around it or set it up properly? Thanks",,ReubenBond,,
5937,Repro for #5936," See #5936 
Note that this repro results in invalid code being generated and thus breaks the build.","Repro for #5936  See #5936 
Note that this repro results in invalid code being generated and thus breaks the build.",,ReubenBond,,
5936,Microsoft.Orleans.CodeGenerator.MSBuild generates invalid code for F# interface methods with multiple unnamed arguments,"F# interface declarations allow declaring methods without specifying argument names.
 generates valid code in this scenario. 

Repro PR: #5937","Microsoft.Orleans.CodeGenerator.MSBuild generates invalid code for F# interface methods with multiple unnamed arguments F# interface declarations allow declaring methods without specifying argument names.
 generates valid code in this scenario. 

Repro PR: #5937",codegen,ReubenBond,,
5933,String grain id interceptor,"@ReubenBond Just moving the conversation to here from Gitter. As I mentioned we have the issue where string differences (capitalization extra whitespaces...) in string grain Ids are causing us to activate different grains. 

Right now our team uses  any time we use a string id but we may need to have different rules based on the different grain type. Ideally the logic to make the ids conform to the standard would be something that the grain with the string id would define not the grain that is trying to access the grain. The proposed solution is to add an id interceptor that could be added to the silo configuration that would allow a developer to convert the requested string id into a ""standardized"" string.

I'd love to get some feedback and/or ideas on this before writing the code. If this seems like an idea that has support within the community I can make the changes and open up a PR within the next week or so.","String grain id interceptor @ReubenBond Just moving the conversation to here from Gitter. As I mentioned we have the issue where string differences (capitalization extra whitespaces...) in string grain Ids are causing us to activate different grains. 

Right now our team uses  any time we use a string id but we may need to have different rules based on the different grain type. Ideally the logic to make the ids conform to the standard would be something that the grain with the string id would define not the grain that is trying to access the grain. The proposed solution is to add an id interceptor that could be added to the silo configuration that would allow a developer to convert the requested string id into a ""standardized"" string.

I'd love to get some feedback and/or ideas on this before writing the code. If this seems like an idea that has support within the community I can make the changes and open up a PR within the next week or so.",,ReubenBond,,
5932,Docs: Update Configuration Guide to show UseOrleans(),"As discussed in #5931 

The Configuration Guide shows  approach ADO.NET configuration entries result in a ""call is ambiguous"" error for the various extension methods (this happens with the provider reminder and cluster packages).

![image](https://user-images.githubusercontent.com/54578900/64422919-375a6c00-d073-11e9-9938-b083b45cefcb.png)
","Docs: Update Configuration Guide to show UseOrleans() As discussed in #5931 

The Configuration Guide shows  approach ADO.NET configuration entries result in a ""call is ambiguous"" error for the various extension methods (this happens with the provider reminder and cluster packages).

![image](https://user-images.githubusercontent.com/54578900/64422919-375a6c00-d073-11e9-9938-b083b45cefcb.png)
",documentation,ReubenBond,,
5926,Roslyn code generator fails when Azure Cosmos DB SDK 3.0 is references by a grain,"When using Azure Cosmos DB SDK 3.0 inside a grain (even without adding Cosmos SDK types to method declaration) the build fails with error: 



I believe the issue is caused by Roslyn code generator trying to load all references assemblies and Microsoft.Azure.Cosmos.Direct package is somehow optional for Cosmos SDK and not always present.

I think Azure Cosmos SDK 3.0 has an issue with async (tasks are hanging when calling SDK from with in a grain - I saw a similar problem in SDK 2.0) and I'm trying to prepare a repro for Cosmos DB Team.

Attached is the repro project.
[Repro.zip](https://github.com/dotnet/orleans/files/3563394/Repro.zip)

cc: @ReubenBond ","Roslyn code generator fails when Azure Cosmos DB SDK 3.0 is references by a grain When using Azure Cosmos DB SDK 3.0 inside a grain (even without adding Cosmos SDK types to method declaration) the build fails with error: 



I believe the issue is caused by Roslyn code generator trying to load all references assemblies and Microsoft.Azure.Cosmos.Direct package is somehow optional for Cosmos SDK and not always present.

I think Azure Cosmos SDK 3.0 has an issue with async (tasks are hanging when calling SDK from with in a grain - I saw a similar problem in SDK 2.0) and I'm trying to prepare a repro for Cosmos DB Team.

Attached is the repro project.
[Repro.zip](https://github.com/dotnet/orleans/files/3563394/Repro.zip)

cc: @ReubenBond ",codegen,ReubenBond,,
5922,Exceptions during graceful shutdown,"I am getting exceptions after trying to gracefully shutdown one of two silos. And sometimes silo can't shutdown at all and just hangs.

On the silo that being shutdown:


","Exceptions during graceful shutdown I am getting exceptions after trying to gracefully shutdown one of two silos. And sometimes silo can't shutdown at all and just hangs.

On the silo that being shutdown:


",,benjaminpetit,,
5918,Exception when deserializing an empty array.,"I think that the problem is in the **TryCheckLengthFast** method of the **BinaryTokenStreamReader** class which can return null if argument passed to parameter **n** is 0.

Log message:


Orleans version: 2.4.1","Exception when deserializing an empty array. I think that the problem is in the **TryCheckLengthFast** method of the **BinaryTokenStreamReader** class which can return null if argument passed to parameter **n** is 0.

Log message:


Orleans version: 2.4.1",,ReubenBond,,
5917,Stateless worker local compatibility check,This changes the placement of stateless workers to not just blindly choose the local silo as the target. Instead we check if the local silo is compatible first if it is then we choose it otherwise we back off to the random logic which we previously used when the silo was shutting down.,Stateless worker local compatibility check This changes the placement of stateless workers to not just blindly choose the local silo as the target. Instead we check if the local silo is compatible first if it is then we choose it otherwise we back off to the random logic which we previously used when the silo was shutting down.,,ReubenBond,,
5916,[2.4.2] Fix default value for MaxMessageHeaderSize and MaxMessageBodySize,,[2.4.2] Fix default value for MaxMessageHeaderSize and MaxMessageBodySize ,,sergeybykov,,
5915,[@ReubenBond] [2.4.2] Remove SAEA pooling,Remove pooling of s. We suspect there's a bug there that occasionally leads to corruption of read data.,[@ReubenBond] [2.4.2] Remove SAEA pooling Remove pooling of s. We suspect there's a bug there that occasionally leads to corruption of read data.,,benjaminpetit,,
5914,Lease based queue balancer refactor.,"No longer uses deployment configuration.
Serialize changes to avoid interleaving.
More configuration options.
Conformed configuration patterns to Orleans common patterns including replacing the azure blob lease settings with options.","Lease based queue balancer refactor. No longer uses deployment configuration.
Serialize changes to avoid interleaving.
More configuration options.
Conformed configuration patterns to Orleans common patterns including replacing the azure blob lease settings with options.",enhancement,ReubenBond,,
5913,Code generator: Same type parameter + method name gives duplicated symbols,s resolves the issue. I'm doing the latter right now as a workaround since I don't want to change my API naming here.,Code generator: Same type parameter + method name gives duplicated symbols s resolves the issue. I'm doing the latter right now as a workaround since I don't want to change my API naming here.,,ReubenBond,,
5912,"Add ""UseSiloUnobservedExceptionsHandler"" extensions to the ISiloBuilder","ISiloBuilder missing ""UseSiloUnobservedExceptionsHandler"" extensions  this PR fixed it","Add ""UseSiloUnobservedExceptionsHandler"" extensions to the ISiloBuilder ISiloBuilder missing ""UseSiloUnobservedExceptionsHandler"" extensions  this PR fixed it",,benjaminpetit,,
5906,[Question] Is is possible to run Orleans on top of Kestrel?,"Is it possible to run Orleans on top of Kestrel given the networking rewrite from 3.0? Is there an example of this or a hint over how I might achieve this (if possible)?

Will this enable scale-out scenarios using Azure App Services? 
","[Question] Is is possible to run Orleans on top of Kestrel? Is it possible to run Orleans on top of Kestrel given the networking rewrite from 3.0? Is there an example of this or a hint over how I might achieve this (if possible)?

Will this enable scale-out scenarios using Azure App Services? 
",question,ReubenBond,,
5905,Managing grains without subclassing: Getting the IGrainActivationContext?,"# Summary

I need a .
* Calling the client's methods.

**I am still having a need to allow ""outsiders"" to tell the service to keep a different grain activated.**","Managing grains without subclassing: Getting the IGrainActivationContext? # Summary

I need a .
* Calling the client's methods.

**I am still having a need to allow ""outsiders"" to tell the service to keep a different grain activated.**",,jason-bragg,,
5903,Orleans.GRPC,"As described in issue https://github.com/dotnet/orleans/issues/3190 microservices become popular and of most popular solution is using protobuf with GRPC srevices. 
And I think it will be more interesting if use will have choice of using HTTP or GRPC to using Orleans backend. 

So what I propose is generating protobuf models from c# interfaces that could be translated to http\grpc with swagger support.","Orleans.GRPC As described in issue https://github.com/dotnet/orleans/issues/3190 microservices become popular and of most popular solution is using protobuf with GRPC srevices. 
And I think it will be more interesting if use will have choice of using HTTP or GRPC to using Orleans backend. 

So what I propose is generating protobuf models from c# interfaces that could be translated to http\grpc with swagger support.",Hacktoberfest,sergeybykov,24/08/2019 23:07,
5899,Close client connection on serialization error.,Close client connection on serialization error to avoid data corruption from client.,Close client connection on serialization error. Close client connection on serialization error to avoid data corruption from client.,,benjaminpetit,,
5898,Force connection close when a silo is failing ping probe,,Force connection close when a silo is failing ping probe ,,jason-bragg,,
5896,Stream batch delivery allows premature purge of cache data,"When using persistent streams and StreamPullingAgentOptions.BatchContainerBatchSize is configured to a value greater than 1 messages from cache will be batched together to be sent to consumers.  This logic moves the consumers cursor in the cache to the last message in the batch allowing all previous messages which may not have yet been successfully delivered to the consumer to be eligible to be purged from the cache which should not be the case since the consumer may not have had a chance to successfully process them.

This could result in unexpected DataNotAvailable exceptions.","Stream batch delivery allows premature purge of cache data When using persistent streams and StreamPullingAgentOptions.BatchContainerBatchSize is configured to a value greater than 1 messages from cache will be batched together to be sent to consumers.  This logic moves the consumers cursor in the cache to the last message in the batch allowing all previous messages which may not have yet been successfully delivered to the consumer to be eligible to be purged from the cache which should not be the case since the consumer may not have had a chance to successfully process them.

This could result in unexpected DataNotAvailable exceptions.",bug,jason-bragg,,
5888,Fix NullReferenceException in AQStreamsBatchingTests.Dispose,,Fix NullReferenceException in AQStreamsBatchingTests.Dispose ,,jason-bragg,,
5887,Improve graceful deactivation of grains performing transaction work,"This PR is mostly intended to reduce log noise since this behavior is benign. Nevertheless I believe it's worthwhile to clean up the behavior here.

If a grain fails to fully activate and has some transaction processing work which need to be performed then it's possible for the grain to get into a state where the background transaction workers will never terminate.

Additionally when a grain deactivates while it's performing background transaction work we may emit a warning to the effect of 
This PR attempts to prevent this situation by blocking deactivation until the background workers are aware of it and can gracefully terminate.","Improve graceful deactivation of grains performing transaction work This PR is mostly intended to reduce log noise since this behavior is benign. Nevertheless I believe it's worthwhile to clean up the behavior here.

If a grain fails to fully activate and has some transaction processing work which need to be performed then it's possible for the grain to get into a state where the background transaction workers will never terminate.

Additionally when a grain deactivates while it's performing background transaction work we may emit a warning to the effect of 
This PR attempts to prevent this situation by blocking deactivation until the background workers are aware of it and can gracefully terminate.",,jason-bragg,,
5886,InterfaceMethod null in call filter,"We have a call filter to log errors. After migrating from 2.2 (core) and 2.0 (server) to more recent versions (2.4.1) we noticed that some of these methods are empty. The correct method is still being called though.

We noticed the problem with a method called ""Create"" but the same name on another grain works just fine. Because it works fine on another grain I don't think we can work on reproduction code easily is there something I can send you (like the generated code) that could help you look into this?

I don't think our call filter itself is very out-of-the-ordinary:

","InterfaceMethod null in call filter We have a call filter to log errors. After migrating from 2.2 (core) and 2.0 (server) to more recent versions (2.4.1) we noticed that some of these methods are empty. The correct method is still being called though.

We noticed the problem with a method called ""Create"" but the same name on another grain works just fine. Because it works fine on another grain I don't think we can work on reproduction code easily is there something I can send you (like the generated code) that could help you look into this?

I don't think our call filter itself is very out-of-the-ordinary:

",,ReubenBond,,
5885,Race condition with streams when AllowCallChainReentrancy is enabled.,"When A sends a message through a stream to B1 and B2 and both of them calls A in the event handler the calls B1->A and B2->A interleave.

","Race condition with streams when AllowCallChainReentrancy is enabled. When A sends a message through a stream to B1 and B2 and both of them calls A in the event handler the calls B1->A and B2->A interleave.

",,sergeybykov,,
5884,ActivationCollector found an active activation in it's last bucket,"Some Grain  cannot work and cannot be collected
log text:
ActivationCollector found an active activation in it's last bucket. This is violation of ActivationCollector invariants.

seach log text
https://github.com/dotnet/orleans/blob/7a85122752c6b597415e0bc59add762fdf250799/src/Orleans.Runtime/Catalog/ActivationCollector.cs#L222

How to avoid this problem?","ActivationCollector found an active activation in it's last bucket Some Grain  cannot work and cannot be collected
log text:
ActivationCollector found an active activation in it's last bucket. This is violation of ActivationCollector invariants.

seach log text
https://github.com/dotnet/orleans/blob/7a85122752c6b597415e0bc59add762fdf250799/src/Orleans.Runtime/Catalog/ActivationCollector.cs#L222

How to avoid this problem?",,sergeybykov,,
5883,Improve codegen's .NET Core 3 compatibility 2,"fixes #5880 

The fix allows the codegen for dotnet to use a runtime >= 3.0.0 as fallback if the 2.0 runtime cannot be found. This allow code generation in only dotnet 3.0 environments.

The changes are the same as for #5799 for the MSBuild codegenerator.

I also included the codegenerator in Bootstrap so that building Orleans itself is now possible only with a dotnet 3.0 runtime.

It maybe a good idea to do that for the MSBuild codegen in Bootstrap too. Should I include the change in this pull request?

Thanks

Frank","Improve codegen's .NET Core 3 compatibility 2 fixes #5880 

The fix allows the codegen for dotnet to use a runtime >= 3.0.0 as fallback if the 2.0 runtime cannot be found. This allow code generation in only dotnet 3.0 environments.

The changes are the same as for #5799 for the MSBuild codegenerator.

I also included the codegenerator in Bootstrap so that building Orleans itself is now possible only with a dotnet 3.0 runtime.

It maybe a good idea to do that for the MSBuild codegen in Bootstrap too. Should I include the change in this pull request?

Thanks

Frank",,ReubenBond,,
5882,Reminders spinning up on silos with different clusterId,"Hi I have an orleans setup where we have different silos with different clusterId's (staging dev prod etc). I noticed that every now and then a reminder that was created on staging would spin up in dev silos.

I am using AdoNetReminderService with SQL Server when I looked at the ReminderTable I noticed that it only had ServiceId as the column no reference to ClusterId so I changed all of the silos to have different serviceId's to prevent the issue. However it was brought to my attention that the Orleans documentation recommends keeping all of the ServiceId's of the silos the same. Am I missing anything? Are reminders supposed to be able to distinguish between silos with different clusterId's even with same ServiceId's?","Reminders spinning up on silos with different clusterId Hi I have an orleans setup where we have different silos with different clusterId's (staging dev prod etc). I noticed that every now and then a reminder that was created on staging would spin up in dev silos.

I am using AdoNetReminderService with SQL Server when I looked at the ReminderTable I noticed that it only had ServiceId as the column no reference to ClusterId so I changed all of the silos to have different serviceId's to prevent the issue. However it was brought to my attention that the Orleans documentation recommends keeping all of the ServiceId's of the silos the same. Am I missing anything? Are reminders supposed to be able to distinguish between silos with different clusterId's even with same ServiceId's?",question,sergeybykov,,
5881,Protect ClientState.PendingToSend with lock,,Protect ClientState.PendingToSend with lock ,,benjaminpetit,,
5880,Orleans 3.0.0-beta1 Code Generator uses Assemblies for dotnet 2.0 and can't be build in official MS container for dotnet 3.0,"The new version Orleans 3.0.0-beta1 still uses assemblies from dotnet 2.0 during code generation. This prevents building the application in the MS docker sdk container 

Installing an older version of dotnet in the container fixes the issue.","Orleans 3.0.0-beta1 Code Generator uses Assemblies for dotnet 2.0 and can't be build in official MS container for dotnet 3.0 The new version Orleans 3.0.0-beta1 still uses assemblies from dotnet 2.0 during code generation. This prevents building the application in the MS docker sdk container 

Installing an older version of dotnet in the container fixes the issue.",,ReubenBond,,
5879,Kinesis Streams Sequence Number much bigger than attributes in StreamSequenceToken introduced with #5580,"We have an implementation of a persistent stream adapter to consume Amazon Kinesis streams which we are using in production for several month now.

Amazon Kinesis streams have a sequence number consisting of 128 digits (186 Bits) which is much bigger than the attributes SequenceNumber and EventIndex defined in StreamSequenceToken. The changes in #5580 therefore break our stream provider implementation.

StreamSequenceToken seems to be very much specific to Azure streams and it is not apparent how an implementation of StreamSequenceToken should be mapped to other persistent stream providers and it seems to be not a very good choice to tie the StreamSequenceToken to closely with stream implementations from a given vendor.","Kinesis Streams Sequence Number much bigger than attributes in StreamSequenceToken introduced with #5580 We have an implementation of a persistent stream adapter to consume Amazon Kinesis streams which we are using in production for several month now.

Amazon Kinesis streams have a sequence number consisting of 128 digits (186 Bits) which is much bigger than the attributes SequenceNumber and EventIndex defined in StreamSequenceToken. The changes in #5580 therefore break our stream provider implementation.

StreamSequenceToken seems to be very much specific to Azure streams and it is not apparent how an implementation of StreamSequenceToken should be mapped to other persistent stream providers and it seems to be not a very good choice to tie the StreamSequenceToken to closely with stream implementations from a given vendor.",,jason-bragg,,
5878,Cannot find generated GrainReference class for interface,"Strange behaviour.
When I registering IClusterClient in Dependncy Injection and use it in other parts of application exception ""Cannot find generated GrainReference class for interface"" will be raised. 

But if I call GetGrain<> during registration - everything will be ok and no errors. 

What's wrong? ","Cannot find generated GrainReference class for interface Strange behaviour.
When I registering IClusterClient in Dependncy Injection and use it in other parts of application exception ""Cannot find generated GrainReference class for interface"" will be raised. 

But if I call GetGrain<> during registration - everything will be ok and no errors. 

What's wrong? ",,ReubenBond,,
5877,Codegenerator produces errors in generics,"I am using Microsoft.Orleans.CodeGenerator.MSBuild to generate proxies in a netstandard2.0 ""contracts"" library (shared library among clients to connect to orleans).
I recently updated to the latest stable version 2.4.1 from 2.3.6.

Where it used to generate 


Which doesn't compile.
Reverting back to 2.3.6 fixes the issue.","Codegenerator produces errors in generics I am using Microsoft.Orleans.CodeGenerator.MSBuild to generate proxies in a netstandard2.0 ""contracts"" library (shared library among clients to connect to orleans).
I recently updated to the latest stable version 2.4.1 from 2.3.6.

Where it used to generate 


Which doesn't compile.
Reverting back to 2.3.6 fixes the issue.",codegen,ReubenBond,,
5876,Serialization manager does not serialize HttpRequestException stack trace ,"Hi
I noticed that Serialization manager does not serialize HttpRequestException stack trace. 
I don
Thanks
Eran","Serialization manager does not serialize HttpRequestException stack trace  Hi
I noticed that Serialization manager does not serialize HttpRequestException stack trace. 
I don
Thanks
Eran",serialization,ReubenBond,,
5875,provide more meaningful details when not able to find grain implementation for stream subscription,"im using orleans 2.3.6 and i got this exception:

'Unexpected: Cannot find an implementation class for grain interface 953247292'

digging down the stack with a debugger I got to PersistentStreamPullingAgent.

It would be VERY helpful if the exception could include the StreamId that is causing the issue so one could find the issue from the logfiles without needing a debugger.

","provide more meaningful details when not able to find grain implementation for stream subscription im using orleans 2.3.6 and i got this exception:

'Unexpected: Cannot find an implementation class for grain interface 953247292'

digging down the stack with a debugger I got to PersistentStreamPullingAgent.

It would be VERY helpful if the exception could include the StreamId that is causing the issue so one could find the issue from the logfiles without needing a debugger.

",,jason-bragg,,
5873,Add a warning about runtime running with trace level higher than Info,This was suggested by @EranOfer in https://github.com/dotnet/orleans/issues/5851#issuecomment-520709746,Add a warning about runtime running with trace level higher than Info This was suggested by @EranOfer in https://github.com/dotnet/orleans/issues/5851#issuecomment-520709746,Hacktoberfest,sergeybykov,17/08/2019 6:19,16/10/2019 3:24
5871,Handling very specific exceptions on the client,"Hello to all! Thanks for the great job! I have the following question:

What is the best way to handle this situation: one of the grains throws a very specific exception (for example related to the database driver). Further this exception ""flies"" and reaches the client where it cannot be deserialized (because the client does not know anything about working with the database all of these libraries are not loaded in the client).

What is the best way to solve such problems?

Here is an example of this kind of deserialization error:

","Handling very specific exceptions on the client Hello to all! Thanks for the great job! I have the following question:

What is the best way to handle this situation: one of the grains throws a very specific exception (for example related to the database driver). Further this exception ""flies"" and reaches the client where it cannot be deserialized (because the client does not know anything about working with the database all of these libraries are not loaded in the client).

What is the best way to solve such problems?

Here is an example of this kind of deserialization error:

",,ReubenBond,,
5870,ConfigureFileLogging hangs/crashes TestCluster,"With the master branch of Orleans and netcore sdk 3.0.100-preview9-013803 
Having 


rich","ConfigureFileLogging hangs/crashes TestCluster With the master branch of Orleans and netcore sdk 3.0.100-preview9-013803 
Having 


rich",,ReubenBond,,
5869,how to call outside method  in grains?,"I have netty as frontend. the msg from device can pass throuth netty then we have a cluster to handler the msg. but how to send response  through netty to device?

I do got some method to do the job without orleans. but I 'd like to know the  orleans' way.","how to call outside method  in grains? I have netty as frontend. the msg from device can pass throuth netty then we have a cluster to handler the msg. but how to send response  through netty to device?

I do got some method to do the job without orleans. but I 'd like to know the  orleans' way.",question,sergeybykov,,
5868,Could not find silo entry for silo ... in the table,"Orleans version: 2.2
Errors

It seems the silo hoped to delete is already deleted in my membershipTableProvider.
Why soli don't update it's probedSilos？
I checked the source code  the  already deleted (in membershipTableProvider) probedSilo will be dead only after delete in membershipTableProvider But I am not sureI will check the higher version
","Could not find silo entry for silo ... in the table Orleans version: 2.2
Errors

It seems the silo hoped to delete is already deleted in my membershipTableProvider.
Why soli don't update it's probedSilos？
I checked the source code  the  already deleted (in membershipTableProvider) probedSilo will be dead only after delete in membershipTableProvider But I am not sureI will check the higher version
",,sergeybykov,,
5866,Is there an example for AzureQueue streams in Orleans?,,Is there an example for AzureQueue streams in Orleans? ,question,sergeybykov,,
5865,Log parameter names improvement for structured loggers,"A lot of log messages use the ""old"" String.Format syntax with  is not always of the same type. (int string ...)

This could be replaced by something like

    Log.Info(""Starting AsyncAgent {AgentName} on managed thread {ThreadId}"" Name Thread.CurrentThread.ManagedThreadId)

The goal is maybe not to change it everywhere but at least to improve the most common log messages in a first time and to improve the other logs over time.","Log parameter names improvement for structured loggers A lot of log messages use the ""old"" String.Format syntax with  is not always of the same type. (int string ...)

This could be replaced by something like

    Log.Info(""Starting AsyncAgent {AgentName} on managed thread {ThreadId}"" Name Thread.CurrentThread.ManagedThreadId)

The goal is maybe not to change it everywhere but at least to improve the most common log messages in a first time and to improve the other logs over time.",Hacktoberfest,ReubenBond,14/08/2019 21:39,
5864,Resubmit #5862 (Cherry-pick #5859 and #5863 for 2.4.1),"Log options on silo and client startup (#5859)
Handle the case where the clustering provider does not support TableVersion (#5863)","Resubmit #5862 (Cherry-pick #5859 and #5863 for 2.4.1) Log options on silo and client startup (#5859)
Handle the case where the clustering provider does not support TableVersion (#5863)",,jason-bragg,,
5863,Fix for Clustering providers that does not implement extended Membership Protocol,Fix for #5857 ,Fix for Clustering providers that does not implement extended Membership Protocol Fix for #5857 ,,ReubenBond,,
5862,Cherry-pick #5859 and #5863 for 2.4.1,"Log options on silo and client startup (#5859)
Handle the case where the clustering provider does not support TableVersion (#5863)","Cherry-pick #5859 and #5863 for 2.4.1 Log options on silo and client startup (#5859)
Handle the case where the clustering provider does not support TableVersion (#5863)",,benjaminpetit,,
5860,[WIP] Support ConnectionOptions.OpenConnectionTimeout,,[WIP] Support ConnectionOptions.OpenConnectionTimeout ,,benjaminpetit,,
5858,How to deploy a new version of GrainService?,Since a GrainService runs on the silo from startup to shutdown what is the best strategy to deploy a new version on the same cluster?,How to deploy a new version of GrainService? Since a GrainService runs on the silo from startup to shutdown what is the best strategy to deploy a new version on the same cluster?,question,sergeybykov,,
5857,ManagementGrain.GetTotalActivationCount() does not return a result with 2.4.0,"Hi

I updated my application to 2.4.0 and with a real membership provider like MongoDB I see a few behaviors:

1. The dashboard does not show any results.

2. GetTotalActivationCount() returns 0

3. GetTotalActivationCount() something throws an exception:



I have pushed a small example to: https://github.com/OrleansContrib/OrleansDashboard/tree/mongo-example/Tests/TestHosts/TestHostWithMongoClustering","ManagementGrain.GetTotalActivationCount() does not return a result with 2.4.0 Hi

I updated my application to 2.4.0 and with a real membership provider like MongoDB I see a few behaviors:

1. The dashboard does not show any results.

2. GetTotalActivationCount() returns 0

3. GetTotalActivationCount() something throws an exception:



I have pushed a small example to: https://github.com/OrleansContrib/OrleansDashboard/tree/mongo-example/Tests/TestHosts/TestHostWithMongoClustering",,benjaminpetit,,
5855,Cherry-pick #5838 for 2.4.1,"Added ClientMessagingOptions.LocalAddress to ignore ConfigUtilities.GetLocalIPAddress that automatic pickups network interfaces. (#5838)
","Cherry-pick #5838 for 2.4.1 Added ClientMessagingOptions.LocalAddress to ignore ConfigUtilities.GetLocalIPAddress that automatic pickups network interfaces. (#5838)
",,ReubenBond,,
5854,Cherry-picked fixes for 2.4.1,,Cherry-picked fixes for 2.4.1 ,,ReubenBond,,
5851,Massive GC when log debug is enabled,"We performing a load testing on Orleans 2.3.4 with 500000 unique grains.
We enabled log **level debug** after we stopped the load the silo suffer from high rate of GC that never stop.

Profiling the issue we saw 

![image](https://user-images.githubusercontent.com/13414515/62870447-5559d880-bd22-11e9-8055-b50df1f86bae.png)

I think it came from 
![image](https://user-images.githubusercontent.com/13414515/62870872-0bbdbd80-bd23-11e9-9de7-6db1d0478a25.png)



![image](https://user-images.githubusercontent.com/13414515/62870891-15dfbc00-bd23-11e9-812b-10452ad97002.png)



","Massive GC when log debug is enabled We performing a load testing on Orleans 2.3.4 with 500000 unique grains.
We enabled log **level debug** after we stopped the load the silo suffer from high rate of GC that never stop.

Profiling the issue we saw 

![image](https://user-images.githubusercontent.com/13414515/62870447-5559d880-bd22-11e9-8055-b50df1f86bae.png)

I think it came from 
![image](https://user-images.githubusercontent.com/13414515/62870872-0bbdbd80-bd23-11e9-9de7-6db1d0478a25.png)



![image](https://user-images.githubusercontent.com/13414515/62870891-15dfbc00-bd23-11e9-812b-10452ad97002.png)



",,sergeybykov,,
5849,[Question] How do I access the GrainService in the specified Silo?,"I have many silos with their own GrainService in my scenario. How do I access the GrainService in the specified Silo? So i can polling every GrainService in my clusters.

Any recommendations suggestions etc would be much appreciated.","[Question] How do I access the GrainService in the specified Silo? I have many silos with their own GrainService in my scenario. How do I access the GrainService in the specified Silo? So i can polling every GrainService in my clusters.

Any recommendations suggestions etc would be much appreciated.",question,sergeybykov,,
5847,IMembershipOracle not added to services in 2.4.0?,Doing a test-run upgrade to 2.4.0 and my health-check hosted service which is modeled partially off of the one in Samples\2.3 fails to resolve its dependency on  and things are working smoothly now. Would this be the suggested work around?,IMembershipOracle not added to services in 2.4.0? Doing a test-run upgrade to 2.4.0 and my health-check hosted service which is modeled partially off of the one in Samples\2.3 fails to resolve its dependency on  and things are working smoothly now. Would this be the suggested work around?,,ReubenBond,,
5846,Orleans doesn't build on Mac,"at commit c9fe1b4a5b9542b31922aa46709d4055e0c8a556 (latest) I cloned cd'ed to the dir and then brought in:
Microsoft.Orleans.Core.Abstractions
Microsoft.Orleans.CodeGenerator.MSBuild
Microsoft.Orleans.Server
Microsoft.Orleans.Client
...using nuget.
I then used ""nuget restore OrleansCrossPlatform.sln"" and then ""dotnet build OrleansCrossPlatform.sln"" - I get this error:

/usr/local/share/dotnet/sdk/2.2.300/NuGet.targets(2655): error MSB3202: The project file ""/Users/john/orleans/orleans/src/Azure/OrleansAzureUtils/OrleansAzureUtils.csproj"" was not found. [/Users/john/orleans/orleans/OrleansCrossPlatform.sln]

The error message speaks the truth - that file does not exist. How can I encourage it to show up? Did I not import something or is it a bad reference? How does one compile Orleans on a Mac?","Orleans doesn't build on Mac at commit c9fe1b4a5b9542b31922aa46709d4055e0c8a556 (latest) I cloned cd'ed to the dir and then brought in:
Microsoft.Orleans.Core.Abstractions
Microsoft.Orleans.CodeGenerator.MSBuild
Microsoft.Orleans.Server
Microsoft.Orleans.Client
...using nuget.
I then used ""nuget restore OrleansCrossPlatform.sln"" and then ""dotnet build OrleansCrossPlatform.sln"" - I get this error:

/usr/local/share/dotnet/sdk/2.2.300/NuGet.targets(2655): error MSB3202: The project file ""/Users/john/orleans/orleans/src/Azure/OrleansAzureUtils/OrleansAzureUtils.csproj"" was not found. [/Users/john/orleans/orleans/OrleansCrossPlatform.sln]

The error message speaks the truth - that file does not exist. How can I encourage it to show up? Did I not import something or is it a bad reference? How does one compile Orleans on a Mac?",,sergeybykov,,
5845,Fixes packaging of analyzers,"Fixes packaging of analyzers. Tested locally and works now.
![image](https://user-images.githubusercontent.com/7863439/62806758-645f4180-bafc-11e9-8e96-9477e9a6db0f.png)

Trick is to add assemblies in  is added when installed via package manager.

//cc @ReubenBond @bddckr
","Fixes packaging of analyzers Fixes packaging of analyzers. Tested locally and works now.
![image](https://user-images.githubusercontent.com/7863439/62806758-645f4180-bafc-11e9-8e96-9477e9a6db0f.png)

Trick is to add assemblies in  is added when installed via package manager.

//cc @ReubenBond @bddckr
",,ReubenBond,,
5844,Fix potential deadlock between Catalog and LocalGrainDirectory,"We've identified a potential silo deadlock:
* 

This PR is an attempt to fix that.","Fix potential deadlock between Catalog and LocalGrainDirectory We've identified a potential silo deadlock:
* 

This PR is an attempt to fix that.",,benjaminpetit,,
5843,not support on dotnet core 2.2?,"I make a demo  target platform dotnet core 2.2 but not build successfully. so I try the hello word  sample on 2.0it runs OK.but if I change the  target framework to 2.2 it  also build failed.
![image](https://user-images.githubusercontent.com/1329895/62770211-1bdc5f80-bacd-11e9-81fd-b699f99db7c1.png)


and I read sample there are  1.x2.02.12.3 but not get 2.2. so is that reason?","not support on dotnet core 2.2? I make a demo  target platform dotnet core 2.2 but not build successfully. so I try the hello word  sample on 2.0it runs OK.but if I change the  target framework to 2.2 it  also build failed.
![image](https://user-images.githubusercontent.com/1329895/62770211-1bdc5f80-bacd-11e9-81fd-b699f99db7c1.png)


and I read sample there are  1.x2.02.12.3 but not get 2.2. so is that reason?",,ReubenBond,,
5842,Call ProcessTableUpdate before GossipToOthers,,Call ProcessTableUpdate before GossipToOthers ,,ReubenBond,,
5840,NATS streaming provider,"Are there any implemantations of streaming provider for Orleans and NATS ?
","NATS streaming provider Are there any implemantations of streaming provider for Orleans and NATS ?
",,sergeybykov,,
5839,Firing same type of event from multiple streams with different providers does not respect fire and forget settings.,I am trying to broadcast the same event to multiple streams that have different  method provider name is not considered while fetching the extension class. So the extension class for the first one is cached and used for all other streams.,Firing same type of event from multiple streams with different providers does not respect fire and forget settings. I am trying to broadcast the same event to multiple streams that have different  method provider name is not considered while fetching the extension class. So the extension class for the first one is cached and used for all other streams.,,jason-bragg,,
5837,Cherry-pick #5691 (Add core tracing events) for 2.4.0,(cherry picked from commit a8abc360d572246a794cb14ff594656c275fe0e1),Cherry-pick #5691 (Add core tracing events) for 2.4.0 (cherry picked from commit a8abc360d572246a794cb14ff594656c275fe0e1),,ReubenBond,,
5835,Cherry-picked three more commits for 2.4.0,,Cherry-picked three more commits for 2.4.0 ,,ReubenBond,,
5833,Always log stack trace when a Task is enqueued for an invalid activation,,Always log stack trace when a Task is enqueued for an invalid activation ,,jason-bragg,,
5832,Stop background transaction processing when a grain deactivates,"Several parts of the transaction processing system rely on background workers for transaction servicing. For example there is a storage worker a lock worker and a confirmation worker.

When an activation terminates these workers must be made aware so that they can also gracefully terminate.

This PR is a follow-up to #5821 extending the termination to the storage worker & lock worker","Stop background transaction processing when a grain deactivates Several parts of the transaction processing system rely on background workers for transaction servicing. For example there is a storage worker a lock worker and a confirmation worker.

When an activation terminates these workers must be made aware so that they can also gracefully terminate.

This PR is a follow-up to #5821 extending the termination to the storage worker & lock worker",,jason-bragg,,
5831,Use simple await in Connection,Simple is best :),Use simple await in Connection Simple is best :),,benjaminpetit,,
5830,Use simple await in HostedClient.RunClientMessagePump,driveby,Use simple await in HostedClient.RunClientMessagePump driveby,,benjaminpetit,,
5829,Nulleble enum not serialized/deserialized (default serializer),"When contract which is returned from other silo has any nullable enum property deserialization fails in calling silo grain.

We have property 



What I found out in **BinaryTokenStreamReaderExtensinons** class method **ReadSpecifiedTypeHeader** does not have specified cast for nullable enum.

Orleans version 2.3.6.

","Nulleble enum not serialized/deserialized (default serializer) When contract which is returned from other silo has any nullable enum property deserialization fails in calling silo grain.

We have property 



What I found out in **BinaryTokenStreamReaderExtensinons** class method **ReadSpecifiedTypeHeader** does not have specified cast for nullable enum.

Orleans version 2.3.6.

",serialization,ReubenBond,,
5828,Do not log warnings for OneWay CacheInvalidation Rejection messages,We send  instead.,Do not log warnings for OneWay CacheInvalidation Rejection messages We send  instead.,,ReubenBond,,
5827,There are unresolved conflicts between different versions,"3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Configuration.Abstractions”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.DependencyInjection.Abstractions”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Hosting.Abstractions”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Logging”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Logging.Abstractions”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Options”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。","There are unresolved conflicts between different versions 3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Configuration.Abstractions”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.DependencyInjection.Abstractions”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Hosting.Abstractions”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Logging”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Logging.Abstractions”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。
3>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current\Bin\Microsoft.Common.CurrentVersion.targets(21065): warning MSB3277: 发现“Microsoft.Extensions.Options”的不同版本间存在无法解决的冲突。当日志详细信息设置为“详细”时，这些引用冲突将会在生成日志中列出。",,ReubenBond,,
5826,Is there an API-level document？,Hope to provide API-level documentation,Is there an API-level document？ Hope to provide API-level documentation,documentation,sergeybykov,,
5825,Reject failed activations and fix possible race condition,#NAME?,Reject failed activations and fix possible race condition - Add another terminal state for activation to reject messages when  state. All pending messages will be forwarded after the activation has been unregistered from the directory,,ReubenBond,,
5824,Support custom SiloAddress to Endpoint mapping,"Currently we determine the endpoint to connect to for a given SiloAddress by looking at its Endpoint property.

With the introduction of new networking APIs (Bedrock) we will support custom transports. Some of these transports may not use IPEndpoint (the type of SiloAddress.Endpoint). For example a transport may use Named Pipes or some other IPC mechanism or HTTPS or something built from a connection string.

Bedrock transports accept an endpoint using the abstract System.Net.Endpoint type. The idea behind this was that users could create any kind of transport and implement a custom Endpoint implementation for their application.

In order to ensure we can leverage an ecosystem of transports and connection middleware we should consider a customisation point for users to provide a translation between SiloAddress and the particular Endpoint type used by their transport.

I think it could be as simple as this:

","Support custom SiloAddress to Endpoint mapping Currently we determine the endpoint to connect to for a given SiloAddress by looking at its Endpoint property.

With the introduction of new networking APIs (Bedrock) we will support custom transports. Some of these transports may not use IPEndpoint (the type of SiloAddress.Endpoint). For example a transport may use Named Pipes or some other IPC mechanism or HTTPS or something built from a connection string.

Bedrock transports accept an endpoint using the abstract System.Net.Endpoint type. The idea behind this was that users could create any kind of transport and implement a custom Endpoint implementation for their application.

In order to ensure we can leverage an ecosystem of transports and connection middleware we should consider a customisation point for users to provide a translation between SiloAddress and the particular Endpoint type used by their transport.

I think it could be as simple as this:

",,ReubenBond,,
5822,Unable to invoke GrainService from Filter,"Hello!

From a a 

Can someone tell me if it is supported to invoke grain services from a filter? I know we can invoke grains but idk about grain services.

Thanks!","Unable to invoke GrainService from Filter Hello!

From a a 

Can someone tell me if it is supported to invoke grain services from a filter? I know we can invoke grains but idk about grain services.

Thanks!",,benjaminpetit,,
5821,Terminate ConfirmationWorker loop on deactivation,"An implicit assumption in the ConfirmationWorker (part of Transactions) was that async tasks would stop executing when a grain was deactivated. However since #5588 we are continuing to execute Tasks scheduled against deactivated grains.

This resulted in tasks continually being scheduled against a deactivated grain causing a significant amount of log noise.","Terminate ConfirmationWorker loop on deactivation An implicit assumption in the ConfirmationWorker (part of Transactions) was that async tasks would stop executing when a grain was deactivated. However since #5588 we are continuing to execute Tasks scheduled against deactivated grains.

This resulted in tasks continually being scheduled against a deactivated grain causing a significant amount of log noise.",,jason-bragg,,
5820,Cherry-picked simple fixes and improvements for 2.3.7,Improvement to cluster membership gossip aren't included here. They will be backported and submitted as a separate PR.,Cherry-picked simple fixes and improvements for 2.3.7 Improvement to cluster membership gossip aren't included here. They will be backported and submitted as a separate PR.,,benjaminpetit,,
5819,RegexStreamNamespacePredicate is not serializable,"When using RegexImplicitStreamSubscriptionAttribute I experienced the following exception  in RegexStreamNamespacePredicate:



Initially reported here: https://github.com/OrleansContrib/Orleankka/issues/159 but tracked down to Orleans codebase.","RegexStreamNamespacePredicate is not serializable When using RegexImplicitStreamSubscriptionAttribute I experienced the following exception  in RegexStreamNamespacePredicate:



Initially reported here: https://github.com/OrleansContrib/Orleankka/issues/159 but tracked down to Orleans codebase.",,ReubenBond,,
5818,Implementing a method in an interface which hides a method in a base interface will cause codegen errors which don't easily give in to human understanding,"kidding but having an interface like 

 package and the older one and the error mentions the id of the interface/method being a duplicate but the id cannot be found in codegen however thanks to @ReubenBond  I found that if you look at the line mentioned t he method will be there.

Double clicking in VS 2019 does not bring the codegen file up since it is in obj folder so you should know where it is to find it.

Best is to either have an analyzer not allowing methods hiding parent methods (since this is an error most of the times) or at least show an error with the method names involved. IMHO fixing this to generate correct code for it is not even required since almost always you don't want to do this in your interfaces","Implementing a method in an interface which hides a method in a base interface will cause codegen errors which don't easily give in to human understanding kidding but having an interface like 

 package and the older one and the error mentions the id of the interface/method being a duplicate but the id cannot be found in codegen however thanks to @ReubenBond  I found that if you look at the line mentioned t he method will be there.

Double clicking in VS 2019 does not bring the codegen file up since it is in obj folder so you should know where it is to find it.

Best is to either have an analyzer not allowing methods hiding parent methods (since this is an error most of the times) or at least show an error with the method names involved. IMHO fixing this to generate correct code for it is not even required since almost always you don't want to do this in your interfaces",codegen,ReubenBond,,
5804,Gossip status change on shutdown for SystemTargetBasedMembershipTable,This helps to improve stability in tests which involve shutdowns. Other membership providers already perform gossip (that's the normal path),Gossip status change on shutdown for SystemTargetBasedMembershipTable This helps to improve stability in tests which involve shutdowns. Other membership providers already perform gossip (that's the normal path),,benjaminpetit,,
5802,Support configurable supported roles in transactional state.,,Support configurable supported roles in transactional state. ,enhancement,ReubenBond,,
5801,SMS streams batch delivered fix,Fixed bug in SMS streams where events were not being delivered to batch observers.,SMS streams batch delivered fix Fixed bug in SMS streams where events were not being delivered to batch observers.,bug,sergeybykov,,
5800,Remove LocalSilo from MembershipTableSnapshot. Detect death in gossip,Follow-up to #5796,Remove LocalSilo from MembershipTableSnapshot. Detect death in gossip Follow-up to #5796,,benjaminpetit,,
5799,Improve codegen's .NET Core 3 compatibility,"Fixes #5793 using @ReubenBond 's instructions.

Successfully compiles a minimal netstandard2.0 project on Linux .NET Core 2.2 3.0 Preview 7 and a combination of the 2.
Previously this would fail on the 3.0 variant.","Improve codegen's .NET Core 3 compatibility Fixes #5793 using @ReubenBond 's instructions.

Successfully compiles a minimal netstandard2.0 project on Linux .NET Core 2.2 3.0 Preview 7 and a combination of the 2.
Previously this would fail on the 3.0 variant.",,ReubenBond,,
5797,How to structure Grains for fast loading of historical data?,"Hello and thanks for building such an incredible framework. I’m beginning the process of sorting out how to leverage Orleans in a major revision of a project that I work on and have several high level questions that I’m hoping to receive some guidance on so I can avoid starting down the wrong path. If there is a better place or way to ask these questions I’d be happy to change venues. Also since I feel that an example application to tie together some of these concepts would help me personally as well as other newcomers in the IoT space I am very interested in contributing an example/quick start once I have a solid path to head down.

The platform that I’m working on handles the dispatching of work to drivers with the complexity that it is a multi-tenant application so we need to ensure each organization’s data is exclusive to their users and tablets. We currently provide this by putting each tenant’s data in their own SQL DB that only their users have access to (every tenant has a connection string to the correct DB). The dispatchers are using a windows desktop back office application with a companion ReactJS web app for viewing realtime/historical locations and the drivers are using an Android tablet app. We currently tie this all together with a blend of RESTish (there’s some RPC endpoints in it too) WebAPI that makes heavy use of Azure Event Hubs for incoming data from the tablets (processing happens in windows services that are subscribed to the hubs something that we want to move to Orleans) uses SignalR for pushing realtime data to the browser and loads most things out of each tenant’s SQL DB (which are not all in the same datacenter as the API).

So now that the “what” of what I’m trying to improve is out of the way where I need help is how we’re going to best utilize Orleans to improve our API. Using Orleans for the basic activity of the application feels really straight forward (although perhaps I’m over simplifying it) in that we can easily assign a Job to a Driver and trigger a push notification to the Device that the driver is using. When data comes in from a Device we can use an Event Hub based stream to queue the processing of its data and push the new location to the web app in realtime with SignalR. The challenging part for me is how to structure all this so that historical data can be easily and quickly retrieved as well as avoid packing too much data into a single Grain.

An example of this is that dispatchers may want to see the path a driver traveled to get to a job. Currently we load that data from the tenant’s DB and I would assume that is still the best way to handle it since loading data for a single driver is relatively quick. Where performance becomes challenging is loading the location of all devices from a particular point in time. Would it be reasonable to have a  that returns a list of all devices with their last known location at that point in time? If so what is the recommendation for implementing something like that? Would it work to asyncly iterate through all the devices asking each of them to figure out where they where (there can be 100 - 1000ish devices per tenant)? We currently make this perform reasonably well by constantly building per-minute time windowed data for each tenant that is persisted separately so we can grab the time window that holds the locations we’re looking for. This is expensive from a storage standpoint so we trash the time windows after 7 days and queries for older data become slow. This feels like an area of our application that we should be able to improve with the power of Orleans but I’m struggling to come up with an architecture that feels like a winner (likely because my optics are based in the way we’ve already solved it). If the pre-calculated time windows are still the best bet is there an example out there of how to do this in Orleans (essentially a per-minute list of all the location changes for all devices belonging to a tenant). 

This question is getting too long so I’ll leave it rooted in the historical data persistence and retrieval for now and as I gain a better understanding of the Orleans way of accomplishing some of this I’ll drill into other challenging aspects of the application.

If there’s some documentation that I should be reading to help come up with a solution or an example that I should be referencing instead of asking for help please share and I’ll gladly keep trying to sort this out on my own. Thank you very much for your time!","How to structure Grains for fast loading of historical data? Hello and thanks for building such an incredible framework. I’m beginning the process of sorting out how to leverage Orleans in a major revision of a project that I work on and have several high level questions that I’m hoping to receive some guidance on so I can avoid starting down the wrong path. If there is a better place or way to ask these questions I’d be happy to change venues. Also since I feel that an example application to tie together some of these concepts would help me personally as well as other newcomers in the IoT space I am very interested in contributing an example/quick start once I have a solid path to head down.

The platform that I’m working on handles the dispatching of work to drivers with the complexity that it is a multi-tenant application so we need to ensure each organization’s data is exclusive to their users and tablets. We currently provide this by putting each tenant’s data in their own SQL DB that only their users have access to (every tenant has a connection string to the correct DB). The dispatchers are using a windows desktop back office application with a companion ReactJS web app for viewing realtime/historical locations and the drivers are using an Android tablet app. We currently tie this all together with a blend of RESTish (there’s some RPC endpoints in it too) WebAPI that makes heavy use of Azure Event Hubs for incoming data from the tablets (processing happens in windows services that are subscribed to the hubs something that we want to move to Orleans) uses SignalR for pushing realtime data to the browser and loads most things out of each tenant’s SQL DB (which are not all in the same datacenter as the API).

So now that the “what” of what I’m trying to improve is out of the way where I need help is how we’re going to best utilize Orleans to improve our API. Using Orleans for the basic activity of the application feels really straight forward (although perhaps I’m over simplifying it) in that we can easily assign a Job to a Driver and trigger a push notification to the Device that the driver is using. When data comes in from a Device we can use an Event Hub based stream to queue the processing of its data and push the new location to the web app in realtime with SignalR. The challenging part for me is how to structure all this so that historical data can be easily and quickly retrieved as well as avoid packing too much data into a single Grain.

An example of this is that dispatchers may want to see the path a driver traveled to get to a job. Currently we load that data from the tenant’s DB and I would assume that is still the best way to handle it since loading data for a single driver is relatively quick. Where performance becomes challenging is loading the location of all devices from a particular point in time. Would it be reasonable to have a  that returns a list of all devices with their last known location at that point in time? If so what is the recommendation for implementing something like that? Would it work to asyncly iterate through all the devices asking each of them to figure out where they where (there can be 100 - 1000ish devices per tenant)? We currently make this perform reasonably well by constantly building per-minute time windowed data for each tenant that is persisted separately so we can grab the time window that holds the locations we’re looking for. This is expensive from a storage standpoint so we trash the time windows after 7 days and queries for older data become slow. This feels like an area of our application that we should be able to improve with the power of Orleans but I’m struggling to come up with an architecture that feels like a winner (likely because my optics are based in the way we’ve already solved it). If the pre-calculated time windows are still the best bet is there an example out there of how to do this in Orleans (essentially a per-minute list of all the location changes for all devices belonging to a tenant). 

This question is getting too long so I’ll leave it rooted in the historical data persistence and retrieval for now and as I gain a better understanding of the Orleans way of accomplishing some of this I’ll drill into other challenging aspects of the application.

If there’s some documentation that I should be reading to help come up with a solution or an example that I should be referencing instead of asking for help please share and I’ll gladly keep trying to sort this out on my own. Thank you very much for your time!",question,sergeybykov,,
5796,Send a snapshot of the membership table on gossip,"Right now when a silo change a silo entry in the membership table it will ""gossip"" the new silo/status to other silos in the cluster. Since silos can miss notifications it's not safe for them to infer anything based on this information alone so they have to go to storage and refresh the all table.

In this PR now silo that has modified the membership table will send a full snapshot of it with the version number. This way other silos in the cluster can either ignore the gossip if they are already up-to-date (or ahead) or can simply use it directly without reading in the storage.

This should reduce the time of membership change propagation and reduce contention on the membership table.","Send a snapshot of the membership table on gossip Right now when a silo change a silo entry in the membership table it will ""gossip"" the new silo/status to other silos in the cluster. Since silos can miss notifications it's not safe for them to infer anything based on this information alone so they have to go to storage and refresh the all table.

In this PR now silo that has modified the membership table will send a full snapshot of it with the version number. This way other silos in the cluster can either ignore the gossip if they are already up-to-date (or ahead) or can simply use it directly without reading in the storage.

This should reduce the time of membership change propagation and reduce contention on the membership table.",,ReubenBond,,
5795,Calling Grain from StreamProvider throws Serialization Exception,"I am invoking a grain from within my stream provider to track incoming messages. This is working fine locally but _sometimes_ fails then running on multiple silos with the following errors:



The Message tracking grain:
https://github.com/jonathansant/Orleans.Streams.Utils/blob/master/Orleans.Streams.Utils/MessageTracking/MessageTrackingGrain.cs

I not doing any grain calls with HttpConnectionPoolManager so I'm not sure why it's trying to serialize an HttpConnectionPoolManager","Calling Grain from StreamProvider throws Serialization Exception I am invoking a grain from within my stream provider to track incoming messages. This is working fine locally but _sometimes_ fails then running on multiple silos with the following errors:



The Message tracking grain:
https://github.com/jonathansant/Orleans.Streams.Utils/blob/master/Orleans.Streams.Utils/MessageTracking/MessageTrackingGrain.cs

I not doing any grain calls with HttpConnectionPoolManager so I'm not sure why it's trying to serialize an HttpConnectionPoolManager",,ReubenBond,,
5793,MSBuild codegen failing when only .NET Core 3 preview SDK is available,"It would appear something is causing 

I've setup a reproduction case at https://github.com/Vhab/OrleansCodegenNetCore3

It's using docker as it's the easiest way to get a clean environment to test in.

It contains 3 images one with .NET Core 22 one with 3.0p7 and one with both.
The first and last one build fine but the one with only 3.0 fails.

The repo includes a readme with how to run the reproduction cases.","MSBuild codegen failing when only .NET Core 3 preview SDK is available It would appear something is causing 

I've setup a reproduction case at https://github.com/Vhab/OrleansCodegenNetCore3

It's using docker as it's the easiest way to get a clean environment to test in.

It contains 3 images one with .NET Core 22 one with 3.0p7 and one with both.
The first and last one build fine but the one with only 3.0 fails.

The repo includes a readme with how to run the reproduction cases.",,ReubenBond,,
5789,Mechanism to fetch all states from a grain (Like Select * from table),,Mechanism to fetch all states from a grain (Like Select * from table) ,question,sergeybykov,,
5782,Missing UsePerfCounterEnvironmentStatistics for SiloBuilder,There is currently no extension method . Is there a plan to add this method or a workaround? I can simulate with reflection but I'd rather not.,Missing UsePerfCounterEnvironmentStatistics for SiloBuilder There is currently no extension method . Is there a plan to add this method or a workaround? I can simulate with reflection but I'd rather not.,,ReubenBond,,
5781,Silo fail to start if have other active silos in membership table,"We've detected some unwanted behavior with single silo start after whole cluster fail unexpectedly.
We use SQL membership Provider and here is sample reproduce code:

.

I am aware of some similar issues #5463 #3009 and the behavior implemented in #3261 
But the problem is we cannot start other nodes - cluster should be self aware and self healing in this scenario. Also with this in mind we do now want to get unexpected errors when some silo got network split from other silos (but not the database).

Can you provide help with that? Can MembershipTable handle this OR we should implement it in our way?","Silo fail to start if have other active silos in membership table We've detected some unwanted behavior with single silo start after whole cluster fail unexpectedly.
We use SQL membership Provider and here is sample reproduce code:

.

I am aware of some similar issues #5463 #3009 and the behavior implemented in #3261 
But the problem is we cannot start other nodes - cluster should be self aware and self healing in this scenario. Also with this in mind we do now want to get unexpected errors when some silo got network split from other silos (but not the database).

Can you provide help with that? Can MembershipTable handle this OR we should implement it in our way?",,sergeybykov,,
5778,"Heterogeneous Silo and ""Cannot find an implementation class"" error","Hello
can't figure out what is wrong with my Orleans based solution. Please advise.
I have four projects:
1. ClientApi - webapi application references Orleans nugets and grain interfaces project;
2. GrainInterface - grains interfaces
3. Coordinator - silo references Orleans MSBuild nuget and grain interfaces project. Contains grains implementation.
4. DataAccessor - silo references Orleans MSBuild nuget and grain interfaces project. Contains grains implementation.
Now from the controller i'm getting grain reference for the grain which is hosted in Coordinator silo. It gets called. From withing that grain i'm trying to get grain reference (using GrainsFactory property) which is hosted in DataAccessor silo. And here i'm getting exception ""cannot find an implementation class..."". 

I've read all documentation and it seems that i don't need to do some additional configuration for this to work. All my silos configured with the code similar to this:

Here executingAssembly is the assembly of my console project with the grain implementations.","Heterogeneous Silo and ""Cannot find an implementation class"" error Hello
can't figure out what is wrong with my Orleans based solution. Please advise.
I have four projects:
1. ClientApi - webapi application references Orleans nugets and grain interfaces project;
2. GrainInterface - grains interfaces
3. Coordinator - silo references Orleans MSBuild nuget and grain interfaces project. Contains grains implementation.
4. DataAccessor - silo references Orleans MSBuild nuget and grain interfaces project. Contains grains implementation.
Now from the controller i'm getting grain reference for the grain which is hosted in Coordinator silo. It gets called. From withing that grain i'm trying to get grain reference (using GrainsFactory property) which is hosted in DataAccessor silo. And here i'm getting exception ""cannot find an implementation class..."". 

I've read all documentation and it seems that i don't need to do some additional configuration for this to work. All my silos configured with the code similar to this:

Here executingAssembly is the assembly of my console project with the grain implementations.",,benjaminpetit,,
5774,[Question] There is a way to call another Grain without waiting for the Task?,"For example I have to send SMS messages and I want to just call the sending method and without waiting for it to finish (and the result) continue to execute my code in the Grain process.
Is it possible to do?

 cs
....
var grain1 = GrainFactory.GetGrain<IGrain>(1);
_ = grain1.DoSome(); //skip await
var x = 1;
.....

","[Question] There is a way to call another Grain without waiting for the Task? For example I have to send SMS messages and I want to just call the sending method and without waiting for it to finish (and the result) continue to execute my code in the Grain process.
Is it possible to do?

 cs
....
var grain1 = GrainFactory.GetGrain<IGrain>(1);
_ = grain1.DoSome(); //skip await
var x = 1;
.....

",,sergeybykov,,
5772,F# support - discussion,"Following our discussion in #38 I've been thinking of possible problems we'll run into along the way. Here's a list (I'll elaborate on each one further below):

1. Orleans grains are defined via interfaces and classes. While F# supports OO-style code it's not what we love F# for. We'll need a functional way of creating grains. This should be the single most important goal of this effort IMO: no OO code in grains and as little as possible in other places.
2. Orleans uses constructor dependency injection. No OO means no constructors which means we need a functional way to inject dependencies.
3. The  into the grains and use that.

# 5. Code-gen

I haven't looked at the codegen sources yet but if my guess is right and it reads the compiled binaries this should be (relatively) simple to implement.

# 6. Calling grains

This really depends on the details of how grains are implemented so I'll leave it out for now.

# 7. Higher order functions

IIRC F# compiles each ""function"" to many subclasses of FSharpFunc one for each argument. We may very well be able to just serialize the resulting objects like any other POCO.

However careful thought must be given to this matter because any POCO's that travel over the wire need serialization code generated for them. We could generate code for all subclasses of FSharpFunc but I think it'll lead to an unacceptable increase in binary size specially since F# generates so many of them.

----------------

I'd love to know what everybody thinks about all of this.","F# support - discussion Following our discussion in #38 I've been thinking of possible problems we'll run into along the way. Here's a list (I'll elaborate on each one further below):

1. Orleans grains are defined via interfaces and classes. While F# supports OO-style code it's not what we love F# for. We'll need a functional way of creating grains. This should be the single most important goal of this effort IMO: no OO code in grains and as little as possible in other places.
2. Orleans uses constructor dependency injection. No OO means no constructors which means we need a functional way to inject dependencies.
3. The  into the grains and use that.

# 5. Code-gen

I haven't looked at the codegen sources yet but if my guess is right and it reads the compiled binaries this should be (relatively) simple to implement.

# 6. Calling grains

This really depends on the details of how grains are implemented so I'll leave it out for now.

# 7. Higher order functions

IIRC F# compiles each ""function"" to many subclasses of FSharpFunc one for each argument. We may very well be able to just serialize the resulting objects like any other POCO.

However careful thought must be given to this matter because any POCO's that travel over the wire need serialization code generated for them. We could generate code for all subclasses of FSharpFunc but I think it'll lead to an unacceptable increase in binary size specially since F# generates so many of them.

----------------

I'd love to know what everybody thinks about all of this.",,ReubenBond,,
5771,Upgrade System.Net.Http to 4.3.4,,Upgrade System.Net.Http to 4.3.4 ,,ReubenBond,,
5770,Remove options and logic for automatic resending of messages,"Resolves #5667.

Automatic message resend was a bad idea. We forgot to remove the logic in 2.0.","Remove options and logic for automatic resending of messages Resolves #5667.

Automatic message resend was a bad idea. We forgot to remove the logic in 2.0.",,ReubenBond,,
5769,Fix OnCompleteAsync & OnErrorAsync in StreamImpl,"Fixes #5697.
Fix NullRreferenceException thrown in OnCompletedAsync & OnErrorAsync.","Fix OnCompleteAsync & OnErrorAsync in StreamImpl Fixes #5697.
Fix NullRreferenceException thrown in OnCompletedAsync & OnErrorAsync.",,ReubenBond,,
5768,[Question]: Silo connection via bus.,"Hello tell me please is there a way to connect Silo nodes to a bus like Redis or Azure Queue?
I tried to use Azure AppService as hosting my .net core webapi application which also contains Silo but the AppService does not allow opening a private endpoint for Silo connections. 
And I wondered if it was possible to connect the nodes without a direct connection.","[Question]: Silo connection via bus. Hello tell me please is there a way to connect Silo nodes to a bus like Redis or Azure Queue?
I tried to use Azure AppService as hosting my .net core webapi application which also contains Silo but the AppService does not allow opening a private endpoint for Silo connections. 
And I wondered if it was possible to connect the nodes without a direct connection.",question,sergeybykov,,
5767,Passing an IEnumerable<Claim> to a grain method gives TypeAccessException,"I'm trying to store Identity user claims in a grain state. I'm passing it in as  state also throws the same error.

![image](https://user-images.githubusercontent.com/10301859/61506072-cdd4b000-a995-11e9-992c-a1be4787ba78.png)
","Passing an IEnumerable<Claim> to a grain method gives TypeAccessException I'm trying to store Identity user claims in a grain state. I'm passing it in as  state also throws the same error.

![image](https://user-images.githubusercontent.com/10301859/61506072-cdd4b000-a995-11e9-992c-a1be4787ba78.png)
",,ReubenBond,,
5765,Add locking support similar to Azure durable functions 2.0,"Add locking support similar to one described here https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-preview#locking-entities-from-orchestrations that I copy & pasted below

This would be really helpful for avoiding raced conditions and should scale better that going through single grain to achieve the same.

> Locking entities from orchestrations
Orchestrations can lock entities. This capability provides a simple way to prevent unwanted races by using critical sections.
>
> The context object provides the following methods:
>
> LockAsync: acquires locks on one or more entities.
IsLocked: returns true if currently in a critical section false otherwise.
The critical section ends and all locks are released when the orchestration ends. In .NET LockAsync returns an IDisposable that ends the critical section when disposed which can be used together with a using clause to get a syntactic representation of the critical section.
>
> For example consider an orchestration that needs to test whether two players are available and then assign them both to a game. This task can be implemented using a critical section as follows:


> Within the critical section both player entities are locked which means they are not executing any operations other than the ones that are called from within the critical section). This behavior prevents races with conflicting operations such as players being assigned to a different game or signing off.
>
> We impose several restrictions on how critical sections can be used. These restrictions serve to prevent deadlocks and reentrancy.
>
> Critical sections cannot be nested.
> Critical sections cannot create suborchestrations.
> Critical sections can call only entities they have locked.
> Critical sections cannot call the same entity using multiple parallel calls.
> Critical sections can signal only entities they have not locked.
","Add locking support similar to Azure durable functions 2.0 Add locking support similar to one described here https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-preview#locking-entities-from-orchestrations that I copy & pasted below

This would be really helpful for avoiding raced conditions and should scale better that going through single grain to achieve the same.

> Locking entities from orchestrations
Orchestrations can lock entities. This capability provides a simple way to prevent unwanted races by using critical sections.
>
> The context object provides the following methods:
>
> LockAsync: acquires locks on one or more entities.
IsLocked: returns true if currently in a critical section false otherwise.
The critical section ends and all locks are released when the orchestration ends. In .NET LockAsync returns an IDisposable that ends the critical section when disposed which can be used together with a using clause to get a syntactic representation of the critical section.
>
> For example consider an orchestration that needs to test whether two players are available and then assign them both to a game. This task can be implemented using a critical section as follows:


> Within the critical section both player entities are locked which means they are not executing any operations other than the ones that are called from within the critical section). This behavior prevents races with conflicting operations such as players being assigned to a different game or signing off.
>
> We impose several restrictions on how critical sections can be used. These restrictions serve to prevent deadlocks and reentrancy.
>
> Critical sections cannot be nested.
> Critical sections cannot create suborchestrations.
> Critical sections can call only entities they have locked.
> Critical sections cannot call the same entity using multiple parallel calls.
> Critical sections can signal only entities they have not locked.
",,sergeybykov,,
5760,Orleans.Client.Hosting - client integration into .net core generic hosting and controller DI,"With this on a IServiceCollection you can:

","Orleans.Client.Hosting - client integration into .net core generic hosting and controller DI With this on a IServiceCollection you can:

",,ReubenBond,,
5758,Client only with Generic Host Builder is asp.net core 3.0,"When using asp.net core 3.0 web api whats the best way to use the orleans builders for a client only to connect to a remote cluster - with DI etc on the Controller APIs for access? Is there something in the builder to configure just as a client?

   ","Client only with Generic Host Builder is asp.net core 3.0 When using asp.net core 3.0 web api whats the best way to use the orleans builders for a client only to connect to a remote cluster - with DI etc on the Controller APIs for access? Is there something in the builder to configure just as a client?

   ",enhancement,ReubenBond,,
5756,System.TimeoutException: Response did not arrive on time in 00:00:30 for message,"I Have 5 silo in a cluster .

the Error log

It seems the ping request from 86 to 88 is timeout And I saw a vote in  silo 88 membership Entry . the option of NumVotesForDeathDeclaration is 2 So the silo 88 would not be killed. 

 The member ping request from 86 to 88 is timeout  and  the request from 88 to 86 is timeout.  Other membership validations are normal . What happened to my orleans cluster ？
","System.TimeoutException: Response did not arrive on time in 00:00:30 for message I Have 5 silo in a cluster .

the Error log

It seems the ping request from 86 to 88 is timeout And I saw a vote in  silo 88 membership Entry . the option of NumVotesForDeathDeclaration is 2 So the silo 88 would not be killed. 

 The member ping request from 86 to 88 is timeout  and  the request from 88 to 86 is timeout.  Other membership validations are normal . What happened to my orleans cluster ？
",question,sergeybykov,,
5755,Stream nullref exception on shutdown,Orleans.Streams.*stg/4614814381842400150/de148396.EventHubStreamProvider arg2 (eventId): 103312 arg3 (eventName):  exception: System.NullReferenceException: Object reference not set to an instance of an object. at Orleans.ServiceBus.Providers.EventHubAdapterReceiver.<GetQueueMessagesAsync>d__22.MoveNext(),Stream nullref exception on shutdown Orleans.Streams.*stg/4614814381842400150/de148396.EventHubStreamProvider arg2 (eventId): 103312 arg3 (eventName):  exception: System.NullReferenceException: Object reference not set to an instance of an object. at Orleans.ServiceBus.Providers.EventHubAdapterReceiver.<GetQueueMessagesAsync>d__22.MoveNext(),bug,jason-bragg,,
5753,【Request Help】Orleans Error，there will be a small part of Grain can not request。,"Orleans  version：

Orleans has this error there will be a small part of Grain can not request。
I guess This error is grain loop request。

Orleans fail info：
![HN19MR@RU1) K776))2Y3UV](https://user-images.githubusercontent.com/28291464/61184643-c609c880-a682-11e9-8f2d-26577a522838.png)
","【Request Help】Orleans Error，there will be a small part of Grain can not request。 Orleans  version：

Orleans has this error there will be a small part of Grain can not request。
I guess This error is grain loop request。

Orleans fail info：
![HN19MR@RU1) K776))2Y3UV](https://user-images.githubusercontent.com/28291464/61184643-c609c880-a682-11e9-8f2d-26577a522838.png)
",,sergeybykov,,
5752,Stream queue balancing should not rely on silo names,Silo names should only be used for display purposes,Stream queue balancing should not rely on silo names Silo names should only be used for display purposes,,jason-bragg,,
5750,Get Guid of IGrainWithGuidCompoundKey in Grain,In the grain implementation code how can you get the actual Guid part of the key when using IGrainWithGuidCompoundKey?,Get Guid of IGrainWithGuidCompoundKey in Grain In the grain implementation code how can you get the actual Guid part of the key when using IGrainWithGuidCompoundKey?,question,sergeybykov,,
5748,[Question] Seems resource leak in StreamDictionary,"All  but I can't see any reference on it.

https://github.com/dotnet/orleans/blob/a8abc360d572246a794cb14ff594656c275fe0e1/src/Orleans.Core/Streams/Internal/StreamDirectory.cs#L50

Did I miss something?","[Question] Seems resource leak in StreamDictionary All  but I can't see any reference on it.

https://github.com/dotnet/orleans/blob/a8abc360d572246a794cb14ff594656c275fe0e1/src/Orleans.Core/Streams/Internal/StreamDirectory.cs#L50

Did I miss something?",,jason-bragg,,
5745,HostedClient - use a slim IClusterClient implementation,Instead of re-using  which was intended for use with external clients & performs a bunch of work which is not needed on the silo (eg connect/disconnect from the cluster).,HostedClient - use a slim IClusterClient implementation Instead of re-using  which was intended for use with external clients & performs a bunch of work which is not needed on the silo (eg connect/disconnect from the cluster).,,benjaminpetit,,
5740,WIP - Silo Service Placement,Add placement strategy to place services on specific silos using grains.  Should be able to replace system targets.,WIP - Silo Service Placement Add placement strategy to place services on specific silos using grains.  Should be able to replace system targets.,work-in-progress,jason-bragg,9/07/2019 10:35,24/07/2019 3:24
5738,Is it possible to use cockroachdb as grain storage?,"We are trying to evaluate if we could use Cockroachdb (https://www.cockroachlabs.com/) as persistence storage for grainstate. Followed the link https://dotnet.github.io/orleans/Documentation/grains/grain_persistence/index.html#configuring-igrainstorage-providers to set up the storage provider for Cockroach as postgresql. As per the instruction when I tried to execute the postgresql statements from https://github.com/dotnet/orleans/blob/master/src/AdoNet/Orleans.Persistence.AdoNet/PostgreSQL-Persistence.sql I am getting an error while creating Function. It appears that cockroachdb does not support creating custom Functions. 
Are there any workarounds? Is using cockroachdb as grain persistence feasible? Has anybody tried doing this? ","Is it possible to use cockroachdb as grain storage? We are trying to evaluate if we could use Cockroachdb (https://www.cockroachlabs.com/) as persistence storage for grainstate. Followed the link https://dotnet.github.io/orleans/Documentation/grains/grain_persistence/index.html#configuring-igrainstorage-providers to set up the storage provider for Cockroach as postgresql. As per the instruction when I tried to execute the postgresql statements from https://github.com/dotnet/orleans/blob/master/src/AdoNet/Orleans.Persistence.AdoNet/PostgreSQL-Persistence.sql I am getting an error while creating Function. It appears that cockroachdb does not support creating custom Functions. 
Are there any workarounds? Is using cockroachdb as grain persistence feasible? Has anybody tried doing this? ",,sergeybykov,,
5736,TimeoutException when OnDeactivateAsync call other deactivating grain,"There is an issue in our production system. When a grain is deactivating we want to call other grain to do its operations. But if the other grain is in deactivation state at the same time it seems the code came in deadlock (or something) and we got a timeout exception.
With the attached minimal sample code the issue can be reproduce.
[sample.zip](https://github.com/dotnet/orleans/files/3363091/sample.zip)
Our workaround is shift the collection ages' the grains.

Is it a bug or is there a better solution? 

Enviroment:
ubuntu 16.04
dotnet sdk 2.2.300
orleans 2.3.5
","TimeoutException when OnDeactivateAsync call other deactivating grain There is an issue in our production system. When a grain is deactivating we want to call other grain to do its operations. But if the other grain is in deactivation state at the same time it seems the code came in deadlock (or something) and we got a timeout exception.
With the attached minimal sample code the issue can be reproduce.
[sample.zip](https://github.com/dotnet/orleans/files/3363091/sample.zip)
Our workaround is shift the collection ages' the grains.

Is it a bug or is there a better solution? 

Enviroment:
ubuntu 16.04
dotnet sdk 2.2.300
orleans 2.3.5
",,sergeybykov,,
5735,Use nameof instead of magic string,,Use nameof instead of magic string ,,ReubenBond,,
5733,Enable membership table cleanup by default,,Enable membership table cleanup by default ,,benjaminpetit,,
5732,Could not find silo entry for silo xxxxxx in the table,,Could not find silo entry for silo xxxxxx in the table ,,ReubenBond,,
5731,Fix race introduced in membership,,Fix race introduced in membership ,,xiazen,,
5729,Disable ILBasedSerializer by default,In preparation for deletion in 3.0 (#5728). It's been deprecated for some time already.,Disable ILBasedSerializer by default In preparation for deletion in 3.0 (#5728). It's been deprecated for some time already.,serialization,ReubenBond,,
5728,Remove ILBasedSerializer,"* [ ] Remove 
* [ ] Update documentation","Remove ILBasedSerializer * [ ] Remove 
* [ ] Update documentation",serialization,ReubenBond,,
5726,TestCluster.Deploy - OrleansMessageRejectionException : Target silo S127.0.0.1:41081:0 is unavailable,"We have an issue where a test sometimes (~30% of the time) fails when deploying the TestCluster.

It only seems to happen on Linux (not on Windows).



Any idea what could cause this?","TestCluster.Deploy - OrleansMessageRejectionException : Target silo S127.0.0.1:41081:0 is unavailable We have an issue where a test sometimes (~30% of the time) fails when deploying the TestCluster.

It only seems to happen on Linux (not on Windows).



Any idea what could cause this?",,ReubenBond,,
5725,hot grain best way to do?,The grain is designed to obtain the tenant token. The token is from a third party and will be refreshed and updated every 2 hours. But there are more customers who visit a tenant token at the same time and may reach thousands. Is this hot grain? If so how to avoid it. Note that the token is not related to the customer and is only relevant to the tenant.,hot grain best way to do? The grain is designed to obtain the tenant token. The token is from a third party and will be refreshed and updated every 2 hours. But there are more customers who visit a tenant token at the same time and may reach thousands. Is this hot grain? If so how to avoid it. Note that the token is not related to the customer and is only relevant to the tenant.,question,ReubenBond,,
5724,DeploymentLoadPublisher: use silo lifecycle,Moving more components out of Silo.cs,DeploymentLoadPublisher: use silo lifecycle Moving more components out of Silo.cs,,jason-bragg,,
5723,Start ClusterHealthMonitor in Active instead of BecomeActive,,Start ClusterHealthMonitor in Active instead of BecomeActive ,,jason-bragg,,
5722,Start MembershipTableCleanupAgent in Active instead of RuntimeGrainServices,,Start MembershipTableCleanupAgent in Active instead of RuntimeGrainServices ,,jason-bragg,,
5721,Add validator for DevelopmentClusterMembershipOptions,,Add validator for DevelopmentClusterMembershipOptions ,,benjaminpetit,,
5720,Fix exception in LatestVersionSelector when there are no deployed versions of a grain,Also throw in GrainVersionStore when versioning is not enabled.,Fix exception in LatestVersionSelector when there are no deployed versions of a grain Also throw in GrainVersionStore when versioning is not enabled.,,benjaminpetit,,
5719,Skip flaky MessageTest_TtlUpdatedOnSerialization test,Opened #5718 to track,Skip flaky MessageTest_TtlUpdatedOnSerialization test Opened #5718 to track,,benjaminpetit,,
5718,Flaky test: MessageTest_TtlUpdatedOnSerialization,,Flaky test: MessageTest_TtlUpdatedOnSerialization ,test-issue,ReubenBond,27/06/2019 3:17,1/08/2019 1:24
5717,Fix AgentTests,I'm not sure how this test was passing but  isn't right.,Fix AgentTests I'm not sure how this test was passing but  isn't right.,,jason-bragg,,
5715,Dispose TestCluster after tests,,Dispose TestCluster after tests ,,jason-bragg,,
5714,Grain-based reminders: separate IReminderTable & IReminderTableGrain,"Currently grain-based reminders implementation does not have separation between the grain &  implementation.

This can cause issues during startup/shutdown when grain calls are not available.

This PR separates the two & adds checks to ensure that the implementation doesn't try to make grain calls until the silo is ready.","Grain-based reminders: separate IReminderTable & IReminderTableGrain Currently grain-based reminders implementation does not have separation between the grain &  implementation.

This can cause issues during startup/shutdown when grain calls are not available.

This PR separates the two & adds checks to ensure that the implementation doesn't try to make grain calls until the silo is ready.",,jason-bragg,,
5713,Remove concurrency cap for Xunit,"I noticed in some stack traces that Xunit was running tests under a .

Tests may behave differently (eg potentially hitting a deadlock) so this PR removes the limit by setting it to -1 for all test assemblies","Remove concurrency cap for Xunit I noticed in some stack traces that Xunit was running tests under a .

Tests may behave differently (eg potentially hitting a deadlock) so this PR removes the limit by setting it to -1 for all test assemblies",,benjaminpetit,,
5712,Minor client/silo teardown tweaks,"* Check for  to fix memory leak (apparent during long test runs)
* Don't await Terminated/Stopped tasks during shutdown (doing so could cause deadlocks)
","Minor client/silo teardown tweaks * Check for  to fix memory leak (apparent during long test runs)
* Don't await Terminated/Stopped tasks during shutdown (doing so could cause deadlocks)
",,jason-bragg,,
5711,Improve lifecycle logging,"Log lifecycle levels using stage names rather than numeric values.
Use structured logging","Improve lifecycle logging Log lifecycle levels using stage names rather than numeric values.
Use structured logging",,jason-bragg,,
5710,Fix CategoryDiscoverer first-chance exception while debugging,,Fix CategoryDiscoverer first-chance exception while debugging ,,xiazen,,
5709,I need to make the Orleans public but I was intercepted by the Orleans Gateway.,"I need to make the Orleans public but I was intercepted by the Orleans Gateway.
I am deploying with Kubernetes.

ERROR:


Is it my legacy configuration or other issues?","I need to make the Orleans public, but I was intercepted by the Orleans Gateway. I need to make the Orleans public but I was intercepted by the Orleans Gateway.
I am deploying with Kubernetes.

ERROR:


Is it my legacy configuration or other issues?",,ReubenBond,,
5706,Tests should have one category of BVT SlowBVT & Functional,"Currently there are at least 400 tests which are in both BVT & Functional categories. There is no need for an overlap: it just slows down test runs

Note: check to make sure no coverage is lost in Azure DevOps (i.e that build settings are correct to ensure all tests are being run once)","Tests should have one category of BVT, SlowBVT, & Functional Currently there are at least 400 tests which are in both BVT & Functional categories. There is no need for an overlap: it just slows down test runs

Note: check to make sure no coverage is lost in Azure DevOps (i.e that build settings are correct to ensure all tests are being run once)",,ReubenBond,,
5705,Remove FileLoggerProvider etc,We should rely on an existing providers for tests (eg [.,Remove FileLoggerProvider etc We should rely on an existing providers for tests (eg [.,,ReubenBond,,
5704,Add Analyzer/CodeGen error for invalid grain interface signatures,Grain interfaces do not support parameter modifiers such as  could be added to the code generator too),Add Analyzer/CodeGen error for invalid grain interface signatures Grain interfaces do not support parameter modifiers such as  could be added to the code generator too),Hacktoberfest,ReubenBond,,
5702,Remove ExpectedClusterSize & add MaxOperationBackoffTime,,Remove ExpectedClusterSize & add MaxOperationBackoffTime ,,jason-bragg,,
5701,LocalGrainDirectory: use membership snapshots,,LocalGrainDirectory: use membership snapshots ,,benjaminpetit,,
5700,Remove MarshalByRefObject base classes,We do not need any of our types to subclass . We should remove it.,Remove MarshalByRefObject base classes We do not need any of our types to subclass . We should remove it.,,ReubenBond,,
5698,OrleansMessageRejectionException after several days of operation,"Hi

I am getting the following exception during communication with the silos after days/weeks of operation:



I am running Orleans 2.3.1 with the Kubernetes membership provider. As far as I can tell the membership table looks fine. See the following output from the Kubernetes membership table:

<details>
<summary>Output from http://localhost:8001/apis/orleans.dot.net/v1/namespaces/utiliread/silos</summary>
<code>
{
apiVersion: ""orleans.dot.net/v1""
items: [
{
address: ""10.244.0.234""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297953238
hostname: ""samplestoresilo-789685bbf8-jr82w""
iAmAliveTime: ""2019-06-11T12:51:22.85686+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:47:24Z""
generation: 5
name: ""10.244.0.234-11111-297953238""
namespace: ""utiliread""
resourceVersion: ""12864801""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.234-11111-297953238""
uid: ""0fcf6520-8c47-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_98af8""
startTime: ""2019-06-11T12:47:19.705448+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.234:11111@297953238""
]
suspectingTimes: [
""2019-06-11 12:51:22.856 GMT""
]
}
{
address: ""10.244.0.31""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298204570
hostname: ""samplestoresilo-789685bbf8-lfsfh""
iAmAliveTime: ""2019-06-15T03:21:22.93462+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T10:36:21Z""
generation: 205
name: ""10.244.0.31-11111-298204570""
namespace: ""utiliread""
resourceVersion: ""13511808""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.31-11111-298204570""
uid: ""405ba26a-8e90-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_f66b5""
startTime: ""2019-06-14T10:36:11.8352878+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.31:11111@298265127""
]
suspectingTimes: [
""2019-06-15 03:25:39.923 GMT""
]
}
{
address: ""10.244.0.31""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298265127
hostname: ""samplestoresilo-789685bbf8-lfsfh""
iAmAliveTime: ""2019-06-15T06:55:41.8285384+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-15T03:25:41Z""
generation: 46
name: ""10.244.0.31-11111-298265127""
namespace: ""utiliread""
resourceVersion: ""13538472""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.31-11111-298265127""
uid: ""40ad2eda-8f1d-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_7f143""
startTime: ""2019-06-15T03:25:27.9318099+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.31:11111@298278017""
]
suspectingTimes: [
""2019-06-15 07:00:24.162 GMT""
]
}
{
address: ""10.244.0.31""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298278017
hostname: ""samplestoresilo-789685bbf8-lfsfh""
iAmAliveTime: ""2019-06-17T05:30:27.35304+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-15T07:00:25Z""
generation: 562
name: ""10.244.0.31-11111-298278017""
namespace: ""utiliread""
resourceVersion: ""13886747""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.31-11111-298278017""
uid: ""40480627-8f3b-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_9d6f1""
startTime: ""2019-06-15T07:00:18.8193208+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.31:11111@298445646""
]
suspectingTimes: [
""2019-06-17 05:34:17.329 GMT""
]
}
{
address: ""10.244.0.31""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298445646
hostname: ""samplestoresilo-789685bbf8-lfsfh""
iAmAliveTime: ""2019-06-17T06:21:58.2439994+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T05:34:18Z""
generation: 14
name: ""10.244.0.31-11111-298445646""
namespace: ""utiliread""
resourceVersion: ""13893211""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.31-11111-298445646""
uid: ""8d69e5fb-90c1-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_2a786""
startTime: ""2019-06-17T05:34:07.112329+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.31:11111@298445646""
]
suspectingTimes: [
""2019-06-17 06:21:58.243 GMT""
]
}
{
address: ""10.244.0.34""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298448522
hostname: ""samplestoresilo-789685bbf8-pgqwk""
iAmAliveTime: ""2019-06-17T06:35:17.2805579+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T06:22:08Z""
generation: 7
name: ""10.244.0.34-11111-298448522""
namespace: ""utiliread""
resourceVersion: ""13894934""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.34-11111-298448522""
uid: ""3bcd18f3-90c8-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_e353f""
startTime: ""2019-06-17T06:22:03.5232614+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.34:11111@298448522""
]
suspectingTimes: [
""2019-06-17 06:35:17.280 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298449319
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-17T10:00:23.0799904+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T06:35:22Z""
generation: 45
name: ""10.244.1.154-11111-298449319""
namespace: ""utiliread""
resourceVersion: ""13920813""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298449319""
uid: ""152d490b-90ca-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_4c64b""
startTime: ""2019-06-17T06:35:19.9434331+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298461715""
]
suspectingTimes: [
""2019-06-17 10:02:06.953 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298461715
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T03:22:08.9199231+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T10:02:08Z""
generation: 212
name: ""10.244.1.154-11111-298461715""
namespace: ""utiliread""
resourceVersion: ""14050880""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298461715""
uid: ""f78dfc21-90e6-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_54a84""
startTime: ""2019-06-17T10:01:56.2362073+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298524328""
]
suspectingTimes: [
""2019-06-18 03:25:36.779 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298524328
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T05:55:38.677627+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T03:25:38Z""
generation: 34
name: ""10.244.1.154-11111-298524328""
namespace: ""utiliread""
resourceVersion: ""14070212""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298524328""
uid: ""be0ba56a-9178-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_88ef9""
startTime: ""2019-06-18T03:25:29.5819737+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298533621""
]
suspectingTimes: [
""2019-06-18 06:00:26.021 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298533621
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T06:10:27.8475709+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:00:27Z""
generation: 6
name: ""10.244.1.154-11111-298533621""
namespace: ""utiliread""
resourceVersion: ""14071597""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298533621""
uid: ""5ec89b7c-918e-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_bb5f9""
startTime: ""2019-06-18T06:00:23.2734568+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298534256""
]
suspectingTimes: [
""2019-06-18 06:11:07.146 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298534256
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T06:11:09.0933573+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:11:08Z""
generation: 4
name: ""10.244.1.154-11111-298534256""
namespace: ""utiliread""
resourceVersion: ""14071951""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298534256""
uid: ""dcf5da2a-918f-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_b3a69""
startTime: ""2019-06-18T06:10:57.1670382+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298534403""
]
suspectingTimes: [
""2019-06-18 06:13:29.317 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298534403
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T13:08:31.0284391+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:13:30Z""
generation: 87
name: ""10.244.1.154-11111-298534403""
namespace: ""utiliread""
resourceVersion: ""14124653""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298534403""
uid: ""31a50780-9190-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_7663d""
startTime: ""2019-06-18T06:13:23.8449261+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298559580""
]
suspectingTimes: [
""2019-06-18 13:13:07.031 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298559580
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-19T03:23:08.9800777+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T13:13:08Z""
generation: 174
name: ""10.244.1.154-11111-298559580""
namespace: ""utiliread""
resourceVersion: ""14230789""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298559580""
uid: ""d0c4bdf8-91ca-11e9-aa92-b624a6412b81""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_006be""
startTime: ""2019-06-18T13:13:01.7666038+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298610721""
]
suspectingTimes: [
""2019-06-19 03:25:25.821 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298610721
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-19T14:40:27.7322395+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-19T03:25:27Z""
generation: 138
name: ""10.244.1.154-11111-298610721""
namespace: ""utiliread""
resourceVersion: ""14314879""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298610721""
uid: ""e1e3c381-9241-11e9-aa92-b624a6412b81""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_c9bcf""
startTime: ""2019-06-19T03:25:22.0894214+00:00""
status: ""active""
suspectingSilos: [ ]
suspectingTimes: [ ]
}
{
address: ""10.244.1.49""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297953233
hostname: ""samplestoresilo-789685bbf8-dn7hn""
iAmAliveTime: ""2019-06-11T12:51:22.1600234+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:47:18Z""
generation: 5
name: ""10.244.1.49-11111-297953233""
namespace: ""utiliread""
resourceVersion: ""12864798""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.49-11111-297953233""
uid: ""0bf6c32e-8c47-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_3a67b""
startTime: ""2019-06-11T12:47:14.5381316+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.49:11111@297953233""
]
suspectingTimes: [
""2019-06-11 12:51:22.160 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297953492
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-12T03:21:47.0337972+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:51:46Z""
generation: 178
name: ""10.244.1.50-11111-297953492""
namespace: ""utiliread""
resourceVersion: ""12973466""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-297953492""
uid: ""abccfa35-8c47-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_e0cf7""
startTime: ""2019-06-11T12:51:34.1855359+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298005922""
]
suspectingTimes: [
""2019-06-12 03:25:34.570 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298005922
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-13T05:50:36.4884219+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-12T03:25:35Z""
generation: 320
name: ""10.244.1.50-11111-298005922""
namespace: ""utiliread""
resourceVersion: ""13170881""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298005922""
uid: ""be260353-8cc1-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_deb91""
startTime: ""2019-06-12T03:25:23.0783201+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298101067""
]
suspectingTimes: [
""2019-06-13 05:51:18.571 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298101067
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-14T05:46:20.5745259+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-13T05:51:19Z""
generation: 291
name: ""10.244.1.50-11111-298101067""
namespace: ""utiliread""
resourceVersion: ""13350149""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298101067""
uid: ""4465a4b0-8d9f-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_37922""
startTime: ""2019-06-13T05:51:08.5638001+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298187359""
]
suspectingTimes: [
""2019-06-14 05:49:28.260 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298187359
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-14T05:49:30.0761174+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T05:49:29Z""
generation: 4
name: ""10.244.1.50-11111-298187359""
namespace: ""utiliread""
resourceVersion: ""13350467""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298187359""
uid: ""2d0bdd5e-8e68-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_5d535""
startTime: ""2019-06-14T05:49:20.4465402+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298187509""
]
suspectingTimes: [
""2019-06-14 05:51:54.323 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298187509
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-14T08:56:56.4780532+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T05:51:55Z""
generation: 41
name: ""10.244.1.50-11111-298187509""
namespace: ""utiliread""
resourceVersion: ""13374129""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298187509""
uid: ""84282e9c-8e68-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_aeb25""
startTime: ""2019-06-14T05:51:50.2501753+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298189383""
]
suspectingTimes: [
""2019-06-14 09:00:06.726 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298199055
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-14T10:36:05.5577063+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T09:04:22Z""
generation: 23
name: ""10.244.1.50-11111-298199055""
namespace: ""utiliread""
resourceVersion: ""13386257""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298199055""
uid: ""66792743-8e83-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_89d37""
startTime: ""2019-06-14T09:04:18.5051592+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298199055""
]
suspectingTimes: [
""2019-06-14 10:36:05.557 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298204573
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-15T06:56:20.0694468+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T10:36:19Z""
generation: 248
name: ""10.244.1.65-11111-298204573""
namespace: ""utiliread""
resourceVersion: ""13538262""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298204573""
uid: ""3eed6091-8e90-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_58e43""
startTime: ""2019-06-14T10:36:14.5063276+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298277926""
]
suspectingTimes: [
""2019-06-15 06:58:58.343 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298277926
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-16T03:24:00.3776894+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-15T06:58:59Z""
generation: 249
name: ""10.244.1.65-11111-298277926""
namespace: ""utiliread""
resourceVersion: ""13690932""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298277926""
uid: ""0d1cd86c-8f3b-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_b1981""
startTime: ""2019-06-15T06:58:46.8443562+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298351523""
]
suspectingTimes: [
""2019-06-16 03:25:28.541 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298351523
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-17T03:25:30.5223938+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-16T03:25:29Z""
generation: 292
name: ""10.244.1.65-11111-298351523""
namespace: ""utiliread""
resourceVersion: ""13870685""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298351523""
uid: ""6441284c-8fe6-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_1197b""
startTime: ""2019-06-16T03:25:23.7745601+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298437952""
]
suspectingTimes: [
""2019-06-17 03:26:05.642 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298437952
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-17T05:36:08.9606268+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T03:26:07Z""
generation: 30
name: ""10.244.1.65-11111-298437952""
namespace: ""utiliread""
resourceVersion: ""13887109""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298437952""
uid: ""a4dc70bb-90af-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_17bfd""
startTime: ""2019-06-17T03:25:54.123374+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298445814""
]
suspectingTimes: [
""2019-06-17 05:37:04.302 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298445814
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-17T06:21:57.3225468+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T05:37:05Z""
generation: 13
name: ""10.244.1.65-11111-298445814""
namespace: ""utiliread""
resourceVersion: ""13893205""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298445814""
uid: ""f0ecb190-90c1-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_b631b""
startTime: ""2019-06-17T05:36:55.1450547+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298445814""
]
suspectingTimes: [
""2019-06-17 06:21:57.322 GMT""
]
}
{
address: ""10.244.3.138""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297809187
hostname: ""samplestoresilo-789685bbf8-vpn2j""
iAmAliveTime: ""2019-06-11T12:16:33.5759148+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-09T20:46:32Z""
generation: 478
name: ""10.244.3.138-11111-297809187""
namespace: ""utiliread""
resourceVersion: ""12860746""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.138-11111-297809187""
uid: ""a9fdeca5-8af7-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_605a9""
startTime: ""2019-06-09T20:46:27.9033132+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.139:11111@297945020""
]
suspectingTimes: [
""2019-06-11 12:19:58.197 GMT""
]
}
{
address: ""10.244.3.138""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297951594
hostname: ""samplestoresilo-789685bbf8-vpn2j""
iAmAliveTime: ""2019-06-11T12:46:58.2604768+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:20:05Z""
generation: 10
name: ""10.244.3.138-11111-297951594""
namespace: ""utiliread""
resourceVersion: ""12864181""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.138-11111-297951594""
uid: ""3ed5b53c-8c43-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_7a1e3""
startTime: ""2019-06-11T12:19:55.2682603+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.138:11111@297951594""
]
suspectingTimes: [
""2019-06-11 12:46:58.260 GMT""
]
}
{
address: ""10.244.3.139""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297945020
hostname: ""samplestoresilo-789685bbf8-j79vv""
iAmAliveTime: ""2019-06-11T12:46:58.602482+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T10:30:33Z""
generation: 32
name: ""10.244.3.139-11111-297945020""
namespace: ""utiliread""
resourceVersion: ""12864183""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.139-11111-297945020""
uid: ""f17119d8-8c33-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_731a8""
startTime: ""2019-06-11T10:30:20.9634992+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.139:11111@297945020""
]
suspectingTimes: [
""2019-06-11 12:46:58.602 GMT""
]
}
{
address: ""10.244.3.49""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298448521
hostname: ""samplestoresilo-789685bbf8-qhx5k""
iAmAliveTime: ""2019-06-17T06:35:15.7397908+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T06:22:09Z""
generation: 7
name: ""10.244.3.49-11111-298448521""
namespace: ""utiliread""
resourceVersion: ""13894927""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.49-11111-298448521""
uid: ""3c465769-90c8-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_1d4d7""
startTime: ""2019-06-17T06:22:02.2849513+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.49:11111@298448521""
]
suspectingTimes: [
""2019-06-17 06:35:15.739 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297953490
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-13T05:46:36.0470946+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:51:34Z""
generation: 494
name: ""10.244.3.5-11111-297953490""
namespace: ""utiliread""
resourceVersion: ""13170890""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-297953490""
uid: ""a4d924e0-8c47-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_e3235""
startTime: ""2019-06-11T12:51:31.744242+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298101071""
]
suspectingTimes: [
""2019-06-13 05:51:20.012 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298101071
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-14T05:46:22.2347732+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-13T05:51:21Z""
generation: 291
name: ""10.244.3.5-11111-298101071""
namespace: ""utiliread""
resourceVersion: ""13350001""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-298101071""
uid: ""453b9e26-8d9f-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_a7115""
startTime: ""2019-06-13T05:51:12.6455421+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298187298""
]
suspectingTimes: [
""2019-06-14 05:48:24.687 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298187298
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-14T06:18:26.3476543+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T05:48:25Z""
generation: 10
name: ""10.244.3.5-11111-298187298""
namespace: ""utiliread""
resourceVersion: ""13354392""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-298187298""
uid: ""072c41ff-8e68-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_4e118""
startTime: ""2019-06-14T05:48:19.4318135+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298189383""
]
suspectingTimes: [
""2019-06-14 06:23:13.835 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298189383
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-14T09:13:15.5674791+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T06:23:15Z""
generation: 38
name: ""10.244.3.5-11111-298189383""
namespace: ""utiliread""
resourceVersion: ""13376471""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-298189383""
uid: ""e46cd148-8e6c-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_0c820""
startTime: ""2019-06-14T06:23:04.6723504+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298199055""
]
suspectingTimes: [
""2019-06-14 09:17:59.646 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298199872
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-14T10:36:05.2727163+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T09:18:03Z""
generation: 20
name: ""10.244.3.5-11111-298199872""
namespace: ""utiliread""
resourceVersion: ""13386255""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-298199872""
uid: ""502eb758-8e85-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_c3772""
startTime: ""2019-06-14T09:17:53.6756759+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298199872""
]
suspectingTimes: [
""2019-06-14 10:36:05.272 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298449319
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-17T12:45:23.9149361+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T06:35:23Z""
generation: 78
name: ""10.244.3.50-11111-298449319""
namespace: ""utiliread""
resourceVersion: ""13941238""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298449319""
uid: ""15bd49a5-90ca-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_18763""
startTime: ""2019-06-17T06:35:19.779006+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298471558""
]
suspectingTimes: [
""2019-06-17 12:46:07.108 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298471558
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-17T12:46:08.9262019+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T12:46:08Z""
generation: 4
name: ""10.244.3.50-11111-298471558""
namespace: ""utiliread""
resourceVersion: ""13941350""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298471558""
uid: ""e0c353a1-90fd-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_231cb""
startTime: ""2019-06-17T12:45:59.625527+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298461715""
]
suspectingTimes: [
""2019-06-17 12:46:52.007 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298471601
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T03:26:54.8059909+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T12:46:54Z""
generation: 179
name: ""10.244.3.50-11111-298471601""
namespace: ""utiliread""
resourceVersion: ""14051496""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298471601""
uid: ""fc15eacd-90fd-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_cfc3b""
startTime: ""2019-06-17T12:46:42.4281823+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298524614""
]
suspectingTimes: [
""2019-06-18 03:30:25.254 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298524614
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T06:00:26.9274781+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T03:30:26Z""
generation: 34
name: ""10.244.3.50-11111-298524614""
namespace: ""utiliread""
resourceVersion: ""14070512""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298524614""
uid: ""69e21b32-9179-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_10846""
startTime: ""2019-06-18T03:30:15.3304391+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298533755""
]
suspectingTimes: [
""2019-06-18 06:02:38.895 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298533755
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T06:07:40.6013731+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:02:40Z""
generation: 5
name: ""10.244.3.50-11111-298533755""
namespace: ""utiliread""
resourceVersion: ""14071796""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298533755""
uid: ""ae023bd6-918e-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_da2c7""
startTime: ""2019-06-18T06:02:36.4165997+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298534345""
]
suspectingTimes: [
""2019-06-18 06:12:28.624 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298534345
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T06:12:30.5140926+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:12:29Z""
generation: 4
name: ""10.244.3.50-11111-298534345""
namespace: ""utiliread""
resourceVersion: ""14072036""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298534345""
uid: ""0d79be8c-9190-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_c6383""
startTime: ""2019-06-18T06:12:26.1622084+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298534433""
]
suspectingTimes: [
""2019-06-18 06:14:00.960 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298534433
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T13:04:02.7106446+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:14:02Z""
generation: 86
name: ""10.244.3.50-11111-298534433""
namespace: ""utiliread""
resourceVersion: ""14123741""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298534433""
uid: ""447cb2a9-9190-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_33f55""
startTime: ""2019-06-18T06:13:54.0935096+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298534403""
]
suspectingTimes: [
""2019-06-18 13:06:08.353 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298559171
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T16:16:19.9360389+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T13:06:19Z""
generation: 42
name: ""10.244.3.50-11111-298559171""
namespace: ""utiliread""
resourceVersion: ""14147952""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298559171""
uid: ""dd0b98df-91c9-11e9-aa92-b624a6412b81""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_7d7a5""
startTime: ""2019-06-18T13:06:12.4847577+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298570827""
]
suspectingTimes: [
""2019-06-18 16:20:30.154 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298570827
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-19T14:40:32.2742356+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T16:20:31Z""
generation: 271
name: ""10.244.3.50-11111-298570827""
namespace: ""utiliread""
resourceVersion: ""14314890""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298570827""
uid: ""fe3bbb48-91e4-11e9-aa92-b624a6412b81""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_f0920""
startTime: ""2019-06-18T16:20:28.0531226+00:00""
status: ""active""
suspectingSilos: [ ]
suspectingTimes: [ ]
}
]
kind: ""OrleansSiloList""
metadata: {
continue: """"
resourceVersion: ""14315332""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos""
}
}
</code>
</details>

It shows that 10.",,,,,
"44.1.15""","OrleansMessageRejectionException after several days of operation Hi

I am getting the following exception during communication with the silos after days/weeks of operation:



I am running Orleans 2.3.1 with the Kubernetes membership provider. As far as I can tell the membership table looks fine. See the following output from the Kubernetes membership table:

<details>
<summary>Output from http://localhost:8001/apis/orleans.dot.net/v1/namespaces/utiliread/silos</summary>
<code>
{
apiVersion: ""orleans.dot.net/v1""
items: [
{
address: ""10.244.0.234""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297953238
hostname: ""samplestoresilo-789685bbf8-jr82w""
iAmAliveTime: ""2019-06-11T12:51:22.85686+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:47:24Z""
generation: 5
name: ""10.244.0.234-11111-297953238""
namespace: ""utiliread""
resourceVersion: ""12864801""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.234-11111-297953238""
uid: ""0fcf6520-8c47-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_98af8""
startTime: ""2019-06-11T12:47:19.705448+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.234:11111@297953238""
]
suspectingTimes: [
""2019-06-11 12:51:22.856 GMT""
]
}
{
address: ""10.244.0.31""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298204570
hostname: ""samplestoresilo-789685bbf8-lfsfh""
iAmAliveTime: ""2019-06-15T03:21:22.93462+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T10:36:21Z""
generation: 205
name: ""10.244.0.31-11111-298204570""
namespace: ""utiliread""
resourceVersion: ""13511808""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.31-11111-298204570""
uid: ""405ba26a-8e90-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_f66b5""
startTime: ""2019-06-14T10:36:11.8352878+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.31:11111@298265127""
]
suspectingTimes: [
""2019-06-15 03:25:39.923 GMT""
]
}
{
address: ""10.244.0.31""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298265127
hostname: ""samplestoresilo-789685bbf8-lfsfh""
iAmAliveTime: ""2019-06-15T06:55:41.8285384+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-15T03:25:41Z""
generation: 46
name: ""10.244.0.31-11111-298265127""
namespace: ""utiliread""
resourceVersion: ""13538472""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.31-11111-298265127""
uid: ""40ad2eda-8f1d-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_7f143""
startTime: ""2019-06-15T03:25:27.9318099+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.31:11111@298278017""
]
suspectingTimes: [
""2019-06-15 07:00:24.162 GMT""
]
}
{
address: ""10.244.0.31""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298278017
hostname: ""samplestoresilo-789685bbf8-lfsfh""
iAmAliveTime: ""2019-06-17T05:30:27.35304+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-15T07:00:25Z""
generation: 562
name: ""10.244.0.31-11111-298278017""
namespace: ""utiliread""
resourceVersion: ""13886747""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.31-11111-298278017""
uid: ""40480627-8f3b-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_9d6f1""
startTime: ""2019-06-15T07:00:18.8193208+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.31:11111@298445646""
]
suspectingTimes: [
""2019-06-17 05:34:17.329 GMT""
]
}
{
address: ""10.244.0.31""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298445646
hostname: ""samplestoresilo-789685bbf8-lfsfh""
iAmAliveTime: ""2019-06-17T06:21:58.2439994+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T05:34:18Z""
generation: 14
name: ""10.244.0.31-11111-298445646""
namespace: ""utiliread""
resourceVersion: ""13893211""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.31-11111-298445646""
uid: ""8d69e5fb-90c1-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_2a786""
startTime: ""2019-06-17T05:34:07.112329+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.31:11111@298445646""
]
suspectingTimes: [
""2019-06-17 06:21:58.243 GMT""
]
}
{
address: ""10.244.0.34""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298448522
hostname: ""samplestoresilo-789685bbf8-pgqwk""
iAmAliveTime: ""2019-06-17T06:35:17.2805579+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T06:22:08Z""
generation: 7
name: ""10.244.0.34-11111-298448522""
namespace: ""utiliread""
resourceVersion: ""13894934""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.0.34-11111-298448522""
uid: ""3bcd18f3-90c8-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_e353f""
startTime: ""2019-06-17T06:22:03.5232614+00:00""
status: ""dead""
suspectingSilos: [
""10.244.0.34:11111@298448522""
]
suspectingTimes: [
""2019-06-17 06:35:17.280 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298449319
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-17T10:00:23.0799904+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T06:35:22Z""
generation: 45
name: ""10.244.1.154-11111-298449319""
namespace: ""utiliread""
resourceVersion: ""13920813""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298449319""
uid: ""152d490b-90ca-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_4c64b""
startTime: ""2019-06-17T06:35:19.9434331+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298461715""
]
suspectingTimes: [
""2019-06-17 10:02:06.953 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298461715
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T03:22:08.9199231+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T10:02:08Z""
generation: 212
name: ""10.244.1.154-11111-298461715""
namespace: ""utiliread""
resourceVersion: ""14050880""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298461715""
uid: ""f78dfc21-90e6-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_54a84""
startTime: ""2019-06-17T10:01:56.2362073+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298524328""
]
suspectingTimes: [
""2019-06-18 03:25:36.779 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298524328
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T05:55:38.677627+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T03:25:38Z""
generation: 34
name: ""10.244.1.154-11111-298524328""
namespace: ""utiliread""
resourceVersion: ""14070212""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298524328""
uid: ""be0ba56a-9178-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_88ef9""
startTime: ""2019-06-18T03:25:29.5819737+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298533621""
]
suspectingTimes: [
""2019-06-18 06:00:26.021 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298533621
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T06:10:27.8475709+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:00:27Z""
generation: 6
name: ""10.244.1.154-11111-298533621""
namespace: ""utiliread""
resourceVersion: ""14071597""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298533621""
uid: ""5ec89b7c-918e-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_bb5f9""
startTime: ""2019-06-18T06:00:23.2734568+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298534256""
]
suspectingTimes: [
""2019-06-18 06:11:07.146 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298534256
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T06:11:09.0933573+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:11:08Z""
generation: 4
name: ""10.244.1.154-11111-298534256""
namespace: ""utiliread""
resourceVersion: ""14071951""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298534256""
uid: ""dcf5da2a-918f-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_b3a69""
startTime: ""2019-06-18T06:10:57.1670382+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298534403""
]
suspectingTimes: [
""2019-06-18 06:13:29.317 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298534403
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-18T13:08:31.0284391+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:13:30Z""
generation: 87
name: ""10.244.1.154-11111-298534403""
namespace: ""utiliread""
resourceVersion: ""14124653""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298534403""
uid: ""31a50780-9190-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_7663d""
startTime: ""2019-06-18T06:13:23.8449261+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298559580""
]
suspectingTimes: [
""2019-06-18 13:13:07.031 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298559580
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-19T03:23:08.9800777+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T13:13:08Z""
generation: 174
name: ""10.244.1.154-11111-298559580""
namespace: ""utiliread""
resourceVersion: ""14230789""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298559580""
uid: ""d0c4bdf8-91ca-11e9-aa92-b624a6412b81""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_006be""
startTime: ""2019-06-18T13:13:01.7666038+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298610721""
]
suspectingTimes: [
""2019-06-19 03:25:25.821 GMT""
]
}
{
address: ""10.244.1.154""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298610721
hostname: ""samplestoresilo-789685bbf8-ndjw2""
iAmAliveTime: ""2019-06-19T14:40:27.7322395+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-19T03:25:27Z""
generation: 138
name: ""10.244.1.154-11111-298610721""
namespace: ""utiliread""
resourceVersion: ""14314879""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.154-11111-298610721""
uid: ""e1e3c381-9241-11e9-aa92-b624a6412b81""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_c9bcf""
startTime: ""2019-06-19T03:25:22.0894214+00:00""
status: ""active""
suspectingSilos: [ ]
suspectingTimes: [ ]
}
{
address: ""10.244.1.49""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297953233
hostname: ""samplestoresilo-789685bbf8-dn7hn""
iAmAliveTime: ""2019-06-11T12:51:22.1600234+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:47:18Z""
generation: 5
name: ""10.244.1.49-11111-297953233""
namespace: ""utiliread""
resourceVersion: ""12864798""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.49-11111-297953233""
uid: ""0bf6c32e-8c47-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_3a67b""
startTime: ""2019-06-11T12:47:14.5381316+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.49:11111@297953233""
]
suspectingTimes: [
""2019-06-11 12:51:22.160 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297953492
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-12T03:21:47.0337972+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:51:46Z""
generation: 178
name: ""10.244.1.50-11111-297953492""
namespace: ""utiliread""
resourceVersion: ""12973466""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-297953492""
uid: ""abccfa35-8c47-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_e0cf7""
startTime: ""2019-06-11T12:51:34.1855359+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298005922""
]
suspectingTimes: [
""2019-06-12 03:25:34.570 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298005922
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-13T05:50:36.4884219+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-12T03:25:35Z""
generation: 320
name: ""10.244.1.50-11111-298005922""
namespace: ""utiliread""
resourceVersion: ""13170881""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298005922""
uid: ""be260353-8cc1-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_deb91""
startTime: ""2019-06-12T03:25:23.0783201+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298101067""
]
suspectingTimes: [
""2019-06-13 05:51:18.571 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298101067
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-14T05:46:20.5745259+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-13T05:51:19Z""
generation: 291
name: ""10.244.1.50-11111-298101067""
namespace: ""utiliread""
resourceVersion: ""13350149""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298101067""
uid: ""4465a4b0-8d9f-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_37922""
startTime: ""2019-06-13T05:51:08.5638001+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298187359""
]
suspectingTimes: [
""2019-06-14 05:49:28.260 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298187359
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-14T05:49:30.0761174+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T05:49:29Z""
generation: 4
name: ""10.244.1.50-11111-298187359""
namespace: ""utiliread""
resourceVersion: ""13350467""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298187359""
uid: ""2d0bdd5e-8e68-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_5d535""
startTime: ""2019-06-14T05:49:20.4465402+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298187509""
]
suspectingTimes: [
""2019-06-14 05:51:54.323 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298187509
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-14T08:56:56.4780532+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T05:51:55Z""
generation: 41
name: ""10.244.1.50-11111-298187509""
namespace: ""utiliread""
resourceVersion: ""13374129""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298187509""
uid: ""84282e9c-8e68-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_aeb25""
startTime: ""2019-06-14T05:51:50.2501753+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298189383""
]
suspectingTimes: [
""2019-06-14 09:00:06.726 GMT""
]
}
{
address: ""10.244.1.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298199055
hostname: ""samplestoresilo-789685bbf8-lnl8r""
iAmAliveTime: ""2019-06-14T10:36:05.5577063+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T09:04:22Z""
generation: 23
name: ""10.244.1.50-11111-298199055""
namespace: ""utiliread""
resourceVersion: ""13386257""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.50-11111-298199055""
uid: ""66792743-8e83-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_89d37""
startTime: ""2019-06-14T09:04:18.5051592+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298199055""
]
suspectingTimes: [
""2019-06-14 10:36:05.557 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298204573
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-15T06:56:20.0694468+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T10:36:19Z""
generation: 248
name: ""10.244.1.65-11111-298204573""
namespace: ""utiliread""
resourceVersion: ""13538262""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298204573""
uid: ""3eed6091-8e90-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_58e43""
startTime: ""2019-06-14T10:36:14.5063276+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298277926""
]
suspectingTimes: [
""2019-06-15 06:58:58.343 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298277926
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-16T03:24:00.3776894+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-15T06:58:59Z""
generation: 249
name: ""10.244.1.65-11111-298277926""
namespace: ""utiliread""
resourceVersion: ""13690932""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298277926""
uid: ""0d1cd86c-8f3b-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_b1981""
startTime: ""2019-06-15T06:58:46.8443562+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298351523""
]
suspectingTimes: [
""2019-06-16 03:25:28.541 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298351523
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-17T03:25:30.5223938+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-16T03:25:29Z""
generation: 292
name: ""10.244.1.65-11111-298351523""
namespace: ""utiliread""
resourceVersion: ""13870685""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298351523""
uid: ""6441284c-8fe6-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_1197b""
startTime: ""2019-06-16T03:25:23.7745601+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298437952""
]
suspectingTimes: [
""2019-06-17 03:26:05.642 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298437952
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-17T05:36:08.9606268+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T03:26:07Z""
generation: 30
name: ""10.244.1.65-11111-298437952""
namespace: ""utiliread""
resourceVersion: ""13887109""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298437952""
uid: ""a4dc70bb-90af-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_17bfd""
startTime: ""2019-06-17T03:25:54.123374+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298445814""
]
suspectingTimes: [
""2019-06-17 05:37:04.302 GMT""
]
}
{
address: ""10.244.1.65""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298445814
hostname: ""samplestoresilo-789685bbf8-hwvqz""
iAmAliveTime: ""2019-06-17T06:21:57.3225468+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T05:37:05Z""
generation: 13
name: ""10.244.1.65-11111-298445814""
namespace: ""utiliread""
resourceVersion: ""13893205""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.1.65-11111-298445814""
uid: ""f0ecb190-90c1-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_b631b""
startTime: ""2019-06-17T05:36:55.1450547+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.65:11111@298445814""
]
suspectingTimes: [
""2019-06-17 06:21:57.322 GMT""
]
}
{
address: ""10.244.3.138""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297809187
hostname: ""samplestoresilo-789685bbf8-vpn2j""
iAmAliveTime: ""2019-06-11T12:16:33.5759148+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-09T20:46:32Z""
generation: 478
name: ""10.244.3.138-11111-297809187""
namespace: ""utiliread""
resourceVersion: ""12860746""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.138-11111-297809187""
uid: ""a9fdeca5-8af7-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_605a9""
startTime: ""2019-06-09T20:46:27.9033132+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.139:11111@297945020""
]
suspectingTimes: [
""2019-06-11 12:19:58.197 GMT""
]
}
{
address: ""10.244.3.138""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297951594
hostname: ""samplestoresilo-789685bbf8-vpn2j""
iAmAliveTime: ""2019-06-11T12:46:58.2604768+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:20:05Z""
generation: 10
name: ""10.244.3.138-11111-297951594""
namespace: ""utiliread""
resourceVersion: ""12864181""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.138-11111-297951594""
uid: ""3ed5b53c-8c43-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_7a1e3""
startTime: ""2019-06-11T12:19:55.2682603+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.138:11111@297951594""
]
suspectingTimes: [
""2019-06-11 12:46:58.260 GMT""
]
}
{
address: ""10.244.3.139""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297945020
hostname: ""samplestoresilo-789685bbf8-j79vv""
iAmAliveTime: ""2019-06-11T12:46:58.602482+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T10:30:33Z""
generation: 32
name: ""10.244.3.139-11111-297945020""
namespace: ""utiliread""
resourceVersion: ""12864183""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.139-11111-297945020""
uid: ""f17119d8-8c33-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_731a8""
startTime: ""2019-06-11T10:30:20.9634992+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.139:11111@297945020""
]
suspectingTimes: [
""2019-06-11 12:46:58.602 GMT""
]
}
{
address: ""10.244.3.49""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298448521
hostname: ""samplestoresilo-789685bbf8-qhx5k""
iAmAliveTime: ""2019-06-17T06:35:15.7397908+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T06:22:09Z""
generation: 7
name: ""10.244.3.49-11111-298448521""
namespace: ""utiliread""
resourceVersion: ""13894927""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.49-11111-298448521""
uid: ""3c465769-90c8-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_1d4d7""
startTime: ""2019-06-17T06:22:02.2849513+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.49:11111@298448521""
]
suspectingTimes: [
""2019-06-17 06:35:15.739 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 297953490
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-13T05:46:36.0470946+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-11T12:51:34Z""
generation: 494
name: ""10.244.3.5-11111-297953490""
namespace: ""utiliread""
resourceVersion: ""13170890""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-297953490""
uid: ""a4d924e0-8c47-11e9-b397-36480728ca93""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_e3235""
startTime: ""2019-06-11T12:51:31.744242+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298101071""
]
suspectingTimes: [
""2019-06-13 05:51:20.012 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298101071
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-14T05:46:22.2347732+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-13T05:51:21Z""
generation: 291
name: ""10.244.3.5-11111-298101071""
namespace: ""utiliread""
resourceVersion: ""13350001""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-298101071""
uid: ""453b9e26-8d9f-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_a7115""
startTime: ""2019-06-13T05:51:12.6455421+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298187298""
]
suspectingTimes: [
""2019-06-14 05:48:24.687 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298187298
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-14T06:18:26.3476543+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T05:48:25Z""
generation: 10
name: ""10.244.3.5-11111-298187298""
namespace: ""utiliread""
resourceVersion: ""13354392""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-298187298""
uid: ""072c41ff-8e68-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_4e118""
startTime: ""2019-06-14T05:48:19.4318135+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298189383""
]
suspectingTimes: [
""2019-06-14 06:23:13.835 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298189383
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-14T09:13:15.5674791+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T06:23:15Z""
generation: 38
name: ""10.244.3.5-11111-298189383""
namespace: ""utiliread""
resourceVersion: ""13376471""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-298189383""
uid: ""e46cd148-8e6c-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_0c820""
startTime: ""2019-06-14T06:23:04.6723504+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.50:11111@298199055""
]
suspectingTimes: [
""2019-06-14 09:17:59.646 GMT""
]
}
{
address: ""10.244.3.5""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298199872
hostname: ""samplestoresilo-789685bbf8-mg6kv""
iAmAliveTime: ""2019-06-14T10:36:05.2727163+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-14T09:18:03Z""
generation: 20
name: ""10.244.3.5-11111-298199872""
namespace: ""utiliread""
resourceVersion: ""13386255""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.5-11111-298199872""
uid: ""502eb758-8e85-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_c3772""
startTime: ""2019-06-14T09:17:53.6756759+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.5:11111@298199872""
]
suspectingTimes: [
""2019-06-14 10:36:05.272 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298449319
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-17T12:45:23.9149361+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T06:35:23Z""
generation: 78
name: ""10.244.3.50-11111-298449319""
namespace: ""utiliread""
resourceVersion: ""13941238""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298449319""
uid: ""15bd49a5-90ca-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_18763""
startTime: ""2019-06-17T06:35:19.779006+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298471558""
]
suspectingTimes: [
""2019-06-17 12:46:07.108 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298471558
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-17T12:46:08.9262019+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T12:46:08Z""
generation: 4
name: ""10.244.3.50-11111-298471558""
namespace: ""utiliread""
resourceVersion: ""13941350""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298471558""
uid: ""e0c353a1-90fd-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_231cb""
startTime: ""2019-06-17T12:45:59.625527+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298461715""
]
suspectingTimes: [
""2019-06-17 12:46:52.007 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298471601
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T03:26:54.8059909+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-17T12:46:54Z""
generation: 179
name: ""10.244.3.50-11111-298471601""
namespace: ""utiliread""
resourceVersion: ""14051496""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298471601""
uid: ""fc15eacd-90fd-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_cfc3b""
startTime: ""2019-06-17T12:46:42.4281823+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298524614""
]
suspectingTimes: [
""2019-06-18 03:30:25.254 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298524614
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T06:00:26.9274781+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T03:30:26Z""
generation: 34
name: ""10.244.3.50-11111-298524614""
namespace: ""utiliread""
resourceVersion: ""14070512""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298524614""
uid: ""69e21b32-9179-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_10846""
startTime: ""2019-06-18T03:30:15.3304391+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298533755""
]
suspectingTimes: [
""2019-06-18 06:02:38.895 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298533755
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T06:07:40.6013731+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:02:40Z""
generation: 5
name: ""10.244.3.50-11111-298533755""
namespace: ""utiliread""
resourceVersion: ""14071796""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298533755""
uid: ""ae023bd6-918e-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_da2c7""
startTime: ""2019-06-18T06:02:36.4165997+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298534345""
]
suspectingTimes: [
""2019-06-18 06:12:28.624 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298534345
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T06:12:30.5140926+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:12:29Z""
generation: 4
name: ""10.244.3.50-11111-298534345""
namespace: ""utiliread""
resourceVersion: ""14072036""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298534345""
uid: ""0d79be8c-9190-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_c6383""
startTime: ""2019-06-18T06:12:26.1622084+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298534433""
]
suspectingTimes: [
""2019-06-18 06:14:00.960 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298534433
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T13:04:02.7106446+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T06:14:02Z""
generation: 86
name: ""10.244.3.50-11111-298534433""
namespace: ""utiliread""
resourceVersion: ""14123741""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298534433""
uid: ""447cb2a9-9190-11e9-979b-b60b76c42098""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_33f55""
startTime: ""2019-06-18T06:13:54.0935096+00:00""
status: ""dead""
suspectingSilos: [
""10.244.1.154:11111@298534403""
]
suspectingTimes: [
""2019-06-18 13:06:08.353 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298559171
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-18T16:16:19.9360389+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T13:06:19Z""
generation: 42
name: ""10.244.3.50-11111-298559171""
namespace: ""utiliread""
resourceVersion: ""14147952""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298559171""
uid: ""dd0b98df-91c9-11e9-aa92-b624a6412b81""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_7d7a5""
startTime: ""2019-06-18T13:06:12.4847577+00:00""
status: ""dead""
suspectingSilos: [
""10.244.3.50:11111@298570827""
]
suspectingTimes: [
""2019-06-18 16:20:30.154 GMT""
]
}
{
address: ""10.244.3.50""
apiVersion: ""orleans.dot.net/v1""
clusterId: ""samplestore""
generation: 298570827
hostname: ""samplestoresilo-789685bbf8-gxqxc""
iAmAliveTime: ""2019-06-19T14:40:32.2742356+00:00""
kind: ""OrleansSilo""
metadata: {
creationTimestamp: ""2019-06-18T16:20:31Z""
generation: 271
name: ""10.244.3.50-11111-298570827""
namespace: ""utiliread""
resourceVersion: ""14314890""
selfLink: ""/apis/orleans.dot.net/v1/namespaces/utiliread/silos/10.244.3.50-11111-298570827""
uid: ""fe3bbb48-91e4-11e9-aa92-b624a6412b81""
}
port: 11111
proxyPort: 30000
siloName: ""Silo_f0920""
startTime: ""2019-06-18T16:20:28.0531226+00:00""
status: ""active""
suspectingSilos: [ ]
suspectingTimes: [ ]
}
]
kind: ""OrleansSiloList""
metadata: {
continue: """"
resourceVersion: ""14315332""
selfLink: ""/apis/orleans.dot.net/v1/name",,,,,,
"paces/u""",,sergeybykov,,,,,
5697,NullReferenceException on Stream Client when Calling OnCompletedAsync,"When a Stream client calls  I get a NullReferenceException.  A minimal repro is provided in the attached zip
[OrleansSample.zip](https://github.com/dotnet/orleans/files/3306576/OrleansSample.zip)
","NullReferenceException on Stream Client when Calling OnCompletedAsync When a Stream client calls  I get a NullReferenceException.  A minimal repro is provided in the attached zip
[OrleansSample.zip](https://github.com/dotnet/orleans/files/3306576/OrleansSample.zip)
",,jason-bragg,,
5696,What does the ClusterOption.ServiceId actually do?,"I have one cluster with two silo services (A and B). I build a client with options.ServiceId= ""A"". With this client I find I can get the grain in the Service B to invoke the services B's method.
So is that the right behavior? If that what does serviceid option actually do? 
I read the doc and source code but I still cannot get through.  
Anyone can help to give an clear explanation? Thanks very much.


>Orleans clustering information
    [...]
    // Clustering information
    .Configure<ClusterOptions>(options =>
    {
        options.ClusterId = ""my-first-cluster"";
        options.ServiceId = ""AspNetSampleApp"";
    })
    [...]
>Here we do two things:
Set the ClusterId to ""my-first-cluster"": this is a unique ID for the Orleans cluster. All clients and silos that use this ID will be able to talk directly to each other. You can choose to use a different ClusterId for different deployments though.
Set the ServiceId to ""AspNetSampleApp"": this is a unique ID for your application that will be used by some providers such as persistence providers. This ID should remain stable and not change across deployments.

*PS: English is not my native language; please excuse typing errors.*
","What does the ClusterOption.ServiceId actually do? I have one cluster with two silo services (A and B). I build a client with options.ServiceId= ""A"". With this client I find I can get the grain in the Service B to invoke the services B's method.
So is that the right behavior? If that what does serviceid option actually do? 
I read the doc and source code but I still cannot get through.  
Anyone can help to give an clear explanation? Thanks very much.


>Orleans clustering information
    [...]
    // Clustering information
    .Configure<ClusterOptions>(options =>
    {
        options.ClusterId = ""my-first-cluster"";
        options.ServiceId = ""AspNetSampleApp"";
    })
    [...]
>Here we do two things:
Set the ClusterId to ""my-first-cluster"": this is a unique ID for the Orleans cluster. All clients and silos that use this ID will be able to talk directly to each other. You can choose to use a different ClusterId for different deployments though.
Set the ServiceId to ""AspNetSampleApp"": this is a unique ID for your application that will be used by some providers such as persistence providers. This ID should remain stable and not change across deployments.

*PS: English is not my native language; please excuse typing errors.*
",documentation,ReubenBond,,
5694,ClusterClient: only call IRuntimeClient.Reset for OutsideRuntimeClient,Fixes some benign exceptions during shutdown now that ClusterClient is also used on silos,ClusterClient: only call IRuntimeClient.Reset for OutsideRuntimeClient Fixes some benign exceptions during shutdown now that ClusterClient is also used on silos,,jason-bragg,,
5692,Is Orleans Transactions ready for production?,"So far after using it full scale for 4 weeks it feels like Orleans transactions still have ways to go and it's not ready for production. We have been getting constant issues as described in #5644 and even after designing our implementation away from ""multiple calls to the same grain within the same transaction"" we are still getting issues with broken lock exceptions.
In fact while running tests the failure seems to cascade to other transactions as well causing all the tests to fail. It will be good to perhaps document the limitations of transactions as well as techniques to prevent broken lock exceptions or deadlocks","Is Orleans Transactions ready for production? So far after using it full scale for 4 weeks it feels like Orleans transactions still have ways to go and it's not ready for production. We have been getting constant issues as described in #5644 and even after designing our implementation away from ""multiple calls to the same grain within the same transaction"" we are still getting issues with broken lock exceptions.
In fact while running tests the failure seems to cascade to other transactions as well causing all the tests to fail. It will be good to perhaps document the limitations of transactions as well as techniques to prevent broken lock exceptions or deadlocks",,xiazen,,
5691,Add core tracing events,Adding core tracing events for application layer grain requests. ,Add core tracing events Adding core tracing events for application layer grain requests. ,,ReubenBond,,
5690,Cherry-pick #5473 for 2.3.5,Fix #5473 - codegen fails on recursively defined types (#5688),Cherry-pick #5473 for 2.3.5 Fix #5473 - codegen fails on recursively defined types (#5688),,ReubenBond,,
5689,CodeGenerator: skip empty projects,Fixes #5678,CodeGenerator: skip empty projects Fixes #5678,,xiazen,,
5687,When shutting down a silo new grain is activated on another silo before the old has finished deactivating.,"Setup:

3 silos running on separate EC2 instances in docker
3 frontend servers

Load test client generating a minor load (~100 grains per silo ~1-2 messages per second)

Grain is activated on Silo1
Silo1 is shut down

Log message timestamps (filtered by the id of this player's grain):

17:15:48.770 silo-2 message indicating the grain has been activated (error message that indicates that the state is not what we expect it to be meaning this state is out of date)
17:15:49.575 silo-1 message indicating grain is being shut down
17:15:49.585 silo-1 message indicating state is written to the database
17:15:52.831 silo-1 message indicating the graceful shutdown of the silohost has completed

The occurence rate is about 1-2% of grains under mild load. This is obviously a massive issue because the state gets corrupted as the flush in silo-1 doesn't complete before silo-2 claims ownership of the data.

Is there any potential setup error that can cause this? 
","When shutting down a silo, new grain is activated on another silo before the old has finished deactivating. Setup:

3 silos running on separate EC2 instances in docker
3 frontend servers

Load test client generating a minor load (~100 grains per silo ~1-2 messages per second)

Grain is activated on Silo1
Silo1 is shut down

Log message timestamps (filtered by the id of this player's grain):

17:15:48.770 silo-2 message indicating the grain has been activated (error message that indicates that the state is not what we expect it to be meaning this state is out of date)
17:15:49.575 silo-1 message indicating grain is being shut down
17:15:49.585 silo-1 message indicating state is written to the database
17:15:52.831 silo-1 message indicating the graceful shutdown of the silohost has completed

The occurence rate is about 1-2% of grains under mild load. This is obviously a massive issue because the state gets corrupted as the flush in silo-1 doesn't complete before silo-2 claims ownership of the data.

Is there any potential setup error that can cause this? 
",bug,benjaminpetit,,
5686,Json serialization references wrong ordering,Using Json serialization when you have multiple references to the same object usually creates a graph such that the first time an object is encountered it has the properties and an ,"Json serialization, references, wrong ordering Using Json serialization when you have multiple references to the same object usually creates a graph such that the first time an object is encountered it has the properties and an ",,sergeybykov,,
5685,Microsoft.Extensions.Hosting.IHostBuilder and Orleans.Hosting.ISiloHostBuilder merge,"Microsoft.Extensions.Hosting.IHostBuilder and Orleans.Hosting.ISiloHostBuilder now have many of the same places.
example:
Microsoft.Extensions.Hosting.HostBuilderContext and Orleans.Hosting.HostBuilderContext
Microsoft.Extensions.Hosting.IHostingEnvironment and Orleans.Hosting.IHostingEnvironment

Can these be merged or all use Microsoft.Extensions.Hosting?","Microsoft.Extensions.Hosting.IHostBuilder and Orleans.Hosting.ISiloHostBuilder merge Microsoft.Extensions.Hosting.IHostBuilder and Orleans.Hosting.ISiloHostBuilder now have many of the same places.
example:
Microsoft.Extensions.Hosting.HostBuilderContext and Orleans.Hosting.HostBuilderContext
Microsoft.Extensions.Hosting.IHostingEnvironment and Orleans.Hosting.IHostingEnvironment

Can these be merged or all use Microsoft.Extensions.Hosting?",,ReubenBond,,
5683,[Question] ClientBuilder and GenericHost,Hello I was looking at new GenericHost sample and it seems now Host and SiloBuilder share same ServiceProvider as (if I am not mistaken) SiloBuilder actually populates Host's service collection. But that is still not true with ClientBuilder. Are there any plans on making ClientBuilder sit on top of generic host as well? I realize there is no need for injection usually in ClientBuilder but still it has ConfigureServices method and thus the question.,[Question] ClientBuilder and GenericHost Hello I was looking at new GenericHost sample and it seems now Host and SiloBuilder share same ServiceProvider as (if I am not mistaken) SiloBuilder actually populates Host's service collection. But that is still not true with ClientBuilder. Are there any plans on making ClientBuilder sit on top of generic host as well? I realize there is no need for injection usually in ClientBuilder but still it has ConfigureServices method and thus the question.,question,ReubenBond,,
5682,Support using shared .NET ThreadPool instead of dedicated thread pool,"Orleans currently schedules work onto a dedicated fixed-size thread pool. In some situations it may be preferable to schedule on .NET's ThreadPool instead.

For performance reasons we may want to wait until Orleans is multi-targeted before supporting this. That way we have access to the  the parameter.

Benefits include:
* Thread injection
* Less overhead in co-hosting (i.e Orleans will be a better neighbor)
* Potentially improved data locality & reduced context switches

There are some risks (potential downsides) including potential chance of scheduler starvation.","Support using shared .NET ThreadPool instead of dedicated thread pool Orleans currently schedules work onto a dedicated fixed-size thread pool. In some situations it may be preferable to schedule on .NET's ThreadPool instead.

For performance reasons we may want to wait until Orleans is multi-targeted before supporting this. That way we have access to the  the parameter.

Benefits include:
* Thread injection
* Less overhead in co-hosting (i.e Orleans will be a better neighbor)
* Potentially improved data locality & reduced context switches

There are some risks (potential downsides) including potential chance of scheduler starvation.",,ReubenBond,,
5679,Create Custom Placement Strategy Sample,This often comes around will be nice to have something to show for it.,Create Custom Placement Strategy Sample This often comes around will be nice to have something to show for it.,,JorgeCandeias,,
5678,Code generator fails on empty projects,"

This should probably be handled as you don't want the compilation of solutions to fail if you just added a new project that you've yet to add anything to.","Code generator fails on empty projects 

This should probably be handled as you don't want the compilation of solutions to fail if you just added a new project that you've yet to add anything to.",,ReubenBond,,
5676,Journaling grain and event sourcing,"Hello

First of all I want to give my appreciation to the team and contributors to Orleans it's a great solution for distributed computing. I've been working with it for awhile now and I'm very pleased with both functionality and how nicely it fits with modern architecture and design.

This issue is more about the documentation and somewhat about events with journaled grains in the context of event sourcing. Let me give my observations.

At the heart of event sourcing is the statement that an event signals that a state has changed meaning that any subscriber to the event can rest assure that the state is consistent with the event. The journaled grain however uses the event as to signal that the state should change e.g. with this event persist update to storage.

This is a typical call chain with Orleans.EventSourcing.CustomStorage (never mind the ReadStateFromStorage that might or not happen before the chain described):

1. RaiseEvent tells the provider that an event is to be fired
2. ApplyUpdatesToStorage is called to persist the event to storage
3. Apply (or TransitionState) is called to update aggregate state

As I understand it and see from other event sourcing solutions the chain maybe should be this:

1. ApplyUpdatesToStorage (to change the domain state meaning persist event(s))
2. RaiseEvent tells the provider that domain state has changed
3. Apply (or TransitionState) is called to update aggregate state

It's kind of backwards in the implementation of Orleans with the semantics of events in the context of event sourcing. This initially caused me confusion and I had to try to figure out what was going on before I finally realized the mechanics. I don't propose to do anything rather maybe in the documentation try to highlight if needed the difference.

Kind regards
//Jan
","Journaling grain and event sourcing Hello

First of all I want to give my appreciation to the team and contributors to Orleans it's a great solution for distributed computing. I've been working with it for awhile now and I'm very pleased with both functionality and how nicely it fits with modern architecture and design.

This issue is more about the documentation and somewhat about events with journaled grains in the context of event sourcing. Let me give my observations.

At the heart of event sourcing is the statement that an event signals that a state has changed meaning that any subscriber to the event can rest assure that the state is consistent with the event. The journaled grain however uses the event as to signal that the state should change e.g. with this event persist update to storage.

This is a typical call chain with Orleans.EventSourcing.CustomStorage (never mind the ReadStateFromStorage that might or not happen before the chain described):

1. RaiseEvent tells the provider that an event is to be fired
2. ApplyUpdatesToStorage is called to persist the event to storage
3. Apply (or TransitionState) is called to update aggregate state

As I understand it and see from other event sourcing solutions the chain maybe should be this:

1. ApplyUpdatesToStorage (to change the domain state meaning persist event(s))
2. RaiseEvent tells the provider that domain state has changed
3. Apply (or TransitionState) is called to update aggregate state

It's kind of backwards in the implementation of Orleans with the semantics of events in the context of event sourcing. This initially caused me confusion and I had to try to figure out what was going on before I finally realized the mechanics. I don't propose to do anything rather maybe in the documentation try to highlight if needed the difference.

Kind regards
//Jan
",,sergeybykov,,
5674,Changes to Orleans runtime to enable building Indexing as a NuGet package,,Changes to Orleans runtime to enable building Indexing as a NuGet package ,,ReubenBond,,
5672,add package ado report service fabric error,"1 dotnet add xxx.csproj package Microsoft.Orleans.Persistence.AdoNet

report error:
。。
“C:\Program Files\Microsoft SDKs\Service Fabric\packages” not exists

this library is dependency service fabric sdk ?				
","add package ado report service fabric error 1 dotnet add xxx.csproj package Microsoft.Orleans.Persistence.AdoNet

report error:
。。
“C:\Program Files\Microsoft SDKs\Service Fabric\packages” not exists

this library is dependency service fabric sdk ?				
",,sergeybykov,,
5671,not support ISiloBuilder.AddIncomingGrainCallFilter ,Cannot use the   open public,not support ISiloBuilder.AddIncomingGrainCallFilter  Cannot use the   open public,,xiazen,,
5670,Interface does not support output parameters?,"I want to page through some entities and return the total number that meets the criteria so I defined this interface:

But compile time error: OrleansCodeGenTestServiceReference Do not implement interface ITestService.Search(int intint out int)

This is the code generated at compile time(X.XX.IService.orleans.g.cs).
global::System.Threading.Tasks.Task<global::System.Collections.Generic.Listglobal::X.XX.XXX.TestEntity> global::X.XX.XXX.ITestService.Search(int age int pageindex int pagesizeint total)
{
return base.InvokeMethodAsync<global::System.Collections.Generic.Listglobal::X.XX.XXX.TestEntity>(unchecked((int)0xBC81583A) new object[]{age  pageindex  pagesize  total});
}
No ‘out’ keyword

What should I do?","Interface does not support output parameters? I want to page through some entities and return the total number that meets the criteria so I defined this interface:

But compile time error: OrleansCodeGenTestServiceReference Do not implement interface ITestService.Search(int intint out int)

This is the code generated at compile time(X.XX.IService.orleans.g.cs).
global::System.Threading.Tasks.Task<global::System.Collections.Generic.Listglobal::X.XX.XXX.TestEntity> global::X.XX.XXX.ITestService.Search(int age int pageindex int pagesizeint total)
{
return base.InvokeMethodAsync<global::System.Collections.Generic.Listglobal::X.XX.XXX.TestEntity>(unchecked((int)0xBC81583A) new object[]{age  pageindex  pagesize  total});
}
No ‘out’ keyword

What should I do?",question,sergeybykov,,
5667,Remove message retry functionality,It is a bad idea to blindly retry messages that fail to process/deliver. Because of that the default retry count is set to zero. We need to remove this code altogether to simplify the codebase and prevent the potential confusion. We should have done that as part of 2.0 effort.,Remove message retry functionality It is a bad idea to blindly retry messages that fail to process/deliver. Because of that the default retry count is set to zero. We need to remove this code altogether to simplify the codebase and prevent the potential confusion. We should have done that as part of 2.0 effort.,,ReubenBond,,
5662,Add ConfigureJsonSerializerSettings delegate to storage providers,…pertyHandling to serializer settings,Add ConfigureJsonSerializerSettings delegate to storage providers …pertyHandling to serializer settings,,ReubenBond,,
5660,Expected result of type System.Nullable`1[System.Int64] but encountered a null value.,"after upgrade to v2.3.3 the grain method return  was broken.

https://github.com/mkjeff/orleans/blob/9d67a5c4a27cd9392f5d198b495ac90fa8df6ffb/src/Orleans.Core/Async/TaskExtensions.cs#L118","Expected result of type System.Nullable was broken.

https://github.com/mkjeff/orleans/blob/9d67a5c4a27cd9392f5d198b495ac90fa8df6ffb/src/Orleans.Core/Async/TaskExtensions.cs#L118",,ReubenBond,,
5659,Reminders with long period invoked before their due time,"We've encountered cases of reminders are invoked before their due time.

Log example:
""reminder tickStatus:<1/10/2019 12:00:03 AM 1.00:00:00 5/28/2019 11:59:44 PM>""
<FirstTickTime Period CurrentTickTime>

As you can see the period is daily and the reminder should be invoked at time >= 12:00:03 AM but it was invoked at 11:59:44 PM which is almost 20 seconds before its time.

We've seen this in many cases for reminders with periods of hours (usually a day) or multiple days.

I looked at the reminders code and it seems fine. Internally it uses . I've tried to stress it on my local workstation with long period timers but couldn't reproduce this behavior yet.
Though our production environment is Google Cloud VM's and maybe it's related (I'll try to stress there too).
We've validated that all the silo's VM's clocks are synchronized with NTP.

Please consider simple defense mechanism of when the timer invoked to validate 'now' against the expected 'dueTime' and if it was invoked ahead of time then reschedule.

Thanks!","Reminders with long period invoked before their due time We've encountered cases of reminders are invoked before their due time.

Log example:
""reminder tickStatus:<1/10/2019 12:00:03 AM 1.00:00:00 5/28/2019 11:59:44 PM>""
<FirstTickTime Period CurrentTickTime>

As you can see the period is daily and the reminder should be invoked at time >= 12:00:03 AM but it was invoked at 11:59:44 PM which is almost 20 seconds before its time.

We've seen this in many cases for reminders with periods of hours (usually a day) or multiple days.

I looked at the reminders code and it seems fine. Internally it uses . I've tried to stress it on my local workstation with long period timers but couldn't reproduce this behavior yet.
Though our production environment is Google Cloud VM's and maybe it's related (I'll try to stress there too).
We've validated that all the silo's VM's clocks are synchronized with NTP.

Please consider simple defense mechanism of when the timer invoked to validate 'now' against the expected 'dueTime' and if it was invoked ahead of time then reschedule.

Thanks!",,sergeybykov,,
5652,Skip more intermittently failing tests,"EHMultipleSubscriptionTest_AddRemove AQ_07_ManyDifferent_ManyProducerClientsManyConsumerGrains
SingleSendBatchConsume
StreamingTests_Consumer_Producer_SubscribeToTwoStream_MessageWithPolymorphism
Grain_AzureBlobStore_SiloRestart","Skip more intermittently failing tests EHMultipleSubscriptionTest_AddRemove AQ_07_ManyDifferent_ManyProducerClientsManyConsumerGrains
SingleSendBatchConsume
StreamingTests_Consumer_Producer_SubscribeToTwoStream_MessageWithPolymorphism
Grain_AzureBlobStore_SiloRestart",,ReubenBond,,
5651,Grain_AzureBlobStore_SiloRestart failing intermittently,">Error message
Orleans.Runtime.OrleansLifecycleCanceledException : Lifecycle start canceled due to errors at stage 20000\r\n---- Orleans.Runtime.OrleansMessageRejectionException : Forwarding failed: tried to forward message Request S127.0.0.1:25559:296864291*stg/0/00000000@S00000000->S127.0.0.1:25559:296864291*grn/FCB3F509/00003039@c732078f #5589[ForwardCount=3]: for 3 times after Non-existent activation to invalid activation. Rejecting now. 
Stack trace
at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 63
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.<Execute>d__8.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.Runtime\Scheduler\ClosureWorkItem.cs:line 63
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.Silo.<StartAsync>d__65.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.Runtime\Silo\Silo.cs:line 270
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Hosting.SiloWrapper.<StartAsync>d__10.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.Runtime\Hosting\Generic\SiloWrapper.cs:line 36
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.InProcessSiloHandle.<CreateAsync>d__7.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\InProcessSiloHandle.cs:line 37
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.TestCluster.<StartSiloAsync>d__61.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\TestCluster.cs:line 552
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.TestCluster.<RestartSiloAsync>d__53.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\TestCluster.cs:line 450
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at TestExtensions.Runners.GrainPersistenceTestsRunner.<Grain_GrainStorage_SiloRestart>d__21.MoveNext() in D:\build\agent\_work\23\s\test\TesterInternal\TestRunners\GrainPersistenceTestRunner.cs:line 311
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.AzureUtils.Persistence.PersistenceGrainTests_AzureBlobStore.<Grain_AzureBlobStore_SiloRestart>d__10.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\TesterAzureUtils\Persistence\PersistenceGrainTests_AzureBlobStore.cs:line 139
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous l","Grain_AzureBlobStore_SiloRestart failing intermittently >Error message
Orleans.Runtime.OrleansLifecycleCanceledException : Lifecycle start canceled due to errors at stage 20000\r\n---- Orleans.Runtime.OrleansMessageRejectionException : Forwarding failed: tried to forward message Request S127.0.0.1:25559:296864291*stg/0/00000000@S00000000->S127.0.0.1:25559:296864291*grn/FCB3F509/00003039@c732078f #5589[ForwardCount=3]: for 3 times after Non-existent activation to invalid activation. Rejecting now. 
Stack trace
at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 63
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.<Execute>d__8.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.Runtime\Scheduler\ClosureWorkItem.cs:line 63
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.Silo.<StartAsync>d__65.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.Runtime\Silo\Silo.cs:line 270
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Hosting.SiloWrapper.<StartAsync>d__10.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.Runtime\Hosting\Generic\SiloWrapper.cs:line 36
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.InProcessSiloHandle.<CreateAsync>d__7.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\InProcessSiloHandle.cs:line 37
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.TestCluster.<StartSiloAsync>d__61.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\TestCluster.cs:line 552
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.TestCluster.<RestartSiloAsync>d__53.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\TestCluster.cs:line 450
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at TestExtensions.Runners.GrainPersistenceTestsRunner.<Grain_GrainStorage_SiloRestart>d__21.MoveNext() in D:\build\agent\_work\23\s\test\TesterInternal\TestRunners\GrainPersistenceTestRunner.cs:line 311
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.AzureUtils.Persistence.PersistenceGrainTests_AzureBlobStore.<Grain_AzureBlobStore_SiloRestart>d__10.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\TesterAzureUtils\Persistence\PersistenceGrainTests_AzureBlobStore.cs:line 139
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous l",test-issue,benjaminpetit,,
5650,StreamingTests_Consumer_Producer_SubscribeToTwoStream_MessageWithPolymorphism failing intermittently,">Error message
Assert.Equal() Failure\r\nExpected: 29\r\nActual: 27
Stack trace
at Tester.StreamingTests.ProgrammaticSubcribeTestsRunner.<CheckCounters>d__14.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ProgrammaticSubscribeTests\ProgrammaticSubcribeTestsRunner.cs:line 289
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.ProgrammaticSubscribeTests.SubscriptionObserverWithImplicitSubscribingTestRunner.<StreamingTests_Consumer_Producer_SubscribeToTwoStream_MessageWithPolymorphism>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ProgrammaticSubscribeTests\SubscriptionObserverWithImplicitSubscribingTestRunner.cs:line 84
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","StreamingTests_Consumer_Producer_SubscribeToTwoStream_MessageWithPolymorphism failing intermittently >Error message
Assert.Equal() Failure\r\nExpected: 29\r\nActual: 27
Stack trace
at Tester.StreamingTests.ProgrammaticSubcribeTestsRunner.<CheckCounters>d__14.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ProgrammaticSubscribeTests\ProgrammaticSubcribeTestsRunner.cs:line 289
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.ProgrammaticSubscribeTests.SubscriptionObserverWithImplicitSubscribingTestRunner.<StreamingTests_Consumer_Producer_SubscribeToTwoStream_MessageWithPolymorphism>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ProgrammaticSubscribeTests\SubscriptionObserverWithImplicitSubscribingTestRunner.cs:line 84
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,jason-bragg,,
5649,SingleSendBatchConsume test failing intermittently,">Error message
Assert.Equal() Failure\r\nExpected: 30\r\nActual: 29
Stack trace
at UnitTests.StreamingTests.StreamBatchingTestRunner.<CheckCounters>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\StreamBatchingTestRunner.cs:line 84
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.StreamBatchingTestRunner.<SingleSendBatchConsume>d__4.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\StreamBatchingTestRunner.cs:line 39
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","SingleSendBatchConsume test failing intermittently >Error message
Assert.Equal() Failure\r\nExpected: 30\r\nActual: 29
Stack trace
at UnitTests.StreamingTests.StreamBatchingTestRunner.<CheckCounters>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\StreamBatchingTestRunner.cs:line 84
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.StreamBatchingTestRunner.<SingleSendBatchConsume>d__4.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\StreamBatchingTestRunner.cs:line 39
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,jason-bragg,,
5648,AQ_07_ManyDifferent_ManyProducerClientsManyConsumerGrains failing intermittently,">Error message
Assert.Equal() Failure\r\nExpected: 90\r\nActual: 89
Stack trace
at UnitTests.StreamingTests.SingleStreamTestRunner.<CheckCounters>d__39.MoveNext() in D:\build\agent\_work\23\s\test\TesterInternal\StreamingTests\SingleStreamTestRunner.cs:line 473
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.SingleStreamTestRunner.<BasicTestAsync>d__37.MoveNext() in D:\build\agent\_work\23\s\test\TesterInternal\StreamingTests\SingleStreamTestRunner.cs:line 440
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.SingleStreamTestRunner.<StreamTest_07_ManyDifferent_ManyProducerClientsManyConsumerGrains>d__22.MoveNext() in D:\build\agent\_work\23\s\test\TesterInternal\StreamingTests\SingleStreamTestRunner.cs:line 144
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.AzureUtils.Streaming.AQStreamingTests.<AQ_07_ManyDifferent_ManyProducerClientsManyConsumerGrains>d__15.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\TesterAzureUtils\Streaming\AQStreamingTests.cs:line 134
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","AQ_07_ManyDifferent_ManyProducerClientsManyConsumerGrains failing intermittently >Error message
Assert.Equal() Failure\r\nExpected: 90\r\nActual: 89
Stack trace
at UnitTests.StreamingTests.SingleStreamTestRunner.<CheckCounters>d__39.MoveNext() in D:\build\agent\_work\23\s\test\TesterInternal\StreamingTests\SingleStreamTestRunner.cs:line 473
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.SingleStreamTestRunner.<BasicTestAsync>d__37.MoveNext() in D:\build\agent\_work\23\s\test\TesterInternal\StreamingTests\SingleStreamTestRunner.cs:line 440
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.SingleStreamTestRunner.<StreamTest_07_ManyDifferent_ManyProducerClientsManyConsumerGrains>d__22.MoveNext() in D:\build\agent\_work\23\s\test\TesterInternal\StreamingTests\SingleStreamTestRunner.cs:line 144
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.AzureUtils.Streaming.AQStreamingTests.<AQ_07_ManyDifferent_ManyProducerClientsManyConsumerGrains>d__15.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\TesterAzureUtils\Streaming\AQStreamingTests.cs:line 134
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,jason-bragg,,
5647,EHMultipleSubscriptionTest_AddRemove failing intermittently,">Error message
Assert.Equal() Failure\r\nExpected: 9\r\nActual: 3
Stack trace
at UnitTests.StreamingTests.SubscriptionMultiplicityTestRunner.<CheckCounters>d__13.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\SubscriptionMultiplicityTestRunner.cs:line 346
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.SubscriptionMultiplicityTestRunner.<MultipleSubscriptionTest_AddRemove>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\SubscriptionMultiplicityTestRunner.cs:line 113
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at ServiceBus.Tests.StreamingTests.EHSubscriptionMultiplicityTests.<EHMultipleSubscriptionTest_AddRemove>d__10.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\ServiceBus.Tests\Streaming\EHSubscriptionMultiplicityTests.cs:line 82
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","EHMultipleSubscriptionTest_AddRemove failing intermittently >Error message
Assert.Equal() Failure\r\nExpected: 9\r\nActual: 3
Stack trace
at UnitTests.StreamingTests.SubscriptionMultiplicityTestRunner.<CheckCounters>d__13.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\SubscriptionMultiplicityTestRunner.cs:line 346
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.SubscriptionMultiplicityTestRunner.<MultipleSubscriptionTest_AddRemove>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\SubscriptionMultiplicityTestRunner.cs:line 113
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at ServiceBus.Tests.StreamingTests.EHSubscriptionMultiplicityTests.<EHMultipleSubscriptionTest_AddRemove>d__10.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\ServiceBus.Tests\Streaming\EHSubscriptionMultiplicityTests.cs:line 82
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,sergeybykov,31/05/2019 9:32,
5645,Port Pr 5354 and 5372 to 1.5.8,"Please manually compare diff in https://github.com/dotnet/orleans/pull/5354/files
and https://github.com/dotnet/orleans/pull/5372/files
to see if I made the right change","Port Pr 5354 and 5372 to 1.5.8 Please manually compare diff in https://github.com/dotnet/orleans/pull/5354/files
and https://github.com/dotnet/orleans/pull/5372/files
to see if I made the right change",,sergeybykov,,
5643,Port Pr 5354 and 5372 to 1.5.8,"Please manually compare diff in https://github.com/dotnet/orleans/pull/5354/files
and https://github.com/dotnet/orleans/pull/5372/files
 to see if I made the right change
","Port Pr 5354 and 5372 to 1.5.8 Please manually compare diff in https://github.com/dotnet/orleans/pull/5354/files
and https://github.com/dotnet/orleans/pull/5372/files
 to see if I made the right change
",,sergeybykov,,
5642,"Revert ""Rebuild when files are added or removed from a project (#5594)","Revert the build change for now because it is breaking code signing. We'll bring it back in when it works properly with code signing.

This reverts commit 74cdce26cf46afa358c8ce5646fae8c83ccfa1c8.","Revert ""Rebuild when files are added or removed from a project (#5594) Revert the build change for now because it is breaking code signing. We'll bring it back in when it works properly with code signing.

This reverts commit 74cdce26cf46afa358c8ce5646fae8c83ccfa1c8.",,ReubenBond,,
5641,Add null check in MessageCenter.TryDeliverToProxy,,Add null check in MessageCenter.TryDeliverToProxy ,,ReubenBond,,
5639,AQStreamProducerOnDroppedClientTest failing intermittently,">Error message
System.AggregateException : One or more errors occurred.\r\n---- Microsoft.WindowsAzure.Storage.StorageException : The remote server returned an error: (409) Conflict.\r\n-------- System.Net.WebException : The remote server returned an error: (409) Conflict.
Stack trace
at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout CancellationToken cancellationToken)
at Tester.AzureUtils.Streaming.AQClientStreamTests.Dispose() in D:\build\agent\_work\6\s\test\Extensions\TesterAzureUtils\Streaming\AQClientStreamTests.cs:line 88
at ReflectionAbstractionExtensions.DisposeTestClass(ITest test Object testClass IMessageBus messageBus ExecutionTimer timer CancellationTokenSource cancellationTokenSource)
----- Inner Stack Trace -----
at Microsoft.WindowsAzure.Storage.Core.Executor.Executor.EndExecuteAsync[T](IAsyncResult result)
at Microsoft.WindowsAzure.Storage.Table.CloudTable.EndCreateIfNotExists(IAsyncResult asyncResult)
at Microsoft.WindowsAzure.Storage.Core.Util.AsyncExtensions.<>c__DisplayClass11.<InitTableAsync>d__17.MoveNext() in D:\build\agent\_work\6\s\src\Azure\Shared\Storage\AzureTableDataManager.cs:line 99
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.TestStreamProviders.TestAzureTableStorageStreamFailureHandler.<DeleteAll>d__5.MoveNext() in D:\build\agent\_work\6\s\test\Tester\TestStreamProviders\TestAzureTableStorageStreamFailureHandler.cs:line 46
----- Inner Stack Trace -----
at Microsoft.WindowsAzure.Storage.Table.Protocol.TableOperationHttpResponseParsers.TableOperationPreProcess(TableResult result TableOperation operation HttpWebResponse resp Exception ex)
at Microsoft.WindowsAzure.Storage.Core.Executor.Executor.EndGetResponse[T](IAsyncResult getResponseResult)","AQStreamProducerOnDroppedClientTest failing intermittently >Error message
System.AggregateException : One or more errors occurred.\r\n---- Microsoft.WindowsAzure.Storage.StorageException : The remote server returned an error: (409) Conflict.\r\n-------- System.Net.WebException : The remote server returned an error: (409) Conflict.
Stack trace
at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout CancellationToken cancellationToken)
at Tester.AzureUtils.Streaming.AQClientStreamTests.Dispose() in D:\build\agent\_work\6\s\test\Extensions\TesterAzureUtils\Streaming\AQClientStreamTests.cs:line 88
at ReflectionAbstractionExtensions.DisposeTestClass(ITest test Object testClass IMessageBus messageBus ExecutionTimer timer CancellationTokenSource cancellationTokenSource)
----- Inner Stack Trace -----
at Microsoft.WindowsAzure.Storage.Core.Executor.Executor.EndExecuteAsync[T](IAsyncResult result)
at Microsoft.WindowsAzure.Storage.Table.CloudTable.EndCreateIfNotExists(IAsyncResult asyncResult)
at Microsoft.WindowsAzure.Storage.Core.Util.AsyncExtensions.<>c__DisplayClass11.<InitTableAsync>d__17.MoveNext() in D:\build\agent\_work\6\s\src\Azure\Shared\Storage\AzureTableDataManager.cs:line 99
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.TestStreamProviders.TestAzureTableStorageStreamFailureHandler.<DeleteAll>d__5.MoveNext() in D:\build\agent\_work\6\s\test\Tester\TestStreamProviders\TestAzureTableStorageStreamFailureHandler.cs:line 46
----- Inner Stack Trace -----
at Microsoft.WindowsAzure.Storage.Table.Protocol.TableOperationHttpResponseParsers.TableOperationPreProcess(TableResult result TableOperation operation HttpWebResponse resp Exception ex)
at Microsoft.WindowsAzure.Storage.Core.Executor.Executor.EndGetResponse[T](IAsyncResult getResponseResult)",test-issue,jason-bragg,,
5638,Recoverable100EventStreamsWith1NonTransientErrorTest failing intermittently,">Error message
Assert.Equal() Failure\r\nExpected: 4\r\nActual: 12
Stack trace
at Tester.StreamingTests.ImplicitSubscritionRecoverableStreamTestRunner.<CheckCounters>d__5.MoveNext() in D:\build\agent\_work\6\s\test\Tester\StreamingTests\ImplicitSubscritionRecoverableStreamTestRunner.cs:line 61
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\6\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\6\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.ImplicitSubscritionRecoverableStreamTestRunner.<Recoverable100EventStreamsWith1NonTransientError>d__4.MoveNext() in D:\build\agent\_work\6\s\test\Tester\StreamingTests\ImplicitSubscritionRecoverableStreamTestRunner.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at ServiceBus.Tests.StreamingTests.EHImplicitSubscriptionStreamRecoveryTests.<Recoverable100EventStreamsWith1NonTransientErrorTest>d__8.MoveNext() in D:\build\agent\_work\6\s\test\Extensions\ServiceBus.Tests\Streaming\EHImplicitSubscriptionStreamRecoveryTests.cs:line 101
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","Recoverable100EventStreamsWith1NonTransientErrorTest failing intermittently >Error message
Assert.Equal() Failure\r\nExpected: 4\r\nActual: 12
Stack trace
at Tester.StreamingTests.ImplicitSubscritionRecoverableStreamTestRunner.<CheckCounters>d__5.MoveNext() in D:\build\agent\_work\6\s\test\Tester\StreamingTests\ImplicitSubscritionRecoverableStreamTestRunner.cs:line 61
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\6\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\6\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.ImplicitSubscritionRecoverableStreamTestRunner.<Recoverable100EventStreamsWith1NonTransientError>d__4.MoveNext() in D:\build\agent\_work\6\s\test\Tester\StreamingTests\ImplicitSubscritionRecoverableStreamTestRunner.cs:line 43
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at ServiceBus.Tests.StreamingTests.EHImplicitSubscriptionStreamRecoveryTests.<Recoverable100EventStreamsWith1NonTransientErrorTest>d__8.MoveNext() in D:\build\agent\_work\6\s\test\Extensions\ServiceBus.Tests\Streaming\EHImplicitSubscriptionStreamRecoveryTests.cs:line 101
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,sergeybykov,29/05/2019 12:19,
5635,StreamingTests_Consumer_Producer_UnSubscribe test failing intermittently,">Error message
Assert.True() Failure\r\nExpected: True\r\nActual: False
Stack trace
at Tester.StreamingTests.ProgrammaticSubcribeTestsRunner.<StreamingTests_Consumer_Producer_UnSubscribe>d__7.MoveNext() in D:\build\agent\_work\25\s\test\Tester\StreamingTests\ProgrammaticSubscribeTests\ProgrammaticSubcribeTestsRunner.cs:line 103
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","StreamingTests_Consumer_Producer_UnSubscribe test failing intermittently >Error message
Assert.True() Failure\r\nExpected: True\r\nActual: False
Stack trace
at Tester.StreamingTests.ProgrammaticSubcribeTestsRunner.<StreamingTests_Consumer_Producer_UnSubscribe>d__7.MoveNext() in D:\build\agent\_work\25\s\test\Tester\StreamingTests\ProgrammaticSubscribeTests\ProgrammaticSubcribeTestsRunner.cs:line 103
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,sergeybykov,29/05/2019 5:32,
5634,EHStreamConsumerOnDroppedClientTest failing intermittently,">Error message
Assert.Equal() Failure\r\nExpected: 1\r\nActual: 0
Stack trace
at Tester.StreamingTests.ClientStreamTestRunner.<CheckCounters>d__9.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ClientStreamTestRunner.cs:line 150
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.ClientStreamTestRunner.<StreamConsumerOnDroppedClientTest>d__5.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ClientStreamTestRunner.cs:line 70
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at ServiceBus.Tests.StreamingTests.EHClientStreamTests.<EHStreamConsumerOnDroppedClientTest>d__11.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\ServiceBus.Tests\Streaming\EHClientStreamTests.cs:line 104
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","EHStreamConsumerOnDroppedClientTest failing intermittently >Error message
Assert.Equal() Failure\r\nExpected: 1\r\nActual: 0
Stack trace
at Tester.StreamingTests.ClientStreamTestRunner.<CheckCounters>d__9.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ClientStreamTestRunner.cs:line 150
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.ClientStreamTestRunner.<StreamConsumerOnDroppedClientTest>d__5.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ClientStreamTestRunner.cs:line 70
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at ServiceBus.Tests.StreamingTests.EHClientStreamTests.<EHStreamConsumerOnDroppedClientTest>d__11.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\ServiceBus.Tests\Streaming\EHClientStreamTests.cs:line 104
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,sergeybykov,29/05/2019 5:27,
5633,Recoverable100EventStreamsWithTransientErrorsTest test failing intermittently,">Error message
Assert.Equal() Failure\r\nExpected: 100\r\nActual: 99
Stack trace
at Tester.StreamingTests.ImplicitSubscritionRecoverableStreamTestRunner.<CheckCounters>d__5.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ImplicitSubscritionRecoverableStreamTestRunner.cs:line 61
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.ImplicitSubscritionRecoverableStreamTestRunner.<Recoverable100EventStreamsWithTransientErrors>d__3.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ImplicitSubscritionRecoverableStreamTestRunner.cs:line 28
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at ServiceBus.Tests.StreamingTests.EHImplicitSubscriptionStreamRecoveryTests.<Recoverable100EventStreamsWithTransientErrorsTest>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\ServiceBus.Tests\Streaming\EHImplicitSubscriptionStreamRecoveryTests.cs:line 94
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","Recoverable100EventStreamsWithTransientErrorsTest test failing intermittently >Error message
Assert.Equal() Failure\r\nExpected: 100\r\nActual: 99
Stack trace
at Tester.StreamingTests.ImplicitSubscritionRecoverableStreamTestRunner.<CheckCounters>d__5.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ImplicitSubscritionRecoverableStreamTestRunner.cs:line 61
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.ImplicitSubscritionRecoverableStreamTestRunner.<Recoverable100EventStreamsWithTransientErrors>d__3.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\ImplicitSubscritionRecoverableStreamTestRunner.cs:line 28
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at ServiceBus.Tests.StreamingTests.EHImplicitSubscriptionStreamRecoveryTests.<Recoverable100EventStreamsWithTransientErrorsTest>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Extensions\ServiceBus.Tests\Streaming\EHImplicitSubscriptionStreamRecoveryTests.cs:line 94
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,sergeybykov,29/05/2019 5:24,
5632,BatchSendBatchConsume test failing intermittently,">Error message
Assert.Equal() Failure\r\nExpected: 30\r\nActual: 20
Stack trace
at UnitTests.StreamingTests.StreamBatchingTestRunner.<CheckCounters>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\StreamBatchingTestRunner.cs:line 84
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.StreamBatchingTestRunner.<BatchSendBatchConsume>d__6.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\StreamBatchingTestRunner.cs:line 75
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","BatchSendBatchConsume test failing intermittently >Error message
Assert.Equal() Failure\r\nExpected: 30\r\nActual: 20
Stack trace
at UnitTests.StreamingTests.StreamBatchingTestRunner.<CheckCounters>d__7.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\StreamBatchingTestRunner.cs:line 84
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 95
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\23\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 108
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.StreamingTests.StreamBatchingTestRunner.<BatchSendBatchConsume>d__6.MoveNext() in D:\build\agent\_work\23\s\test\Tester\StreamingTests\StreamBatchingTestRunner.cs:line 75
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",test-issue,jason-bragg,,
5631,Catalog and Directory Grains failing to communicate - Select Activation Timeouts,"Hi

We are having issues in our cluster with select activation timeouts between the catalog and directory grains - Issue below.



Once this error starts it never recovers and that source silo seems to stop doing much useful work.  We have struggled to nail down when it happens.

Is it possible to move those system grains away from silos that run our grains so we can rule out our interaction with the silo which I am sure it is what we are doing on there

Can you effectively segment the cluster to allow system grains on one half and custom grains on the other ?

Thanks","Catalog and Directory Grains failing to communicate - Select Activation Timeouts Hi

We are having issues in our cluster with select activation timeouts between the catalog and directory grains - Issue below.



Once this error starts it never recovers and that source silo seems to stop doing much useful work.  We have struggled to nail down when it happens.

Is it possible to move those system grains away from silos that run our grains so we can rule out our interaction with the silo which I am sure it is what we are doing on there

Can you effectively segment the cluster to allow system grains on one half and custom grains on the other ?

Thanks",,sergeybykov,,
5630,[Question] Deadlock in streams handling,"Hello 

I am trying to implement some kind of RPC using Orleans 2.0 streams.

In grain method grain awaits publishing to CommandStream and then observes response from CommandResponseStream awaiting the result 

remote service (another process) observes incoming command from CommandStream and then handles the command and awaits publishing result back to CommandResponseStream.

Looks like this setup gets deadlocked somehow in the internals of Orleans after remote service handles the command and publishes the response. I assume due to custom scheduler used. As if I mark the grain as  everything works as expected looks like [Reentrancy within a call chain](https://dotnet.github.io/orleans/Documentation/grains/reentrancy.html#reentrancy-within-a-call-chain) does not work in this case. Maybe it would if instead of two streams I had used GrainObserver + CommandResponseStream.

So for now the only workaround I see is to use predicate to control reentrancy as in general I do not want my code to be reentrant but is that the right way of implementing such calls? 

Thanks in advance.","[Question] Deadlock in streams handling Hello 

I am trying to implement some kind of RPC using Orleans 2.0 streams.

In grain method grain awaits publishing to CommandStream and then observes response from CommandResponseStream awaiting the result 

remote service (another process) observes incoming command from CommandStream and then handles the command and awaits publishing result back to CommandResponseStream.

Looks like this setup gets deadlocked somehow in the internals of Orleans after remote service handles the command and publishes the response. I assume due to custom scheduler used. As if I mark the grain as  everything works as expected looks like [Reentrancy within a call chain](https://dotnet.github.io/orleans/Documentation/grains/reentrancy.html#reentrancy-within-a-call-chain) does not work in this case. Maybe it would if instead of two streams I had used GrainObserver + CommandResponseStream.

So for now the only workaround I see is to use predicate to control reentrancy as in general I do not want my code to be reentrant but is that the right way of implementing such calls? 

Thanks in advance.",,sergeybykov,,
5629,[Question] EventHub stream not all consumers receiving events instantly,"We have a stream per order with some (10+) consumers all marked with ImplicitStreamSubscription attribute. Sometimes we see in logs that after event were sent to stream only few consumers receive it instantly. Others are hung until next event comes.
Something like this:

13:07:02.251 event 'First' sent to stream
13:07:02.258 event 'First' received by Grain**A**
...
13:32:23.054 event 'Second' sent to stream
13:32:23.200 event 'First' received by Grain**B**
13:32:23.200 event 'Second' received by Grain**A**
13:32:23.283 event 'Second' received by Grain**B**

So **25 minutes** passed since GrainA received event from stream without any impact on GrainB. And only when new event (Second) was sent - GrainB was triggered and received both these events.
How could that happen? That's not a throttling because event's message already read from stream provider parsed but delivered only to one of consumers.
The confusing part here is that 'Second' event is delivered to GrainA **same millisecond** as 'First' delivered to GrainB. Like if GranB were to trigger for 'Second' event but found 'First' in queue ahead forgotten for some reason and triggered now by FIFO principle.
Logs shows that grains are instatiated on different silos. GrainA lives on same silo where producer ran.
","[Question] EventHub stream not all consumers receiving events instantly We have a stream per order with some (10+) consumers all marked with ImplicitStreamSubscription attribute. Sometimes we see in logs that after event were sent to stream only few consumers receive it instantly. Others are hung until next event comes.
Something like this:

13:07:02.251 event 'First' sent to stream
13:07:02.258 event 'First' received by Grain**A**
...
13:32:23.054 event 'Second' sent to stream
13:32:23.200 event 'First' received by Grain**B**
13:32:23.200 event 'Second' received by Grain**A**
13:32:23.283 event 'Second' received by Grain**B**

So **25 minutes** passed since GrainA received event from stream without any impact on GrainB. And only when new event (Second) was sent - GrainB was triggered and received both these events.
How could that happen? That's not a throttling because event's message already read from stream provider parsed but delivered only to one of consumers.
The confusing part here is that 'Second' event is delivered to GrainA **same millisecond** as 'First' delivered to GrainB. Like if GranB were to trigger for 'Second' event but found 'First' in queue ahead forgotten for some reason and triggered now by FIFO principle.
Logs shows that grains are instatiated on different silos. GrainA lives on same silo where producer ran.
",,xiazen,,
5628,[QUESTION] How to marshal a task into an ActivationTaskScheduler context,"Version: Orleans 1.5.3

I have some code that runs inside a silo but not in Orleans task scheduler ( a singleton? Is it okay to save it from the bootstrap provider and use it later?

What about Orleans 2.x? Will this work there too? (I know the bootstrap provider stuff has been replaced with a different architecture.)

Or the other way round: What is the best way to get back into Orleans context from code which runs outside of it?","[QUESTION] How to marshal a task into an ActivationTaskScheduler context Version: Orleans 1.5.3

I have some code that runs inside a silo but not in Orleans task scheduler ( a singleton? Is it okay to save it from the bootstrap provider and use it later?

What about Orleans 2.x? Will this work there too? (I know the bootstrap provider stuff has been replaced with a different architecture.)

Or the other way round: What is the best way to get back into Orleans context from code which runs outside of it?",,ReubenBond,,
5627,GrainMethodInvoker.GetMethodEntry can throw InvalidOperationException,The dashboard uses a grain call filter which tries to grab the name of the method being invoked. It does this by calling ,GrainMethodInvoker.GetMethodEntry can throw InvalidOperationException The dashboard uses a grain call filter which tries to grab the name of the method being invoked. It does this by calling ,codegen,ReubenBond,,
5626,Unit Testing Sample,This is a new unit testing sample showcasing ways to mock Orleans services.,Unit Testing Sample This is a new unit testing sample showcasing ways to mock Orleans services.,,xiazen,,
5625,Performance issues using Streams as backchannels to Frontend Servers,"We are currently load testing our Orleans cluster and are experiencing some performance issues with streams. The general architecture is split into three major components: Mobile Clients Frontend Servers and Silohosts.

Mobile clients connect to Frontend Servers with a TCP socket. Each client has one PlayerGrain in the Silohost containing the state of the player. Each player may belong to up to one Guild which are represented by a GuildGrain. Once a Mobile Client opens a TCP connection to Frontend a PlayerConnection object is created in the FrontEnd which then calls SubscribeAsync on a stream (SimpleMessageStreamProvider) in the Player namespace and a stream in the Guild namespace. These streams are then used by PlayerGrains and GuildGrains to push data to the mobile clients. Once the PlayerConnection object is disposed we call Unsubscribe with the stream handles.

In the load test we are creating mock mobile clients that register a new player join a guild and start sending chat messages every ~5 seconds. When the guild grain receives the message it pushes it down to the guild stream and all subscribed PlayerConnections push it down to the mobile clients via the TCP socket. 

The weird behaviour is exhibited when we change the number of players per guild between 30 and 10 players. The performance of the Silohost drops drastically (approximately a 50% drop in concurrently online player capability) if we increase the players per guild to 30. The only effect this has is that now each chat message is sent 3x as many subscribers on the FrontEnd all other variables should be the same. The FrontEndServer's performance doesn't seem to suffer much. 

Is this possibly caused by the fact that the FrontEndServer has 10 (or 30) separate subscriptions to the same Guild stream and if so how can it be shared without building some kind of a Hub that holds the subscriptions? Also what is worrying is if sharing the subscriptions is the answer then at a very large scale when players in a guild are load balanced to different FrontEndServers the I assume the problem will reappear.

One other performance-related issue we've seen with streams is in scenarios where a large number of PlayerGrains are deactivated (around 600 or so) we can see very large latencies (~300ms) for the UnregisterProducer method in the Dashboard causing massive CPU spikes in the Silohost.

Do any of these symptoms sound like we have somehow incorrectly implemented streams and/or is there any specific diagnostic data we could provide to help investigate?","Performance issues using Streams as backchannels to Frontend Servers We are currently load testing our Orleans cluster and are experiencing some performance issues with streams. The general architecture is split into three major components: Mobile Clients Frontend Servers and Silohosts.

Mobile clients connect to Frontend Servers with a TCP socket. Each client has one PlayerGrain in the Silohost containing the state of the player. Each player may belong to up to one Guild which are represented by a GuildGrain. Once a Mobile Client opens a TCP connection to Frontend a PlayerConnection object is created in the FrontEnd which then calls SubscribeAsync on a stream (SimpleMessageStreamProvider) in the Player namespace and a stream in the Guild namespace. These streams are then used by PlayerGrains and GuildGrains to push data to the mobile clients. Once the PlayerConnection object is disposed we call Unsubscribe with the stream handles.

In the load test we are creating mock mobile clients that register a new player join a guild and start sending chat messages every ~5 seconds. When the guild grain receives the message it pushes it down to the guild stream and all subscribed PlayerConnections push it down to the mobile clients via the TCP socket. 

The weird behaviour is exhibited when we change the number of players per guild between 30 and 10 players. The performance of the Silohost drops drastically (approximately a 50% drop in concurrently online player capability) if we increase the players per guild to 30. The only effect this has is that now each chat message is sent 3x as many subscribers on the FrontEnd all other variables should be the same. The FrontEndServer's performance doesn't seem to suffer much. 

Is this possibly caused by the fact that the FrontEndServer has 10 (or 30) separate subscriptions to the same Guild stream and if so how can it be shared without building some kind of a Hub that holds the subscriptions? Also what is worrying is if sharing the subscriptions is the answer then at a very large scale when players in a guild are load balanced to different FrontEndServers the I assume the problem will reappear.

One other performance-related issue we've seen with streams is in scenarios where a large number of PlayerGrains are deactivated (around 600 or so) we can see very large latencies (~300ms) for the UnregisterProducer method in the Dashboard causing massive CPU spikes in the Silohost.

Do any of these symptoms sound like we have somehow incorrectly implemented streams and/or is there any specific diagnostic data we could provide to help investigate?",,sergeybykov,,
5624,NullReferenceException in SafeTimer,"Hi

this is a support request because i feel a little bit stupid right now.

From time to time I get a lof of exceptions like this:



Which is strange because...

1. I have disabled the logs for this category: https://github.com/Squidex/squidex/blob/master/src/Squidex/Config/Logging.cs#L26

2. I don't see how it can happen because there is nothing in your code and this stack trace that could be null.

Usually everything works fine and I just restart the node to get rid of the log entries but I have no idea how it can happen.","NullReferenceException in SafeTimer Hi

this is a support request because i feel a little bit stupid right now.

From time to time I get a lof of exceptions like this:



Which is strange because...

1. I have disabled the logs for this category: https://github.com/Squidex/squidex/blob/master/src/Squidex/Config/Logging.cs#L26

2. I don't see how it can happen because there is nothing in your code and this stack trace that could be null.

Usually everything works fine and I just restart the node to get rid of the log entries but I have no idea how it can happen.",,ReubenBond,,
5623,How to implement Property Injection,according to the autofac documentation the configuration of property injection has been done but I find that property injection does not work. Is it something I missed? can you tell me how to implement it?,How to implement Property Injection according to the autofac documentation the configuration of property injection has been done but I find that property injection does not work. Is it something I missed? can you tell me how to implement it?,question,xiazen,,
5622,LinuxEnvironmentStatistics Couldn't read 'MemAvailable' line from '/proc/meminfo',"when use UseLinuxEnvironmentStatistics  get a Warn **Couldn't read 'MemAvailable' line from '/proc/meminfo'**
run command  

OS:  ubuntu 1804
OrleansVersion: 2.3.2

","LinuxEnvironmentStatistics Couldn't read 'MemAvailable' line from '/proc/meminfo' when use UseLinuxEnvironmentStatistics  get a Warn **Couldn't read 'MemAvailable' line from '/proc/meminfo'**
run command  

OS:  ubuntu 1804
OrleansVersion: 2.3.2

",,benjaminpetit,,
5621,Apply Dashboard Custom Profiling to the Reactive Caching Sample,Apply https://github.com/OrleansContrib/OrleansDashboard/pull/228 (see https://github.com/OrleansContrib/OrleansDashboard/issues/227) to the Reactive Caching Sample to demonstrate how to fix inflated metrics from reactive poll methods. To do upon the next release of the Dashboard. Feel free to assign this to me.,Apply Dashboard Custom Profiling to the Reactive Caching Sample Apply https://github.com/OrleansContrib/OrleansDashboard/pull/228 (see https://github.com/OrleansContrib/OrleansDashboard/issues/227) to the Reactive Caching Sample to demonstrate how to fix inflated metrics from reactive poll methods. To do upon the next release of the Dashboard. Feel free to assign this to me.,,JorgeCandeias,,
5620,Cannot connect client to remote silo hosted on Windows Azure VM using Azure table membership,"Hi all 
just trying to figure out how to configure correctly silo membership using Azure tables on an Azure hosted VM which has a public ip (the one used for the membership) and ports 11111 and 30000 opened on the Azure Firewall... I verified that I'm able to access that IP from outside and also see Dashboard published on the default port 8080 but not able to connect the client to the cluster since the silo seems to be registered correctly on the Azure Table since has the correct IP and is marked as 'Active' can you help me to understand what's wrong? 

Here's the client log: 



Orleans version used is 2.3.2 running on .net core 2.2","Cannot connect client to remote silo hosted on Windows Azure VM using Azure table membership Hi all 
just trying to figure out how to configure correctly silo membership using Azure tables on an Azure hosted VM which has a public ip (the one used for the membership) and ports 11111 and 30000 opened on the Azure Firewall... I verified that I'm able to access that IP from outside and also see Dashboard published on the default port 8080 but not able to connect the client to the cluster since the silo seems to be registered correctly on the Azure Table since has the correct IP and is marked as 'Active' can you help me to understand what's wrong? 

Here's the client log: 



Orleans version used is 2.3.2 running on .net core 2.2",,benjaminpetit,,
5619,Create GrainReferenceKeyInfo,"Create new type GrainReferenceKeyInfo and methods for getting key info from a GrainReference and getting a GrainReference form the key info. This enables serializers not part of orleans to serialize/deserialize GrainReferences into more space compact representations than the GetKeyString() format.

Resolves #3810.","Create GrainReferenceKeyInfo Create new type GrainReferenceKeyInfo and methods for getting key info from a GrainReference and getting a GrainReference form the key info. This enables serializers not part of orleans to serialize/deserialize GrainReferences into more space compact representations than the GetKeyString() format.

Resolves #3810.",,ReubenBond,,
5617,Add fluent support to TestClusterBuilder,"The TestClusterBuilder should support fluent method chaining so we can do the following


","Add fluent support to TestClusterBuilder The TestClusterBuilder should support fluent method chaining so we can do the following


",,sergeybykov,,
5616,Add IHostApplicationLifetime support,"I think it would be a good idea to add IHostApplicationLifetime to TestCluster so that it can be monitored from outside rather than using the ILifecycleObservable startup tasks.

when testing a service fixture we can do the following before returning the client service provider to the test:

","Add IHostApplicationLifetime support I think it would be a good idea to add IHostApplicationLifetime to TestCluster so that it can be monitored from outside rather than using the ILifecycleObservable startup tasks.

when testing a service fixture we can do the following before returning the client service provider to the test:

",,xiazen,,
5615,Fix tx test,,Fix tx test ,,ReubenBond,,
5614,Azure App Service (Web API) cannot connect to Orleans Cloud Service Silo as Worker Role,"Hi Team

We have hosted Orleans Client as API as Windows App Service and and Orleans Silo as Azure Worker Role as Cloud Services but we not able to connect web api to silo. Below are the error we get when trying to access the sites.

Silo Error :
Microsoft.WindowsAzure.ServiceRuntime.RoleEnvironment.StartRoleInternal() at Microsoft.WindowsAzure.ServiceRuntime.Implementation.Loader.RoleRuntimeBridge.<StartRole>b__2() at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext ContextCallback callback Object state Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext ContextCallback callback Object state Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext ContextCallback callback Object state) at System.Threading.ThreadHelper.ThreadStart() Inner Exception: No such host is known at System.Net.Dns.GetAddrInfo(String name) at System.Net.Dns.InternalGetHostByName(String hostName Boolean includeIPv6) at System.Net.Dns.GetHostEntry(String hostNameOrAddress) at Silo.WorkerRole.<>c__DisplayClass6_0.<StartSilo>b__3(EndpointOptions opt) in E:\Aniketh\Experimental Projects\Zipped Projects\OrleansPOC\Orleans-Azure-POC\src\Silo\WorkerRole.cs:line 108 at Microsoft.Extensions.Options.ConfigureNamedOptions1.LazyInitValue() at Orleans.Configuration.EndpointOptionsValidator.ValidateConfiguration() in D:\build\agent\_work\12\s\src\Orleans.Runtime\Configuration\Validators\EndpointOptionsValidator.cs:line 25 at Orleans.Hosting.SiloHostBuilder.ValidateSystemConfiguration(IServiceProvider serviceProvider) in D:\build\agent\_work\12\s\src\Orleans.Runtime\Hosting\Generic\SiloHostBuilder.cs:line 159 at Orleans.Hosting.SiloHostBuilder.Build() in D:\build\agent\_work\12\s\src\Orleans.Runtime\Hosting\Generic\SiloHostBuilder.cs:line 43 at Silo.WorkerRole.<StartSilo>d__6.MoveNext() in E:\Aniketh\Experimental Projects\Zipped Projects\OrleansPOC\Orleans-Azure-POC\src\Silo\WorkerRole.cs:line 152 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Silo.WorkerRole.<RunAsync>d__5.MoveNext() in E:\Aniketh\Experimental Projects\Zipped Projects\OrleansPOC\Orleans-Azure-POC\src\Silo\WorkerRole.cs:line","Azure App Service (Web API) cannot connect to Orleans Cloud Service Silo as Worker Role Hi Team

We have hosted Orleans Client as API as Windows App Service and and Orleans Silo as Azure Worker Role as Cloud Services but we not able to connect web api to silo. Below are the error we get when trying to access the sites.

Silo Error :
Microsoft.WindowsAzure.ServiceRuntime.RoleEnvironment.StartRoleInternal() at Microsoft.WindowsAzure.ServiceRuntime.Implementation.Loader.RoleRuntimeBridge.<StartRole>b__2() at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext ContextCallback callback Object state Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext ContextCallback callback Object state Boolean preserveSyncCtx) at System.Threading.ExecutionContext.Run(ExecutionContext executionContext ContextCallback callback Object state) at System.Threading.ThreadHelper.ThreadStart() Inner Exception: No such host is known at System.Net.Dns.GetAddrInfo(String name) at System.Net.Dns.InternalGetHostByName(String hostName Boolean includeIPv6) at System.Net.Dns.GetHostEntry(String hostNameOrAddress) at Silo.WorkerRole.<>c__DisplayClass6_0.<StartSilo>b__3(EndpointOptions opt) in E:\Aniketh\Experimental Projects\Zipped Projects\OrleansPOC\Orleans-Azure-POC\src\Silo\WorkerRole.cs:line 108 at Microsoft.Extensions.Options.ConfigureNamedOptions1.LazyInitValue() at Orleans.Configuration.EndpointOptionsValidator.ValidateConfiguration() in D:\build\agent\_work\12\s\src\Orleans.Runtime\Configuration\Validators\EndpointOptionsValidator.cs:line 25 at Orleans.Hosting.SiloHostBuilder.ValidateSystemConfiguration(IServiceProvider serviceProvider) in D:\build\agent\_work\12\s\src\Orleans.Runtime\Hosting\Generic\SiloHostBuilder.cs:line 159 at Orleans.Hosting.SiloHostBuilder.Build() in D:\build\agent\_work\12\s\src\Orleans.Runtime\Hosting\Generic\SiloHostBuilder.cs:line 43 at Silo.WorkerRole.<StartSilo>d__6.MoveNext() in E:\Aniketh\Experimental Projects\Zipped Projects\OrleansPOC\Orleans-Azure-POC\src\Silo\WorkerRole.cs:line 152 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Silo.WorkerRole.<RunAsync>d__5.MoveNext() in E:\Aniketh\Experimental Projects\Zipped Projects\OrleansPOC\Orleans-Azure-POC\src\Silo\WorkerRole.cs:line",,sergeybykov,,
5613,What is the Relaese date for Microsoft Orleans which can support service fabric?,"Hi Team 

We are planning to introduce Microsoft Orleans to our Service Fabric Cluster but we observed some limitation in existing Orleans as per few documentation Microsoft.Orleans.Clustering.ServiceFabric is not available since the release of orleans 2.0. 
So can we know by when a new version will be released which is capable to host in Service Fabric? 

We believe the new version supports both .NET Core and .NET Framework. 

Thanks Sandeep.
","What is the Relaese date for Microsoft Orleans which can support service fabric? Hi Team 

We are planning to introduce Microsoft Orleans to our Service Fabric Cluster but we observed some limitation in existing Orleans as per few documentation Microsoft.Orleans.Clustering.ServiceFabric is not available since the release of orleans 2.0. 
So can we know by when a new version will be released which is capable to host in Service Fabric? 

We believe the new version supports both .NET Core and .NET Framework. 

Thanks Sandeep.
",,sergeybykov,,
5612,Memory  increased by 10%  since Orleans upgraded from 2.2.4 to 2.3.2,Memory usage has doubled since Orleans upgraded from 2.2.4 to 2.3.2,Memory  increased by 10%  since Orleans upgraded from 2.2.4 to 2.3.2 Memory usage has doubled since Orleans upgraded from 2.2.4 to 2.3.2,,sergeybykov,,
5611,Exceptions when using aspnetcore preview 5,"Hello

I just made the simplest app possible with orleans and aspnetcore preview 5

","Exceptions when using aspnetcore preview 5 Hello

I just made the simplest app possible with orleans and aspnetcore preview 5

",,ReubenBond,,
5609,Document [OneWay] attribute,Couldn't find any information about  attribute from http://dotnet.github.io/orleans/Documentation. But found pull request and tests now I know I need to add it to interface and method there.,Document [OneWay] attribute Couldn't find any information about  attribute from http://dotnet.github.io/orleans/Documentation. But found pull request and tests now I know I need to add it to interface and method there.,documentation,sergeybykov,13/05/2019 21:24,
5607,Implement TaskScheduler.GetScheduledTasks() for debuggers,"Currently we have two implementations of ](https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.taskscheduler.getscheduledtasks?view=netframework-4.8) faithfully: our implementations return an empty array instead of a collection of currently scheduled tasks.

This doesn't affect behavior at runtime but can affect the debugging experience. For example the Tasks & Parallel Stacks (Tasks) views may not work correctly.","Implement TaskScheduler.GetScheduledTasks() for debuggers Currently we have two implementations of ](https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.taskscheduler.getscheduledtasks?view=netframework-4.8) faithfully: our implementations return an empty array instead of a collection of currently scheduled tasks.

This doesn't affect behavior at runtime but can affect the debugging experience. For example the Tasks & Parallel Stacks (Tasks) views may not work correctly.",,ReubenBond,,
5606,Remove legacy packages,Removes legacy configuration (,Remove legacy packages Removes legacy configuration (,,jason-bragg,,
5605,Test reliability: AccountWithLog,"I've seen this fail frequently in recent times.



Eg: https://orleans.visualstudio.com/GitHub%20-%20PR%20Builds/_build/results?buildId=20181&view=ms.vss-test-web.build-test-results-tab&runId=1010344&resultId=101116&paneView=debug","Test reliability: AccountWithLog I've seen this fail frequently in recent times.



Eg: https://orleans.visualstudio.com/GitHub%20-%20PR%20Builds/_build/results?buildId=20181&view=ms.vss-test-web.build-test-results-tab&runId=1010344&resultId=101116&paneView=debug",test-issue,ReubenBond,10/05/2019 23:53,
5603,Feedback: Simplify the Streaming Interfaces,"I've been working on #5527 and trying to understand a lot of how the stream provider works and I wanted to provide some constructive feedback on it. My perspective coming into this is that I'm looking to implement a mostly pure-AMQP stream provider (RabbitMQ) and add it to the project. It's entirely possible that I missed the intent of some of the existing interfaces they aren't documented well and the formal documentation isn't much more helpful. I wanted to see how far I could get before providing feedback.

Right now with how many design decisions the stream interfaces forces me to make I've been considering just adding a stream consumer middleware in my system and then each message received will just call a grain. Personally I'm on the fence with the streaming provider's readiness for a production workload but I'm hoping some of the feedback can start to guide the streaming interfaces in the right way.

### Design Decisions

From the outside looking in the idea of having an internal stream provider which arbitrates on behalf of stream providers is a great idea and I think that was definitely a great decision. However I think the current implementation forces too many decisions on a given external provider and it forces extension devs to implement things strictly which isn't that great. I think the big forcing design decisions are ","Feedback: Simplify the Streaming Interfaces I've been working on #5527 and trying to understand a lot of how the stream provider works and I wanted to provide some constructive feedback on it. My perspective coming into this is that I'm looking to implement a mostly pure-AMQP stream provider (RabbitMQ) and add it to the project. It's entirely possible that I missed the intent of some of the existing interfaces they aren't documented well and the formal documentation isn't much more helpful. I wanted to see how far I could get before providing feedback.

Right now with how many design decisions the stream interfaces forces me to make I've been considering just adding a stream consumer middleware in my system and then each message received will just call a grain. Personally I'm on the fence with the streaming provider's readiness for a production workload but I'm hoping some of the feedback can start to guide the streaming interfaces in the right way.

### Design Decisions

From the outside looking in the idea of having an internal stream provider which arbitrates on behalf of stream providers is a great idea and I think that was definitely a great decision. However I think the current implementation forces too many decisions on a given external provider and it forces extension devs to implement things strictly which isn't that great. I think the big forcing design decisions are ",,sergeybykov,,
5601,Support runtime code generation in source analysis code generator,Currently the ,Support runtime code generation in source analysis code generator Currently the ,codegen,ReubenBond,,
5597,Fix potential NullReferenceException in PersistentStreamProvider,,Fix potential NullReferenceException in PersistentStreamProvider ,,xiazen,,
5593, The given key 'ReminderService' was not present in the dictionary,"1. Create  a  ReminderGrain 
public class ReminderGrain : GrainBase IReminderGrain
    {
        public async Task<IGrainReminder> StartReminderAsync(string reminderName TimeSpan dueTime TimeSpan period)
        {
            return await RegisterOrUpdateReminder(reminderName dueTime period);
        }

        public Task ReceiveReminder(string reminderName TickStatus status)
        {
            Console.WriteLine($""我是定时器{reminderName}，自动执行首次执行时间：{status.FirstTickTime.ToString()}；当前执行时间{status.CurrentTickTime.ToString()}"");
            return Task.CompletedTask;
        }
    }
2. Create a database by executing the MySQL-Reminders.sql file.
3. In Program UseAdoNetReminderService
 var builder = new SiloHostBuilder()
                // Membership
                .UseAdoNetClustering(options =>
                {
                    options.Invariant = configurationRoot[""OrleansSetting:AdoNetClustering:Invariant""];
                    options.ConnectionString = configurationRoot[""OrleansSetting:AdoNetClustering:ConnectionString""];
                })
                .UseAdoNetReminderService(options =>
                {
                    options.Invariant = configurationRoot[""OrleansSetting:AdoNetReminderService:Invariant""];
                    options.ConnectionString = configurationRoot[""OrleansSetting:AdoNetReminderService:ConnectionString""];
                })

3. Start SiloHost Throw Exception：
Exception during Silo.Start
Orleans.Runtime.OrleansLifecycleCanceledException: Lifecycle start canceled due to errors at stage 20000 ---> System.Collections.Generic.KeyNotFoundException: The given key 'ReminderService' was not present in the dictionary.
   at System.Collections.Generic.Dictionary2 action) in D:\build\agent\_work\12\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 115
   at Orleans.LifecycleSubject.OnStart(CancellationToken ct) in D:\build\agent\_work\12\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 55
   --- End of inner exception stack trace ---
   at Orleans.LifecycleSubject.OnStart(CancellationToken ct) in D:\build\agent\_work\12\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 63
   at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.Execute() in D:\build\agent\_work\12\s\src\Orleans.Runtime\Scheduler\ClosureWorkItem.cs:line 63
   at Orleans.Runtime.Silo.StartAsync(CancellationToken cancellationToken) in D:\build\agent\_work\12\s\src\Orleans.Runtime\Silo\Silo.cs:line 265
"," The given key 'ReminderService' was not present in the dictionary 1. Create  a  ReminderGrain 
public class ReminderGrain : GrainBase IReminderGrain
    {
        public async Task<IGrainReminder> StartReminderAsync(string reminderName TimeSpan dueTime TimeSpan period)
        {
            return await RegisterOrUpdateReminder(reminderName dueTime period);
        }

        public Task ReceiveReminder(string reminderName TickStatus status)
        {
            Console.WriteLine($""我是定时器{reminderName}，自动执行首次执行时间：{status.FirstTickTime.ToString()}；当前执行时间{status.CurrentTickTime.ToString()}"");
            return Task.CompletedTask;
        }
    }
2. Create a database by executing the MySQL-Reminders.sql file.
3. In Program UseAdoNetReminderService
 var builder = new SiloHostBuilder()
                // Membership
                .UseAdoNetClustering(options =>
                {
                    options.Invariant = configurationRoot[""OrleansSetting:AdoNetClustering:Invariant""];
                    options.ConnectionString = configurationRoot[""OrleansSetting:AdoNetClustering:ConnectionString""];
                })
                .UseAdoNetReminderService(options =>
                {
                    options.Invariant = configurationRoot[""OrleansSetting:AdoNetReminderService:Invariant""];
                    options.ConnectionString = configurationRoot[""OrleansSetting:AdoNetReminderService:ConnectionString""];
                })

3. Start SiloHost Throw Exception：
Exception during Silo.Start
Orleans.Runtime.OrleansLifecycleCanceledException: Lifecycle start canceled due to errors at stage 20000 ---> System.Collections.Generic.KeyNotFoundException: The given key 'ReminderService' was not present in the dictionary.
   at System.Collections.Generic.Dictionary2 action) in D:\build\agent\_work\12\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 115
   at Orleans.LifecycleSubject.OnStart(CancellationToken ct) in D:\build\agent\_work\12\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 55
   --- End of inner exception stack trace ---
   at Orleans.LifecycleSubject.OnStart(CancellationToken ct) in D:\build\agent\_work\12\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 63
   at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.Execute() in D:\build\agent\_work\12\s\src\Orleans.Runtime\Scheduler\ClosureWorkItem.cs:line 63
   at Orleans.Runtime.Silo.StartAsync(CancellationToken cancellationToken) in D:\build\agent\_work\12\s\src\Orleans.Runtime\Silo\Silo.cs:line 265
",,sergeybykov,,
5591,Question on TransactionOptions,"Which TransactionOption should i use when i just want to read the committed state of the grain via the ITransactionalState facet without participating in a transaction? I just want to retrieve a ""snapshot"" of the currently committed state of the transaction. Will the TransactionOption.Suppress work?","Question on TransactionOptions Which TransactionOption should i use when i just want to read the committed state of the grain via the ITransactionalState facet without participating in a transaction? I just want to retrieve a ""snapshot"" of the currently committed state of the transaction. Will the TransactionOption.Suppress work?",,xiazen,,
5590,Documentation | Unit Testing,"- [ ] https://dotnet.github.io/orleans/1.5/Tutorials/Unit-Testing-Grains.html missing old version **warning-banner**
- [ ] https://dotnet.github.io/orleans/Documentation/tutorials_and_samples/testing.html outdated?

The code specified in that document

Results

> ERROR: There is no argument given that corresponds to the required formal parameter **options**.

","Documentation | Unit Testing - [ ] https://dotnet.github.io/orleans/1.5/Tutorials/Unit-Testing-Grains.html missing old version **warning-banner**
- [ ] https://dotnet.github.io/orleans/Documentation/tutorials_and_samples/testing.html outdated?

The code specified in that document

Results

> ERROR: There is no argument given that corresponds to the required formal parameter **options**.

",documentation,sergeybykov,9/05/2019 18:26,
5589,Add Analyzers to Orleans,#NAME?,"Add Analyzers to Orleans - Setup basic Analyzer project
- Setup basic Tests project
- Create analyzer for AlwaysInterleaveAttribute",,ReubenBond,,
5588,Execute tasks scheduled against defunct activations,"Currently ). The error will then be logged at most once per minute per activation.

This allows systems to continue functioning when a library misbehaves and gives the application developer more tools to find the misbehaving code.

Since this allows grain code to continue executing after being deactivated (eg due to an end-user programming error) this PR also adds additional runtime checks so that invalid activations cannot access runtime services as easily.","Execute tasks scheduled against defunct activations Currently ). The error will then be logged at most once per minute per activation.

This allows systems to continue functioning when a library misbehaves and gives the application developer more tools to find the misbehaving code.

Since this allows grain code to continue executing after being deactivated (eg due to an end-user programming error) this PR also adds additional runtime checks so that invalid activations cannot access runtime services as easily.",,benjaminpetit,,
5586,Implement IApplicationLifetime for ClientBuilder/SiloHostBuilder,This is a pre-requisite for #5436 which uses .,Implement IApplicationLifetime for ClientBuilder/SiloHostBuilder This is a pre-requisite for #5436 which uses .,,jason-bragg,,
5585,Groundwork for span-friendly serialization,This is a pre-requisite for #5436 and lays some groundwork for a more span-friendly serializer (networking replat is based on pipes which use Span<byte>/Memory<byte>),Groundwork for span-friendly serialization This is a pre-requisite for #5436 and lays some groundwork for a more span-friendly serializer (networking replat is based on pipes which use Span<byte>/Memory<byte>),,xiazen,,
5584,Provide separate options for worker & IO pool min thread counts,"Set defaults to 0 (no minimum set)

During development of #5436 the default value for these thread pools was found to be a detrimental to throughput.

It is better to avoid setting a minimum and instead allow users to follow general .NET guidance on setting thread pool limits.","Provide separate options for worker & IO pool min thread counts Set defaults to 0 (no minimum set)

During development of #5436 the default value for these thread pools was found to be a detrimental to throughput.

It is better to avoid setting a minimum and instead allow users to follow general .NET guidance on setting thread pool limits.",,sergeybykov,,
5583,Fix packaging warning in Orleans.CodeGenerator.MSBuild,The  files are already included and including them multiple times causes a packaging warning,Fix packaging warning in Orleans.CodeGenerator.MSBuild The  files are already included and including them multiple times causes a packaging warning,,benjaminpetit,,
5580,Refactor EventHubDataAdapter to be plugable,"Attempting to address ""Stream data adapter #4621"" for EventHub streams.
EventHubDataAdapter is now pluggable.  It can now be configured without customizing queue adapter or cache.

Other changes:
- Simplified pooled cache to only use CachedMessage
- Simplified eviction strategy to only use CachedMessage
- Removed the need for custom comparer logic.
- Added interned stream namespace to CachedMessage to prevent the need to encode it into pooled memory segment.
- Refactored IQueueDataAdapter to support common send behaviors.

Overall pooled cache pattern is much cleaner and maintainable at the cost of some customizability.","Refactor EventHubDataAdapter to be plugable Attempting to address ""Stream data adapter #4621"" for EventHub streams.
EventHubDataAdapter is now pluggable.  It can now be configured without customizing queue adapter or cache.

Other changes:
- Simplified pooled cache to only use CachedMessage
- Simplified eviction strategy to only use CachedMessage
- Removed the need for custom comparer logic.
- Added interned stream namespace to CachedMessage to prevent the need to encode it into pooled memory segment.
- Refactored IQueueDataAdapter to support common send behaviors.

Overall pooled cache pattern is much cleaner and maintainable at the cost of some customizability.",,xiazen,,
5579,Health Check Sample,"Orleans Health Check Sample

Targets:
* .NET Core 2.2
* Orleans 2.3.1
* ASP.NET Core 2.2

Based on prior art from [ReubenBond](https://github.com/dotnet/orleans/issues/4843#issuecomment-478055180) and [DarkCow](https://github.com/dotnet/orleans/issues/4843#issuecomment-479576394).

In addition to the code I would appreciate a review of the readme file for technical correctness. Some bits are to the best of my current knowledge and may be wrong or outdated. Thanks in advance.

Closes #5486 ","Health Check Sample Orleans Health Check Sample

Targets:
* .NET Core 2.2
* Orleans 2.3.1
* ASP.NET Core 2.2

Based on prior art from [ReubenBond](https://github.com/dotnet/orleans/issues/4843#issuecomment-478055180) and [DarkCow](https://github.com/dotnet/orleans/issues/4843#issuecomment-479576394).

In addition to the code I would appreciate a review of the readme file for technical correctness. Some bits are to the best of my current knowledge and may be wrong or outdated. Thanks in advance.

Closes #5486 ",,ReubenBond,,
5578,Documentation | Graceful shutdown - Docker app,"In [Shutting down Orleans | Microsoft Orleans Documentation](https://dotnet.github.io/orleans/Documentation/clusters_and_clients/configuration_guide/shutting_down_orleans.html)  mentioned as **To be completed**.

Putting at least a reference to [orleans/Samples/2.0/docker-aspnet-core/Silo/Program.cs](https://github.com/dotnet/orleans/blob/master/Samples/2.0/docker-aspnet-core/Silo/Program.cs) would be good.

The doc for the same can be found here - [shutting_down_orleans.md](https://github.com/dotnet/orleans/blob/docs/src/Documentation/clusters_and_clients/configuration_guide/shutting_down_orleans.md/#L1)","Documentation | Graceful shutdown - Docker app In [Shutting down Orleans | Microsoft Orleans Documentation](https://dotnet.github.io/orleans/Documentation/clusters_and_clients/configuration_guide/shutting_down_orleans.html)  mentioned as **To be completed**.

Putting at least a reference to [orleans/Samples/2.0/docker-aspnet-core/Silo/Program.cs](https://github.com/dotnet/orleans/blob/master/Samples/2.0/docker-aspnet-core/Silo/Program.cs) would be good.

The doc for the same can be found here - [shutting_down_orleans.md](https://github.com/dotnet/orleans/blob/docs/src/Documentation/clusters_and_clients/configuration_guide/shutting_down_orleans.md/#L1)",,benjaminpetit,,
5577,NoOp delete when ETag is null in AzureTableStorage provider,"This is to prevent exceptions from Azure Storage SDK when Delete is called with  i.e. when state for that grain hasn't been written to the storage.

Closes #5219 ","NoOp delete when ETag is null in AzureTableStorage provider This is to prevent exceptions from Azure Storage SDK when Delete is called with  i.e. when state for that grain hasn't been written to the storage.

Closes #5219 ",,jason-bragg,,
5576,Cherry-pick #5570 and #5575 for 2.3.2,"Prevent NullReferenceException with some storage providers when state is Nullable<T> (#5570)
Accommodate existing RequestContext.PropagateActivityId value in ClusterClient (#5575)","Cherry-pick #5570 and #5575 for 2.3.2 Prevent NullReferenceException with some storage providers when state is Nullable<T> (#5570)
Accommodate existing RequestContext.PropagateActivityId value in ClusterClient (#5575)",,ReubenBond,,
5574,[WIP] Remove base class from [ClientSilo]MessagingOptions,"This separates the .

This is a breaking change: users may have to fix some code so that their application continues to compile.

Effectively subsumes #4753.","[WIP] Remove base class from [Client,Silo]MessagingOptions This separates the .

This is a breaking change: users may have to fix some code so that their application continues to compile.

Effectively subsumes #4753.",,xiazen,,
5573,Cherry-pick #5561 for 2.3.2,On the client close gateway connection to dead silos (#5561),Cherry-pick #5561 for 2.3.2 On the client close gateway connection to dead silos (#5561),,benjaminpetit,,
5572,I need someone who can write a customized version of the msbuild task,"This is off-topic from Orleans issues but I'll put it out there.

I have a solution that is built up from an interface based meta-model.

It outputs CSharp C++ Typescript/JavaScript & Go client proxies as well as a socket gateway handler used to communicate with the Orleans cluster(s). 

To date I have used reflection with a post build task but would like to migrate it to a build task using code analysis the same way Orleans does.

My ask is simple. Is there anyone out there with the time and experience to do the work?

rich","I need someone who can write a customized version of the msbuild task This is off-topic from Orleans issues but I'll put it out there.

I have a solution that is built up from an interface based meta-model.

It outputs CSharp C++ Typescript/JavaScript & Go client proxies as well as a socket gateway handler used to communicate with the Orleans cluster(s). 

To date I have used reflection with a post build task but would like to migrate it to a build task using code analysis the same way Orleans does.

My ask is simple. Is there anyone out there with the time and experience to do the work?

rich",,sergeybykov,,
5571,Tutorial.Minimal building errors,"I have downloaded the Orleans.master and tryed to build the Tutorial.Minimal sample in VS2017.
But
1. There are yellow mark on Orleans.CodeGeneration.Build.Bootstrap in the GrainInterfaces and GrainCollection 
2. During the building I receive
		

What can I fix?
","Tutorial.Minimal building errors I have downloaded the Orleans.master and tryed to build the Tutorial.Minimal sample in VS2017.
But
1. There are yellow mark on Orleans.CodeGeneration.Build.Bootstrap in the GrainInterfaces and GrainCollection 
2. During the building I receive
		

What can I fix?
",,sergeybykov,,
5570,Prevent NullReferenceException with some storage providers when state is Nullable<T>,"Fixes #5569 

The change has been tested in a real cluster.","Prevent NullReferenceException with some storage providers when state is Nullable<T> Fixes #5569 

The change has been tested in a real cluster.",,jason-bragg,,
5569,Possible NullReferenceException in AzureTableStorage.ReadStateAsync for Grain<Nullable<T>>,"If .

I'm going to submit a PR that fixes that shortly.","Possible NullReferenceException in AzureTableStorage.ReadStateAsync for Grain<Nullable<T>> If .

I'm going to submit a PR that fixes that shortly.",,jason-bragg,,
5568,"""Failed to get a local IP address"" on Linux with localhost clustering","**OS**: Arch Linux updated 30.04.2019
**Linux kernel**: 5.0.10-arch1-1-ARCH
**Orleans version**: 2.2.0

**What happened**:
I am creating a cluster with UseLocalhostClustering but I cannot connect from a client running on the same machine without having internet connection (or when on a tethered connection).
I suspect this is due to the loopback address having UNKNOWN state.

Related to #5097.

Stacktrace of the error:


Finally it would be nice if there was an option for forcing a custom IP address and bypassing automatic IP address selection.
","""Failed to get a local IP address"" on Linux with localhost clustering **OS**: Arch Linux updated 30.04.2019
**Linux kernel**: 5.0.10-arch1-1-ARCH
**Orleans version**: 2.2.0

**What happened**:
I am creating a cluster with UseLocalhostClustering but I cannot connect from a client running on the same machine without having internet connection (or when on a tethered connection).
I suspect this is due to the loopback address having UNKNOWN state.

Related to #5097.

Stacktrace of the error:


Finally it would be nice if there was an option for forcing a custom IP address and bypassing automatic IP address selection.
",,benjaminpetit,,
5565,NullReferenceException when you catch exceptions,"Hi
when you just catch execptions with a filter like:



you get a NullReferenceException. I think such a filter should be allowed for grains that void result (Task).
","NullReferenceException when you catch exceptions Hi
when you just catch execptions with a filter like:



you get a NullReferenceException. I think such a filter should be allowed for grains that void result (Task).
",,ReubenBond,,
5563,AsyncLocal values flow into timer callbacks and stream observers,"The values of AsyncLocals will flow into timer callbacks and stream observers from their registration point. RequestContext uses an AsyncLocal to manage properties which is probably why they are like this but it shouldn't affect all AsyncLocals.

This is quite unintuitive for me because I would only expect these to flow whenever I call an async method.

In my project ","AsyncLocal values flow into timer callbacks and stream observers The values of AsyncLocals will flow into timer callbacks and stream observers from their registration point. RequestContext uses an AsyncLocal to manage properties which is probably why they are like this but it shouldn't affect all AsyncLocals.

This is quite unintuitive for me because I would only expect these to flow whenever I call an async method.

In my project ",,ReubenBond,,
5562,request to add Chinese documents,request to add Chinese documents,request to add Chinese documents request to add Chinese documents,documentation,sergeybykov,28/04/2019 16:42,
5561,On the client close gateway connection to dead silos,Fix for #5560 ,"On the client, close gateway connection to dead silos Fix for #5560 ",,ReubenBond,,
5560,Client does not close connection to a dead Silo,If a Silo stop responding to other silos for some reason it will be voted  but for some reason its socket are still open clients will continue to send message to this faulty silo.,Client does not close connection to a dead Silo If a Silo stop responding to other silos for some reason it will be voted  but for some reason its socket are still open clients will continue to send message to this faulty silo.,bug,benjaminpetit,,
5559,Update changelog for 2.3.1,,Update changelog for 2.3.1 ,,ReubenBond,,
5558,Hosting Silo as Azure App Service Throws Error,I am facing issues when deploying Silo as Azure App Service it throws error when i request from client.,Hosting Silo as Azure App Service Throws Error I am facing issues when deploying Silo as Azure App Service it throws error when i request from client.,,ReubenBond,,
5557,implicit subscription not working on heterogeneous silos,"I have a heterogeneous silos environment. 
Silo1: GrainA class with an implicit subscription on the namespace 'topic'
Silo2: without GrainA

When the associated queue's pull-agent was activated on Silo2 the pull-agent can't obtain the GrainA information to complete  be able to apply to the grain interface? 
","implicit subscription not working on heterogeneous silos I have a heterogeneous silos environment. 
Silo1: GrainA class with an implicit subscription on the namespace 'topic'
Silo2: without GrainA

When the associated queue's pull-agent was activated on Silo2 the pull-agent can't obtain the GrainA information to complete  be able to apply to the grain interface? 
",,benjaminpetit,,
5556,Specify Bond Serializer for the MsBuildTask,"Question...
How do I tell the MsBuildTask to use the Bond Serializer?

regards
rich","Specify Bond Serializer for the MsBuildTask Question...
How do I tell the MsBuildTask to use the Bond Serializer?

regards
rich",question,ReubenBond,,
5554,Cherry-picked fixes for 2.3.1,,Cherry-picked fixes for 2.3.1 ,,benjaminpetit,,
5553,Provide a Direct Client Example,"According to a comment to [a question of mine in SO](https://stackoverflow.com/questions/55832345/can-i-use-orleans-for-in-process-actors-grains?noredirect=1#comment98346266_55832345)

> Yes it's possible out of the box in Orleans 2.3. They have a ""hosted client"" (sometimes referred to as a ""direct client"") in the service container by default. Unfortunately there are no docs for it yet. Additionally it looks like you're using Orleankka. I haven't looked at that library in detail so I'm not sure how configuration of the silo with a hosted client differs (if at all) from vanilla Orleans. 

Would be it possible to provide a simple example where two grains communicate with each other with that sort of direct client and the simplest silo possible ever I just want something to startup (note: not using Orleankka).","Provide a Direct Client Example According to a comment to [a question of mine in SO](https://stackoverflow.com/questions/55832345/can-i-use-orleans-for-in-process-actors-grains?noredirect=1#comment98346266_55832345)

> Yes it's possible out of the box in Orleans 2.3. They have a ""hosted client"" (sometimes referred to as a ""direct client"") in the service container by default. Unfortunately there are no docs for it yet. Additionally it looks like you're using Orleankka. I haven't looked at that library in detail so I'm not sure how configuration of the silo with a hosted client differs (if at all) from vanilla Orleans. 

Would be it possible to provide a simple example where two grains communicate with each other with that sort of direct client and the simplest silo possible ever I just want something to startup (note: not using Orleankka).",,ReubenBond,,
5548,System.Collections.Generic.KeyNotFoundException: Type System.Collections.Generic.IList<ZLHP.Message.Contract.Dtos.MessageDto> does not have a member of kind Microsoft.CodeAnalysis.IMethodSymbol named GetAwaiter,"add a method generate code throw this exception
![image](https://user-images.githubusercontent.com/13807716/56658225-a76fe300-66cc-11e9-873a-24094935ba78.png)

![image](https://user-images.githubusercontent.com/13807716/56658178-8dce9b80-66cc-11e9-8c15-39b5a440a3dc.png)
","System.Collections.Generic.KeyNotFoundException: Type System.Collections.Generic.IList<ZLHP.Message.Contract.Dtos.MessageDto> does not have a member of kind Microsoft.CodeAnalysis.IMethodSymbol named GetAwaiter add a method generate code throw this exception
![image](https://user-images.githubusercontent.com/13807716/56658225-a76fe300-66cc-11e9-873a-24094935ba78.png)

![image](https://user-images.githubusercontent.com/13807716/56658178-8dce9b80-66cc-11e9-8c15-39b5a440a3dc.png)
",,sergeybykov,,
5546,After enabling cleaning of dead entries occour NotImplementedException.,"Orleans Version is:2.3.0
Membership:Consul

SiloConfig:


After silo starts it prompts the following error:

fail: Orleans.Runtime.MembershipService.MembershipOracleData[100662]
      DeleteDeadMembershipTableEntries operation is not supported by the current implementation of IMembershipTable. Disabling the timer now.","After enabling cleaning of dead entries occour NotImplementedException. Orleans Version is:2.3.0
Membership:Consul

SiloConfig:


After silo starts it prompts the following error:

fail: Orleans.Runtime.MembershipService.MembershipOracleData[100662]
      DeleteDeadMembershipTableEntries operation is not supported by the current implementation of IMembershipTable. Disabling the timer now.",,benjaminpetit,,
5544,Orleans Core Project - Host Silo or Client Using Azure ,"Hi

I have created a project using .net core (console) for Silo and .net core (API) for Client. I am able to run using local development with Azure Storage Clustering but is there any helpful resources for deploying to cloud for .net core referenced projects.","Orleans Core Project - Host Silo or Client Using Azure  Hi

I have created a project using .net core (console) for Silo and .net core (API) for Client. I am able to run using local development with Azure Storage Clustering but is there any helpful resources for deploying to cloud for .net core referenced projects.",question,sergeybykov,,
5542,Issues with stateless workers producing SMS stream events,"Events produced by stateless worker grains aren't always delivered to consumers for SMS.
Digging into this the problems seems to be related to the . When the worker first produces an event everything works fine. The extension is installed and it is registered with pub sub.
The problem starts when a new consumer is added and the pub sub tried to notify producers about it. Since it is a stateless worker the notification isn't guaranteed to go to the same activation. When it goes to a different one the extension isn't installed there and that causes the producer to become unregistered. This is still sort of ok until the original worker tries to produce a new event. At that point it still has the extension so it thinks it knows all of the consumers but it didn't get the previous notification and thus doesn't send to the new consumer.

If producing to SMS from a stateless worker isn't meant to be supported that is fine (I can workaround it) but from the surface I don't think anyone would expect it to not work.","Issues with stateless workers producing SMS stream events Events produced by stateless worker grains aren't always delivered to consumers for SMS.
Digging into this the problems seems to be related to the . When the worker first produces an event everything works fine. The extension is installed and it is registered with pub sub.
The problem starts when a new consumer is added and the pub sub tried to notify producers about it. Since it is a stateless worker the notification isn't guaranteed to go to the same activation. When it goes to a different one the extension isn't installed there and that causes the producer to become unregistered. This is still sort of ok until the original worker tries to produce a new event. At that point it still has the extension so it thinks it knows all of the consumers but it didn't get the previous notification and thus doesn't send to the new consumer.

If producing to SMS from a stateless worker isn't meant to be supported that is fine (I can workaround it) but from the surface I don't think anyone would expect it to not work.",,jason-bragg,,
5541,Get Grain from generic grain id through IGrainFactory,"I am currently developing an abstract base class for a set of worker grains that operate on a parent grain. I want to create a way to get the parent grain.

Here's a simple exmaple of what I'm doing:
 returns a Guid key so GrainWorker would only work for Guid grains. I want to have a way to do this operation in a generic manner without having to duplicate tons of code.

Based off of my minor research it seems like the IInternalGrainFactory methods would be useful in this case but this interface is marked as internal.

As @ReubenBond noted in the Gitter chat issue #1511 is related to this.","Get Grain from generic grain id through IGrainFactory I am currently developing an abstract base class for a set of worker grains that operate on a parent grain. I want to create a way to get the parent grain.

Here's a simple exmaple of what I'm doing:
 returns a Guid key so GrainWorker would only work for Guid grains. I want to have a way to do this operation in a generic manner without having to duplicate tons of code.

Based off of my minor research it seems like the IInternalGrainFactory methods would be useful in this case but this interface is marked as internal.

As @ReubenBond noted in the Gitter chat issue #1511 is related to this.",,ReubenBond,,
5540,Analyzer/CodeGen: block usage of [AlwaysInterleave] on class method," must only be used on the grain *interface* method and not the grain class method.

Users can accidentally add this attribute (and others) in the wrong place and we currently have no way to warn them or stop them.

Add a misuse error to a new analyzer package (better) or to the code generator (easier since the code generator exists).

See also #2841","Analyzer/CodeGen: block usage of [AlwaysInterleave] on class method  must only be used on the grain *interface* method and not the grain class method.

Users can accidentally add this attribute (and others) in the wrong place and we currently have no way to warn them or stop them.

Add a misuse error to a new analyzer package (better) or to the code generator (easier since the code generator exists).

See also #2841",help wanted,sergeybykov,17/04/2019 14:46,10/05/2019 2:47
5539,Dropped fluent support for Named Service Configurator,Note: this will likely break our load and bc tests.  Working on fixes.,Dropped fluent support for Named Service Configurator Note: this will likely break our load and bc tests.  Working on fixes.,,ReubenBond,,
5538,Skip Dispose for skipped streaming tests,"When a test is skipped due to a precondition check failure there is a  because initialization has not occurred.

This avoids the Dispose logic in some streaming tests when initialization did not occur.","Skip Dispose for skipped streaming tests When a test is skipped due to a precondition check failure there is a  because initialization has not occurred.

This avoids the Dispose logic in some streaming tests when initialization did not occur.",,jason-bragg,,
5537,Consul cluster problem,An consul was used to do the cluster to start two silo instances: siloA and siloB but when the siloA instance was shut down the entire service access failed and the siloB kept trying to connect to siloA.How to solve?Thank you very much!,Consul cluster problem An consul was used to do the cluster to start two silo instances: siloA and siloB but when the siloA instance was shut down the entire service access failed and the siloB kept trying to connect to siloA.How to solve?Thank you very much!,,sergeybykov,,
5536,Bug report. StartupTasks will activate the same Grain multiple times,"Some users have confirmed this bug:
start multiple Silos (one adonet cluster) separately their StartupTasks might result in multiple activation of the same Grain instance demo see below.
https://github.com/slango0513/OrleansBugs
It happens about 2 to 3 times every 5 times.

![D0AC9FCEB66868B68E1F5636F7F41243](https://user-images.githubusercontent.com/39337503/56191515-0f845080-605f-11e9-9ba2-2bb68423908c.png)

![F37A4E45334A01045C5540F0E54726D6](https://user-images.githubusercontent.com/39337503/56191524-13b06e00-605f-11e9-81aa-52f2bdbefda8.png)
","Bug report. StartupTasks will activate the same Grain multiple times Some users have confirmed this bug:
start multiple Silos (one adonet cluster) separately their StartupTasks might result in multiple activation of the same Grain instance demo see below.
https://github.com/slango0513/OrleansBugs
It happens about 2 to 3 times every 5 times.

![D0AC9FCEB66868B68E1F5636F7F41243](https://user-images.githubusercontent.com/39337503/56191515-0f845080-605f-11e9-9ba2-2bb68423908c.png)

![F37A4E45334A01045C5540F0E54726D6](https://user-images.githubusercontent.com/39337503/56191524-13b06e00-605f-11e9-81aa-52f2bdbefda8.png)
",,benjaminpetit,,
5535,Fixed build break caused to non-conflicting merge,,Fixed build break caused to non-conflicting merge ,,ReubenBond,,
5534,NullReferenceException in deserialization when mixing serializers,"Hi I have a strange case.

I have an EventConsumerGrain that retrieves events from an event sourcing database and calls an IEventConsumer.

One of these consumers throws a NullReferenceException:



The code where the exception is thrown:

https://github.com/Squidex/squidex/blob/master/src/Squidex.Domain.Apps.Entities/Contents/Text/GrainTextIndexer.cs#L68

As you can see there is only a reference to the grain. The content event cannot be null because of the pattern matching.

If I scale down the cluster to 1 it works so I guess it has something to do with the remote call. But I do not receive details.

EDIT: I am not sure yet but I would say that it only happens under load e.g. when many requests per second are done (~100)","NullReferenceException in deserialization when mixing serializers Hi I have a strange case.

I have an EventConsumerGrain that retrieves events from an event sourcing database and calls an IEventConsumer.

One of these consumers throws a NullReferenceException:



The code where the exception is thrown:

https://github.com/Squidex/squidex/blob/master/src/Squidex.Domain.Apps.Entities/Contents/Text/GrainTextIndexer.cs#L68

As you can see there is only a reference to the grain. The content event cannot be null because of the pattern matching.

If I scale down the cluster to 1 it works so I guess it has something to do with the remote call. But I do not receive details.

EDIT: I am not sure yet but I would say that it only happens under load e.g. when many requests per second are done (~100)",,ReubenBond,,
5532,Serialize grains into memory to avoid GC pressure,"Serialize grains to native or GC handled memory to avoid GC pressure (long GC pauses). This article provides similar approach
https://www.infoq.com/articles/Big-Memory-Part-1
https://www.infoq.com/articles/Big-Memory-Part-2

It could go something like this
- Serialize grain to memory after inactivity timeout or if there is high amount of live grains
- Deserialize grain if it activates or remove serialized grain from memory after another inactivity timeout
","Serialize grains into memory to avoid GC pressure Serialize grains to native or GC handled memory to avoid GC pressure (long GC pauses). This article provides similar approach
https://www.infoq.com/articles/Big-Memory-Part-1
https://www.infoq.com/articles/Big-Memory-Part-2

It could go something like this
- Serialize grain to memory after inactivity timeout or if there is high amount of live grains
- Deserialize grain if it activates or remove serialized grain from memory after another inactivity timeout
",,sergeybykov,,
5531,Direct Client Orleans 2.2,"Hello 
I‘m trying to get my head around using DirectClient which is mentioned in the 2.1 release notes. Looking into the sources of 2.2 it seems like it is already obsolete again. Is there any replacement or how is this feature meant to use?","Direct Client Orleans 2.2 Hello 
I‘m trying to get my head around using DirectClient which is mentioned in the 2.1 release notes. Looking into the sources of 2.2 it seems like it is already obsolete again. Is there any replacement or how is this feature meant to use?",question,ReubenBond,,
5530,Add codegen error for non-awaitable grain interface methods,,Add codegen error for non-awaitable grain interface methods ,,benjaminpetit,,
5529,Can the transaction state provider use other databases or redis? Does the official have any plans for this?,"For . Alternatively you can create and add your own provider.

_Originally posted by @sergeybykov in https://github.com/dotnet/orleans/issues/5125#issuecomment-433463902_

-------------------------------------------------------------------------------------
Can the transaction state provider use other databases or redis? Does the official have any plans for this?
","Can the transaction state provider use other databases or redis? Does the official have any plans for this? For . Alternatively you can create and add your own provider.

_Originally posted by @sergeybykov in https://github.com/dotnet/orleans/issues/5125#issuecomment-433463902_

-------------------------------------------------------------------------------------
Can the transaction state provider use other databases or redis? Does the official have any plans for this?
",question,jason-bragg,,
5528,Cleanup pass of named service configurator,"- Removed component configurator abstraction as it forced duplication of methods in client and silo.
- Reduced NamedServiceConfigurator to a minimal class and moved all behaviors to extension functions.
- Removed duplicate extention functions for azure queue and eventhub streams (these were causing build breaks do to bugs in tooling.
- Public surfaces of all supported streams unchanged (except they build even with tooling bugs) but direct use of base builders like SiloPersistentStreamConfigurator is more awkward.","Cleanup pass of named service configurator - Removed component configurator abstraction as it forced duplication of methods in client and silo.
- Reduced NamedServiceConfigurator to a minimal class and moved all behaviors to extension functions.
- Removed duplicate extention functions for azure queue and eventhub streams (these were causing build breaks do to bugs in tooling.
- Public surfaces of all supported streams unchanged (except they build even with tooling bugs) but direct use of base builders like SiloPersistentStreamConfigurator is more awkward.",,ReubenBond,,
5527,Add RabbitMQ as a Stream Provider,"This is my first significant PR and I think I got some stuff wrong but I wanted to submit it as a draft and work through the feedback while it's still a WIP.

## RabbitMQ Stream Provider

This implements all of the Stream Provider interfaces for formal RabbitMQ support. My team and I (@zednis et al) have a use case for RabbitMQ and since I were going to implement it for our use cases it seemed better to donate the effort for others.

### TODO

I need to address these items before it's ready for a more formal review. Also please let me know if there's anything major I'm missing that's not covered under the list below.

- [ ] Write tests

I used the GCP PubSub provider as the reference item and I saw the tests in the original PR but they've moved locations and I cannot find them. I will also need a way to require RabbitMQ to be available so the test suite can be run. I would love some advice in this area because I'd like for folks to be able to do local testing. RabbitMQ server is licensed with the Mozilla Public License 1.1 so there should be no distribution concerns when working with the RabbitMQ server binaries.

- [ ] Pull design pattern

The C# RabbitMQ client is designed to be very simple with a totally hidden implementation. As part of that it when I was working through the implementation it felt really clunky and didn't seem to mesh well with the current provider interface designs for Stream Providers. I would love to hear some feedback on the design pattern that I used to make sure it feels _right_ because it feels a bit wrong to me. Some of this is likely because of the RabbitMQ client implementation but I'd love some more constructive feedback on the topic.

- [ ] Pushing API?

Are there any plans for a more asynchronous queue layer? RabbitMQ is a provider that would benefit from that as there is first class support for pushing messages to the client.

- [ ] AMQP Interfaces?

Are there any plans for an interface that's a bit closer to the core AMQP design patterns? It would've been super useful to be able to have backend primitives/interfaces that were much more closely aligned with Exchanges Queues Dead Lettering etc.

- [ ] Nuget Package

I need to make a Nuget package out of this but I'm not sure how that works.

- [ ] Error Codes?

The GCP provider has error codes. I didn't implement any specific error codes is that something I need to do? If so is there guidance on how to go about that?

- [ ] Namespace

I didn't know what to put for the namespace so I put  at the time. I'm happy to fix the namespacing to whatever the group things.

Edit: namespace comments.

Signed-off-by: Mike Lloyd <mike@reboot3times.org>","Add RabbitMQ as a Stream Provider This is my first significant PR and I think I got some stuff wrong but I wanted to submit it as a draft and work through the feedback while it's still a WIP.

## RabbitMQ Stream Provider

This implements all of the Stream Provider interfaces for formal RabbitMQ support. My team and I (@zednis et al) have a use case for RabbitMQ and since I were going to implement it for our use cases it seemed better to donate the effort for others.

### TODO

I need to address these items before it's ready for a more formal review. Also please let me know if there's anything major I'm missing that's not covered under the list below.

- [ ] Write tests

I used the GCP PubSub provider as the reference item and I saw the tests in the original PR but they've moved locations and I cannot find them. I will also need a way to require RabbitMQ to be available so the test suite can be run. I would love some advice in this area because I'd like for folks to be able to do local testing. RabbitMQ server is licensed with the Mozilla Public License 1.1 so there should be no distribution concerns when working with the RabbitMQ server binaries.

- [ ] Pull design pattern

The C# RabbitMQ client is designed to be very simple with a totally hidden implementation. As part of that it when I was working through the implementation it felt really clunky and didn't seem to mesh well with the current provider interface designs for Stream Providers. I would love to hear some feedback on the design pattern that I used to make sure it feels _right_ because it feels a bit wrong to me. Some of this is likely because of the RabbitMQ client implementation but I'd love some more constructive feedback on the topic.

- [ ] Pushing API?

Are there any plans for a more asynchronous queue layer? RabbitMQ is a provider that would benefit from that as there is first class support for pushing messages to the client.

- [ ] AMQP Interfaces?

Are there any plans for an interface that's a bit closer to the core AMQP design patterns? It would've been super useful to be able to have backend primitives/interfaces that were much more closely aligned with Exchanges Queues Dead Lettering etc.

- [ ] Nuget Package

I need to make a Nuget package out of this but I'm not sure how that works.

- [ ] Error Codes?

The GCP provider has error codes. I didn't implement any specific error codes is that something I need to do? If so is there guidance on how to go about that?

- [ ] Namespace

I didn't know what to put for the namespace so I put  at the time. I'm happy to fix the namespacing to whatever the group things.

Edit: namespace comments.

Signed-off-by: Mike Lloyd <mike@reboot3times.org>",,jason-bragg,,
5526,[WIP] Remove catalog activations locking,,[WIP] Remove catalog activations locking ,,xiazen,,
5525,Remove locking in LocalGrainDirectory,,Remove locking in LocalGrainDirectory ,,benjaminpetit,,
5524,How to know whether a transaction is over or not.,Is there any way to find out a transaction is over or not with transaction id?,How to know whether a transaction is over or not. Is there any way to find out a transaction is over or not with transaction id?,question,jason-bragg,,
5523,Orleans stalled,"Hi
We have a project that use Microsoft Orleans 2.2 in .Net Framework 4.7.1 and SQL server as Storage.
When we load test it it always fails at the 4th day that it stop responding any new requests and CPU usage in almost 0 while the number of threads gets increased heavily.
The failure messages at the log :
[2019-04-10 20:06:29.125 GMT 13	Warning	101215	Orleans.Runtime.Scheduler.WorkItemGroup]	Task [Id=77224074 Status=RanToCompletion] in WorkGroup [Activation: S10.1.0.5:11111:292432306*grn/8C9EE89/000026cf@38040cb6 #GrainType=Softec.FMS.Orleans.Implementation.Grains.RawDataSaverGrain Placement=RandomPlacement State=Valid] took elapsed time 0:00:00.8558401 for execution which is longer than 00:00:00.2000000. Running on thread System.Threading.Thread	
[2019-04-10 20:07:38.517 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:01:19.4272142 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:07:38.517 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:06:20.726 GMT 00:01:17.7906305 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:07:38.517 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:05:41.0251127 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:07:38.517 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:09:07.479 GMT 17678	Warning	100157	Orleans.Runtime.CallbackData]	Response did not arrive on time in 00:00:30 for message: Request S10.1.0.5:11111:292432306*grn/7C16CD43/00000000+357454074159300@e982059b->S10.1.0.5:11111:292432306*grn/7C16CD43/00000000+357454074159300@e982059b #607940229: . Target History is: <S10.1.0.5:11111:292432306:*grn/7C16CD43/00000000+357454074159300:@e982059b>. About to break its promise.	
[2019-04-10 20:12:38.527 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:06:19.4374713 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:12:38.527 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:06:20.726 GMT 00:06:17.8008876 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:12:38.527 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:10:41.0353698 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:12:38.527 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:17:38.574 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:11:19.4845859 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:17:38.574 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:14:43.982 GMT 00:02:54.5922485 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:17:38.574 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:15:41.0824844 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:17:38.574 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:22:38.616 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:16:19.5256852 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:22:38.616 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:14:43.982 GMT 00:07:54.6333478 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:22:38.616 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:20:41.1235837 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:22:38.616 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:27:39.500 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:21:20.4096932 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:27:39.500 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:14:43.982 GMT 00:12:55.5173558 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:27:39.500 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:25:42.0075917 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:27:39.500 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:32:39.634 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:26:20.5445034 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:32:39.634 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:14:43.982 GMT 00:17:55.6521660 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:32:39.634 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:30:42.1424019 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:32:39.634 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	


You can kindly find attached the full Log
[Log.zip](https://github.com/dotnet/orleans/files/3066064/Log.zip)

","Orleans stalled Hi
We have a project that use Microsoft Orleans 2.2 in .Net Framework 4.7.1 and SQL server as Storage.
When we load test it it always fails at the 4th day that it stop responding any new requests and CPU usage in almost 0 while the number of threads gets increased heavily.
The failure messages at the log :
[2019-04-10 20:06:29.125 GMT 13	Warning	101215	Orleans.Runtime.Scheduler.WorkItemGroup]	Task [Id=77224074 Status=RanToCompletion] in WorkGroup [Activation: S10.1.0.5:11111:292432306*grn/8C9EE89/000026cf@38040cb6 #GrainType=Softec.FMS.Orleans.Implementation.Grains.RawDataSaverGrain Placement=RandomPlacement State=Valid] took elapsed time 0:00:00.8558401 for execution which is longer than 00:00:00.2000000. Running on thread System.Threading.Thread	
[2019-04-10 20:07:38.517 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:01:19.4272142 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:07:38.517 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:06:20.726 GMT 00:01:17.7906305 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:07:38.517 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:05:41.0251127 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:07:38.517 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:09:07.479 GMT 17678	Warning	100157	Orleans.Runtime.CallbackData]	Response did not arrive on time in 00:00:30 for message: Request S10.1.0.5:11111:292432306*grn/7C16CD43/00000000+357454074159300@e982059b->S10.1.0.5:11111:292432306*grn/7C16CD43/00000000+357454074159300@e982059b #607940229: . Target History is: <S10.1.0.5:11111:292432306:*grn/7C16CD43/00000000+357454074159300:@e982059b>. About to break its promise.	
[2019-04-10 20:12:38.527 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:06:19.4374713 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:12:38.527 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:06:20.726 GMT 00:06:17.8008876 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:12:38.527 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:10:41.0353698 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:12:38.527 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:17:38.574 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:11:19.4845859 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:17:38.574 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:14:43.982 GMT 00:02:54.5922485 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:17:38.574 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:15:41.0824844 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:17:38.574 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:22:38.616 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:16:19.5256852 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:22:38.616 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:14:43.982 GMT 00:07:54.6333478 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:22:38.616 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:20:41.1235837 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:22:38.616 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:27:39.500 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:21:20.4096932 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:27:39.500 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:14:43.982 GMT 00:12:55.5173558 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:27:39.500 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:25:42.0075917 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:27:39.500 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	
[2019-04-10 20:32:39.634 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ReadTableTimer did not fire on time. Last fired at 2019-04-10 20:06:19.090 GMT 00:26:20.5445034 since previous fire should have fired after 00:01:00.	
[2019-04-10 20:32:39.634 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. Last fired at 2019-04-10 20:14:43.982 GMT 00:17:55.6521660 since previous fire should have fired after 00:00:10.	
[2019-04-10 20:32:39.634 GMT 37	Error	101412	Orleans.Runtime.GrainTimer]	!!!!!!!!!! Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. Last fired at 2019-04-10 20:01:57.492 GMT 00:30:42.1424019 since previous fire should have fired after 00:05:00.	
[2019-04-10 20:32:39.634 GMT 37	Warning	102603	Orleans.Runtime.Watchdog]	Watchdog had 1 Health Check Failure(s) out of 2 Health Check Participants.	


You can kindly find attached the full Log
[Log.zip](https://github.com/dotnet/orleans/files/3066064/Log.zip)

",,ReubenBond,,
5522,Fix #5519: use local silo as default primary silo,Fixes #5519,Fix #5519: use local silo as default primary silo Fixes #5519,,benjaminpetit,,
5520,how to get the dbContext  is always new when call the grain,"# version info:
Orleans : 2.3.0
EF Core:2.2.3



I used the above 2 ways to get the context I got the context used in the last call not a new context.

","how to get the dbContext  is always new when call the grain # version info:
Orleans : 2.3.0
EF Core:2.2.3



I used the above 2 ways to get the context I got the context used in the last call not a new context.

",question,ReubenBond,,
5518,Docker setup with local host clustering making a request to localhost,"Hi 

I have a setup variation with docker and basically no clustering. I only use the direct client with co-hosting. But some process seems to make a request to localhost and fails. 

	""exception"": {
		""type"": ""System.TimeoutException""
		""message"": ""Connection to 127.0.0.1:11111 could not be established in 00:00:05""
		""stackTrace"": ""   at Orleans.Runtime.SocketManager.Connect(Socket s IPEndPoint endPoint TimeSpan connectionTimeout)\n   at Orleans.Runtime.SocketManager.SendingSocketCreator(IPEndPoint target)\n   at Orleans.Runtime.LRU2.Get(TKey key)\n   at Orleans.Runtime.Messaging.SiloMessageSender.GetSendingSocket(Message msg Socket& socket SiloAddress& targetSilo String& error)""
	}

I am not sure why this request is done and how to prevent it.

After that I see a lot of these messages:

	""exception"": {
		""type"": ""System.NullReferenceException""
		""message"": ""Object reference not set to an instance of an object.""
		""stackTrace"": ""   at Orleans.Runtime.InsideRuntimeClient.OnCallbackExpiryTick(Object state)\n   at Orleans.Runtime.SafeTimerBase.HandleSyncTimerCallback(Object state)""
	}

Not sure if they are related but I would like to get rid of them.","Docker setup with local host clustering making a request to localhost Hi 

I have a setup variation with docker and basically no clustering. I only use the direct client with co-hosting. But some process seems to make a request to localhost and fails. 

	""exception"": {
		""type"": ""System.TimeoutException""
		""message"": ""Connection to 127.0.0.1:11111 could not be established in 00:00:05""
		""stackTrace"": ""   at Orleans.Runtime.SocketManager.Connect(Socket s IPEndPoint endPoint TimeSpan connectionTimeout)\n   at Orleans.Runtime.SocketManager.SendingSocketCreator(IPEndPoint target)\n   at Orleans.Runtime.LRU2.Get(TKey key)\n   at Orleans.Runtime.Messaging.SiloMessageSender.GetSendingSocket(Message msg Socket& socket SiloAddress& targetSilo String& error)""
	}

I am not sure why this request is done and how to prevent it.

After that I see a lot of these messages:

	""exception"": {
		""type"": ""System.NullReferenceException""
		""message"": ""Object reference not set to an instance of an object.""
		""stackTrace"": ""   at Orleans.Runtime.InsideRuntimeClient.OnCallbackExpiryTick(Object state)\n   at Orleans.Runtime.SafeTimerBase.HandleSyncTimerCallback(Object state)""
	}

Not sure if they are related but I would like to get rid of them.",,benjaminpetit,,
5517,Orleans silo windows service Log,"hi 
how to configure Orleans silo to Log its error and Trace its problem ?","Orleans silo windows service Log hi 
how to configure Orleans silo to Log its error and Trace its problem ?",,sergeybykov,,
5516,Event Sourcing does not work in calling grain within a grain,"Hi
I have a problem with event sourcing. when i call grains in client it works well and save data in db such as this (in mu code):

how can i call the CountryGrain in this code to use event sourcing and save states?
Thanks","Event Sourcing does not work in calling grain within a grain Hi
I have a problem with event sourcing. when i call grains in client it works well and save data in db such as this (in mu code):

how can i call the CountryGrain in this code to use event sourcing and save states?
Thanks",,sergeybykov,,
5514,Enable TransactionalStateStorageTestRunner to test with custom type,TransactionalStateStorageTestRunner was hard coded to test manipulating integer state only. This PR enable it to test with any type as long as the type is a reference type and implements  constructor should return a different value each time to ensure test coverage. ,Enable TransactionalStateStorageTestRunner to test with custom type TransactionalStateStorageTestRunner was hard coded to test manipulating integer state only. This PR enable it to test with any type as long as the type is a reference type and implements  constructor should return a different value each time to ensure test coverage. ,,jason-bragg,,
5513,Design pattern for starting and not blocking on long running task but notified of completion,"Hello

I have a use case where a Grain may want to kick off a long running operation and I want to be notified of its completion but don’t want to block (even via await’ing a thread pool task) the long running operation so the Grain can continue to respond to other messages.

I’m thinking I need to have this Grain maybe queue a message in a regular job/service bus queue with the Id of the Grain who asked for the long running task to be performed have a non-Orleans worker process do that task.

When the task is complete send a message back to the Grain.

Am I on the right track?","Design pattern for starting and not blocking on long running task, but notified of completion Hello

I have a use case where a Grain may want to kick off a long running operation and I want to be notified of its completion but don’t want to block (even via await’ing a thread pool task) the long running operation so the Grain can continue to respond to other messages.

I’m thinking I need to have this Grain maybe queue a message in a regular job/service bus queue with the Id of the Grain who asked for the long running task to be performed have a non-Orleans worker process do that task.

When the task is complete send a message back to the Grain.

Am I on the right track?",,sergeybykov,,
5512,AzureTableClusteringExtensions does not provide access to the HostBuilderContext,"When initializing my silo under ServiceFabric I am doing the following:
 unless I double build the configuration and store it in a variable (which sucks).

Does anyone have any insights into how I can maintain a clean initialization sequence without requiring extraneous variables?

rich","AzureTableClusteringExtensions does not provide access to the HostBuilderContext When initializing my silo under ServiceFabric I am doing the following:
 unless I double build the configuration and store it in a variable (which sucks).

Does anyone have any insights into how I can maintain a clean initialization sequence without requiring extraneous variables?

rich",,benjaminpetit,,
5510,Stream messages not reaching all client-based subscribers,"I have a problem whereby some stream subscribers are not receiving messages published to that stream.

Our system is set up with Web API REST endpoints which use an Orleans IClusterClient to access boundary grains.  These grains hand off the process to internal grains some of which are stateless workers and eventually this will result in a message being published to a Simple Message Provider stream.  When invoked the Web API controllers subscribe to this stream via a singleton IClusterClient and the handler for this subscription returns the result back to the caller.  We pass a correlation Id (Guid) into the Orleans.RequestContext and check this in the stream handler to confirm we're processing the correct message.  All streams use the same Guid (Guid.Empty) as their Id but the namespace of the stream will change based on the request being made.  When the controller is disposed it unsubscribes from the stream.

The problem occurs when multiple concurrent requests are sent to our Web API.  What we see is when the system is started up from cold the first set of concurrent requests all succeed.  Messages are published received by the controllers and responses are returned to the callers.  However from that point on each subsequent set of concurrent requests see some of the requests timeout because the messages being published are not being handled by the controllers.  The number of requests that fail is variable.  Sometimes only one is successful sometimes only one fails and every point in between but there is always at least one success and one failure in each batch.

I have (I think) verified that the messages are being published correctly by subscribing to the same stream within a grain that is invoked as part of the call chain.  Our logs show that the messages are always being handled by this grain.

After a period of rest (sorry I haven't ascertained exactly how long this is) the system seems to go back to its initial state and a batch of requests work correctly but from there on in it's as it was before.

For the time being we have got around this problem by using a distinct Guid (the correlation Id) for each request but this is not ideal.

I'm mostly confused as to why it all works the first time and only subsequent sets of requests fail.

Is there anything else we can investigate to see what may be the root cause of this?

We're using v2.1.2 of Orleans.

Many thanks
Mark","Stream messages not reaching all client-based subscribers I have a problem whereby some stream subscribers are not receiving messages published to that stream.

Our system is set up with Web API REST endpoints which use an Orleans IClusterClient to access boundary grains.  These grains hand off the process to internal grains some of which are stateless workers and eventually this will result in a message being published to a Simple Message Provider stream.  When invoked the Web API controllers subscribe to this stream via a singleton IClusterClient and the handler for this subscription returns the result back to the caller.  We pass a correlation Id (Guid) into the Orleans.RequestContext and check this in the stream handler to confirm we're processing the correct message.  All streams use the same Guid (Guid.Empty) as their Id but the namespace of the stream will change based on the request being made.  When the controller is disposed it unsubscribes from the stream.

The problem occurs when multiple concurrent requests are sent to our Web API.  What we see is when the system is started up from cold the first set of concurrent requests all succeed.  Messages are published received by the controllers and responses are returned to the callers.  However from that point on each subsequent set of concurrent requests see some of the requests timeout because the messages being published are not being handled by the controllers.  The number of requests that fail is variable.  Sometimes only one is successful sometimes only one fails and every point in between but there is always at least one success and one failure in each batch.

I have (I think) verified that the messages are being published correctly by subscribing to the same stream within a grain that is invoked as part of the call chain.  Our logs show that the messages are always being handled by this grain.

After a period of rest (sorry I haven't ascertained exactly how long this is) the system seems to go back to its initial state and a batch of requests work correctly but from there on in it's as it was before.

For the time being we have got around this problem by using a distinct Guid (the correlation Id) for each request but this is not ideal.

I'm mostly confused as to why it all works the first time and only subsequent sets of requests fail.

Is there anything else we can investigate to see what may be the root cause of this?

We're using v2.1.2 of Orleans.

Many thanks
Mark",,jason-bragg,,
5508,what is the best way to  transmit request from grainA to grainB.,"I dont know how many IGrainB silos in the clusterit is scaled.
If I use  GrainFactory.GetGrain<IGrainB>(0) it is inefficient.Only one grainB busy. 
If I use  GrainFactory.GetGrain<IGrainB>(randomid) it means per request creates per grain.Im afraid It will  create amount of Gains there. 
How should I do it? Thanks.","what is the best way to  transmit request from grainA to grainB. I dont know how many IGrainB silos in the clusterit is scaled.
If I use  GrainFactory.GetGrain<IGrainB>(0) it is inefficient.Only one grainB busy. 
If I use  GrainFactory.GetGrain<IGrainB>(randomid) it means per request creates per grain.Im afraid It will  create amount of Gains there. 
How should I do it? Thanks.",question,sergeybykov,4/04/2019 22:57,5/04/2019 13:53
5506,IDeserializationContext.DeserializeInner deserialization bug,"In generated code something senseless happen time to time (around 50% of running)
The returned class has three fields: int int bool.

    public class AnalysisStatus
    {
        public bool UpdateInProgress { get; set; }

        public int Total { get; set; }

        public int Processed { get; set; }
    }

In the generated code DeserializeInner takes the rigth type as input (**int**) for unknow reason returns a **bool** and obviously the cast to **int** fails badly

![ORLEAN BUG](https://user-images.githubusercontent.com/130935/55506731-76b10680-5656-11e9-90de-238cf36cadd1.PNG)
","IDeserializationContext.DeserializeInner deserialization bug In generated code something senseless happen time to time (around 50% of running)
The returned class has three fields: int int bool.

    public class AnalysisStatus
    {
        public bool UpdateInProgress { get; set; }

        public int Total { get; set; }

        public int Processed { get; set; }
    }

In the generated code DeserializeInner takes the rigth type as input (**int**) for unknow reason returns a **bool** and obviously the cast to **int** fails badly

![ORLEAN BUG](https://user-images.githubusercontent.com/130935/55506731-76b10680-5656-11e9-90de-238cf36cadd1.PNG)
",,ReubenBond,,
5505,Get the calling grain reference from a custom IReminderRegistry,I'm working on unit testing some grains that make use of reminders (using  since it's unnecessary for all of our unit tests)?,Get the calling grain reference from a custom IReminderRegistry I'm working on unit testing some grains that make use of reminders (using  since it's unnecessary for all of our unit tests)?,,benjaminpetit,,
5504,Issue w/client stream reconnect,"It seems when a client disconnect and reconnects the client will hang when publishing to the stream.

I encountered this in my own project and was able to reproduce in a sample project:
1) Open ChatRoom.sln (Samples/2.0/ChatRoom)
2) Start OrleansServer
3) Start OrleansClient instance 1 join channel: /j random
4) Start OrleansClient instance 2 join channel: /j random
5) Close OrleansClient instance 2
6) Start OrleansClient instance 2 join channel /j random
7) OrleansClient instance 2 is now hung","Issue w/client stream reconnect It seems when a client disconnect and reconnects the client will hang when publishing to the stream.

I encountered this in my own project and was able to reproduce in a sample project:
1) Open ChatRoom.sln (Samples/2.0/ChatRoom)
2) Start OrleansServer
3) Start OrleansClient instance 1 join channel: /j random
4) Start OrleansClient instance 2 join channel: /j random
5) Close OrleansClient instance 2
6) Start OrleansClient instance 2 join channel /j random
7) OrleansClient instance 2 is now hung",,jason-bragg,,
5503,Added batch stream production back in.,#NAME?,"Added batch stream production back in. -Added testing for batch behaviors for EH AQ Memory and SMS.  Works for all but SMS.
-SMS tests skipped until we fix.
Surfaces are asymmetric though.  Will discuss with team before merging.",,ReubenBond,,
5502,Subscription handle extensions for batch consumption,Updated stream subscription handle extension functions to handle batch consumption complerable to what is supported for subscribe.,Subscription handle extensions for batch consumption Updated stream subscription handle extension functions to handle batch consumption complerable to what is supported for subscribe.,,xiazen,,
5501,(Attempt To) Create Integration Sample w/ ML.NET,"[ML.NET](https://dotnet.microsoft.com/apps/machinelearning-ai/ml-dotnet) @ [GitHub](https://github.com/dotnet/machinelearning) in the new shiny tech on the .NET space.

Though our own use cases are still a ways off I think showing how this can integrate with Orleans for work distribution and most importantly *cached state* distribution could help raise the profile of Orleans itself. Compute is cheap it's *moving data* that kills performance something that machine learning solutions suffer a lot from. Sharding state and moving it efficiently is something Orleans is very good at and I can therefore see these two technologies working well especially if we're able to add something like [Apache Arrow](https://arrow.apache.org/) on top to compress data on the move *and* at rest without the overhead of transforming said data for processing. Anyway these are all in the air right now. This issue is here in case anyone wants to have fun with it. Otherwise I'll come back to this at some point just for kicks.","(Attempt To) Create Integration Sample w/ ML.NET [ML.NET](https://dotnet.microsoft.com/apps/machinelearning-ai/ml-dotnet) @ [GitHub](https://github.com/dotnet/machinelearning) in the new shiny tech on the .NET space.

Though our own use cases are still a ways off I think showing how this can integrate with Orleans for work distribution and most importantly *cached state* distribution could help raise the profile of Orleans itself. Compute is cheap it's *moving data* that kills performance something that machine learning solutions suffer a lot from. Sharding state and moving it efficiently is something Orleans is very good at and I can therefore see these two technologies working well especially if we're able to add something like [Apache Arrow](https://arrow.apache.org/) on top to compress data on the move *and* at rest without the overhead of transforming said data for processing. Anyway these are all in the air right now. This issue is here in case anyone wants to have fun with it. Otherwise I'll come back to this at some point just for kicks.",,JorgeCandeias,,
5500,(Attempt To) Create Integration Sample /w Trill,"> Trill is a high-performance open-source in-memory incremental analytics library. It can handle both real-time and offline data and is based on a temporal data and query model. Trill can be used as a streaming engine a lightweight in-memory relational engine and as a progressive query processor (for early query results on partial data).

See [Microsoft Research Website](https://www.microsoft.com/en-us/research/project/trill/) and [GitHub](https://github.com/Microsoft/Trill).

It also looks very cool. We're bound to build a prototype of this at some point in the context of a CQRS-style real-time data aggregation and projection engine running on Orleans so I'm putting this here in case some wants to have fun building a sample for it. Otherwise I'll get to this at some point.","(Attempt To) Create Integration Sample /w Trill > Trill is a high-performance open-source in-memory incremental analytics library. It can handle both real-time and offline data and is based on a temporal data and query model. Trill can be used as a streaming engine a lightweight in-memory relational engine and as a progressive query processor (for early query results on partial data).

See [Microsoft Research Website](https://www.microsoft.com/en-us/research/project/trill/) and [GitHub](https://github.com/Microsoft/Trill).

It also looks very cool. We're bound to build a prototype of this at some point in the context of a CQRS-style real-time data aggregation and projection engine running on Orleans so I'm putting this here in case some wants to have fun building a sample for it. Otherwise I'll get to this at some point.",,JorgeCandeias,,
5499,"The question of using AddMemoryGrainStorage (""PubSubStore"") when subscribing to StreamProvider on the client side","The client needs to subscribe to the StreamProvider to get the message pushed by the Silo side. Because of the need for PubSubStore AddMemoryGrainStorage (""PubSubStore"") is used.
Because you need to ensure that the client can get the push message you can't cancel the subscription but this will cause a serious problem.
When I generate Guid different PubSubRendezvousGrain generates a lot of data.
How to clear up old subscription data?
If the client restarts will the old data of the PubSubRendezvousGrain in the silo be clear?","The question of using AddMemoryGrainStorage (""PubSubStore"") when subscribing to StreamProvider on the client side The client needs to subscribe to the StreamProvider to get the message pushed by the Silo side. Because of the need for PubSubStore AddMemoryGrainStorage (""PubSubStore"") is used.
Because you need to ensure that the client can get the push message you can't cancel the subscription but this will cause a serious problem.
When I generate Guid different PubSubRendezvousGrain generates a lot of data.
How to clear up old subscription data?
If the client restarts will the old data of the PubSubRendezvousGrain in the silo be clear?",,xiazen,,
5498,Add UseLinuxEnvironmentStatistics method for ISiloBuilder,Fixes #5497.,Add UseLinuxEnvironmentStatistics method for ISiloBuilder Fixes #5497.,,benjaminpetit,,
5494,does GrainServiceClient   accessing the GrainService is load balanced？,,does GrainServiceClient   accessing the GrainService is load balanced？ ,question,sergeybykov,,
5493,Add Kubernetes support to Docker sample,"This is a WIP PR to add support for Kubernetes on the Docker sample. I played with the sample myself wrote a simple Makefile to test and I thought of PR'ing it to get some feedback whether you want something like that. E.g. want the Kubernetes sample combined with the Docker one or maybe we should create a separate Kubernetes sample? I'm open to suggestions :)

Btw whereas deployment works (tested locally with Docker for Windows and remotely using Azure Kubernetes Service) I'm getting an Exception after some time and the silo dies. Any hints?



Btw I'm pretty new to Orleans so apologies in advance if I missed something.","Add Kubernetes support to Docker sample This is a WIP PR to add support for Kubernetes on the Docker sample. I played with the sample myself wrote a simple Makefile to test and I thought of PR'ing it to get some feedback whether you want something like that. E.g. want the Kubernetes sample combined with the Docker one or maybe we should create a separate Kubernetes sample? I'm open to suggestions :)

Btw whereas deployment works (tested locally with Docker for Windows and remotely using Azure Kubernetes Service) I'm getting an Exception after some time and the silo dies. Any hints?



Btw I'm pretty new to Orleans so apologies in advance if I missed something.",,benjaminpetit,,
5489,(Attempt To) Create Integration Sample w/ Apache Arrow,[Apache Arrow](https://arrow.apache.org/) is another edge technology we have on the to-look-at list in order to improve performance of certain workloads within Orleans. As [Microsoft FASTER](https://github.com/Microsoft/FASTER) in #5488 it's also a young project but it shows very promising potential as a columnar storage solution for large collections that support analytical workloads. I'm also bound to build a prototype of this at some point so I'm creating this issue here in case anyone wants to have a go at it in the mean time. Otherwise feel free to assign this to me.,(Attempt To) Create Integration Sample w/ Apache Arrow [Apache Arrow](https://arrow.apache.org/) is another edge technology we have on the to-look-at list in order to improve performance of certain workloads within Orleans. As [Microsoft FASTER](https://github.com/Microsoft/FASTER) in #5488 it's also a young project but it shows very promising potential as a columnar storage solution for large collections that support analytical workloads. I'm also bound to build a prototype of this at some point so I'm creating this issue here in case anyone wants to have a go at it in the mean time. Otherwise feel free to assign this to me.,,JorgeCandeias,,
5488,(Attempt To) Create Integration Sample w/ Microsoft FASTER,[Microsoft FASTER](https://github.com/Microsoft/FASTER) is one edge technology we have on the to-look-at list in order to improve performance of certain workloads within Orleans. It's a young project and still in a rough shape but it shows very promising potential as a hybrid storage solution for large dictionary-style collections especially if it gets at least a basic iteration story off the ground. I'm bound to build a prototype of this at some point so I'm creating this issue here in case anyone wants to have a go at it in the mean time. Otherwise feel free to assign this to me.,(Attempt To) Create Integration Sample w/ Microsoft FASTER [Microsoft FASTER](https://github.com/Microsoft/FASTER) is one edge technology we have on the to-look-at list in order to improve performance of certain workloads within Orleans. It's a young project and still in a rough shape but it shows very promising potential as a hybrid storage solution for large dictionary-style collections especially if it gets at least a basic iteration story off the ground. I'm bound to build a prototype of this at some point so I'm creating this issue here in case anyone wants to have a go at it in the mean time. Otherwise feel free to assign this to me.,,JorgeCandeias,,
5487,Reactive Caching Sample Leftovers,"Here are the rest of the changes for now. If #5485 surfaces a better approach I'll come back to this.

Not super happy with [this commit](https://github.com/dotnet/orleans/commit/54ab4c1abae8e9b2a8d0f3266bd8777e9108bead) though. Is there any way we can disable the timeout warnings only for specific calls?

Also very grateful for the tips on the previous PR! 👍 ","Reactive Caching Sample Leftovers Here are the rest of the changes for now. If #5485 surfaces a better approach I'll come back to this.

Not super happy with [this commit](https://github.com/dotnet/orleans/commit/54ab4c1abae8e9b2a8d0f3266bd8777e9108bead) though. Is there any way we can disable the timeout warnings only for specific calls?

Also very grateful for the tips on the previous PR! 👍 ",,sergeybykov,,
5486,Create HealthCheck Sample,As described. Feel free to assign this to me unless someone else wants to have a go at it. #4843,Create HealthCheck Sample As described. Feel free to assign this to me unless someone else wants to have a go at it. #4843,,JorgeCandeias,,
5485,Question: How can one access the IReminderRegistry from a static Grain extension method.,I'm attempting to write a static extension method for the  in this context?,Question: How can one access the IReminderRegistry from a static Grain extension method. I'm attempting to write a static extension method for the  in this context?,question,ReubenBond,,
5484,Strange activation exception. Am I missing some registration ? ,"Hi we are getting some strange exception on activation 

","Strange activation exception. Am I missing some registration ?  Hi we are getting some strange exception on activation 

",,ReubenBond,,
5483,Azure Table Storage Provider Throughput,"A long time ago I remember reading somewhere that you should use the  with multiple Azure Table Storage providers if you thought that one Azure Table Storage account would not give you enough throughput. I also remember reading that you should predict what your max throughput is going to be because you can't change it later on.

I can't seem to find this information in the docs or issues. Does this still even hold with the latest version of Orleans and Azure Table Storage? If it does what is the max throughput of a single Azure Table Storage account?","Azure Table Storage Provider Throughput A long time ago I remember reading somewhere that you should use the  with multiple Azure Table Storage providers if you thought that one Azure Table Storage account would not give you enough throughput. I also remember reading that you should predict what your max throughput is going to be because you can't change it later on.

I can't seem to find this information in the docs or issues. Does this still even hold with the latest version of Orleans and Azure Table Storage? If it does what is the max throughput of a single Azure Table Storage account?",,sergeybykov,,
5482,Microsoft.Orleans.CodeGenerator.MSBuild - Issues with GrainState being of generic type,"Hi we observed some differences between the 

At the moment we don't have time to do a repro. Hopefully this can help i some way.","Microsoft.Orleans.CodeGenerator.MSBuild - Issues with GrainState being of generic type Hi we observed some differences between the 

At the moment we don't have time to do a repro. Hopefully this can help i some way.",,ReubenBond,,
5479,Update Azure Storage libraries,"We keep experiencing the issue described in #5003. The fix in the upstream repo was rejected as the Azure Table storage service/API/SDKs were being transferred from the Azure Storage team to the Cosmos DB team.

The Cosmos DB team has released a new [SDK for Azure Table storage](https://docs.microsoft.com/en-us/azure/cosmos-db/table-sdk-dotnet-standard) with support for .NET Standard. Interestingly the team chose to release this under a _new_ package ID [Microsoft.Azure.Cosmos.Table](https://www.nuget.org/packages/Microsoft.Azure.Cosmos.Table) as opposed to updating their existing Microsoft.Azure.CosmosDB.Table package.

Additionally the Azure Storage SDK has since been broken out into separate packages. We now have:

- [Microsoft.Azure.Storage.Blob](https://www.nuget.org/packages/Microsoft.Azure.Storage.Blob/)
- [Microsoft.Azure.Storage.Common](https://www.nuget.org/packages/Microsoft.Azure.Storage.Common/)
- [Microsoft.Azure.Storage.File](https://www.nuget.org/packages/Microsoft.Azure.Storage.File/)
- [Microsoft.Azure.Storage.Queue](https://www.nuget.org/packages/Microsoft.Azure.Storage.Queue/)

The new Common library contains  is released under an MIT license the source code is not yet available. I also reached out to the Cosmos DB team for guidance.

So how to proceed? Should the Blob/Queue code get separated from the Table code? That sounds undesirable _if_ there's some confirmation the Microsoft.Azure.Cosmos.Table library will end up taking on a Microsoft.Azure.Storage.Common dependency. While waiting for a Cosmos DB team response the refactored Azure Storage SDKs are getting new bug fixes for Blob and Queue. WindowsAzure.Storage appears to be frozen.","Update Azure Storage libraries We keep experiencing the issue described in #5003. The fix in the upstream repo was rejected as the Azure Table storage service/API/SDKs were being transferred from the Azure Storage team to the Cosmos DB team.

The Cosmos DB team has released a new [SDK for Azure Table storage](https://docs.microsoft.com/en-us/azure/cosmos-db/table-sdk-dotnet-standard) with support for .NET Standard. Interestingly the team chose to release this under a _new_ package ID [Microsoft.Azure.Cosmos.Table](https://www.nuget.org/packages/Microsoft.Azure.Cosmos.Table) as opposed to updating their existing Microsoft.Azure.CosmosDB.Table package.

Additionally the Azure Storage SDK has since been broken out into separate packages. We now have:

- [Microsoft.Azure.Storage.Blob](https://www.nuget.org/packages/Microsoft.Azure.Storage.Blob/)
- [Microsoft.Azure.Storage.Common](https://www.nuget.org/packages/Microsoft.Azure.Storage.Common/)
- [Microsoft.Azure.Storage.File](https://www.nuget.org/packages/Microsoft.Azure.Storage.File/)
- [Microsoft.Azure.Storage.Queue](https://www.nuget.org/packages/Microsoft.Azure.Storage.Queue/)

The new Common library contains  is released under an MIT license the source code is not yet available. I also reached out to the Cosmos DB team for guidance.

So how to proceed? Should the Blob/Queue code get separated from the Table code? That sounds undesirable _if_ there's some confirmation the Microsoft.Azure.Cosmos.Table library will end up taking on a Microsoft.Azure.Storage.Common dependency. While waiting for a Cosmos DB team response the refactored Azure Storage SDKs are getting new bug fixes for Blob and Queue. WindowsAzure.Storage appears to be frozen.",,sergeybykov,,
5478,Question about registered reminders and cluster id,"We have a lot of errors like this one:

","Question about registered reminders and cluster id We have a lot of errors like this one:

",question,sergeybykov,,
5475,Observers have been Replaced with Streams,I'm new to Orleans. This page threw me off until I read somewhere that Streams had replaced this functionality. If there is docs for older versions then this document should go there.,Observers have been Replaced with Streams I'm new to Orleans. This page threw me off until I read somewhere that Streams had replaced this functionality. If there is docs for older versions then this document should go there.,,sergeybykov,,
5474,Should require many grains one time or multiple time?,"If there are many tasks and each task should create a grains. Should create those grains one time ? 
I think Orleans know its work load can cache all tasks(grains) required by client and then dispatch tasks to soils intelligently. If not what is strategy? Should client cache all tasks and then require grains in batch ? but how much should require one time for client don't know work load of Orleans and soil?

Furthermore Can Orleans scale in and out automatically according work load with something like K8t Swarm?

Thanks","Should require many grains one time or multiple time? If there are many tasks and each task should create a grains. Should create those grains one time ? 
I think Orleans know its work load can cache all tasks(grains) required by client and then dispatch tasks to soils intelligently. If not what is strategy? Should client cache all tasks and then require grains in batch ? but how much should require one time for client don't know work load of Orleans and soil?

Furthermore Can Orleans scale in and out automatically according work load with something like K8t Swarm?

Thanks",,sergeybykov,,
5473,Microsoft.Orleans.CodeGenerator.MSBuild 2.2.4 infinite loop,The following code is probably causing an infinite loop in  that is causing the infinite loop.,Microsoft.Orleans.CodeGenerator.MSBuild 2.2.4 infinite loop The following code is probably causing an infinite loop in  that is causing the infinite loop.,,ReubenBond,,
5472,Recommended way to Handle Collections of Grains,"I'm new to Orleans and am trying to work out how to deal with collections of grains e.g. A ? If I'm using Azure Table Storage I have a maximum state size constraint which is what I'm guessing is my limit in this scenario.

I've seen two projects that seem to have some promise but they are supposedly not ready for production:

- https://github.com/OrleansContrib/OrleansV2.Fork.Indexing (pre-production = beta?)
- https://github.com/OrleansContrib/Orleans.Containers (pre-alpha)","Recommended way to Handle Collections of Grains I'm new to Orleans and am trying to work out how to deal with collections of grains e.g. A ? If I'm using Azure Table Storage I have a maximum state size constraint which is what I'm guessing is my limit in this scenario.

I've seen two projects that seem to have some promise but they are supposedly not ready for production:

- https://github.com/OrleansContrib/OrleansV2.Fork.Indexing (pre-production = beta?)
- https://github.com/OrleansContrib/Orleans.Containers (pre-alpha)",question,sergeybykov,,
5470,HashSet grain method argument makes empty filter context with new Codegenerator.MSBuild,"Assuming the code:
 scenario and we're forced to update to MSBuild package - this behavior is pretty frustrating.","HashSet grain method argument makes empty filter context with new Codegenerator.MSBuild Assuming the code:
 scenario and we're forced to update to MSBuild package - this behavior is pretty frustrating.",codegen,ReubenBond,,
5466,Add Incoming grain call filter extensions for ISiloBuilder,Following the changes in 2.3.0 ISiloBuilder had no extension methods to add incoming grain filters.,Add Incoming grain call filter extensions for ISiloBuilder Following the changes in 2.3.0 ISiloBuilder had no extension methods to add incoming grain filters.,,ReubenBond,,
5465,Add configuration support for ISiloBuilder to TestClusterBuilder,"Hi in order to configure common options for a ""test silo"" and a ""real silo"" -- it would be great if there was some way to configure a  is working today.","Add configuration support for ISiloBuilder to TestClusterBuilder Hi in order to configure common options for a ""test silo"" and a ""real silo"" -- it would be great if there was some way to configure a  is working today.",,ReubenBond,,
5464,Sending messages on the initiative of the silo?,Hello! I successfully use Orleans for request-response but did not find in the documentation is it possible to send messages on the initiative of the silo? Is it possible Is there a sample code or other documentation?,Sending messages on the initiative of the silo? Hello! I successfully use Orleans for request-response but did not find in the documentation is it possible to send messages on the initiative of the silo? Is it possible Is there a sample code or other documentation?,question,ReubenBond,,
5463,-Failed to get ping responses from all 1 silos that are currently listed as Active in the Membership table,"Orleans.Runtime.MembershipService.MembershipOracleData[100661]
      -Failed to get ping responses from all 1 silos that are currently listed as Active in the Membership table. Newly joining silos validate connectivity with all pre-existing silos that are listed as Active in the table and have written I Am Alive in the table in the last 00:10:00 period before they are allowed to join the cluster. Active silos are: [[SiloAddress=S10.0.75.1:11111:290933742 SiloName=Silo_048a5 Status=Active HostName=LiBo ProxyPort=30000 RoleName= UpdateZone=0 FaultZone=0 StartTime = 2019-03-22 06:55:43.000 GMT IAmAliveTime = 2019-03-22 07:00:51.000 GMT  ]]
warn: Orleans.Runtime.Scheduler *stg/15/0000000f.WorkItemGroup[101215]
      Task [Id=1653 Status=Faulted] in WorkGroup [SystemTarget: S172.19.227.65:11111:290933946*stg/15/0000000f@S0000000f] took elapsed time 0:00:00.2714147 for execution which is longer than 00:00:00.2000000. Running on thread System.Threading.Thread","-Failed to get ping responses from all 1 silos that are currently listed as Active in the Membership table Orleans.Runtime.MembershipService.MembershipOracleData[100661]
      -Failed to get ping responses from all 1 silos that are currently listed as Active in the Membership table. Newly joining silos validate connectivity with all pre-existing silos that are listed as Active in the table and have written I Am Alive in the table in the last 00:10:00 period before they are allowed to join the cluster. Active silos are: [[SiloAddress=S10.0.75.1:11111:290933742 SiloName=Silo_048a5 Status=Active HostName=LiBo ProxyPort=30000 RoleName= UpdateZone=0 FaultZone=0 StartTime = 2019-03-22 06:55:43.000 GMT IAmAliveTime = 2019-03-22 07:00:51.000 GMT  ]]
warn: Orleans.Runtime.Scheduler *stg/15/0000000f.WorkItemGroup[101215]
      Task [Id=1653 Status=Faulted] in WorkGroup [SystemTarget: S172.19.227.65:11111:290933946*stg/15/0000000f@S0000000f] took elapsed time 0:00:00.2714147 for execution which is longer than 00:00:00.2000000. Running on thread System.Threading.Thread",,sergeybykov,,
5462,Update changelog with 2.3.0 changes,,Update changelog with 2.3.0 changes ,,ReubenBond,,
5459,How to clear JournaledGrain's state or events,"I have some JournaledGrains that never activate later. So i need to clear these grains state/events In order to  reduce grain state storage space used. But i can't find **ClearStateAsync()** method in JournaledGrain class.  

So my question is: How to clear JournaledGrain state or events?","How to clear JournaledGrain's state or events I have some JournaledGrains that never activate later. So i need to clear these grains state/events In order to  reduce grain state storage space used. But i can't find **ClearStateAsync()** method in JournaledGrain class.  

So my question is: How to clear JournaledGrain state or events?",,sebastianburckhardt,,
5458,Component configurator function order independant,"Modified component configurator extension functions so order of configuration no longer matters.

With component specialization via interfaces as IAAA : IAA: IA extension functions on the more specialized (IAAA) interfaces had to be used first as the extension functions on the less specific interface (IA) would return the less specific interface limiting all future extension functions to that limited surface.

Example from streams the following would work:

    .AddEventHubStreams(StreamProviderName b=>b
        .ConfigureEventHub(ob=>ob.Configure(
            options =>
            {
                options.ConnectionString = TestDefaultConfiguration.EventHubConnectionString;
                options.ConsumerGroup = EHConsumerGroup;
                options.Path = EHPath;
            }))
        .ConfigureStreamPubSub(StreamPubSubType.ImplicitOnly));

but this wouldn't

    .AddEventHubStreams(StreamProviderName b=>b
        .ConfigureStreamPubSub(StreamPubSubType.ImplicitOnly)
        .ConfigureEventHub(ob=>ob.Configure(
            options =>
            {
                options.ConnectionString = TestDefaultConfiguration.EventHubConnectionString;
                options.ConsumerGroup = EHConsumerGroup;
                options.Path = EHPath;
            })));

Because the ConfigureEventHub extension function was hung on a more specialized interface than ConfigureEventHub so it needed to be used first.

With this change they both work.","Component configurator function order independant Modified component configurator extension functions so order of configuration no longer matters.

With component specialization via interfaces as IAAA : IAA: IA extension functions on the more specialized (IAAA) interfaces had to be used first as the extension functions on the less specific interface (IA) would return the less specific interface limiting all future extension functions to that limited surface.

Example from streams the following would work:

    .AddEventHubStreams(StreamProviderName b=>b
        .ConfigureEventHub(ob=>ob.Configure(
            options =>
            {
                options.ConnectionString = TestDefaultConfiguration.EventHubConnectionString;
                options.ConsumerGroup = EHConsumerGroup;
                options.Path = EHPath;
            }))
        .ConfigureStreamPubSub(StreamPubSubType.ImplicitOnly));

but this wouldn't

    .AddEventHubStreams(StreamProviderName b=>b
        .ConfigureStreamPubSub(StreamPubSubType.ImplicitOnly)
        .ConfigureEventHub(ob=>ob.Configure(
            options =>
            {
                options.ConnectionString = TestDefaultConfiguration.EventHubConnectionString;
                options.ConsumerGroup = EHConsumerGroup;
                options.Path = EHPath;
            })));

Because the ConfigureEventHub extension function was hung on a more specialized interface than ConfigureEventHub so it needed to be used first.

With this change they both work.",,ReubenBond,,
5457,Made stream fault handler a plugable component.,,Made stream fault handler a plugable component. ,,xiazen,,
5456,Simple call chain reentrancy deadlock A->B->C->A (with repro),"There is call chain reentrancy deadlock with simple call flow A -> B -> C -> A.

[Grains.zip](https://github.com/dotnet/orleans/files/2979656/Grains.zip)

UPD:  Not reproducing on 2.1.0 version.","Simple call chain reentrancy deadlock A->B->C->A (with repro) There is call chain reentrancy deadlock with simple call flow A -> B -> C -> A.

[Grains.zip](https://github.com/dotnet/orleans/files/2979656/Grains.zip)

UPD:  Not reproducing on 2.1.0 version.",,ReubenBond,,
5452,Registration based on interface name,To do an early cluster based on zookeeper or consul Orleans supports registration based on interface names? such as **Alibaba RPC high performance framework-DUBBO** .,Registration based on interface name To do an early cluster based on zookeeper or consul Orleans supports registration based on interface names? such as **Alibaba RPC high performance framework-DUBBO** .,,sergeybykov,,
5451,"Revert ""Stop packing *.symbols.nupkg packages""","Reverts dotnet/orleans#5441

For some reason it seems to break our code signing infra...","Revert ""Stop packing *.symbols.nupkg packages"" Reverts dotnet/orleans#5441

For some reason it seems to break our code signing infra...",,sergeybykov,,
5450,Added IQueueData adapter for persistent streams.,#NAME?,"Added IQueueData adapter for persistent streams. - Updated AzureQueueStream to use IQueueDataAdapter replacing IAzureQueueDataAdapter.
- Cleaned up azure queue stream provider configuration to support IQueueDataAdapter as a configurable component.",,xiazen,,
5448,"[Feature Request] ""Delete"" a grain with transactional state","We have a couple cases where we would like to have a grain with transactional state that gets deleted after some amount of time. With a normal stateful grain you can call  which with the right storage parameters will cause the grain state to get removed from storage. With transactional state there isn't currently such an option. It is possible to manually reset the state but it still remains in storage. There isn't really a great way to know that it is safe to delete from storage manually either.

It does seem possible (though tricky) to implement the feature. Once all pending transactions are fully resolved it should be safe to delete. Could possibly delete in the ""second phase"" of the commit but may not want to take that risk. Would also likely want to fail any new transactions that try to access state that is pending deletion.","[Feature Request] ""Delete"" a grain with transactional state We have a couple cases where we would like to have a grain with transactional state that gets deleted after some amount of time. With a normal stateful grain you can call  which with the right storage parameters will cause the grain state to get removed from storage. With transactional state there isn't currently such an option. It is possible to manually reset the state but it still remains in storage. There isn't really a great way to know that it is safe to delete from storage manually either.

It does seem possible (though tricky) to implement the feature. Once all pending transactions are fully resolved it should be safe to delete. Could possibly delete in the ""second phase"" of the commit but may not want to take that risk. Would also likely want to fail any new transactions that try to access state that is pending deletion.",enhancement,jason-bragg,,
5447,Errors when deactivating a grain with transactional state,Putting ,Errors when deactivating a grain with transactional state Putting ,,jason-bragg,,
5446,Protected property in base class being changed by another grain at the same millisecond execution time,"Suppose we have the following class:



Please note the grainIds is list collection with more 10K+ (the more the better chance to reproduce the behaviour) records all the time","Protected property in base class being changed by another grain at the same millisecond execution time Suppose we have the following class:



Please note the grainIds is list collection with more 10K+ (the more the better chance to reproduce the behaviour) records all the time",,ReubenBond,,
5445,Grain extensions are now available on system targets and Grain services,,Grain extensions are now available on system targets and Grain services ,,ReubenBond,,
5444,Stream subscription from startup task doesn't quite work,"https://github.com/dotnet/orleans/issues/587 indicated that it should be possible to access streams from a startup task when using the direct client. This is sort of true but still has some issues.
For example:
 to be used.

After subscribing in the workaround manor the stream does seem to work as expected.","Stream subscription from startup task doesn't quite work https://github.com/dotnet/orleans/issues/587 indicated that it should be possible to access streams from a startup task when using the direct client. This is sort of true but still has some issues.
For example:
 to be used.

After subscribing in the workaround manor the stream does seem to work as expected.",,jason-bragg,,
5443,Fix a code typo in migration guide,Trying to fill some gaps that I found trying to follow migration guides and pages.,Fix a code typo in migration guide Trying to fill some gaps that I found trying to follow migration guides and pages.,,sergeybykov,,
5442,Changelog for 2.3.0-rc2,,Changelog for 2.3.0-rc2 ,,ReubenBond,,
5441,Stop packing *.symbols.nupkg packages,,Stop packing *.symbols.nupkg packages ,,sergeybykov,,
5439,Create many grains and detect that all grains are finished?,"Hello distributed computing framework is rare with .Net Orleans is excellent.

Our situation is that in Front-end user click a button to start a computing task(it is not Task in .Net) which is split into many sub-tasks and each sub-task or several sub-tasks is a grains the code may like below


the question are:
1. Whether it is suitable to create so many grains. I‘m afraid so many will take soil down or reduce performance
2. How to detect all grains are finished job. After all sub-tasks are finished then calculate summary value from values of sub-tasks. Is it suitable to waitall with so many Task?
3. Method ""Calculate"" of grains ""IElementCalculator"" may take long time to finish job Should use external task like Task.Run?

Thanks","Create many grains and detect that all grains are finished? Hello distributed computing framework is rare with .Net Orleans is excellent.

Our situation is that in Front-end user click a button to start a computing task(it is not Task in .Net) which is split into many sub-tasks and each sub-task or several sub-tasks is a grains the code may like below


the question are:
1. Whether it is suitable to create so many grains. I‘m afraid so many will take soil down or reduce performance
2. How to detect all grains are finished job. After all sub-tasks are finished then calculate summary value from values of sub-tasks. Is it suitable to waitall with so many Task?
3. Method ""Calculate"" of grains ""IElementCalculator"" may take long time to finish job Should use external task like Task.Run?

Thanks",question,sergeybykov,,
5438,How to use consul to implement cluster,"How to use consul to implement cluster?
Is there relevant source code?
thx","How to use consul to implement cluster How to use consul to implement cluster?
Is there relevant source code?
thx",question,sergeybykov,,
5437,Introduced general component configurator pattern.,#NAME?,"Introduced general component configurator pattern. - Added IComponentConfigurator as a general configurator for components with subcomponents.and/or multiple options.
- Added NamesServiceConfigurator base class for configuring named services with subcomponents and/or multiple options.
- Refactors stream configurators to use names service configurator configurator pattern.",,xiazen,,
5432,Concerns regarding lack of separation between indexing and storage,"During our work on the CosmosDB provider we've found some concerns regarding the implementation of indexing and the lack of separation from the storage provider. 

The tl;dr should probably be something in the lines of ""storage and indexing is different and in most cases will require different implementations backing them"" there fore it should not be implemented by the same interface. 

A bit longer version:

1. Indexing is implicit in the write state async call the storage provider must be aware of how to enable indexing of selected paths or able to extract these from the state. 

According to code comments CosmosDB is currently the only provider supporting this and some providers such as Blob or table storage will have a hard time supporting it without companion service. 

Services not able to apply indexing directly on the state (Se also 3. on CosmosDB) will have to extract the indexed fields from state them self and store them properly. This seems to require a bit of duplicated and possible complex code in each provider which could be avoided using the defined methods DirectApplyIndexUpdate and DirectApplyIndexUpdateBatch defined in IIndexInterface and then call to an interface implemented by a (storage- or) Index-Provider. 

The index read query does not read state data it only returns GrainReference thus the index besides searching has no use of the state it self. 

2. Reading from index is done via dynamic without a defined interface although commented with ""TODO: define IOrleansIndexingStorageProvider?""

If one are to implement an IndexingStorageProvider it would make even more sense to implement write this way as well.

3. The current implementation in CosmosDB effectively limits a grain type to at most 10GB of data as GrainType is used as partition key. 

The current CosmosDB implementatione queries using stored procedures which cannot be used in cross partition queries. As partitioning and querying is done by GrainType this limits the amount of data for a single grain type to 10GB. 

A pull request to allow [custom partitioning based on GrainReference](https://github.com/OrleansContrib/Orleans.CosmosDB/pull/26) solves this propblem for general state storage but does not address indexing. Indexing can still work with this pull request if the CosmosDB provided is change from a stored procedure query to a SQL query    with feed options set to allow cross partition queries. This will come at a potentially significant cost in terms of request charge on the CosmosDB and it may be that it will be better to store index data for CosmosDB separately with only the indexed data and grain reference partitioned by the grain type while letting the state it self follow custom partition key logic. Implementation of a separate index storage in CosmosDB based on calls from DirectApplyIndexUpdate seems doable. ","Concerns regarding lack of separation between indexing and storage During our work on the CosmosDB provider we've found some concerns regarding the implementation of indexing and the lack of separation from the storage provider. 

The tl;dr should probably be something in the lines of ""storage and indexing is different and in most cases will require different implementations backing them"" there fore it should not be implemented by the same interface. 

A bit longer version:

1. Indexing is implicit in the write state async call the storage provider must be aware of how to enable indexing of selected paths or able to extract these from the state. 

According to code comments CosmosDB is currently the only provider supporting this and some providers such as Blob or table storage will have a hard time supporting it without companion service. 

Services not able to apply indexing directly on the state (Se also 3. on CosmosDB) will have to extract the indexed fields from state them self and store them properly. This seems to require a bit of duplicated and possible complex code in each provider which could be avoided using the defined methods DirectApplyIndexUpdate and DirectApplyIndexUpdateBatch defined in IIndexInterface and then call to an interface implemented by a (storage- or) Index-Provider. 

The index read query does not read state data it only returns GrainReference thus the index besides searching has no use of the state it self. 

2. Reading from index is done via dynamic without a defined interface although commented with ""TODO: define IOrleansIndexingStorageProvider?""

If one are to implement an IndexingStorageProvider it would make even more sense to implement write this way as well.

3. The current implementation in CosmosDB effectively limits a grain type to at most 10GB of data as GrainType is used as partition key. 

The current CosmosDB implementatione queries using stored procedures which cannot be used in cross partition queries. As partitioning and querying is done by GrainType this limits the amount of data for a single grain type to 10GB. 

A pull request to allow [custom partitioning based on GrainReference](https://github.com/OrleansContrib/Orleans.CosmosDB/pull/26) solves this propblem for general state storage but does not address indexing. Indexing can still work with this pull request if the CosmosDB provided is change from a stored procedure query to a SQL query    with feed options set to allow cross partition queries. This will come at a potentially significant cost in terms of request charge on the CosmosDB and it may be that it will be better to store index data for CosmosDB separately with only the indexed data and grain reference partitioned by the grain type while letting the state it self follow custom partition key logic. Implementation of a separate index storage in CosmosDB based on calls from DirectApplyIndexUpdate seems doable. ",design-review,sergeybykov,12/03/2019 0:41,
5431,Orleans 2.3.0-rc1 and ASP.NET Core 3.0-preview3 co-hosting doesn't work,"Copying the problem from Gitter for better tracking.
Using the code like this:
 dependencies to 3.0.0-preview3.19153.1 and rebuilt Orleans and it worked.
Will it be fixed\released in Orleans or we should wait until ASP.NET Core 3.0 release?","Orleans 2.3.0-rc1 and ASP.NET Core 3.0-preview3 co-hosting doesn't work Copying the problem from Gitter for better tracking.
Using the code like this:
 dependencies to 3.0.0-preview3.19153.1 and rebuilt Orleans and it worked.
Will it be fixed\released in Orleans or we should wait until ASP.NET Core 3.0 release?",,ReubenBond,,
5427,Question: implement custom read-only stream provider,"Hi

We have a global event-log in our system (implemented using [SQLStreamStore](https://github.com/SQLStreamStore/SQLStreamStore)).

The system is based on JournalledGrains which write (produce) events to the log. 

After an event is sucessfully written it is published onto an orleans stream with a fixed namespace and a fixed id so essentially there is one large stream.

Eventprocessors are implemented using Implicit Subscriptions on the global stream.

Currently we're using the Azure storage queue streamprovider which is not optimal for our use-case. We're facing several problems:

1 a slow eventprocessor impact all event processing (because we use a single streamid/streamnamespace)
2 we can not rewind (start at a specific position) per eventprocessor
3 latency of eventprocessing is suboptimal because of dispatching the event to azure storage

We've discussed this internally and come up with 2 possible solutions:

**Drop orleans streams and subscribe directly to global event-log**

In this solution our eventprocessors each have an own cursor to the event-log this let's them work at their own pace without impacting other eventprocessors. They each poll the event-log for new messages after their last-processed event.

Challenges in this solution are
* Database overload.  
Because each eventprocessor is polling the database in short intervals this could overload the db. Solution would could to cache this per silo where each eventprocessor subscribes to the cache where it is activated challenges with this caching strategy are how to handle slow consumers
* Always-on eventprocessors
Eventprocessors have to be kept alive this could be implemented by some sort of watchdog-grain which invokes the eventprocessors at timed intervals to keep them alive. (we previously relied on implicit subscriptions for this).

**Hybrid solution implementing custom readonly-streamprovider**

Because our event-log is basically a stream we could implement our own (readonly) streamprovider for it. I've looked at the azure storage queue and the AWS implementations. Implementing something like that is fairly straightforward. But I have a few questions:
* how to make them rewindable
* how to implement this so each streamconsumer (on one single stream) does not impact each other.
* can orleans streaming be adapted so it is feasible to use with 1 stream and many subscribers








","Question: implement custom read-only stream provider Hi

We have a global event-log in our system (implemented using [SQLStreamStore](https://github.com/SQLStreamStore/SQLStreamStore)).

The system is based on JournalledGrains which write (produce) events to the log. 

After an event is sucessfully written it is published onto an orleans stream with a fixed namespace and a fixed id so essentially there is one large stream.

Eventprocessors are implemented using Implicit Subscriptions on the global stream.

Currently we're using the Azure storage queue streamprovider which is not optimal for our use-case. We're facing several problems:

1 a slow eventprocessor impact all event processing (because we use a single streamid/streamnamespace)
2 we can not rewind (start at a specific position) per eventprocessor
3 latency of eventprocessing is suboptimal because of dispatching the event to azure storage

We've discussed this internally and come up with 2 possible solutions:

**Drop orleans streams and subscribe directly to global event-log**

In this solution our eventprocessors each have an own cursor to the event-log this let's them work at their own pace without impacting other eventprocessors. They each poll the event-log for new messages after their last-processed event.

Challenges in this solution are
* Database overload.  
Because each eventprocessor is polling the database in short intervals this could overload the db. Solution would could to cache this per silo where each eventprocessor subscribes to the cache where it is activated challenges with this caching strategy are how to handle slow consumers
* Always-on eventprocessors
Eventprocessors have to be kept alive this could be implemented by some sort of watchdog-grain which invokes the eventprocessors at timed intervals to keep them alive. (we previously relied on implicit subscriptions for this).

**Hybrid solution implementing custom readonly-streamprovider**

Because our event-log is basically a stream we could implement our own (readonly) streamprovider for it. I've looked at the azure storage queue and the AWS implementations. Implementing something like that is fairly straightforward. But I have a few questions:
* how to make them rewindable
* how to implement this so each streamconsumer (on one single stream) does not impact each other.
* can orleans streaming be adapted so it is feasible to use with 1 stream and many subscribers








",question,jason-bragg,,
5426,IHostEnvironmentStatistics and runtime statistics improvements,"Working on this for Linux: #5423 

Todays implementation only considers stats on the host level so it accounts for everything running on server including other services. Now that docker and k8s is becoming increasingly common and Orleans being more suitable for microservices scenarios due to lower idle usage in recent versions it would be beneficial to change the 's that look interesting for exporting.","IHostEnvironmentStatistics and runtime statistics improvements Working on this for Linux: #5423 

Todays implementation only considers stats on the host level so it accounts for everything running on server including other services. Now that docker and k8s is becoming increasingly common and Orleans being more suitable for microservices scenarios due to lower idle usage in recent versions it would be beneficial to change the 's that look interesting for exporting.",,benjaminpetit,,
5425,Refactored stream batch behaviors to support batch consumption.,Only supported by persistent streams.,Refactored stream batch behaviors to support batch consumption. Only supported by persistent streams.,,xiazen,,
5424,Improve activation & directory convergence,Rebasing and fixing comments from #4344 ,Improve activation & directory convergence Rebasing and fixing comments from #4344 ,,ReubenBond,,
5423,Linux version of IHostEnvironmentStatistics,Started work on an implementation for ?,Linux version of IHostEnvironmentStatistics Started work on an implementation for ?,,benjaminpetit,,
5422,Update changelog up to 2.3.0-rc1,,Update changelog up to 2.3.0-rc1 ,,benjaminpetit,,
5421,Co-hosting Orleans and ASP.NET in the same process - performance recommendations,"As requested on Gitter this is an open-ended thread to discuss what are the general performance benefits and drawbacks regarding co-hosting an ASP.NET Front-end (e.g. a RESTful API over Kestrel on ASP.NET Core) in the same process (and by consequence physical host) of an Orleans silo. This question takes special aim at Orleans' use of its own cooperative scheduler vs ASP.NET's use of the Thread Pool and how they would compete for host resources.

Specifically what are the engineering team's thoughts regarding:
- CPU expenditure on thread context switching.
- CPU cache use and possible trashing.
- Scalability benefits and drawbacks.
- Performance benefits and drawbacks.
- Memory contention and possible virtual memory trashing.
- Benefit/drawback relationship as cluster size increases.

The idea is to have some good practice pointers for Orleans users like me to decide when/if it is a good idea to host ASP.NET and Orleans together in the same process (and thereby physical host) or to keep them separate in a client-silo relationship across separate processes (and also machines via the wire) and in what conditions.

If there is already some official documentation regarding this then apologies for raising the issue and ""preemptive"" thanks for redirecting me to it. If not then happy to gather relevant input and PR the docs.","Co-hosting Orleans and ASP.NET in the same process - performance recommendations As requested on Gitter this is an open-ended thread to discuss what are the general performance benefits and drawbacks regarding co-hosting an ASP.NET Front-end (e.g. a RESTful API over Kestrel on ASP.NET Core) in the same process (and by consequence physical host) of an Orleans silo. This question takes special aim at Orleans' use of its own cooperative scheduler vs ASP.NET's use of the Thread Pool and how they would compete for host resources.

Specifically what are the engineering team's thoughts regarding:
- CPU expenditure on thread context switching.
- CPU cache use and possible trashing.
- Scalability benefits and drawbacks.
- Performance benefits and drawbacks.
- Memory contention and possible virtual memory trashing.
- Benefit/drawback relationship as cluster size increases.

The idea is to have some good practice pointers for Orleans users like me to decide when/if it is a good idea to host ASP.NET and Orleans together in the same process (and thereby physical host) or to keep them separate in a client-silo relationship across separate processes (and also machines via the wire) and in what conditions.

If there is already some official documentation regarding this then apologies for raising the issue and ""preemptive"" thanks for redirecting me to it. If not then happy to gather relevant input and PR the docs.",,ReubenBond,,
5419,Orleans Streaming - sparse streams scenario,"Hi! In our company we are trying to use Orleans for IoT scenario. We using IoT Hub/EventHub.
I did a significant amount of research around how to do this properly using available possibilities in Orleans. It turned out that we cannot use Streaming with modified EventHub provider as current implementation has problems with huge number of sparse streams (if we would like to use Stream per Device). Each device can send relatively small amount of data in not so short period like one minute for example. But we can have them really huge number like half millions. That in average can give us around 8k messages per second to the system but for each device - one message per minute. 
Currently using Orleans that way (Stream per Device) turns out really quickly to be inefficient (around 10-20k streams). For that reason we choose hosting EPH along with the silo (as GrainService) and just pass messages directly to the ""device"" grain. That easily could handle 500k grains (if machine RAM was enough). 
I did some time ago discussion about that with @jason-bragg and eventually possibilities of implementing/improving current Streams to handle sparse streams. 
Now i have a time to do more investigation on that and would like to play with it a bit. I wonder if we could have discussion here how this could be handled inside Orleans runtime - some guidance from you guys so i could know where to start looking at. ","Orleans Streaming - sparse streams scenario Hi! In our company we are trying to use Orleans for IoT scenario. We using IoT Hub/EventHub.
I did a significant amount of research around how to do this properly using available possibilities in Orleans. It turned out that we cannot use Streaming with modified EventHub provider as current implementation has problems with huge number of sparse streams (if we would like to use Stream per Device). Each device can send relatively small amount of data in not so short period like one minute for example. But we can have them really huge number like half millions. That in average can give us around 8k messages per second to the system but for each device - one message per minute. 
Currently using Orleans that way (Stream per Device) turns out really quickly to be inefficient (around 10-20k streams). For that reason we choose hosting EPH along with the silo (as GrainService) and just pass messages directly to the ""device"" grain. That easily could handle 500k grains (if machine RAM was enough). 
I did some time ago discussion about that with @jason-bragg and eventually possibilities of implementing/improving current Streams to handle sparse streams. 
Now i have a time to do more investigation on that and would like to play with it a bit. I wonder if we could have discussion here how this could be handled inside Orleans runtime - some guidance from you guys so i could know where to start looking at. ",question,jason-bragg,,
5418,NPE on parsing the partition of an IOT Event Hub endpoint,"I've spent some time on trying to get the AddEventHubStreams to put from the IOT Hubs default endpoint and I'm running into the same issues that @andrew-laughlin is reporting here (https://github.com/dotnet/orleans/issues/4572#issue-321329955) ... @jason-bragg I noticed that much of this code was written by you so I'm hoping you can help as I may just be doing something wrong.  Here is what I've got -- and I'm hoping I am just doing something stupid and don't need to extend all the classes as Andrew did.


","NPE on parsing the partition of an IOT Event Hub endpoint I've spent some time on trying to get the AddEventHubStreams to put from the IOT Hubs default endpoint and I'm running into the same issues that @andrew-laughlin is reporting here (https://github.com/dotnet/orleans/issues/4572#issue-321329955) ... @jason-bragg I noticed that much of this code was written by you so I'm hoping you can help as I may just be doing something wrong.  Here is what I've got -- and I'm hoping I am just doing something stupid and don't need to extend all the classes as Andrew did.


",duplicate,jason-bragg,,
5415,Question/Feature request LoadShedding,"I'm not positive on this but @sergeybykov said to put in an issue to research/investigate possibilities:

@Kritner:
> it seems like utilizing LoadShedding would prevent new clients from connecting in times of overloading... is there a way to disable *that* particular portion of load shedding?

@sergeybykov:
> When load shedding kicks in it starts rejecting client requests. I wonder if what you are seeing is not rejection of a client connection per se but of it's first call to retrieve the grain type map. Could you open an issue on that please. Maybe we should consider special treatment of those calls (if my guess is correct).

I can try to put together a repro at some point but from what I can recall I set my  or setting my threshold higher connections went through w/o issue.

I guess if it's not the client connection failing but the call @sergeybykov referenced about retrieving a grain type map then that could complicate things a bit.  I guess I was hoping that client connections (and everything that a connection entails) would be kept separate from the load shedding.","Question/Feature request LoadShedding I'm not positive on this but @sergeybykov said to put in an issue to research/investigate possibilities:

@Kritner:
> it seems like utilizing LoadShedding would prevent new clients from connecting in times of overloading... is there a way to disable *that* particular portion of load shedding?

@sergeybykov:
> When load shedding kicks in it starts rejecting client requests. I wonder if what you are seeing is not rejection of a client connection per se but of it's first call to retrieve the grain type map. Could you open an issue on that please. Maybe we should consider special treatment of those calls (if my guess is correct).

I can try to put together a repro at some point but from what I can recall I set my  or setting my threshold higher connections went through w/o issue.

I guess if it's not the client connection failing but the call @sergeybykov referenced about retrieving a grain type map then that could complicate things a bit.  I guess I was hoping that client connections (and everything that a connection entails) would be kept separate from the load shedding.",Hacktoberfest,benjaminpetit,,
5414,"Revert ""Migrate src subdirectory to new codegen (#5365)""",#5365 broke our code signing pipeline. We can revert it for now and remerge it back when we update the signing process.,"Revert ""Migrate src subdirectory to new codegen (#5365)"" #5365 broke our code signing pipeline. We can revert it for now and remerge it back when we update the signing process.",,benjaminpetit,,
5411,Test Reliability: Timeout_LongMethod,The ,Test Reliability: Timeout_LongMethod The ,test-issue,ReubenBond,1/03/2019 2:10,
5409,Minor serialization perf & cleanliness improvements,"Minor serializer perf fixes. Can hold until after 2.3.0 is tagged.

Fixes #4443

Also see comment: https://github.com/dotnet/orleans/pull/5210#issuecomment-443859708","Minor serialization perf & cleanliness improvements Minor serializer perf fixes. Can hold until after 2.3.0 is tagged.

Fixes #4443

Also see comment: https://github.com/dotnet/orleans/pull/5210#issuecomment-443859708",,xiazen,,
5408,Removed filtering from streaming infrastructure,Breaking changes to core.abstractions so this is at earliest a 3.0 change,Removed filtering from streaming infrastructure Breaking changes to core.abstractions so this is at earliest a 3.0 change,,xiazen,,
5405,hack to allow physical file provider to be serialized using json,,hack to allow physical file provider to be serialized using json ,,xiazen,,
5404,Backport PRs #3974 and #5184 to 1.5.7," #3974 (Fixes for Multi-Cluster Support).
#5184 (Add GSI cache maintenance and tests).","Backport PRs #3974 and #5184 to 1.5.7  #3974 (Fixes for Multi-Cluster Support).
#5184 (Add GSI cache maintenance and tests).",,ReubenBond,,
5403,got an item for subscription  but I don't have any subscriber for that stream. Dropping on the floor. while pushing message from external service,,"got an item for subscription , but I don't have any subscriber for that stream. Dropping on the floor. while pushing message from external service ",question,jason-bragg,,
5402,Fixed function persistence tests,Fixed function persistence tests broken when IPersistentState facet was introduced.,Fixed function persistence tests Fixed function persistence tests broken when IPersistentState facet was introduced.,,benjaminpetit,,
5401,Fix OneWay cache invalidation,"Fixes #4896

When a OneWay message is destined for a defunct activation send a rejection response for the purpose of cache invalidation. This rejection is sent even though the message may be forwarded on to a new activation simultaneously. The rejection is ignored by the receiver after the cache invalidation headers have been inspected.","Fix OneWay cache invalidation Fixes #4896

When a OneWay message is destined for a defunct activation send a rejection response for the purpose of cache invalidation. This rejection is sent even though the message may be forwarded on to a new activation simultaneously. The rejection is ignored by the receiver after the cache invalidation headers have been inspected.",,benjaminpetit,,
5400,Adds a LoadSheddingValidator class,"- Adds as a default validator within  has been registered.
- Fixes #4389

I did not see (at a glance) any test classes for validator classes... this seems like it should work... maybe?","Adds a LoadSheddingValidator class - Adds as a default validator within  has been registered.
- Fixes #4389

I did not see (at a glance) any test classes for validator classes... this seems like it should work... maybe?",,benjaminpetit,,
5399,Upgraded Microsoft.Azure.EventHubs package to 3.0.0.,The  being made public to remove reflection based helpers.,Upgraded Microsoft.Azure.EventHubs package to 3.0.0. The  being made public to remove reflection based helpers.,,jason-bragg,,
5398,System.Reflection.AmbiguousMatchException: 'Multiple custom attributes of the same type found.',"Hi

When I used the Dashboard v2.2.0 with Orleans.Server v2.2.4 the following exception throws:


The workaround is to downgrade Microsoft.Orleans.Server to v2.2.0 and just worked again... but would be nice if latest verions can be used. 
","System.Reflection.AmbiguousMatchException: 'Multiple custom attributes of the same type found.' Hi

When I used the Dashboard v2.2.0 with Orleans.Server v2.2.4 the following exception throws:


The workaround is to downgrade Microsoft.Orleans.Server to v2.2.0 and just worked again... but would be nice if latest verions can be used. 
",,ReubenBond,,
5397,Test Reliability: ExceptionPropagation_ClientToGrain_SerializationFailure,"UnitTests.General.ExceptionPropagationTests.ExceptionPropagation_ClientToGrain_SerializationFailure is flaky. Example test run: https://ci.dot.net/job/dotnet_orleans/job/master/job/functional_prtest/2578/testReport/junit/UnitTests.General/ExceptionPropagationTests/ExceptionPropagation_ClientToGrain_SerializationFailure/

","Test Reliability: ExceptionPropagation_ClientToGrain_SerializationFailure UnitTests.General.ExceptionPropagationTests.ExceptionPropagation_ClientToGrain_SerializationFailure is flaky. Example test run: https://ci.dot.net/job/dotnet_orleans/job/master/job/functional_prtest/2578/testReport/junit/UnitTests.General/ExceptionPropagationTests/ExceptionPropagation_ClientToGrain_SerializationFailure/

",test-issue,ReubenBond,,
5395,Enable HostedClient by default,Fixes #5337,Enable HostedClient by default Fixes #5337,,jason-bragg,,
5394,Azure Storage Streaming poison handling when message batch can not be deserialized,"Hi

Using the azure storage streaming provider with the default serializer causes an infinite retry loop of message batches serialized with the previous version.

The problem is most likely in https://github.com/dotnet/orleans/blob/bdaf800326b90c5e0950be6b0a8568add56f3b2c/src/Azure/Orleans.Streaming.AzureStorage/Providers/Streams/AzureQueue/AzureQueueAdapterReceiver.cs#L92

The batchcontainer can not be deserialized and should be considered as  
In the next try the previous batch is still invisible (due to InvisibilityTimeout set when retrieving the faulty batch) so it will succeed. 

Eventually our silo was only reading faulty batches and not processing any new messages.

We know that we shouldn't break contracts and that the default Orleans serializer is not version tolerant. We try to avoid making breaking changes but missed one. It should not have broken down the entire silo I think
","Azure Storage Streaming, poison handling when message batch can not be deserialized Hi

Using the azure storage streaming provider with the default serializer causes an infinite retry loop of message batches serialized with the previous version.

The problem is most likely in https://github.com/dotnet/orleans/blob/bdaf800326b90c5e0950be6b0a8568add56f3b2c/src/Azure/Orleans.Streaming.AzureStorage/Providers/Streams/AzureQueue/AzureQueueAdapterReceiver.cs#L92

The batchcontainer can not be deserialized and should be considered as  
In the next try the previous batch is still invisible (due to InvisibilityTimeout set when retrieving the faulty batch) so it will succeed. 

Eventually our silo was only reading faulty batches and not processing any new messages.

We know that we shouldn't break contracts and that the default Orleans serializer is not version tolerant. We try to avoid making breaking changes but missed one. It should not have broken down the entire silo I think
",bug,jason-bragg,,
5392,Reentrant timer issue when AllowCallChainReentrancy = true (default),"As mentioned in https://github.com/dotnet/orleans/issues/2574 it would be great if Timer callbacks respected the reentrancy of grains. There's been a trick people could use to achieve the desired behavior:

[OrleansTimerReentrancyIssue.zip](https://github.com/dotnet/orleans/files/2896697/OrleansTimerReentrancyIssue.zip)

Disabling AllowCallChainReentrancy results in the desired behavior in this case but our code has come to rely on call chain reentrancy (it is the default after all).

**Are there any workarounds?** Ultimately it would be greatly beneficial if the timer could respect grain reentrancy as outlined in https://github.com/dotnet/orleans/issues/2574.","Reentrant timer issue when AllowCallChainReentrancy = true (default) As mentioned in https://github.com/dotnet/orleans/issues/2574 it would be great if Timer callbacks respected the reentrancy of grains. There's been a trick people could use to achieve the desired behavior:

[OrleansTimerReentrancyIssue.zip](https://github.com/dotnet/orleans/files/2896697/OrleansTimerReentrancyIssue.zip)

Disabling AllowCallChainReentrancy results in the desired behavior in this case but our code has come to rely on call chain reentrancy (it is the default after all).

**Are there any workarounds?** Ultimately it would be greatly beneficial if the timer could respect grain reentrancy as outlined in https://github.com/dotnet/orleans/issues/2574.",enhancement,jason-bragg,,
5391,Mark ILBasedSerializer et al as [Obsolete],We created this serializer for cases where BinaryFormatter would otherwise be used since BF was not going to be made available on .NET Core/.NET Standard. Since it is available there is no need for it.,Mark ILBasedSerializer et al as [Obsolete] We created this serializer for cases where BinaryFormatter would otherwise be used since BF was not going to be made available on .NET Core/.NET Standard. Since it is available there is no need for it.,,ReubenBond,,
5390,Cherry-picked fixes for 2.2.4,,Cherry-picked fixes for 2.2.4 ,,ReubenBond,,
5389,"Enable ""cleaning"" of all dead entries in the membership table","Right now we don't delete old entries in the membership table and that can be an issue since it will grow forever. 

This PR enable deleting old silo entries and implement it in the azure membership provider. Other providers still need to implement this logic.","Enable ""cleaning"" of all dead entries in the membership table Right now we don't delete old entries in the membership table and that can be an issue since it will grow forever. 

This PR enable deleting old silo entries and implement it in the azure membership provider. Other providers still need to implement this logic.",,ReubenBond,,
5388,Downgrade Benchmark to target netcoreapp2.1 instead of 2.2,No need to target 2.2 at this point as that increases friction with compiling sources.,Downgrade Benchmark to target netcoreapp2.1 instead of 2.2 No need to target 2.2 at this point as that increases friction with compiling sources.,,ReubenBond,,
5385,Update to Microsoft.Extensions.Options 2.1.1 and remove duplicated classes,for #4703 ,Update to Microsoft.Extensions.Options 2.1.1 and remove duplicated classes for #4703 ,,ReubenBond,,
5384,Upgade to eventhub 2.2.1,,Upgade to eventhub 2.2.1 ,,xiazen,,
5383,How to access Orleans inside Service Fabric from outside? ,"Hi I'm trying to deploy Orleans Silo to a Service Fabric cluster. I need my Orleans client to be outside of the SF cluster. With the sample code the address saved in the Membership table is the internal SF ip.
How can I properly configure Orleans Silo to expose the external addresses for the client to use?
Or maybe there is a way to use Static clustering to connect to the service fabric service?","How to access Orleans inside Service Fabric from outside?  Hi I'm trying to deploy Orleans Silo to a Service Fabric cluster. I need my Orleans client to be outside of the SF cluster. With the sample code the address saved in the Membership table is the internal SF ip.
How can I properly configure Orleans Silo to expose the external addresses for the client to use?
Or maybe there is a way to use Static clustering to connect to the service fabric service?",question,ReubenBond,,
5382,Update statement about rewindable stream providers,,Update statement about rewindable stream providers ,documentation,sergeybykov,21/02/2019 13:05,22/02/2019 10:27
5381,Remove new() requirement from persistent state facet and Grain<T>,Note: This change introduced interface changes in core.abstractions.  We may not want to do this at this time.,Remove new() requirement from persistent state facet and Grain<T> Note: This change introduced interface changes in core.abstractions.  We may not want to do this at this time.,,ReubenBond,,
5380,Enable tx test kit pkg,,Enable tx test kit pkg ,,jason-bragg,,
5379,ConvertJsonToFromStorageFormatWithCustomJsonProperties test fix,#NAME?,ConvertJsonToFromStorageFormatWithCustomJsonProperties test fix - made is skippable,,ReubenBond,,
5376,Client disposal on failed connection in Orleans v2.0 and later,"According to [1.5 documentation](https://dotnet.github.io/orleans/1.5/Documentation/Deployment-and-Operations/Configuration-Guide/Client-Configuration.html):
> If the connection attempt fails the client instance must be disposed.

However I haven't found anything similar in 2.0 documentation.

I'm implementing [connection retries](https://github.com/dotnet/orleans/pull/4161/files) but I'm wondering if the client disposal part should remain in my code:

","Client disposal on failed connection in Orleans v2.0 and later According to [1.5 documentation](https://dotnet.github.io/orleans/1.5/Documentation/Deployment-and-Operations/Configuration-Guide/Client-Configuration.html):
> If the connection attempt fails the client instance must be disposed.

However I haven't found anything similar in 2.0 documentation.

I'm implementing [connection retries](https://github.com/dotnet/orleans/pull/4161/files) but I'm wondering if the client disposal part should remain in my code:

",question,benjaminpetit,,
5375,can i get more than then thousand streams?  any limit or side effect in large count stream?,"i am building mqtt server broker cluster by orleans. 

one stream named cluster stream  to share mqtt packet between brokers in cluster
each broker has its own stream named broker stream.
broker grain subscribe from cluster stream  or publish mqtt packet to cluster stream.
client connect to one broker publish or subscribe mqtt packet in broker.

my question is
should i get a stream for each client(over ten thousand clients) route mqtt packet at grain side.
or just one stream one broker only process mqtt packet at grain client side and route to mqtt client.

can anyone give me some suggestions? 
","can i get more than then thousand streams?  any limit or side effect in large count stream? i am building mqtt server broker cluster by orleans. 

one stream named cluster stream  to share mqtt packet between brokers in cluster
each broker has its own stream named broker stream.
broker grain subscribe from cluster stream  or publish mqtt packet to cluster stream.
client connect to one broker publish or subscribe mqtt packet in broker.

my question is
should i get a stream for each client(over ten thousand clients) route mqtt packet at grain side.
or just one stream one broker only process mqtt packet at grain client side and route to mqtt client.

can anyone give me some suggestions? 
",question,sergeybykov,,
5374,Confusing behavior with ResponseTimeout properties,"So I tried to do this:
.

It might be worth having a separate (getter only) property for the timeout value it will be using or at least some more hints in documentation.","Confusing behavior with ResponseTimeout properties So I tried to do this:
.

It might be worth having a separate (getter only) property for the timeout value it will be using or at least some more hints in documentation.",,benjaminpetit,,
5373,Persistent state facet,This change Introduces a storage facet IPersistentState<T> which allows grains to define state which can be stored in using the existing IGrainStorage implementations.,Persistent state facet This change Introduces a storage facet IPersistentState<T> which allows grains to define state which can be stored in using the existing IGrainStorage implementations.,,ReubenBond,,
5372,Pulling agent losing subscriptions fix,Pulling agent could lose subscriptions if a subscription was added after the subscription cache was cleared.  We now always go to the pubsub system for subscriptions and only add new ones if the stream is active and in the pubsub cache.,Pulling agent losing subscriptions fix Pulling agent could lose subscriptions if a subscription was added after the subscription cache was cleared.  We now always go to the pubsub system for subscriptions and only add new ones if the stream is active and in the pubsub cache.,,xiazen,,
5371,Fix link to blog in readme.md.,,Fix link to blog in readme.md. ,documentation,ReubenBond,,
5370,Orleans Blog Link Broken,"The Orleans Blog link leads to a nonexistent page. 

![image](https://user-images.githubusercontent.com/6845982/52853626-2f23f900-3142-11e9-95b4-05efcbad532c.png)
","Orleans Blog Link Broken The Orleans Blog link leads to a nonexistent page. 

![image](https://user-images.githubusercontent.com/6845982/52853626-2f23f900-3142-11e9-95b4-05efcbad532c.png)
",documentation,sergeybykov,,
5369,Unable to use Microsoft.Azure.EventHubs package greater than 1.0.3 with Microsoft.Orleans.OrleansServiceBus,"It is not possible to use a version of . This fixture contains integration style tests that I had to point at my own EventHub and Storage Table to get working. I wasn't sure if this failure was related to the upgrade so I ran the same test without the upgrade and it still fails for me locally. I assume there is a difference between my setup and the one used in your build system.

I would be happy to put together a PR with these changes if you are interested.","Unable to use Microsoft.Azure.EventHubs package greater than 1.0.3 with Microsoft.Orleans.OrleansServiceBus It is not possible to use a version of . This fixture contains integration style tests that I had to point at my own EventHub and Storage Table to get working. I wasn't sure if this failure was related to the upgrade so I ran the same test without the upgrade and it still fails for me locally. I assume there is a difference between my setup and the one used in your build system.

I would be happy to put together a PR with these changes if you are interested.",,jason-bragg,,
5368,Firewall: Silo nodes do not allow incoming TCP connections. Allow inter-Silo communication via a proxy.,Silo node communication depends on **incoming** TCP connections. Sometimes this is not possible due to firewalls or other constraints. In these situations it would be beneficial when Silo nodes on startup initiate a bi-directional socket to a proxy via which inter-Silo communication is routed.,Firewall: Silo nodes do not allow incoming TCP connections. Allow inter-Silo communication via a proxy. Silo node communication depends on **incoming** TCP connections. Sometimes this is not possible due to firewalls or other constraints. In these situations it would be beneficial when Silo nodes on startup initiate a bi-directional socket to a proxy via which inter-Silo communication is routed.,,ReubenBond,,
5367,OMG DDS vs Orleans,,OMG DDS vs Orleans ,question,sergeybykov,,
5366,Question about Transaction,"I need some advice on using Orleans.Transaction.

To use Orleans.Transaction it is required to declare TransactionOption on the Grain interface.
It means that if you make a method that can be called in or not in Transaction you have to double it.

So I thought this way would be easier to use this way.
 layer.
A Service is matched with a Grain.
When a Service request something to another Service It sends through Grain.
And at Grain level we decide which way to go NoneTransactionalRequest or TransactionalRequest.

If the request is NoneTransactionalRequest create a new transaction.
if the request is TransactionalRequest join the current transaction.

Here are the questions.
First I want to know how you think of this way.
Second Is this way of using Orleans.Transaction is too much?


","Question about Transaction I need some advice on using Orleans.Transaction.

To use Orleans.Transaction it is required to declare TransactionOption on the Grain interface.
It means that if you make a method that can be called in or not in Transaction you have to double it.

So I thought this way would be easier to use this way.
 layer.
A Service is matched with a Grain.
When a Service request something to another Service It sends through Grain.
And at Grain level we decide which way to go NoneTransactionalRequest or TransactionalRequest.

If the request is NoneTransactionalRequest create a new transaction.
if the request is TransactionalRequest join the current transaction.

Here are the questions.
First I want to know how you think of this way.
Second Is this way of using Orleans.Transaction is too much?


",question,jason-bragg,,
5364,Serialization?,"Is not an Issue only a question about the used (binary) serialization. 
In his speech here: [https://youtu.be/vMaqXCq52l8](url) Roger Johansson from akka.net talks about his implementation of message object serialization.
Exists there also somewhere something to compare the numbers? ","Serialization? Is not an Issue only a question about the used (binary) serialization. 
In his speech here: [https://youtu.be/vMaqXCq52l8](url) Roger Johansson from akka.net talks about his implementation of message object serialization.
Exists there also somewhere something to compare the numbers? ",question,ReubenBond,,
5363,Is GrainService support StorageProvider attribute?,"i tried to use GrainServices as documentation code.
StorageProvider  only described used for Grain class can i use it like this?
and if StorageProvider not support how supposed i use storage in GrainService? thans

","Is GrainService support StorageProvider attribute? i tried to use GrainServices as documentation code.
StorageProvider  only described used for Grain class can i use it like this?
and if StorageProvider not support how supposed i use storage in GrainService? thans

",question,sergeybykov,,
5362,AzureQueues stops being processed when large and growing number of streams uses it,"I test Orleans for the use case when large number of independant messages should be processed in the fastest and scalable way. My first approach was to send each message to unique stream in the same namespace. So if message has id = GUID then it is sent to stream <GUID ""Namespace"">. On the processing side I used implicit subscription grain ProcessingGrain with attr [ImplicitStreamSubscription(""Namespace"")]. So as many there are messages to process that many streams and grains are created. After message GUID is processed stream <GUID ""Namespace""> and  ProcessingGrain <GUID> is not needed anymore so I configured ProcessingGrain to be Deactivated after 5 minutes. Not active streams are cleared from Orleans after StreamPullingAgentOptions.StreamInactivityPeriod that was left with the default value = 10 min.
Stream: AzureQueueStreamProvider
Clustering: AzureStorageClustering
Monitoring: Orleans Dashboard 2.2.0

I tried these load scenarios:
- 100-1000 msgs/sec
- 1-2 silos
- 1-8 queues in Azure Queue

Enviroment:
- Orleans 2.2.3
- Windows 10 or Windows Server 2016 Datacenter both x64
- .Net Core 2.2.0

and in all scenarios real Azure Queues were stopped being processed after 10-40 minutes of work. So pulling agents just don't pull messages anymore. Logs show that PubSubCacheSize grows all the time and at value 250-400k mentioned fail occurs. 
Old Grains are successfully deactivated and streams too but after fail occurs streams are not cleared. So value of PubSubCacheSize goes up and down but then on value of 250-400k it is not cleared anymore. At the same time all processing grains are eventually deactivated.

After chatting on gitter I understood that I need to try a solution of pool of streams with fixed number of them to avoid this situation of unbounded number of streams. 

- But anyway I think it is an issue that system just stops process streams with even no message in logs. It looks like everything is fine but messages just accumulate in Azure Queue. 
- Also I don't understand why if inactive streams are cleared after StreamInactivityPeriod and all grains are deactivated the described pattern of 1stream\msg is not working one? It seems to me that up to some load the system should feel fine. New messages create new objects in the system but at that time old objects (streams system info and grains) have been cleared already.

Besides of my (actually not recommended in the docs) scenario please consider another one:
The system creates a group of grains per some event e.g. conference. These grains use persistant stream like AzureQueue for some communication. Conferences should not know about each other so each conference=group of grains uses its own stream Id = Conference Id. The frequency of new conferences creation can be high comparable with my test 100-500/sec. Here each stream is used many times but like in my test when the conference ends stream is not needed anymore. It will never be used again. So number of streams in system can slowly grow. So now it looks similar to my test. 
And I'm afraid that on some load Orleans will stop process streams and create new ones because of some reason. May be because it can't handle situation when speed of new streams creation is more than speed of clearing inactive streams?

Thanks!","AzureQueues stops being processed when large and growing number of streams uses it I test Orleans for the use case when large number of independant messages should be processed in the fastest and scalable way. My first approach was to send each message to unique stream in the same namespace. So if message has id = GUID then it is sent to stream <GUID ""Namespace"">. On the processing side I used implicit subscription grain ProcessingGrain with attr [ImplicitStreamSubscription(""Namespace"")]. So as many there are messages to process that many streams and grains are created. After message GUID is processed stream <GUID ""Namespace""> and  ProcessingGrain <GUID> is not needed anymore so I configured ProcessingGrain to be Deactivated after 5 minutes. Not active streams are cleared from Orleans after StreamPullingAgentOptions.StreamInactivityPeriod that was left with the default value = 10 min.
Stream: AzureQueueStreamProvider
Clustering: AzureStorageClustering
Monitoring: Orleans Dashboard 2.2.0

I tried these load scenarios:
- 100-1000 msgs/sec
- 1-2 silos
- 1-8 queues in Azure Queue

Enviroment:
- Orleans 2.2.3
- Windows 10 or Windows Server 2016 Datacenter both x64
- .Net Core 2.2.0

and in all scenarios real Azure Queues were stopped being processed after 10-40 minutes of work. So pulling agents just don't pull messages anymore. Logs show that PubSubCacheSize grows all the time and at value 250-400k mentioned fail occurs. 
Old Grains are successfully deactivated and streams too but after fail occurs streams are not cleared. So value of PubSubCacheSize goes up and down but then on value of 250-400k it is not cleared anymore. At the same time all processing grains are eventually deactivated.

After chatting on gitter I understood that I need to try a solution of pool of streams with fixed number of them to avoid this situation of unbounded number of streams. 

- But anyway I think it is an issue that system just stops process streams with even no message in logs. It looks like everything is fine but messages just accumulate in Azure Queue. 
- Also I don't understand why if inactive streams are cleared after StreamInactivityPeriod and all grains are deactivated the described pattern of 1stream\msg is not working one? It seems to me that up to some load the system should feel fine. New messages create new objects in the system but at that time old objects (streams system info and grains) have been cleared already.

Besides of my (actually not recommended in the docs) scenario please consider another one:
The system creates a group of grains per some event e.g. conference. These grains use persistant stream like AzureQueue for some communication. Conferences should not know about each other so each conference=group of grains uses its own stream Id = Conference Id. The frequency of new conferences creation can be high comparable with my test 100-500/sec. Here each stream is used many times but like in my test when the conference ends stream is not needed anymore. It will never be used again. So number of streams in system can slowly grow. So now it looks similar to my test. 
And I'm afraid that on some load Orleans will stop process streams and create new ones because of some reason. May be because it can't handle situation when speed of new streams creation is more than speed of clearing inactive streams?

Thanks!",,jason-bragg,,
5359,MySQL membership failed to start ,"Hi All

Configured my Silo  with ADO net clustering to use MySQL as the storage provider. Executed the MySQL scripts which are in OrleansAdoNetContent and created the tables OrleansQuery orleansmembershiptable and orleansmembershipversiontable. But when running the SiloHost it gives the following error and fails. 

![mysql error- orleans](https://user-images.githubusercontent.com/4996419/52545829-a2f69680-2e0e-11e9-849d-d3e134233f76.jpg)


This is my Code for Silo Configuration 



![silo_code](https://user-images.githubusercontent.com/4996419/52545922-77c07700-2e0f-11e9-92ed-a35cf351942c.PNG)


All the packages are uptodate (V 2.2.3)


Thanks in advance 
","MySQL membership failed to start  Hi All

Configured my Silo  with ADO net clustering to use MySQL as the storage provider. Executed the MySQL scripts which are in OrleansAdoNetContent and created the tables OrleansQuery orleansmembershiptable and orleansmembershipversiontable. But when running the SiloHost it gives the following error and fails. 

![mysql error- orleans](https://user-images.githubusercontent.com/4996419/52545829-a2f69680-2e0e-11e9-849d-d3e134233f76.jpg)


This is my Code for Silo Configuration 



![silo_code](https://user-images.githubusercontent.com/4996419/52545922-77c07700-2e0f-11e9-92ed-a35cf351942c.PNG)


All the packages are uptodate (V 2.2.3)


Thanks in advance 
",,sergeybykov,,
5354,Add handling when pulling agent fails RegisterAsProducer to pubsub,,Add handling when pulling agent fails RegisterAsProducer to pubsub ,,jason-bragg,,
5351,Persistent Grain super slow after having more than 5 active,"I recently converted all my grains to be persistent grains that hold grain state. After starting to do load testing however I'm noticing that beyond a threshold of 5 grains being active (single silo) it takes a long long time for me to get another grain and have it kick off to doing work. Does anyone have any thoughts as to why this would happen?

Here is the workflow.

POST to web api to create a factory (FactoryGrain)
POST to web api a bunch of orders to be worked on by the factory.

Factory spawns WorkerGrains to work on each order and then report back when they finish.

If I have 2 factories with 3 worker each another POST to create a factory times out with more than 30 second response time. 

During POST Factory I set up a FactoryGrain set an instance int variable and have it subscribe it to 2 streams. When it's timing out it hangs at setting the instance variable. ","Persistent Grain super slow after having more than 5 active I recently converted all my grains to be persistent grains that hold grain state. After starting to do load testing however I'm noticing that beyond a threshold of 5 grains being active (single silo) it takes a long long time for me to get another grain and have it kick off to doing work. Does anyone have any thoughts as to why this would happen?

Here is the workflow.

POST to web api to create a factory (FactoryGrain)
POST to web api a bunch of orders to be worked on by the factory.

Factory spawns WorkerGrains to work on each order and then report back when they finish.

If I have 2 factories with 3 worker each another POST to create a factory times out with more than 30 second response time. 

During POST Factory I set up a FactoryGrain set an instance int variable and have it subscribe it to 2 streams. When it's timing out it hangs at setting the instance variable. ",,sergeybykov,,
5350,Migrate blog content from shut down MSDN blogs to docs,"We can later mirror the content on some blogging engine if we want. For now at least it'll be available as part of our docs.

You can see a preview on http://sergeybykov.github.io/orleans/Blog/index.html.","Migrate blog content from shut down MSDN blogs to docs We can later mirror the content on some blogging engine if we want. For now at least it'll be available as part of our docs.

You can see a preview on http://sergeybykov.github.io/orleans/Blog/index.html.",documentation,sergeybykov,6/02/2019 6:07,6/02/2019 10:04
5349,Skip TestMultiClusterConf_3_3 test until it is fixed to pass reliably,,Skip TestMultiClusterConf_3_3 test until it is fixed to pass reliably ,,ReubenBond,,
5348,Large message send hang,"Today we've met some strange crash. It started with these messages in log (you can see 
So a silo became suddenly stopped responding and other nodes marked it as Dead in membership table.

Is there any way to track sources of this problem and maybe better way to catch it / monitor without waiting for so much calls to be dropped by timeout?","Large message send hang Today we've met some strange crash. It started with these messages in log (you can see 
So a silo became suddenly stopped responding and other nodes marked it as Dead in membership table.

Is there any way to track sources of this problem and maybe better way to catch it / monitor without waiting for so much calls to be dropped by timeout?",,sergeybykov,,
5347,Jil Serializer breaks Orleans,"Sometimes when i reboot my server Web docker container can't connect to Silo container with this errors:


","Jil Serializer breaks Orleans Sometimes when i reboot my server Web docker container can't connect to Silo container with this errors:


",,ReubenBond,,
5346,Receiving Orleans.Storage.InconsistentState Exception while using Streams and Reminders,"Hi I recently added Reminders to my project to add fault tolerance. After adding it though and doing some stress testing with increasing load I see errors popping up such as 

""Error from storage provider AdoNetGrainStorage.Orleans.Streams.PubSubRendezvousGrain during WriteState"" 

and 

""Failed to register a stream producer.""

I've noted that possibly this issue https://github.com/dotnet/orleans/issues/2565 may have been related. However I'm using Reminders and not timers. Do you guys have any thoughts on this?","Receiving Orleans.Storage.InconsistentState Exception while using Streams and Reminders Hi I recently added Reminders to my project to add fault tolerance. After adding it though and doing some stress testing with increasing load I see errors popping up such as 

""Error from storage provider AdoNetGrainStorage.Orleans.Streams.PubSubRendezvousGrain during WriteState"" 

and 

""Failed to register a stream producer.""

I've noted that possibly this issue https://github.com/dotnet/orleans/issues/2565 may have been related. However I'm using Reminders and not timers. Do you guys have any thoughts on this?",,sergeybykov,,
5340,Code generation bug with generics,"The following interface and implementation cause a compile-time error with Orleans 1.5.6:

 generated which does not compile.","Code generation bug with generics The following interface and implementation cause a compile-time error with Orleans 1.5.6:

 generated which does not compile.",codegen,ReubenBond,,
5339,Orleans hangs when one grain gets two request at the same time,"I'm trying on TransactionalState and following code does not work.
Can anybody help me?

","Orleans hangs when one grain gets two request at the same time I'm trying on TransactionalState and following code does not work.
Can anybody help me?

",,jason-bragg,,
5337,Enable hosted client by default,,Enable hosted client by default ,,ReubenBond,,
5336,Batching batch containers pulling agent retrieves from cache,"- This change attempts to add a layer of batching in the PersistentStreamPullingAgent. If configured the 
   PersistentStreamPullingAgent will accumulate several BatchContainers received from a cache and place 
   them in an instance of BatchContainerBatch before delivering.

I'll add tests and fix the white spaces changes that were somehow included in the pull request. Mostly creating this pull request for visibility.
","Batching batch containers pulling agent retrieves from cache - This change attempts to add a layer of batching in the PersistentStreamPullingAgent. If configured the 
   PersistentStreamPullingAgent will accumulate several BatchContainers received from a cache and place 
   them in an instance of BatchContainerBatch before delivering.

I'll add tests and fix the white spaces changes that were somehow included in the pull request. Mostly creating this pull request for visibility.
",,jason-bragg,,
5335,Is it possible to connect other virtual actor systems in Orleans？,"Hi.

Is it possible to connect other virtual actor systems in Orleans? Like [orbit](https://github.com/orbit/orbit)

I think there may be tasks that need to be implemented in other languages so maybe the communication of two different virutal actor systems will become a difficult problem to solve.","Is it possible to connect other virtual actor systems in Orleans？ Hi.

Is it possible to connect other virtual actor systems in Orleans? Like [orbit](https://github.com/orbit/orbit)

I think there may be tasks that need to be implemented in other languages so maybe the communication of two different virutal actor systems will become a difficult problem to solve.",question,sergeybykov,,
5334,added OnActivate reentrancy test,This test fails on recursive call from OnActivateAsync(). This is for #5331,added OnActivate reentrancy test This test fails on recursive call from OnActivateAsync(). This is for #5331,,jason-bragg,,
5332,Serialization Exception for ImmutableArray<int> ,"Hi

Using 1.5.0 (we can't yet upgrade to 2.0)

 can just suffice with a normal array","Serialization Exception for ImmutableArray<int>  Hi

Using 1.5.0 (we can't yet upgrade to 2.0)

 can just suffice with a normal array",,ReubenBond,,
5331,Deadlocks on recursive calls,"The #3185 issue was closed a year ago but we're still getting problems with reentrant calls (using orleans 2.2 on netcore/linux).
Assuming interfaces
 results in deadlock that fails with timeout.","Deadlocks on recursive calls The #3185 issue was closed a year ago but we're still getting problems with reentrant calls (using orleans 2.2 on netcore/linux).
Assuming interfaces
 results in deadlock that fails with timeout.",,jason-bragg,,
5330,Every call to the grain sends a packet over the network for a request? ,"Is there a way to get the requested data directly to silo because each time the requested parameter is a complex object it will take some time to make a memory copy and then send it over the network. Assuming my program is only running on one server the above operations will waste a lot of performance.
Thank you for reading。","Every call to the grain sends a packet over the network for a request?  Is there a way to get the requested data directly to silo because each time the requested parameter is a complex object it will take some time to make a memory copy and then send it over the network. Assuming my program is only running on one server the above operations will waste a lot of performance.
Thank you for reading。",question,sergeybykov,,
5329,Orleans on OpenShift,"We are trying to launch _Orleans 2.2_ on [OpenShift](https://www.openshift.com/) platform.
However we do have one important network limitation. We are only allowed to communicate between Orleans silos (Docker containers) through a single gateway address. Our security limitations we cannot allow direct TCP ""silo-to-silo"" communication. 
If I try to initialize   with our gateway address and allowed port Orleans cannot let me launch a second silo on the same IP address. It just deactivates old silo and starts up a new one.
Are there any ways to circumvent that? Or using _Orleans_ on our current infrastructure is not the way to be?","Orleans on OpenShift We are trying to launch _Orleans 2.2_ on [OpenShift](https://www.openshift.com/) platform.
However we do have one important network limitation. We are only allowed to communicate between Orleans silos (Docker containers) through a single gateway address. Our security limitations we cannot allow direct TCP ""silo-to-silo"" communication. 
If I try to initialize   with our gateway address and allowed port Orleans cannot let me launch a second silo on the same IP address. It just deactivates old silo and starts up a new one.
Are there any ways to circumvent that? Or using _Orleans_ on our current infrastructure is not the way to be?",question,sergeybykov,,
5327,Access Grain from Controller in Orleans 2.0,"Hi. I'm migrating an MVC project from Orleans 1.5.6 to Orleans 2.0. Previously I would have accessed a Grain from a Controller by doing something like this:



But there is no implementation type for GrainFactory that I can access.

Am I missing something obvious here? Feels like there should be a straightforward way to access a Grain from a Controller.
","Access Grain from Controller in Orleans 2.0 Hi. I'm migrating an MVC project from Orleans 1.5.6 to Orleans 2.0. Previously I would have accessed a Grain from a Controller by doing something like this:



But there is no implementation type for GrainFactory that I can access.

Am I missing something obvious here? Feels like there should be a straightforward way to access a Grain from a Controller.
",question,sergeybykov,,
5326,SimpleMessageStream performance seems not good enough,"According to the [Orleans Streams Documention](https://dotnet.github.io/orleans/Documentation/streaming/index.html) I try to write a chat demo which uses the SimpleMessageStream. I just want to simulate some simple usecases in a chat system such as one-to-one chat. 

The demo looks like:
1. A silo cluster(more than 2 silo servers )
2. Several clients each one simulates hundreds of users(in fact it's a gateway between the silo server and the user's devices. Because Orleans doesn't want to directly exposed the server address to the user right?)  
3. Each user has a unique ID and subscribes a stream which is based on his ID.So other users can publish a message to a user's stream if they know his ID and the user will receive it because he subscribes himself.

I am concerned about the latency in the chat system so I divide the users into two group(A and B). In group A each user will cyclic(now it is 5 second) send a message with a local unix timestamp to several(now it is 10) users in group B. In group B when a user receive a message from group A it would send the same message(the unix timestamp not change) back to the user in group A. When the user in group A receive the response message he could use the local unix timestamp to calculate the latency.

the client side's code looks like that:
 

The server/client machine's all use CentOS 7 and their cpu(8 cores) usage doesn't reach 100%(in 
 fact the server's usage is only about 40% and the bandwidth is enough. 

Although the average latency seems good but there is 5% latency more than 240 ms and 1%  more than 860 ms. Compare to the NATS's result it is a little bit unacceptable :(

PS:I guess some off-cpu analysis work will be down. I am trying to use bcc tools to do some analysis but have met some problems about the dotnet core symbols.","SimpleMessageStream performance seems not good enough According to the [Orleans Streams Documention](https://dotnet.github.io/orleans/Documentation/streaming/index.html) I try to write a chat demo which uses the SimpleMessageStream. I just want to simulate some simple usecases in a chat system such as one-to-one chat. 

The demo looks like:
1. A silo cluster(more than 2 silo servers )
2. Several clients each one simulates hundreds of users(in fact it's a gateway between the silo server and the user's devices. Because Orleans doesn't want to directly exposed the server address to the user right?)  
3. Each user has a unique ID and subscribes a stream which is based on his ID.So other users can publish a message to a user's stream if they know his ID and the user will receive it because he subscribes himself.

I am concerned about the latency in the chat system so I divide the users into two group(A and B). In group A each user will cyclic(now it is 5 second) send a message with a local unix timestamp to several(now it is 10) users in group B. In group B when a user receive a message from group A it would send the same message(the unix timestamp not change) back to the user in group A. When the user in group A receive the response message he could use the local unix timestamp to calculate the latency.

the client side's code looks like that:
 

The server/client machine's all use CentOS 7 and their cpu(8 cores) usage doesn't reach 100%(in 
 fact the server's usage is only about 40% and the bandwidth is enough. 

Although the average latency seems good but there is 5% latency more than 240 ms and 1%  more than 860 ms. Compare to the NATS's result it is a little bit unacceptable :(

PS:I guess some off-cpu analysis work will be down. I am trying to use bcc tools to do some analysis but have met some problems about the dotnet core symbols.",question,sergeybykov,,
5324,Performance issue how to read warnings from log,"Hello
how to get more details about warnings visible in log ?
I have faced performance issues but I can't find what is the reason.
I will appreciate your help.
Greetings

My logs:
>       Task [Id=8677620 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/7480126151777703339/87d1d5ab@S87d1d5ab] to
ok elapsed time 0:00:00.3293732 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8678501 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/1660678162373163416/72803998@S72803998] to
ok elapsed time 0:00:00.2571926 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8678514 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/16201652576789337278/b5d214be@Sb5d214be] t
ook elapsed time 0:00:00.2284598 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8678839 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/13243215104421926820/cf2817a4@Scf2817a4] t
ook elapsed time 0:00:00.487768 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8678990 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/2892194010405447811/03baa883@S03baa883] to
ok elapsed time 0:00:00.4912624 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8682400 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10139444246793834898/46065192@S46065192] t
ook elapsed time 0:00:00.2345563 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8683635 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/7480126151777703339/87d1d5ab@S87d1d5ab] to
ok elapsed time 0:00:00.3088771 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8684277 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3971411049396639124/d8591594@Sd8591594] to
ok elapsed time 0:00:00.2059425 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8684381 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3262124382583873155/ad0d5e83@Sad0d5e83] to
ok elapsed time 0:00:00.2554212 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8684605 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/12365399726059551649/417dfba1@S417dfba1] t
ook elapsed time 0:00:00.2144696 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8689909 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9962573138966299836/64ef44bc@S64ef44bc] to
ok elapsed time 0:00:00.2164671 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8692696 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11452622014448957596/260c789c@S260c789c] t
ook elapsed time 0:00:00.3986481 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8693449 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10939458234255134123/e7ffcdab@Se7ffcdab] t
ook elapsed time 0:00:00.356442 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8694469 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/8797984796704637060/12de0084@S12de0084] to
ok elapsed time 0:00:00.2079363 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8694695 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3002566311248937147/dc8c40bb@Sdc8c40bb] to
ok elapsed time 0:00:00.2369492 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8695501 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9974504408589424314/948a56ba@S948a56ba] to
ok elapsed time 0:00:00.8594778 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8697446 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/15212243947186492053/a4a31295@Sa4a31295] t
ook elapsed time 0:00:00.3273585 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8698355 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/17110226376080873662/34d1d8be@S34d1d8be] t
ook elapsed time 0:00:00.2694442 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8700250 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/13037136908939279520/e975bca0@Se975bca0] t
ook elapsed time 0:00:00.3555526 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8700861 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/14859631423479171972/c9b54b84@Sc9b54b84] t
ook elapsed time 0:00:00.3161251 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8702632 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/1981981633998696594/8dd73092@S8dd73092] to
ok elapsed time 0:00:00.2025749 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8702901 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3002566311248937147/dc8c40bb@Sdc8c40bb] to
ok elapsed time 0:00:00.2669245 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8706348 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3070772565396539313/ea79c7b1@Sea79c7b1] to
ok elapsed time 0:00:00.2264682 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8708324 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/13205469375169319353/5f4451b9@S5f4451b9] t
ook elapsed time 0:00:00.284403 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8708693 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3002566311248937147/dc8c40bb@Sdc8c40bb] to
ok elapsed time 0:00:00.2148307 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8710148 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/4474990208853291151/ac0d308f@Sac0d308f] to
ok elapsed time 0:00:00.5519002 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8715341 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/15952853474205714349/83e347ad@S83e347ad] t
ook elapsed time 0:00:00.5413761 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8715823 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/16365102821271470515/56a101b3@S56a101b3] t
ook elapsed time 0:00:00.2770024 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8716471 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/4474990208853291151/ac0d308f@Sac0d308f] to
ok elapsed time 0:00:00.2164933 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8717287 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3262124382583873155/ad0d5e83@Sad0d5e83] to
ok elapsed time 0:00:00.2459953 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8717470 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3971411049396639124/d8591594@Sd8591594] to
ok elapsed time 0:00:00.3994595 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8717819 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/13243215104421926820/cf2817a4@Scf2817a4] t
ook elapsed time 0:00:00.2591515 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8717860 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10939458234255134123/e7ffcdab@Se7ffcdab] t
ook elapsed time 0:00:00.2349099 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8719159 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/753007251491414656/0a706280@S0a706280] too
k elapsed time 0:00:00.2772202 for execution which is longer than 00:00:00.2000
000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8719938 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3070772565396539313/ea79c7b1@Sea79c7b1] to
ok elapsed time 0:00:00.3865724 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8720187 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11444598981775634862/4988b1ae@S4988b1ae] t
ook elapsed time 0:00:00.393994 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8721865 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9962573138966299836/64ef44bc@S64ef44bc] to
ok elapsed time 0:00:00.2093606 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8722921 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/1981981633998696594/8dd73092@S8dd73092] to
ok elapsed time 0:00:00.29118 for execution which is longer than 00:00:00.20000
00. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8723871 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/16201652576789337278/b5d214be@Sb5d214be] t
ook elapsed time 0:00:00.2281181 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8726620 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/812735807001527226/109103ba@S109103ba] too
k elapsed time 0:00:00.3368624 for execution which is longer than 00:00:00.2000
000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8727268 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/17110226376080873662/34d1d8be@S34d1d8be] t
ook elapsed time 0:00:00.2351561 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8727378 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10939458234255134123/e7ffcdab@Se7ffcdab] t
ook elapsed time 0:00:00.2045067 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8727801 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10177662558882251144/79f84188@S79f84188] t
ook elapsed time 0:00:00.3269352 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8729143 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/6346276726719776131/16760583@S16760583] to
ok elapsed time 0:00:00.2939532 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8729889 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9974504408589424314/948a56ba@S948a56ba] to
ok elapsed time 0:00:00.2711455 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8731870 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/15278920717608221610/0464fbaa@S0464fbaa] t
ook elapsed time 0:00:00.4368154 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8732476 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/17144885887817931434/a1fedaaa@Sa1fedaaa] t
ook elapsed time 0:00:00.387365 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8736383 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9139807053803530884/3591aa84@S3591aa84] to
ok elapsed time 0:00:00.4033186 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8736448 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/404602148764222349/b873838d@Sb873838d] too
k elapsed time 0:00:00.7389245 for execution which is longer than 00:00:00.2000
000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8736864 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11199281674166864300/a84209ac@Sa84209ac] t
ook elapsed time 0:00:00.2407328 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8737603 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/14428427995014467459/fe238f83@Sfe238f83] t
ook elapsed time 0:00:00.338192 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8738574 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/15212243947186492053/a4a31295@Sa4a31295] t
ook elapsed time 0:00:00.2200619 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8739156 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11867948782904102814/f9874f9e@Sf9874f9e] t
ook elapsed time 0:00:00.4196865 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8740236 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9962573138966299836/64ef44bc@S64ef44bc] to
ok elapsed time 0:00:00.3324778 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8741554 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/8188424151639157946/bcae6cba@Sbcae6cba] to
ok elapsed time 0:00:00.2116091 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8743123 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/1981981633998696594/8dd73092@S8dd73092] to
ok elapsed time 0:00:00.3394255 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8743381 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/14428427995014467459/fe238f83@Sfe238f83] t
ook elapsed time 0:00:00.2190081 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8746322 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11444598981775634862/4988b1ae@S4988b1ae] t
ook elapsed time 0:00:00.2179242 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8750120 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/18232931148661783190/0a23fa96@S0a23fa96] t
ook elapsed time 0:00:00.3155508 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8750132 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3002566311248937147/dc8c40bb@Sdc8c40bb] to
ok elapsed time 0:00:00.3163106 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread

> ","Performance issue, how to read warnings from log Hello
how to get more details about warnings visible in log ?
I have faced performance issues but I can't find what is the reason.
I will appreciate your help.
Greetings

My logs:
>       Task [Id=8677620 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/7480126151777703339/87d1d5ab@S87d1d5ab] to
ok elapsed time 0:00:00.3293732 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8678501 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/1660678162373163416/72803998@S72803998] to
ok elapsed time 0:00:00.2571926 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8678514 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/16201652576789337278/b5d214be@Sb5d214be] t
ook elapsed time 0:00:00.2284598 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8678839 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/13243215104421926820/cf2817a4@Scf2817a4] t
ook elapsed time 0:00:00.487768 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8678990 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/2892194010405447811/03baa883@S03baa883] to
ok elapsed time 0:00:00.4912624 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8682400 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10139444246793834898/46065192@S46065192] t
ook elapsed time 0:00:00.2345563 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8683635 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/7480126151777703339/87d1d5ab@S87d1d5ab] to
ok elapsed time 0:00:00.3088771 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8684277 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3971411049396639124/d8591594@Sd8591594] to
ok elapsed time 0:00:00.2059425 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8684381 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3262124382583873155/ad0d5e83@Sad0d5e83] to
ok elapsed time 0:00:00.2554212 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8684605 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/12365399726059551649/417dfba1@S417dfba1] t
ook elapsed time 0:00:00.2144696 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8689909 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9962573138966299836/64ef44bc@S64ef44bc] to
ok elapsed time 0:00:00.2164671 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8692696 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11452622014448957596/260c789c@S260c789c] t
ook elapsed time 0:00:00.3986481 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8693449 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10939458234255134123/e7ffcdab@Se7ffcdab] t
ook elapsed time 0:00:00.356442 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8694469 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/8797984796704637060/12de0084@S12de0084] to
ok elapsed time 0:00:00.2079363 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8694695 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3002566311248937147/dc8c40bb@Sdc8c40bb] to
ok elapsed time 0:00:00.2369492 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8695501 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9974504408589424314/948a56ba@S948a56ba] to
ok elapsed time 0:00:00.8594778 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8697446 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/15212243947186492053/a4a31295@Sa4a31295] t
ook elapsed time 0:00:00.3273585 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8698355 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/17110226376080873662/34d1d8be@S34d1d8be] t
ook elapsed time 0:00:00.2694442 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8700250 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/13037136908939279520/e975bca0@Se975bca0] t
ook elapsed time 0:00:00.3555526 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8700861 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/14859631423479171972/c9b54b84@Sc9b54b84] t
ook elapsed time 0:00:00.3161251 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8702632 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/1981981633998696594/8dd73092@S8dd73092] to
ok elapsed time 0:00:00.2025749 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8702901 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3002566311248937147/dc8c40bb@Sdc8c40bb] to
ok elapsed time 0:00:00.2669245 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8706348 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3070772565396539313/ea79c7b1@Sea79c7b1] to
ok elapsed time 0:00:00.2264682 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8708324 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/13205469375169319353/5f4451b9@S5f4451b9] t
ook elapsed time 0:00:00.284403 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8708693 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3002566311248937147/dc8c40bb@Sdc8c40bb] to
ok elapsed time 0:00:00.2148307 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8710148 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/4474990208853291151/ac0d308f@Sac0d308f] to
ok elapsed time 0:00:00.5519002 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8715341 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/15952853474205714349/83e347ad@S83e347ad] t
ook elapsed time 0:00:00.5413761 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8715823 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/16365102821271470515/56a101b3@S56a101b3] t
ook elapsed time 0:00:00.2770024 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8716471 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/4474990208853291151/ac0d308f@Sac0d308f] to
ok elapsed time 0:00:00.2164933 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8717287 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3262124382583873155/ad0d5e83@Sad0d5e83] to
ok elapsed time 0:00:00.2459953 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8717470 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3971411049396639124/d8591594@Sd8591594] to
ok elapsed time 0:00:00.3994595 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8717819 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/13243215104421926820/cf2817a4@Scf2817a4] t
ook elapsed time 0:00:00.2591515 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8717860 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10939458234255134123/e7ffcdab@Se7ffcdab] t
ook elapsed time 0:00:00.2349099 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8719159 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/753007251491414656/0a706280@S0a706280] too
k elapsed time 0:00:00.2772202 for execution which is longer than 00:00:00.2000
000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8719938 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3070772565396539313/ea79c7b1@Sea79c7b1] to
ok elapsed time 0:00:00.3865724 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8720187 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11444598981775634862/4988b1ae@S4988b1ae] t
ook elapsed time 0:00:00.393994 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8721865 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9962573138966299836/64ef44bc@S64ef44bc] to
ok elapsed time 0:00:00.2093606 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8722921 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/1981981633998696594/8dd73092@S8dd73092] to
ok elapsed time 0:00:00.29118 for execution which is longer than 00:00:00.20000
00. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8723871 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/16201652576789337278/b5d214be@Sb5d214be] t
ook elapsed time 0:00:00.2281181 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8726620 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/812735807001527226/109103ba@S109103ba] too
k elapsed time 0:00:00.3368624 for execution which is longer than 00:00:00.2000
000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8727268 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/17110226376080873662/34d1d8be@S34d1d8be] t
ook elapsed time 0:00:00.2351561 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8727378 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10939458234255134123/e7ffcdab@Se7ffcdab] t
ook elapsed time 0:00:00.2045067 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8727801 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/10177662558882251144/79f84188@S79f84188] t
ook elapsed time 0:00:00.3269352 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8729143 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/6346276726719776131/16760583@S16760583] to
ok elapsed time 0:00:00.2939532 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8729889 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9974504408589424314/948a56ba@S948a56ba] to
ok elapsed time 0:00:00.2711455 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8731870 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/15278920717608221610/0464fbaa@S0464fbaa] t
ook elapsed time 0:00:00.4368154 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8732476 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/17144885887817931434/a1fedaaa@Sa1fedaaa] t
ook elapsed time 0:00:00.387365 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8736383 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9139807053803530884/3591aa84@S3591aa84] to
ok elapsed time 0:00:00.4033186 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8736448 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/404602148764222349/b873838d@Sb873838d] too
k elapsed time 0:00:00.7389245 for execution which is longer than 00:00:00.2000
000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8736864 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11199281674166864300/a84209ac@Sa84209ac] t
ook elapsed time 0:00:00.2407328 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8737603 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/14428427995014467459/fe238f83@Sfe238f83] t
ook elapsed time 0:00:00.338192 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8738574 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/15212243947186492053/a4a31295@Sa4a31295] t
ook elapsed time 0:00:00.2200619 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8739156 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11867948782904102814/f9874f9e@Sf9874f9e] t
ook elapsed time 0:00:00.4196865 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8740236 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/9962573138966299836/64ef44bc@S64ef44bc] to
ok elapsed time 0:00:00.3324778 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8741554 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/8188424151639157946/bcae6cba@Sbcae6cba] to
ok elapsed time 0:00:00.2116091 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8743123 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/1981981633998696594/8dd73092@S8dd73092] to
ok elapsed time 0:00:00.3394255 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8743381 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/14428427995014467459/fe238f83@Sfe238f83] t
ook elapsed time 0:00:00.2190081 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8746322 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/11444598981775634862/4988b1ae@S4988b1ae] t
ook elapsed time 0:00:00.2179242 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8750120 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/18232931148661783190/0a23fa96@S0a23fa96] t
ook elapsed time 0:00:00.3155508 for execution which is longer than 00:00:00.20
00000. Running on thread System.Threading.Thread
warn: Orleans.Runtime.Scheduler.WorkItemGroup[101215]
      Task [Id=8750132 Status=RanToCompletion] in WorkGroup [LowPrioritySystemT
arget: S127.0.0.1:11111:285768451*stg/3002566311248937147/dc8c40bb@Sdc8c40bb] to
ok elapsed time 0:00:00.3163106 for execution which is longer than 00:00:00.200
0000. Running on thread System.Threading.Thread

> ",question,sergeybykov,,
5321,Message / Request Priority,"Hi we are using Orleans as back-end in our IoT project briefly it relies on ConnectionPoint's and Devices. Devices are connected to CP's. Each CP support only one connection in the same time so it's very suitable for CP's to work within single-threaded nature of grains. There are various reminders on CP for each Devices like read device setup read device data heartbeat health-check and some other domain specific operations. CPGrain is not re-entrant and we are using asynchronous socket for communication.

My question is; there is being multiple request by reminders on the CPGrain's mailboxes naturally but we also have some instant request that must be run instantly so expected behavior would be like that even if there are 20 messages in the mailbox cancel current process first (we can handle it with grain cancellation token) and **process instant request before other requests in the mailbox (that is I am asking for) is there a way to do that with Orleans**

Currently we are using priority queue in CPGrain to schedule and prioritize messages/requests but we have to check queue with timer to process. So we are loosing natural flow of Orleans by this custom solution besides lower time interval for that timer would result with high CPU consumption contrary higher time interval would result higher latency. Do you have any suggestion?","Message / Request Priority Hi we are using Orleans as back-end in our IoT project briefly it relies on ConnectionPoint's and Devices. Devices are connected to CP's. Each CP support only one connection in the same time so it's very suitable for CP's to work within single-threaded nature of grains. There are various reminders on CP for each Devices like read device setup read device data heartbeat health-check and some other domain specific operations. CPGrain is not re-entrant and we are using asynchronous socket for communication.

My question is; there is being multiple request by reminders on the CPGrain's mailboxes naturally but we also have some instant request that must be run instantly so expected behavior would be like that even if there are 20 messages in the mailbox cancel current process first (we can handle it with grain cancellation token) and **process instant request before other requests in the mailbox (that is I am asking for) is there a way to do that with Orleans**

Currently we are using priority queue in CPGrain to schedule and prioritize messages/requests but we have to check queue with timer to process. So we are loosing natural flow of Orleans by this custom solution besides lower time interval for that timer would result with high CPU consumption contrary higher time interval would result higher latency. Do you have any suggestion?",question,sergeybykov,,
5320,Some questions about placements / discovery / grain types,"Hello there

We are about to run a silo with multiple grain types let's say IA IB IC ... 10 to 15 of them.

They are really distinct domains but we'd like to embed all this little world in the same cluster
- to avoid having to configure multiple IClusterClient and manage them
- and to have aggregated silos statistics all in one on the dashboard.

Those grain are hosted in distinct applications runned in a K8s cluster let's say 3 to 10 replica for each grain type (this way we have the ability to scale each part of the system independendly).

I was a little surprise to see that if I entirely drop a service let's say IZ (it's representing a good 1/3 part of the all system so it's 1/3 silos that are down on the same time) all the clients of the system who are actually never calling Z grains are starting to raise exceptions (mostly TimeOut). Until the cluster is stable again.

My guess is that in fact all silos are responsible for the placement/discovery of any grain of the cluster so the loss of any silo will impact randomly any client in the system depending on the partitions responsiblity ...

Would you say it's an expected behavior ? something that I could avoid somehow ? Is there something I could have greatly missunderstood ?
","Some questions about placements / discovery / grain types Hello there

We are about to run a silo with multiple grain types let's say IA IB IC ... 10 to 15 of them.

They are really distinct domains but we'd like to embed all this little world in the same cluster
- to avoid having to configure multiple IClusterClient and manage them
- and to have aggregated silos statistics all in one on the dashboard.

Those grain are hosted in distinct applications runned in a K8s cluster let's say 3 to 10 replica for each grain type (this way we have the ability to scale each part of the system independendly).

I was a little surprise to see that if I entirely drop a service let's say IZ (it's representing a good 1/3 part of the all system so it's 1/3 silos that are down on the same time) all the clients of the system who are actually never calling Z grains are starting to raise exceptions (mostly TimeOut). Until the cluster is stable again.

My guess is that in fact all silos are responsible for the placement/discovery of any grain of the cluster so the loss of any silo will impact randomly any client in the system depending on the partitions responsiblity ...

Would you say it's an expected behavior ? something that I could avoid somehow ? Is there something I could have greatly missunderstood ?
",question,sergeybykov,18/01/2019 23:18,25/01/2019 20:16
5319,Fix defensive check in LogConsistentGrain,"Found this low hanging fruit around the Orleans.Core project.

The original intent of this code is to have two possible error messages:

1.   is not null and throws an exception if so.
 
","Fix defensive check in LogConsistentGrain Found this low hanging fruit around the Orleans.Core project.

The original intent of this code is to have two possible error messages:

1.   is not null and throws an exception if so.
 
",,sergeybykov,,
5317,Orleans client takes a long time to close(),Hi I designed a web API endpoint to take in work and distribute that work to various grains. During the API call I have it instantiating a new client to connect to the cluster and then close at the end when it's finished. However it's causing significant lag where the client could take upwards to 30 seconds to close. Do you guys have a recommended way to manage orleans client or simply make the API call not wait for the client to close() before responding back to the consumer? Thanks.,Orleans client takes a long time to close() Hi I designed a web API endpoint to take in work and distribute that work to various grains. During the API call I have it instantiating a new client to connect to the cluster and then close at the end when it's finished. However it's causing significant lag where the client could take upwards to 30 seconds to close. Do you guys have a recommended way to manage orleans client or simply make the API call not wait for the client to close() before responding back to the consumer? Thanks.,,ReubenBond,,
5316,Is storing state data inside of a grain redundant?,"Hi guys.
I'm wondering if it makes any sense to store State data inside a grain.
I'm adding State to a 

Thanks in advance for your answers!","Is storing state data inside of a grain redundant? Hi guys.
I'm wondering if it makes any sense to store State data inside a grain.
I'm adding State to a 

Thanks in advance for your answers!",question,sergeybykov,16/01/2019 21:33,17/01/2019 19:27
5315,Need design advice regarding version selection strategy canary testing grains,"Hi there im working on an IOT project for a production facility and would like to use orleans

One requirement is that I need to be able to roll out updates for only one / some of the devices.

At first I thought I simply create one grain for each device. But im not sure if this will work.

I read the docs but for me it is not clear if / how I can achive what I want. http://dotnet.github.io/orleans/Documentation/deployment/grain_versioning/version_selector_strategy.html

Lets say I have device A and B both running Grain Version 1. And I want to deploy a new version only for Device A.

From what I understand the version is only chosen for new activations. So if an activation exists with V1 it will not be created in V2.

I think I can overcome this with a programmatic deactivation after deploying the update to one of the cluster nodes and then activating the grain again.

The other issue is that I need some custom version selection strategy so the cluster knows that it should create A as V2 and B as V1. 

Is this possible at all?

One thing I found is IPlacementDirector would that be the correct place to implement the desired behavior?
 ","Need design advice regarding version selection strategy canary testing grains Hi there im working on an IOT project for a production facility and would like to use orleans

One requirement is that I need to be able to roll out updates for only one / some of the devices.

At first I thought I simply create one grain for each device. But im not sure if this will work.

I read the docs but for me it is not clear if / how I can achive what I want. http://dotnet.github.io/orleans/Documentation/deployment/grain_versioning/version_selector_strategy.html

Lets say I have device A and B both running Grain Version 1. And I want to deploy a new version only for Device A.

From what I understand the version is only chosen for new activations. So if an activation exists with V1 it will not be created in V2.

I think I can overcome this with a programmatic deactivation after deploying the update to one of the cluster nodes and then activating the grain again.

The other issue is that I need some custom version selection strategy so the cluster knows that it should create A as V2 and B as V1. 

Is this possible at all?

One thing I found is IPlacementDirector would that be the correct place to implement the desired behavior?
 ",question,sergeybykov,,
5314,Cherry-picked commits for 2.2.3,,Cherry-picked commits for 2.2.3 ,,ReubenBond,,
5313,Enable EventHub streaming tests,"Enable EventHub streaming tests 
- will be skipped on check in 
- will be in run in vso

vso event hub connection string  updated to the new one. ","Enable EventHub streaming tests Enable EventHub streaming tests 
- will be skipped on check in 
- will be in run in vso

vso event hub connection string  updated to the new one. ",,jason-bragg,,
5311,Samples/2.1/ServiceFabric/Stateless/StatelessCalculatorApp fails to deploy,"I'm having trouble getting the sample ""Samples/2.1/ServiceFabric/Stateless/StatelessCalculatorApp"" to deploy. I'm using Visual Studio 2017 Community and Windows 10 Pro; OS IDE and Service Fabric tools are all up to date.

I'm able to run a home rolled Service Fabric application/service but just to be sure I reset my cluster and rebooted.

No doubt I'm doing something wrong - any idea what?

Build log:

1>------ Build started: Project: StatelessCalculatorApp Configuration: Debug x64 ------
2>------ Deploy started: Project: StatelessCalculatorApp Configuration: Debug x64 ------
2>Started executing script 'GetApplicationExistence'.
2>Finished executing script 'GetApplicationExistence'.
2>Time elapsed: 00:00:11.1557189
2>Started executing script 'Set-LocalClusterReady'.
2>powershell -NonInteractive -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command ""Import-Module 'C:\Program Files\Microsoft SDKs\Service Fabric\Tools\Scripts\DefaultLocalClusterSetup.psm1'; Set-LocalClusterReady -createOneNodeCluster $true""
2>--------------------------------------------
2>Local Service Fabric Cluster is not running...
2>Please wait while we start the Local Service Fabric Cluster. This may take few minutes...
2>Performing Start-Service on: FabricHostSvc . This may take a few minutes...
2>
2>Waiting for Service Fabric Cluster to be ready. This may take a few minutes...
2>Local Cluster ready status: 4% completed.
2>Local Cluster ready status: 100% completed.
2>
2>Waiting for fabric:/System/NamingService to be ready. This may take a few minutes...
2>fabric:/System/NamingService is ready now...
2>
2>Deploying Addon Service:AzureFilesVolumePlugin in the cluster...
2>
2>
2>    Directory: C:\Users\Steve\AppData\Local\Temp
2>
2>
2>Mode                LastWriteTime         Length Name                                                                  
2>----                -------------         ------ ----                                                                  
2>d-----       11/01/2019     15:30                AzureFilesVolumePlugin                                                
2>Using ImageStoreConnectionString='file:C:\SfDevCluster\Data\ImageStoreShare'
2>Upload to Image Store succeeded
2>Register application type succeeded
2>
2>ApplicationParameters  : {ListenPort InstanceCount}
2>ApplicationName        : fabric:/AzureFilesVolumePlugin
2>ApplicationTypeName    : AzureFilesVolumePluginType
2>ApplicationTypeVersion : 6.4.622.9590
2>MaximumNodes           : 0
2>MinimumNodes           : 0
2>Metrics                : {}
2>
2>
2>Waiting for fabric:/AzureFilesVolumePlugin/Service to be ready. This may take a few minutes...
2>fabric:/AzureFilesVolumePlugin/Service ready status: 8% completed.
2>fabric:/AzureFilesVolumePlugin/Service is ready now...
2>
2>Deploying Addon Service:ServiceFabricVolumeDriver in the cluster...
2>d-----       11/01/2019     15:31                ServiceFabricVolumeDriver                                             
2>Using ImageStoreConnectionString='file:C:\SfDevCluster\Data\ImageStoreShare'
2>Upload to Image Store succeeded
2>Register application type succeeded
2>
2>ApplicationParameters  : {ListenPort InstanceCount}
2>ApplicationName        : fabric:/ServiceFabricVolumeDriver
2>ApplicationTypeName    : ServiceFabricVolumeDriverType
2>ApplicationTypeVersion : 6.4.622.9590
2>MaximumNodes           : 0
2>MinimumNodes           : 0
2>Metrics                : {}
2>
2>
2>Waiting for fabric:/ServiceFabricVolumeDriver/Service to be ready. This may take a few minutes...
2>fabric:/ServiceFabricVolumeDriver/Service ready status: 8% completed.
2>fabric:/ServiceFabricVolumeDriver/Service is ready now...
2>
2>Local Service Fabric Cluster is running now.
2>----------------------------------------
2>Launching Service Fabric Local Cluster Manager...
2>You can use Service Fabric Local Cluster Manager (system tray application) to manage your local dev cluster.
2>
2>
2>Finished executing script 'Set-LocalClusterReady'.
2>Time elapsed: 00:02:30.9555172
2>Started executing script 'GetApplicationExistence'.
2>Finished executing script 'GetApplicationExistence'.
2>Time elapsed: 00:00:01.2374216
2>Started executing script 'GetApplicationExistence'.
-------- Package started: Project: StatelessCalculatorApp Configuration: Debug x64 ------
2>Finished executing script 'GetApplicationExistence'.
2>Time elapsed: 00:00:01.0377925
StatelessCalculatorService -> E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorService\bin\Debug\netcoreapp2.1\StatelessCalculatorService.dll
StatelessCalculatorService -> E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\pkg\Debug\StatelessCalculatorServicePkg\Code\
StatelessCalculatorApp -> E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\pkg\Debug
-------- Package: Project: StatelessCalculatorApp succeeded Time elapsed: 00:00:09.4987049 --------
2>Started executing script 'Deploy-FabricApplication.ps1'.
2>powershell -NonInteractive -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "". 'E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\Scripts\Deploy-FabricApplication.ps1' -ApplicationPackagePath 'E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\pkg\Debug' -PublishProfileFile 'E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\PublishProfiles\Local.1Node.xml' -DeployOnly:$true -ApplicationParameter:@{_WFDebugParams_='[{""""""CodePackageName"""""":""""""Code""""""""""""CodePackageLinkFolder"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService\\bin\\Debug\\netcoreapp2.1""""""""""""ConfigPackageName"""""":""""""Config""""""""""""ConfigPackageLinkFolder"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService\\PackageRoot\\Config""""""""""""DataPackageName"""""":null""""""DataPackageLinkFolder"""""":null""""""LockFile"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService\\bin\\Debug\\netcoreapp2.1\\_VS_ServiceFabric_lock.txt""""""""""""WorkingFolder"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService""""""""""""ServiceManifestName"""""":""""""StatelessCalculatorServicePkg""""""""""""EntryPointType"""""":""""""Main""""""""""""DebugExePath"""""":null""""""DebugArguments"""""":null""""""DebugParametersFile"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService\\bin\\Debug\\netcoreapp2.1\\_VS_ServiceFabric_debug.txt""""""}]'} -UnregisterUnusedApplicationVersionsAfterUpgrade $false -OverrideUpgradeBehavior 'None' -OverwriteBehavior 'Always' -SkipPackageValidation:$true -ErrorAction Stop""
2>Copying application to image store...
2>Upload to Image Store succeeded
2>Registering application type...
2>Register application type started. Use Get-ServiceFabricApplicationType to query for status.
2>Running Image Builder process ...
2>Downloading application package from 'StatelessCalculatorApp' ...
2>FABRIC_E_IMAGEBUILDER_VALIDATION_ERROR: The EntryPoint StatelessCalculatorService.exe is not found.
2>FileName: C:\SfDevCluster\Data\ImageBuilderProxy\AppType\a02b2e7b-2148-45e5-a503-34d7abc9c1f0\StatelessCalculatorServicePkg\ServiceManifest.xml
2>Registration of application type failed.
2>At C:\Program Files\Microsoft SDKs\Service 
2>Fabric\Tools\PSModule\ServiceFabricSDK\Publish-NewServiceFabricApplication.ps1:308 char:17
2>+                 throw ""Registration of application type failed.""
2>+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2>    + CategoryInfo          : OperationStopped: (Registration of application type failed.:String) [] RuntimeException
2>    + FullyQualifiedErrorId : Registration of application type failed.
2> 
2>Finished executing script 'Deploy-FabricApplication.ps1'.
2>Time elapsed: 00:00:08.9462862
2>The PowerShell script failed to execute.
========== Build: 1 succeeded 0 failed 3 up-to-date 0 skipped ==========
========== Deploy: 0 succeeded 1 failed 0 skipped ==========
","Samples/2.1/ServiceFabric/Stateless/StatelessCalculatorApp fails to deploy I'm having trouble getting the sample ""Samples/2.1/ServiceFabric/Stateless/StatelessCalculatorApp"" to deploy. I'm using Visual Studio 2017 Community and Windows 10 Pro; OS IDE and Service Fabric tools are all up to date.

I'm able to run a home rolled Service Fabric application/service but just to be sure I reset my cluster and rebooted.

No doubt I'm doing something wrong - any idea what?

Build log:

1>------ Build started: Project: StatelessCalculatorApp Configuration: Debug x64 ------
2>------ Deploy started: Project: StatelessCalculatorApp Configuration: Debug x64 ------
2>Started executing script 'GetApplicationExistence'.
2>Finished executing script 'GetApplicationExistence'.
2>Time elapsed: 00:00:11.1557189
2>Started executing script 'Set-LocalClusterReady'.
2>powershell -NonInteractive -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command ""Import-Module 'C:\Program Files\Microsoft SDKs\Service Fabric\Tools\Scripts\DefaultLocalClusterSetup.psm1'; Set-LocalClusterReady -createOneNodeCluster $true""
2>--------------------------------------------
2>Local Service Fabric Cluster is not running...
2>Please wait while we start the Local Service Fabric Cluster. This may take few minutes...
2>Performing Start-Service on: FabricHostSvc . This may take a few minutes...
2>
2>Waiting for Service Fabric Cluster to be ready. This may take a few minutes...
2>Local Cluster ready status: 4% completed.
2>Local Cluster ready status: 100% completed.
2>
2>Waiting for fabric:/System/NamingService to be ready. This may take a few minutes...
2>fabric:/System/NamingService is ready now...
2>
2>Deploying Addon Service:AzureFilesVolumePlugin in the cluster...
2>
2>
2>    Directory: C:\Users\Steve\AppData\Local\Temp
2>
2>
2>Mode                LastWriteTime         Length Name                                                                  
2>----                -------------         ------ ----                                                                  
2>d-----       11/01/2019     15:30                AzureFilesVolumePlugin                                                
2>Using ImageStoreConnectionString='file:C:\SfDevCluster\Data\ImageStoreShare'
2>Upload to Image Store succeeded
2>Register application type succeeded
2>
2>ApplicationParameters  : {ListenPort InstanceCount}
2>ApplicationName        : fabric:/AzureFilesVolumePlugin
2>ApplicationTypeName    : AzureFilesVolumePluginType
2>ApplicationTypeVersion : 6.4.622.9590
2>MaximumNodes           : 0
2>MinimumNodes           : 0
2>Metrics                : {}
2>
2>
2>Waiting for fabric:/AzureFilesVolumePlugin/Service to be ready. This may take a few minutes...
2>fabric:/AzureFilesVolumePlugin/Service ready status: 8% completed.
2>fabric:/AzureFilesVolumePlugin/Service is ready now...
2>
2>Deploying Addon Service:ServiceFabricVolumeDriver in the cluster...
2>d-----       11/01/2019     15:31                ServiceFabricVolumeDriver                                             
2>Using ImageStoreConnectionString='file:C:\SfDevCluster\Data\ImageStoreShare'
2>Upload to Image Store succeeded
2>Register application type succeeded
2>
2>ApplicationParameters  : {ListenPort InstanceCount}
2>ApplicationName        : fabric:/ServiceFabricVolumeDriver
2>ApplicationTypeName    : ServiceFabricVolumeDriverType
2>ApplicationTypeVersion : 6.4.622.9590
2>MaximumNodes           : 0
2>MinimumNodes           : 0
2>Metrics                : {}
2>
2>
2>Waiting for fabric:/ServiceFabricVolumeDriver/Service to be ready. This may take a few minutes...
2>fabric:/ServiceFabricVolumeDriver/Service ready status: 8% completed.
2>fabric:/ServiceFabricVolumeDriver/Service is ready now...
2>
2>Local Service Fabric Cluster is running now.
2>----------------------------------------
2>Launching Service Fabric Local Cluster Manager...
2>You can use Service Fabric Local Cluster Manager (system tray application) to manage your local dev cluster.
2>
2>
2>Finished executing script 'Set-LocalClusterReady'.
2>Time elapsed: 00:02:30.9555172
2>Started executing script 'GetApplicationExistence'.
2>Finished executing script 'GetApplicationExistence'.
2>Time elapsed: 00:00:01.2374216
2>Started executing script 'GetApplicationExistence'.
-------- Package started: Project: StatelessCalculatorApp Configuration: Debug x64 ------
2>Finished executing script 'GetApplicationExistence'.
2>Time elapsed: 00:00:01.0377925
StatelessCalculatorService -> E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorService\bin\Debug\netcoreapp2.1\StatelessCalculatorService.dll
StatelessCalculatorService -> E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\pkg\Debug\StatelessCalculatorServicePkg\Code\
StatelessCalculatorApp -> E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\pkg\Debug
-------- Package: Project: StatelessCalculatorApp succeeded Time elapsed: 00:00:09.4987049 --------
2>Started executing script 'Deploy-FabricApplication.ps1'.
2>powershell -NonInteractive -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -Command "". 'E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\Scripts\Deploy-FabricApplication.ps1' -ApplicationPackagePath 'E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\pkg\Debug' -PublishProfileFile 'E:\Reference source\Orleans\Samples\2.1\ServiceFabric\Stateless\StatelessCalculatorApp\PublishProfiles\Local.1Node.xml' -DeployOnly:$true -ApplicationParameter:@{_WFDebugParams_='[{""""""CodePackageName"""""":""""""Code""""""""""""CodePackageLinkFolder"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService\\bin\\Debug\\netcoreapp2.1""""""""""""ConfigPackageName"""""":""""""Config""""""""""""ConfigPackageLinkFolder"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService\\PackageRoot\\Config""""""""""""DataPackageName"""""":null""""""DataPackageLinkFolder"""""":null""""""LockFile"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService\\bin\\Debug\\netcoreapp2.1\\_VS_ServiceFabric_lock.txt""""""""""""WorkingFolder"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService""""""""""""ServiceManifestName"""""":""""""StatelessCalculatorServicePkg""""""""""""EntryPointType"""""":""""""Main""""""""""""DebugExePath"""""":null""""""DebugArguments"""""":null""""""DebugParametersFile"""""":""""""E:\\Reference source\\Orleans\\Samples\\2.1\\ServiceFabric\\Stateless\\StatelessCalculatorService\\bin\\Debug\\netcoreapp2.1\\_VS_ServiceFabric_debug.txt""""""}]'} -UnregisterUnusedApplicationVersionsAfterUpgrade $false -OverrideUpgradeBehavior 'None' -OverwriteBehavior 'Always' -SkipPackageValidation:$true -ErrorAction Stop""
2>Copying application to image store...
2>Upload to Image Store succeeded
2>Registering application type...
2>Register application type started. Use Get-ServiceFabricApplicationType to query for status.
2>Running Image Builder process ...
2>Downloading application package from 'StatelessCalculatorApp' ...
2>FABRIC_E_IMAGEBUILDER_VALIDATION_ERROR: The EntryPoint StatelessCalculatorService.exe is not found.
2>FileName: C:\SfDevCluster\Data\ImageBuilderProxy\AppType\a02b2e7b-2148-45e5-a503-34d7abc9c1f0\StatelessCalculatorServicePkg\ServiceManifest.xml
2>Registration of application type failed.
2>At C:\Program Files\Microsoft SDKs\Service 
2>Fabric\Tools\PSModule\ServiceFabricSDK\Publish-NewServiceFabricApplication.ps1:308 char:17
2>+                 throw ""Registration of application type failed.""
2>+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
2>    + CategoryInfo          : OperationStopped: (Registration of application type failed.:String) [] RuntimeException
2>    + FullyQualifiedErrorId : Registration of application type failed.
2> 
2>Finished executing script 'Deploy-FabricApplication.ps1'.
2>Time elapsed: 00:00:08.9462862
2>The PowerShell script failed to execute.
========== Build: 1 succeeded 0 failed 3 up-to-date 0 skipped ==========
========== Deploy: 0 succeeded 1 failed 0 skipped ==========
",,ReubenBond,,
5310,Cannot resume stream after silo restart,"In my application I use a SMS provider and I have some issues when the silo restarts
The architecture is basically that:
- The system has a single silo and 2 clients.
- I use a single stream with only 1 grain that publish events
- The 2 clients subscribe directly to the stream.

The problem is when the silo restarts I cannot resume the event subscription
- Sometimes after the restart the stream continues working but this is not frequent
- Calling  doesn't change anything. Is it on purpose? Am I missing something?

I made a simplified repro project that isolate and illustrate the issue: https://github.com/srollinet/OrleansStreamIssue

In the real application I use Ado storage and clustering and I call ResumeAsync only when I detect a connection lost. By the way it seems that the ClusterConnectionLostHandler is not systematically called when the silo crashes.

Bonus question: Is there a better / more robust solution to handle this use case? I have seen some examples with observers but I don't know what is the preferred way in this case.","Cannot resume stream after silo restart In my application I use a SMS provider and I have some issues when the silo restarts
The architecture is basically that:
- The system has a single silo and 2 clients.
- I use a single stream with only 1 grain that publish events
- The 2 clients subscribe directly to the stream.

The problem is when the silo restarts I cannot resume the event subscription
- Sometimes after the restart the stream continues working but this is not frequent
- Calling  doesn't change anything. Is it on purpose? Am I missing something?

I made a simplified repro project that isolate and illustrate the issue: https://github.com/srollinet/OrleansStreamIssue

In the real application I use Ado storage and clustering and I call ResumeAsync only when I detect a connection lost. By the way it seems that the ClusterConnectionLostHandler is not systematically called when the silo crashes.

Bonus question: Is there a better / more robust solution to handle this use case? I have seen some examples with observers but I don't know what is the preferred way in this case.",,jason-bragg,,
5309,ASP.NET Core Identity store implementation,"What do you think about ASP.NET Core Identity and Orleans should it be implemented on Front-end project or in Orleans Grains I mean store Users roles tenants and so on? In case if it is decoupled from Orleans Grains how can I reference Orders(Grain) Entity to Users and Tenants from Identity store? Or it would be better to have something like this Microsoft.AspNetCore.Identity.EntityframeworkCore but
Microsoft.AspNetCore.Identity.OrleansStore?","ASP.NET Core Identity store implementation What do you think about ASP.NET Core Identity and Orleans should it be implemented on Front-end project or in Orleans Grains I mean store Users roles tenants and so on? In case if it is decoupled from Orleans Grains how can I reference Orders(Grain) Entity to Users and Tenants from Identity store? Or it would be better to have something like this Microsoft.AspNetCore.Identity.EntityframeworkCore but
Microsoft.AspNetCore.Identity.OrleansStore?",question,ReubenBond,,
5308,Support customizable Actor type name,"Hi guys
I have multi tenant system and I would like to see all my Actor types in the same cluster for comfort and convenience.
A multi-tenant system means that the same actor type is deployed with different configuration because he will use different persistence queues etc related to his tenant and the health check will be done based on this tenant configuration.
This solution allows me to isolate the traffic/activity by tenant and to scale a tenant independently to the other on the same K8 cluster.

The registration of the actor is based on the silo/actor type.
For example based on this kind of registration I cannot make the distinction because actor type   HelloWorldType deployed on the tenant A and B on same K8 cluster.

In your book you said ""(Orleans is not currently intended for a multi-tenant environment)"": https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/Orleans-MSR-TR-2014-41.pdf
But @jkonecki succeed to use Orleans on his multi-tenant system: http://gigi.nullneuron.net/gigilabs/microsoft-orleans-use-case-reservations-system/

On ProtoActor we had the Actor kind concept and it's not related to the Actor Class Name it could be anything which is great!...

Source: https://github.com/AsynkronIT/protoactor-dotnet/blob/74d71f0c9eb14925da59ade42cbec4f2e4a2252f/src/Proto.Remote/Remote.cs

Example: https://github.com/AsynkronIT/protoactor-dotnet/blob/74d71f0c9eb14925da59ade42cbec4f2e4a2252f/examples/ClusterHelloWorld/Node2/Program.cs

But now that we moved to Orleans we cannot compute the actor type name...

We think that the solution could be to prefix the actor type name with the tenant name for example: 
- Tenant_A_ActorType_HelloWorldType
- Tenant_B_ActorType_HelloWorldType

It could be great if we can customize the actor type name.

We found the VersionAttribute it's not the same but it's something...
But I would prefer to have a more flexible way to indicate the tenant.

What do you think?
","Support customizable Actor type name Hi guys
I have multi tenant system and I would like to see all my Actor types in the same cluster for comfort and convenience.
A multi-tenant system means that the same actor type is deployed with different configuration because he will use different persistence queues etc related to his tenant and the health check will be done based on this tenant configuration.
This solution allows me to isolate the traffic/activity by tenant and to scale a tenant independently to the other on the same K8 cluster.

The registration of the actor is based on the silo/actor type.
For example based on this kind of registration I cannot make the distinction because actor type   HelloWorldType deployed on the tenant A and B on same K8 cluster.

In your book you said ""(Orleans is not currently intended for a multi-tenant environment)"": https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/Orleans-MSR-TR-2014-41.pdf
But @jkonecki succeed to use Orleans on his multi-tenant system: http://gigi.nullneuron.net/gigilabs/microsoft-orleans-use-case-reservations-system/

On ProtoActor we had the Actor kind concept and it's not related to the Actor Class Name it could be anything which is great!...

Source: https://github.com/AsynkronIT/protoactor-dotnet/blob/74d71f0c9eb14925da59ade42cbec4f2e4a2252f/src/Proto.Remote/Remote.cs

Example: https://github.com/AsynkronIT/protoactor-dotnet/blob/74d71f0c9eb14925da59ade42cbec4f2e4a2252f/examples/ClusterHelloWorld/Node2/Program.cs

But now that we moved to Orleans we cannot compute the actor type name...

We think that the solution could be to prefix the actor type name with the tenant name for example: 
- Tenant_A_ActorType_HelloWorldType
- Tenant_B_ActorType_HelloWorldType

It could be great if we can customize the actor type name.

We found the VersionAttribute it's not the same but it's something...
But I would prefer to have a more flexible way to indicate the tenant.

What do you think?
",question,sergeybykov,,
5307,Fix package dependency condition for Microsoft.Orleans.Transactions,,Fix package dependency condition for Microsoft.Orleans.Transactions ,,ReubenBond,,
5304,Improve steps for getting started in readme,"Lifting this feedback from #5133.
>Sidenote: even on the Windows machine doing a clean checkout would not work properly as a lot of tests kept failing randomly not sure if there was something wrong with the setup. Would still be nice to have some FAQ on how to setup the project as a new contributor as the steps in the README did not work out of the box and there was a bunch of stuff I had to do to even run a single test.","Improve steps for getting started in readme Lifting this feedback from #5133.
>Sidenote: even on the Windows machine doing a clean checkout would not work properly as a lot of tests kept failing randomly not sure if there was something wrong with the setup. Would still be nice to have some FAQ on how to setup the project as a new contributor as the steps in the README did not work out of the box and there was a bunch of stuff I had to do to even run a single test.",documentation,sergeybykov,10/01/2019 9:57,
5303,Silos cannot ping another silo successfully,"I use dotnet core Orleans 2.2.0 (with zookeeper docker containers as the membership provider) there are 3 silos (A B C) in docker containers hosted in 3 azure vms under same azure vnet (and subnet).
I can always find response timeout error even there is no much request load and when it occurs there will be also silo ping timeout. 
More strange thing is even after load decreased to 0 (No any grain method is called) the 2 silos still keep timeout for pinging each other.
The consistent situation is siloA and siloB cannot ping each other but siloC can ping to both A and B in same time when issue occurs. When I restarted siloA container siloA and SiloB turn to ping each other successfully. I also checked netstat seems connection are all right and no send-q recv-q blocked between A and B.
I cannot find clue for now any one can help? Thanks.

Silo Log sample:
Category:Orleans.Runtime.MembershipService.MembershipOracleData|-Did not get ping response for ping #1301 from S10.42.183.42:11111:284542315. Reason = Original Exc Type: System.TimeoutException Message:Response did not arrive on time in 00:02:00 for message: Request S10.42.132.31:11111:284542291*stg/15/0000000f@S0000000f->S10.42.183.42:11111:284542315*stg/15/0000000f@S0000000f #18368: . Target History is: <S10.42.183.42:11111:284542315:*stg/15/0000000f:@S0000000f>.","Silos cannot ping another silo successfully I use dotnet core Orleans 2.2.0 (with zookeeper docker containers as the membership provider) there are 3 silos (A B C) in docker containers hosted in 3 azure vms under same azure vnet (and subnet).
I can always find response timeout error even there is no much request load and when it occurs there will be also silo ping timeout. 
More strange thing is even after load decreased to 0 (No any grain method is called) the 2 silos still keep timeout for pinging each other.
The consistent situation is siloA and siloB cannot ping each other but siloC can ping to both A and B in same time when issue occurs. When I restarted siloA container siloA and SiloB turn to ping each other successfully. I also checked netstat seems connection are all right and no send-q recv-q blocked between A and B.
I cannot find clue for now any one can help? Thanks.

Silo Log sample:
Category:Orleans.Runtime.MembershipService.MembershipOracleData|-Did not get ping response for ping #1301 from S10.42.183.42:11111:284542315. Reason = Original Exc Type: System.TimeoutException Message:Response did not arrive on time in 00:02:00 for message: Request S10.42.132.31:11111:284542291*stg/15/0000000f@S0000000f->S10.42.183.42:11111:284542315*stg/15/0000000f@S0000000f #18368: . Target History is: <S10.42.183.42:11111:284542315:*stg/15/0000000f:@S0000000f>.",,sergeybykov,,
5301,EventHub Streams - one grain starving another,"Hi. I have overrided EventHubDataAdapter to reads external EventHub messages.
I have two grains which are implicit subscribed to this StreamProvider.
One grain have a lot easier work and periodically make writes to Blob storage. Call it: TelemetryCapture
Second do a bit more processing - de-serialize message check some fields values and then write alert to MongoDB. Call it: TelemetryProcessor
I observed that TelemetryCapture process messages around 40k / s while TelemetryProcessor around 1k / s.
I did this testing one single silo cluster.
Machine is around 85% of CPU.
When i launch this grains separately - TelemetryCapture gests 40k /s TelemetryProcessor  around 20k/s. 
Two questions:
- Why performance of TelemetryProcessor is decreased while TelemetryCapture not?
- After a while i see errors on TelemetryProcessor  that ""Item not found in cache"". That suggest that Orleans remove messages from internal cache before grain start to read it. I thought that throttling mechanism is for that and should prevent such situation. 

Settings of Eviction:

Can you guide me here? 

@sergeybykov @jason-bragg ? :)","EventHub Streams - one grain starving another Hi. I have overrided EventHubDataAdapter to reads external EventHub messages.
I have two grains which are implicit subscribed to this StreamProvider.
One grain have a lot easier work and periodically make writes to Blob storage. Call it: TelemetryCapture
Second do a bit more processing - de-serialize message check some fields values and then write alert to MongoDB. Call it: TelemetryProcessor
I observed that TelemetryCapture process messages around 40k / s while TelemetryProcessor around 1k / s.
I did this testing one single silo cluster.
Machine is around 85% of CPU.
When i launch this grains separately - TelemetryCapture gests 40k /s TelemetryProcessor  around 20k/s. 
Two questions:
- Why performance of TelemetryProcessor is decreased while TelemetryCapture not?
- After a while i see errors on TelemetryProcessor  that ""Item not found in cache"". That suggest that Orleans remove messages from internal cache before grain start to read it. I thought that throttling mechanism is for that and should prevent such situation. 

Settings of Eviction:

Can you guide me here? 

@sergeybykov @jason-bragg ? :)",documentation,jason-bragg,,
5300,Codegen fails for ValueTask<T> with Build but not MSBuild,When trying to build a project containing a grain interface whose method returns a  is a valid return type therefore I'm assuming this is a bug.,Codegen fails for ValueTask<T> with Build but not MSBuild When trying to build a project containing a grain interface whose method returns a  is a valid return type therefore I'm assuming this is a bug.,,sergeybykov,,
5299,Grain Persistence and GrainCancellationTokenSource,Hi I am creating grain persistence for a master grain that manages the work of other worker grains. I am utilizing GrainCancellationTokenSource so the master grain can cancel all of the worker grains however when I try to use Grain Persistence for the GrainCancellationTokenSource I get an error saying that GrainCancellationTokenSource cannot be deep copied. Do you guys have any recommendations around this error or have any recommendations for managing cancellation of worker grains? Thanks.,Grain Persistence and GrainCancellationTokenSource Hi I am creating grain persistence for a master grain that manages the work of other worker grains. I am utilizing GrainCancellationTokenSource so the master grain can cancel all of the worker grains however when I try to use Grain Persistence for the GrainCancellationTokenSource I get an error saying that GrainCancellationTokenSource cannot be deep copied. Do you guys have any recommendations around this error or have any recommendations for managing cancellation of worker grains? Thanks.,question,sergeybykov,,
5298,Support customizable type name formatting,Currently Orleans allows users to customize Type resolution (conversion from some  impl),Support customizable type name formatting Currently Orleans allows users to customize Type resolution (conversion from some  impl),,ReubenBond,,
5297,[Question] Orleans transaction deadlocks,"I was looking at the Orleans transaction code (as I was trying to implement my own transactions for JournaledGrains) and I noticed some code that will produce deadlocks. I may be wrong but I would like to raise this question anyway (It will help me avoid or resolve deadlocks in my own implementation).

I noticed that [ReaderWriterLock](https://github.com/dotnet/orleans/blob/master/src/Orleans.Transactions/State/ReaderWriterLock.cs) is local to each [TransactionQueue](https://github.com/dotnet/orleans/blob/master/src/Orleans.Transactions/State/TransactionQueue.cs) and a TransactionQueue is instantiated for every TransactionalState.

There is a LockGroup currentGroup in ReaderWriterLock that is a linked list and when a new transaction requires a lock a new group is appended to the back of the linked list. This means that locks are queued in the order they have arrived in right? Doesn't that mean that it is possible that deadlocks can occur?

If there are 2 transactions T1 and T2 both affecting entities E1 and E2 E1 may have its lock group linked list as T1 T2 and E2 may have its lock group as T2 T1.

I would think that the lock groups are ordered by their .","[Question] Orleans transaction deadlocks I was looking at the Orleans transaction code (as I was trying to implement my own transactions for JournaledGrains) and I noticed some code that will produce deadlocks. I may be wrong but I would like to raise this question anyway (It will help me avoid or resolve deadlocks in my own implementation).

I noticed that [ReaderWriterLock](https://github.com/dotnet/orleans/blob/master/src/Orleans.Transactions/State/ReaderWriterLock.cs) is local to each [TransactionQueue](https://github.com/dotnet/orleans/blob/master/src/Orleans.Transactions/State/TransactionQueue.cs) and a TransactionQueue is instantiated for every TransactionalState.

There is a LockGroup currentGroup in ReaderWriterLock that is a linked list and when a new transaction requires a lock a new group is appended to the back of the linked list. This means that locks are queued in the order they have arrived in right? Doesn't that mean that it is possible that deadlocks can occur?

If there are 2 transactions T1 and T2 both affecting entities E1 and E2 E1 may have its lock group linked list as T1 T2 and E2 may have its lock group as T2 T1.

I would think that the lock groups are ordered by their .",,jason-bragg,,
5296,Use AzureClustering to make SiloGracefulShutdown_ForwardPendingRequest pass more consistently,,Use AzureClustering to make SiloGracefulShutdown_ForwardPendingRequest pass more consistently ,,ReubenBond,,
5295,The switch statement contains multiple cases with label value...,"Grain interfaces with duplicate/hidden method definitions of a base interface cause invalid code to be generated.

Example:


Normal VS setup does cause a warning on the hidden method but that doesn't break compilation. The generated code does.

I'll see if I can get around to a PR. Not sure I'll have time though. :( Likely either deduping in GrainInterfaceCommon.GenerateGrainInterfaceAndMethodSwitch *or* perhaps more properly accounting for hidden methods during ID generation in OrleansLegacyCompat.GetMethodId...","The switch statement contains multiple cases with label value... Grain interfaces with duplicate/hidden method definitions of a base interface cause invalid code to be generated.

Example:


Normal VS setup does cause a warning on the hidden method but that doesn't break compilation. The generated code does.

I'll see if I can get around to a PR. Not sure I'll have time though. :( Likely either deduping in GrainInterfaceCommon.GenerateGrainInterfaceAndMethodSwitch *or* perhaps more properly accounting for hidden methods during ID generation in OrleansLegacyCompat.GetMethodId...",codegen,ReubenBond,,
5294,Release notes for 2.2.1 and some prior releases,,Release notes for 2.2.1 and some prior releases ,,ReubenBond,,
5292,Gettting a System.TypeAccessException: Unable to find a type named Microsoft.FSharp.Core.LanguagePrimitives,"Hi there I am getting a 
**version info:**
- .Net Core 2.2
- Orleans 2.2.0
- C# 7.3
- FSharp.Core 4.5.2


","Gettting a System.TypeAccessException: Unable to find a type named Microsoft.FSharp.Core.LanguagePrimitives Hi there I am getting a 
**version info:**
- .Net Core 2.2
- Orleans 2.2.0
- C# 7.3
- FSharp.Core 4.5.2


",,ReubenBond,,
5291,Cherry-pick a couple of fixes to transactions for 2.2.1,,Cherry-pick a couple of fixes to transactions for 2.2.1 ,,ReubenBond,,
5288,SiloHostBuilder.Build() should throw if AddApplicationPart() added no app grain classes,#4785 exposed this gap - if a grain class projects lacks the codegen NuGet package then calling  throw if no application grain classes were added.,SiloHostBuilder.Build() should throw if AddApplicationPart() added no app grain classes #4785 exposed this gap - if a grain class projects lacks the codegen NuGet package then calling  throw if no application grain classes were added.,,ReubenBond,,
5287,How can I get client context? ,"How can I get client context: client ID client IP address(for logging) maybe message ID connect ID in grain?
Something with which I can make unique sessions and make log.
Have Orleans mechanism for that or any code example of user implementation? ","How can I get client context?  How can I get client context: client ID client IP address(for logging) maybe message ID connect ID in grain?
Something with which I can make unique sessions and make log.
Have Orleans mechanism for that or any code example of user implementation? ",question,sergeybykov,3/01/2019 7:21,3/01/2019 8:29
5286,Grain Persistence and polling,"I'm working on a project with a design where individual Grains would make Http calls to poll on web services. My code has it so the grain would do Task.Run() to poll on the web service until it's finished. I'm trying to implement grain persistence and thinking through a scenario where a silo goes down while a grain is polling and I'm not sure how to ensure it will pick back up where it left off. 

Do you guys have a recommended way to do something like that?","Grain Persistence and polling I'm working on a project with a design where individual Grains would make Http calls to poll on web services. My code has it so the grain would do Task.Run() to poll on the web service until it's finished. I'm trying to implement grain persistence and thinking through a scenario where a silo goes down while a grain is polling and I'm not sure how to ensure it will pick back up where it left off. 

Do you guys have a recommended way to do something like that?",question,sergeybykov,,
5282,More sample code????,Can you offer more examples?Google searched and didn't have too many examples of use.Thanks!!!!,More sample code???? Can you offer more examples?Google searched and didn't have too many examples of use.Thanks!!!!,question,sergeybykov,,
5281,How to invoke a grain only if active?,"Hi

I've ran into this situation many times before. 
I have grains that sometimes I need to update their state but only if they're active.

These grains are heavy to activate since they're doing SQL queries in their  to Get a grain it probably checks against the directory if it's active and if not then it should activate it.. ? so in this process can we expose just the first part? wether it's already active?

Many thanks if you read this far :)","How to invoke a grain only if active? Hi

I've ran into this situation many times before. 
I have grains that sometimes I need to update their state but only if they're active.

These grains are heavy to activate since they're doing SQL queries in their  to Get a grain it probably checks against the directory if it's active and if not then it should activate it.. ? so in this process can we expose just the first part? wether it's already active?

Many thanks if you read this far :)",enhancement,benjaminpetit,,
5278,ArgumentNullException thrown when stopping the TestSilo,"This is similar to #4965 although that issue has been fixed with PR #5072 I am still getting this error on the latest release version (2.2.0) of  task for job ""linux"". This exception seems like to be caused by a race condition as it was intermittent and goes away after retrying).

It was only encountered on Linux so far; <del>has not been reproduced on macOS and Windows so far.</del> actually the exception is seen in macOS/Windows logs as well.

> [Here](https://github.com/ztl8702/CrowdSource/blob/c603fef5cf9966ff746a3aa4920f559ed89db6da/test/Zezo.Core.Grains.Tests/BaseGrainTest.cs) is the code I used to [start](https://github.com/ztl8702/CrowdSource/blob/c603fef5cf9966ff746a3aa4920f559ed89db6da/test/Zezo.Core.Grains.Tests/BaseGrainTest.cs#L33-L46) and [stop](https://github.com/ztl8702/CrowdSource/blob/c603fef5cf9966ff746a3aa4920f559ed89db6da/test/Zezo.Core.Grains.Tests/BaseGrainTest.cs#L53-L60) the TestSilo.","ArgumentNullException thrown when stopping the TestSilo This is similar to #4965 although that issue has been fixed with PR #5072 I am still getting this error on the latest release version (2.2.0) of  task for job ""linux"". This exception seems like to be caused by a race condition as it was intermittent and goes away after retrying).

It was only encountered on Linux so far; <del>has not been reproduced on macOS and Windows so far.</del> actually the exception is seen in macOS/Windows logs as well.

> [Here](https://github.com/ztl8702/CrowdSource/blob/c603fef5cf9966ff746a3aa4920f559ed89db6da/test/Zezo.Core.Grains.Tests/BaseGrainTest.cs) is the code I used to [start](https://github.com/ztl8702/CrowdSource/blob/c603fef5cf9966ff746a3aa4920f559ed89db6da/test/Zezo.Core.Grains.Tests/BaseGrainTest.cs#L33-L46) and [stop](https://github.com/ztl8702/CrowdSource/blob/c603fef5cf9966ff746a3aa4920f559ed89db6da/test/Zezo.Core.Grains.Tests/BaseGrainTest.cs#L53-L60) the TestSilo.",,jason-bragg,,
5277,Docs clarification: Reentrancy,"I have the following questions when looking at the 2.0 Docs on the topic of [Reentrancy](https://github.com/dotnet/orleans/blob/cfdd759d798f1f6b49d037cceda159beb4f37b10/src/Documentation/grains/reentrancy.md):

1. When an interface method is attributed s (I believe these are Orleans' internal data structures?). How do I determine which method on the Grain's interface is being invoked by this request? The example only demonstrates checking attributes on the request argument types. But if I cannot decide which interface method is being invoked what is the point of checking the arguments? And what about argumentless interface methods?

Those aren't very clear to me as I learn to use Orleans. So could anyone from the team please clarify these and possibly add to the docs? Thanks!","Docs clarification: Reentrancy I have the following questions when looking at the 2.0 Docs on the topic of [Reentrancy](https://github.com/dotnet/orleans/blob/cfdd759d798f1f6b49d037cceda159beb4f37b10/src/Documentation/grains/reentrancy.md):

1. When an interface method is attributed s (I believe these are Orleans' internal data structures?). How do I determine which method on the Grain's interface is being invoked by this request? The example only demonstrates checking attributes on the request argument types. But if I cannot decide which interface method is being invoked what is the point of checking the arguments? And what about argumentless interface methods?

Those aren't very clear to me as I learn to use Orleans. So could anyone from the team please clarify these and possibly add to the docs? Thanks!",documentation,sergeybykov,26/12/2018 4:54,5/01/2019 9:37
5276,Sort out LocalGrainDirectory shutdown sequence,"- move LocalGrainDirectory stop to  instead being trigged by MembershipOracleShutdown -> Sent notification to its SiloStatatusListeners about its shuttingdown -> LocalGrainDirectory.Stop(). and not awaiting the call. 

- sort out its shutdown sequence to be : 

1. exclude itself from GrainDirectoryPartition calculation since it is shutting down and cannot serve as as GrainDirectoryPartition anymore
2. Stop Mantainers
3. GrainPartition handoff and we are awaiting this call 
4. Clear local activation cache
5. MarkStopPreparationCompleted

","Sort out LocalGrainDirectory shutdown sequence - move LocalGrainDirectory stop to  instead being trigged by MembershipOracleShutdown -> Sent notification to its SiloStatatusListeners about its shuttingdown -> LocalGrainDirectory.Stop(). and not awaiting the call. 

- sort out its shutdown sequence to be : 

1. exclude itself from GrainDirectoryPartition calculation since it is shutting down and cannot serve as as GrainDirectoryPartition anymore
2. Stop Mantainers
3. GrainPartition handoff and we are awaiting this call 
4. Clear local activation cache
5. MarkStopPreparationCompleted

",,ReubenBond,,
5275,Null reference in CallGrainActivate,"Hi! I have really strange error and behavior. 
I'v created GranService which use EventProcessorHost and register appropriate EventHubProcessor.
EventHubProcessor get reference to OtherGrain and call on it method Process with grainId extracted from message. OtherGrain has state. There is a lot a different graindIds (around 10k). After running Silo on server im getting following error:

","Null reference in CallGrainActivate Hi! I have really strange error and behavior. 
I'v created GranService which use EventProcessorHost and register appropriate EventHubProcessor.
EventHubProcessor get reference to OtherGrain and call on it method Process with grainId extracted from message. OtherGrain has state. There is a lot a different graindIds (around 10k). After running Silo on server im getting following error:

",,ReubenBond,,
5271,Increase default build version to 2.3.0,,Increase default build version to 2.3.0 ,,ReubenBond,,
5265,Compilation error `error CS0579: Duplicate GeneratedCodeAttribute attribute` when used with webapi project,I have a webapi project created using . The project and the associated bin-log can be found [here](https://drive.google.com/drive/folders/1k8pXqQ7l4VpaxWX7CW2_EtQC_YPtasSv?usp=sharing),Compilation error . The project and the associated bin-log can be found [here](https://drive.google.com/drive/folders/1k8pXqQ7l4VpaxWX7CW2_EtQC_YPtasSv?usp=sharing),,ReubenBond,,
5262,Question - Architecture - Processing a file,"I am working presently on parsing a zip file.  In that file has about 1000 +/- files that I need to seek 4 of them out and do some backend work to extract information about the contents of the file (and maybe need to extract a subsequent 4-5 files thereafter... undecided yet).

My current implementation is doing this via my web portal and although it works it does not seem ideal long-term.

What I think I want to do is to basically:
1. Create a worker node for this parsing
2. Teach the upload API to accept the file drop it to Azure storage then create an item in a queue and/or publish it via an Orleans stream
3. Have a subscriber on the Orleans stream and/or queue pick it up and do the work on the back-end reporting back to the user that uploaded the file what the status is.

Think of doing an operation within the Azure portal today.

Are there any best practices available from the team as to how to properly do this within Orleans and/or has anyone done anything like this within Orleans?  If so what were the gotchas etc????","Question - Architecture - Processing a file I am working presently on parsing a zip file.  In that file has about 1000 +/- files that I need to seek 4 of them out and do some backend work to extract information about the contents of the file (and maybe need to extract a subsequent 4-5 files thereafter... undecided yet).

My current implementation is doing this via my web portal and although it works it does not seem ideal long-term.

What I think I want to do is to basically:
1. Create a worker node for this parsing
2. Teach the upload API to accept the file drop it to Azure storage then create an item in a queue and/or publish it via an Orleans stream
3. Have a subscriber on the Orleans stream and/or queue pick it up and do the work on the back-end reporting back to the user that uploaded the file what the status is.

Think of doing an operation within the Azure portal today.

Are there any best practices available from the team as to how to properly do this within Orleans and/or has anyone done anything like this within Orleans?  If so what were the gotchas etc????",question,sergeybykov,,
5261,Microsoft.Extensions.Hosting support,"This PR adds [Microsoft.Extensions.Hosting](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/host/generic-host?view=aspnetcore-2.1) support for Orleans (aka _Generic Host_).

This PR is being worked out aligned with @ReubenBond and the strategy described [here](https://github.com/dotnet/orleans/issues/4702#issuecomment-446684609).

Fixes #4702","Microsoft.Extensions.Hosting support This PR adds [Microsoft.Extensions.Hosting](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/host/generic-host?view=aspnetcore-2.1) support for Orleans (aka _Generic Host_).

This PR is being worked out aligned with @ReubenBond and the strategy described [here](https://github.com/dotnet/orleans/issues/4702#issuecomment-446684609).

Fixes #4702",,ReubenBond,,
5260,What interface does Orleans have to get all Grain?,What interface does Orleans have to get all Grain? ,What interface does Orleans have to get all Grain? What interface does Orleans have to get all Grain? ,question,sergeybykov,,
5259,P2P network?,I noticed in the adventure example that the host was also the client. This has me wondering: what is stopping you from axing the middle man altogether and making the client the host too? I.e. a P2P network?,P2P network? I noticed in the adventure example that the host was also the client. This has me wondering: what is stopping you from axing the middle man altogether and making the client the host too? I.e. a P2P network?,question,sergeybykov,14/12/2018 14:36,5/01/2019 9:32
5256,Is there any way to get the type of the grain reference which passed in the method parameters?,"Is there any way to get the type of the grain reference which passed in the method parameters?
Like below:

Caller interfaces:
","Is there any way to get the type of the grain reference, which passed in the method parameters? Is there any way to get the type of the grain reference which passed in the method parameters?
Like below:

Caller interfaces:
",question,sergeybykov,,
5255,Fix build warnings caused by new codegen in test tree ,The warning introduced in #5031 shows up in our build logs because some test state classes inherit from ,Fix build warnings caused by new codegen in test tree  The warning introduced in #5031 shows up in our build logs because some test state classes inherit from ,,ReubenBond,,
5254,Cherry-pick post 2.2.0-rc1 fixes for 2.2.0 final #3,"Add GSI cache maintenance and tests (#5184)
Revert: Fix call chain reentrancy (#5145 #5225) (#5249)","Cherry-pick post 2.2.0-rc1 fixes for 2.2.0 final #3 Add GSI cache maintenance and tests (#5184)
Revert: Fix call chain reentrancy (#5145 #5225) (#5249)",,ReubenBond,,
5252,Logger names in transactions,"Currently the logger name used throughout most of the transaction system is unique per resource. While this can be helpful when tracing transactions it also makes it more difficult for someone not very familiar with the internals to turn on debug logging for just transactions. In my case this was compounded by having logging settings that don't print the logger name.

Perhaps a compromise between what is there now and more standard logger names is to prefix the logger name with  to allow a simple source filter to work.","Logger names in transactions Currently the logger name used throughout most of the transaction system is unique per resource. While this can be helpful when tracing transactions it also makes it more difficult for someone not very familiar with the internals to turn on debug logging for just transactions. In my case this was compounded by having logging settings that don't print the logger name.

Perhaps a compromise between what is there now and more standard logger names is to prefix the logger name with  to allow a simple source filter to work.",,jason-bragg,,
5250,A transaction with only 1 write participant incorrectly assumes that the write participant is local,"Setup:
Orleans 2.2.0-rc1
Have a transaction with 2 or more participants where only 1 of them writes.
*It may or may not be necessary for the 1st participant to be read only.
Wait for 
would fix this particular problem but I have some doubts about how read only participants are handled in read + write transactions since at least on the surface it looks like they are still expecting to get the confirmations.

I'm pretty sure this is a regression from 2.1.","A transaction with only 1 write participant incorrectly assumes that the write participant is local Setup:
Orleans 2.2.0-rc1
Have a transaction with 2 or more participants where only 1 of them writes.
*It may or may not be necessary for the 1st participant to be read only.
Wait for 
would fix this particular problem but I have some doubts about how read only participants are handled in read + write transactions since at least on the surface it looks like they are still expecting to get the confirmations.

I'm pretty sure this is a regression from 2.1.",,jason-bragg,,
5248,Added 'first' and 'last' to grain lifecycle stages.,Added first and last stages to grain lifecycle stages to align with service lifecycle stages,Added 'first' and 'last' to grain lifecycle stages. Added first and last stages to grain lifecycle stages to align with service lifecycle stages,,ReubenBond,,
5247,RegexImplicitStreamSubscription not working,"Implicit stream subscription with RegexImplicitStreamSubscription attribute is not working:

> System.Runtime.Serialization.SerializationException: 'Type 'System.Text.RegularExpressions.RegexReplacement' in Assembly 'System.Text.RegularExpressions Version=4.2.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a' is not marked as serializable.'


","RegexImplicitStreamSubscription not working Implicit stream subscription with RegexImplicitStreamSubscription attribute is not working:

> System.Runtime.Serialization.SerializationException: 'Type 'System.Text.RegularExpressions.RegexReplacement' in Assembly 'System.Text.RegularExpressions Version=4.2.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a' is not marked as serializable.'


",,xiazen,,
5245,Microsoft.Orleans.OrleansCodeGenerator.Build dotnet core 2.2 support,"Hello

Today I've tried to update my Orleans project to dotnet core 2.2 and faced the following issue. Seems that Microsoft.Orleans.OrleansCodeGenerator.Build package (https://www.nuget.org/packages/Microsoft.Orleans.OrleansCodeGenerator.Build/2.2.0-rc1) supports dotnet core 2.1 https://github.com/dotnet/orleans/blob/master/src/Orleans.CodeGeneration.Build/build/Microsoft.Orleans.OrleansCodeGenerator.Build.targets and in latest RC-1 for orleans 2.2.0 there is no support for dotnet core 2.2 as well.

The error looks like this and it is expected due to the how *targets* file is implemented.


I'm wondering whether there are plans to support netcore 2.2 with the release?

Thanks. ","Microsoft.Orleans.OrleansCodeGenerator.Build dotnet core 2.2 support Hello

Today I've tried to update my Orleans project to dotnet core 2.2 and faced the following issue. Seems that Microsoft.Orleans.OrleansCodeGenerator.Build package (https://www.nuget.org/packages/Microsoft.Orleans.OrleansCodeGenerator.Build/2.2.0-rc1) supports dotnet core 2.1 https://github.com/dotnet/orleans/blob/master/src/Orleans.CodeGeneration.Build/build/Microsoft.Orleans.OrleansCodeGenerator.Build.targets and in latest RC-1 for orleans 2.2.0 there is no support for dotnet core 2.2 as well.

The error looks like this and it is expected due to the how *targets* file is implemented.


I'm wondering whether there are plans to support netcore 2.2 with the release?

Thanks. ",,ReubenBond,,
5244,Missing global:: prefix in generated code,I'm using  prefix.,Missing global:: prefix in generated code I'm using  prefix.,,ReubenBond,,
5243,MSBuild code generator cannot generate serializer for struct with array field,"I changed the code generator in my project to 

As far as I can tell the exception is thrown in [SerializerGenerator.IsValueTypeFieldsShallowCopyable](https://github.com/dotnet/orleans/blob/008605e3717ccd5f7396c388090e8c7a6ea1a46c/src/Orleans.CodeGenerator/Generators/SerializerGenerator.cs#L633).

The issue seems to be that the new code generator will only create a serializer if the field can be shallow copied. However an array of a type that can be shallow copied can also be shallow copied by copying the array. The old code generator didn't have this issue and I hope this can be fixed in the new code generator.","MSBuild code generator cannot generate serializer for struct with array field I changed the code generator in my project to 

As far as I can tell the exception is thrown in [SerializerGenerator.IsValueTypeFieldsShallowCopyable](https://github.com/dotnet/orleans/blob/008605e3717ccd5f7396c388090e8c7a6ea1a46c/src/Orleans.CodeGenerator/Generators/SerializerGenerator.cs#L633).

The issue seems to be that the new code generator will only create a serializer if the field can be shallow copied. However an array of a type that can be shallow copied can also be shallow copied by copying the array. The old code generator didn't have this issue and I hope this can be fixed in the new code generator.",codegen,ReubenBond,,
5242,Cherry-pick post 2.2.0-rc1 fixes for 2.2.0 final #2,"Update ZooKeeperNetEx package to 3.4.12.1 (#5236)
Include exception in TryForwardRequest info log (#5238)
Improve logging of stream delivery errors. (#5230)
Support ProxyGatewayEndpoint from legacy configuration (#5214)","Cherry-pick post 2.2.0-rc1 fixes for 2.2.0 final #2 Update ZooKeeperNetEx package to 3.4.12.1 (#5236)
Include exception in TryForwardRequest info log (#5238)
Improve logging of stream delivery errors. (#5230)
Support ProxyGatewayEndpoint from legacy configuration (#5214)",,ReubenBond,,
5241,AzureStorageClustering does not work with Azurite,"I was trying out Azurite as the storage emulator as the version 5.8 of the official storage emulator has a huge bug (https://github.com/Azure/azure-storage-net/issues/801) where blobs cannot be written. Since I am relying on blob storage for non-orleans use I had to move away from using the emulator since I was unable to find an installer for the previous 5.7 version of the emulator (https://github.com/Azure/azure-storage-net/issues/810#issuecomment-446123225)

However my silo will not start using azurite. The OrleansSiloInstances table is created and populated with the SampleStore/VersionRow entry. The following is the output from the Azurite terminal:

![image](https://user-images.githubusercontent.com/2112306/49789609-b6ad5000-fd2c-11e8-9457-7fcd4e1811e8.png)

Storage emulator fiddler:
![image](https://user-images.githubusercontent.com/2112306/49792023-004c6980-fd32-11e8-99b8-36f9b33e9569.png)

Azurite fiddler:
![image](https://user-images.githubusercontent.com/2112306/49792051-135f3980-fd32-11e8-902a-d13031708323.png)



I know that this is not an Orleans bug but maybe we could help the Azurite guys to reproduce what is going on...?","AzureStorageClustering does not work with Azurite I was trying out Azurite as the storage emulator as the version 5.8 of the official storage emulator has a huge bug (https://github.com/Azure/azure-storage-net/issues/801) where blobs cannot be written. Since I am relying on blob storage for non-orleans use I had to move away from using the emulator since I was unable to find an installer for the previous 5.7 version of the emulator (https://github.com/Azure/azure-storage-net/issues/810#issuecomment-446123225)

However my silo will not start using azurite. The OrleansSiloInstances table is created and populated with the SampleStore/VersionRow entry. The following is the output from the Azurite terminal:

![image](https://user-images.githubusercontent.com/2112306/49789609-b6ad5000-fd2c-11e8-9457-7fcd4e1811e8.png)

Storage emulator fiddler:
![image](https://user-images.githubusercontent.com/2112306/49792023-004c6980-fd32-11e8-99b8-36f9b33e9569.png)

Azurite fiddler:
![image](https://user-images.githubusercontent.com/2112306/49792051-135f3980-fd32-11e8-902a-d13031708323.png)



I know that this is not an Orleans bug but maybe we could help the Azurite guys to reproduce what is going on...?",,sergeybykov,,
5240,2.2.0 1,Resubmitting this PR to be merged without squashing.,2.2.0 1 Resubmitting this PR to be merged without squashing.,,ReubenBond,,
5239,Mark key legacy types/methods as [Obsolete],"Fixes #5221

I disabled legacy type warnings for the 

I figured:

* 1 is too much work for now (especially between rc and final)
* 2 offers little benefit over the chosen approach with more cost
* 3 would make code ugly since it requires many changes which will eventually need to be undone before (presumably) 3.0.","Mark key legacy types/methods as [Obsolete] Fixes #5221

I disabled legacy type warnings for the 

I figured:

* 1 is too much work for now (especially between rc and final)
* 2 offers little benefit over the chosen approach with more cost
* 3 would make code ugly since it requires many changes which will eventually need to be undone before (presumably) 3.0.",,sergeybykov,,
5237,silo dead,"
I see a lot of the same problems and I configure it very simply

>  var builder = new SiloHostBuilder()
                //.UseDashboard(options =>
                //{
                //    options.Username = ""ABC"";
                //    options.Password = ""123"";
                //    options.Host = ""*"";
                //    options.Port = 11110;
                //    options.HostSelf = true;
                //    options.CounterUpdateIntervalMs = 1000;
                //})
                .Configure<SerializationProviderOptions>(d => { d.SerializationProviders.Add(typeof(ProtobufSerializer).GetTypeInfo()); })
               .UseAdoNetClustering(options =>
               {
                   options.Invariant = invariant;
                   options.ConnectionString = connectionString;
               })
                .UseAdoNetReminderService(options =>
                {
                    options.Invariant = invariant;
                    options.ConnectionString = connectionString;
                })
                .AddAdoNetGrainStorage(""ProductServerWeb"" options =>
                {
                    options.Invariant = invariant;
                    options.ConnectionString = connectionString;
                }).AddAdoNetGrainStorageAsDefault(opations => {
                     opations.ConnectionString = connectionString;
                 }) .ConfigureEndpoints(siloPort gatewayPort)
                    .Configure<ClusterOptions>(options =>
                    {
                        options.ClusterId = ""dev"";
                        options.ServiceId = ""AuthorizationServer"";
                    })
                    .AddStartupTask((IServiceProvider services CancellationToken cancellation) =>
                      {
                          var grainFactory = services.GetRequiredService<IGrainFactory>();
                          return Task.CompletedTask;
                      })
                     .ConfigureLogging(logging => logging.AddConsole());
            var host = builder.Build();
            await host.StartAsync();
            return host;

I started it and then I went to PLAY and after a while about 20 minutes it had a problem. I repeated the result several times during which only this warehouse was running and no calls were made

Why does it kill itself and notify it and then it dies?","silo dead 
I see a lot of the same problems and I configure it very simply

>  var builder = new SiloHostBuilder()
                //.UseDashboard(options =>
                //{
                //    options.Username = ""ABC"";
                //    options.Password = ""123"";
                //    options.Host = ""*"";
                //    options.Port = 11110;
                //    options.HostSelf = true;
                //    options.CounterUpdateIntervalMs = 1000;
                //})
                .Configure<SerializationProviderOptions>(d => { d.SerializationProviders.Add(typeof(ProtobufSerializer).GetTypeInfo()); })
               .UseAdoNetClustering(options =>
               {
                   options.Invariant = invariant;
                   options.ConnectionString = connectionString;
               })
                .UseAdoNetReminderService(options =>
                {
                    options.Invariant = invariant;
                    options.ConnectionString = connectionString;
                })
                .AddAdoNetGrainStorage(""ProductServerWeb"" options =>
                {
                    options.Invariant = invariant;
                    options.ConnectionString = connectionString;
                }).AddAdoNetGrainStorageAsDefault(opations => {
                     opations.ConnectionString = connectionString;
                 }) .ConfigureEndpoints(siloPort gatewayPort)
                    .Configure<ClusterOptions>(options =>
                    {
                        options.ClusterId = ""dev"";
                        options.ServiceId = ""AuthorizationServer"";
                    })
                    .AddStartupTask((IServiceProvider services CancellationToken cancellation) =>
                      {
                          var grainFactory = services.GetRequiredService<IGrainFactory>();
                          return Task.CompletedTask;
                      })
                     .ConfigureLogging(logging => logging.AddConsole());
            var host = builder.Build();
            await host.StartAsync();
            return host;

I started it and then I went to PLAY and after a while about 20 minutes it had a problem. I repeated the result several times during which only this warehouse was running and no calls were made

Why does it kill itself and notify it and then it dies?",,ReubenBond,,
5234,Ensure OrleansProviders is added as an ApplicationPart in streams providers,"Fixes #5172 for all streams providers

Thanks for being patient @galvesribeiro :)","Ensure OrleansProviders is added as an ApplicationPart in streams providers Fixes #5172 for all streams providers

Thanks for being patient @galvesribeiro :)",,jason-bragg,,
5231,Stream Provider Configurator work,In 2.0 we introduced StreamConfigurator the concept the abstracions and minimum implementations. The goal is to move stream configuration from an inheritance based approach to a dependency injection based approach. That work has been started a minimum implementation is put in. but It is still far from finishing. ,Stream Provider Configurator work In 2.0 we introduced StreamConfigurator the concept the abstracions and minimum implementations. The goal is to move stream configuration from an inheritance based approach to a dependency injection based approach. That work has been started a minimum implementation is put in. but It is still far from finishing. ,,jason-bragg,,
5230,Improve logging of stream delivery errors.,Attempt to address #5205,Improve logging of stream delivery errors. Attempt to address #5205,,xiazen,,
5226,Receive timeout explanation / guarantees,"I understand the client and silo messaging timeouts can be configured. My questions is what kind of guarantees do I have when the timeouts occur?

I would like to cover the following scenarios:

1. When the timeout occurs I'd like the (grain) method to finish its work and not be interrupted
1. When an exception occurs I'd like it to be logged

As far as I've tested locally even when the timeout on the client occurs the method finishes correctly. I has a test case with an intentional 

Exception handling is trickier: when a client is connected the exceptions are sent to the client. When the timeout occurs the exceptions are swallowed. I then implemented an incoming grain call filter and that one catches the exceptions so they can be at least logged.

The questions are:

* does Orleans runtime guarantee that the grain method code will execute after the timeout?
* is implementing an incoming grain call filter the right approach for catching exceptions?

Thanks!","Receive timeout explanation / guarantees I understand the client and silo messaging timeouts can be configured. My questions is what kind of guarantees do I have when the timeouts occur?

I would like to cover the following scenarios:

1. When the timeout occurs I'd like the (grain) method to finish its work and not be interrupted
1. When an exception occurs I'd like it to be logged

As far as I've tested locally even when the timeout on the client occurs the method finishes correctly. I has a test case with an intentional 

Exception handling is trickier: when a client is connected the exceptions are sent to the client. When the timeout occurs the exceptions are swallowed. I then implemented an incoming grain call filter and that one catches the exceptions so they can be at least logged.

The questions are:

* does Orleans runtime guarantee that the grain method code will execute after the timeout?
* is implementing an incoming grain call filter the right approach for catching exceptions?

Thanks!",,sergeybykov,,
5224,Timeout exception when using Simple Message Stream Provider / Implicit Subscription,"I activate 3122 grains via a [OneWay] grain (Grain A) method. This first grain (Grain A) saves state pushes an event (Event A) to stream and activates 2 more grains (Grain B and Grain C). Both Grain B and C save state and push an event to stream (Event B and Event C).

Event A and Event B are not picked up by any Grain (no subscribers). We do this to save the event that is event sourcing.

This is how we save state and push the event (Grain A B and C inherit from a base class).


Grain C and Grain E do not make sense at all. Somehow the messages are not being picked up on time and lost completely. This behaviour only appears when we launch the application without debugging. When we debug the application everything works fine.
","Timeout exception when using Simple Message Stream Provider / Implicit Subscription I activate 3122 grains via a [OneWay] grain (Grain A) method. This first grain (Grain A) saves state pushes an event (Event A) to stream and activates 2 more grains (Grain B and Grain C). Both Grain B and C save state and push an event to stream (Event B and Event C).

Event A and Event B are not picked up by any Grain (no subscribers). We do this to save the event that is event sourcing.

This is how we save state and push the event (Grain A B and C inherit from a base class).


Grain C and Grain E do not make sense at all. Somehow the messages are not being picked up on time and lost completely. This behaviour only appears when we launch the application without debugging. When we debug the application everything works fine.
",,jason-bragg,,
5223,Add warm up to transaction recovery tests and reduce grain logging,TransactionWillRecoverAfterRandomSiloFailure test failed on the first assert where we send transaction request to grains for the first time before we shutdown or kill silo. Failure are prepareTimeout and break lock. So I suspect it is because grains are taking too long to activate or grains logging are too verbose. So in order to make TransactionWillRecoverAfterRandomSiloFailure passing more consistent  added a ping method to the grain interface and call Ping() to activate grains before transaction calls and reduce grain logging level.,Add warm up to transaction recovery tests and reduce grain logging TransactionWillRecoverAfterRandomSiloFailure test failed on the first assert where we send transaction request to grains for the first time before we shutdown or kill silo. Failure are prepareTimeout and break lock. So I suspect it is because grains are taking too long to activate or grains logging are too verbose. So in order to make TransactionWillRecoverAfterRandomSiloFailure passing more consistent  added a ping method to the grain interface and call Ping() to activate grains before transaction calls and reduce grain logging level.,,ReubenBond,,
5222,Changelog for 2.2.0-rc1,,Changelog for 2.2.0-rc1 ,,ReubenBond,,
5221,Mark legacy types as [Obsolete],We do not plan to ship legacy packages and classes like  as part of 3.0 because they will have outlived their utility by then. To communicate this intent we need to mark all types that will be going away as [Obsolete] now so that people have enough time to plan and adjust their code.,Mark legacy types as [Obsolete] We do not plan to ship legacy packages and classes like  as part of 3.0 because they will have outlived their utility by then. To communicate this intent we need to mark all types that will be going away as [Obsolete] now so that people have enough time to plan and adjust their code.,,sergeybykov,,
5220,Nullref when calling injected IGrainServiceClient from a FooGrainService,"I'm getting a nullref when trying to invoke an injected IBarGrainServiceClient from a FooGrainService. GrainServiceClient.CallingGrainReference is throwing a nullref due to RuntimeContext.Current?.ActivationContext?.Activation being null.

","Nullref when calling injected IGrainServiceClient from a FooGrainService I'm getting a nullref when trying to invoke an injected IBarGrainServiceClient from a FooGrainService. GrainServiceClient.CallingGrainReference is throwing a nullref due to RuntimeContext.Current?.ActivationContext?.Activation being null.

",,xiazen,,
5219,Clearing state failed for grain which hasn't been yet saved to AzureTable storage,"Good day to all.

Calling ClearStateAsync failed with exception when grain instance doesn't have table record.

This is because of grainState.Etag is null during grain Activation if it doesn't have a table record.
Possible solutions:
- Skip deletion for null Etag
- Using '*' as Etag value for null Etag

Exception details:

Exc level 0: System.ArgumentException: Delete requires an ETag (which may be the '*' wildcard).
   at Microsoft.WindowsAzure.Storage.Table.TableOperation.Delete(ITableEntity entity) in C:\Program Files (x86)\Jenkins\workspace\release_dotnet_master\Lib\Common\Table\TableOperation.Common.cs:line 190
   at Orleans.Persistence.AzureStorage.AzureTableDataManager1.ClearStateAsync() in D:\build\agent\_work\24\s\src\Orleans.Runtime\Storage\StateStorageBridge.cs:line 130

","Clearing state failed for grain which hasn't been yet saved to AzureTable storage Good day to all.

Calling ClearStateAsync failed with exception when grain instance doesn't have table record.

This is because of grainState.Etag is null during grain Activation if it doesn't have a table record.
Possible solutions:
- Skip deletion for null Etag
- Using '*' as Etag value for null Etag

Exception details:

Exc level 0: System.ArgumentException: Delete requires an ETag (which may be the '*' wildcard).
   at Microsoft.WindowsAzure.Storage.Table.TableOperation.Delete(ITableEntity entity) in C:\Program Files (x86)\Jenkins\workspace\release_dotnet_master\Lib\Common\Table\TableOperation.Common.cs:line 190
   at Orleans.Persistence.AzureStorage.AzureTableDataManager1.ClearStateAsync() in D:\build\agent\_work\24\s\src\Orleans.Runtime\Storage\StateStorageBridge.cs:line 130

",help wanted,ReubenBond,,
5218,[Question] Google Cloud Platform PubSub,"Hello

In the Orleans.Stream.GCP.csproj there is the following:



Since Google.Cloud.PubSub has been release and is not in beta version can we consider Orleans Google's PubSub as a stable version?

https://www.nuget.org/packages/Google.Cloud.PubSub.V1

","[Question] Google Cloud Platform PubSub Hello

In the Orleans.Stream.GCP.csproj there is the following:



Since Google.Cloud.PubSub has been release and is not in beta version can we consider Orleans Google's PubSub as a stable version?

https://www.nuget.org/packages/Google.Cloud.PubSub.V1

",,sergeybykov,,
5217,AdoNetGrainStorage : Newtonsoft.Json.JsonSerializationException: Self referencing loop detected,"We have json serialization error during WriteState for grain. We use the AdoNetGrainStorage .
Looks like the using of ReferenceLoopHandling json setting is missing.
","AdoNetGrainStorage : Newtonsoft.Json.JsonSerializationException: Self referencing loop detected We have json serialization error during WriteState for grain. We use the AdoNetGrainStorage .
Looks like the using of ReferenceLoopHandling json setting is missing.
",,ReubenBond,,
5216,ConsistentRingProviderTests_Silo.Ring_1Fsec1J test failure,"Example: https://ci.dot.net/job/dotnet_orleans/job/master/job/functional_prtest/2428/testReport/junit/UnitTests.General/ConsistentRingProviderTests_Silo/Ring_1Fsec1J/

","ConsistentRingProviderTests_Silo.Ring_1Fsec1J test failure Example: https://ci.dot.net/job/dotnet_orleans/job/master/job/functional_prtest/2428/testReport/junit/UnitTests.General/ConsistentRingProviderTests_Silo/Ring_1Fsec1J/

",test-issue,sergeybykov,4/12/2018 13:02,
5214,Support ProxyGatewayEndpoint from legacy configuration,Propagates the  wasn't redundant: it was being used to determine whether or not to start a gateway etc. I added changes to fix that.,Support ProxyGatewayEndpoint from legacy configuration Propagates the  wasn't redundant: it was being used to determine whether or not to start a gateway etc. I added changes to fix that.,,benjaminpetit,,
5213,Fix AzureSilo startup,"We saw an issue with  implementation.

Two main changes: 

* Do not manually publish an entry into the table
* Do not manually configure a silo generation (which will be overwritten later anyway).

We can include this post 2.2.0-rc1","Fix AzureSilo startup We saw an issue with  implementation.

Two main changes: 

* Do not manually publish an entry into the table
* Do not manually configure a silo generation (which will be overwritten later anyway).

We can include this post 2.2.0-rc1",,benjaminpetit,,
5212,Turn off nuget release for transaction testkit projects,,Turn off nuget release for transaction testkit projects ,,ReubenBond,,
5210,Optimize memory allocation with custom EqualityComparer,The  to eliminate allocation.,Optimize memory allocation with custom EqualityComparer The  to eliminate allocation.,,ReubenBond,,
5206,How do I deploy Silo on Azure as a app service?,"I am trying to deploy to my first Orleans project on Azure as a service but was not able to find any solution.
Right now I am using a local cluster and it is working fine.","How do I deploy Silo on Azure as a app service? I am trying to deploy to my first Orleans project on Azure as a service but was not able to find any solution.
Right now I am using a local cluster and it is working fine.",question,ReubenBond,,
5205,Exceptions on stream consumers are not logged,"Hey folks!

I don't know if it the desired behaviour but I noticed that when a grain receives a message and it throw an exception it doesn't even write a a Warning log. It just swallow the exception:

![image](https://user-images.githubusercontent.com/4714040/49260064-059ce080-f423-11e8-916d-8db9ec5da8f0.png)

If I set ) but not on the processing method...

Any thoughts?","Exceptions on stream consumers are not logged Hey folks!

I don't know if it the desired behaviour but I noticed that when a grain receives a message and it throw an exception it doesn't even write a a Warning log. It just swallow the exception:

![image](https://user-images.githubusercontent.com/4714040/49260064-059ce080-f423-11e8-916d-8db9ec5da8f0.png)

If I set ) but not on the processing method...

Any thoughts?",,xiazen,,
5203,Handling canary deployments,"This is a new incarnation of an old subject we wrap our head against since starting to use Orleans some years ago :-) 
It's all about deployment strategies. 

A quick description of the problem - we build microservices that use Orleans as their infrastructure. Each microservice is a separate Orleans cluster (with several silos on several machines).
To reduce deployment risks we would like to use canary deployments. Meaning deploy a new version of the service switch a portion of the traffic to it (1% 5%) monitor for differences in behavior if all is well switch to the new version. 

This is a deployment strategy that works well with stateless services. But when using Orleans there are multiple obstacles - 

- You cannot randomly switch traffic. Since you have stateful grains you need to be able to switch a portion of the traffic according to a specific identifier that can signify the grains that are used (so all requests for certain grains ends up in the same cluster - prod or canary). Otherwise you have multiple activation and stale states.

- What do you do if there is no consistent identifier that you can route on for all the methods the service exposes? What if you identify the ""id"" only in the middle of handling the request in the service?

- What if you need to switch off the canary? Some grains were already instantiated in the canary cluster but they might be also active in the prod cluster. Now traffic will go again to prod possibly to the old grains and again you have stale state.

I don't think that the grain versioning feature answers this problem fully. I'm wondering if anyone else tried to handle this or what are the deployment strategies that are actually used in production for high scale systems that are running on Orleans. 
","Handling canary deployments This is a new incarnation of an old subject we wrap our head against since starting to use Orleans some years ago :-) 
It's all about deployment strategies. 

A quick description of the problem - we build microservices that use Orleans as their infrastructure. Each microservice is a separate Orleans cluster (with several silos on several machines).
To reduce deployment risks we would like to use canary deployments. Meaning deploy a new version of the service switch a portion of the traffic to it (1% 5%) monitor for differences in behavior if all is well switch to the new version. 

This is a deployment strategy that works well with stateless services. But when using Orleans there are multiple obstacles - 

- You cannot randomly switch traffic. Since you have stateful grains you need to be able to switch a portion of the traffic according to a specific identifier that can signify the grains that are used (so all requests for certain grains ends up in the same cluster - prod or canary). Otherwise you have multiple activation and stale states.

- What do you do if there is no consistent identifier that you can route on for all the methods the service exposes? What if you identify the ""id"" only in the middle of handling the request in the service?

- What if you need to switch off the canary? Some grains were already instantiated in the canary cluster but they might be also active in the prod cluster. Now traffic will go again to prod possibly to the old grains and again you have stale state.

I don't think that the grain versioning feature answers this problem fully. I'm wondering if anyone else tried to handle this or what are the deployment strategies that are actually used in production for high scale systems that are running on Orleans. 
",question,sergeybykov,,
5202,Requests to old silo incarnation,"Hi

I just had the following scenario:

A silo was restarted (IP 10.0.0.46) and it was correctly updated in the membership table (MongoDB):

![membership table](https://user-images.githubusercontent.com/1236435/49216292-03a73300-f3cb-11e8-9833-b7c865dc1446.PNG)

The orleans dashboard only shows the new incarnation of this silo:

![dashboard](https://user-images.githubusercontent.com/1236435/49216319-128de580-f3cb-11e8-8205-f52865bb62dd.PNG)

Then I see a lot of exceptions like



It stopped after I terminated this node. The new node got a new IP and everything was fine.

It could be a bug in the MongoDB Membership Table but I am confused why everything else looks good.

","Requests to old silo incarnation Hi

I just had the following scenario:

A silo was restarted (IP 10.0.0.46) and it was correctly updated in the membership table (MongoDB):

![membership table](https://user-images.githubusercontent.com/1236435/49216292-03a73300-f3cb-11e8-9833-b7c865dc1446.PNG)

The orleans dashboard only shows the new incarnation of this silo:

![dashboard](https://user-images.githubusercontent.com/1236435/49216319-128de580-f3cb-11e8-8205-f52865bb62dd.PNG)

Then I see a lot of exceptions like



It stopped after I terminated this node. The new node got a new IP and everything was fine.

It could be a bug in the MongoDB Membership Table but I am confused why everything else looks good.

",,sergeybykov,,
5200,SiloHostBuilder not validating GrainCollectionOptions during build,"**Repro code:**



**Expected behavior**
The call to siloHostBuilder.Build() should throw an exception because the specified TimeSpan for options.Collection age is less than 1 minute.

**Actual behavior**
The call to siloHostBuilder.Build() succeeds however activations will fail because the TimeSpan is less than 1 minutes.  Moreover when the runtime throws the exception on the silo when the activation fails the exception never reaches the client which made the initial request to the cluster and the client experiences a timeout.","SiloHostBuilder not validating GrainCollectionOptions during build **Repro code:**



**Expected behavior**
The call to siloHostBuilder.Build() should throw an exception because the specified TimeSpan for options.Collection age is less than 1 minute.

**Actual behavior**
The call to siloHostBuilder.Build() succeeds however activations will fail because the TimeSpan is less than 1 minutes.  Moreover when the runtime throws the exception on the silo when the activation fails the exception never reaches the client which made the initial request to the cluster and the client experiences a timeout.",,xiazen,,
5197, transactional multiple read/write tests,Added golden path tests for multiple transactional reads and writes within a single transaction, transactional multiple read/write tests Added golden path tests for multiple transactional reads and writes within a single transaction,,xiazen,,
5196,Ignored RegisterAsStreamProducer error on EventHub streams,"Hi. Im testing EventHub stream providers on high throughputs with a lot streams. (32k).
I observed when launching my orleans on existing eventhub with populated data (32 partitions 1000 partionsKeys per partition) that orleans spams my pubsub storage on blob azure and get a lot errors. Orleans works further and im ending up with a lot of streams not being processed due to this errors because they are never retried.
I changed this to MemoryStorage and that part pass with success but then errors occur on loading grain states (initial check as i doesn't have any grain saved yet). 
My questions are:
1. If Orleans has some retry mechanism for getting pubsub storage and grain state storage?
2. Why Orleans spam pubsub storage when using Implicit subscription? What is purpose for that? ","Ignored RegisterAsStreamProducer error on EventHub streams Hi. Im testing EventHub stream providers on high throughputs with a lot streams. (32k).
I observed when launching my orleans on existing eventhub with populated data (32 partitions 1000 partionsKeys per partition) that orleans spams my pubsub storage on blob azure and get a lot errors. Orleans works further and im ending up with a lot of streams not being processed due to this errors because they are never retried.
I changed this to MemoryStorage and that part pass with success but then errors occur on loading grain states (initial check as i doesn't have any grain saved yet). 
My questions are:
1. If Orleans has some retry mechanism for getting pubsub storage and grain state storage?
2. Why Orleans spam pubsub storage when using Implicit subscription? What is purpose for that? ",,jason-bragg,,
5195,dotnet build fails with error MSB4062 on sdk 2.1.500,"Hey guys

I've created a Silo on .NET SDK 2.1.500 and I'm encountering a build error when using the  without success.

Am I doing something wrong or is there a known workaround? 

Any help appreciated!
","dotnet build fails with error MSB4062 on sdk 2.1.500 Hey guys

I've created a Silo on .NET SDK 2.1.500 and I'm encountering a build error when using the  without success.

Am I doing something wrong or is there a known workaround? 

Any help appreciated!
",,ReubenBond,,
5189,Question: Can an IGrainService or IGrainServiceClient be called from an Orleans Client?,"Can an IGrainService or IGrainServiceClient be called from an Orleans Client or is it only accessible within a silo?

Can I get a handle to an IGrainService via clusterClient.GetGrain<T>?

","Question: Can an IGrainService or IGrainServiceClient be called from an Orleans Client? Can an IGrainService or IGrainServiceClient be called from an Orleans Client or is it only accessible within a silo?

Can I get a handle to an IGrainService via clusterClient.GetGrain<T>?

",question,sergeybykov,,
5188,Cleanup Transaction Agent,#NAME?,Cleanup Transaction Agent - Reduced linq usages and allocations.,,ReubenBond,,
5187,EventHubStreamProvider run out for memory,"Hi. I did adaptation of EventHubStreamProvider to read from EventHubs external messages.
It works and im getting messages.
Then i run load test running silo on VM machine with 16 GB rams. 
I populated EventHub with huge amount of small messages and then run Orleans - with grain attached to the Stream. Grain is StatelessWorker. Grain just receive messages and return Task.CompletedTask. 
I get something around 45-50k reuqests/s on that grain and that was great. But i noticed that the memory on VM machine quickly grow to 14-15 GB and then my VM starts to be unresponsive orleans dashboard hangs and orleans console start signaling that requests cannot be completed. I wait a long time but situation never changed - memory was still overload and not cleaned. 

My grain:

Any thoughts about this? 
 ","EventHubStreamProvider run out for memory Hi. I did adaptation of EventHubStreamProvider to read from EventHubs external messages.
It works and im getting messages.
Then i run load test running silo on VM machine with 16 GB rams. 
I populated EventHub with huge amount of small messages and then run Orleans - with grain attached to the Stream. Grain is StatelessWorker. Grain just receive messages and return Task.CompletedTask. 
I get something around 45-50k reuqests/s on that grain and that was great. But i noticed that the memory on VM machine quickly grow to 14-15 GB and then my VM starts to be unresponsive orleans dashboard hangs and orleans console start signaling that requests cannot be completed. I wait a long time but situation never changed - memory was still overload and not cleaned. 

My grain:

Any thoughts about this? 
 ",,jason-bragg,,
5185,Invoke silo.StopAsync() to an infinite loop,"Invoke silo.StopAsync() to an infinite loop

![image](https://user-images.githubusercontent.com/28291464/48750862-53e01000-ecbc-11e8-8b16-26e0c9faab60.png)
","Invoke silo.StopAsync() to an infinite loop Invoke silo.StopAsync() to an infinite loop

![image](https://user-images.githubusercontent.com/28291464/48750862-53e01000-ecbc-11e8-8b16-26e0c9faab60.png)
",,benjaminpetit,,
5183,More graceful graceful shutdowns,"Orleans version: **2.1.2**

I've been experimenting with rolling upgrades (primarily in Kubernetes) and have noticed some inconsistent behaviour when shutting silos down gracefully (calling ISiloHost.StopAsync()). It is not specific to running in containers though the same behaviour can be observed in console applications.

Note: Generally Orleans does what is advertised on the box but I do feel that graceful shutdowns could be more consistent and ... well more graceful. Even if that means that graceful shutdown would be slower/consist of more phases.

It would be great if errors can be avoided completely when all shutdowns are graceful as is the case with rolling upgrades. This is particularly important when end users interact with grains - long pauses affecting some users during rolling upgrades are not ideal.

To help visualise these I've attached a simple solution consisting of two console apps:
* GracefulShutdownReproSiloHost is the host which should be run a few times to start up a couple of silos.
* GracefulShutdownReproUI requests state and displays placement for 100 grains once per second.

With a few silos running and while watching the UI gracefully shut down a silo by pressing Ctrl+C in its console window.

Some non-ideal behaviours I've observed:
* Spamming the logs with warnings related to shutting down (would it not be better to either avoid these or suppress these as they seem to be just noise?):

* Sometimes a shutdown will result in very quick movement of all grains to different silos bar one or two. The calls to the grains that did not move quickly will not time out but could take 5-10 seconds before they return successfully.
* Sometimes requests to a fair number of grains (those where the silo that was gracefully shut down was the grain directory master) will take about 10 seconds to return with or without warnings logged in the client app and/or by other silos. These are often easier to demonstrate with 2 silos via shutting down one of them as more grains are affected but the behaviour is similar with higher numbers of silos.

PS. When the UI console app runs out of colours just restart it.

[GracefulShutdownRepro.zip](https://github.com/dotnet/orleans/files/2595625/GracefulShutdownRepro.zip)","More graceful graceful shutdowns Orleans version: **2.1.2**

I've been experimenting with rolling upgrades (primarily in Kubernetes) and have noticed some inconsistent behaviour when shutting silos down gracefully (calling ISiloHost.StopAsync()). It is not specific to running in containers though the same behaviour can be observed in console applications.

Note: Generally Orleans does what is advertised on the box but I do feel that graceful shutdowns could be more consistent and ... well more graceful. Even if that means that graceful shutdown would be slower/consist of more phases.

It would be great if errors can be avoided completely when all shutdowns are graceful as is the case with rolling upgrades. This is particularly important when end users interact with grains - long pauses affecting some users during rolling upgrades are not ideal.

To help visualise these I've attached a simple solution consisting of two console apps:
* GracefulShutdownReproSiloHost is the host which should be run a few times to start up a couple of silos.
* GracefulShutdownReproUI requests state and displays placement for 100 grains once per second.

With a few silos running and while watching the UI gracefully shut down a silo by pressing Ctrl+C in its console window.

Some non-ideal behaviours I've observed:
* Spamming the logs with warnings related to shutting down (would it not be better to either avoid these or suppress these as they seem to be just noise?):

* Sometimes a shutdown will result in very quick movement of all grains to different silos bar one or two. The calls to the grains that did not move quickly will not time out but could take 5-10 seconds before they return successfully.
* Sometimes requests to a fair number of grains (those where the silo that was gracefully shut down was the grain directory master) will take about 10 seconds to return with or without warnings logged in the client app and/or by other silos. These are often easier to demonstrate with 2 silos via shutting down one of them as more grains are affected but the behaviour is similar with higher numbers of silos.

PS. When the UI console app runs out of colours just restart it.

[GracefulShutdownRepro.zip](https://github.com/dotnet/orleans/files/2595625/GracefulShutdownRepro.zip)",,benjaminpetit,,
5182,Message broadcasting,"Normally when a message is published into a stream is received by one grain that as subscribed that stream.
There is any stream provider that does broadcasting to all grain that has subscribed that channel ?","Message broadcasting Normally when a message is published into a stream is received by one grain that as subscribed that stream.
There is any stream provider that does broadcasting to all grain that has subscribed that channel ?",question,sergeybykov,,
5181,How to Serialize/Deserilize DataTable?,"I wrote an interface like this:

and I wrote a grain then.
When I call this method in a garin client the exception occured:
>System.InvalidCastException: Unable to cast object of type 'Orleans.Serialization.SerializationContext' to type 'System.IConvertible'.

Now I have to convert the DataTable to  a IEnumerable<IDictionary<stringobject>> to make it work.
I wonder if there's a graceful way to handle it.","How to Serialize/Deserilize DataTable? I wrote an interface like this:

and I wrote a grain then.
When I call this method in a garin client the exception occured:
>System.InvalidCastException: Unable to cast object of type 'Orleans.Serialization.SerializationContext' to type 'System.IConvertible'.

Now I have to convert the DataTable to  a IEnumerable<IDictionary<stringobject>> to make it work.
I wonder if there's a graceful way to handle it.",question,sergeybykov,,
5180,Missing Grain Activations,"I'm experiencing an issue where a grain is sometimes not activating frustratingly consistently always skipping the activation that is critical to the application. I've had this issue in both 2.0.4 and 2.1.2. Clients and silos are both in the same process and yes this is occurring when there's only one process running in the environment (which is a Windows Service on Windows Server 2012 R2 .NET Framework 4.6.1 with .NET Core 2.1.302 and SQL Server storage).

I'm getting and calling the method on the grain on what is basically an inherited event handler from a base class. While debugging with breakpoints I can see the particular event come in to the handler and go over the lines to get and call the grain. The actual type of . There are other situations where I easily get more than 6 unique activations at once.

I've checked logs (I have both Microsoft.Extensions.Logging.Debug and Microsoft.Extensions.Logging.EventLog ILogger implementations added) and I'm not seeing any errors.
[orleans_log.txt](https://github.com/dotnet/orleans/files/2594380/orleans_log.txt)","Missing Grain Activations I'm experiencing an issue where a grain is sometimes not activating frustratingly consistently always skipping the activation that is critical to the application. I've had this issue in both 2.0.4 and 2.1.2. Clients and silos are both in the same process and yes this is occurring when there's only one process running in the environment (which is a Windows Service on Windows Server 2012 R2 .NET Framework 4.6.1 with .NET Core 2.1.302 and SQL Server storage).

I'm getting and calling the method on the grain on what is basically an inherited event handler from a base class. While debugging with breakpoints I can see the particular event come in to the handler and go over the lines to get and call the grain. The actual type of . There are other situations where I easily get more than 6 unique activations at once.

I've checked logs (I have both Microsoft.Extensions.Logging.Debug and Microsoft.Extensions.Logging.EventLog ILogger implementations added) and I'm not seeing any errors.
[orleans_log.txt](https://github.com/dotnet/orleans/files/2594380/orleans_log.txt)",,sergeybykov,,
5179,How to deal with the relationship between the gateway and transmission entity？,"Main Silo (gateway) seems to be quoted all transport entities or the gateway will throw an exception.

If so in the development each time a colleague modify transport entities to restart gateway?

","How to deal with the relationship between the gateway and transmission entity？ Main Silo (gateway) seems to be quoted all transport entities or the gateway will throw an exception.

If so in the development each time a colleague modify transport entities to restart gateway?

",question,sergeybykov,,
5178,Expedite type map refresh after cluster membership change,"When a silo joins a cluster the cluster type map on other silos is not refreshed immediately.

This means that there is a delay between a new silo joining and the time that other silos begin placing grains on that new silo.

Emile van Reenen inquired about this on Gitter: https://gitter.im/dotnet/orleans?at=5bed7ef392b7d11721924cd5
","Expedite type map refresh after cluster membership change When a silo joins a cluster the cluster type map on other silos is not refreshed immediately.

This means that there is a delay between a new silo joining and the time that other silos begin placing grains on that new silo.

Emile van Reenen inquired about this on Gitter: https://gitter.im/dotnet/orleans?at=5bed7ef392b7d11721924cd5
",,benjaminpetit,,
5177,Expected request rate to OrleansSilos table,"What rate/volume of requests can be expected to the OrleansSilos table?

Context:
We have a dev environment setup using DynamoDB for primary storage and for clustering. We are using default grain membership configuration. To save costs we have the provisioning limit set very low. We observed that with only a few users hitting the system we were hitting throttling on read requests to the OrleansSilos table.
One thing that might be impacting our workload is using  on a regular basis.

We can certainly increase the provisioning but are a bit concerned about how those accesses might scale.","Expected request rate to OrleansSilos table What rate/volume of requests can be expected to the OrleansSilos table?

Context:
We have a dev environment setup using DynamoDB for primary storage and for clustering. We are using default grain membership configuration. To save costs we have the provisioning limit set very low. We observed that with only a few users hitting the system we were hitting throttling on read requests to the OrleansSilos table.
One thing that might be impacting our workload is using  on a regular basis.

We can certainly increase the provisioning but are a bit concerned about how those accesses might scale.",question,sergeybykov,,
5176,Update compatible_grains.md,,Update compatible_grains.md ,,benjaminpetit,,
5175,Lock worker error handling improvements,,Lock worker error handling improvements ,,xiazen,,
5173,SMS stream resending last message to new subscribers,"A feature that I would really like to see implemented in SMS streams is the configurable option to have the stream resend the ""most-recently-sent"" message to any NEW subscriber.

In other words the stream would keep a copy of the last message sent on that stream and immediately send it when a NEW subscription is made just to that new subscription.

In this way messages can be sent periodically (or rarely) on an SMS stream and new subscribers can be brought immediately up to date with the last-sent-message when they subscribe without any extra plumbing code.

For my use case the ""last-sent-message"" would not need to be persisted. It could be just kept in memory but I see the advantage and disadvantages of storing it as well. If the SMS stream is having messages sent rapidly it would ""slow down"" the stream by writing every message to storage before sending it so if storage is to be used there may have to be some configuration regarding the ""max write rate"" to keep the stream running optimally at high messaging rates.

Can we add this feature to SMS streams? ","SMS stream resending last message to new subscribers A feature that I would really like to see implemented in SMS streams is the configurable option to have the stream resend the ""most-recently-sent"" message to any NEW subscriber.

In other words the stream would keep a copy of the last message sent on that stream and immediately send it when a NEW subscription is made just to that new subscription.

In this way messages can be sent periodically (or rarely) on an SMS stream and new subscribers can be brought immediately up to date with the last-sent-message when they subscribe without any extra plumbing code.

For my use case the ""last-sent-message"" would not need to be persisted. It could be just kept in memory but I see the advantage and disadvantages of storing it as well. If the SMS stream is having messages sent rapidly it would ""slow down"" the stream by writing every message to storage before sending it so if storage is to be used there may have to be some configuration regarding the ""max write rate"" to keep the stream running optimally at high messaging rates.

Can we add this feature to SMS streams? ",,sergeybykov,,
5172,Failure to use stream providers with EventSequenceTokenV2,"Hey folks!

After migrate some codebase that worked properly using SMS _streams_ to AWS SQS provider I got this exception when trying to send/receive messages (both on client and silo):



That unblocked us but it would be nice to get it fixed as it is an internal type from the runtime. I wonder if the codegen isn't generating code for it or if it does the assembly isn't being loaded by it.

For reference we are on Orleans 2.1.2 using the new source-to-source build time codegen.

Thanks!

","Failure to use stream providers with EventSequenceTokenV2 Hey folks!

After migrate some codebase that worked properly using SMS _streams_ to AWS SQS provider I got this exception when trying to send/receive messages (both on client and silo):



That unblocked us but it would be nice to get it fixed as it is an internal type from the runtime. I wonder if the codegen isn't generating code for it or if it does the assembly isn't being loaded by it.

For reference we are on Orleans 2.1.2 using the new source-to-source build time codegen.

Thanks!

",,ReubenBond,,
5171,Is't possible to access TransactionalState in non-transactional method?,"I asked at [gitter](https://gitter.im/dotnet/orleans)
","Is't possible to access TransactionalState in non-transactional method? I asked at [gitter](https://gitter.im/dotnet/orleans)
",question,jason-bragg,,
5170,Add SubscriptionObserverWithImplicitSubscribingGrainTests,add tests cover ISubscriptionObserver used with ImplicitSubsribe,Add SubscriptionObserverWithImplicitSubscribingGrainTests add tests cover ISubscriptionObserver used with ImplicitSubsribe,,jason-bragg,,
5169,[Question] Writing to storage performance,"Hi everyone! I have following scenario: ClusterClient read events from EventHub and then send them to the Orleans. One grain takes those batches groups them by the key and then send to the second grain which writes to Blob Storage (append blob - one blob for one key). 

I have implementation of this (stateless workers) and everything works fine when key granularity is low. (we make less connection to blobs writing grouped batches). 

But when granularity of key grow (for example in worst scenario we can have one event - one key) bad things start happen and everything chocks up. I understand that this is due to almost one event - one write to blob but i wonder what optimizations can be done here to improve this. 

I tried raising DefaultConnectionLimit play with number of activation of statlessworkers but i can't go beyond of 250 messages per second on single machine (Azure Standard F8s_v2 (8 vcpus 16 GB memory)). This is with default settings. 

To contrast that when i choose one single key to write everything to the same blob in batches (exact same batch which was received in EventHubProccesorHost) i can achieve 25k messages per second on the same machine and have almost half cpu % reserve. Of course the number of writes to the blob storage is far less than 25k messages as single write has up to 1024 messages).
Quotas on blob storage says that it can achieve 20k requests per second. 
Do you have idea how to improve this? How many concurrent connection to the blob one single machine can achieve?

big picture:

![orleanstopology](https://user-images.githubusercontent.com/4254758/48219499-f5966180-e38c-11e8-9cb0-ccfee0b4cd7c.png)

Few notes: 
- Everything is async/await","[Question] Writing to storage performance Hi everyone! I have following scenario: ClusterClient read events from EventHub and then send them to the Orleans. One grain takes those batches groups them by the key and then send to the second grain which writes to Blob Storage (append blob - one blob for one key). 

I have implementation of this (stateless workers) and everything works fine when key granularity is low. (we make less connection to blobs writing grouped batches). 

But when granularity of key grow (for example in worst scenario we can have one event - one key) bad things start happen and everything chocks up. I understand that this is due to almost one event - one write to blob but i wonder what optimizations can be done here to improve this. 

I tried raising DefaultConnectionLimit play with number of activation of statlessworkers but i can't go beyond of 250 messages per second on single machine (Azure Standard F8s_v2 (8 vcpus 16 GB memory)). This is with default settings. 

To contrast that when i choose one single key to write everything to the same blob in batches (exact same batch which was received in EventHubProccesorHost) i can achieve 25k messages per second on the same machine and have almost half cpu % reserve. Of course the number of writes to the blob storage is far less than 25k messages as single write has up to 1024 messages).
Quotas on blob storage says that it can achieve 20k requests per second. 
Do you have idea how to improve this? How many concurrent connection to the blob one single machine can achieve?

big picture:

![orleanstopology](https://user-images.githubusercontent.com/4254758/48219499-f5966180-e38c-11e8-9cb0-ccfee0b4cd7c.png)

Few notes: 
- Everything is async/await",,sergeybykov,,
5167,Fix test cluster deploy deadlock,Fixes https://github.com/dotnet/orleans/issues/5166  but has some breacking changes public test APIs,Fix test cluster deploy deadlock Fixes https://github.com/dotnet/orleans/issues/5166  but has some breacking changes public test APIs,,benjaminpetit,,
5166,Orleans TestCluster Deploy causes deadlock with xUnit,"In case of trying run TestCluster Deploy parallel with xUnit deadlock occured.

Steps to reproduce:
1) Create as many simple classes as you have logical processors or more (i.e i have 8 logical processors i need to create 8 or more same classes)

2) Run all tests from created classes with xUnit

Result: deadlock at https://github.com/dotnet/orleans/blob/master/src/Orleans.TestingHost/InProcessSiloHandle.cs#L34

I think xUnit custom SyncronizationContext not allows such way of executing async metod result. I have solution with full async flow but it can break public testing API.","Orleans TestCluster Deploy causes deadlock with xUnit In case of trying run TestCluster Deploy parallel with xUnit deadlock occured.

Steps to reproduce:
1) Create as many simple classes as you have logical processors or more (i.e i have 8 logical processors i need to create 8 or more same classes)

2) Run all tests from created classes with xUnit

Result: deadlock at https://github.com/dotnet/orleans/blob/master/src/Orleans.TestingHost/InProcessSiloHandle.cs#L34

I think xUnit custom SyncronizationContext not allows such way of executing async metod result. I have solution with full async flow but it can break public testing API.",,benjaminpetit,,
5165,[Question] EventStore Read-only stream adapter,"Hi. Im trying use Orleans for CQRS - EventSource pattern. I want grains to persist their state in EventStore.
That part is pretty obvious - we can use OnActivate and load all neccesery events and build Grain State.
But when Grain publish new Event to the EventStore we want to subscribe to this events in other Grains and it seems that great option is use Orleans Streams with own custom adapter which is read-only and read via subscriptions new events from EventStore streams and pushes them to the subscribed grains.
I want to try write this stream adapter. 
My first concern is - a queueID and it's concept and how this should map to the EventStore inftrastrucute. 
EventStore only contains streams - we can subscribe to them. How to achieve this with QueueID concept in Orleans? It should be one queue for each stream? What piece of code decide how many queues will be created? Can anyone guide me here? 
","[Question] EventStore Read-only stream adapter Hi. Im trying use Orleans for CQRS - EventSource pattern. I want grains to persist their state in EventStore.
That part is pretty obvious - we can use OnActivate and load all neccesery events and build Grain State.
But when Grain publish new Event to the EventStore we want to subscribe to this events in other Grains and it seems that great option is use Orleans Streams with own custom adapter which is read-only and read via subscriptions new events from EventStore streams and pushes them to the subscribed grains.
I want to try write this stream adapter. 
My first concern is - a queueID and it's concept and how this should map to the EventStore inftrastrucute. 
EventStore only contains streams - we can subscribe to them. How to achieve this with QueueID concept in Orleans? It should be one queue for each stream? What piece of code decide how many queues will be created? Can anyone guide me here? 
",question,sergeybykov,,
5164,[Question] The case for Orleans streams,"Hello colleagues

I'm evaluating the usage of  is primarily designed to have a lot of relatively small streams and in cases where we have a small number of event types and large number of consumers we need to distribute such work by creating a lot of streams?

Thanks. ","[Question] The case for Orleans streams Hello colleagues

I'm evaluating the usage of  is primarily designed to have a lot of relatively small streams and in cases where we have a small number of event types and large number of consumers we need to distribute such work by creating a lot of streams?

Thanks. ",question,sergeybykov,,
5163,OrleansMessageRejectionException Forwarding failure,"Orleans 1.5.0

 call.","OrleansMessageRejectionException Forwarding failure Orleans 1.5.0

 call.",,sergeybykov,,
5162,cannot call from inside of grain,"It could look like dumb but I could not solve the problem and found nowhere but here to ask.

I'm planning to use the Orleans and testing some simple codes.
The Grain implementation is something similar to the codes to this.


I could see ""SecondCall called"". but couldn't see ""Responded"".
I tried to get some informations from debug log but there was nothing (at least on my thought).
Could you help me out?","cannot call from inside of grain It could look like dumb but I could not solve the problem and found nowhere but here to ask.

I'm planning to use the Orleans and testing some simple codes.
The Grain implementation is something similar to the codes to this.


I could see ""SecondCall called"". but couldn't see ""Responded"".
I tried to get some informations from debug log but there was nothing (at least on my thought).
Could you help me out?",question,sergeybykov,,
5161,The orleans client connection to the silo often occurs timeout,"I have developed a product using the Orleans .net core version which uses .net core
 webapi is connected to Silo(server side) as a client. Unfortunately some problems occurred after the product went online that is the orleans client connect to the silo often (about every half a day) occurs timeout.The following error messages appear in the log:



Have you encountered this situation? Is the way I use the client and server as it is correct? 
I am looking forward to your help so that I can solve this problem as soon as possible.Thank you.","The orleans client connection to the silo often occurs timeout I have developed a product using the Orleans .net core version which uses .net core
 webapi is connected to Silo(server side) as a client. Unfortunately some problems occurred after the product went online that is the orleans client connect to the silo often (about every half a day) occurs timeout.The following error messages appear in the log:



Have you encountered this situation? Is the way I use the client and server as it is correct? 
I am looking forward to your help so that I can solve this problem as soon as possible.Thank you.",,sergeybykov,,
5160,The SocketAsyncEventArgs.Buffer is not cleared when it's returned to the pool.,"The Buffer of the SocketAsyncEventArgs is not cleared when it's returned to the pool. When this args is used for the next time the old buffer which may contains the legacy data will still be passed to IncomingMessageBuffer.UpdateReceivedData. Then if the IncomingMessageBuffer wanted to read ""e.BytesTransferred"" bytes from the Buffer it might get the old message.

This code should be added to the method below.


https://github.com/dotnet/orleans/blob/6b802f6365e78d691430360a4101b1993eb7afee/src/Orleans.Runtime/Messaging/IncomingMessageAcceptor.cs#L441

==

Update: There could be another bug in .net core runtime on linux. After I called SetBuffer and when it triggered the OnCompleted event the BytesTransferred is not zero but the args.Offset is zero.

Maybe it could be solved if we don't use a pool","The SocketAsyncEventArgs.Buffer is not cleared when it's returned to the pool. The Buffer of the SocketAsyncEventArgs is not cleared when it's returned to the pool. When this args is used for the next time the old buffer which may contains the legacy data will still be passed to IncomingMessageBuffer.UpdateReceivedData. Then if the IncomingMessageBuffer wanted to read ""e.BytesTransferred"" bytes from the Buffer it might get the old message.

This code should be added to the method below.


https://github.com/dotnet/orleans/blob/6b802f6365e78d691430360a4101b1993eb7afee/src/Orleans.Runtime/Messaging/IncomingMessageAcceptor.cs#L441

==

Update: There could be another bug in .net core runtime on linux. After I called SetBuffer and when it triggered the OnCompleted event the BytesTransferred is not zero but the args.Offset is zero.

Maybe it could be solved if we don't use a pool",,jason-bragg,,
5158,Client connection using AdoNetClustering  fails on Docker container,"- Used Orleans 2.1.0. 
- Run on .NET Core 2.1 Docker linux container.

[orleans.log](https://github.com/dotnet/orleans/files/2542565/orleans.log)
(frontend is Orleans Client app. backend is silo. Db is Postgresql)

Using StaticClustering configuration runs perfectly.

I saw an issue similar with this at https://github.com/Azure/service-fabric-issues/issues/1182","Client connection using AdoNetClustering  fails on Docker container - Used Orleans 2.1.0. 
- Run on .NET Core 2.1 Docker linux container.

[orleans.log](https://github.com/dotnet/orleans/files/2542565/orleans.log)
(frontend is Orleans Client app. backend is silo. Db is Postgresql)

Using StaticClustering configuration runs perfectly.

I saw an issue similar with this at https://github.com/Azure/service-fabric-issues/issues/1182",,benjaminpetit,,
5157,Is it possible to cross the LAN,"I wonder if the two lans can communicate with him
I've tried non-reliable deployments and the problem is that my primary repository can only use UseLocalhostClustering() which is 127.0.0.1 and seems inaccessible to outsiders","Is it possible to cross the LAN I wonder if the two lans can communicate with him
I've tried non-reliable deployments and the problem is that my primary repository can only use UseLocalhostClustering() which is 127.0.0.1 and seems inaccessible to outsiders",question,sergeybykov,,
5156,System.NotSupportedException: Call cannot be made outside of a transaction.  ,i use interceptor and transactionsit runs wrong. how do i solve thank you,System.NotSupportedException: Call cannot be made outside of a transaction.   i use interceptor and transactionsit runs wrong. how do i solve thank you,,jason-bragg,,
5155,add tests to the transactional state storage test kit,Adds a bunch of tests. This is not necessarily a complete suite yet but it covers much of the (prepare/confirm/cancel) logic including some batching.,add tests to the transactional state storage test kit Adds a bunch of tests. This is not necessarily a complete suite yet but it covers much of the (prepare/confirm/cancel) logic including some batching.,,jason-bragg,,
5149,Internal transactional states are now immutable,Internal transactional states are now immutable outside transactional operations.,Internal transactional states are now immutable Internal transactional states are now immutable outside transactional operations.,,xiazen,,
5147,Unexpected token 'Error' introducing type specifier when calling grain method. ,"Hi! Im getting
""Unexpected token 'Error' introducing type specifier "" every time when i call method Recieve on my grain  which have following signature:



Grain has  [StatelessWorker] and [Reentrant] attributes.

Other method which has simplier signature:

 Task<string> SayHello(string greetings) works ok.

Do you know what can cause this? Is there any limitation if comes to data contract? ","Unexpected token 'Error' introducing type specifier when calling grain method.  Hi! Im getting
""Unexpected token 'Error' introducing type specifier "" every time when i call method Recieve on my grain  which have following signature:



Grain has  [StatelessWorker] and [Reentrant] attributes.

Other method which has simplier signature:

 Task<string> SayHello(string greetings) works ok.

Do you know what can cause this? Is there any limitation if comes to data contract? ",question,sergeybykov,,
5146,Make the logs to print more clear Grain/Interface identity.,"I'm trying to diagnose several performance issues like _from nothing_ the silo starts to eat 100% CPU and profiling on async code is a nightmare...

Thousands of those messages are printed when the scenario happens:

) is printed on it but we don't have it referenced anywhere in code being generated because codegen stores the interfaceId IIRC...

So what we are trying to do is to have a way to map those IDs to our grains so at our log server we can make it replace the IDs at the logs on-the-fly so it can help us detect issues.
","Make the logs to print more clear Grain/Interface identity. I'm trying to diagnose several performance issues like _from nothing_ the silo starts to eat 100% CPU and profiling on async code is a nightmare...

Thousands of those messages are printed when the scenario happens:

) is printed on it but we don't have it referenced anywhere in code being generated because codegen stores the interfaceId IIRC...

So what we are trying to do is to have a way to map those IDs to our grains so at our log server we can make it replace the IDs at the logs on-the-fly so it can help us detect issues.
",,benjaminpetit,,
5145,Fix call chain reentrancy,"Current behavior is to only allow call chain re-entrancy on A->B->A or A->A. This adds a new option for allowing A->B->C->A. Also flow the reentrancy context via RequestContext so that it can be viewed and serialized by the application layer.

* Refactor re-entrancy tests to use common code
* Change bool to enum in config and introduce new option CallChainReentrancyStrategy.EntireChain

Passes call chain tests. Sending an early version for feedback on the approach.

Remaining questions:
* Do we want to reconcile the code for Single Call and full call chain?
* Do we want to eliminate the option for single call (probably needs perf testing to determine impact)
* Still need to figure out logging in tests","Fix call chain reentrancy Current behavior is to only allow call chain re-entrancy on A->B->A or A->A. This adds a new option for allowing A->B->C->A. Also flow the reentrancy context via RequestContext so that it can be viewed and serialized by the application layer.

* Refactor re-entrancy tests to use common code
* Change bool to enum in config and introduce new option CallChainReentrancyStrategy.EntireChain

Passes call chain tests. Sending an early version for feedback on the approach.

Remaining questions:
* Do we want to reconcile the code for Single Call and full call chain?
* Do we want to eliminate the option for single call (probably needs perf testing to determine impact)
* Still need to figure out logging in tests",,benjaminpetit,,
5144,Document hosted client,Need to add a documentation page for #3362.,Document hosted client Need to add a documentation page for #3362.,documentation,ReubenBond,,
5142,Error: Extension not installed on grain attempting to invoke type OrleansCodeGenCancellationSourcesExtensionMethodInvoker,"During calling to GrainCancellationTokenSource.Cancel I have following error.
I use GrainCancellationToken for aborting long running operation. 
What is missing? Thanks

","Error: Extension not installed on grain attempting to invoke type OrleansCodeGenCancellationSourcesExtensionMethodInvoker During calling to GrainCancellationTokenSource.Cancel I have following error.
I use GrainCancellationToken for aborting long running operation. 
What is missing? Thanks

",,sergeybykov,,
5141,multi silos，how can i configure my client,"silo1=>port : 11111 gatewayport: 30000
silo2=>port : 11112 gatewayport: 30001( can i use the same gateway port?)
my silos/clients running on the same host.

_Originally posted by @leoterry-ulrica in https://github.com/dotnet/orleans/issues/4384#issuecomment-433624135_","multi silos，how can i configure my client silo1=>port : 11111 gatewayport: 30000
silo2=>port : 11112 gatewayport: 30001( can i use the same gateway port?)
my silos/clients running on the same host.

_Originally posted by @leoterry-ulrica in https://github.com/dotnet/orleans/issues/4384#issuecomment-433624135_",question,benjaminpetit,,
5140,GrainReference throwing `System.InvalidOperationException: Should be overridden by subclass` in GrainStorage.ReadStateAsync,,GrainReference throwing ,question,sergeybykov,,
5138,Does Orleans fit my case?,"Hello friends

sorry for posting a question here. I'd like to ask for some suggestions for my scenario and check if Orleans is a good fit for it. 
I have a bunch (about 30000-70000) of processing to perform and would like to split this among 5 high spec computers we have (16 processors 32GB RAM and SSD each).  The processing consists of creating a small input text file and send it to a 3rd party app that process it and return a string as result. This 3rd party app can eat some CPU sometimes it can take 1-3 seconds to process the input.
So the idea would be to create a Job list dispatch this and get the result as its happens. 

Do you thing Orleans is a good pick for this or would you recommend something else?

Thank you ","Does Orleans fit my case? Hello friends

sorry for posting a question here. I'd like to ask for some suggestions for my scenario and check if Orleans is a good fit for it. 
I have a bunch (about 30000-70000) of processing to perform and would like to split this among 5 high spec computers we have (16 processors 32GB RAM and SSD each).  The processing consists of creating a small input text file and send it to a 3rd party app that process it and return a string as result. This 3rd party app can eat some CPU sometimes it can take 1-3 seconds to process the input.
So the idea would be to create a Job list dispatch this and get the result as its happens. 

Do you thing Orleans is a good pick for this or would you recommend something else?

Thank you ",question,sergeybykov,,
5137,Exception of type 'zookeeper.KeeperException+NoNodeException' was thrown in Orleans client,"We use Orleans 2.0 to build orleans cluster by docker deployment: the docker containers contains: 3 silos containers 1 client container 3 zookeeper containers (used as membership table). There are 3 VMs to host containers. We ensure 3 silos are in separate vms(123) 3 zookeepers are in separate vms(123) 1 client is in vm1. 
Most time this cluster works well but sometimes (about one per week) client throws exception as follows:

> org.apache.zookeeper.KeeperException+NoNodeException: Exception of type 'org.apache.zookeeper.KeeperException+NoNodeException' was thrown. at org.apache.zookeeper.ZooKeeper.getDataAsync(String path Watcher watcher) at Orleans.Runtime.Membership.ZooKeeperBasedMembershipTable.GetRow(ZooKeeper zk SiloAddress siloAddress) at Orleans.Runtime.Membership.ZooKeeperBasedMembershipTable.<>c.<<ReadAll>b__11_0>d.MoveNext() --- End of stack trace from previous location where exception was thrown --- at org.apache.zookeeper.ZooKeeper.TryOperation[T](ZooKeeper zk Func2 zkMethod) at Orleans.Runtime.Membership.ZooKeeperClusteringClientOptions.GetGateways() at Orleans.Messaging.GatewayManager.RefreshSnapshotLiveGateways_TimerCallback(Object context)

We doubt if there is any dirty data in zookeeper node so that exception thrown when trying to retrieve active gateway list from zk but membership table are fully maintained by Orleans runtime (package 'Microsoft.Orleans.OrleansZooKeeperUtils' used is version 2.0.0). Could you please give some information what happened? Thanks!","Exception of type 'zookeeper.KeeperException+NoNodeException' was thrown in Orleans client We use Orleans 2.0 to build orleans cluster by docker deployment: the docker containers contains: 3 silos containers 1 client container 3 zookeeper containers (used as membership table). There are 3 VMs to host containers. We ensure 3 silos are in separate vms(123) 3 zookeepers are in separate vms(123) 1 client is in vm1. 
Most time this cluster works well but sometimes (about one per week) client throws exception as follows:

> org.apache.zookeeper.KeeperException+NoNodeException: Exception of type 'org.apache.zookeeper.KeeperException+NoNodeException' was thrown. at org.apache.zookeeper.ZooKeeper.getDataAsync(String path Watcher watcher) at Orleans.Runtime.Membership.ZooKeeperBasedMembershipTable.GetRow(ZooKeeper zk SiloAddress siloAddress) at Orleans.Runtime.Membership.ZooKeeperBasedMembershipTable.<>c.<<ReadAll>b__11_0>d.MoveNext() --- End of stack trace from previous location where exception was thrown --- at org.apache.zookeeper.ZooKeeper.TryOperation[T](ZooKeeper zk Func2 zkMethod) at Orleans.Runtime.Membership.ZooKeeperClusteringClientOptions.GetGateways() at Orleans.Messaging.GatewayManager.RefreshSnapshotLiveGateways_TimerCallback(Object context)

We doubt if there is any dirty data in zookeeper node so that exception thrown when trying to retrieve active gateway list from zk but membership table are fully maintained by Orleans runtime (package 'Microsoft.Orleans.OrleansZooKeeperUtils' used is version 2.0.0). Could you please give some information what happened? Thanks!",question,sergeybykov,,
5136,Using Microsoft.Orleans.ProtobufNet,"I have a question about the ProtobufNet serializer in orleans. I have tried to implement it but I could not find allot of documentation around using this within Orleans. I just want to make sure that what I have done is what is required to use this serializer. 

I am currently using Orleans 2.1 and from [this issue](https://github.com/dotnet/orleans/issues/4305) it looks like it is as simple as the steps below. 

1. I have installed **Microsoft.Orleans.ProtobufNet** package into both my Silo and client projects.
2. Added the following to the Silo and Client configuration


Is this all that is needed to use the ProtobufNet serializer ? Or Am I missing something.



","Using Microsoft.Orleans.ProtobufNet I have a question about the ProtobufNet serializer in orleans. I have tried to implement it but I could not find allot of documentation around using this within Orleans. I just want to make sure that what I have done is what is required to use this serializer. 

I am currently using Orleans 2.1 and from [this issue](https://github.com/dotnet/orleans/issues/4305) it looks like it is as simple as the steps below. 

1. I have installed **Microsoft.Orleans.ProtobufNet** package into both my Silo and client projects.
2. Added the following to the Silo and Client configuration


Is this all that is needed to use the ProtobufNet serializer ? Or Am I missing something.



",question,sergeybykov,,
5133,Add event on gateway count changed,"Based on gitter discussion with @ReubenBond 

Adds an event that the user can listen for changes in the gateway counts. Contains the current count of gateways as well as the previous count (to differentiate between gainin and losing gateways).

It's hard to test the reconnect situation. The only way I found so far to make a test that passes is included but it's not clean. I also had to implement a Reconnect functionality in the ClientMessageCenter for the test but it seems to not actually connect to any silos. The gateways reconnect and send the proper events but any grain requests after Reconnect time out. This makes me wonder if this is only a test cluster scenario (possibly due to faulty Reconnect implementation) or can it also happen in a regular cluster (which would make the entire event useless) 

TODO:
- [ ] Proper tests (need to figure out how to either fix the Reconnect in ClientMessageCenter or some other way of properly testing the reconnect situation)

- [x]  Whitespace cleanup ","Add event on gateway count changed Based on gitter discussion with @ReubenBond 

Adds an event that the user can listen for changes in the gateway counts. Contains the current count of gateways as well as the previous count (to differentiate between gainin and losing gateways).

It's hard to test the reconnect situation. The only way I found so far to make a test that passes is included but it's not clean. I also had to implement a Reconnect functionality in the ClientMessageCenter for the test but it seems to not actually connect to any silos. The gateways reconnect and send the proper events but any grain requests after Reconnect time out. This makes me wonder if this is only a test cluster scenario (possibly due to faulty Reconnect implementation) or can it also happen in a regular cluster (which would make the entire event useless) 

TODO:
- [ ] Proper tests (need to figure out how to either fix the Reconnect in ClientMessageCenter or some other way of properly testing the reconnect situation)

- [x]  Whitespace cleanup ",,ReubenBond,,
5132,Documentation: Connect/clarify client Observer documentation to Streaming,"I think next tuning of documentation would be helpful to many newcomers to Orleans

Now .


","Documentation: Connect/clarify client Observer documentation to Streaming I think next tuning of documentation would be helpful to many newcomers to Orleans

Now .


",documentation,sergeybykov,,
5131,local cluster shutdown stuck 30 second,"setup:

1. memory storage + local cluster
2. API gate + direct client + silo host in one process
3. orleans version: b0fa540

","local cluster shutdown stuck 30 second setup:

1. memory storage + local cluster
2. API gate + direct client + silo host in one process
3. orleans version: b0fa540

",,benjaminpetit,,
5130,Can i integrate with the NLog log component,I want to use the NLog component as my log provider.How can I achieve it? @ReubenBond  Thx,Can i integrate with the NLog log component I want to use the NLog component as my log provider.How can I achieve it? @ReubenBond  Thx,,xiazen,,
5127,Update https://dotnet.github.io/orleans/Documentation/grains/index.html,"1. Update 


","Update https://dotnet.github.io/orleans/Documentation/grains/index.html 1. Update 


",documentation,sergeybykov,25/10/2018 0:22,26/02/2019 9:40
5126, `Improve this Doc` link does not work on https://dotnet.github.io/orleans/Documentation,"
1. https://dotnet.github.io/orleans/Documentation/grains/index.html
2. Press  
3. https://github.com/dotnet/orleans/blob/gh-pages/src/Documentation/grains/index.md/#L1

Actual: Get 404
Expected: Editor"," 
3. https://github.com/dotnet/orleans/blob/gh-pages/src/Documentation/grains/index.md/#L1

Actual: Get 404
Expected: Editor",documentation,JillHeaden,,
5125,System.InvalidOperationException : No default ITransactionalStateStorageFactory nor IGrainStorage was found while attempting to create transactional state storage.,"var builder = new SiloHostBuilder()
                .Configure<ClusterOptions>(options =>
                {
                    options.ClusterId = ""dev"";
                    options.ServiceId = ""fiiipay"";
                })
                .UseLocalhostClustering()
                .Configure<EndpointOptions>(options => options.AdvertisedIPAddress = IPAddress.Loopback)
                .ConfigureApplicationParts(parts =>
                {
                    parts.AddApplicationPart(typeof(HelloGrain).Assembly).WithReferences();
                })
                .AddAdoNetGrainStorage(""store0""configureOptions =>
                {
                    configureOptions.ConnectionString =
                        ""Data Source=.;Database=FiiiPay.Account;Integrated Security=True;Pooling=False;Max Pool Size=200;"";
                    configureOptions.Invariant = ""System.Data.SqlClient"";
                })
                .AddAdoNetGrainStorage(""store1""configureOptions =>
                {
                    configureOptions.ConnectionString =
                        ""Data Source=.;Database=Test;Integrated Security=True;Pooling=False;Max Pool Size=200;"";
                    configureOptions.Invariant = ""System.Data.SqlClient"";
                })
                .UseTransactions(); 
this is my host code","System.InvalidOperationException : No default ITransactionalStateStorageFactory nor IGrainStorage was found while attempting to create transactional state storage. var builder = new SiloHostBuilder()
                .Configure<ClusterOptions>(options =>
                {
                    options.ClusterId = ""dev"";
                    options.ServiceId = ""fiiipay"";
                })
                .UseLocalhostClustering()
                .Configure<EndpointOptions>(options => options.AdvertisedIPAddress = IPAddress.Loopback)
                .ConfigureApplicationParts(parts =>
                {
                    parts.AddApplicationPart(typeof(HelloGrain).Assembly).WithReferences();
                })
                .AddAdoNetGrainStorage(""store0""configureOptions =>
                {
                    configureOptions.ConnectionString =
                        ""Data Source=.;Database=FiiiPay.Account;Integrated Security=True;Pooling=False;Max Pool Size=200;"";
                    configureOptions.Invariant = ""System.Data.SqlClient"";
                })
                .AddAdoNetGrainStorage(""store1""configureOptions =>
                {
                    configureOptions.ConnectionString =
                        ""Data Source=.;Database=Test;Integrated Security=True;Pooling=False;Max Pool Size=200;"";
                    configureOptions.Invariant = ""System.Data.SqlClient"";
                })
                .UseTransactions(); 
this is my host code",question,jason-bragg,,
5124,microsoft.orleans.codegenerator.msbuild build fail,"严重性	代码	说明	项目	文件	行	禁止显示状态
错误	MSB3073	命令“""dotnet"" ""C:\Users\thinkpad\.nuget\packages\microsoft.orleans.codegenerator.msbuild\2.1.2\build\..\tasks\netcoreapp2.0\Orleans.CodeGenerator.MSBuild.dll"" SourceToSource ""D:\aws-gitlab\dme\SH2018CP030\src\Dist.Product.Dme\Dist.Dme.Orleans.Interfaces\obj\x86\Debug\netcoreapp2.1\Dist.Dme.Orleans.Interfaces.orleans.g.args.txt""”已退出，代码为 3。	Dist.Dme.Orleans.Interfaces	C:\Users\thinkpad\.nuget\packages\microsoft.orleans.codegenerator.msbuild\2.1.2\build\Microsoft.Orleans.CodeGenerator.MSBuild.targets	122	

why? thx","microsoft.orleans.codegenerator.msbuild build fail 严重性	代码	说明	项目	文件	行	禁止显示状态
错误	MSB3073	命令“""dotnet"" ""C:\Users\thinkpad\.nuget\packages\microsoft.orleans.codegenerator.msbuild\2.1.2\build\..\tasks\netcoreapp2.0\Orleans.CodeGenerator.MSBuild.dll"" SourceToSource ""D:\aws-gitlab\dme\SH2018CP030\src\Dist.Product.Dme\Dist.Dme.Orleans.Interfaces\obj\x86\Debug\netcoreapp2.1\Dist.Dme.Orleans.Interfaces.orleans.g.args.txt""”已退出，代码为 3。	Dist.Dme.Orleans.Interfaces	C:\Users\thinkpad\.nuget\packages\microsoft.orleans.codegenerator.msbuild\2.1.2\build\Microsoft.Orleans.CodeGenerator.MSBuild.targets	122	

why? thx",,xiazen,,
5123,Cleaned up ping benchmark,,Cleaned up ping benchmark ,,benjaminpetit,,
5120,Consume EventHub - the best way to do that,"Hi. Im looking on Orleans and have scenario where i have to read external data from EventHub (EventHub is not populated with data from Orleans applications/clients) and eventually pass them further to other grains - model flows and etc. I wonder - is this is somehow achievable inside orleans middle-tier (to leverage scaling and distributed nature of the system) or i have to externally (as OrleanClient) read the events from EventHub and then eventually pass them to needed grains? 
For example let's assume scenario where i want to read data from EventHub partition them and catch by arbitrary property (UserId) and then write grouped as single transaction (for reach key) to DataLake. The trigger to write should be size of cached data (around 4 MB) or time (if we not make it to gather 4 MB before time elapsed). From theory i would use some Orleans Service or Stream to read data extract key and then pass each message to grain with key as ID - then grain batch this events and have Orleans Timer or size Trigger to flush data do DataLake - but if this has any chance of success? Is 4 MB size grains are suitable for Orleans? And still i have no idea how to read those events from EventHub. 
Is something like this achievable in Olreans? 
@jason-bragg - could you help here? :)","Consume EventHub - the best way to do that Hi. Im looking on Orleans and have scenario where i have to read external data from EventHub (EventHub is not populated with data from Orleans applications/clients) and eventually pass them further to other grains - model flows and etc. I wonder - is this is somehow achievable inside orleans middle-tier (to leverage scaling and distributed nature of the system) or i have to externally (as OrleanClient) read the events from EventHub and then eventually pass them to needed grains? 
For example let's assume scenario where i want to read data from EventHub partition them and catch by arbitrary property (UserId) and then write grouped as single transaction (for reach key) to DataLake. The trigger to write should be size of cached data (around 4 MB) or time (if we not make it to gather 4 MB before time elapsed). From theory i would use some Orleans Service or Stream to read data extract key and then pass each message to grain with key as ID - then grain batch this events and have Orleans Timer or size Trigger to flush data do DataLake - but if this has any chance of success? Is 4 MB size grains are suitable for Orleans? And still i have no idea how to read those events from EventHub. 
Is something like this achievable in Olreans? 
@jason-bragg - could you help here? :)",question,jason-bragg,,
5119,Orleans method call slower than Orleans streams,"We have implemented a workflow execution system using Orleans 2.0.0. The workflow contains 4 operators  connected one after the other. Each operator (implemented as its own grain class) after it processes a tuple passes it to the next operator. This 'passing' is implemented in two ways - 1) method calls to the downstream operator 2) Streams between each consecutive operators and the downstream operators subscribe to the stream of their previous operator. We use SMSProvider for our streams.

In both implementations the results from the last operator reach the Client using a stream (SMSProvider).

We ran tests using two input sizes - 1) 100000 tuples and 2) 1 million tuples. Following are the time taken for the two implementations (averaged over multiple iterations):

 case.

For all other cases everything goes on fine. But we do see the slower performance of Method Calls as compared to streams.

The two implementations are in my Github repository under the branches [workflow_RPCs_with_ordering_v2](https://github.com/avinash0161/TexeraPrototypes/tree/workflow_RPCs_with_ordering_v2) and [workflow_streams_with_ordering](https://github.com/avinash0161/TexeraPrototypes/tree/workflow_streams_with_ordering).","Orleans method call slower than Orleans streams We have implemented a workflow execution system using Orleans 2.0.0. The workflow contains 4 operators  connected one after the other. Each operator (implemented as its own grain class) after it processes a tuple passes it to the next operator. This 'passing' is implemented in two ways - 1) method calls to the downstream operator 2) Streams between each consecutive operators and the downstream operators subscribe to the stream of their previous operator. We use SMSProvider for our streams.

In both implementations the results from the last operator reach the Client using a stream (SMSProvider).

We ran tests using two input sizes - 1) 100000 tuples and 2) 1 million tuples. Following are the time taken for the two implementations (averaged over multiple iterations):

 case.

For all other cases everything goes on fine. But we do see the slower performance of Method Calls as compared to streams.

The two implementations are in my Github repository under the branches [workflow_RPCs_with_ordering_v2](https://github.com/avinash0161/TexeraPrototypes/tree/workflow_RPCs_with_ordering_v2) and [workflow_streams_with_ordering](https://github.com/avinash0161/TexeraPrototypes/tree/workflow_streams_with_ordering).",,jason-bragg,,
5118,gossip channels across Azure availability zones?,"What are the requirements for the gossip channel(s) to work correctly?

With Azure now having 3+ ""Availability Zones"" per region is multi-cluster support needed for silos to span zones or would these inter-zone hops be low enough latency to form a single cluster across zones within a single region?

Any thoughts on hierarchical partitioning/silo-affinity (""within zone across zones across regions"" for example)? Is it done anywhere or considered for Orleans? Or does existing multi-cluster support in Orleans already cover every conceivable scenario?","gossip channels across Azure availability zones? What are the requirements for the gossip channel(s) to work correctly?

With Azure now having 3+ ""Availability Zones"" per region is multi-cluster support needed for silos to span zones or would these inter-zone hops be low enough latency to form a single cluster across zones within a single region?

Any thoughts on hierarchical partitioning/silo-affinity (""within zone across zones across regions"" for example)? Is it done anywhere or considered for Orleans? Or does existing multi-cluster support in Orleans already cover every conceivable scenario?",question,sergeybykov,,
5117,Add changelog for 2.2.0-beta1,,Add changelog for 2.2.0-beta1 ,,benjaminpetit,,
5115,HelloWorld Tutorial/sample needs a correction,"Hello

The documentation of HelloWorld sample available at http://dotnet.github.io/orleans/Documentation/tutorials_and_samples/Hello-World.html needs a correction. The **Improve this Doc** link on the page is broken too



With the missing statement related to adding the assembly that holds definition of the _Grains_ the documentation misses the point on how the _SiloHost_ picks the _grains_ to host","HelloWorld Tutorial/sample needs a correction Hello

The documentation of HelloWorld sample available at http://dotnet.github.io/orleans/Documentation/tutorials_and_samples/Hello-World.html needs a correction. The **Improve this Doc** link on the page is broken too



With the missing statement related to adding the assembly that holds definition of the _Grains_ the documentation misses the point on how the _SiloHost_ picks the _grains_ to host",,xiazen,,
5114,How do you get all the grain collections?,"For example there are many users grain one of them needs to change the name and the name cannot be the same as other users what should be done at this time ~
What I can think of at the moment is to use a grain like user management to manage all users grain but it doesn't feel reasonable because that grain will become very big can anyone tell me what to do","How do you get all the grain collections? For example there are many users grain one of them needs to change the name and the name cannot be the same as other users what should be done at this time ~
What I can think of at the moment is to use a grain like user management to manage all users grain but it doesn't feel reasonable because that grain will become very big can anyone tell me what to do",question,sergeybykov,22/10/2018 2:45,1/11/2018 13:05
5113,Update AccountTransfer sample ,"* Update sample to the newer version of the transaction interface.
* Add ReadKey in sample client after an exception is thrown to keep the window open long enough to read the exception
* Fix an exception to remove reference to deprecated functionality.","Update AccountTransfer sample  * Update sample to the newer version of the transaction interface.
* Add ReadKey in sample client after an exception is thrown to keep the window open long enough to read the exception
* Fix an exception to remove reference to deprecated functionality.",,jason-bragg,,
5110,Possible reasons and correct handling of TableStorageUpdateConditionNotSatisfiedException,"Hi All

I noticed we're getting 

We're running Orleans 2.0.5.

Any help would be hugely appreciated thanks in advance.","Possible reasons and correct handling of TableStorageUpdateConditionNotSatisfiedException Hi All

I noticed we're getting 

We're running Orleans 2.0.5.

Any help would be hugely appreciated thanks in advance.",,xiazen,,
5107,CustomStorage.LogViewAdaptor could potentially cause an endless loop,"When there is an exception during  but that method is not run inside a grain context but from a BatchWorker.





","CustomStorage.LogViewAdaptor could potentially cause an endless loop When there is an exception during  but that method is not run inside a grain context but from a BatchWorker.





",,sebastianburckhardt,,
5106,`Orleans.Runtime.Silo.StartAsync` stuck occasionally,"setup:
* memory storage + local cluster
* co-host  1)API gate  2) cluster client 3) silo host in one process
* orleans version:  b0fa5401891a2490bf99b95dca5d11c80df593d2

clrstack:
",,,benjaminpetit,,
5104,#2359 Migrated HelloWorld to dotnet core 2.1,Migrated HelloWorld to dotnet core 2.1 #2359 ,#2359 Migrated HelloWorld to dotnet core 2.1 Migrated HelloWorld to dotnet core 2.1 #2359 ,,benjaminpetit,,
5102,Tutorial 1 for Orleans 2.0,This tutorial ties in with the Hello World sample. ,Tutorial 1 for Orleans 2.0 This tutorial ties in with the Hello World sample. ,,xiazen,,
5101,Reenabled transaction recovery tests,,Reenabled transaction recovery tests ,,xiazen,,
5100,Fix Consul rootKvFolder option is not backward compatible,Fix rootKvFolder is not backward compatible,Fix Consul rootKvFolder option is not backward compatible Fix rootKvFolder is not backward compatible,,benjaminpetit,,
5099,Java service as producer of Orleans stream events,I have question regarding producing stream events. We have java service the will store event to azure queue. Is it possible to integrate this events with Orleans streams?,Java service as producer of Orleans stream events I have question regarding producing stream events. We have java service the will store event to azure queue. Is it possible to integrate this events with Orleans streams?,question,xiazen,,
5098,Fixed bug in transaction confirmation logic,#NAME?,"Fixed bug in transaction confirmation logic - Refactored confirmation management.
- Confirmation task only resoved after write to storage.",,sergeybykov,,
5097,Small issues running Orleans2.1 ClusterClient on Mono/Unity/Android,"Hello I am running Orleans 2.1 ClusterClient on Mono/Unity/Android. The common features work fine but following small problems:

1. 
https://github.com/dotnet/orleans/blob/b0fa5401891a2490bf99b95dca5d11c80df593d2/src/Orleans.Core/Runtime/RuntimeVersion.cs#L18

This line will throw an exception from GetVersionInfo because ""thisProg.Location"" param is empty under Android. 
The purpose of this line is only to print log but it prevents the ClusterClient from launching under Android.
Hope that a checking of whether the file exists here can be added before calling GetVersionInfo like:

which can be configured during ClusterClient building and invoked in this line.

A question in addtion how will the address returned by this method GetLocalIPAddress be used by ClusterClient?

Thanks!","Small issues running Orleans2.1 ClusterClient on Mono/Unity/Android Hello I am running Orleans 2.1 ClusterClient on Mono/Unity/Android. The common features work fine but following small problems:

1. 
https://github.com/dotnet/orleans/blob/b0fa5401891a2490bf99b95dca5d11c80df593d2/src/Orleans.Core/Runtime/RuntimeVersion.cs#L18

This line will throw an exception from GetVersionInfo because ""thisProg.Location"" param is empty under Android. 
The purpose of this line is only to print log but it prevents the ClusterClient from launching under Android.
Hope that a checking of whether the file exists here can be added before calling GetVersionInfo like:

which can be configured during ClusterClient building and invoked in this line.

A question in addtion how will the address returned by this method GetLocalIPAddress be used by ClusterClient?

Thanks!",question,sergeybykov,,
5095,Rewrite BufferPool with ArrayPool<byte>.Shared,"Let BufferPool wrap  doesn't accept arrays which not from pool](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/shared/System/Buffers/TlsOverPerCoreLockedStacksArrayPool.cs#L181) the workaround for this brokes the optimization in long bytes writing(like bytes from serializer).


","Rewrite BufferPool with ArrayPool<byte>.Shared Let BufferPool wrap  doesn't accept arrays which not from pool](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/shared/System/Buffers/TlsOverPerCoreLockedStacksArrayPool.cs#L181) the workaround for this brokes the optimization in long bytes writing(like bytes from serializer).


",,ReubenBond,,
5093,Testing OneWay grain messages is hard,"Writing tests involving grain calls with [OneWay]s generally means getting to rig up a lock to wait until something else happens to make sure the OneWay actually fired. It's not awful but it does involve lots of boilerplate code.

Has there been any or is there any room for discussing testing these types of grain calls? I can think of a couple of options:
- Horrible static OneWayAttribute test-hook that causes one-way messages to be called normally
- Orleans configuration that causes all one-way attributes to be called normally
- A means of calling a grain method that forces a normal calling (this might exist?)
- The ability to extend OneWayAttribute (it's sealed right now) so as to extend or not from OneWayAttribute based on a configuration flag

Or perhaps there's a more obvious means of doing this in which case that's even better. :)","Testing OneWay grain messages is hard Writing tests involving grain calls with [OneWay]s generally means getting to rig up a lock to wait until something else happens to make sure the OneWay actually fired. It's not awful but it does involve lots of boilerplate code.

Has there been any or is there any room for discussing testing these types of grain calls? I can think of a couple of options:
- Horrible static OneWayAttribute test-hook that causes one-way messages to be called normally
- Orleans configuration that causes all one-way attributes to be called normally
- A means of calling a grain method that forces a normal calling (this might exist?)
- The ability to extend OneWayAttribute (it's sealed right now) so as to extend or not from OneWayAttribute based on a configuration flag

Or perhaps there's a more obvious means of doing this in which case that's even better. :)",,benjaminpetit,,
5092,Receiving notifications about transaction lifecycle,"Hi

I'm looking for a way to send information about changes to grain state to an external service but only after the transaction in which those changes were made is committed.  To do this I'd like to be able to receive a notification (in each silo where the information was reported) after a transaction is confirmed or aborted.

It looks like there is some work around separating transaction management and participation specifically in #4810 #4820 and #4860.  From what I can understand the idea is to add an  and could you point me to some resources as to how to use it?

 ","Receiving notifications about transaction lifecycle Hi

I'm looking for a way to send information about changes to grain state to an external service but only after the transaction in which those changes were made is committed.  To do this I'd like to be able to receive a notification (in each silo where the information was reported) after a transaction is confirmed or aborted.

It looks like there is some work around separating transaction management and participation specifically in #4810 #4820 and #4860.  From what I can understand the idea is to add an  and could you point me to some resources as to how to use it?

 ",question,jason-bragg,,
5091,Will you join sagas in the later plan?,"actor+sagas is very good.
ex:  https://github.com/apache/incubator-servicecomb-saga
https://github.com/OpenSagas-csharp/servicecomb-saga-csharp","Will you join sagas in the later plan? actor+sagas is very good.
ex:  https://github.com/apache/incubator-servicecomb-saga
https://github.com/OpenSagas-csharp/servicecomb-saga-csharp",question,sergeybykov,,
5089,Backport: Revert some revert change to fix backward compatibility (#5088),,Backport: Revert some revert change to fix backward compatibility (#5088) ,,benjaminpetit,,
5087,Backport #5086 for 2.1.2,,Backport #5086 for 2.1.2 ,,benjaminpetit,,
5086,"Revert ""Don't enforce reentrancy for one way requests"" #4382","It seems that #4382 introduced some regressions (see #5080 #5059 maybe other weird behavior).

I propose we revert it to be able to quickly publish a new 2.1 version. We can then work to bring it back in 2.2.0 once the issue is fixed.","Revert ""Don't enforce reentrancy for one way requests"" #4382 It seems that #4382 introduced some regressions (see #5080 #5059 maybe other weird behavior).

I propose we revert it to be able to quickly publish a new 2.1 version. We can then work to bring it back in 2.2.0 once the issue is fixed.",,ReubenBond,,
5085,TimeoutExceptions on deployments,"We're seeing a load of errors when we deploy new Silos around timeouts. We see messages like: 

We have a background service that lives in the same process as our Silos that pulls messages from a queue and calls a method on a grain to deliver the data. It's these calls that are failing. We're using ILifecycleParticipant<ISiloLifecycle> to start & stop this background service.

The silos updated via rolling deployments in Kubernetes. Once everything settles these error messages go away.

Is there some way we can fix these errors?","TimeoutExceptions on deployments We're seeing a load of errors when we deploy new Silos around timeouts. We see messages like: 

We have a background service that lives in the same process as our Silos that pulls messages from a queue and calls a method on a grain to deliver the data. It's these calls that are failing. We're using ILifecycleParticipant<ISiloLifecycle> to start & stop this background service.

The silos updated via rolling deployments in Kubernetes. Once everything settles these error messages go away.

Is there some way we can fix these errors?",,benjaminpetit,,
5084,Added testing reference from 1.5 for 2.0.,"Also added reference around dependency injection after a conversation
with @ReubonBond.

Fixes #5083.

Signed-off-by: Mike Lloyd <mike@reboot3times.org>","Added testing reference from 1.5 for 2.0. Also added reference around dependency injection after a conversation
with @ReubonBond.

Fixes #5083.

Signed-off-by: Mike Lloyd <mike@reboot3times.org>",documentation,ReubenBond,9/10/2018 17:23,11/10/2018 6:34
5083,1.5 -> 2.0 testing documentation,"Looking at the [1.5 testing docs](https://dotnet.github.io/orleans/1.5/Tutorials/Unit-Testing-Grains.html) there is guidance on how to mock the cluster and grains but that documentation isn't carried forward into 2.0. There is also a constructor signature change as well:



The docs don't explain what the change is nor does the code give too many hints on proper usage.","1.5 -> 2.0 testing documentation Looking at the [1.5 testing docs](https://dotnet.github.io/orleans/1.5/Tutorials/Unit-Testing-Grains.html) there is guidance on how to mock the cluster and grains but that documentation isn't carried forward into 2.0. There is also a constructor signature change as well:



The docs don't explain what the change is nor does the code give too many hints on proper usage.",documentation,JillHeaden,,
5082,Allow placement strategies to specify deterministic activation ids,"When grains are placed using the (upcoming) Service Fabric Stateful Service strategy there is no grain directory involvement and hence we need a mechanism to determine which activation id to use when routing messages.

This PR enables that functionality but keeps it *. (PR #5082)","Allow placement strategies to specify deterministic activation ids When grains are placed using the (upcoming) Service Fabric Stateful Service strategy there is no grain directory involvement and hence we need a mechanism to determine which activation id to use when routing messages.

This PR enables that functionality but keeps it *. (PR #5082)",,benjaminpetit,,
5081,"Update ""What is a Grain Client?"" doc page to 2.0 configuration API",http://dotnet.github.io/orleans/Documentation/clusters_and_clients/index.html#initialization-of-grain-client is still referring to the legacy configuration API. We need to make it consistent with http://dotnet.github.io/orleans/Documentation/clusters_and_clients/configuration_guide/client_configuration.html. Otherwise the page content is confusing.,"Update ""What is a Grain Client?"" doc page to 2.0 configuration API http://dotnet.github.io/orleans/Documentation/clusters_and_clients/index.html#initialization-of-grain-client is still referring to the legacy configuration API. We need to make it consistent with http://dotnet.github.io/orleans/Documentation/clusters_and_clients/configuration_guide/client_configuration.html. Otherwise the page content is confusing.",P1,JillHeaden,,
5080,Orleans.Storage.InconsistentStateException after migrating to Orleans 2.1 (repro sample included),"I have an issue after updating to Orleans 2.1. I am using  for my integrational tests and tests started failing after update (maybe problem not in memory storage but in new scheduler). I have created small project to reproduce this issue. I think this is trivial flow for grains and shouldn't throw any exceptions.
[Grains.zip](https://github.com/dotnet/orleans/files/2457102/Grains.zip)

","Orleans.Storage.InconsistentStateException after migrating to Orleans 2.1 (repro sample included) I have an issue after updating to Orleans 2.1. I am using  for my integrational tests and tests started failing after update (maybe problem not in memory storage but in new scheduler). I have created small project to reproduce this issue. I think this is trivial flow for grains and shouldn't throw any exceptions.
[Grains.zip](https://github.com/dotnet/orleans/files/2457102/Grains.zip)

",P1,benjaminpetit,,
5079,is it possible to prevent timers from starting?,"We have a case where we shut all silos down at once and start them again.
this is mainly when we need to rollback to a previous version or perform an upgrade that is not possible as a rolling upgrade (like upgrading to orleans 2.0).

what we see is we have a lot of reminders ticking just as soon as some silos become available and therefore have a lot of stuff happening before we are ready for it.
this also causes most of the activations to go on the first silo that was ready then we have to restart that one to rebalance the activations.

what do you suggest doing?","is it possible to prevent timers from starting? We have a case where we shut all silos down at once and start them again.
this is mainly when we need to rollback to a previous version or perform an upgrade that is not possible as a rolling upgrade (like upgrading to orleans 2.0).

what we see is we have a lot of reminders ticking just as soon as some silos become available and therefore have a lot of stuff happening before we are ready for it.
this also causes most of the activations to go on the first silo that was ready then we have to restart that one to rebalance the activations.

what do you suggest doing?",question,sergeybykov,,
5076,proposal: add issue template,"e.g. 
1. https://github.com/golang/go/issues/new
2. https://github.com/golang/go/blob/master/.github/ISSUE_TEMPLATE","proposal: add issue template e.g. 
1. https://github.com/golang/go/issues/new
2. https://github.com/golang/go/blob/master/.github/ISSUE_TEMPLATE",,sergeybykov,,
5075,Getting `System.InvalidOperationException: Grain directory is stopping` when shutting down ,"setup:
* memory storage + local cluster
* co-host  1)API gate  2) cluster client 3) silo host in one process
* orleans version:  （almost) bb360159f695b008be701d7bafd581e410781001 
 ( https://github.com/sillyousu/orleans/tree/fix-4965)

When I shutdown the process I got following warning:
",Getting ,,benjaminpetit,,
5072,IMessageCenter.WaitMessage support cancellation,"In the shutdown procedure the message center thread is blocked for waiting for
new inbound messages. Meanwhile the shutdown procedure also dispose 
the in-used objects (BlockingCollection) which cause unexpected throw
(ArgumentNullException) in message center thread.

The original decision that avoiding passing cancellation to
 was in consideration of performance.
But I can't see any regression in my benchmark program.

see also:
https://github.com/dotnet/corefx/issues/14320#issuecomment-266128170

fix #4965","IMessageCenter.WaitMessage support cancellation In the shutdown procedure the message center thread is blocked for waiting for
new inbound messages. Meanwhile the shutdown procedure also dispose 
the in-used objects (BlockingCollection) which cause unexpected throw
(ArgumentNullException) in message center thread.

The original decision that avoiding passing cancellation to
 was in consideration of performance.
But I can't see any regression in my benchmark program.

see also:
https://github.com/dotnet/corefx/issues/14320#issuecomment-266128170

fix #4965",,benjaminpetit,,
5070,Partial fix for transaction recovery tests,"- May still be an issues need to run test 19289 more times in a row to find it :/
- Still looking","Partial fix for transaction recovery tests - May still be an issues need to run test 19289 more times in a row to find it :/
- Still looking",,xiazen,,
5069,Service Fabric Mesh support,"I started thinking about adding support for [Service Fabric Mesh](https://docs.microsoft.com/en-us/azure/service-fabric-mesh/service-fabric-mesh-overview).

So far the docker-aspnet-core example works like a charm example [here](https://github.com/mholo65/mesh-orleans-sample/tree/414d0d73c3a1e977de1667a977fc2e153645b992). But I want to take this further and use Service Fabric Mesh for clustering and (when Service Fabric 6.4 lands) use Standalone Reliable Collections for persisting grain state.

For clustering I started looking at current the current implementation in .","Service Fabric Mesh support I started thinking about adding support for [Service Fabric Mesh](https://docs.microsoft.com/en-us/azure/service-fabric-mesh/service-fabric-mesh-overview).

So far the docker-aspnet-core example works like a charm example [here](https://github.com/mholo65/mesh-orleans-sample/tree/414d0d73c3a1e977de1667a977fc2e153645b992). But I want to take this further and use Service Fabric Mesh for clustering and (when Service Fabric 6.4 lands) use Standalone Reliable Collections for persisting grain state.

For clustering I started looking at current the current implementation in .",,ReubenBond,,
5067,"""System"" namespace conflicts with generated code","A namespace of of *.System breaks with the generated code because the binding flags don't use the global alias.



PR to follow.","""System"" namespace conflicts with generated code A namespace of of *.System breaks with the generated code because the binding flags don't use the global alias.



PR to follow.",,ReubenBond,,
5066,Disable fault injection tx test,Disable fault injection tx test will turn it on after investigation on its failures ,Disable fault injection tx test Disable fault injection tx test will turn it on after investigation on its failures ,,jason-bragg,,
5064,Dissabling transaction recovery tests while investigating,,Dissabling transaction recovery tests while investigating ,,xiazen,,
5063,Backport fixes to ZooKeeper and Consul providers to 2.1.1,,Backport fixes to ZooKeeper and Consul providers to 2.1.1 ,,ReubenBond,,
5062,Increase package versions to 2.2.0,"Increase package versions to 2.2.0 so that we don't need to update it for every patch release.
Also add a missing nuget packaging condition for Service Fabric meta-package.","Increase package versions to 2.2.0 Increase package versions to 2.2.0 so that we don't need to update it for every patch release.
Also add a missing nuget packaging condition for Service Fabric meta-package.",,benjaminpetit,,
5061,Start using Span and new language features for increasing Orleans perfomance,Initial PR to inject Span and C# 7.3 optimizations in Orleans project with simple example of using it where we avoid unnecessary GC array allocations.,Start using Span and new language features for increasing Orleans perfomance Initial PR to inject Span and C# 7.3 optimizations in Orleans project with simple example of using it where we avoid unnecessary GC array allocations.,,ReubenBond,,
5059,Inconsistent State Exception on PubSub grain,"Hello folks

When we are starting a silo it get several messages about duplicated activations of a grain the PubSub grain which is weird because they happen on a single silo as well. After that those grains are being deactivated and then I see 
","Inconsistent State Exception on PubSub grain Hello folks

When we are starting a silo it get several messages about duplicated activations of a grain the PubSub grain which is weird because they happen on a single silo as well. After that those grains are being deactivated and then I see 
",,xiazen,,
5058,Log compact/aggregation not working after 2.x migration,"Hello folks!

According to the [docs](http://dotnet.github.io/orleans/Documentation/clusters_and_clients/monitoring/silo_error_code_monitoring.html): 

> If multiple logs of the same log code occur within a designated time interval (the default is >5 within 1 minute) then additional log messages with that log code are suppressed and output as a ""bulk"" entry with log code equal to the original log code + 500000. So for example multiple 100157 entries will show in the logs as 5 x 100157 + 1 x 600157 log entry per minute.


After migrating to 2.x and using the new logging infrastructure based on MEL the logs aren't being aggregated anymore.

Can someone take a look why?
","Log compact/aggregation not working after 2.x migration Hello folks!

According to the [docs](http://dotnet.github.io/orleans/Documentation/clusters_and_clients/monitoring/silo_error_code_monitoring.html): 

> If multiple logs of the same log code occur within a designated time interval (the default is >5 within 1 minute) then additional log messages with that log code are suppressed and output as a ""bulk"" entry with log code equal to the original log code + 500000. So for example multiple 100157 entries will show in the logs as 5 x 100157 + 1 x 600157 log entry per minute.


After migrating to 2.x and using the new logging infrastructure based on MEL the logs aren't being aggregated anymore.

Can someone take a look why?
",documentation,JillHeaden,,
5056,ServiceBus.Tests build error in vs 2017,"

Anybody know what's wrong? ","ServiceBus.Tests build error in vs 2017 

Anybody know what's wrong? ",,xiazen,,
5052,Grain reminders documentation,"The answers to these questions could be included in the grain reminders documentation:

- What is the maximum allowed value for the  parameter?","Grain reminders documentation The answers to these questions could be included in the grain reminders documentation:

- What is the maximum allowed value for the  parameter?",documentation,benjaminpetit,,
5051,Typo and spelling check XML doc and strings. A to E. #Hacktoberfest,":dog2: *Much error.* :dog2: 
:dog: *Very typo.* :dog: 
:heavy_check_mark: *Many spell check.* :heavy_check_mark: 

I had to break this up into multiple PRs. This PR only contains **A to E** corrections. Mostly focused on XML doc comments. I tried to ignore  messages that had spelling errors.

Let me know if you'd like me to continue checking.

Also happy #Hacktoberfest ! :smiley_cat: :fearful: :skull_and_crossbones: :moon: :bat: 

Thanks
Brian

:crystal_ball: :dolls: ***[""Magic and technology. Voodoo dolls and chants. Electricity. Were makin weird science...""](https://www.youtube.com/watch?v=Jm-upHSP9KU)***
","Typo and spelling check XML doc and strings. A to E. #Hacktoberfest :dog2: *Much error.* :dog2: 
:dog: *Very typo.* :dog: 
:heavy_check_mark: *Many spell check.* :heavy_check_mark: 

I had to break this up into multiple PRs. This PR only contains **A to E** corrections. Mostly focused on XML doc comments. I tried to ignore  messages that had spelling errors.

Let me know if you'd like me to continue checking.

Also happy #Hacktoberfest ! :smiley_cat: :fearful: :skull_and_crossbones: :moon: :bat: 

Thanks
Brian

:crystal_ball: :dolls: ***[""Magic and technology. Voodoo dolls and chants. Electricity. Were makin weird science...""](https://www.youtube.com/watch?v=Jm-upHSP9KU)***
",Hacktoberfest,philrowan-mtb,2/10/2018 9:15,2/10/2018 12:10
5048,"Slow access to Azure Table ""OrleansReminders"" for ""ReadTableEntriesAndEtags"" which took 00:00:03.0158598","Where is a problem in case of these warnings:

","Slow access to Azure Table ""OrleansReminders"" for ""ReadTableEntriesAndEtags"", which took 00:00:03.0158598 Where is a problem in case of these warnings:

",question,sergeybykov,,
5047,Change TelemetryConsumers.NewRelic to target .NET Standard #5044,"Change Target Framework of Orleans.TelemetryConsumers.NewRelic to .NET Standard
Fixes #5044
","Change TelemetryConsumers.NewRelic to target .NET Standard #5044 Change Target Framework of Orleans.TelemetryConsumers.NewRelic to .NET Standard
Fixes #5044
",,xiazen,,
5045,Cleaned up StreamId code,"The ValueTuple type allowed a lovely cleanup of the StreamId class. 
When the Record types becomes a c# feature another cleanup can be made.","Cleaned up StreamId code The ValueTuple type allowed a lovely cleanup of the StreamId class. 
When the Record types becomes a c# feature another cleanup can be made.",,benjaminpetit,,
5044,Change Target Framework of Orleans.TelemetryConsumers.NewRelic to .NET Standard,"Orleans.TelemetryConsumers.NewRelic currently targets .NET Framework 4.6.1

Can we please change that project to target .NET Standard ?

Cheers","Change Target Framework of Orleans.TelemetryConsumers.NewRelic to .NET Standard Orleans.TelemetryConsumers.NewRelic currently targets .NET Framework 4.6.1

Can we please change that project to target .NET Standard ?

Cheers",,xiazen,,
5043,Using MySQL as a Membership Provider with Microsoft.Orleans.Clustering.AdoNet 2.1.0 too many Connection error occurred,"When i using MySQL as a Membership Provider with Microsoft.Orleans.Clustering.AdoNet 2.1.0 too many Connection error occurred.
In previous versions a silo had only 2-5 connections. But now one silo have more than 30 connections.
Too surprised me there is such a problem.

My .net version is: .net framework 4.6.1
Orleans version is: 2.1.0
","Using MySQL as a Membership Provider with Microsoft.Orleans.Clustering.AdoNet 2.1.0 too many Connection error occurred When i using MySQL as a Membership Provider with Microsoft.Orleans.Clustering.AdoNet 2.1.0 too many Connection error occurred.
In previous versions a silo had only 2-5 connections. But now one silo have more than 30 connections.
Too surprised me there is such a problem.

My .net version is: .net framework 4.6.1
Orleans version is: 2.1.0
",,benjaminpetit,,
5042,Lifetime of services injected into grains,"It's not clear what is lifetime of a service that registered as services.AddScoped in silo and injected into grain? In case of silo and grains what is different between AddScoped and AddTransient?
For example I have a grain that can be activated by client stream or reminder. This grain can activate hundred another grains . By default lifetime of each grain is 2 hour. In this case what is request scope?
I have not found any documentation about DI on Olreans. ","Lifetime of services injected into grains It's not clear what is lifetime of a service that registered as services.AddScoped in silo and injected into grain? In case of silo and grains what is different between AddScoped and AddTransient?
For example I have a grain that can be activated by client stream or reminder. This grain can activate hundred another grains . By default lifetime of each grain is 2 hour. In this case what is request scope?
I have not found any documentation about DI on Olreans. ",question,xiazen,,
5041,When I Use Orleans Microsoft.Orleans.CodeGenerator.MSBuild 2.1.0 Build the Interface  failed.,"

Error Message: CS1501 “AddSerializerType” method not have 3 parameters override.","When I Use Orleans Microsoft.Orleans.CodeGenerator.MSBuild 2.1.0 Build the Interface  failed. 

Error Message: CS1501 “AddSerializerType” method not have 3 parameters override.",,ReubenBond,,
5040,About when the silo stops,"I started silo s1 and s2
client c1 and c2 connect silo s1 and subscribe.
Then turn off silo s1
c1 and c2 subscribed grains to s2
c1 and c2 need to re-subscribe to the previous grain
but c1 and c2 don't know. 
How should this be solved?!
I'm sorry about the English ~","About when the silo stops I started silo s1 and s2
client c1 and c2 connect silo s1 and subscribe.
Then turn off silo s1
c1 and c2 subscribed grains to s2
c1 and c2 need to re-subscribe to the previous grain
but c1 and c2 don't know. 
How should this be solved?!
I'm sorry about the English ~",question,sergeybykov,,
5037,Port of #5033 to 1.5.x: Make MaxSockets in SocketManager configurable,,Port of #5033 to 1.5.x: Make MaxSockets in SocketManager configurable ,,ReubenBond,,
5034,Implicit stream subscriptions seem to stop being called after some time,We're seeing a grain implicitly subscribed to multiple streams suddenly stop having it's  to fire in the grain. This seems to imply the grain was either inaccessible due to some deadlock or busy waiting or that the grain itself was never activated and sent the message. Given that the grain is _relatively_ simple and devoid of any locks I am suspicious that it's the latter.,Implicit stream subscriptions seem to stop being called after some time We're seeing a grain implicitly subscribed to multiple streams suddenly stop having it's  to fire in the grain. This seems to imply the grain was either inaccessible due to some deadlock or busy waiting or that the grain itself was never activated and sent the message. Given that the grain is _relatively_ simple and devoid of any locks I am suspicious that it's the latter.,,xiazen,,
5033,Make MaxSockets in SocketManager configurable,"Make MaxSockets in SocketManager configurable.
Raise the default from 200 to 500.

With clusters larger than 200 silos the hardcoded limit on the number of sockets causes massive churn of sockets that get constantly closed and reopened.","Make MaxSockets in SocketManager configurable Make MaxSockets in SocketManager configurable.
Raise the default from 200 to 500.

With clusters larger than 200 silos the hardcoded limit on the number of sockets causes massive churn of sockets that get constantly closed and reopened.",enhancement,jason-bragg,,
5030,Cleanup types in transaction state storage interface,Participated of transaction manager and metadata are now passed to storage by structure not string values.,Cleanup types in transaction state storage interface Participated of transaction manager and metadata are now passed to storage by structure not string values.,,xiazen,,
5029,Serialization bug in new codegenerator for types deriving from Dictionary<TKey TValue>,"If a grain interface method takes as parameter a custom dictionary which inherits from  then the dictionary is not populated on the receiving side. The error only exist when the new code generator is used it works correctly with the old one.

There is a reproducing project here: https://github.com/rmja/OrleansIssueDictionary
The project currently references the new generator. Changing back to the old one makes the test pass.","Serialization bug in new codegenerator for types deriving from Dictionary<TKey, TValue> If a grain interface method takes as parameter a custom dictionary which inherits from  then the dictionary is not populated on the receiving side. The error only exist when the new code generator is used it works correctly with the old one.

There is a reproducing project here: https://github.com/rmja/OrleansIssueDictionary
The project currently references the new generator. Changing back to the old one makes the test pass.",codegen,ReubenBond,,
5027,What would be the recommended approach to persist grain state in relational database in order to query across multiple actors?,"I had been following the indexing of actor state and read the paper published on it but there doesn't seem to be much movement on it.

**What would be the recommended approach to persist grain state in relational database in order to query across multiple actors?**

_For the moment I have implemented it as such:_
- _all the grains which I need to query from emit a stream event after writing their state in grain storage_
- _an implicit stream reads all events and persist them in relation DB_
 ","What would be the recommended approach to persist grain state in relational database in order to query across multiple actors? I had been following the indexing of actor state and read the paper published on it but there doesn't seem to be much movement on it.

**What would be the recommended approach to persist grain state in relational database in order to query across multiple actors?**

_For the moment I have implemented it as such:_
- _all the grains which I need to query from emit a stream event after writing their state in grain storage_
- _an implicit stream reads all events and persist them in relation DB_
 ",question,sergeybykov,26/09/2018 17:25,5/10/2018 18:02
5025,Getting a SiloUnavailableException,Getting a  ,Getting a SiloUnavailableException Getting a  ,,ReubenBond,,
5023,Ensure AsyncAgent restarts on fault,"AsyncAgents were not restarting on fault when configured to do so.
- Added test to repro
- Fixed in AsyncAgent
","Ensure AsyncAgent restarts on fault AsyncAgents were not restarting on fault when configured to do so.
- Added test to repro
- Fixed in AsyncAgent
",,ReubenBond,,
5022,Add LargeMessageWarningThreshold back to Silo(Client)MessagingOptions,Add LargeMessageWarningThreshold back to Silo(Client)MessagingOptions and also legacy configuration objects,Add LargeMessageWarningThreshold back to Silo(Client)MessagingOptions Add LargeMessageWarningThreshold back to Silo(Client)MessagingOptions and also legacy configuration objects,,ReubenBond,,
5021,The new code generator adds everything to feature.AddKnownType,"This was a problem with the old code generator already as documented in #4437 but with the new code generator it's a lot worse.

For example I have a functional tests project that has a single grain interface with a few simple calls it references various other projects. Both code generators write about 200 lines of code for the grain method invoker but then they generate endless ? It looks like it adds every type that is visible to Roslyn during codegen or something similar. And the added information doesn't look useful at all - it's just a list of type names.","The new code generator adds everything to feature.AddKnownType This was a problem with the old code generator already as documented in #4437 but with the new code generator it's a lot worse.

For example I have a functional tests project that has a single grain interface with a few simple calls it references various other projects. Both code generators write about 200 lines of code for the grain method invoker but then they generate endless ? It looks like it adds every type that is visible to Roslyn during codegen or something similar. And the added information doesn't look useful at all - it's just a list of type names.",,ReubenBond,,
5020,Added Validations for Blob Names and refactored the ContianerName & TableName validations,PR for: Azure Blob storage provider does not sanitize blob names (https://github.com/dotnet/orleans/issues/1496) ,Added Validations for Blob Names and refactored the ContianerName & TableName validations PR for: Azure Blob storage provider does not sanitize blob names (https://github.com/dotnet/orleans/issues/1496) ,,xiazen,,
5018,Exception serialization with .NET Core 2.0?,"Hi

I use Orleans since one of one of the earliest alphas for 2.0 with .NET Core and I think that I never had a problem with exceptions although I am not sure.

Recently we discovered a bug where validation details where not displayed correctly in the UI. It does not happen very often because there is also a lot of client side validation. Validation errors are transported with a custom validation exception something like:



Details was always Empty and the reason was that our serialization logic was not correct. So we fixed it: https://github.com/Squidex/squidex/blob/master/src/Squidex.Infrastructure/ValidationException.cs#L53

The docu says:

> Fallback Serialization:  .NET Core uses the ILBasedSerializer by default whereas .NET 4.6 uses BinaryFormatterSerializer by default.

But obviously it cannot be correct for exceptions and I am not sure if this behavior has been changed recently.

Futhermore the documentation says nothing about exceptions and serialization.

Some clarification would be great.","Exception serialization with .NET Core 2.0? Hi

I use Orleans since one of one of the earliest alphas for 2.0 with .NET Core and I think that I never had a problem with exceptions although I am not sure.

Recently we discovered a bug where validation details where not displayed correctly in the UI. It does not happen very often because there is also a lot of client side validation. Validation errors are transported with a custom validation exception something like:



Details was always Empty and the reason was that our serialization logic was not correct. So we fixed it: https://github.com/Squidex/squidex/blob/master/src/Squidex.Infrastructure/ValidationException.cs#L53

The docu says:

> Fallback Serialization:  .NET Core uses the ILBasedSerializer by default whereas .NET 4.6 uses BinaryFormatterSerializer by default.

But obviously it cannot be correct for exceptions and I am not sure if this behavior has been changed recently.

Futhermore the documentation says nothing about exceptions and serialization.

Some clarification would be great.",documentation,ReubenBond,,
5017,New code generator fails (2.1-RC2),"Using the new generator one of my project fails with the following error:

>  Using ""Exec"" task from assembly ""Microsoft.Build.Tasks.Core Version=15.1.0.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a"".
>        Task ""Exec""
>          ""/usr/share/dotnet/dotnet"" ""/home/sro/.nuget/packages/microsoft.orleans.codegenerator.msbuild/2.1.0-rc2/build/../tasks/netcoreapp2.0/Orleans.CodeGenerator.MSBuild.dll"" SourceToSource ""/home/sro/projects/xxx/src/Core.Grains/obj/Debug/netstandard2.0/Core.Grains.orleans.g.args.txt""
>          Orleans.CodeGenerator - command-line = SourceToSource /home/sro/projects/xxx/src/Core.Grains/obj/Debug/netstandard2.0/Core.Grains.orleans.g.args.txt
>          -- Code Generation FAILED -- 
>          
>          Exc level 0: System.InvalidOperationException: Unable to find type with metadata name ""System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute"".
>             at Orleans.CodeGenerator.WellKnownTypes.<FromCompilation>g__Type|0_0(String type <>c__DisplayClass0_0& )
>             at Orleans.CodeGenerator.WellKnownTypes.FromCompilation(Compilation compilation)
>             at Orleans.CodeGenerator.CodeGenerator..ctor(Compilation compilation ILogger log)
>             at Orleans.CodeGenerator.MSBuild.CodeGeneratorCommand.<Execute>d__39.MoveNext()
>          --- End of stack trace from previous location where exception was thrown ---
>             at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
>             at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
>             at Microsoft.Orleans.CodeGenerator.MSBuild.Program.SourceToSource(String[] args)
>             at Microsoft.Orleans.CodeGenerator.MSBuild.Program.Main(String[] args)
>    1:7>/home/sro/.nuget/packages/microsoft.orleans.codegenerator.msbuild/2.1.0-rc2/build/Microsoft.Orleans.CodeGenerator.MSBuild.targets(1225): error MSB3073: The command """"/usr/share/dotnet/dotnet"" ""/home/sro/.nuget/packages/microsoft.orleans.codegenerator.msbuild/2.1.0-rc2/build/../tasks/netcoreapp2.0/Orleans.CodeGenerator.MSBuild.dll"" SourceToSource ""/home/sro/projects/xxx/src/Core.Grains/obj/Debug/netstandard2.0/Core.Grains.orleans.g.args.txt"""" exited with code 3. [/home/sro/projects/xxx/src/Core.Grains/Core.Grains.csproj]
>        Done executing task ""Exec"" -- FAILED.

In total I have 4 projects using the generator and only 1 fails.
I use dotnet 2.1.402

I don't know how to provide you more information about the problem.","New code generator fails (2.1-RC2) Using the new generator one of my project fails with the following error:

>  Using ""Exec"" task from assembly ""Microsoft.Build.Tasks.Core Version=15.1.0.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a"".
>        Task ""Exec""
>          ""/usr/share/dotnet/dotnet"" ""/home/sro/.nuget/packages/microsoft.orleans.codegenerator.msbuild/2.1.0-rc2/build/../tasks/netcoreapp2.0/Orleans.CodeGenerator.MSBuild.dll"" SourceToSource ""/home/sro/projects/xxx/src/Core.Grains/obj/Debug/netstandard2.0/Core.Grains.orleans.g.args.txt""
>          Orleans.CodeGenerator - command-line = SourceToSource /home/sro/projects/xxx/src/Core.Grains/obj/Debug/netstandard2.0/Core.Grains.orleans.g.args.txt
>          -- Code Generation FAILED -- 
>          
>          Exc level 0: System.InvalidOperationException: Unable to find type with metadata name ""System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverageAttribute"".
>             at Orleans.CodeGenerator.WellKnownTypes.<FromCompilation>g__Type|0_0(String type <>c__DisplayClass0_0& )
>             at Orleans.CodeGenerator.WellKnownTypes.FromCompilation(Compilation compilation)
>             at Orleans.CodeGenerator.CodeGenerator..ctor(Compilation compilation ILogger log)
>             at Orleans.CodeGenerator.MSBuild.CodeGeneratorCommand.<Execute>d__39.MoveNext()
>          --- End of stack trace from previous location where exception was thrown ---
>             at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
>             at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
>             at Microsoft.Orleans.CodeGenerator.MSBuild.Program.SourceToSource(String[] args)
>             at Microsoft.Orleans.CodeGenerator.MSBuild.Program.Main(String[] args)
>    1:7>/home/sro/.nuget/packages/microsoft.orleans.codegenerator.msbuild/2.1.0-rc2/build/Microsoft.Orleans.CodeGenerator.MSBuild.targets(1225): error MSB3073: The command """"/usr/share/dotnet/dotnet"" ""/home/sro/.nuget/packages/microsoft.orleans.codegenerator.msbuild/2.1.0-rc2/build/../tasks/netcoreapp2.0/Orleans.CodeGenerator.MSBuild.dll"" SourceToSource ""/home/sro/projects/xxx/src/Core.Grains/obj/Debug/netstandard2.0/Core.Grains.orleans.g.args.txt"""" exited with code 3. [/home/sro/projects/xxx/src/Core.Grains/Core.Grains.csproj]
>        Done executing task ""Exec"" -- FAILED.

In total I have 4 projects using the generator and only 1 fails.
I use dotnet 2.1.402

I don't know how to provide you more information about the problem.",,ReubenBond,,
5016,Update changelog for 2.1.0-rc2,,Update changelog for 2.1.0-rc2 ,,xiazen,,
5015,Prevent packaging of Orleans.CodeGenerator.MSBuild.Tasks.csproj,This project generates an unneeded NuGet package that we don't need to and cannot publish to nuget.org.,Prevent packaging of Orleans.CodeGenerator.MSBuild.Tasks.csproj This project generates an unneeded NuGet package that we don't need to and cannot publish to nuget.org.,,ReubenBond,,
5014,Need to update whats_new_in_orleans.md with releases since 2.0.0,Need to append information about releases since 2.0.0.,Need to update whats_new_in_orleans.md with releases since 2.0.0 Need to append information about releases since 2.0.0.,documentation,JillHeaden,,
5013,How to write a client in .NET Standard 2.0 that can connect to old v1.5 server?,"I have an old Orleans v1.5 cluster which cannot be updated to v2 ATM.

I'm writing an Azure Function v2 which is a .NET Standard 2.0 application.

This applications needs an Orleans Client to connect to the old cluster. Unfortunately the latest available client library (NuGet: Microsoft.Orleans.Client 1.5.5) does not work with .NET Standard 2.0 (there is an issue with dependency injection described in #3325).

I tried using the latest v2 client (NuGet: Microsoft.Orleans.Client 2.0.3) but it is obviously not compatible with old cluster since it fails with an exception during connection:



Is there some workaround (legacy mode?) to make new client work with old server? There was a fix that would make the old client work with .NET Standard 2.0 (issue #3356) but it was never implemented into 1.5 branch.
","How to write a client in .NET Standard 2.0 that can connect to old v1.5 server? I have an old Orleans v1.5 cluster which cannot be updated to v2 ATM.

I'm writing an Azure Function v2 which is a .NET Standard 2.0 application.

This applications needs an Orleans Client to connect to the old cluster. Unfortunately the latest available client library (NuGet: Microsoft.Orleans.Client 1.5.5) does not work with .NET Standard 2.0 (there is an issue with dependency injection described in #3325).

I tried using the latest v2 client (NuGet: Microsoft.Orleans.Client 2.0.3) but it is obviously not compatible with old cluster since it fails with an exception during connection:



Is there some workaround (legacy mode?) to make new client work with old server? There was a fix that would make the old client work with .NET Standard 2.0 (issue #3356) but it was never implemented into 1.5 branch.
",question,sergeybykov,,
5009,Can a Grain subscribe to multiple streams at the same time?,Hi I've been trying to use Explicit Streams and have 2 separate clients calling the grain's method to subscribe to different streams. However when the 2nd client is trying to have the grain subscribe to a second stream (after it subscribed to a different stream) nothing happens. No errors no exceptions or anything. Can grains subscribe to multiple different streams at the same time (assuming all the OnNextAsync() are stubbed out)?.,Can a Grain subscribe to multiple streams at the same time? Hi I've been trying to use Explicit Streams and have 2 separate clients calling the grain's method to subscribe to different streams. However when the 2nd client is trying to have the grain subscribe to a second stream (after it subscribed to a different stream) nothing happens. No errors no exceptions or anything. Can grains subscribe to multiple different streams at the same time (assuming all the OnNextAsync() are stubbed out)?.,question,sergeybykov,,
5007,New CodeGenerator fails with packages such as Orleans.Dashboard which are built with old code generator,"I tested 2.1.0-ci.20180919.3 from myget.

The build works but when I run the application I get the following exception:



The stacktrace is from Orleans Dashboard which was build with the old code generator.

But because you added  a  new parameter it fails: https://github.com/dotnet/orleans/blob/ffabe550a7891e7378f9f076e88a8e3c184d967f/src/Orleans.Core.Abstractions/Serialization/SerializerFeature.cs#L36

A good old method overload should fix the problem.","New CodeGenerator fails with packages such as Orleans.Dashboard which are built with old code generator I tested 2.1.0-ci.20180919.3 from myget.

The build works but when I run the application I get the following exception:



The stacktrace is from Orleans Dashboard which was build with the old code generator.

But because you added  a  new parameter it fails: https://github.com/dotnet/orleans/blob/ffabe550a7891e7378f9f076e88a8e3c184d967f/src/Orleans.Core.Abstractions/Serialization/SerializerFeature.cs#L36

A good old method overload should fix the problem.",,ReubenBond,,
5003,CloudTable reference in Azure Table Storage is a singleton but it is not threadsafe,The  where one can borrow initialized clients from.,CloudTable reference in Azure Table Storage is a singleton but it is not threadsafe The  where one can borrow initialized clients from.,,xiazen,,
5002,Orleans CodeGenerator not found,"When we build our project in Visual Studio 2017 we get following error:
src\packages\Microsoft.Orleans.OrleansCodeGenerator.Build.1.5.3\build\Microsoft.Orleans.OrleansCodeGenerator.Build.targets(465): error :  could not be found!

This results in Orleans code files not being generated.
Has anyone faced this issue?
Installing latest updates to Visual Studio did not help.","Orleans CodeGenerator not found When we build our project in Visual Studio 2017 we get following error:
src\packages\Microsoft.Orleans.OrleansCodeGenerator.Build.1.5.3\build\Microsoft.Orleans.OrleansCodeGenerator.Build.targets(465): error :  could not be found!

This results in Orleans code files not being generated.
Has anyone faced this issue?
Installing latest updates to Visual Studio did not help.",,ReubenBond,,
5001,Add option to Orleans generated code  will be hidden from the debugging process,This is quite helpful when you don’t  want to go to stepping inside of a generated method while debugging.,Add option to Orleans generated code  will be hidden from the debugging process This is quite helpful when you don’t  want to go to stepping inside of a generated method while debugging.,codegen,ReubenBond,,
5000,[Question] Any plans for migration to netstandard2.1?,And start using improved .net core runtime and new built-in features like  and others?,[Question] Any plans for migration to netstandard2.1? And start using improved .net core runtime and new built-in features like  and others?,,sergeybykov,,
4999,When ClientBuilder.Build() throw  System.ExecutionEngineException,"
when exec at the function ValidateSystemConfigurationthrow System.ExecutionEngineException;","When ClientBuilder.Build() throw  System.ExecutionEngineException 
when exec at the function ValidateSystemConfigurationthrow System.ExecutionEngineException;",,xiazen,,
4998,How to debug the source code using Visual Studio 2017?,Is it possible to debug the Orleans source code in my projects?,How to debug the source code using Visual Studio 2017? Is it possible to debug the Orleans source code in my projects?,,ReubenBond,,
4997,ServiceId_SiloRestart test fails intermittently,"UnitTests.Streaming.StreamProvidersTests_ProviderConfigNotLoaded.ServiceId_SiloRestart fails intermittently


MESSAGE:
Orleans.Runtime.OrleansLifecycleCanceledException : Lifecycle start canceled due to errors at stage 19999\r\n---- System.TimeoutException : MembershipOracle activating failed due to timeout 00:05:00
+++++++++++++++++++
STACK TRACE:
at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 63 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.<Execute>d__8.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Scheduler\ClosureWorkItem.cs:line 63 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Silo.<StartAsync>d__65.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Silo\Silo.cs:line 274 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.TestingHost.InProcessSiloHandle.Create(String siloName IList1 configurationOverrides Boolean startSiloOnNewPort) in D:\j\workspace\functional_pr---83d31c72\src\Orleans.TestingHost\TestCluster.cs:line 521 at Orleans.TestingHost.TestCluster.RestartSilo(SiloHandle instance) in D:\j\workspace\functional_pr---83d31c72\src\Orleans.TestingHost\TestCluster.cs:line 419 at UnitTests.Streaming.StreamProvidersTests_ProviderConfigNotLoaded.<ServiceId_SiloRestart>d__9.MoveNext() in D:\j\workspace\functional_pr---83d31c72\test\TesterInternal\StreamProvidersTests.cs:line 92 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) ----- Inner Stack Trace ----- at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Core\Async\TaskExtensions.cs:line 0 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Silo.<<OnBecomeActiveStart>g__BecomeActive|73_1>d.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Silo\Silo.cs:line 527 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Silo.<StartAsyncTaskWithPerfAnalysis>d__70.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Silo\Silo.cs:line 395 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Silo.<OnBecomeActiveStart>d__73.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Silo\Silo.cs:line 529 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.SiloLifecycleSubject.MonitoredObserver.<OnStart>d__9.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Lifecycle\SiloLifecycleSubject.cs:line 82 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.LifecycleSubject.<WrapExecution>d__10.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 115 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 55","ServiceId_SiloRestart test fails intermittently UnitTests.Streaming.StreamProvidersTests_ProviderConfigNotLoaded.ServiceId_SiloRestart fails intermittently


MESSAGE:
Orleans.Runtime.OrleansLifecycleCanceledException : Lifecycle start canceled due to errors at stage 19999\r\n---- System.TimeoutException : MembershipOracle activating failed due to timeout 00:05:00
+++++++++++++++++++
STACK TRACE:
at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 63 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.<Execute>d__8.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Scheduler\ClosureWorkItem.cs:line 63 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Silo.<StartAsync>d__65.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Silo\Silo.cs:line 274 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.TestingHost.InProcessSiloHandle.Create(String siloName IList1 configurationOverrides Boolean startSiloOnNewPort) in D:\j\workspace\functional_pr---83d31c72\src\Orleans.TestingHost\TestCluster.cs:line 521 at Orleans.TestingHost.TestCluster.RestartSilo(SiloHandle instance) in D:\j\workspace\functional_pr---83d31c72\src\Orleans.TestingHost\TestCluster.cs:line 419 at UnitTests.Streaming.StreamProvidersTests_ProviderConfigNotLoaded.<ServiceId_SiloRestart>d__9.MoveNext() in D:\j\workspace\functional_pr---83d31c72\test\TesterInternal\StreamProvidersTests.cs:line 92 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) ----- Inner Stack Trace ----- at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Core\Async\TaskExtensions.cs:line 0 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Silo.<<OnBecomeActiveStart>g__BecomeActive|73_1>d.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Silo\Silo.cs:line 527 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Silo.<StartAsyncTaskWithPerfAnalysis>d__70.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Silo\Silo.cs:line 395 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.Silo.<OnBecomeActiveStart>d__73.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Silo\Silo.cs:line 529 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.Runtime.SiloLifecycleSubject.MonitoredObserver.<OnStart>d__9.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Runtime\Lifecycle\SiloLifecycleSubject.cs:line 82 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.LifecycleSubject.<WrapExecution>d__10.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 115 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext() in D:\j\workspace\functional_pr---83d31c72\src\Orleans.Core\Lifecycle\LifecycleSubject.cs:line 55",test-issue,benjaminpetit,,
4996,Resolve transaction on abort.,"Abort and Cancel calls are no longer one way.  When transactions return abort exceptions they can usually be retried immediately.  In some rare cases this will cause a single cascade abort.


Correctness testing and fault testing now enabled.
","Resolve transaction on abort. Abort and Cancel calls are no longer one way.  When transactions return abort exceptions they can usually be retried immediately.  In some rare cases this will cause a single cascade abort.


Correctness testing and fault testing now enabled.
",,xiazen,,
4995,Revert Microsoft.ServiceFabric.Services version,Upgrading even the patch version of the  is a breaking change and requires the user to upgrade their SF cluster. Please consider to revert this back to 3.0.456.,Revert Microsoft.ServiceFabric.Services version Upgrading even the patch version of the  is a breaking change and requires the user to upgrade their SF cluster. Please consider to revert this back to 3.0.456.,,ReubenBond,,
4994,Use grain state type when deserializing json state in azure table sto…,…rage. Fixes #4993,Use grain state type when deserializing json state in azure table sto… …rage. Fixes #4993,,ReubenBond,,
4993,InvalidCastException when deserializing json state when custom JsonProperty is used with TypeNameHandling.None,".

A PR is coming...
","InvalidCastException when deserializing json state when custom JsonProperty is used with TypeNameHandling.None .

A PR is coming...
",,ReubenBond,,
4992,Distributed tracing and Orleans,"# Goal
Distributed tracing that works out-of-the-box with other Microsoft libraries like System.Net (HttpClient) EntityFramework Event Hubs SDK and Service Bus SDK.

# Value
I want to instrument my Orleans application in a way I can correlate events so I can trace the effect of any one request across an entire system across service boundaries. As an example by adding a trace identifier to a HTTP request I want to see that it reaches my gateway (in ASP.NET Core) each grain it hits (in Orleans) the messages it creates (on an Event Hub) and the database transaction it executes (via Entity Framework). 

# Background
I understand Orleans provides an [ActivityId](https://github.com/dotnet/orleans/blob/dad62cc16d4d6de671563f6b1e54196f617926a5/src/Orleans.Core.Abstractions/Runtime/RequestContext.cs#L37) however it doesn't cover distributed tracing out-of-the-box (i.e. flowing that ActivityId to other systems).

I looked at how other Microsoft libraries did this (e.g. [System.Net](https://github.com/dotnet/corefx/blob/master/src/System.Net.Http/src/System/Net/Http/DiagnosticsHandler.cs) [Event Hubs SDK](https://github.com/Azure/azure-event-hubs-dotnet/blob/1a890942ce86339ef4ed97f9246acf36823cb4f7/src/Microsoft.Azure.EventHubs/EventHubsDiagnosticSource.cs)) and they seem to be converging on [System.Diagnostics.Activity](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/System/Diagnostics/Activity.cs) which is available as an AsyncLocal container (Activity.Current) for carrying diagnostic context. (More information about Activity is in [the user guide](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md).)
Unfortunately it's not something that is used with Microsoft.Extension.Logging but rather introduces a (yet another) new diagnostic API: [System.Diagnostics.DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/System/Diagnostics/DiagnosticSource.cs). DiagnosticSource is distinct from other logging systems in that it's to be consumed in-process and sources normally provide rich payloads.
(More information about DiagnosticSource is in [the user guide](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md).)

Libraries using Activity which make or receive external calls often implement some variation of [this correlation protocol](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/HttpCorrelationProtocol.md). This means that the Activity is emitted on outbound requests and resumed on inbound requests.
It [looks](https://github.com/aspnet/Hosting/issues/1457) [like](https://github.com/dotnet/corefx/issues/30332) there is work underway to standardize (the header names) based on the [W3C spec for distributed tracing](https://w3c.github.io/distributed-tracing/report-trace-context.html). However Orleans should be able to be instrumented now without being affected by these changes. (Client-to-Orleans calls are via an Orleans-provided library so I don't think a change in header names would be a breaking change.)
~~(There (hopefully?) won't be any change to Activity itself [depending on this discussion](https://github.com/dotnet/corefx/issues/30331).)~~
Edit: See @lmolkova's comment for details on the impact of W3C distributed tracing.

# Implementation
There is official guidance for [Activity](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md) and [DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) but newer documentation is work-in-progress and [available here](https://github.com/Microsoft/ApplicationInsights-dotnet-server/pull/917).

Based on [the experience of people who have consumed DiagnosticSources before](https://github.com/MiniProfiler/dotnet/issues/322#issuecomment-421198415) it looks like a implementation similar to Entity Framework [where the events are typed](https://github.com/aspnet/EntityFrameworkCore/pull/8351) would be preferable.

My insight only goes as deep as poking around over the last week. I've come across people who seem very involved in the .NET and distributed tracing space who might be able to chime in and enlighten us about the right way of approaching this such as @SergeyKanzhelev @lmolkova and @cwe1ss.

## Minimal
A minimal implementation would allow the Activity to flow across service boundaries with a DiagnosticSource for grain requests. Log providers (ILoggerProvider) could optionally listen to this DiagnosticSource (or all DiagnosticSources) and enrich the logs with the Activity context.

* Add an interceptor to start an Activity and add it to the [RequestContext](https://github.com/dotnet/orleans/blob/master/src/Orleans.Core.Abstractions/Runtime/RequestContext.cs).
   @rikbosch has a gist with an implementation of [this part here](https://github.com/dotnet/orleans/issues/3093#issuecomment-308039802).
* Add a client-side interceptor (if that's a thing) which starts an Activity and adds it to the RequestContext.
* Add documentation for log providers wanting to enrich logs with the Activity context and/or document which providers work like this out of the box.
   @SergeyKanzhelev does App Insight's (ASP.NET Core?) ILoggerProvider implementation already make use of the Activity.Current for correlation? I saw [this](https://docs.microsoft.com/en-us/azure/application-insights/application-insights-correlation) but does that mean it'll work for any DiagnosticSource?
   >Application Insights SDK starting version 2.4.0-beta1 uses DiagnosticSource and Activity to collect telemetry and associate it with the current activity.

## Extended
An extended implementation might go so far as to replace ILogger use in Orleans with DiagnosticSources and provide adapters back to ILogger (and to ITelemetryProvider for performance counters). I think the value of going this far would be to offer richer diagnostics to people who want it (e.g. someone who wants to build a profiler) and a single diagnostics API for Orleans. (The minimal implementation would mean Orleans would offer both ILogger and DiagnosticSource which is ugh.)
","Distributed tracing and Orleans # Goal
Distributed tracing that works out-of-the-box with other Microsoft libraries like System.Net (HttpClient) EntityFramework Event Hubs SDK and Service Bus SDK.

# Value
I want to instrument my Orleans application in a way I can correlate events so I can trace the effect of any one request across an entire system across service boundaries. As an example by adding a trace identifier to a HTTP request I want to see that it reaches my gateway (in ASP.NET Core) each grain it hits (in Orleans) the messages it creates (on an Event Hub) and the database transaction it executes (via Entity Framework). 

# Background
I understand Orleans provides an [ActivityId](https://github.com/dotnet/orleans/blob/dad62cc16d4d6de671563f6b1e54196f617926a5/src/Orleans.Core.Abstractions/Runtime/RequestContext.cs#L37) however it doesn't cover distributed tracing out-of-the-box (i.e. flowing that ActivityId to other systems).

I looked at how other Microsoft libraries did this (e.g. [System.Net](https://github.com/dotnet/corefx/blob/master/src/System.Net.Http/src/System/Net/Http/DiagnosticsHandler.cs) [Event Hubs SDK](https://github.com/Azure/azure-event-hubs-dotnet/blob/1a890942ce86339ef4ed97f9246acf36823cb4f7/src/Microsoft.Azure.EventHubs/EventHubsDiagnosticSource.cs)) and they seem to be converging on [System.Diagnostics.Activity](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/System/Diagnostics/Activity.cs) which is available as an AsyncLocal container (Activity.Current) for carrying diagnostic context. (More information about Activity is in [the user guide](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md).)
Unfortunately it's not something that is used with Microsoft.Extension.Logging but rather introduces a (yet another) new diagnostic API: [System.Diagnostics.DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/System/Diagnostics/DiagnosticSource.cs). DiagnosticSource is distinct from other logging systems in that it's to be consumed in-process and sources normally provide rich payloads.
(More information about DiagnosticSource is in [the user guide](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md).)

Libraries using Activity which make or receive external calls often implement some variation of [this correlation protocol](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/HttpCorrelationProtocol.md). This means that the Activity is emitted on outbound requests and resumed on inbound requests.
It [looks](https://github.com/aspnet/Hosting/issues/1457) [like](https://github.com/dotnet/corefx/issues/30332) there is work underway to standardize (the header names) based on the [W3C spec for distributed tracing](https://w3c.github.io/distributed-tracing/report-trace-context.html). However Orleans should be able to be instrumented now without being affected by these changes. (Client-to-Orleans calls are via an Orleans-provided library so I don't think a change in header names would be a breaking change.)
~~(There (hopefully?) won't be any change to Activity itself [depending on this discussion](https://github.com/dotnet/corefx/issues/30331).)~~
Edit: See @lmolkova's comment for details on the impact of W3C distributed tracing.

# Implementation
There is official guidance for [Activity](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md) and [DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) but newer documentation is work-in-progress and [available here](https://github.com/Microsoft/ApplicationInsights-dotnet-server/pull/917).

Based on [the experience of people who have consumed DiagnosticSources before](https://github.com/MiniProfiler/dotnet/issues/322#issuecomment-421198415) it looks like a implementation similar to Entity Framework [where the events are typed](https://github.com/aspnet/EntityFrameworkCore/pull/8351) would be preferable.

My insight only goes as deep as poking around over the last week. I've come across people who seem very involved in the .NET and distributed tracing space who might be able to chime in and enlighten us about the right way of approaching this such as @SergeyKanzhelev @lmolkova and @cwe1ss.

## Minimal
A minimal implementation would allow the Activity to flow across service boundaries with a DiagnosticSource for grain requests. Log providers (ILoggerProvider) could optionally listen to this DiagnosticSource (or all DiagnosticSources) and enrich the logs with the Activity context.

* Add an interceptor to start an Activity and add it to the [RequestContext](https://github.com/dotnet/orleans/blob/master/src/Orleans.Core.Abstractions/Runtime/RequestContext.cs).
   @rikbosch has a gist with an implementation of [this part here](https://github.com/dotnet/orleans/issues/3093#issuecomment-308039802).
* Add a client-side interceptor (if that's a thing) which starts an Activity and adds it to the RequestContext.
* Add documentation for log providers wanting to enrich logs with the Activity context and/or document which providers work like this out of the box.
   @SergeyKanzhelev does App Insight's (ASP.NET Core?) ILoggerProvider implementation already make use of the Activity.Current for correlation? I saw [this](https://docs.microsoft.com/en-us/azure/application-insights/application-insights-correlation) but does that mean it'll work for any DiagnosticSource?
   >Application Insights SDK starting version 2.4.0-beta1 uses DiagnosticSource and Activity to collect telemetry and associate it with the current activity.

## Extended
An extended implementation might go so far as to replace ILogger use in Orleans with DiagnosticSources and provide adapters back to ILogger (and to ITelemetryProvider for performance counters). I think the value of going this far would be to offer richer diagnostics to people who want it (e.g. someone who wants to build a profiler) and a single diagnostics API for Orleans. (The minimal implementation would mean Orleans would offer both ILogger and DiagnosticSource which is ugh.)
",,ReubenBond,,
4990,Start silo fails with System.IndexOutOfRangeException on 2.1.0,"#### Environments:
* Windows 10 1803
* Visual Studio 2017 15.9.0 Preview 2.0
* .NET Core SDK 2.1.402
* Orleans 2.1.0-rc1

#### Issue:
Silo failed to start with error:

> info: Orleans.Runtime.Silo[100452]
      Start Incoming message agents took 33 Milliseconds to finish
info: Orleans.Threading.ThreadPoolThread[0]
      Starting thread Runtime.Messaging.IncomingMessageAgent/Application0 on managed thread 22
info: Orleans.Runtime.GrainDirectory.LocalGrainDirectory[0]
      Start
info: Runtime.GrainDirectory.AdaptiveDirectoryCacheMaintainer .**

","Start silo fails with System.IndexOutOfRangeException on 2.1.0 #### Environments:
* Windows 10 1803
* Visual Studio 2017 15.9.0 Preview 2.0
* .NET Core SDK 2.1.402
* Orleans 2.1.0-rc1

#### Issue:
Silo failed to start with error:

> info: Orleans.Runtime.Silo[100452]
      Start Incoming message agents took 33 Milliseconds to finish
info: Orleans.Threading.ThreadPoolThread[0]
      Starting thread Runtime.Messaging.IncomingMessageAgent/Application0 on managed thread 22
info: Orleans.Runtime.GrainDirectory.LocalGrainDirectory[0]
      Start
info: Runtime.GrainDirectory.AdaptiveDirectoryCacheMaintainer .**

",documentation,sergeybykov,,
4989,Reminders documentation improvement idea,"This knowledge should be added to the Orleans reminders documentation: 

![image](https://user-images.githubusercontent.com/1445862/43936561-5d9737c4-9c9c-11e8-80df-43f80fb6d241.png)
","Reminders documentation improvement idea This knowledge should be added to the Orleans reminders documentation: 

![image](https://user-images.githubusercontent.com/1445862/43936561-5d9737c4-9c9c-11e8-80df-43f80fb6d241.png)
",documentation,JillHeaden,,
4988,Move implementation details pages to the respective section,,Move implementation details pages to the respective section ,documentation,jason-bragg,,
4987,Add changelog for 2.1.0-rc1,,Add changelog for 2.1.0-rc1 ,,xiazen,,
4986,ToTypedTask<T> fails with NullReferenceException on ASP.NET Core 2.1,"I'm working on developing an ASP.NET Core Web API to front-end an Orleans cluster for image management. I'm leveraging ASP.NET Core 2.1 because of the new 

Edit: added package config.","ToTypedTask<T> fails with NullReferenceException on ASP.NET Core 2.1 I'm working on developing an ASP.NET Core Web API to front-end an Orleans cluster for image management. I'm leveraging ASP.NET Core 2.1 because of the new 

Edit: added package config.",,ReubenBond,,
4985,Durability Guarantees,When I save the actor state what are the durability guarantees?  How long before that data is actually persisted?,Durability Guarantees When I save the actor state what are the durability guarantees?  How long before that data is actually persisted?,question,ReubenBond,14/09/2018 14:57,5/10/2018 4:17
4984,Revist Transaction serialization,"* Consider passing object directly to transaction storage APIs (rather than serialized)
* Ensure that grain references can be serialized by user code

Backwards compatibility is required by the time transactions are stabilized.

cc @jason-bragg 
","Revist Transaction serialization * Consider passing object directly to transaction storage APIs (rather than serialized)
* Ensure that grain references can be serialized by user code

Backwards compatibility is required by the time transactions are stabilized.

cc @jason-bragg 
",,jason-bragg,,
4981,Move advanced topis and implementation details to separate sections,This is to unclutter the core documentation about grains.,Move advanced topis and implementation details to separate sections This is to unclutter the core documentation about grains.,documentation,jason-bragg,,
4978,Add TableName to Azure Storage clustering and reminders config,"This resolves: https://github.com/dotnet/orleans/issues/4971
As it is implemented here it solves our needs.

As far as I could see there are no validators for these options but I can whip some up in a separate PR.

One open question: Should this also be made configurable for AzureSilo and the tests?","Add TableName to Azure Storage clustering and reminders config This resolves: https://github.com/dotnet/orleans/issues/4971
As it is implemented here it solves our needs.

As far as I could see there are no validators for these options but I can whip some up in a separate PR.

One open question: Should this also be made configurable for AzureSilo and the tests?",,xiazen,,
4977,Fix logo on README.md,"Seems that a recent change in the gh-pages branch broke the logo at the top of our README
Previously the logo was here: https://github.com/dotnet/orleans/blob/gh-pages/assets/logo_full.png","Fix logo on README.md Seems that a recent change in the gh-pages branch broke the logo at the top of our README
Previously the logo was here: https://github.com/dotnet/orleans/blob/gh-pages/assets/logo_full.png",,JillHeaden,,
4975,Using streams with RabbitMQ,"Hi I'm learning about Streams and am interested in using it together with a message queuing system like RabbitMQ. My use case can have potentially a large number of requests and I want to be able to implement throttling (such as limiting the number of Grains that are doing work at a time) and work priority. My use case is similar to a cloud base Borg Hivemind trying to conquer the universe.

I was thinking to have a master queue like RabbitMQ hold all the tasks that a Borg unit would do and a large number of BorgUnitGrain would subscribe to and perform tasks listed in the RabbitMQ master queue as they receive them. 

I want to be able to control concurrency and throttling on a per planet basis for assimilation so multiple planets could be marked but I only want a set number of BorgUnitGrains to be working on a planet at a time. I was thinking that I can control concurrency by having an orchestrator control what tasks get pushed onto RabbitMQ to be divided up by the BorgUnitGrains. Do you guys have any recommendations for what I'm trying to do?","Using streams with RabbitMQ Hi I'm learning about Streams and am interested in using it together with a message queuing system like RabbitMQ. My use case can have potentially a large number of requests and I want to be able to implement throttling (such as limiting the number of Grains that are doing work at a time) and work priority. My use case is similar to a cloud base Borg Hivemind trying to conquer the universe.

I was thinking to have a master queue like RabbitMQ hold all the tasks that a Borg unit would do and a large number of BorgUnitGrain would subscribe to and perform tasks listed in the RabbitMQ master queue as they receive them. 

I want to be able to control concurrency and throttling on a per planet basis for assimilation so multiple planets could be marked but I only want a set number of BorgUnitGrains to be working on a planet at a time. I was thinking that I can control concurrency by having an orchestrator control what tasks get pushed onto RabbitMQ to be divided up by the BorgUnitGrains. Do you guys have any recommendations for what I'm trying to do?",question,xiazen,,
4973,"No storage provider named ""PubSubStore"" found loading grain type Orleans.Streams.PubSubRendezvousGrain.","When I used IAsyncstream to notify the client I was prompted that a storage provider named “PubSubStore” was not found but I did configure the storage provider only the configuration name was not “PubSubStore” and if I had storage provider's name configured as “PubSubStore” there would be no problem. In the end I found the class PubSubRendezvousGrain in the source code with the attribute[Storageprovider (ProviderName =  ""Pubsubstore"")] so I wonder if  this attribute is the reason I have to configure a stroage provider named PubSubStore?","No storage provider named ""PubSubStore"" found loading grain type Orleans.Streams.PubSubRendezvousGrain. When I used IAsyncstream to notify the client I was prompted that a storage provider named “PubSubStore” was not found but I did configure the storage provider only the configuration name was not “PubSubStore” and if I had storage provider's name configured as “PubSubStore” there would be no problem. In the end I found the class PubSubRendezvousGrain in the source code with the attribute[Storageprovider (ProviderName =  ""Pubsubstore"")] so I wonder if  this attribute is the reason I have to configure a stroage provider named PubSubStore?",question,sergeybykov,,
4971,Make Azure Storage table name (OrleansSiloInstances OrleansReminders) configurable,"We're looking into deploying concurrent and disposable instances of our application.
To reduce the amount of orchestration we intend to re-use a single Azure Storage Accounts for multiple deployments of our application concurrently.

State storage can already sufficiently configure to not collide using  be extended to take a table name?

This would allow us to clean up after we pull down an instance of the application by just deleting the named tables and container.

Meanwhile as a workaround would using a different ClusterId allow multiple independent Orleans clusters to run side by side on the same tables?","Make Azure Storage table name (OrleansSiloInstances, OrleansReminders) configurable We're looking into deploying concurrent and disposable instances of our application.
To reduce the amount of orchestration we intend to re-use a single Azure Storage Accounts for multiple deployments of our application concurrently.

State storage can already sufficiently configure to not collide using  be extended to take a table name?

This would allow us to clean up after we pull down an instance of the application by just deleting the named tables and container.

Meanwhile as a workaround would using a different ClusterId allow multiple independent Orleans clusters to run side by side on the same tables?",,xiazen,,
4969,Strange timers behaviour in Orleans 1.5.4,"We just spotted some strange timers behaviour in our system. 
We have a healthGrain which performs some basic operations in cluster.
Invocation of that grain is in our  so I would assume there is only 1 grain activation in the cluster. Previously we had bug when api endpoint was calling grain with random Guid and that registered plenty of reminders. We fixed it now it uses Guid.Empty as grain id and cleaned up reminders from system table. But timers are stateless and looks like there is something wrong either in Timers or in our code. And I can't understand what's and where.","Strange timers behaviour in Orleans 1.5.4 We just spotted some strange timers behaviour in our system. 
We have a healthGrain which performs some basic operations in cluster.
Invocation of that grain is in our  so I would assume there is only 1 grain activation in the cluster. Previously we had bug when api endpoint was calling grain with random Guid and that registered plenty of reminders. We fixed it now it uses Guid.Empty as grain id and cleaned up reminders from system table. But timers are stateless and looks like there is something wrong either in Timers or in our code. And I can't understand what's and where.",,sergeybykov,,
4968,More fixed to TOC,"Added commit operation to pre store actions.
This still doesn't work correctly with batching in all cases but does not violate non-toc transaction semantics.  TOC is still not production ready.","More fixed to TOC Added commit operation to pre store actions.
This still doesn't work correctly with batching in all cases but does not violate non-toc transaction semantics.  TOC is still not production ready.",,xiazen,,
4966,Argument Null Exception on 1.5 Cluster Startup,"I've been testing our stuff on a localhost primary silo setup for a while now and finally moved to getting onto a cluster setup. But I can't get even one silo started. I keep getting this error on startup:

![image](https://user-images.githubusercontent.com/4165786/45377348-504b5100-b5c8-11e8-9c62-812c4292548c.png)

I figure I must be missing something in the config but I can figure out what. 

Here's my startup code:

","Argument Null Exception on 1.5 Cluster Startup I've been testing our stuff on a localhost primary silo setup for a while now and finally moved to getting onto a cluster setup. But I can't get even one silo started. I keep getting this error on startup:

![image](https://user-images.githubusercontent.com/4165786/45377348-504b5100-b5c8-11e8-9c62-812c4292548c.png)

I figure I must be missing something in the config but I can figure out what. 

Here's my startup code:

",,ReubenBond,,
4965,ArgumentNullException thrown when stopping the silo,"When the silo is starting to shut down gracefully at some point strange exceptions has been thrown.
The most important ones:

the silo is deployed to the Kubernetus v1.10.6-gke.2 with 3 replicas as a StatefulSet using AdoNet clustering provider
Orleans v2.1.0-beta1
dotnet sdk v2.1.401
dotnet runtime v2.1.3

Looks like there is something bad happened in the corefx blocking collection.
Regarding ObjectDisposedException it really minor but a bit annoying because why the silo is trying to dispose the service provider again?
Does anyone know anything about this?
","ArgumentNullException thrown when stopping the silo When the silo is starting to shut down gracefully at some point strange exceptions has been thrown.
The most important ones:

the silo is deployed to the Kubernetus v1.10.6-gke.2 with 3 replicas as a StatefulSet using AdoNet clustering provider
Orleans v2.1.0-beta1
dotnet sdk v2.1.401
dotnet runtime v2.1.3

Looks like there is something bad happened in the corefx blocking collection.
Regarding ObjectDisposedException it really minor but a bit annoying because why the silo is trying to dispose the service provider again?
Does anyone know anything about this?
",,xiazen,,
4964,Troubleshooting help not available,"In orleans/src/Orleans.Core/Runtime/Constants.cs the link
https://aka.ms/orleans-troubleshooting
is referenced which shows up for an error in our deployed version. It doesn't lead to any page though. Please correct the link.

Thanks!","Troubleshooting help not available In orleans/src/Orleans.Core/Runtime/Constants.cs the link
https://aka.ms/orleans-troubleshooting
is referenced which shows up for an error in our deployed version. It doesn't lead to any page though. Please correct the link.

Thanks!",documentation,JillHeaden,,
4963,Code generation fails when running dotnet build without --no-restore flag,"Possibly the same problem as #4877 (so the --no-restore flag might be a possible workaround there)
Using version 2.1.0-beta1 on Windows. 
Building the project from Visual Studio also works fine.
Let me know if you need more information to reproduce

The error I get is : 
","Code generation fails when running dotnet build without --no-restore flag Possibly the same problem as #4877 (so the --no-restore flag might be a possible workaround there)
Using version 2.1.0-beta1 on Windows. 
Building the project from Visual Studio also works fine.
Let me know if you need more information to reproduce

The error I get is : 
",,ReubenBond,,
4962,SQL Schema files should be mentioned in the documentation,"The files are available in the [repo](https://github.com/dotnet/orleans/tree/master/src/AdoNet/Orleans.Clustering.AdoNet) but are not referenced in the 2.0 documentation. They are referenced in the [1.5 documentation](https://dotnet.github.io/orleans/1.5/Documentation/Deployment-and-Operations/Configuration-Guide/Configuring-SQL-Tables.html). 

Perhaps these pages are a good candidate to mention how to setup cluster membership table:
* https://dotnet.github.io/orleans/Documentation/clusters_and_clients/configuration_guide/server_configuration.html
* https://dotnet.github.io/orleans/Documentation/deployment/cluster_management.html

Other persistence specifics (i.e. how to setup Azure Table Storage Consul etc.) should be documented as well.","SQL Schema files should be mentioned in the documentation The files are available in the [repo](https://github.com/dotnet/orleans/tree/master/src/AdoNet/Orleans.Clustering.AdoNet) but are not referenced in the 2.0 documentation. They are referenced in the [1.5 documentation](https://dotnet.github.io/orleans/1.5/Documentation/Deployment-and-Operations/Configuration-Guide/Configuring-SQL-Tables.html). 

Perhaps these pages are a good candidate to mention how to setup cluster membership table:
* https://dotnet.github.io/orleans/Documentation/clusters_and_clients/configuration_guide/server_configuration.html
* https://dotnet.github.io/orleans/Documentation/deployment/cluster_management.html

Other persistence specifics (i.e. how to setup Azure Table Storage Consul etc.) should be documented as well.",documentation,sergeybykov,11/09/2018 16:42,
4961,Fix azure streaming tests,some azure streaming tests failed due to diff introduced to WaitUntilAsync in pr #4923 . It is not necessarily the changes in WaitUtilAcync is wrong is how those tests uses it is slightly wrong IMO. For a quick fix let's revert WaitUtilAsync's behavior to its original when  the test use WaitUtilAsync to ensure producer produced. After the pr producer would produce far less leaving little time for consumer to react before being checked. The time of a message sent from producer to consumer is short but apparently not that short ;) ,Fix azure streaming tests some azure streaming tests failed due to diff introduced to WaitUntilAsync in pr #4923 . It is not necessarily the changes in WaitUtilAcync is wrong is how those tests uses it is slightly wrong IMO. For a quick fix let's revert WaitUtilAsync's behavior to its original when  the test use WaitUtilAsync to ensure producer produced. After the pr producer would produce far less leaving little time for consumer to react before being checked. The time of a message sent from producer to consumer is short but apparently not that short ;) ,,jason-bragg,,
4960,Question about 2.0 ChatRoom example,"How can the Channel grain detect when a user disconnects/closes the Client app in order to remove them from the onlineMembers list?

I know the client can leave the channel but I wanted to know of a more reliable way to detect this since if a client just closes the app without leaving the channel the user remains in the onlineMembers list indefinitely.","Question about 2.0 ChatRoom example How can the Channel grain detect when a user disconnects/closes the Client app in order to remove them from the onlineMembers list?

I know the client can leave the channel but I wanted to know of a more reliable way to detect this since if a client just closes the app without leaving the channel the user remains in the onlineMembers list indefinitely.",question,sergeybykov,,
4958,Multiclustering using Oracle,"Just wanted to know whether the oracle implementation for gossip channel is complete and ready to use?

I was referring to the class MultiClusterOracle.cs","Multiclustering using Oracle Just wanted to know whether the oracle implementation for gossip channel is complete and ready to use?

I was referring to the class MultiClusterOracle.cs",question,sergeybykov,,
4957,Standardize naming create content for resources/index.md and make m…,"…inor grammatical changes.

","Standardize naming, create content for resources/index.md, and make m… …inor grammatical changes.

",documentation,sergeybykov,11/09/2018 0:08,22/09/2018 2:09
4956,Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0,"Orleans version: 2.1.0-beta1

SDK: .NET Core 2.1.401

Tragetframework: netstandard2.0

Detail:  Works findif I switch targetframework to netcoreapp2.1.

ErrorMessage:
 Orleans-CodeGen - Generating file C:\Users\Jz.Fan\Source\Repos\Ray\Ray.Core\obj\Debug\netstandard2.0\Ray.Core.orleans.g.cs
  warn: Orleans.CodeGenerator.RoslynCodeGenerator[101723]
        Exception loading types from assembly 'Ray.Core Version=1.1.5.0 Culture=neutral PublicKeyToken=null':
        Exc level 0: System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
           at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
           at System.Reflection.RuntimeAssembly.get_DefinedTypes()
           at Orleans.Runtime.TypeUtils.GetDefinedTypes(Assembly assembly ILogger logger) in D:\build\agent\_work\25\s\src\Orleans.Core\CodeGeneration\TypeUtils.cs:line 561
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。.
  System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
     at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
     at System.Reflection.RuntimeAssembly.get_DefinedTypes()
     at Orleans.Runtime.TypeUtils.GetDefinedTypes(Assembly assembly ILogger logger) in D:\build\agent\_work\25\s\src\Orleans.Core\CodeGeneration\TypeUtils.cs:line 561
  warn: Orleans.CodeGenerator.RoslynCodeGenerator[101723]
        Exception loading types from assembly 'Ray.Core Version=1.1.5.0 Culture=neutral PublicKeyToken=null':
        Exc level 0: System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
           at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
           at System.Reflection.RuntimeAssembly.get_DefinedTypes()
           at Orleans.Runtime.TypeUtils.GetDefinedTypes(Assembly assembly ILogger logger) in D:\build\agent\_work\25\s\src\Orleans.Core\CodeGeneration\TypeUtils.cs:line 561
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。.
  System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
     at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
     at System.Reflection.RuntimeAssembly.get_DefinedTypes()
     at Orleans.Runtime.TypeUtils.GetDefinedTypes(Assembly assembly ILogger logger) in D:\build\agent\_work\25\s\src\Orleans.Core\CodeGeneration\TypeUtils.cs:line 561
  Orleans-CodeGen - Generated file written C:\Users\Jz.Fan\Source\Repos\Ray\Ray.Core\obj\Debug\netstandard2.0\Ray.Core.orleans.g.cs","Could not load file or assembly 'System.Threading.Tasks.Extensions, Version=4.2.0.0 Orleans version: 2.1.0-beta1

SDK: .NET Core 2.1.401

Tragetframework: netstandard2.0

Detail:  Works findif I switch targetframework to netcoreapp2.1.

ErrorMessage:
 Orleans-CodeGen - Generating file C:\Users\Jz.Fan\Source\Repos\Ray\Ray.Core\obj\Debug\netstandard2.0\Ray.Core.orleans.g.cs
  warn: Orleans.CodeGenerator.RoslynCodeGenerator[101723]
        Exception loading types from assembly 'Ray.Core Version=1.1.5.0 Culture=neutral PublicKeyToken=null':
        Exc level 0: System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
           at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
           at System.Reflection.RuntimeAssembly.get_DefinedTypes()
           at Orleans.Runtime.TypeUtils.GetDefinedTypes(Assembly assembly ILogger logger) in D:\build\agent\_work\25\s\src\Orleans.Core\CodeGeneration\TypeUtils.cs:line 561
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。.
  System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
     at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
     at System.Reflection.RuntimeAssembly.get_DefinedTypes()
     at Orleans.Runtime.TypeUtils.GetDefinedTypes(Assembly assembly ILogger logger) in D:\build\agent\_work\25\s\src\Orleans.Core\CodeGeneration\TypeUtils.cs:line 561
  warn: Orleans.CodeGenerator.RoslynCodeGenerator[101723]
        Exception loading types from assembly 'Ray.Core Version=1.1.5.0 Culture=neutral PublicKeyToken=null':
        Exc level 0: System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
           at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
           at System.Reflection.RuntimeAssembly.get_DefinedTypes()
           at Orleans.Runtime.TypeUtils.GetDefinedTypes(Assembly assembly ILogger logger) in D:\build\agent\_work\25\s\src\Orleans.Core\CodeGeneration\TypeUtils.cs:line 561
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。
        Exc level 1: System.IO.FileNotFoundException: Could not load file or assembly 'System.Threading.Tasks.Extensions Version=4.2.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. 系统找不到指定的文件。.
  System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.
     at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)
     at System.Reflection.RuntimeAssembly.get_DefinedTypes()
     at Orleans.Runtime.TypeUtils.GetDefinedTypes(Assembly assembly ILogger logger) in D:\build\agent\_work\25\s\src\Orleans.Core\CodeGeneration\TypeUtils.cs:line 561
  Orleans-CodeGen - Generated file written C:\Users\Jz.Fan\Source\Repos\Ray\Ray.Core\obj\Debug\netstandard2.0\Ray.Core.orleans.g.cs",,ReubenBond,,
4955,Documentation on handling failures,"A question came up on Gitter that highlights many of the topics on the following page are only discussed in the 1.5 Tutorials section:

http://dotnet.github.io/orleans/1.5/Tutorials/Failure-Handling.html

Finding this information in the 1.5 Tutorials section may not be intuitive to new users and I think it would be great to see this migrated to the new Documentation navigation tree.","Documentation on handling failures A question came up on Gitter that highlights many of the topics on the following page are only discussed in the 1.5 Tutorials section:

http://dotnet.github.io/orleans/1.5/Tutorials/Failure-Handling.html

Finding this information in the 1.5 Tutorials section may not be intuitive to new users and I think it would be great to see this migrated to the new Documentation navigation tree.",documentation,JillHeaden,,
4954,Add Microsoft.Orleans.Streaming.AzureStorage as a dependency to AzureUtils,"Fixes #4800.

Add .","Add Microsoft.Orleans.Streaming.AzureStorage as a dependency to AzureUtils Fixes #4800.

Add .",,jason-bragg,,
4953,Minor revisions to transaction tracing,This is a minor refactoring to give us better information when reading traces of failed tests.,Minor revisions to transaction tracing This is a minor refactoring to give us better information when reading traces of failed tests.,,jason-bragg,,
4951,Clear transaction context on error,,Clear transaction context on error ,,ReubenBond,,
4950,Fixed TransactionFaultInjectionTests,#NAME?,"Fixed TransactionFaultInjectionTests - Addressed transaction recovery issues.
- Fixed minor test issues.
- Still not added to functional because they take too long to run.  Need to fix the abort issue then we can remove delays and to functional",,ReubenBond,,
4949,TOC aborts under service failure,"Fixed TOC aborts under service failure
Added minimal failure testing for TOC.","TOC aborts under service failure Fixed TOC aborts under service failure
Added minimal failure testing for TOC.",,ReubenBond,,
4947,Transaction Scope in Grains,Is there a sample implementation or example for transaction scope across multiple grains? The main objective is too commit and rollback database transactions.,Transaction Scope in Grains Is there a sample implementation or example for transaction scope across multiple grains? The main objective is too commit and rollback database transactions.,,jason-bragg,,
4945,IsOrleansShallowCopyable fixes,"-  is shallow copyable if all the element types are shallow copyable.
- Value types are shallow copyable if all public and private instance fields are shallow copyable.
Previously private fields were ignored and public static fields were checked instead and generic types were not allowed.
- Changed the static constructor to a field initializer for better performance (static constructors enforce precise initialization timing which can be expensive).","IsOrleansShallowCopyable fixes -  is shallow copyable if all the element types are shallow copyable.
- Value types are shallow copyable if all public and private instance fields are shallow copyable.
Previously private fields were ignored and public static fields were checked instead and generic types were not allowed.
- Changed the static constructor to a field initializer for better performance (static constructors enforce precise initialization timing which can be expensive).",,ReubenBond,,
4943,Port of #3843 and #3851,Port of #3843 and #3851 PRs from master to 1.5.5.,Port of #3843 and #3851 Port of #3843 and #3851 PRs from master to 1.5.5.,,jason-bragg,,
4942,Consul clustering enhancements,"Following changes have been included in this PR.

1. Consul ACL integration.
2. Creating the cluster folder under a specific folder at the root of KV store.

Consul ACL integration
************************
The current orleans clustering consul package is not having an import feature i.e ACL integration which is a security features of Consul that restricts unauthorized access on the cluster KV folder. 


Sample code


 var client = new ClientBuilder().Configure<ClusterOptions>(options =>
            {
                options.ClusterId = ConfigurationManager.AppSettings[""ClusterId""];
                options.ServiceId = ConfigurationManager.AppSettings[""ServiceId""];
            })
                .UseConsulClustering(gatewayOptions =>
                {
                    gatewayOptions.Address =
                        new Uri(ConfigurationManager.AppSettings[""ServiceDiscoverEndPoint""]);
                    gatewayOptions.AclClientToken = ConfigurationManager.AppSettings[""ServiceDiscoveryToken""];
                    gatewayOptions.KvRootFolder = ConfigurationManager.AppSettings[""KvFolderName""];

                })
                .ConfigureApplicationParts(parts =>
                    parts.AddApplicationPart(typeof(ICustomerRule).Assembly).WithReferences())
                .Build();


            await client.Connect();
            return client;

Creating the cluster folder under a specific folder at the root of KV store.
****************************************************************************

When we have multiple projects using the orleans framework then all the cluster folder gets created at the root level of the KV store to organize it in a better way I've added an ability to configure the folder name where the cluster folder should be created.

.UseConsulClustering(gatewayOptions =>
                {
                    gatewayOptions.Address =
                        new Uri(ConfigurationManager.AppSettings[""ServiceDiscoverEndPoint""]);
                    gatewayOptions.AclClientToken = ConfigurationManager.AppSettings[""ServiceDiscoveryToken""];
                    gatewayOptions.KvRootFolder = ConfigurationManager.AppSettings[""KvFolderName""];

                })

 ","Consul clustering enhancements Following changes have been included in this PR.

1. Consul ACL integration.
2. Creating the cluster folder under a specific folder at the root of KV store.

Consul ACL integration
************************
The current orleans clustering consul package is not having an import feature i.e ACL integration which is a security features of Consul that restricts unauthorized access on the cluster KV folder. 


Sample code


 var client = new ClientBuilder().Configure<ClusterOptions>(options =>
            {
                options.ClusterId = ConfigurationManager.AppSettings[""ClusterId""];
                options.ServiceId = ConfigurationManager.AppSettings[""ServiceId""];
            })
                .UseConsulClustering(gatewayOptions =>
                {
                    gatewayOptions.Address =
                        new Uri(ConfigurationManager.AppSettings[""ServiceDiscoverEndPoint""]);
                    gatewayOptions.AclClientToken = ConfigurationManager.AppSettings[""ServiceDiscoveryToken""];
                    gatewayOptions.KvRootFolder = ConfigurationManager.AppSettings[""KvFolderName""];

                })
                .ConfigureApplicationParts(parts =>
                    parts.AddApplicationPart(typeof(ICustomerRule).Assembly).WithReferences())
                .Build();


            await client.Connect();
            return client;

Creating the cluster folder under a specific folder at the root of KV store.
****************************************************************************

When we have multiple projects using the orleans framework then all the cluster folder gets created at the root level of the KV store to organize it in a better way I've added an ability to configure the folder name where the cluster folder should be created.

.UseConsulClustering(gatewayOptions =>
                {
                    gatewayOptions.Address =
                        new Uri(ConfigurationManager.AppSettings[""ServiceDiscoverEndPoint""]);
                    gatewayOptions.AclClientToken = ConfigurationManager.AppSettings[""ServiceDiscoveryToken""];
                    gatewayOptions.KvRootFolder = ConfigurationManager.AppSettings[""KvFolderName""];

                })

 ",,ReubenBond,,
4939,Orleans silos crashing 'Process is terminating due to StackOverflowException.',"We have recently put an orleans service into production to manage the login session lifecycle of our application. This is running Orleans 2.0.4 and .net core 2.0 hosted in Kubernetes using Linux docker containers built using the microsoft/aspnetcore:2.0 image.

We are using Azure Storage for clustering and state based persistence..

Occasionally at first and with increased frequency we are seeing the silo host containers crash out due to a Stack Over Flow.

We believe this is somehow related to the use of 'reminders' because with a clean state for around the first 40 minutes there are no crashes but gradually over a number of days crashes and restarts happen more and more frequently until it is impossible to keep the cluster up and running in a health state.

While we are not ruling out our specific application code as the cause (accept this is the most likely) we can find no instances of recursive function calls have experimented with removal and refactoring of several areas of the code and have so far been unsuccessful in resolving this.

This doesn't happen on our internal development and testing clusters but that isn't under load in the same way.

Are there any known issues / potential configurations with Orleans 2.x that are known to cause this? What information do I need to collect / how can i go about diagnosing this?","Orleans silos crashing 'Process is terminating due to StackOverflowException.' We have recently put an orleans service into production to manage the login session lifecycle of our application. This is running Orleans 2.0.4 and .net core 2.0 hosted in Kubernetes using Linux docker containers built using the microsoft/aspnetcore:2.0 image.

We are using Azure Storage for clustering and state based persistence..

Occasionally at first and with increased frequency we are seeing the silo host containers crash out due to a Stack Over Flow.

We believe this is somehow related to the use of 'reminders' because with a clean state for around the first 40 minutes there are no crashes but gradually over a number of days crashes and restarts happen more and more frequently until it is impossible to keep the cluster up and running in a health state.

While we are not ruling out our specific application code as the cause (accept this is the most likely) we can find no instances of recursive function calls have experimented with removal and refactoring of several areas of the code and have so far been unsuccessful in resolving this.

This doesn't happen on our internal development and testing clusters but that isn't under load in the same way.

Are there any known issues / potential configurations with Orleans 2.x that are known to cause this? What information do I need to collect / how can i go about diagnosing this?",,sergeybykov,,
4938,Orleans.Transactions.ITransactionManagerGrain. Make sure the grain assembly was correctly deployed and loaded in the silo,"i use orleans.transactions v2.04 nuget when i silobulider add UseInClusterTransactionManager() it run errorif i delete it it will run ok.
![image](https://user-images.githubusercontent.com/26404526/45068227-06122d80-b0f9-11e8-94f7-c52fe1c02d70.png)
","Orleans.Transactions.ITransactionManagerGrain. Make sure the grain assembly was correctly deployed and loaded in the silo i use orleans.transactions v2.04 nuget when i silobulider add UseInClusterTransactionManager() it run errorif i delete it it will run ok.
![image](https://user-images.githubusercontent.com/26404526/45068227-06122d80-b0f9-11e8-94f7-c52fe1c02d70.png)
",,xiazen,,
4936,#4935 Fixing race condition with simple queue cache,"Related to #4935 
- Cursor was allowed to be in a state dependent on a token
  while allowing the containing bucket to be purged","#4935 Fixing race condition with simple queue cache Related to #4935 
- Cursor was allowed to be in a state dependent on a token
  while allowing the containing bucket to be purged",,jason-bragg,,
4935,Race condition with SimpleQueueCache allows for broken cursor,"See https://gitter.im/dotnet/orleans?at=5b8ed56958a3797aa301e47e:

Essentially a cursor being spun up with an empty sequence token was set to the first available token but not tracked. This allows for periodic purging to purge the item with the token causing the cursor to report a cache miss forever.

The fix is pretty simple and supplied by @jason-bragg. I'll throw a PR up shortly.","Race condition with SimpleQueueCache allows for broken cursor See https://gitter.im/dotnet/orleans?at=5b8ed56958a3797aa301e47e:

Essentially a cursor being spun up with an empty sequence token was set to the first available token but not tracked. This allows for periodic purging to purge the item with the token causing the cursor to report a cache miss forever.

The fix is pretty simple and supplied by @jason-bragg. I'll throw a PR up shortly.",bug,jason-bragg,,
4933,"Remove 'Types of Grains.md"" placeholder page insert content from...","…""Actor Identity.md"" and replace ""actor"" with ""grain"" throughout document.
Also reformat  to Documentation Guidelines and make grammatical changes.

","Remove 'Types of Grains.md"" placeholder page, insert content from... …""Actor Identity.md"" and replace ""actor"" with ""grain"" throughout document.
Also reformat  to Documentation Guidelines and make grammatical changes.

",documentation,sergeybykov,5/09/2018 4:49,8/09/2018 8:49
4932,"Remove 'Who's using Orleans"" file from table of contents.",File is not needed.,"Remove 'Who's using Orleans"" file from table of contents. File is not needed.",documentation,sergeybykov,5/09/2018 4:35,6/09/2018 11:58
4931,Rename file from 'Benefits.md' to 'benefits.md' change 'actor' to ...,"…'grain' where needed and change grammar and wording.

This combines and replaces two other PRs that had problems.","Rename file from 'Benefits.md' to 'benefits.md', change 'actor' to ... …'grain' where needed and change grammar and wording.

This combines and replaces two other PRs that had problems.",documentation,sergeybykov,5/09/2018 4:29,6/09/2018 12:11
4930,Change 'gateways' to 'gatewayPort: 30000'.,,Change 'gateways' to 'gatewayPort: 30000'. ,documentation,sergeybykov,5/09/2018 3:57,14/09/2018 5:08
4927,Enable fault injection tests,"Didn't know confirm would be retried on failure so I didn't reset fault injection control after confirmed once which cause some of the tests failing.


This pr fixes it. ","Enable fault injection tests Didn't know confirm would be retried on failure so I didn't reset fault injection control after confirmed once which cause some of the tests failing.


This pr fixes it. ",,jason-bragg,,
4926,Fix fault injection tests and enable them ,I didn't know confirm would be retried on storage error so I didn't reset fault injection control after confirmed once which cause some of the tests failing. ,Fix fault injection tests and enable them  I didn't know confirm would be retried on storage error so I didn't reset fault injection control after confirmed once which cause some of the tests failing. ,,jason-bragg,,
4925,Rebalance grains to new server on request,"Hi

Is there any option to migrate grain with its state to a new silohost?

For now we created our own solution.

1. Monitor number of silohost
2. Monitor number of grains on each silo host
3. When new siloHost join cluster - Call DeactivateOnIdle on grains that are on the busiest server 

Maybe to have an easy implementation for archiving the same solution?

1. Fetch statistics - number of siloHosts number of grain (one type) per siloHost
2. Rebalance grains (Need to be atomic)
    a) Take the state of grain
    b) Deactivate grain on SiloHost 1
    b) Activate grain on SiloHost 2 (do not call onActivate event!)
    c) Load grain state on SiloHost 2

Best

Dean
  ","Rebalance grains to new server on request Hi

Is there any option to migrate grain with its state to a new silohost?

For now we created our own solution.

1. Monitor number of silohost
2. Monitor number of grains on each silo host
3. When new siloHost join cluster - Call DeactivateOnIdle on grains that are on the busiest server 

Maybe to have an easy implementation for archiving the same solution?

1. Fetch statistics - number of siloHosts number of grain (one type) per siloHost
2. Rebalance grains (Need to be atomic)
    a) Take the state of grain
    b) Deactivate grain on SiloHost 1
    b) Activate grain on SiloHost 2 (do not call onActivate event!)
    c) Load grain state on SiloHost 2

Best

Dean
  ",,sergeybykov,,
4913,Add back .editorconfig,"This adds back the .editorconfig file from #3872 that was removed by #3963.
I fixed some bugs in the file (removed severity from formatting rules that don't support it) and changed all warnings to suggestions or even to ""none"" for some rules.
Changed some of the rules to better match the existing codebase but it's not always consistent so suggestions for style changes are welcome.","Add back .editorconfig This adds back the .editorconfig file from #3872 that was removed by #3963.
I fixed some bugs in the file (removed severity from formatting rules that don't support it) and changed all warnings to suggestions or even to ""none"" for some rules.
Changed some of the rules to better match the existing codebase but it's not always consistent so suggestions for style changes are welcome.",,ReubenBond,,
4911,Do not try to register GrainVersionStore if an implementation of IVersionStore is already registered,Fix for #4855 ,Do not try to register GrainVersionStore if an implementation of IVersionStore is already registered Fix for #4855 ,,ReubenBond,,
4910,Access to declared state type in IGrainStorage,"The declared type of the grain state is not accessible via IGrainState.  The runtime type is however you can't determine the actual declared type. This causes problems when the state is of a derived type of the declared type.
e.g. in the IGrainStorage interface the only params you get about the state is IGrainState and if you need the declared type you're out of luck.

There's a hack available though. The implementation type of IGrainState is the internal 
and hope the grainState runtime type doesn't change.

I can suggest two options:
1 - Add **DeclaredStateType** parameter to IGrainStorage methods.
2 - Add DeclaredStateType to IGrainState. This does make the grain state object bigger and I don't know other places using IGrainState. So if there's no benefit other than this I would stay with the hack or give it a second thought.

","Access to declared state type in IGrainStorage The declared type of the grain state is not accessible via IGrainState.  The runtime type is however you can't determine the actual declared type. This causes problems when the state is of a derived type of the declared type.
e.g. in the IGrainStorage interface the only params you get about the state is IGrainState and if you need the declared type you're out of luck.

There's a hack available though. The implementation type of IGrainState is the internal 
and hope the grainState runtime type doesn't change.

I can suggest two options:
1 - Add **DeclaredStateType** parameter to IGrainStorage methods.
2 - Add DeclaredStateType to IGrainState. This does make the grain state object bigger and I don't know other places using IGrainState. So if there's no benefit other than this I would stay with the hack or give it a second thought.

",,xiazen,,
4908,ManagementGrain.ForceActivationCollection with zero ageLimit causes undesired effects,"Calling ManagementGrain.ForceActivationCollection(TimeSpan.Zero) collects every grain including system grains and the ManagementGrain itself. Which effectively almost restarts the silo and causes the said grain call to timeout.

Shouldn't this exclude some grains (management grain pubsub etc.)? or at least make the TimeSpan.Zero value an invalid one? 

I can't think of a scenario where current behavior would be useful.
","ManagementGrain.ForceActivationCollection with zero ageLimit causes undesired effects Calling ManagementGrain.ForceActivationCollection(TimeSpan.Zero) collects every grain including system grains and the ManagementGrain itself. Which effectively almost restarts the silo and causes the said grain call to timeout.

Shouldn't this exclude some grains (management grain pubsub etc.)? or at least make the TimeSpan.Zero value an invalid one? 

I can't think of a scenario where current behavior would be useful.
",,benjaminpetit,,
4907,Propagate message serialization exceptions to callers,"Fixes #4793 

There are 6 scenarios being tested which can be summed up as  for external users. Nevertheless it's worth adding tests for the scenario just in case and it helped to uncover some issues and places we could improve logging.","Propagate message serialization exceptions to callers Fixes #4793 

There are 6 scenarios being tested which can be summed up as  for external users. Nevertheless it's worth adding tests for the scenario just in case and it helped to uncover some issues and places we could improve logging.",,xiazen,,
4906,Migrate DynamoDB transaction state provider to new interface,DynamoDB was originally submitted and merge with #4056. It implemented the .,Migrate DynamoDB transaction state provider to new interface DynamoDB was originally submitted and merge with #4056. It implemented the .,Hacktoberfest,sergeybykov,29/08/2018 9:33,30/11/2018 9:39
4905,Add 2.1.0-beta1 to changelog,,Add 2.1.0-beta1 to changelog ,,ReubenBond,,
4904,Remove ITransactionFaultInjector from src,"- Remove ITransactionFaultInjector from src. Fault are now injected into storage layer through FaultInjectedTransactionStateStorage implementations in test proj. 
- Remove MemoryConsistencyTests since we don't have a fault injection memory state storage for it to use yet. Can be added later. ","Remove ITransactionFaultInjector from src - Remove ITransactionFaultInjector from src. Fault are now injected into storage layer through FaultInjectedTransactionStateStorage implementations in test proj. 
- Remove MemoryConsistencyTests since we don't have a fault injection memory state storage for it to use yet. Can be added later. ",,jason-bragg,,
4901,Move actor identity content from 1.5 tutorials to grains section,"The content of the 1.5 tutorial ""Actor Identity"" contains information about grain IDs and no steps to accomplish a task. It should be put with other similar pages.

","Move actor identity content from 1.5 tutorials to grains section The content of the 1.5 tutorial ""Actor Identity"" contains information about grain IDs and no steps to accomplish a task. It should be put with other similar pages.

",documentation,sergeybykov,,
4900,API to access the default DeepCopier,"There should be a way to access the default copier from an  implementation. That would be useful when only trying to override the serialization/deserialization behavior of a type.
And it should be possible to access the default serialization code when only overriding deep-copying is needed.","API to access the default DeepCopier There should be a way to access the default copier from an  implementation. That would be useful when only trying to override the serialization/deserialization behavior of a type.
And it should be possible to access the default serialization code when only overriding deep-copying is needed.",,ReubenBond,,
4896,Activation address cache is not invalidated when only [OneWay] calls are used,"Scenario:

* Call  methods on a grain from silo A
  * Activation is hosted on silo B
  * Activation is registered in directory partition on silo C 
* Deactivate that grain (eg by killing silo C) 
* Silo A will never learn that the grain has been destroyed and will keep messaging a non-existent activation (unsuccessfully unbeknownst to caller or calling silo)

","Activation address cache is not invalidated when only [OneWay] calls are used Scenario:

* Call  methods on a grain from silo A
  * Activation is hosted on silo B
  * Activation is registered in directory partition on silo C 
* Deactivate that grain (eg by killing silo C) 
* Silo A will never learn that the grain has been destroyed and will keep messaging a non-existent activation (unsuccessfully unbeknownst to caller or calling silo)

",P2,ReubenBond,,
4895,Use netcoreapp2.0 for msbuild target dll if using dotnet core msbuild but targeting full .net,"(Cherry-pick of #4689)

#4673 introduced a regression: when using the command  command in the path @ReubenBond ?","Use netcoreapp2.0 for msbuild target dll if using dotnet core msbuild but targeting full .net (Cherry-pick of #4689)

#4673 introduced a regression: when using the command  command in the path @ReubenBond ?",,ReubenBond,,
4894,Fixed build breaks from bad merge:," - Constructor mismatches
 - Adde CurrentTransactionId to transaction context","Fixed build breaks from bad merge:  - Constructor mismatches
 - Adde CurrentTransactionId to transaction context",,xiazen,,
4893,Build time codegen in 2.0.4 not working when using dotnet cli while targeting full .net framework,We need to backport #4689 to fix this issue,Build time codegen in 2.0.4 not working when using dotnet cli while targeting full .net framework We need to backport #4689 to fix this issue,bug,benjaminpetit,,
4892,fixes 'placeholder page' issue for Grains section,,fixes 'placeholder page' issue for Grains section ,documentation,sergeybykov,28/08/2018 1:12,28/08/2018 9:29
4891,Move actor identity content from 1.5 tutorials to grains section,"The 1.5 Tutorial page ""Actor Identity"" is informational not procedural - it should be included among other informational pages.","Move actor identity content from 1.5 tutorials to grains section The 1.5 Tutorial page ""Actor Identity"" is informational not procedural - it should be included among other informational pages.",documentation,sergeybykov,,
4890,Feature per grain collection attribute,,Feature per grain collection attribute ,,ReubenBond,,
4888,Fixes 'clusters and clients' similar to 'grains',,Fixes 'clusters and clients' similar to 'grains' ,documentation,sergeybykov,,
4886,"Moved the ""This documentation is for the 2.0 release"" section... ","… from Orleans Overview to main landing page (to keep content about documentation itself together)
- made some grammar and sentence structure edits
- verified links
","Moved the ""This documentation is for the 2.0 release"" section...  … from Orleans Overview to main landing page (to keep content about documentation itself together)
- made some grammar and sentence structure edits
- verified links
",documentation,sergeybykov,25/08/2018 3:23,28/08/2018 5:43
4885,What kind of scenario will the SiloName of the two nodes be the same?,When I read the code I saw the following code from  method used to handle?,What kind of scenario will the SiloName of the two nodes be the same? When I read the code I saw the following code from  method used to handle?,question,benjaminpetit,,
4884,Event Hub checkpoint on shutdown,"Checkpoints don't seem to occur on silo shutdown. This results in re-processing events when a silo comes back up.

Maybe ?
","Event Hub checkpoint on shutdown Checkpoints don't seem to occur on silo shutdown. This results in re-processing events when a silo comes back up.

Maybe ?
",,xiazen,,
4877,Build-time code generation version 2.0.4 breaks docker builds,When upgrading the ,Build-time code generation version 2.0.4 breaks docker builds When upgrading the ,,ReubenBond,,
4876,Fix DI cycle involving OrleansJsonSerializer,Fixes #4873,Fix DI cycle involving OrleansJsonSerializer Fixes #4873,,xiazen,,
4875,Revisit silo stop/shutdown timeout,,Revisit silo stop/shutdown timeout ,,ReubenBond,,
4874,Add storage exception injection logic into fault injection test runner,"Adding fault injection test case
- inject storage exception before store during Prepare
- inject storage exception after store during Prepare 
- inject storage exception before store during Confirm
- inject storage exception after store during Confirm
- inject storage exception before store during PrepareAndCommit
- inject storage exception after store during PrepareAndCommit

injecting exception before store simulates situation that state update failed to persist
injecting exception after store simulates situation that state update succeed to persist but runtime think it failed

currently all tests failed... I don't think I have a test logic issue. But please give me a second eye. ","Add storage exception injection logic into fault injection test runner Adding fault injection test case
- inject storage exception before store during Prepare
- inject storage exception after store during Prepare 
- inject storage exception before store during Confirm
- inject storage exception after store during Confirm
- inject storage exception before store during PrepareAndCommit
- inject storage exception after store during PrepareAndCommit

injecting exception before store simulates situation that state update failed to persist
injecting exception after store simulates situation that state update succeed to persist but runtime think it failed

currently all tests failed... I don't think I have a test logic issue. But please give me a second eye. ",,jason-bragg,,
4873,StackOverflowException when adding OrleansJsonSerializer as a SerializationProvider,"Workaround: use this gist instead https://gist.github.com/ReubenBond/45ef767aff071302ee62731b5c706dd7

Repro:


Only the silo fails the client doesn't have a dependency cycle.","StackOverflowException when adding OrleansJsonSerializer as a SerializationProvider Workaround: use this gist instead https://gist.github.com/ReubenBond/45ef767aff071302ee62731b5c706dd7

Repro:


Only the silo fails the client doesn't have a dependency cycle.",P2,ReubenBond,,
4872,No menu topic for Streaming after restructuring of docs,,No menu topic for Streaming after restructuring of docs ,documentation,JillHeaden,,
4871,Rename UseDistributedTM to UseTransactions,fix issue #4688 ,Rename UseDistributedTM to UseTransactions fix issue #4688 ,,jason-bragg,,
4870,Remove documentation sources,"I moved documentation sources to the docs branch so that we completely separate them from the generated html output. The goal is to move them to a separate repo altogether.

This is to delete doc sources from the gh-pages branch to prevent duplication and potential confusion.","Remove documentation sources I moved documentation sources to the docs branch so that we completely separate them from the generated html output. The goal is to move them to a separate repo altogether.

This is to delete doc sources from the gh-pages branch to prevent duplication and potential confusion.",,ReubenBond,,
4868,Should not need `.AsReference<>` when returning a grain,"I have a bit of code in the Registry pattern:

 I get an exception saying serialization failed.

Is this an edge case that got missed for grain checking?","Should not need  I get an exception saying serialization failed.

Is this an edge case that got missed for grain checking?",,ReubenBond,,
4867,Avoiding the OrleansAdoNetContent folder,"The solution to #4243 causes repositories and projects to be polluted by the OrleansAdoNetContent folder. One has to employ various hacks to ensure that the folder is removed after package restore and in the case of  there doesn't even seem to exist any target to use with AfterTargets to get rid of the files.

I see how the files could be useful for someone just starting out with Orleans but not for an established project. In my case the files are possibly harmful as I'm running on a modified schema and these files would only confuse my colleagues.

A possible solution would be to move the copying of these files into the OrleansSQLUtils project. One can then reference the individual packages to bypass the copying of the SQL files.

Has anyone else spent way too much time fighting these files? :) Any other ideas as to what can be done about it?","Avoiding the OrleansAdoNetContent folder The solution to #4243 causes repositories and projects to be polluted by the OrleansAdoNetContent folder. One has to employ various hacks to ensure that the folder is removed after package restore and in the case of  there doesn't even seem to exist any target to use with AfterTargets to get rid of the files.

I see how the files could be useful for someone just starting out with Orleans but not for an established project. In my case the files are possibly harmful as I'm running on a modified schema and these files would only confuse my colleagues.

A possible solution would be to move the copying of these files into the OrleansSQLUtils project. One can then reference the individual packages to bypass the copying of the SQL files.

Has anyone else spent way too much time fighting these files? :) Any other ideas as to what can be done about it?",,sergeybykov,,
4866,Minio grain storage provider,"I made a grain storage provider implementation with [Minio](https://www.minio.io/) which is a free  open source distributed object storage.

The implementation currently resides as code on [my repository](https://github.com/Kimserey/orleans-minio) under [/OrleansMinio](https://github.com/Kimserey/orleans-minio/tree/master/OrleansMinio) which I would like to PR into Orleans. I just don't know how to proceed. 

https://github.com/Kimserey/orleans-minio

If someone could guide me by answering the following questions:

1. Is it something you see worth PR'ing? If it isn't we can close this question.
_Minio is useful for me as I wish to not be tied to cloud providers services and prefer rely on free open source solutions._
2. How should I proceed? Are there any guidelines as I see other grain storages are within folder that are _linked files_ to _/shared_.

Thanks!","Minio grain storage provider I made a grain storage provider implementation with [Minio](https://www.minio.io/) which is a free  open source distributed object storage.

The implementation currently resides as code on [my repository](https://github.com/Kimserey/orleans-minio) under [/OrleansMinio](https://github.com/Kimserey/orleans-minio/tree/master/OrleansMinio) which I would like to PR into Orleans. I just don't know how to proceed. 

https://github.com/Kimserey/orleans-minio

If someone could guide me by answering the following questions:

1. Is it something you see worth PR'ing? If it isn't we can close this question.
_Minio is useful for me as I wish to not be tied to cloud providers services and prefer rely on free open source solutions._
2. How should I proceed? Are there any guidelines as I see other grain storages are within folder that are _linked files_ to _/shared_.

Thanks!",question,sergeybykov,22/08/2018 22:02,6/09/2018 5:24
4865,Await tasks in DedicatedAsynchAgent.Run(),"Source description in gitter:
> I'm discovering the internal of orleans' runtime and I found that  rather than just start a job/task in the .NET thread pool.
* If it is safe to execute DedicatedAsynchAgent logic out of its ThreadPoolExecutor's thread.


PS.
*There may be some misunderstanding about ThreadPoolExecutor/AsynchAgent/Async-Await ... I'm glad to be corrected.*
*It's so much fun to read Orleans' source code what you people did is fantastic*","Await tasks in DedicatedAsynchAgent.Run() Source description in gitter:
> I'm discovering the internal of orleans' runtime and I found that  rather than just start a job/task in the .NET thread pool.
* If it is safe to execute DedicatedAsynchAgent logic out of its ThreadPoolExecutor's thread.


PS.
*There may be some misunderstanding about ThreadPoolExecutor/AsynchAgent/Async-Await ... I'm glad to be corrected.*
*It's so much fun to read Orleans' source code what you people did is fantastic*",,ReubenBond,,
4862,[Question] Orleans Event Sourcing snapshots of event log,"I have a JournaledGrain which I am persisting events through the attribute [LogConsistencyProvider(ProviderName = ""LogStorage"")]. Since this grain will handle heavy load hydrating the grain every time with all the events can result in a performance bottleneck. As a result snapshot are one alternative to this problem by hydrating events since the latest snapshot only. Is there is a way to handle snapshots in Orleans Event Sourcing?

I am using MongoDB to persist the data.","[Question] Orleans Event Sourcing snapshots of event log I have a JournaledGrain which I am persisting events through the attribute [LogConsistencyProvider(ProviderName = ""LogStorage"")]. Since this grain will handle heavy load hydrating the grain every time with all the events can result in a performance bottleneck. As a result snapshot are one alternative to this problem by hydrating events since the latest snapshot only. Is there is a way to handle snapshots in Orleans Event Sourcing?

I am using MongoDB to persist the data.",,sebastianburckhardt,,
4861,No default grains storage added to container if one is not configured.,Addresses - IGrainStorage null implementation registerd in DI container #4710,No default grains storage added to container if one is not configured. Addresses - IGrainStorage null implementation registerd in DI container #4710,,ReubenBond,,
4860,Minimal TOC,"Minimal transfer of coordintation support for transactions.
- TransactionCommitter facet
- Changed to commit logic to commit only upon successfull remot service call.
- Minima golden path tests","Minimal TOC Minimal transfer of coordintation support for transactions.
- TransactionCommitter facet
- Changed to commit logic to commit only upon successfull remot service call.
- Minima golden path tests",,xiazen,,
4859,Silo with EFCore Lazy Loading failed to catch System.ExecutionEngineException and crash silently,"* Orleans.Server: 2.0.4
* EntityFrameworkCore: 2.1.1

I'm using EF Core and enable Lazy Loading for grain to store data.
When I use the EF entity proxy object as a return value for grain method it will throw a ).","Silo with EFCore Lazy Loading failed to catch System.ExecutionEngineException and crash silently * Orleans.Server: 2.0.4
* EntityFrameworkCore: 2.1.1

I'm using EF Core and enable Lazy Loading for grain to store data.
When I use the EF entity proxy object as a return value for grain method it will throw a ).",,ReubenBond,,
4858,Orleans.Transactions.TransactionInfo not in Core,When a transaction aborts for whatever reason the exception that is serialized contains the Orleans.Transactions.TransactionInfo type.  That type is in Orleans.Transactions not in Orleans.Core so if the client doesn't reference the transactions package it fails to deserialize the exception (which unfortunately causes a grain timeout exception instead of a failed to deserialize exception to be delivered to the caller).,Orleans.Transactions.TransactionInfo not in Core When a transaction aborts for whatever reason the exception that is serialized contains the Orleans.Transactions.TransactionInfo type.  That type is in Orleans.Transactions not in Orleans.Core so if the client doesn't reference the transactions package it fails to deserialize the exception (which unfortunately causes a grain timeout exception instead of a failed to deserialize exception to be delivered to the caller).,P1,xiazen,18/08/2018 9:32,
4855,[Question] about GrainStorage and the internal VersionStoreGrain,"I'm writing a storage provider using efcore. 
The provider works against a configured dbcontext which means any type being used as storage should have a corresponding DbSet<> on the context. So arbitrary types are not welcomed here as the backing storage is not happy with them (SQL Server for example).

Now the problem raises If the provider is used as the default grain storage. This causes the internal  differently. This probably suggest an internal dbcontext to handle Orleans related stuff. Which also causes the provider to break if I'm missing another internal type.
- Handle arbitrary types using a fallback provider or a key-value table.
- Don't allow the provider to be used as the default storage.

I know using entity framework inherently suggest that arbitrary types can't be used but for this to work it should be able to be used as the only grain storage provider in the silo.

I'll probably go with option 3 with my current knowledge of Orleans. Any advice is very appreciated. I'm gonna open source this as soon as I finish this and write more tests.","[Question] about GrainStorage and the internal VersionStoreGrain I'm writing a storage provider using efcore. 
The provider works against a configured dbcontext which means any type being used as storage should have a corresponding DbSet<> on the context. So arbitrary types are not welcomed here as the backing storage is not happy with them (SQL Server for example).

Now the problem raises If the provider is used as the default grain storage. This causes the internal  differently. This probably suggest an internal dbcontext to handle Orleans related stuff. Which also causes the provider to break if I'm missing another internal type.
- Handle arbitrary types using a fallback provider or a key-value table.
- Don't allow the provider to be used as the default storage.

I know using entity framework inherently suggest that arbitrary types can't be used but for this to work it should be able to be used as the only grain storage provider in the silo.

I'll probably go with option 3 with my current knowledge of Orleans. Any advice is very appreciated. I'm gonna open source this as soon as I finish this and write more tests.",bug,benjaminpetit,,
4853,Do not place stateless worker locally if the silo is stopping,Fix for #4852 and #4757 ,Do not place stateless worker locally if the silo is stopping Fix for #4852 and #4757 ,,ReubenBond,,
4852,Revisit handling of StatelessWorker grains during shutdown,Base on the feedback in #4757 we need to reconsider how StatelessWorker grains are handled during silo shutdown.,Revisit handling of StatelessWorker grains during shutdown Base on the feedback in #4757 we need to reconsider how StatelessWorker grains are handled during silo shutdown.,enhancement,benjaminpetit,,
4851,transaction consistency tests and error injection,"the consistency tests I have been using for testing the transaction implementation.

- includes a test runner that runs randomized transaction tests using various scale and randomization settings.  Running all of those takes a long time (because of the large number of tests and the volume of the tests) but this is sort of intentional for this type of test (random testing is quite good at discovering subtle race conditions if run with enough volume).

- each consistency test records a lot of data while executing the random transactions (state version numbers read & written by each transaction for each grain)  that is checked for serializability in the end. Also I check if any exceptions encountered are expected for the type of test being run. For example there should not be any transient exceptions under low congestion and when avoiding deadlocks and there should not be any unknown exceptions when storage injection is off.

- These tests can run with or without fault injection. 

- The fault injector randomly injects three kinds of exceptions:
    - an uninterpreted exception before or after writing to storage
    - an InconsistentStateException before writing to storage","transaction consistency tests and error injection the consistency tests I have been using for testing the transaction implementation.

- includes a test runner that runs randomized transaction tests using various scale and randomization settings.  Running all of those takes a long time (because of the large number of tests and the volume of the tests) but this is sort of intentional for this type of test (random testing is quite good at discovering subtle race conditions if run with enough volume).

- each consistency test records a lot of data while executing the random transactions (state version numbers read & written by each transaction for each grain)  that is checked for serializability in the end. Also I check if any exceptions encountered are expected for the type of test being run. For example there should not be any transient exceptions under low congestion and when avoiding deadlocks and there should not be any unknown exceptions when storage injection is off.

- These tests can run with or without fault injection. 

- The fault injector randomly injects three kinds of exceptions:
    - an uninterpreted exception before or after writing to storage
    - an InconsistentStateException before writing to storage",,xiazen,,
4850,Fix NullReferenceException in ExecutingWorkItemsTracker,"I hit a  constructor.

This PR fixes that adds some defensiveness and cleans up the code a little.","Fix NullReferenceException in ExecutingWorkItemsTracker I hit a  constructor.

This PR fixes that adds some defensiveness and cleans up the code a little.",,benjaminpetit,,
4847,Why is it that only the last Silo suspected of P can declare its death?,If the successor node ABC of P starts at intervals then it is possible that A suspects P writes; B suspects P writes; C suspects P writes and in such a dead cycle can not really declare P's death.,Why is it that only the last Silo suspected of P can declare its death? If the successor node ABC of P starts at intervals then it is possible that A suspects P writes; B suspects P writes; C suspects P writes and in such a dead cycle can not really declare P's death.,question,sergeybykov,,
4846,Repair typesetting error,Repair typesetting error.,Repair typesetting error Repair typesetting error.,documentation,JillHeaden,,
4844,Fix partial build,Tentative to bring #4740 to the master branch,Fix partial build Tentative to bring #4740 to the master branch,,ReubenBond,,
4843,Orleans Health Check,"We are running Orleans on a Kubernetes cluster.

What is the recommended way to set up readiness/liveliness (health) checks on silos?
","Orleans Health Check We are running Orleans on a Kubernetes cluster.

What is the recommended way to set up readiness/liveliness (health) checks on silos?
",question,benjaminpetit,,
4842,Orleans.Runtime.OrleansException: Not connected to a gateway when reconnecting to a local silo,"I'm just playing with Orleans and one of the basics and I tried the 2.0 sample app.

I started the client before the silo (intentionally) just to see if the retry policy outlined there would work. The client connected but then immediately failed with the error I'm pasting below.

Steps to reproduce:

1. Use the [Hello world sample](https://github.com/dotnet/orleans/tree/master/Samples/2.0/HelloWorld)
1. Start the client
1. Start the silo (after the client has been started)
1. Observe the log output to see the exception

Expected behaviour:
I would expect the client to successfully reconnect and perform operations normally. Is this something that is supposed to work or am I expecting too much? Let me know if you need more details on the setup.

Log output:

<details>
  <summary>Expand log content</summary>


</details>","Orleans.Runtime.OrleansException: Not connected to a gateway when reconnecting to a local silo I'm just playing with Orleans and one of the basics and I tried the 2.0 sample app.

I started the client before the silo (intentionally) just to see if the retry policy outlined there would work. The client connected but then immediately failed with the error I'm pasting below.

Steps to reproduce:

1. Use the [Hello world sample](https://github.com/dotnet/orleans/tree/master/Samples/2.0/HelloWorld)
1. Start the client
1. Start the silo (after the client has been started)
1. Observe the log output to see the exception

Expected behaviour:
I would expect the client to successfully reconnect and perform operations normally. Is this something that is supposed to work or am I expecting too much? Let me know if you need more details on the setup.

Log output:

<details>
  <summary>Expand log content</summary>


</details>",,benjaminpetit,,
4841,Ignore ambiguous transactions in correctness testing.,Updated transaction correctness/recoverability tests to not check results against client expectations if transaction success was ambiguous.,Ignore ambiguous transactions in correctness testing. Updated transaction correctness/recoverability tests to not check results against client expectations if transaction success was ambiguous.,,xiazen,,
4839,Namespace property removed from ImplicitStreamSubscriptionAttribute in 1.5,"From [gitter chat here](https://gitter.im/dotnet/orleans?at=5b6bf2c9e9b96f2c98e36bec)

We started to migrate 1.4 -> 1.5 (2.0 deemed too big rework and too many breaking changes)
and discovered that we need to make some changes in our code base. They are more or less reasonable like DI for constructors and some removed defaults. There is one change in 1.5 that looks strange and unreasonable and I'd like to understand what was the reasoning behind it:

Previously (in 1.4)  in favour of our own one and this is what we are doing now. For me it's a code smell to introduce your own attributes to solve the problem that was perfectly solved in older versions of framework.

But the question is - what was the reason behind this breaking change ? It feels that it doesn't affect anything but was simply to break public contract that was in use (across multiple 1.x version) without any obvious alternative or any afterthoughts of how this is going to affect existing deployments.

Also If there is a better way to implement this in non 2.0 world - keen to hear in comments.","Namespace property removed from ImplicitStreamSubscriptionAttribute in 1.5 From [gitter chat here](https://gitter.im/dotnet/orleans?at=5b6bf2c9e9b96f2c98e36bec)

We started to migrate 1.4 -> 1.5 (2.0 deemed too big rework and too many breaking changes)
and discovered that we need to make some changes in our code base. They are more or less reasonable like DI for constructors and some removed defaults. There is one change in 1.5 that looks strange and unreasonable and I'd like to understand what was the reasoning behind it:

Previously (in 1.4)  in favour of our own one and this is what we are doing now. For me it's a code smell to introduce your own attributes to solve the problem that was perfectly solved in older versions of framework.

But the question is - what was the reason behind this breaking change ? It feels that it doesn't affect anything but was simply to break public contract that was in use (across multiple 1.x version) without any obvious alternative or any afterthoughts of how this is going to affect existing deployments.

Also If there is a better way to implement this in non 2.0 world - keen to hear in comments.",documentation,jason-bragg,10/08/2018 8:44,
4837,Client shutdown problem,"Hi

We noticed that if we kill the client without calling method .Close next time when we tried to establish a connection with silo host client connection hangs with the state ""Starting"".

From console log we can see all active gateways TCP connection is alive but code simply hangs on 
![image](https://user-images.githubusercontent.com/1646051/43911787-9f151528-9c00-11e8-9390-e6dbec010879.png)

Has anyone else noticed the same issue before?

Best

Dean","Client shutdown problem Hi

We noticed that if we kill the client without calling method .Close next time when we tried to establish a connection with silo host client connection hangs with the state ""Starting"".

From console log we can see all active gateways TCP connection is alive but code simply hangs on 
![image](https://user-images.githubusercontent.com/1646051/43911787-9f151528-9c00-11e8-9390-e6dbec010879.png)

Has anyone else noticed the same issue before?

Best

Dean",,benjaminpetit,,
4835,Change Orleans.TelemetryConsumers.Counters project target platform to netstandard or netcoreapp,Currently  since  it is already available for netstandart https://www.nuget.org/packages/System.Diagnostics.PerformanceCounter/,Change Orleans.TelemetryConsumers.Counters project target platform to netstandard or netcoreapp Currently  since  it is already available for netstandart https://www.nuget.org/packages/System.Diagnostics.PerformanceCounter/,,ReubenBond,,
4834,Questions about Reminders timing,"Hey there
In our team we are using Orleans Reminders to perform an action that should run exactly every 1 hour.
Reminders are registered with the following function: 
As we noticed recently a reminder that was registered with dueTime=0 period=1 hour will not tick every one hour exactly.
It will simply wait 1 hour _after the last reminder ended_ and then send the next reminder tick.
That is a problem to us since the reminder invokes a function that can take few seconds to end. In that case we will have an **accumulative delay** on reminder ticks that will be received every 1 hour **+ epsilon**.

From [Orleans Documentation](https://dotnet.github.io/orleans/1.5/Documentation/Core-Features/Timers-and-Reminders.html) it is said to be the case for Orleans Timers and for Reminders it said that ""Reminders are similar to timers [...]"".

My question is **whether there is an option to configure reminder timing** to be exactly as we registered (first tick after dueTime time and then a tick every period) without being affected by the duration of the function the reminder invokes.
If there isn't other solutions would be (A) making the reminder to invoke a async Task without awaiting for it (B) making the reminder to start a timer to do the actual work or (C) keeping track on the delay from the expected time and once it got too big update and re-schedule the reminder.

We'll be glad to hear if you know a way to handle it or simply what would you do in such cases :)
","Questions about Reminders timing Hey there
In our team we are using Orleans Reminders to perform an action that should run exactly every 1 hour.
Reminders are registered with the following function: 
As we noticed recently a reminder that was registered with dueTime=0 period=1 hour will not tick every one hour exactly.
It will simply wait 1 hour _after the last reminder ended_ and then send the next reminder tick.
That is a problem to us since the reminder invokes a function that can take few seconds to end. In that case we will have an **accumulative delay** on reminder ticks that will be received every 1 hour **+ epsilon**.

From [Orleans Documentation](https://dotnet.github.io/orleans/1.5/Documentation/Core-Features/Timers-and-Reminders.html) it is said to be the case for Orleans Timers and for Reminders it said that ""Reminders are similar to timers [...]"".

My question is **whether there is an option to configure reminder timing** to be exactly as we registered (first tick after dueTime time and then a tick every period) without being affected by the duration of the function the reminder invokes.
If there isn't other solutions would be (A) making the reminder to invoke a async Task without awaiting for it (B) making the reminder to start a timer to do the actual work or (C) keeping track on the delay from the expected time and once it got too big update and re-schedule the reminder.

We'll be glad to hear if you know a way to handle it or simply what would you do in such cases :)
",question,sergeybykov,,
4833,Accepting into an existing Socket is not supported on this platform.,"Hi There 

I am deploying Orleans within docker on linux for the first time and have found an exception in my log that so far does not seem to be causing any issues. I though it worth reporting nonetheless.

My base image for docker deployment is microsoft/dotnet:2.1-runtime 

The log I have is as follows:

","Accepting into an existing Socket is not supported on this platform. Hi There 

I am deploying Orleans within docker on linux for the first time and have found an exception in my log that so far does not seem to be causing any issues. I though it worth reporting nonetheless.

My base image for docker deployment is microsoft/dotnet:2.1-runtime 

The log I have is as follows:

",,benjaminpetit,,
4832,Serializing Delegates not supported on this platform,"Hi There

I am running the latest version of Orleans on a docker container based upon microsoft/dotnet:2.1-runtime on linux.

It's running at AWS in the ECS environment.

The problem seems to be related to Fallback serialization of exceptions. I make a call to an external library AmazonLambdaClient which is throwing a permissions exception. The permissions exception is a custom exception type and it seems that there is something wrong with serialization of this custom exception within docker on linux. 

For now my workaround is to catch the exception and convert it to a regular System.Exception but I'm guessing this problem will rear it's head somewhere else.

The exception log is below:

","Serializing Delegates not supported on this platform Hi There

I am running the latest version of Orleans on a docker container based upon microsoft/dotnet:2.1-runtime on linux.

It's running at AWS in the ECS environment.

The problem seems to be related to Fallback serialization of exceptions. I make a call to an external library AmazonLambdaClient which is throwing a permissions exception. The permissions exception is a custom exception type and it seems that there is something wrong with serialization of this custom exception within docker on linux. 

For now my workaround is to catch the exception and convert it to a regular System.Exception but I'm guessing this problem will rear it's head somewhere else.

The exception log is below:

",,ReubenBond,,
4831,Added support for priority transaction manager. ,"Only one priority transaction manager is allowed per transaction.  Priority TM be used to detect TOC in future changes.

Also moved ReadonlyCommit to resource interface from tm interface.  Call was placed in wrong interface when split.","Added support for priority transaction manager.  Only one priority transaction manager is allowed per transaction.  Priority TM be used to detect TOC in future changes.

Also moved ReadonlyCommit to resource interface from tm interface.  Call was placed in wrong interface when split.",,xiazen,,
4830,When deactivating a grain do not stop timers if there are running requests ,"Fix for #4774 

Thanks @yevhen  I was able to repro this issue 100% with this test. Like said in the issue this will fix only part of the issue.","When deactivating a grain, do not stop timers if there are running requests  Fix for #4774 

Thanks @yevhen  I was able to repro this issue 100% with this test. Like said in the issue this will fix only part of the issue.",,ReubenBond,,
4828,Questions about the order of method calls ,"Hi 

I am working on a stream processing system which might be sensitive to the orders of the method calls between grains. If I call an async method which sends messages from A to B multiple times will the messages are processed in order? 

Thanks!

 ","Questions about the order of method calls  Hi 

I am working on a stream processing system which might be sensitive to the orders of the method calls between grains. If I call an async method which sends messages from A to B multiple times will the messages are processed in order? 

Thanks!

 ",question,jason-bragg,,
4826,Question/Sample Request: Long running function execution via Orleans,"I've seen in the documentation about how ""Orleans is not suited for long running work*"" (*Generally) - I may be paraphrasing. There are a few issues regarding that same topic #4531 #4370 #3071 and several others that I'm having trouble finding ATM.

The tldr of what I'm hoping to accomplish with Orleans is to take lots of calls from my app and dispatch them across a cluster of Orleans silos.  Many of these calls that occur are completed in a few milliseconds but many take several minutes to complete when running in our non-Orleans implementation.  

I understand there is a default timeout of 30 seconds for the client to receive a response from the grain and I would feel weird about increasing that to accommodate our ""longest running logic""  I feel like there has to be a better way of doing it that just increasing the timeout.

Currently my calls (either fast or slow) look similar to this and note this is all CPU bound work:

Client.cs
 in order to keep memory usage down; it seemed like I was getting into some situations where I'd have so many scheduled tasks that all memory would be utilized and nothing would complete.  

The above code does not work without setting the timeout to at least as high as our ""longest running operation"".  It seems that a lot of suggestions on getting around this are to ""return immediately that the task has been started then get the result when it's finished"" but I'm not finding any samples on how to accomplish this at least from both a client and grain perspective.

Could some samples be provided on how to accomplish what I'm going after?  It seems that some sort of check that an invocation is complete would be needed but I'm not sure how to go about that.  Would this require my grains to become stateful rather than stateless? #4370 seems like it ***may*** be of use but I'm only seeing from the grain perspective not what it looks like from the client.  Ideally my fast and long running client/grains with have similar looking implementations but if I have to break out into separate methods for accommodating that's fine as well.

Hopefully this all makes sense!","Question/Sample Request: Long running function execution via Orleans I've seen in the documentation about how ""Orleans is not suited for long running work*"" (*Generally) - I may be paraphrasing. There are a few issues regarding that same topic #4531 #4370 #3071 and several others that I'm having trouble finding ATM.

The tldr of what I'm hoping to accomplish with Orleans is to take lots of calls from my app and dispatch them across a cluster of Orleans silos.  Many of these calls that occur are completed in a few milliseconds but many take several minutes to complete when running in our non-Orleans implementation.  

I understand there is a default timeout of 30 seconds for the client to receive a response from the grain and I would feel weird about increasing that to accommodate our ""longest running logic""  I feel like there has to be a better way of doing it that just increasing the timeout.

Currently my calls (either fast or slow) look similar to this and note this is all CPU bound work:

Client.cs
 in order to keep memory usage down; it seemed like I was getting into some situations where I'd have so many scheduled tasks that all memory would be utilized and nothing would complete.  

The above code does not work without setting the timeout to at least as high as our ""longest running operation"".  It seems that a lot of suggestions on getting around this are to ""return immediately that the task has been started then get the result when it's finished"" but I'm not finding any samples on how to accomplish this at least from both a client and grain perspective.

Could some samples be provided on how to accomplish what I'm going after?  It seems that some sort of check that an invocation is complete would be needed but I'm not sure how to go about that.  Would this require my grains to become stateful rather than stateless? #4370 seems like it ***may*** be of use but I'm only seeing from the grain perspective not what it looks like from the client.  Ideally my fast and long running client/grains with have similar looking implementations but if I have to break out into separate methods for accommodating that's fine as well.

Hopefully this all makes sense!",question,sergeybykov,,
4823,Error occurs in clusterbuilder.build  when  iis website restart,"Hi
  I have a websit using Orleans Client connect to the server.

  I have a static ClusterClient
    and when the website start the ClientBuilder.Build() is invoked and connect to the server.
    and when  the website shut down IClusterClient.Close() and Dispose() is invoked .

  it runs good but when the website restart it become unstable   and then if continue access the 
  website it will become ok because the IClusterClient is still null and  ClientBuilder.Build() is also 
   invoked for init. and then it will OK all the time.

  the env is:   windows 10  IIS 10  donet framework 4.7.2  asp.net mvc 5.2.4.0.

the debugger show that:
FatalExecutionEngineError  error address is 0x0df3063f，at thread 0xbf8 。error code is 0xc0000005。maybe it is a CLR  bug，or unsafe code bug。maybe with COM-interop or PInvoke .

please help.

![error](https://user-images.githubusercontent.com/17829409/43782305-a40558ce-9a91-11e8-9c2b-73e460f6af09.PNG)

![error2](https://user-images.githubusercontent.com/17829409/43782812-bf60bb58-9a92-11e8-8751-99d24f0fe083.PNG)
","Error occurs in clusterbuilder.build  when  iis website restart Hi
  I have a websit using Orleans Client connect to the server.

  I have a static ClusterClient
    and when the website start the ClientBuilder.Build() is invoked and connect to the server.
    and when  the website shut down IClusterClient.Close() and Dispose() is invoked .

  it runs good but when the website restart it become unstable   and then if continue access the 
  website it will become ok because the IClusterClient is still null and  ClientBuilder.Build() is also 
   invoked for init. and then it will OK all the time.

  the env is:   windows 10  IIS 10  donet framework 4.7.2  asp.net mvc 5.2.4.0.

the debugger show that:
FatalExecutionEngineError  error address is 0x0df3063f，at thread 0xbf8 。error code is 0xc0000005。maybe it is a CLR  bug，or unsafe code bug。maybe with COM-interop or PInvoke .

please help.

![error](https://user-images.githubusercontent.com/17829409/43782305-a40558ce-9a91-11e8-9c2b-73e460f6af09.PNG)

![error2](https://user-images.githubusercontent.com/17829409/43782812-bf60bb58-9a92-11e8-8751-99d24f0fe083.PNG)
",,ReubenBond,,
4822,Which code files are maintained for memberships tables and grain directory tables?,"  I'm studying the implementation of Orleans but I've found that I can't find the specific maintenance code for the memberships table and the grain directory table. Including the entry of members normal exit and abnormal exit Grain activation and deactivation and node failure when the table recovery operations.

  Could you tell me which files are the specific implementation codes of these operations?","Which code files are maintained for memberships tables and grain directory tables?   I'm studying the implementation of Orleans but I've found that I can't find the specific maintenance code for the memberships table and the grain directory table. Including the entry of members normal exit and abnormal exit Grain activation and deactivation and node failure when the table recovery operations.

  Could you tell me which files are the specific implementation codes of these operations?",question,sergeybykov,,
4821,GatewayClientReceiver.FillBuffer() being slow and looks like executing in critical section,"Hi Team

While troubleshooting slowness with our cloud service we noticed from the memory dump logs that the GatewayClientReceiver.FillBuffer() is taking time and might be executing in critical section which might also be blocking other threads. However when I look at the code it looks like only initialization logic for senders/receivers is getting executed in critical section. 
some of the stack trace from memory dump where we see that the thread have been stuck for a while:

As it is difficult to find the real cause here we need a confirmation from you that the processing of messages (queuing and fillbuffer) should be executing well within the expected time.
Also should we reduce or increase the sizes of send/receive buffers to fine tune the performance considering that our application works in high load and sends/receives a lot of messages within Orleans cluster.
We are using Orleans 2.0.0 on Azure Cloud Service.","GatewayClientReceiver.FillBuffer() being slow and looks like executing in critical section Hi Team

While troubleshooting slowness with our cloud service we noticed from the memory dump logs that the GatewayClientReceiver.FillBuffer() is taking time and might be executing in critical section which might also be blocking other threads. However when I look at the code it looks like only initialization logic for senders/receivers is getting executed in critical section. 
some of the stack trace from memory dump where we see that the thread have been stuck for a while:

As it is difficult to find the real cause here we need a confirmation from you that the processing of messages (queuing and fillbuffer) should be executing well within the expected time.
Also should we reduce or increase the sizes of send/receive buffers to fine tune the performance considering that our application works in high load and sends/receives a lot of messages within Orleans cluster.
We are using Orleans 2.0.0 on Azure Cloud Service.",,benjaminpetit,,
4820,Separation of Transaction Manager and Transactional Resource,"Separation of Transaction Manager and Transactional Resource
- Remove transaction participant
- Full separation of tm and resource grain extensions.
- Grain references are used everwhere and cast to extensions where needed.

Next step: Add TOC support
","Separation of Transaction Manager and Transactional Resource Separation of Transaction Manager and Transactional Resource
- Remove transaction participant
- Full separation of tm and resource grain extensions.
- Grain references are used everwhere and cast to extensions where needed.

Next step: Add TOC support
",,ReubenBond,,
4819,"Type string ""Orleans.Runtime.RequestInvocationHistory"" cannot be resolved.","When I do the following setting Client will throw an exception..
1.Apply(T action) in D:\Git\orleans\src\Orleans.Core\Threading\ActionFilter.cs:line 86","Type string ""Orleans.Runtime.RequestInvocationHistory"" cannot be resolved. When I do the following setting Client will throw an exception..
1.Apply(T action) in D:\Git\orleans\src\Orleans.Core\Threading\ActionFilter.cs:line 86",,jason-bragg,,
4818,Grain can't be collection normally,"I set up the following：

After the Grain is collection it can be seen through the Dashboardand has not been collection successfully.
I will not be able to activate these Grain again.
But if update SqlEventStorage.cs line 136 use Task.Run will not the problem.
This problem is very easy to happen if you introduce a third party library.

Example:
Startup need the postgresql and rabbitmq.
[Ray.git.zip](https://github.com/dotnet/orleans/files/2260031/Ray.git.zip)
","Grain can't be collection normally I set up the following：

After the Grain is collection it can be seen through the Dashboardand has not been collection successfully.
I will not be able to activate these Grain again.
But if update SqlEventStorage.cs line 136 use Task.Run will not the problem.
This problem is very easy to happen if you introduce a third party library.

Example:
Startup need the postgresql and rabbitmq.
[Ray.git.zip](https://github.com/dotnet/orleans/files/2260031/Ray.git.zip)
",,benjaminpetit,,
4816,[WIP] Add memory threshold,A naive implementation that allows for configurable suppression of grain collection based on memory pressure.,[WIP] Add memory threshold A naive implementation that allows for configurable suppression of grain collection based on memory pressure.,,benjaminpetit,,
4813,Bump code generation version to 2.0.4,,Bump code generation version to 2.0.4 ,,benjaminpetit,,
4812,Build time codegen quite unstable on Orleans 2.x,"Hello folks 

I saw some issues pointing out multiple issues with build time codegen after Orleans 2.x was released.

In fact I've suffering since 2.0 release with multiple different issues with it. Some PR were made attempting to fix but which just failed.

I'm opening this issue in an attempt to bring team's attention to this matter as it is turning build time codegen practically unusable the way it is now.

As discussed with @ReubenBond it looks like the new codegen he is working is going to fix if not all the majority of those current issues but the work is on hold due to other team's priorities. 

It is a major block on multiple projects I'm working with so I would appreciate if Reuben have a bit more of time to dedicate to it. 

Thank you all!","Build time codegen quite unstable on Orleans 2.x Hello folks 

I saw some issues pointing out multiple issues with build time codegen after Orleans 2.x was released.

In fact I've suffering since 2.0 release with multiple different issues with it. Some PR were made attempting to fix but which just failed.

I'm opening this issue in an attempt to bring team's attention to this matter as it is turning build time codegen practically unusable the way it is now.

As discussed with @ReubenBond it looks like the new codegen he is working is going to fix if not all the majority of those current issues but the work is on hold due to other team's priorities. 

It is a major block on multiple projects I'm working with so I would appreciate if Reuben have a bit more of time to dedicate to it. 

Thank you all!",,ReubenBond,,
4811,Errors from SiloHost,"Hello

I have a Silohost & client running on local machine and connects through consul membership. Everything works fine but I was able to find below exceptions. What are these excepions? Do I need to fix something before these code move to higher environments?

{""Timestamp"":""2018-08-01T17:00:58.0013497-05:00""""Level"":""Error""""MessageTemplate"":""Worker pool thread Runtime.Scheduler.WorkerPoolThread/3 (ManagedThreadId=40) has been busy for long time:
 Executing Task Id=97879 Status=Running for 00:00:59.7464953 on WorkItem=WorkItemGroup:Name=[Activation: S10.XXX.XX.XXX:XX:270856538*grn/9B57CB77/00000000+XXXXZ505@01be8caf
 #GrainType=XXXXX.XXXXX.Grains.CommandBus Placement=ActivationCountBasedPlacement]WorkGroupStatus=Running Executing for 00:00:59.7555196. WorkItemGroup Details: 
 WorkItemGroup:Name=[Activation: S10.XX.XX.XX:XX:270856538*grn/9B57CB77/00000000+17543CZ505@01be8caf #GrainType=XXXX.XXXXX.Grains.CommandBus Placement=ActivationCountBasedPlacement]
 WorkGroupStatus=Running. Currently QueuedWorkItems=0; Total EnQueued=2; Total processed=1; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-14:Queued=0; Detailed 
 SchedulingContext=<[Activation: S10.XXX.XX.XXX:XXX:270856538*grn/9B57CB77/0000000000000000000000000000000006ffffff9b57cb77+17543CZ505-0x1E0EA515@01be8caf #GrainType=XXXX.XXXXX.Grains.CommandBus 
 Placement=ActivationCountBasedPlacement State=Valid NonReentrancyQueueSize=0 EnqueuedOnDispatcher=0 InFlightCount=1 NumRunning=1 IdlenessTimeSpan=736906.22:00:58.0003454 
 CollectionAgeLimit=02:00:00 CurrentlyExecuting=NewPlacement Request XXX.XXX.XX.XX:XXX:270856538*cli/a64bf6b3@bf402085->S10.XXX.XX.XXX:XX:270856538*grn/9B57CB77/00000000+17543CZ505@01be8caf 
 #5: ]>.""""Properties"":{""EventId"":{""Id"":101212}""SourceContext"":""Runtime.Scheduler.WorkerPoolThread/3""""Orleans"":""XXXXXX""""EnvironmentUserName"":""XXXXX\\XXXXXX""""MachineName"":""XXXXXXX""
 ""ProcessId"":15836""ProcessName"":""XXXX.XXXXX.Host""""ThreadId"":40}}
 
{""Timestamp"":""2018-08-01T17:00:59.7092269-05:00""""Level"":""Error""""MessageTemplate"":""Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. 
Last fired at 2018-08-01 22:00:42.396 GMT 00:00:17.3124134 since previous fire should have fired after 00:00:10.""""Properties"":{""EventId"":{""Id"":101412}""SourceContext"":
""Orleans.Runtime.GrainTimer""""Orleans"":""SiloHostBuilder""""EnvironmentUserName"":""XXXX\\XXXXX""""MachineName"":""XXXXXX-XXX""""ProcessId"":15836""ProcessName"":""XXXXX.XXXX.Host""""ThreadId"":40}}


{""Timestamp"":""2018-08-01T17:01:03.2601117-05:00""""Level"":""Error""""MessageTemplate"":""Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. 
Last fired at 2018-08-01 21:55:44.998 GMT 00:05:18.2619388 since previous fire should have fired after 00:05:00.""""Properties"":{""EventId"":{""Id"":101412}
""SourceContext"":""Orleans.Runtime.GrainTimer""""Orleans"":""SiloHostBuilder""""EnvironmentUserName"":""XXXX\\XXXXXX""""MachineName"":""XXXXXX-XXX""""ProcessId"":15836""
ProcessName"":""XXXXX.XXXXX.Host""""ThreadId"":40}}
","Errors from SiloHost Hello

I have a Silohost & client running on local machine and connects through consul membership. Everything works fine but I was able to find below exceptions. What are these excepions? Do I need to fix something before these code move to higher environments?

{""Timestamp"":""2018-08-01T17:00:58.0013497-05:00""""Level"":""Error""""MessageTemplate"":""Worker pool thread Runtime.Scheduler.WorkerPoolThread/3 (ManagedThreadId=40) has been busy for long time:
 Executing Task Id=97879 Status=Running for 00:00:59.7464953 on WorkItem=WorkItemGroup:Name=[Activation: S10.XXX.XX.XXX:XX:270856538*grn/9B57CB77/00000000+XXXXZ505@01be8caf
 #GrainType=XXXXX.XXXXX.Grains.CommandBus Placement=ActivationCountBasedPlacement]WorkGroupStatus=Running Executing for 00:00:59.7555196. WorkItemGroup Details: 
 WorkItemGroup:Name=[Activation: S10.XX.XX.XX:XX:270856538*grn/9B57CB77/00000000+17543CZ505@01be8caf #GrainType=XXXX.XXXXX.Grains.CommandBus Placement=ActivationCountBasedPlacement]
 WorkGroupStatus=Running. Currently QueuedWorkItems=0; Total EnQueued=2; Total processed=1; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-14:Queued=0; Detailed 
 SchedulingContext=<[Activation: S10.XXX.XX.XXX:XXX:270856538*grn/9B57CB77/0000000000000000000000000000000006ffffff9b57cb77+17543CZ505-0x1E0EA515@01be8caf #GrainType=XXXX.XXXXX.Grains.CommandBus 
 Placement=ActivationCountBasedPlacement State=Valid NonReentrancyQueueSize=0 EnqueuedOnDispatcher=0 InFlightCount=1 NumRunning=1 IdlenessTimeSpan=736906.22:00:58.0003454 
 CollectionAgeLimit=02:00:00 CurrentlyExecuting=NewPlacement Request XXX.XXX.XX.XX:XXX:270856538*cli/a64bf6b3@bf402085->S10.XXX.XX.XXX:XX:270856538*grn/9B57CB77/00000000+17543CZ505@01be8caf 
 #5: ]>.""""Properties"":{""EventId"":{""Id"":101212}""SourceContext"":""Runtime.Scheduler.WorkerPoolThread/3""""Orleans"":""XXXXXX""""EnvironmentUserName"":""XXXXX\\XXXXXX""""MachineName"":""XXXXXXX""
 ""ProcessId"":15836""ProcessName"":""XXXX.XXXXX.Host""""ThreadId"":40}}
 
{""Timestamp"":""2018-08-01T17:00:59.7092269-05:00""""Level"":""Error""""MessageTemplate"":""Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. 
Last fired at 2018-08-01 22:00:42.396 GMT 00:00:17.3124134 since previous fire should have fired after 00:00:10.""""Properties"":{""EventId"":{""Id"":101412}""SourceContext"":
""Orleans.Runtime.GrainTimer""""Orleans"":""SiloHostBuilder""""EnvironmentUserName"":""XXXX\\XXXXX""""MachineName"":""XXXXXX-XXX""""ProcessId"":15836""ProcessName"":""XXXXX.XXXX.Host""""ThreadId"":40}}


{""Timestamp"":""2018-08-01T17:01:03.2601117-05:00""""Level"":""Error""""MessageTemplate"":""Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. 
Last fired at 2018-08-01 21:55:44.998 GMT 00:05:18.2619388 since previous fire should have fired after 00:05:00.""""Properties"":{""EventId"":{""Id"":101412}
""SourceContext"":""Orleans.Runtime.GrainTimer""""Orleans"":""SiloHostBuilder""""EnvironmentUserName"":""XXXX\\XXXXXX""""MachineName"":""XXXXXX-XXX""""ProcessId"":15836""
ProcessName"":""XXXXX.XXXXX.Host""""ThreadId"":40}}
",,jason-bragg,,
4810,Limited separation of transaction orchestration and participation.,"First pass at separating transaction orchestration (transaction manager) from participation (transactional resource).

Goal is to eventually be able to support a variety of transactional resources (state queues event sourcing ...) as well as advanced transactional patterns like Transfer of Commit (TOC).

This PR should have no behavioral changes only code reorganization.
- Added transaction manager and transactional resource interfaces
- Removed partial classes separating logic into a read/write lock and transaction queue transaction manager and transactional resource.

More work needs be done this is just a first pass.","Limited separation of transaction orchestration and participation. First pass at separating transaction orchestration (transaction manager) from participation (transactional resource).

Goal is to eventually be able to support a variety of transactional resources (state queues event sourcing ...) as well as advanced transactional patterns like Transfer of Commit (TOC).

This PR should have no behavioral changes only code reorganization.
- Added transaction manager and transactional resource interfaces
- Removed partial classes separating logic into a read/write lock and transaction queue transaction manager and transactional resource.

More work needs be done this is just a first pass.",,xiazen,,
4809,LightInject integration issue,"I am trying to use [LightInject ](https://github.com/seesharper/LightInject) as IoC container in Orleans Silo and on startup it throws an error 
Full solution that can reproduce the issue can be found here:
https://github.com/n-sidorov/OreansLightInjectIssueRepro","LightInject integration issue I am trying to use [LightInject ](https://github.com/seesharper/LightInject) as IoC container in Orleans Silo and on startup it throws an error 
Full solution that can reproduce the issue can be found here:
https://github.com/n-sidorov/OreansLightInjectIssueRepro",,xiazen,,
4808,Remove the callchain information for the OneWay message,"Recently I've met a deadlock exception caused by a OneWay message. As far as I know the sender of the one-way message will not wailt for the response of the message. This means that even if the callee calls the function on the same grain the message will be added to the next position of messaging queue and will not cause a deadlock. So we should add a check on the line below if it is a OneWay message the call chain information should not be passed to next calls. 

https://github.com/dotnet/orleans/blob/e2b25a695767ae5746ffe47218c1331427997894/src/Orleans.Runtime/Core/InsideRuntimeClient.cs#L292

I don't know if I'm correct. If the thought is correct I will make a pull-request to fix it.","Remove the callchain information for the OneWay message Recently I've met a deadlock exception caused by a OneWay message. As far as I know the sender of the one-way message will not wailt for the response of the message. This means that even if the callee calls the function on the same grain the message will be added to the next position of messaging queue and will not cause a deadlock. So we should add a check on the line below if it is a OneWay message the call chain information should not be passed to next calls. 

https://github.com/dotnet/orleans/blob/e2b25a695767ae5746ffe47218c1331427997894/src/Orleans.Runtime/Core/InsideRuntimeClient.cs#L292

I don't know if I'm correct. If the thought is correct I will make a pull-request to fix it.",,ReubenBond,,
4913,Add back .editorconfig,"This adds back the .editorconfig file from #3872 that was removed by #3963.
I fixed some bugs in the file (removed severity from formatting rules that don't support it) and changed all warnings to suggestions or even to ""none"" for some rules.
Changed some of the rules to better match the existing codebase but it's not always consistent so suggestions for style changes are welcome.","Add back .editorconfig This adds back the .editorconfig file from #3872 that was removed by #3963.
I fixed some bugs in the file (removed severity from formatting rules that don't support it) and changed all warnings to suggestions or even to ""none"" for some rules.
Changed some of the rules to better match the existing codebase but it's not always consistent so suggestions for style changes are welcome.",,ReubenBond,,
4911,Do not try to register GrainVersionStore if an implementation of IVersionStore is already registered,Fix for #4855 ,Do not try to register GrainVersionStore if an implementation of IVersionStore is already registered Fix for #4855 ,,ReubenBond,,
4910,Access to declared state type in IGrainStorage,"The declared type of the grain state is not accessible via IGrainState.  The runtime type is however you can't determine the actual declared type. This causes problems when the state is of a derived type of the declared type.
e.g. in the IGrainStorage interface the only params you get about the state is IGrainState and if you need the declared type you're out of luck.

There's a hack available though. The implementation type of IGrainState is the internal 
and hope the grainState runtime type doesn't change.

I can suggest two options:
1 - Add **DeclaredStateType** parameter to IGrainStorage methods.
2 - Add DeclaredStateType to IGrainState. This does make the grain state object bigger and I don't know other places using IGrainState. So if there's no benefit other than this I would stay with the hack or give it a second thought.

","Access to declared state type in IGrainStorage The declared type of the grain state is not accessible via IGrainState.  The runtime type is however you can't determine the actual declared type. This causes problems when the state is of a derived type of the declared type.
e.g. in the IGrainStorage interface the only params you get about the state is IGrainState and if you need the declared type you're out of luck.

There's a hack available though. The implementation type of IGrainState is the internal 
and hope the grainState runtime type doesn't change.

I can suggest two options:
1 - Add **DeclaredStateType** parameter to IGrainStorage methods.
2 - Add DeclaredStateType to IGrainState. This does make the grain state object bigger and I don't know other places using IGrainState. So if there's no benefit other than this I would stay with the hack or give it a second thought.

",,xiazen,,
4908,ManagementGrain.ForceActivationCollection with zero ageLimit causes undesired effects,"Calling ManagementGrain.ForceActivationCollection(TimeSpan.Zero) collects every grain including system grains and the ManagementGrain itself. Which effectively almost restarts the silo and causes the said grain call to timeout.

Shouldn't this exclude some grains (management grain pubsub etc.)? or at least make the TimeSpan.Zero value an invalid one? 

I can't think of a scenario where current behavior would be useful.
","ManagementGrain.ForceActivationCollection with zero ageLimit causes undesired effects Calling ManagementGrain.ForceActivationCollection(TimeSpan.Zero) collects every grain including system grains and the ManagementGrain itself. Which effectively almost restarts the silo and causes the said grain call to timeout.

Shouldn't this exclude some grains (management grain pubsub etc.)? or at least make the TimeSpan.Zero value an invalid one? 

I can't think of a scenario where current behavior would be useful.
",,benjaminpetit,,
4907,Propagate message serialization exceptions to callers,"Fixes #4793 

There are 6 scenarios being tested which can be summed up as  for external users. Nevertheless it's worth adding tests for the scenario just in case and it helped to uncover some issues and places we could improve logging.","Propagate message serialization exceptions to callers Fixes #4793 

There are 6 scenarios being tested which can be summed up as  for external users. Nevertheless it's worth adding tests for the scenario just in case and it helped to uncover some issues and places we could improve logging.",,xiazen,,
4906,Migrate DynamoDB transaction state provider to new interface,DynamoDB was originally submitted and merge with #4056. It implemented the .,Migrate DynamoDB transaction state provider to new interface DynamoDB was originally submitted and merge with #4056. It implemented the .,Hacktoberfest,sergeybykov,29/08/2018 9:33,30/11/2018 9:39
4905,Add 2.1.0-beta1 to changelog,,Add 2.1.0-beta1 to changelog ,,ReubenBond,,
4904,Remove ITransactionFaultInjector from src,"- Remove ITransactionFaultInjector from src. Fault are now injected into storage layer through FaultInjectedTransactionStateStorage implementations in test proj. 
- Remove MemoryConsistencyTests since we don't have a fault injection memory state storage for it to use yet. Can be added later. ","Remove ITransactionFaultInjector from src - Remove ITransactionFaultInjector from src. Fault are now injected into storage layer through FaultInjectedTransactionStateStorage implementations in test proj. 
- Remove MemoryConsistencyTests since we don't have a fault injection memory state storage for it to use yet. Can be added later. ",,jason-bragg,,
4901,Move actor identity content from 1.5 tutorials to grains section,"The content of the 1.5 tutorial ""Actor Identity"" contains information about grain IDs and no steps to accomplish a task. It should be put with other similar pages.

","Move actor identity content from 1.5 tutorials to grains section The content of the 1.5 tutorial ""Actor Identity"" contains information about grain IDs and no steps to accomplish a task. It should be put with other similar pages.

",documentation,sergeybykov,,
4900,API to access the default DeepCopier,"There should be a way to access the default copier from an  implementation. That would be useful when only trying to override the serialization/deserialization behavior of a type.
And it should be possible to access the default serialization code when only overriding deep-copying is needed.","API to access the default DeepCopier There should be a way to access the default copier from an  implementation. That would be useful when only trying to override the serialization/deserialization behavior of a type.
And it should be possible to access the default serialization code when only overriding deep-copying is needed.",,ReubenBond,,
4896,Activation address cache is not invalidated when only [OneWay] calls are used,"Scenario:

* Call  methods on a grain from silo A
  * Activation is hosted on silo B
  * Activation is registered in directory partition on silo C 
* Deactivate that grain (eg by killing silo C) 
* Silo A will never learn that the grain has been destroyed and will keep messaging a non-existent activation (unsuccessfully unbeknownst to caller or calling silo)

","Activation address cache is not invalidated when only [OneWay] calls are used Scenario:

* Call  methods on a grain from silo A
  * Activation is hosted on silo B
  * Activation is registered in directory partition on silo C 
* Deactivate that grain (eg by killing silo C) 
* Silo A will never learn that the grain has been destroyed and will keep messaging a non-existent activation (unsuccessfully unbeknownst to caller or calling silo)

",P2,ReubenBond,,
4895,Use netcoreapp2.0 for msbuild target dll if using dotnet core msbuild but targeting full .net,"(Cherry-pick of #4689)

#4673 introduced a regression: when using the command  command in the path @ReubenBond ?","Use netcoreapp2.0 for msbuild target dll if using dotnet core msbuild but targeting full .net (Cherry-pick of #4689)

#4673 introduced a regression: when using the command  command in the path @ReubenBond ?",,ReubenBond,,
4894,Fixed build breaks from bad merge:," - Constructor mismatches
 - Adde CurrentTransactionId to transaction context","Fixed build breaks from bad merge:  - Constructor mismatches
 - Adde CurrentTransactionId to transaction context",,xiazen,,
4893,Build time codegen in 2.0.4 not working when using dotnet cli while targeting full .net framework,We need to backport #4689 to fix this issue,Build time codegen in 2.0.4 not working when using dotnet cli while targeting full .net framework We need to backport #4689 to fix this issue,bug,benjaminpetit,,
4892,fixes 'placeholder page' issue for Grains section,,fixes 'placeholder page' issue for Grains section ,documentation,sergeybykov,28/08/2018 1:12,28/08/2018 9:29
4891,Move actor identity content from 1.5 tutorials to grains section,"The 1.5 Tutorial page ""Actor Identity"" is informational not procedural - it should be included among other informational pages.","Move actor identity content from 1.5 tutorials to grains section The 1.5 Tutorial page ""Actor Identity"" is informational not procedural - it should be included among other informational pages.",documentation,sergeybykov,,
4890,Feature per grain collection attribute,,Feature per grain collection attribute ,,ReubenBond,,
4888,Fixes 'clusters and clients' similar to 'grains',,Fixes 'clusters and clients' similar to 'grains' ,documentation,sergeybykov,,
4886,"Moved the ""This documentation is for the 2.0 release"" section... ","… from Orleans Overview to main landing page (to keep content about documentation itself together)
- made some grammar and sentence structure edits
- verified links
","Moved the ""This documentation is for the 2.0 release"" section...  … from Orleans Overview to main landing page (to keep content about documentation itself together)
- made some grammar and sentence structure edits
- verified links
",documentation,sergeybykov,25/08/2018 3:23,28/08/2018 5:43
4885,What kind of scenario will the SiloName of the two nodes be the same?,When I read the code I saw the following code from  method used to handle?,What kind of scenario will the SiloName of the two nodes be the same? When I read the code I saw the following code from  method used to handle?,question,benjaminpetit,,
4884,Event Hub checkpoint on shutdown,"Checkpoints don't seem to occur on silo shutdown. This results in re-processing events when a silo comes back up.

Maybe ?
","Event Hub checkpoint on shutdown Checkpoints don't seem to occur on silo shutdown. This results in re-processing events when a silo comes back up.

Maybe ?
",,xiazen,,
4877,Build-time code generation version 2.0.4 breaks docker builds,When upgrading the ,Build-time code generation version 2.0.4 breaks docker builds When upgrading the ,,ReubenBond,,
4876,Fix DI cycle involving OrleansJsonSerializer,Fixes #4873,Fix DI cycle involving OrleansJsonSerializer Fixes #4873,,xiazen,,
4875,Revisit silo stop/shutdown timeout,,Revisit silo stop/shutdown timeout ,,ReubenBond,,
4874,Add storage exception injection logic into fault injection test runner,"Adding fault injection test case
- inject storage exception before store during Prepare
- inject storage exception after store during Prepare 
- inject storage exception before store during Confirm
- inject storage exception after store during Confirm
- inject storage exception before store during PrepareAndCommit
- inject storage exception after store during PrepareAndCommit

injecting exception before store simulates situation that state update failed to persist
injecting exception after store simulates situation that state update succeed to persist but runtime think it failed

currently all tests failed... I don't think I have a test logic issue. But please give me a second eye. ","Add storage exception injection logic into fault injection test runner Adding fault injection test case
- inject storage exception before store during Prepare
- inject storage exception after store during Prepare 
- inject storage exception before store during Confirm
- inject storage exception after store during Confirm
- inject storage exception before store during PrepareAndCommit
- inject storage exception after store during PrepareAndCommit

injecting exception before store simulates situation that state update failed to persist
injecting exception after store simulates situation that state update succeed to persist but runtime think it failed

currently all tests failed... I don't think I have a test logic issue. But please give me a second eye. ",,jason-bragg,,
4873,StackOverflowException when adding OrleansJsonSerializer as a SerializationProvider,"Workaround: use this gist instead https://gist.github.com/ReubenBond/45ef767aff071302ee62731b5c706dd7

Repro:


Only the silo fails the client doesn't have a dependency cycle.","StackOverflowException when adding OrleansJsonSerializer as a SerializationProvider Workaround: use this gist instead https://gist.github.com/ReubenBond/45ef767aff071302ee62731b5c706dd7

Repro:


Only the silo fails the client doesn't have a dependency cycle.",P2,ReubenBond,,
4872,No menu topic for Streaming after restructuring of docs,,No menu topic for Streaming after restructuring of docs ,documentation,JillHeaden,,
4871,Rename UseDistributedTM to UseTransactions,fix issue #4688 ,Rename UseDistributedTM to UseTransactions fix issue #4688 ,,jason-bragg,,
4870,Remove documentation sources,"I moved documentation sources to the docs branch so that we completely separate them from the generated html output. The goal is to move them to a separate repo altogether.

This is to delete doc sources from the gh-pages branch to prevent duplication and potential confusion.","Remove documentation sources I moved documentation sources to the docs branch so that we completely separate them from the generated html output. The goal is to move them to a separate repo altogether.

This is to delete doc sources from the gh-pages branch to prevent duplication and potential confusion.",,ReubenBond,,
4868,Should not need `.AsReference<>` when returning a grain,"I have a bit of code in the Registry pattern:

 I get an exception saying serialization failed.

Is this an edge case that got missed for grain checking?","Should not need  I get an exception saying serialization failed.

Is this an edge case that got missed for grain checking?",,ReubenBond,,
4867,Avoiding the OrleansAdoNetContent folder,"The solution to #4243 causes repositories and projects to be polluted by the OrleansAdoNetContent folder. One has to employ various hacks to ensure that the folder is removed after package restore and in the case of  there doesn't even seem to exist any target to use with AfterTargets to get rid of the files.

I see how the files could be useful for someone just starting out with Orleans but not for an established project. In my case the files are possibly harmful as I'm running on a modified schema and these files would only confuse my colleagues.

A possible solution would be to move the copying of these files into the OrleansSQLUtils project. One can then reference the individual packages to bypass the copying of the SQL files.

Has anyone else spent way too much time fighting these files? :) Any other ideas as to what can be done about it?","Avoiding the OrleansAdoNetContent folder The solution to #4243 causes repositories and projects to be polluted by the OrleansAdoNetContent folder. One has to employ various hacks to ensure that the folder is removed after package restore and in the case of  there doesn't even seem to exist any target to use with AfterTargets to get rid of the files.

I see how the files could be useful for someone just starting out with Orleans but not for an established project. In my case the files are possibly harmful as I'm running on a modified schema and these files would only confuse my colleagues.

A possible solution would be to move the copying of these files into the OrleansSQLUtils project. One can then reference the individual packages to bypass the copying of the SQL files.

Has anyone else spent way too much time fighting these files? :) Any other ideas as to what can be done about it?",,sergeybykov,,
4866,Minio grain storage provider,"I made a grain storage provider implementation with [Minio](https://www.minio.io/) which is a free  open source distributed object storage.

The implementation currently resides as code on [my repository](https://github.com/Kimserey/orleans-minio) under [/OrleansMinio](https://github.com/Kimserey/orleans-minio/tree/master/OrleansMinio) which I would like to PR into Orleans. I just don't know how to proceed. 

https://github.com/Kimserey/orleans-minio

If someone could guide me by answering the following questions:

1. Is it something you see worth PR'ing? If it isn't we can close this question.
_Minio is useful for me as I wish to not be tied to cloud providers services and prefer rely on free open source solutions._
2. How should I proceed? Are there any guidelines as I see other grain storages are within folder that are _linked files_ to _/shared_.

Thanks!","Minio grain storage provider I made a grain storage provider implementation with [Minio](https://www.minio.io/) which is a free  open source distributed object storage.

The implementation currently resides as code on [my repository](https://github.com/Kimserey/orleans-minio) under [/OrleansMinio](https://github.com/Kimserey/orleans-minio/tree/master/OrleansMinio) which I would like to PR into Orleans. I just don't know how to proceed. 

https://github.com/Kimserey/orleans-minio

If someone could guide me by answering the following questions:

1. Is it something you see worth PR'ing? If it isn't we can close this question.
_Minio is useful for me as I wish to not be tied to cloud providers services and prefer rely on free open source solutions._
2. How should I proceed? Are there any guidelines as I see other grain storages are within folder that are _linked files_ to _/shared_.

Thanks!",question,sergeybykov,22/08/2018 22:02,6/09/2018 5:24
4865,Await tasks in DedicatedAsynchAgent.Run(),"Source description in gitter:
> I'm discovering the internal of orleans' runtime and I found that  rather than just start a job/task in the .NET thread pool.
* If it is safe to execute DedicatedAsynchAgent logic out of its ThreadPoolExecutor's thread.


PS.
*There may be some misunderstanding about ThreadPoolExecutor/AsynchAgent/Async-Await ... I'm glad to be corrected.*
*It's so much fun to read Orleans' source code what you people did is fantastic*","Await tasks in DedicatedAsynchAgent.Run() Source description in gitter:
> I'm discovering the internal of orleans' runtime and I found that  rather than just start a job/task in the .NET thread pool.
* If it is safe to execute DedicatedAsynchAgent logic out of its ThreadPoolExecutor's thread.


PS.
*There may be some misunderstanding about ThreadPoolExecutor/AsynchAgent/Async-Await ... I'm glad to be corrected.*
*It's so much fun to read Orleans' source code what you people did is fantastic*",,ReubenBond,,
4862,[Question] Orleans Event Sourcing snapshots of event log,"I have a JournaledGrain which I am persisting events through the attribute [LogConsistencyProvider(ProviderName = ""LogStorage"")]. Since this grain will handle heavy load hydrating the grain every time with all the events can result in a performance bottleneck. As a result snapshot are one alternative to this problem by hydrating events since the latest snapshot only. Is there is a way to handle snapshots in Orleans Event Sourcing?

I am using MongoDB to persist the data.","[Question] Orleans Event Sourcing snapshots of event log I have a JournaledGrain which I am persisting events through the attribute [LogConsistencyProvider(ProviderName = ""LogStorage"")]. Since this grain will handle heavy load hydrating the grain every time with all the events can result in a performance bottleneck. As a result snapshot are one alternative to this problem by hydrating events since the latest snapshot only. Is there is a way to handle snapshots in Orleans Event Sourcing?

I am using MongoDB to persist the data.",,sebastianburckhardt,,
4861,No default grains storage added to container if one is not configured.,Addresses - IGrainStorage null implementation registerd in DI container #4710,No default grains storage added to container if one is not configured. Addresses - IGrainStorage null implementation registerd in DI container #4710,,ReubenBond,,
4860,Minimal TOC,"Minimal transfer of coordintation support for transactions.
- TransactionCommitter facet
- Changed to commit logic to commit only upon successfull remot service call.
- Minima golden path tests","Minimal TOC Minimal transfer of coordintation support for transactions.
- TransactionCommitter facet
- Changed to commit logic to commit only upon successfull remot service call.
- Minima golden path tests",,xiazen,,
4859,Silo with EFCore Lazy Loading failed to catch System.ExecutionEngineException and crash silently,"* Orleans.Server: 2.0.4
* EntityFrameworkCore: 2.1.1

I'm using EF Core and enable Lazy Loading for grain to store data.
When I use the EF entity proxy object as a return value for grain method it will throw a ).","Silo with EFCore Lazy Loading failed to catch System.ExecutionEngineException and crash silently * Orleans.Server: 2.0.4
* EntityFrameworkCore: 2.1.1

I'm using EF Core and enable Lazy Loading for grain to store data.
When I use the EF entity proxy object as a return value for grain method it will throw a ).",,ReubenBond,,
4858,Orleans.Transactions.TransactionInfo not in Core,When a transaction aborts for whatever reason the exception that is serialized contains the Orleans.Transactions.TransactionInfo type.  That type is in Orleans.Transactions not in Orleans.Core so if the client doesn't reference the transactions package it fails to deserialize the exception (which unfortunately causes a grain timeout exception instead of a failed to deserialize exception to be delivered to the caller).,Orleans.Transactions.TransactionInfo not in Core When a transaction aborts for whatever reason the exception that is serialized contains the Orleans.Transactions.TransactionInfo type.  That type is in Orleans.Transactions not in Orleans.Core so if the client doesn't reference the transactions package it fails to deserialize the exception (which unfortunately causes a grain timeout exception instead of a failed to deserialize exception to be delivered to the caller).,P1,xiazen,18/08/2018 9:32,
4855,[Question] about GrainStorage and the internal VersionStoreGrain,"I'm writing a storage provider using efcore. 
The provider works against a configured dbcontext which means any type being used as storage should have a corresponding DbSet<> on the context. So arbitrary types are not welcomed here as the backing storage is not happy with them (SQL Server for example).

Now the problem raises If the provider is used as the default grain storage. This causes the internal  differently. This probably suggest an internal dbcontext to handle Orleans related stuff. Which also causes the provider to break if I'm missing another internal type.
- Handle arbitrary types using a fallback provider or a key-value table.
- Don't allow the provider to be used as the default storage.

I know using entity framework inherently suggest that arbitrary types can't be used but for this to work it should be able to be used as the only grain storage provider in the silo.

I'll probably go with option 3 with my current knowledge of Orleans. Any advice is very appreciated. I'm gonna open source this as soon as I finish this and write more tests.","[Question] about GrainStorage and the internal VersionStoreGrain I'm writing a storage provider using efcore. 
The provider works against a configured dbcontext which means any type being used as storage should have a corresponding DbSet<> on the context. So arbitrary types are not welcomed here as the backing storage is not happy with them (SQL Server for example).

Now the problem raises If the provider is used as the default grain storage. This causes the internal  differently. This probably suggest an internal dbcontext to handle Orleans related stuff. Which also causes the provider to break if I'm missing another internal type.
- Handle arbitrary types using a fallback provider or a key-value table.
- Don't allow the provider to be used as the default storage.

I know using entity framework inherently suggest that arbitrary types can't be used but for this to work it should be able to be used as the only grain storage provider in the silo.

I'll probably go with option 3 with my current knowledge of Orleans. Any advice is very appreciated. I'm gonna open source this as soon as I finish this and write more tests.",bug,benjaminpetit,,
4853,Do not place stateless worker locally if the silo is stopping,Fix for #4852 and #4757 ,Do not place stateless worker locally if the silo is stopping Fix for #4852 and #4757 ,,ReubenBond,,
4852,Revisit handling of StatelessWorker grains during shutdown,Base on the feedback in #4757 we need to reconsider how StatelessWorker grains are handled during silo shutdown.,Revisit handling of StatelessWorker grains during shutdown Base on the feedback in #4757 we need to reconsider how StatelessWorker grains are handled during silo shutdown.,enhancement,benjaminpetit,,
4851,transaction consistency tests and error injection,"the consistency tests I have been using for testing the transaction implementation.

- includes a test runner that runs randomized transaction tests using various scale and randomization settings.  Running all of those takes a long time (because of the large number of tests and the volume of the tests) but this is sort of intentional for this type of test (random testing is quite good at discovering subtle race conditions if run with enough volume).

- each consistency test records a lot of data while executing the random transactions (state version numbers read & written by each transaction for each grain)  that is checked for serializability in the end. Also I check if any exceptions encountered are expected for the type of test being run. For example there should not be any transient exceptions under low congestion and when avoiding deadlocks and there should not be any unknown exceptions when storage injection is off.

- These tests can run with or without fault injection. 

- The fault injector randomly injects three kinds of exceptions:
    - an uninterpreted exception before or after writing to storage
    - an InconsistentStateException before writing to storage","transaction consistency tests and error injection the consistency tests I have been using for testing the transaction implementation.

- includes a test runner that runs randomized transaction tests using various scale and randomization settings.  Running all of those takes a long time (because of the large number of tests and the volume of the tests) but this is sort of intentional for this type of test (random testing is quite good at discovering subtle race conditions if run with enough volume).

- each consistency test records a lot of data while executing the random transactions (state version numbers read & written by each transaction for each grain)  that is checked for serializability in the end. Also I check if any exceptions encountered are expected for the type of test being run. For example there should not be any transient exceptions under low congestion and when avoiding deadlocks and there should not be any unknown exceptions when storage injection is off.

- These tests can run with or without fault injection. 

- The fault injector randomly injects three kinds of exceptions:
    - an uninterpreted exception before or after writing to storage
    - an InconsistentStateException before writing to storage",,xiazen,,
4850,Fix NullReferenceException in ExecutingWorkItemsTracker,"I hit a  constructor.

This PR fixes that adds some defensiveness and cleans up the code a little.","Fix NullReferenceException in ExecutingWorkItemsTracker I hit a  constructor.

This PR fixes that adds some defensiveness and cleans up the code a little.",,benjaminpetit,,
4847,Why is it that only the last Silo suspected of P can declare its death?,If the successor node ABC of P starts at intervals then it is possible that A suspects P writes; B suspects P writes; C suspects P writes and in such a dead cycle can not really declare P's death.,Why is it that only the last Silo suspected of P can declare its death? If the successor node ABC of P starts at intervals then it is possible that A suspects P writes; B suspects P writes; C suspects P writes and in such a dead cycle can not really declare P's death.,question,sergeybykov,,
4846,Repair typesetting error,Repair typesetting error.,Repair typesetting error Repair typesetting error.,documentation,JillHeaden,,
4844,Fix partial build,Tentative to bring #4740 to the master branch,Fix partial build Tentative to bring #4740 to the master branch,,ReubenBond,,
4843,Orleans Health Check,"We are running Orleans on a Kubernetes cluster.

What is the recommended way to set up readiness/liveliness (health) checks on silos?
","Orleans Health Check We are running Orleans on a Kubernetes cluster.

What is the recommended way to set up readiness/liveliness (health) checks on silos?
",question,benjaminpetit,,
4842,Orleans.Runtime.OrleansException: Not connected to a gateway when reconnecting to a local silo,"I'm just playing with Orleans and one of the basics and I tried the 2.0 sample app.

I started the client before the silo (intentionally) just to see if the retry policy outlined there would work. The client connected but then immediately failed with the error I'm pasting below.

Steps to reproduce:

1. Use the [Hello world sample](https://github.com/dotnet/orleans/tree/master/Samples/2.0/HelloWorld)
1. Start the client
1. Start the silo (after the client has been started)
1. Observe the log output to see the exception

Expected behaviour:
I would expect the client to successfully reconnect and perform operations normally. Is this something that is supposed to work or am I expecting too much? Let me know if you need more details on the setup.

Log output:

<details>
  <summary>Expand log content</summary>


</details>","Orleans.Runtime.OrleansException: Not connected to a gateway when reconnecting to a local silo I'm just playing with Orleans and one of the basics and I tried the 2.0 sample app.

I started the client before the silo (intentionally) just to see if the retry policy outlined there would work. The client connected but then immediately failed with the error I'm pasting below.

Steps to reproduce:

1. Use the [Hello world sample](https://github.com/dotnet/orleans/tree/master/Samples/2.0/HelloWorld)
1. Start the client
1. Start the silo (after the client has been started)
1. Observe the log output to see the exception

Expected behaviour:
I would expect the client to successfully reconnect and perform operations normally. Is this something that is supposed to work or am I expecting too much? Let me know if you need more details on the setup.

Log output:

<details>
  <summary>Expand log content</summary>


</details>",,benjaminpetit,,
4841,Ignore ambiguous transactions in correctness testing.,Updated transaction correctness/recoverability tests to not check results against client expectations if transaction success was ambiguous.,Ignore ambiguous transactions in correctness testing. Updated transaction correctness/recoverability tests to not check results against client expectations if transaction success was ambiguous.,,xiazen,,
4839,Namespace property removed from ImplicitStreamSubscriptionAttribute in 1.5,"From [gitter chat here](https://gitter.im/dotnet/orleans?at=5b6bf2c9e9b96f2c98e36bec)

We started to migrate 1.4 -> 1.5 (2.0 deemed too big rework and too many breaking changes)
and discovered that we need to make some changes in our code base. They are more or less reasonable like DI for constructors and some removed defaults. There is one change in 1.5 that looks strange and unreasonable and I'd like to understand what was the reasoning behind it:

Previously (in 1.4)  in favour of our own one and this is what we are doing now. For me it's a code smell to introduce your own attributes to solve the problem that was perfectly solved in older versions of framework.

But the question is - what was the reason behind this breaking change ? It feels that it doesn't affect anything but was simply to break public contract that was in use (across multiple 1.x version) without any obvious alternative or any afterthoughts of how this is going to affect existing deployments.

Also If there is a better way to implement this in non 2.0 world - keen to hear in comments.","Namespace property removed from ImplicitStreamSubscriptionAttribute in 1.5 From [gitter chat here](https://gitter.im/dotnet/orleans?at=5b6bf2c9e9b96f2c98e36bec)

We started to migrate 1.4 -> 1.5 (2.0 deemed too big rework and too many breaking changes)
and discovered that we need to make some changes in our code base. They are more or less reasonable like DI for constructors and some removed defaults. There is one change in 1.5 that looks strange and unreasonable and I'd like to understand what was the reasoning behind it:

Previously (in 1.4)  in favour of our own one and this is what we are doing now. For me it's a code smell to introduce your own attributes to solve the problem that was perfectly solved in older versions of framework.

But the question is - what was the reason behind this breaking change ? It feels that it doesn't affect anything but was simply to break public contract that was in use (across multiple 1.x version) without any obvious alternative or any afterthoughts of how this is going to affect existing deployments.

Also If there is a better way to implement this in non 2.0 world - keen to hear in comments.",documentation,jason-bragg,10/08/2018 8:44,
4837,Client shutdown problem,"Hi

We noticed that if we kill the client without calling method .Close next time when we tried to establish a connection with silo host client connection hangs with the state ""Starting"".

From console log we can see all active gateways TCP connection is alive but code simply hangs on 
![image](https://user-images.githubusercontent.com/1646051/43911787-9f151528-9c00-11e8-9390-e6dbec010879.png)

Has anyone else noticed the same issue before?

Best

Dean","Client shutdown problem Hi

We noticed that if we kill the client without calling method .Close next time when we tried to establish a connection with silo host client connection hangs with the state ""Starting"".

From console log we can see all active gateways TCP connection is alive but code simply hangs on 
![image](https://user-images.githubusercontent.com/1646051/43911787-9f151528-9c00-11e8-9390-e6dbec010879.png)

Has anyone else noticed the same issue before?

Best

Dean",,benjaminpetit,,
4835,Change Orleans.TelemetryConsumers.Counters project target platform to netstandard or netcoreapp,Currently  since  it is already available for netstandart https://www.nuget.org/packages/System.Diagnostics.PerformanceCounter/,Change Orleans.TelemetryConsumers.Counters project target platform to netstandard or netcoreapp Currently  since  it is already available for netstandart https://www.nuget.org/packages/System.Diagnostics.PerformanceCounter/,,ReubenBond,,
4834,Questions about Reminders timing,"Hey there
In our team we are using Orleans Reminders to perform an action that should run exactly every 1 hour.
Reminders are registered with the following function: 
As we noticed recently a reminder that was registered with dueTime=0 period=1 hour will not tick every one hour exactly.
It will simply wait 1 hour _after the last reminder ended_ and then send the next reminder tick.
That is a problem to us since the reminder invokes a function that can take few seconds to end. In that case we will have an **accumulative delay** on reminder ticks that will be received every 1 hour **+ epsilon**.

From [Orleans Documentation](https://dotnet.github.io/orleans/1.5/Documentation/Core-Features/Timers-and-Reminders.html) it is said to be the case for Orleans Timers and for Reminders it said that ""Reminders are similar to timers [...]"".

My question is **whether there is an option to configure reminder timing** to be exactly as we registered (first tick after dueTime time and then a tick every period) without being affected by the duration of the function the reminder invokes.
If there isn't other solutions would be (A) making the reminder to invoke a async Task without awaiting for it (B) making the reminder to start a timer to do the actual work or (C) keeping track on the delay from the expected time and once it got too big update and re-schedule the reminder.

We'll be glad to hear if you know a way to handle it or simply what would you do in such cases :)
","Questions about Reminders timing Hey there
In our team we are using Orleans Reminders to perform an action that should run exactly every 1 hour.
Reminders are registered with the following function: 
As we noticed recently a reminder that was registered with dueTime=0 period=1 hour will not tick every one hour exactly.
It will simply wait 1 hour _after the last reminder ended_ and then send the next reminder tick.
That is a problem to us since the reminder invokes a function that can take few seconds to end. In that case we will have an **accumulative delay** on reminder ticks that will be received every 1 hour **+ epsilon**.

From [Orleans Documentation](https://dotnet.github.io/orleans/1.5/Documentation/Core-Features/Timers-and-Reminders.html) it is said to be the case for Orleans Timers and for Reminders it said that ""Reminders are similar to timers [...]"".

My question is **whether there is an option to configure reminder timing** to be exactly as we registered (first tick after dueTime time and then a tick every period) without being affected by the duration of the function the reminder invokes.
If there isn't other solutions would be (A) making the reminder to invoke a async Task without awaiting for it (B) making the reminder to start a timer to do the actual work or (C) keeping track on the delay from the expected time and once it got too big update and re-schedule the reminder.

We'll be glad to hear if you know a way to handle it or simply what would you do in such cases :)
",question,sergeybykov,,
4833,Accepting into an existing Socket is not supported on this platform.,"Hi There 

I am deploying Orleans within docker on linux for the first time and have found an exception in my log that so far does not seem to be causing any issues. I though it worth reporting nonetheless.

My base image for docker deployment is microsoft/dotnet:2.1-runtime 

The log I have is as follows:

","Accepting into an existing Socket is not supported on this platform. Hi There 

I am deploying Orleans within docker on linux for the first time and have found an exception in my log that so far does not seem to be causing any issues. I though it worth reporting nonetheless.

My base image for docker deployment is microsoft/dotnet:2.1-runtime 

The log I have is as follows:

",,benjaminpetit,,
4832,Serializing Delegates not supported on this platform,"Hi There

I am running the latest version of Orleans on a docker container based upon microsoft/dotnet:2.1-runtime on linux.

It's running at AWS in the ECS environment.

The problem seems to be related to Fallback serialization of exceptions. I make a call to an external library AmazonLambdaClient which is throwing a permissions exception. The permissions exception is a custom exception type and it seems that there is something wrong with serialization of this custom exception within docker on linux. 

For now my workaround is to catch the exception and convert it to a regular System.Exception but I'm guessing this problem will rear it's head somewhere else.

The exception log is below:

","Serializing Delegates not supported on this platform Hi There

I am running the latest version of Orleans on a docker container based upon microsoft/dotnet:2.1-runtime on linux.

It's running at AWS in the ECS environment.

The problem seems to be related to Fallback serialization of exceptions. I make a call to an external library AmazonLambdaClient which is throwing a permissions exception. The permissions exception is a custom exception type and it seems that there is something wrong with serialization of this custom exception within docker on linux. 

For now my workaround is to catch the exception and convert it to a regular System.Exception but I'm guessing this problem will rear it's head somewhere else.

The exception log is below:

",,ReubenBond,,
4831,Added support for priority transaction manager. ,"Only one priority transaction manager is allowed per transaction.  Priority TM be used to detect TOC in future changes.

Also moved ReadonlyCommit to resource interface from tm interface.  Call was placed in wrong interface when split.","Added support for priority transaction manager.  Only one priority transaction manager is allowed per transaction.  Priority TM be used to detect TOC in future changes.

Also moved ReadonlyCommit to resource interface from tm interface.  Call was placed in wrong interface when split.",,xiazen,,
4830,When deactivating a grain do not stop timers if there are running requests ,"Fix for #4774 

Thanks @yevhen  I was able to repro this issue 100% with this test. Like said in the issue this will fix only part of the issue.","When deactivating a grain, do not stop timers if there are running requests  Fix for #4774 

Thanks @yevhen  I was able to repro this issue 100% with this test. Like said in the issue this will fix only part of the issue.",,ReubenBond,,
4828,Questions about the order of method calls ,"Hi 

I am working on a stream processing system which might be sensitive to the orders of the method calls between grains. If I call an async method which sends messages from A to B multiple times will the messages are processed in order? 

Thanks!

 ","Questions about the order of method calls  Hi 

I am working on a stream processing system which might be sensitive to the orders of the method calls between grains. If I call an async method which sends messages from A to B multiple times will the messages are processed in order? 

Thanks!

 ",question,jason-bragg,,
4826,Question/Sample Request: Long running function execution via Orleans,"I've seen in the documentation about how ""Orleans is not suited for long running work*"" (*Generally) - I may be paraphrasing. There are a few issues regarding that same topic #4531 #4370 #3071 and several others that I'm having trouble finding ATM.

The tldr of what I'm hoping to accomplish with Orleans is to take lots of calls from my app and dispatch them across a cluster of Orleans silos.  Many of these calls that occur are completed in a few milliseconds but many take several minutes to complete when running in our non-Orleans implementation.  

I understand there is a default timeout of 30 seconds for the client to receive a response from the grain and I would feel weird about increasing that to accommodate our ""longest running logic""  I feel like there has to be a better way of doing it that just increasing the timeout.

Currently my calls (either fast or slow) look similar to this and note this is all CPU bound work:

Client.cs
 in order to keep memory usage down; it seemed like I was getting into some situations where I'd have so many scheduled tasks that all memory would be utilized and nothing would complete.  

The above code does not work without setting the timeout to at least as high as our ""longest running operation"".  It seems that a lot of suggestions on getting around this are to ""return immediately that the task has been started then get the result when it's finished"" but I'm not finding any samples on how to accomplish this at least from both a client and grain perspective.

Could some samples be provided on how to accomplish what I'm going after?  It seems that some sort of check that an invocation is complete would be needed but I'm not sure how to go about that.  Would this require my grains to become stateful rather than stateless? #4370 seems like it ***may*** be of use but I'm only seeing from the grain perspective not what it looks like from the client.  Ideally my fast and long running client/grains with have similar looking implementations but if I have to break out into separate methods for accommodating that's fine as well.

Hopefully this all makes sense!","Question/Sample Request: Long running function execution via Orleans I've seen in the documentation about how ""Orleans is not suited for long running work*"" (*Generally) - I may be paraphrasing. There are a few issues regarding that same topic #4531 #4370 #3071 and several others that I'm having trouble finding ATM.

The tldr of what I'm hoping to accomplish with Orleans is to take lots of calls from my app and dispatch them across a cluster of Orleans silos.  Many of these calls that occur are completed in a few milliseconds but many take several minutes to complete when running in our non-Orleans implementation.  

I understand there is a default timeout of 30 seconds for the client to receive a response from the grain and I would feel weird about increasing that to accommodate our ""longest running logic""  I feel like there has to be a better way of doing it that just increasing the timeout.

Currently my calls (either fast or slow) look similar to this and note this is all CPU bound work:

Client.cs
 in order to keep memory usage down; it seemed like I was getting into some situations where I'd have so many scheduled tasks that all memory would be utilized and nothing would complete.  

The above code does not work without setting the timeout to at least as high as our ""longest running operation"".  It seems that a lot of suggestions on getting around this are to ""return immediately that the task has been started then get the result when it's finished"" but I'm not finding any samples on how to accomplish this at least from both a client and grain perspective.

Could some samples be provided on how to accomplish what I'm going after?  It seems that some sort of check that an invocation is complete would be needed but I'm not sure how to go about that.  Would this require my grains to become stateful rather than stateless? #4370 seems like it ***may*** be of use but I'm only seeing from the grain perspective not what it looks like from the client.  Ideally my fast and long running client/grains with have similar looking implementations but if I have to break out into separate methods for accommodating that's fine as well.

Hopefully this all makes sense!",question,sergeybykov,,
4823,Error occurs in clusterbuilder.build  when  iis website restart,"Hi
  I have a websit using Orleans Client connect to the server.

  I have a static ClusterClient
    and when the website start the ClientBuilder.Build() is invoked and connect to the server.
    and when  the website shut down IClusterClient.Close() and Dispose() is invoked .

  it runs good but when the website restart it become unstable   and then if continue access the 
  website it will become ok because the IClusterClient is still null and  ClientBuilder.Build() is also 
   invoked for init. and then it will OK all the time.

  the env is:   windows 10  IIS 10  donet framework 4.7.2  asp.net mvc 5.2.4.0.

the debugger show that:
FatalExecutionEngineError  error address is 0x0df3063f，at thread 0xbf8 。error code is 0xc0000005。maybe it is a CLR  bug，or unsafe code bug。maybe with COM-interop or PInvoke .

please help.

![error](https://user-images.githubusercontent.com/17829409/43782305-a40558ce-9a91-11e8-9c2b-73e460f6af09.PNG)

![error2](https://user-images.githubusercontent.com/17829409/43782812-bf60bb58-9a92-11e8-8751-99d24f0fe083.PNG)
","Error occurs in clusterbuilder.build  when  iis website restart Hi
  I have a websit using Orleans Client connect to the server.

  I have a static ClusterClient
    and when the website start the ClientBuilder.Build() is invoked and connect to the server.
    and when  the website shut down IClusterClient.Close() and Dispose() is invoked .

  it runs good but when the website restart it become unstable   and then if continue access the 
  website it will become ok because the IClusterClient is still null and  ClientBuilder.Build() is also 
   invoked for init. and then it will OK all the time.

  the env is:   windows 10  IIS 10  donet framework 4.7.2  asp.net mvc 5.2.4.0.

the debugger show that:
FatalExecutionEngineError  error address is 0x0df3063f，at thread 0xbf8 。error code is 0xc0000005。maybe it is a CLR  bug，or unsafe code bug。maybe with COM-interop or PInvoke .

please help.

![error](https://user-images.githubusercontent.com/17829409/43782305-a40558ce-9a91-11e8-9c2b-73e460f6af09.PNG)

![error2](https://user-images.githubusercontent.com/17829409/43782812-bf60bb58-9a92-11e8-8751-99d24f0fe083.PNG)
",,ReubenBond,,
4822,Which code files are maintained for memberships tables and grain directory tables?,"  I'm studying the implementation of Orleans but I've found that I can't find the specific maintenance code for the memberships table and the grain directory table. Including the entry of members normal exit and abnormal exit Grain activation and deactivation and node failure when the table recovery operations.

  Could you tell me which files are the specific implementation codes of these operations?","Which code files are maintained for memberships tables and grain directory tables?   I'm studying the implementation of Orleans but I've found that I can't find the specific maintenance code for the memberships table and the grain directory table. Including the entry of members normal exit and abnormal exit Grain activation and deactivation and node failure when the table recovery operations.

  Could you tell me which files are the specific implementation codes of these operations?",question,sergeybykov,,
4821,GatewayClientReceiver.FillBuffer() being slow and looks like executing in critical section,"Hi Team

While troubleshooting slowness with our cloud service we noticed from the memory dump logs that the GatewayClientReceiver.FillBuffer() is taking time and might be executing in critical section which might also be blocking other threads. However when I look at the code it looks like only initialization logic for senders/receivers is getting executed in critical section. 
some of the stack trace from memory dump where we see that the thread have been stuck for a while:

As it is difficult to find the real cause here we need a confirmation from you that the processing of messages (queuing and fillbuffer) should be executing well within the expected time.
Also should we reduce or increase the sizes of send/receive buffers to fine tune the performance considering that our application works in high load and sends/receives a lot of messages within Orleans cluster.
We are using Orleans 2.0.0 on Azure Cloud Service.","GatewayClientReceiver.FillBuffer() being slow and looks like executing in critical section Hi Team

While troubleshooting slowness with our cloud service we noticed from the memory dump logs that the GatewayClientReceiver.FillBuffer() is taking time and might be executing in critical section which might also be blocking other threads. However when I look at the code it looks like only initialization logic for senders/receivers is getting executed in critical section. 
some of the stack trace from memory dump where we see that the thread have been stuck for a while:

As it is difficult to find the real cause here we need a confirmation from you that the processing of messages (queuing and fillbuffer) should be executing well within the expected time.
Also should we reduce or increase the sizes of send/receive buffers to fine tune the performance considering that our application works in high load and sends/receives a lot of messages within Orleans cluster.
We are using Orleans 2.0.0 on Azure Cloud Service.",,benjaminpetit,,
4820,Separation of Transaction Manager and Transactional Resource,"Separation of Transaction Manager and Transactional Resource
- Remove transaction participant
- Full separation of tm and resource grain extensions.
- Grain references are used everwhere and cast to extensions where needed.

Next step: Add TOC support
","Separation of Transaction Manager and Transactional Resource Separation of Transaction Manager and Transactional Resource
- Remove transaction participant
- Full separation of tm and resource grain extensions.
- Grain references are used everwhere and cast to extensions where needed.

Next step: Add TOC support
",,ReubenBond,,
4819,"Type string ""Orleans.Runtime.RequestInvocationHistory"" cannot be resolved.","When I do the following setting Client will throw an exception..
1.Apply(T action) in D:\Git\orleans\src\Orleans.Core\Threading\ActionFilter.cs:line 86","Type string ""Orleans.Runtime.RequestInvocationHistory"" cannot be resolved. When I do the following setting Client will throw an exception..
1.Apply(T action) in D:\Git\orleans\src\Orleans.Core\Threading\ActionFilter.cs:line 86",,jason-bragg,,
4818,Grain can't be collection normally,"I set up the following：

After the Grain is collection it can be seen through the Dashboardand has not been collection successfully.
I will not be able to activate these Grain again.
But if update SqlEventStorage.cs line 136 use Task.Run will not the problem.
This problem is very easy to happen if you introduce a third party library.

Example:
Startup need the postgresql and rabbitmq.
[Ray.git.zip](https://github.com/dotnet/orleans/files/2260031/Ray.git.zip)
","Grain can't be collection normally I set up the following：

After the Grain is collection it can be seen through the Dashboardand has not been collection successfully.
I will not be able to activate these Grain again.
But if update SqlEventStorage.cs line 136 use Task.Run will not the problem.
This problem is very easy to happen if you introduce a third party library.

Example:
Startup need the postgresql and rabbitmq.
[Ray.git.zip](https://github.com/dotnet/orleans/files/2260031/Ray.git.zip)
",,benjaminpetit,,
4816,[WIP] Add memory threshold,A naive implementation that allows for configurable suppression of grain collection based on memory pressure.,[WIP] Add memory threshold A naive implementation that allows for configurable suppression of grain collection based on memory pressure.,,benjaminpetit,,
4813,Bump code generation version to 2.0.4,,Bump code generation version to 2.0.4 ,,benjaminpetit,,
4812,Build time codegen quite unstable on Orleans 2.x,"Hello folks 

I saw some issues pointing out multiple issues with build time codegen after Orleans 2.x was released.

In fact I've suffering since 2.0 release with multiple different issues with it. Some PR were made attempting to fix but which just failed.

I'm opening this issue in an attempt to bring team's attention to this matter as it is turning build time codegen practically unusable the way it is now.

As discussed with @ReubenBond it looks like the new codegen he is working is going to fix if not all the majority of those current issues but the work is on hold due to other team's priorities. 

It is a major block on multiple projects I'm working with so I would appreciate if Reuben have a bit more of time to dedicate to it. 

Thank you all!","Build time codegen quite unstable on Orleans 2.x Hello folks 

I saw some issues pointing out multiple issues with build time codegen after Orleans 2.x was released.

In fact I've suffering since 2.0 release with multiple different issues with it. Some PR were made attempting to fix but which just failed.

I'm opening this issue in an attempt to bring team's attention to this matter as it is turning build time codegen practically unusable the way it is now.

As discussed with @ReubenBond it looks like the new codegen he is working is going to fix if not all the majority of those current issues but the work is on hold due to other team's priorities. 

It is a major block on multiple projects I'm working with so I would appreciate if Reuben have a bit more of time to dedicate to it. 

Thank you all!",,ReubenBond,,
4811,Errors from SiloHost,"Hello

I have a Silohost & client running on local machine and connects through consul membership. Everything works fine but I was able to find below exceptions. What are these excepions? Do I need to fix something before these code move to higher environments?

{""Timestamp"":""2018-08-01T17:00:58.0013497-05:00""""Level"":""Error""""MessageTemplate"":""Worker pool thread Runtime.Scheduler.WorkerPoolThread/3 (ManagedThreadId=40) has been busy for long time:
 Executing Task Id=97879 Status=Running for 00:00:59.7464953 on WorkItem=WorkItemGroup:Name=[Activation: S10.XXX.XX.XXX:XX:270856538*grn/9B57CB77/00000000+XXXXZ505@01be8caf
 #GrainType=XXXXX.XXXXX.Grains.CommandBus Placement=ActivationCountBasedPlacement]WorkGroupStatus=Running Executing for 00:00:59.7555196. WorkItemGroup Details: 
 WorkItemGroup:Name=[Activation: S10.XX.XX.XX:XX:270856538*grn/9B57CB77/00000000+17543CZ505@01be8caf #GrainType=XXXX.XXXXX.Grains.CommandBus Placement=ActivationCountBasedPlacement]
 WorkGroupStatus=Running. Currently QueuedWorkItems=0; Total EnQueued=2; Total processed=1; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-14:Queued=0; Detailed 
 SchedulingContext=<[Activation: S10.XXX.XX.XXX:XXX:270856538*grn/9B57CB77/0000000000000000000000000000000006ffffff9b57cb77+17543CZ505-0x1E0EA515@01be8caf #GrainType=XXXX.XXXXX.Grains.CommandBus 
 Placement=ActivationCountBasedPlacement State=Valid NonReentrancyQueueSize=0 EnqueuedOnDispatcher=0 InFlightCount=1 NumRunning=1 IdlenessTimeSpan=736906.22:00:58.0003454 
 CollectionAgeLimit=02:00:00 CurrentlyExecuting=NewPlacement Request XXX.XXX.XX.XX:XXX:270856538*cli/a64bf6b3@bf402085->S10.XXX.XX.XXX:XX:270856538*grn/9B57CB77/00000000+17543CZ505@01be8caf 
 #5: ]>.""""Properties"":{""EventId"":{""Id"":101212}""SourceContext"":""Runtime.Scheduler.WorkerPoolThread/3""""Orleans"":""XXXXXX""""EnvironmentUserName"":""XXXXX\\XXXXXX""""MachineName"":""XXXXXXX""
 ""ProcessId"":15836""ProcessName"":""XXXX.XXXXX.Host""""ThreadId"":40}}
 
{""Timestamp"":""2018-08-01T17:00:59.7092269-05:00""""Level"":""Error""""MessageTemplate"":""Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. 
Last fired at 2018-08-01 22:00:42.396 GMT 00:00:17.3124134 since previous fire should have fired after 00:00:10.""""Properties"":{""EventId"":{""Id"":101412}""SourceContext"":
""Orleans.Runtime.GrainTimer""""Orleans"":""SiloHostBuilder""""EnvironmentUserName"":""XXXX\\XXXXX""""MachineName"":""XXXXXX-XXX""""ProcessId"":15836""ProcessName"":""XXXXX.XXXX.Host""""ThreadId"":40}}


{""Timestamp"":""2018-08-01T17:01:03.2601117-05:00""""Level"":""Error""""MessageTemplate"":""Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. 
Last fired at 2018-08-01 21:55:44.998 GMT 00:05:18.2619388 since previous fire should have fired after 00:05:00.""""Properties"":{""EventId"":{""Id"":101412}
""SourceContext"":""Orleans.Runtime.GrainTimer""""Orleans"":""SiloHostBuilder""""EnvironmentUserName"":""XXXX\\XXXXXX""""MachineName"":""XXXXXX-XXX""""ProcessId"":15836""
ProcessName"":""XXXXX.XXXXX.Host""""ThreadId"":40}}
","Errors from SiloHost Hello

I have a Silohost & client running on local machine and connects through consul membership. Everything works fine but I was able to find below exceptions. What are these excepions? Do I need to fix something before these code move to higher environments?

{""Timestamp"":""2018-08-01T17:00:58.0013497-05:00""""Level"":""Error""""MessageTemplate"":""Worker pool thread Runtime.Scheduler.WorkerPoolThread/3 (ManagedThreadId=40) has been busy for long time:
 Executing Task Id=97879 Status=Running for 00:00:59.7464953 on WorkItem=WorkItemGroup:Name=[Activation: S10.XXX.XX.XXX:XX:270856538*grn/9B57CB77/00000000+XXXXZ505@01be8caf
 #GrainType=XXXXX.XXXXX.Grains.CommandBus Placement=ActivationCountBasedPlacement]WorkGroupStatus=Running Executing for 00:00:59.7555196. WorkItemGroup Details: 
 WorkItemGroup:Name=[Activation: S10.XX.XX.XX:XX:270856538*grn/9B57CB77/00000000+17543CZ505@01be8caf #GrainType=XXXX.XXXXX.Grains.CommandBus Placement=ActivationCountBasedPlacement]
 WorkGroupStatus=Running. Currently QueuedWorkItems=0; Total EnQueued=2; Total processed=1; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-14:Queued=0; Detailed 
 SchedulingContext=<[Activation: S10.XXX.XX.XXX:XXX:270856538*grn/9B57CB77/0000000000000000000000000000000006ffffff9b57cb77+17543CZ505-0x1E0EA515@01be8caf #GrainType=XXXX.XXXXX.Grains.CommandBus 
 Placement=ActivationCountBasedPlacement State=Valid NonReentrancyQueueSize=0 EnqueuedOnDispatcher=0 InFlightCount=1 NumRunning=1 IdlenessTimeSpan=736906.22:00:58.0003454 
 CollectionAgeLimit=02:00:00 CurrentlyExecuting=NewPlacement Request XXX.XXX.XX.XX:XXX:270856538*cli/a64bf6b3@bf402085->S10.XXX.XX.XXX:XX:270856538*grn/9B57CB77/00000000+17543CZ505@01be8caf 
 #5: ]>.""""Properties"":{""EventId"":{""Id"":101212}""SourceContext"":""Runtime.Scheduler.WorkerPoolThread/3""""Orleans"":""XXXXXX""""EnvironmentUserName"":""XXXXX\\XXXXXX""""MachineName"":""XXXXXXX""
 ""ProcessId"":15836""ProcessName"":""XXXX.XXXXX.Host""""ThreadId"":40}}
 
{""Timestamp"":""2018-08-01T17:00:59.7092269-05:00""""Level"":""Error""""MessageTemplate"":""Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.ProbeTimer did not fire on time. 
Last fired at 2018-08-01 22:00:42.396 GMT 00:00:17.3124134 since previous fire should have fired after 00:00:10.""""Properties"":{""EventId"":{""Id"":101412}""SourceContext"":
""Orleans.Runtime.GrainTimer""""Orleans"":""SiloHostBuilder""""EnvironmentUserName"":""XXXX\\XXXXX""""MachineName"":""XXXXXX-XXX""""ProcessId"":15836""ProcessName"":""XXXXX.XXXX.Host""""ThreadId"":40}}


{""Timestamp"":""2018-08-01T17:01:03.2601117-05:00""""Level"":""Error""""MessageTemplate"":""Watchdog Freeze Alert: Orleans.Runtime.asynTask.SafeTimerBase.Membership.IAmAliveTimer did not fire on time. 
Last fired at 2018-08-01 21:55:44.998 GMT 00:05:18.2619388 since previous fire should have fired after 00:05:00.""""Properties"":{""EventId"":{""Id"":101412}
""SourceContext"":""Orleans.Runtime.GrainTimer""""Orleans"":""SiloHostBuilder""""EnvironmentUserName"":""XXXX\\XXXXXX""""MachineName"":""XXXXXX-XXX""""ProcessId"":15836""
ProcessName"":""XXXXX.XXXXX.Host""""ThreadId"":40}}
",,jason-bragg,,
4810,Limited separation of transaction orchestration and participation.,"First pass at separating transaction orchestration (transaction manager) from participation (transactional resource).

Goal is to eventually be able to support a variety of transactional resources (state queues event sourcing ...) as well as advanced transactional patterns like Transfer of Commit (TOC).

This PR should have no behavioral changes only code reorganization.
- Added transaction manager and transactional resource interfaces
- Removed partial classes separating logic into a read/write lock and transaction queue transaction manager and transactional resource.

More work needs be done this is just a first pass.","Limited separation of transaction orchestration and participation. First pass at separating transaction orchestration (transaction manager) from participation (transactional resource).

Goal is to eventually be able to support a variety of transactional resources (state queues event sourcing ...) as well as advanced transactional patterns like Transfer of Commit (TOC).

This PR should have no behavioral changes only code reorganization.
- Added transaction manager and transactional resource interfaces
- Removed partial classes separating logic into a read/write lock and transaction queue transaction manager and transactional resource.

More work needs be done this is just a first pass.",,xiazen,,
4809,LightInject integration issue,"I am trying to use [LightInject ](https://github.com/seesharper/LightInject) as IoC container in Orleans Silo and on startup it throws an error 
Full solution that can reproduce the issue can be found here:
https://github.com/n-sidorov/OreansLightInjectIssueRepro","LightInject integration issue I am trying to use [LightInject ](https://github.com/seesharper/LightInject) as IoC container in Orleans Silo and on startup it throws an error 
Full solution that can reproduce the issue can be found here:
https://github.com/n-sidorov/OreansLightInjectIssueRepro",,xiazen,,
4808,Remove the callchain information for the OneWay message,"Recently I've met a deadlock exception caused by a OneWay message. As far as I know the sender of the one-way message will not wailt for the response of the message. This means that even if the callee calls the function on the same grain the message will be added to the next position of messaging queue and will not cause a deadlock. So we should add a check on the line below if it is a OneWay message the call chain information should not be passed to next calls. 

https://github.com/dotnet/orleans/blob/e2b25a695767ae5746ffe47218c1331427997894/src/Orleans.Runtime/Core/InsideRuntimeClient.cs#L292

I don't know if I'm correct. If the thought is correct I will make a pull-request to fix it.","Remove the callchain information for the OneWay message Recently I've met a deadlock exception caused by a OneWay message. As far as I know the sender of the one-way message will not wailt for the response of the message. This means that even if the callee calls the function on the same grain the message will be added to the next position of messaging queue and will not cause a deadlock. So we should add a check on the line below if it is a OneWay message the call chain information should not be passed to next calls. 

https://github.com/dotnet/orleans/blob/e2b25a695767ae5746ffe47218c1331427997894/src/Orleans.Runtime/Core/InsideRuntimeClient.cs#L292

I don't know if I'm correct. If the thought is correct I will make a pull-request to fix it.",,ReubenBond,,
4802,The latest code is often compiled with exceptions,"Asynch agent Runtime.Messaging.IncomingMessageAgent/Application encountered unexpected exception The Stage will be restarted.

Value cannot be null. 

 at System.Threading.Monitor.Exit(Object obj)
   at System.Threading.SemaphoreSlim.Wait(Int32 millisecondsTimeout CancellationToken cancellationToken)
   at System.Collections.Concurrent.BlockingCollection1.Apply(T action)","The latest code is often compiled with exceptions Asynch agent Runtime.Messaging.IncomingMessageAgent/Application encountered unexpected exception The Stage will be restarted.

Value cannot be null. 

 at System.Threading.Monitor.Exit(Object obj)
   at System.Threading.SemaphoreSlim.Wait(Int32 millisecondsTimeout CancellationToken cancellationToken)
   at System.Collections.Concurrent.BlockingCollection1.Apply(T action)",,ReubenBond,,
4801,Orleans StatelessWorker Grain throw System.TypeLoadException,"I create 3 projects:OLTest.ClientOLTest1.SiloOLTest2.Silo. I implemented a StatelessWorker Grain ""Hello2Stateless"" in OLTest2.Silo. Then run a LTest1.Silo instance and 2 OLTest2.Silo instances.Use OLTest.Client to call Hello2Stateless for testing (grainFactory.GetGrain<IHello2Stateless> (Guid.Empty).Say ())It runs well at this time.After that I close Hello2Stateless Grain to activate Silo (one of two instances of OLTest2.Silo) and then use OLTest.Client to call after cluster recovery.
Hello2Stateless will throw ""System.TypeLoadException: Cannot find GrainTypeData for class OLTest2.Grains.Hello2Stateless in OLTest1.Silo instance.At Orleans.Runtime.GrainTypeManager.get_Item (String className) exception."" (I use OrleansDashboard to see that OLTest.Client is connected to the LTest1.Silo instance if one of the instances in which OLTest.Client is connected to OLTest2.Silo does not appear the cluster is using the Sql Server mode).","Orleans StatelessWorker Grain throw System.TypeLoadException I create 3 projects:OLTest.ClientOLTest1.SiloOLTest2.Silo. I implemented a StatelessWorker Grain ""Hello2Stateless"" in OLTest2.Silo. Then run a LTest1.Silo instance and 2 OLTest2.Silo instances.Use OLTest.Client to call Hello2Stateless for testing (grainFactory.GetGrain<IHello2Stateless> (Guid.Empty).Say ())It runs well at this time.After that I close Hello2Stateless Grain to activate Silo (one of two instances of OLTest2.Silo) and then use OLTest.Client to call after cluster recovery.
Hello2Stateless will throw ""System.TypeLoadException: Cannot find GrainTypeData for class OLTest2.Grains.Hello2Stateless in OLTest1.Silo instance.At Orleans.Runtime.GrainTypeManager.get_Item (String className) exception."" (I use OrleansDashboard to see that OLTest.Client is connected to the LTest1.Silo instance if one of the instances in which OLTest.Client is connected to OLTest2.Silo does not appear the cluster is using the Sql Server mode).",,ReubenBond,,
4800,OrleansAzureUtils 2.0.4 no longer depends on Streaming.AzureStorage,"I updated our project's dependencies to the 2.0.4 bits on NuGet and encountered the following build error:

> The type or namespace name 'AzureQueue' does not exist in the namespace 'Orleans.Providers.Streams' (are you missing an assembly reference?)

After some quick digging I found that the  package:

https://www.nuget.org/packages/Microsoft.Orleans.OrleansAzureUtils/2.0.0
https://www.nuget.org/packages/Microsoft.Orleans.OrleansAzureUtils/2.0.4

Is this expected and should it be documented in the release notes on GitHub?","OrleansAzureUtils 2.0.4 no longer depends on Streaming.AzureStorage I updated our project's dependencies to the 2.0.4 bits on NuGet and encountered the following build error:

> The type or namespace name 'AzureQueue' does not exist in the namespace 'Orleans.Providers.Streams' (are you missing an assembly reference?)

After some quick digging I found that the  package:

https://www.nuget.org/packages/Microsoft.Orleans.OrleansAzureUtils/2.0.0
https://www.nuget.org/packages/Microsoft.Orleans.OrleansAzureUtils/2.0.4

Is this expected and should it be documented in the release notes on GitHub?",P3,ReubenBond,27/07/2018 9:08,12/09/2018 6:48
4798,Getting a lot of errors from azure queue stream provider,"We're trying to move from simple message stream to azure queue streams.
Getting a lot of these errors:


all of these are for the same queue: queue felix-azurequeuestreamprovider-4 
when looking at that queue in azure storage explorer that was the only one that was full.
I deleted that queue and i think that stopped it.

any ideas?","Getting a lot of errors from azure queue stream provider We're trying to move from simple message stream to azure queue streams.
Getting a lot of these errors:


all of these are for the same queue: queue felix-azurequeuestreamprovider-4 
when looking at that queue in azure storage explorer that was the only one that was full.
I deleted that queue and i think that stopped it.

any ideas?",,jason-bragg,,
4796,Verify exception handling logic when multiple particiant throw,Verify exception handling logic when multiple particiant throw. The expected logic is only one exception is picked as the inner exception of OrleansTransactionAbortException,Verify exception handling logic when multiple particiant throw Verify exception handling logic when multiple particiant throw. The expected logic is only one exception is picked as the inner exception of OrleansTransactionAbortException,,jason-bragg,,
4795,"Named type ""Domain.Model"" is invalid: Type string ""Domain.Model"" cannot be resolved","Hi

I have this strange exception happening. It happens randomly about 50% of the time kind of sending goes fine then sending again triggers exception and so on. I found similar [issues](https://github.com/dotnet/orleans/issues/1536) from 2016. Some of the issues in the context of generic types. However the type I'm using is a plain C# (POCO) type.

Here is my scenario.

I want to share some of my data types (models) between solutions so I create a NuGet package that I install wherever I need the model. I do the same with interfaces (e.g. different solutions implements client to the same grain in some silo).

I've read the documentation [Serialization and Writing Custom Serializers](http://dotnet.github.io/orleans/Documentation/Advanced-Concepts/Serialization.html) about serialization but I can not see what I'm doing wrong. I do use ""DataContract"" attribute and also the ""Serializable"" attribute (as the document instruct me to use the ""Serializable"" attribute on types).

It is not clear from the documentation how I use other serializers (I see that it's possible to use other serializers instead of the one out-of-the-box - as long as all other parts of the environment uses the same serializer).

But now I've run out of ideas.

Here is the model that fails to be serialized (about 50% of the time):

 can't handle .NET Core version 2.1 (yet) all my solutions are locked to .NET Core version 2.0 (2.0.2). I'm using Orleans v2.0.3 and v2.0 throughout my (.NET Core) solutions.

I'd be happy to have some thoughts on why such a ""simple"" scenario fails. If it was consistent like failing all the time then I'd go with what the exception tells me that the type can not be resolved (not found) and work with it. But it is this scenario of the serializer failing on and off that I think is strange.

Thanks
Jan","Named type ""Domain.Model"" is invalid: Type string ""Domain.Model"" cannot be resolved Hi

I have this strange exception happening. It happens randomly about 50% of the time kind of sending goes fine then sending again triggers exception and so on. I found similar [issues](https://github.com/dotnet/orleans/issues/1536) from 2016. Some of the issues in the context of generic types. However the type I'm using is a plain C# (POCO) type.

Here is my scenario.

I want to share some of my data types (models) between solutions so I create a NuGet package that I install wherever I need the model. I do the same with interfaces (e.g. different solutions implements client to the same grain in some silo).

I've read the documentation [Serialization and Writing Custom Serializers](http://dotnet.github.io/orleans/Documentation/Advanced-Concepts/Serialization.html) about serialization but I can not see what I'm doing wrong. I do use ""DataContract"" attribute and also the ""Serializable"" attribute (as the document instruct me to use the ""Serializable"" attribute on types).

It is not clear from the documentation how I use other serializers (I see that it's possible to use other serializers instead of the one out-of-the-box - as long as all other parts of the environment uses the same serializer).

But now I've run out of ideas.

Here is the model that fails to be serialized (about 50% of the time):

 can't handle .NET Core version 2.1 (yet) all my solutions are locked to .NET Core version 2.0 (2.0.2). I'm using Orleans v2.0.3 and v2.0 throughout my (.NET Core) solutions.

I'd be happy to have some thoughts on why such a ""simple"" scenario fails. If it was consistent like failing all the time then I'd go with what the exception tells me that the type can not be resolved (not found) and work with it. But it is this scenario of the serializer failing on and off that I think is strange.

Thanks
Jan",,ReubenBond,,
4794,(v1.5.1) GC issue and the silo occurring Out Of Memory,"Affter occurring  following warnings for a few minutes， this silo occurring Out Of Memory issue and crash. 
The version of Orleans is 1.5.1. 

My GC configure is :

","(v1.5.1) GC issue and the silo occurring Out Of Memory Affter occurring  following warnings for a few minutes， this silo occurring Out Of Memory issue and crash. 
The version of Orleans is 1.5.1. 

My GC configure is :

",,xiazen,,
4793,Serialization errors on exceptions thrown from grain methods cause client timeouts,"Take grain interface:



If for whatever reason DoSomething() encounters an unhandled exception that reaches the runtime and the runtime cannot serialize it back to the client the runtime sends nothing back to the client causing an eventual client timeout.

The expected behavior is the client would receive some generic serialization failed exception.  Without this these types of issues are very difficult to debug.","Serialization errors on exceptions thrown from grain methods cause client timeouts Take grain interface:



If for whatever reason DoSomething() encounters an unhandled exception that reaches the runtime and the runtime cannot serialize it back to the client the runtime sends nothing back to the client causing an eventual client timeout.

The expected behavior is the client would receive some generic serialization failed exception.  Without this these types of issues are very difficult to debug.",P2,ReubenBond,,
4792,ISiloHost.Stopped not resolved when silo kill himself,"When a silo decide to kill himself because it sees its membership entry as ""Dead"" it will try to shutdown quickly by himelf. 

The issue is that the Task in  is not resolved so if the user relies on this task to quit the program the program will not quit even if the silo is not doing anything relevant anymore.
","ISiloHost.Stopped not resolved when silo kill himself When a silo decide to kill himself because it sees its membership entry as ""Dead"" it will try to shutdown quickly by himelf. 

The issue is that the Task in  is not resolved so if the user relies on this task to quit the program the program will not quit even if the silo is not doing anything relevant anymore.
",,benjaminpetit,,
4790,Request help No client request The  system auto Downtime,"No concurrency no call to Grain born unexplained problem.
After this error Client cannot connect to Orleans silo

Use .Net Core  V2.1.2
Use Orleans V2.0.4 


@ReubenBond Please help me see
This is all the logs that have an exception.
[Exception log.txt](https://github.com/dotnet/orleans/files/2238467/Exception.log.txt)
","Request help, No client request, The  system auto Downtime No concurrency no call to Grain born unexplained problem.
After this error Client cannot connect to Orleans silo

Use .Net Core  V2.1.2
Use Orleans V2.0.4 


@ReubenBond Please help me see
This is all the logs that have an exception.
[Exception log.txt](https://github.com/dotnet/orleans/files/2238467/Exception.log.txt)
",,ReubenBond,,
4789,Gossip Channel Implementations,"
If we do not specify a Gossip channel then what would be the default gossip channel?","Gossip Channel Implementations 
If we do not specify a Gossip channel then what would be the default gossip channel?",,benjaminpetit,,
4785,"""Developing a Grain"" doc","1. 2.0 (.Net Standard based right?) doc says to create a class project targeting .Net 4.6.1 - this is confusing
1. It says to install the nuget pkg  etc)
~~~
PlayerGrain.cs(10371054): error CS0246: The type or namespace name 'IGrainWithGuidKey' could not be found (are you missing a using directive or an assembly reference?)
PlayerGrain.cs(18321837): error CS0246: The type or namespace name 'Grain' could not be found (are you missing a using directive or an assembly reference?)
PlayerGrain.cs(12141224): error CS0246: The type or namespace name 'IGameGrain' could not be found (are you missing a using directive or an assembly reference?)
~~~","""Developing a Grain"" doc 1. 2.0 (.Net Standard based right?) doc says to create a class project targeting .Net 4.6.1 - this is confusing
1. It says to install the nuget pkg  etc)
~~~
PlayerGrain.cs(10371054): error CS0246: The type or namespace name 'IGrainWithGuidKey' could not be found (are you missing a using directive or an assembly reference?)
PlayerGrain.cs(18321837): error CS0246: The type or namespace name 'Grain' could not be found (are you missing a using directive or an assembly reference?)
PlayerGrain.cs(12141224): error CS0246: The type or namespace name 'IGameGrain' could not be found (are you missing a using directive or an assembly reference?)
~~~",P1,JillHeaden,,
4781,More Transaction Metrics,Added more transaction metrics and benchmark tests for transaction throttling.,More Transaction Metrics Added more transaction metrics and benchmark tests for transaction throttling.,,xiazen,,
4779,Allow the Grain state to define Partition key and Row key for Table Storage,"While enabling the state to persist in the storage we should have a mechanism to override the Partition Key /Row key so that data can be stored and retrieved effectively.
","Allow the Grain state to define Partition key and Row key for Table Storage While enabling the state to persist in the storage we should have a mechanism to override the Partition Key /Row key so that data can be stored and retrieved effectively.
",P3,jason-bragg,18/07/2018 22:04,
4778,Tuning Orleans table liveness for maximum availability,"Looking at this:
http://dotnet.github.io/orleans/Documentation/Runtime-Implementation-Details/Cluster-Management.html#configuration

It looks like the defaults for some liveness configurations are really high Like:

We have a realtime system where 10 seconds of not knowing a silo is dead and getting errors is not something we can live with.

How would you recommend configuring liveness for MAXIMUM availability?
Would appreciate specific suggestions for values adding the keys here for convenience:

* ProbeTimeout - The number of seconds to probe other silos for their liveness or for the silo to send ""I am alive"" heartbeat messages about itself. Default is 10 seconds.

* TableRefreshTimeout - The number of seconds to fetch updates from the membership table. Default is 60 seconds.

* DeathVoteExpirationTimeout - Expiration time in seconds for death vote in the membership table. Default is 120 seconds

* NumMissedProbesLimit - The number of missed ""I am alive"" heartbeat messages from a silo or number of un-replied probes that lead to suspecting this silo as dead. Default is 3.

* NumProbedSilos - The number of silos each silo probes for liveness. Default is 3.

* NumVotesForDeathDeclaration - The number of non-expired votes that are needed to declare some silo as dead (should be at most NumMissedProbesLimit). Default is 2.

* UseLivenessGossip - Whether to use the gossip optimization to speed up spreading liveness information. Default is true.

* IAmAliveTablePublishTimeout - The number of seconds to periodically write in the membership table that this silo is alive. Used only for diagnostics. Default is 5 minutes.

* NumMissedTableIAmAliveLimit - The number of missed ""I am alive"" updates in the table from a silo that causes warning to be logged. Does not impact the liveness protocol. Default is 2.

* MaxJoinAttemptTime - The number of seconds to attempt to join a cluster of silos before giving up. Default is 5 minutes.

* ExpectedClusterSize - The expected size of a cluster. Need not be very accurate can be an overestimate. Used to tune the exponential backoff algorithm of retries to write to Azure table. Default is 20.","Tuning Orleans table liveness for maximum availability Looking at this:
http://dotnet.github.io/orleans/Documentation/Runtime-Implementation-Details/Cluster-Management.html#configuration

It looks like the defaults for some liveness configurations are really high Like:

We have a realtime system where 10 seconds of not knowing a silo is dead and getting errors is not something we can live with.

How would you recommend configuring liveness for MAXIMUM availability?
Would appreciate specific suggestions for values adding the keys here for convenience:

* ProbeTimeout - The number of seconds to probe other silos for their liveness or for the silo to send ""I am alive"" heartbeat messages about itself. Default is 10 seconds.

* TableRefreshTimeout - The number of seconds to fetch updates from the membership table. Default is 60 seconds.

* DeathVoteExpirationTimeout - Expiration time in seconds for death vote in the membership table. Default is 120 seconds

* NumMissedProbesLimit - The number of missed ""I am alive"" heartbeat messages from a silo or number of un-replied probes that lead to suspecting this silo as dead. Default is 3.

* NumProbedSilos - The number of silos each silo probes for liveness. Default is 3.

* NumVotesForDeathDeclaration - The number of non-expired votes that are needed to declare some silo as dead (should be at most NumMissedProbesLimit). Default is 2.

* UseLivenessGossip - Whether to use the gossip optimization to speed up spreading liveness information. Default is true.

* IAmAliveTablePublishTimeout - The number of seconds to periodically write in the membership table that this silo is alive. Used only for diagnostics. Default is 5 minutes.

* NumMissedTableIAmAliveLimit - The number of missed ""I am alive"" updates in the table from a silo that causes warning to be logged. Does not impact the liveness protocol. Default is 2.

* MaxJoinAttemptTime - The number of seconds to attempt to join a cluster of silos before giving up. Default is 5 minutes.

* ExpectedClusterSize - The expected size of a cluster. Need not be very accurate can be an overestimate. Used to tune the exponential backoff algorithm of retries to write to Azure table. Default is 20.",,xiazen,,
4777,Service fabric clustering graceful shutdown,"Hey We are currently using service fabric clustering in orleans 1.5.3.
We're experiencing a lot of noise (errors slow execution) while doing a rolling upgrade. 
From what i've read here:
https://github.com/dotnet/orleans/blob/a2ad7e375af89f7920c3c6f272b972d5f3710774/src/OrleansServiceFabricUtils/OrleansCommunicationListener.cs#L120
it looks like this is an ungraceful shutdown which could cause this am i right?
I tried to change CloseAsync to do shutDownOrleansSilo instead of stop had no effect at all.

My assumption is that graceful shutdown does not work with service fabric clustering only with table membership clustering (the silo marks itself as shutting down finish requests and dont take any more work).
Is this  true?","Service fabric clustering graceful shutdown Hey We are currently using service fabric clustering in orleans 1.5.3.
We're experiencing a lot of noise (errors slow execution) while doing a rolling upgrade. 
From what i've read here:
https://github.com/dotnet/orleans/blob/a2ad7e375af89f7920c3c6f272b972d5f3710774/src/OrleansServiceFabricUtils/OrleansCommunicationListener.cs#L120
it looks like this is an ungraceful shutdown which could cause this am i right?
I tried to change CloseAsync to do shutDownOrleansSilo instead of stop had no effect at all.

My assumption is that graceful shutdown does not work with service fabric clustering only with table membership clustering (the silo marks itself as shutting down finish requests and dont take any more work).
Is this  true?",,ReubenBond,,
4774,Race condition with interleaved messages using TCS,"We're extensively using the async batcher pattern described by @hataytuna in this book
https://github.com/hataytuna/Distributed/raw/master/Applied%20Actor%20Model%20with%20Orleans%20v1.1.pdf It is crucial to performance boosts we got from batching in our system.

We figured out that problem we're experiencing with graceful shutdown described in #4757 is due to Orleans not being able to deactivate some of the grains. This only happens when TaskCompletionSource is used (along with the buffering and timer-based completion).

I have a failing test (#4773) for this scenario you can pull and check. On the surface it looks like after DeactivateOnIdle is called Orleans disposes the timer while there interleaved requests which leaves tasks in the uncompleted state thus preventing Orleans from deactivating the grain.

Please advice what can be done wrt to this issue.","Race condition with interleaved messages using TCS We're extensively using the async batcher pattern described by @hataytuna in this book
https://github.com/hataytuna/Distributed/raw/master/Applied%20Actor%20Model%20with%20Orleans%20v1.1.pdf It is crucial to performance boosts we got from batching in our system.

We figured out that problem we're experiencing with graceful shutdown described in #4757 is due to Orleans not being able to deactivate some of the grains. This only happens when TaskCompletionSource is used (along with the buffering and timer-based completion).

I have a failing test (#4773) for this scenario you can pull and check. On the surface it looks like after DeactivateOnIdle is called Orleans disposes the timer while there interleaved requests which leaves tasks in the uncompleted state thus preventing Orleans from deactivating the grain.

Please advice what can be done wrt to this issue.",,benjaminpetit,,
4772,RollingUpdate fails on GetAllSubscriptions(),"Version: method 

**Current workaround:**
Restart each node in our cluster and then errors dissapear","RollingUpdate fails on GetAllSubscriptions() Version: method 

**Current workaround:**
Restart each node in our cluster and then errors dissapear",,ReubenBond,,
4771,"Documentation issues (""ADO.NET Persistence Rationale"")",Please revise [this piece](https://github.com/dotnet/orleans/blob/gh-pages/src/Documentation/Core-Features/Grain-Persistence.md/#adonet-persistence-rationale-) as it is full of typos and hard to understand. ,"Documentation issues (""ADO.NET Persistence Rationale"") Please revise [this piece](https://github.com/dotnet/orleans/blob/gh-pages/src/Documentation/Core-Features/Grain-Persistence.md/#adonet-persistence-rationale-) as it is full of typos and hard to understand. ",P3,JillHeaden,,
4769,Azure App Service (Web App) cannot connect to Orleans Cloud Service silo,"Hello
I am sorry for bothering you with something that looks like an Azure VNET configuration issue but it seems you've done this a lot of times and you could point me to the right direction.  
I posted this originally on: https://stackoverflow.com/questions/51252380/azure-app-service-doesnt-see-worker-roles-in-vnet (and I set a bounty ;)). Copied here for ease of reading:  
I need to configure an Orleans cluster to connect to an Azure App Service. The issue is that networking is my weakest point ;).
I have configured an Orleans Silo using Azure Worker Role (4 instances) listening to the default ports: 

    .ConfigureEndpoints(siloPort: 11111 gatewayPort: 30000)

I've assigned the Worker Role to an Azure VNET (Classic) with these settings:  
Address Range 10.0.0.0/24  
Subnet-1 10.0.0.0/27 (the Worker Role is Assigned here as part of a network security group)  
Point to Site range 10.0.**1**.0/24  
GatewaySubnet 10.0.0.32/29 (added to the same network security group)

I see that the 4 deployed instances take proper IPs in the Subnet-1: 10.0.0.4 to 10.0.0.7.
The App Service is assigned to this VPN (""Certificates in sync"") and reports:  
IP ADDRESSES ROUTED TO VNET   
10.0.0.0 - 10.255.255.255  
172.16.0.0 - 172.31.255.255  
192.168.0.0 - 192.168.255.255  

I see that the app service tries to connect to 10.0.0.7:30000
**I tested both by checking application logs when it starts up and tries to connect to the Orleans Silo and by using tcpping that 10.0.0.7:30000 is not accessible by the application.** (Unable to connect to gateway at address gwy.tcp://10.0.0.7:30000/268857231 […] AccessDenied)    
I am definitely missing something elementary here! 
","Azure App Service (Web App) cannot connect to Orleans Cloud Service silo Hello
I am sorry for bothering you with something that looks like an Azure VNET configuration issue but it seems you've done this a lot of times and you could point me to the right direction.  
I posted this originally on: https://stackoverflow.com/questions/51252380/azure-app-service-doesnt-see-worker-roles-in-vnet (and I set a bounty ;)). Copied here for ease of reading:  
I need to configure an Orleans cluster to connect to an Azure App Service. The issue is that networking is my weakest point ;).
I have configured an Orleans Silo using Azure Worker Role (4 instances) listening to the default ports: 

    .ConfigureEndpoints(siloPort: 11111 gatewayPort: 30000)

I've assigned the Worker Role to an Azure VNET (Classic) with these settings:  
Address Range 10.0.0.0/24  
Subnet-1 10.0.0.0/27 (the Worker Role is Assigned here as part of a network security group)  
Point to Site range 10.0.**1**.0/24  
GatewaySubnet 10.0.0.32/29 (added to the same network security group)

I see that the 4 deployed instances take proper IPs in the Subnet-1: 10.0.0.4 to 10.0.0.7.
The App Service is assigned to this VPN (""Certificates in sync"") and reports:  
IP ADDRESSES ROUTED TO VNET   
10.0.0.0 - 10.255.255.255  
172.16.0.0 - 172.31.255.255  
192.168.0.0 - 192.168.255.255  

I see that the app service tries to connect to 10.0.0.7:30000
**I tested both by checking application logs when it starts up and tries to connect to the Orleans Silo and by using tcpping that 10.0.0.7:30000 is not accessible by the application.** (Unable to connect to gateway at address gwy.tcp://10.0.0.7:30000/268857231 […] AccessDenied)    
I am definitely missing something elementary here! 
",,benjaminpetit,,
4768,Transaction participant wrapper json serialization fix,Transaction wrapper was not serializing the participant when using json.,Transaction participant wrapper json serialization fix Transaction wrapper was not serializing the participant when using json.,,xiazen,,
4767,Cleanup connect retry loop in hello world sample,,Cleanup connect retry loop in hello world sample ,,ReubenBond,,
4765,Clean up BatchWorker,No functional change just a minor cleanup and minor reduction of API surface,Clean up BatchWorker No functional change just a minor cleanup and minor reduction of API surface,,jason-bragg,,
4763,Added grain storage to benchmarks,"Added a grain storage benchmark to help track down #4612.

Unfortunately not able to repro the issue (yet).
","Added grain storage to benchmarks Added a grain storage benchmark to help track down #4612.

Unfortunately not able to repro the issue (yet).
",,xiazen,,
4762,Make azure queue name configurable,"-make azure queue name prefix configuration through 

-if not set then default to its original value  which is serviceId-providerName

For issue #4577 ","Make azure queue name configurable -make azure queue name prefix configuration through 

-if not set then default to its original value  which is serviceId-providerName

For issue #4577 ",,jason-bragg,,
4761,Moved request invocation history to core.,"Moved request invocation history to orleans core so it's available on the client.
Should address #4706","Moved request invocation history to core. Moved request invocation history to orleans core so it's available on the client.
Should address #4706",bug,ReubenBond,,
4760,Intermittent test failure ValidateGeneratedStreamsTest,"
UnitTests.StreamingTests.StreamGeneratorProviderTests.ValidateGeneratedStreamsTest

Assert.Equal() Failure\r\nExpected: 100\r\nActual: 101
+++++++++++++++++++
STACK TRACE:
at UnitTests.StreamingTests.StreamGeneratorProviderTests.<CheckCounters>d__6.MoveNext() in D:\j\workspace\bvt_prtest3cca9be5\test\Tester\StreamingTests\StreamGeneratorProviderTests.cs:line 77 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\j\workspace\bvt_prtest3cca9be5\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 93 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\j\workspace\bvt_prtest3cca9be5\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 106 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at UnitTests.StreamingTests.StreamGeneratorProviderTests.<ValidateGeneratedStreamsTest>d__5.MoveNext() in D:\j\workspace\bvt_prtest3cca9be5\test\Tester\StreamingTests\StreamGeneratorProviderTests.cs:line 65 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","Intermittent test failure ValidateGeneratedStreamsTest 
UnitTests.StreamingTests.StreamGeneratorProviderTests.ValidateGeneratedStreamsTest

Assert.Equal() Failure\r\nExpected: 100\r\nActual: 101
+++++++++++++++++++
STACK TRACE:
at UnitTests.StreamingTests.StreamGeneratorProviderTests.<CheckCounters>d__6.MoveNext() in D:\j\workspace\bvt_prtest3cca9be5\test\Tester\StreamingTests\StreamGeneratorProviderTests.cs:line 77 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\j\workspace\bvt_prtest3cca9be5\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 93 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\j\workspace\bvt_prtest3cca9be5\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 106 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at UnitTests.StreamingTests.StreamGeneratorProviderTests.<ValidateGeneratedStreamsTest>d__5.MoveNext() in D:\j\workspace\bvt_prtest3cca9be5\test\Tester\StreamingTests\StreamGeneratorProviderTests.cs:line 65 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,jason-bragg,12/07/2018 4:22,
4759,New Sample to go with new Tutorial,#NAME?,New Sample to go with new Tutorial @jason-bragg ,documentation,jason-bragg,,
4758,Event hub stream provider questions,"Hi All

I have some questions regarding streaming in Orleans in general and specifically streaming using Event Hub Stream Provider.
I’ll briefly describe my scenario: I have a worker role (non-Orleans) that gets messages from an event hub. Each message belongs to some provider (there can be thousands of providers). The worker role then sends the message to a grain for this specific provider using streaming (there’s a separate stream for each provider grain). The processing of each message by the grain may take some time and that’s why I want to send the message over a persistent queue to decouple the sending from the handling of the message (unlike SMS provider). 
In addition there’s an accumulation of data in the grain itself and it in its turn sends the accumulated data to another service. That’s why I want the stream to be rewindable – if the silo crushed before the grain had sent the data batch I want to process the messages from the begging of the batch.
That’s why the event hub stream provider seems like the correct choice and that’s how I was thinking of using it:
When the first message of the batch arrives to the grain I will save its token in the (persisted) state of the grain. When the batch is sent I’ll update the token to the last message received and use a flag to indicate that I want to get messages with a newer token (the first message of the next batch). In this way if the silo crushes before I’ve sent the batch the grain will start processing messages from the last token saved.
1.	Can I consider event hub stream provider as ready for production systems? I don’t see any documentation for it but I see it’s been released long time ago and it’s been used by 343 industries.
2.	How many different streams does the event hub stream provider support? In the documentation states that “By default Orleans Streaming is targeted to support a large number of relatively small streams”. So it’s seems ok but I wanted to be sure.
3.	When I played with the event hub stream provider I tried to pass null to the StreamSequenceToken parameter on ResumeAsync expecting it to provider new events. But every time I started the Silo I got all the events that I previously sent. I have a workaround for this that I mentioned above but I’m wondering what the reason for this behavior is. 

Thanks!
Gal
","Event hub stream provider questions Hi All

I have some questions regarding streaming in Orleans in general and specifically streaming using Event Hub Stream Provider.
I’ll briefly describe my scenario: I have a worker role (non-Orleans) that gets messages from an event hub. Each message belongs to some provider (there can be thousands of providers). The worker role then sends the message to a grain for this specific provider using streaming (there’s a separate stream for each provider grain). The processing of each message by the grain may take some time and that’s why I want to send the message over a persistent queue to decouple the sending from the handling of the message (unlike SMS provider). 
In addition there’s an accumulation of data in the grain itself and it in its turn sends the accumulated data to another service. That’s why I want the stream to be rewindable – if the silo crushed before the grain had sent the data batch I want to process the messages from the begging of the batch.
That’s why the event hub stream provider seems like the correct choice and that’s how I was thinking of using it:
When the first message of the batch arrives to the grain I will save its token in the (persisted) state of the grain. When the batch is sent I’ll update the token to the last message received and use a flag to indicate that I want to get messages with a newer token (the first message of the next batch). In this way if the silo crushes before I’ve sent the batch the grain will start processing messages from the last token saved.
1.	Can I consider event hub stream provider as ready for production systems? I don’t see any documentation for it but I see it’s been released long time ago and it’s been used by 343 industries.
2.	How many different streams does the event hub stream provider support? In the documentation states that “By default Orleans Streaming is targeted to support a large number of relatively small streams”. So it’s seems ok but I wanted to be sure.
3.	When I played with the event hub stream provider I tried to pass null to the StreamSequenceToken parameter on ResumeAsync expecting it to provider new events. But every time I started the Silo I got all the events that I previously sent. I have a workaround for this that I mentioned above but I’m wondering what the reason for this behavior is. 

Thanks!
Gal
",documentation,jason-bragg,,
4757,Incorrect silo shutdown behavior,"We're experiencing serious problems with a rolling update after migration to 2.0. Let me explain our architecture: we have a single heterogenous Azure queue processed by multiple workers (Competing Consumers pattern). Each message in this queue may be destined to a differrent actor. The setup is quite similar to how built-in Azure Queue Streaming Provider works. See diagram below.

![2018-07-11 12_06_43-untitled diagram xml - draw io](https://user-images.githubusercontent.com/107726/42562033-5785be38-8503-11e8-9e9e-055862a2d9c4.png)

Each node runs pulling agent (queue poller)  and the corresponding TPL DataFlow pipeline outside of the silo but within the same process with the silo (ie embedded). It could happen that recipent actor may reside on a different silo and so the client may forward the message to another silo which is normal of course. Also there number of other actors that may exchange messages across silos also normal of course since that's the whole point of having Orleans.

The problem arises when we try to shutdown the silo during rolling update. My expectation of Orleans' silo shutdown behavior when  raised by sibling nodes during each restart - I belive it's a topic of its own (perhaps retries could be advised as the solution).","Incorrect silo shutdown behavior We're experiencing serious problems with a rolling update after migration to 2.0. Let me explain our architecture: we have a single heterogenous Azure queue processed by multiple workers (Competing Consumers pattern). Each message in this queue may be destined to a differrent actor. The setup is quite similar to how built-in Azure Queue Streaming Provider works. See diagram below.

![2018-07-11 12_06_43-untitled diagram xml - draw io](https://user-images.githubusercontent.com/107726/42562033-5785be38-8503-11e8-9e9e-055862a2d9c4.png)

Each node runs pulling agent (queue poller)  and the corresponding TPL DataFlow pipeline outside of the silo but within the same process with the silo (ie embedded). It could happen that recipent actor may reside on a different silo and so the client may forward the message to another silo which is normal of course. Also there number of other actors that may exchange messages across silos also normal of course since that's the whole point of having Orleans.

The problem arises when we try to shutdown the silo during rolling update. My expectation of Orleans' silo shutdown behavior when  raised by sibling nodes during each restart - I belive it's a topic of its own (perhaps retries could be advised as the solution).",bug,benjaminpetit,,
4756,Upgrade to Microsoft.AzureEventHubs 2.x,,Upgrade to Microsoft.AzureEventHubs 2.x ,P2,xiazen,,
4755,DeadlockDetectionWithoutAllowCallChainReentrancyTests,"Added deadlock detection testing when allow call chain reenterancy is turned off.


Testing added to help track down PerformDeadlockDetection not working in 2.0 #4706 
","DeadlockDetectionWithoutAllowCallChainReentrancyTests Added deadlock detection testing when allow call chain reenterancy is turned off.


Testing added to help track down PerformDeadlockDetection not working in 2.0 #4706 
",testing,ReubenBond,,
4753,[WIP] Support configuration of messaging options via MessagingOptions,Fixes #4751,[WIP] Support configuration of messaging options via MessagingOptions Fixes #4751,,jason-bragg,,
4751,Response timeout is not respected,"We're using 2.0.3 and despite configured 10s timeout for both client (embedded in the same process) and silo we sometimes see 30 second TimeoutException in logs:



This usually happens after ungraceful shutdown of the silo ...","Response timeout is not respected We're using 2.0.3 and despite configured 10s timeout for both client (embedded in the same process) and silo we sometimes see 30 second TimeoutException in logs:



This usually happens after ungraceful shutdown of the silo ...",P3,ReubenBond,,
4750,Update Server-Configuration.md,,Update Server-Configuration.md ,documentation,jason-bragg,,
4748,Exception thrown during OnActivateAsync not posted to client?,I try this: a grain implemented Grain(T) while the entity T can not be found in storage during OnActivateAsync a EntityNotFoundException will be thrown. And the exception will not be posted to the client. How can I handle this error?,Exception thrown during OnActivateAsync not posted to client? I try this: a grain implemented Grain(T) while the entity T can not be found in storage during OnActivateAsync a EntityNotFoundException will be thrown. And the exception will not be posted to the client. How can I handle this error?,,ReubenBond,,
4747,Small spelling fix in Heterogeneous-Silos.md,some very small spelling fixes,Small spelling fix in Heterogeneous-Silos.md some very small spelling fixes,documentation,jason-bragg,6/07/2018 22:35,13/07/2018 5:44
4746,Update Configuring-AdoNet-Providers.md,,Update Configuring-AdoNet-Providers.md ,documentation,jason-bragg,,
4744,Support adding cluster clients to an app's IServiceCollection,"Since most modern frontends user either ASP.NET (Mvc or WebApi) and with the new generic Host that was shipped in Microsoft.Extensions.Hosting 2.1 we can expect most Orleans clients will be using the  if it was registered as default.
The factory can also act as a hosted service (if using the generic Host) to gracefully shutdown all the clients when the host is shutting down.

For reasons why I don't advocate sharing the container 1 is obvious: it would make the assumption that a client library must be configured in the same way as the app host and it wouldn't even support multiple clients. For others there's [this longer chat thread](https://gitter.im/dotnet/orleans?at=5b3e746370efc60660b06f0f) with @galvesribeiro","Support adding cluster clients to an app's IServiceCollection Since most modern frontends user either ASP.NET (Mvc or WebApi) and with the new generic Host that was shipped in Microsoft.Extensions.Hosting 2.1 we can expect most Orleans clients will be using the  if it was registered as default.
The factory can also act as a hosted service (if using the generic Host) to gracefully shutdown all the clients when the host is shutting down.

For reasons why I don't advocate sharing the container 1 is obvious: it would make the assumption that a client library must be configured in the same way as the app host and it wouldn't even support multiple clients. For others there's [this longer chat thread](https://gitter.im/dotnet/orleans?at=5b3e746370efc60660b06f0f) with @galvesribeiro",P2,jason-bragg,,
4743,Update Grain-Persistence.md - fix typo,Fix typo,Update Grain-Persistence.md - fix typo Fix typo,documentation,JillHeaden,,
4742,how to build microsoft orleans source code,run Build.cmd then error msb3802 task failed because csc.dll not found.  i used vs2017 last version. ,how to build microsoft orleans source code run Build.cmd then error msb3802 task failed because csc.dll not found.  i used vs2017 last version. ,question,ReubenBond,,
4739,Transaction attribution test,Added test cases to ensure transaction attribute options (NotSupported Required RequiredNew) properly maintain transaction context.,Transaction attribution test Added test cases to ensure transaction attribute options (NotSupported Required RequiredNew) properly maintain transaction context.,bug,xiazen,,
4736,Workaround for CoreFx/#30781 (Fixes #4505),"Fixes #4505 

This implements a workaround for some divergent behavior between .NET Core and .NET Framework tracked by https://github.com/dotnet/corefx/issues/30781

Note that this is intended for a 2.0.4 release.","Workaround for CoreFx/#30781 (Fixes #4505) Fixes #4505 

This implements a workaround for some divergent behavior between .NET Core and .NET Framework tracked by https://github.com/dotnet/corefx/issues/30781

Note that this is intended for a 2.0.4 release.",,benjaminpetit,,
4735,Orleans unobserved exception,"With this code: 

","Orleans unobserved exception With this code: 

",,ReubenBond,,
4734,MembershipOracle activating failed,"While testing the ability to recover we manage to put the host into an unrecoverable state.



Please see attachment for repro:
[OrleansRepro.zip](https://github.com/dotnet/orleans/files/2156999/OrleansRepro.zip)


Note that SQL database is required in this sample as the ADO cluster provider is used.

Repro steps:

1. Start first host. Use silo port 11111 and gw port 30000 (or whatever preferred)
2. Start second host. Use silo port 11112 and gw port 30001 (or whatever preferred)
3. Wait till both instances run
4. Kill first host (ungraceful shutdown)
5. Kill second host (ungraceful shutdown)
6. Do step 1

The host is unable to recover and will eventually crash after a 5min timeout.

However doing a graceful shutdown won't put the host into an unrecoverable state.","MembershipOracle activating failed While testing the ability to recover we manage to put the host into an unrecoverable state.



Please see attachment for repro:
[OrleansRepro.zip](https://github.com/dotnet/orleans/files/2156999/OrleansRepro.zip)


Note that SQL database is required in this sample as the ADO cluster provider is used.

Repro steps:

1. Start first host. Use silo port 11111 and gw port 30000 (or whatever preferred)
2. Start second host. Use silo port 11112 and gw port 30001 (or whatever preferred)
3. Wait till both instances run
4. Kill first host (ungraceful shutdown)
5. Kill second host (ungraceful shutdown)
6. Do step 1

The host is unable to recover and will eventually crash after a 5min timeout.

However doing a graceful shutdown won't put the host into an unrecoverable state.",,benjaminpetit,,
4733,404 for Code Samples link on Orleans Streams page in the documentation,"The page at:
[http://dotnet.github.io/orleans/Documentation/Orleans-Streams/index.html](http://dotnet.github.io/orleans/Documentation/Orleans-Streams/index.html)

Contains a link to a sample at:
[https://github.com/dotnet/orleans/blob/master/test/TestGrains/SampleStreamingGrain.cs](https://github.com/dotnet/orleans/blob/master/test/TestGrains/SampleStreamingGrain.cs)

Which is a 404. I no longer find such a file in the repo.
","404 for Code Samples link on Orleans Streams page in the documentation The page at:
[http://dotnet.github.io/orleans/Documentation/Orleans-Streams/index.html](http://dotnet.github.io/orleans/Documentation/Orleans-Streams/index.html)

Contains a link to a sample at:
[https://github.com/dotnet/orleans/blob/master/test/TestGrains/SampleStreamingGrain.cs](https://github.com/dotnet/orleans/blob/master/test/TestGrains/SampleStreamingGrain.cs)

Which is a 404. I no longer find such a file in the repo.
",documentation,JillHeaden,,
4731,Testing the Ignore method - doesn't work if an exception is thrown synchronously.,"I found a situation where the Ignore() method fails to catch exceptions and demonstrated it with the code below.

Method ","Testing the Ignore method - doesn't work if an exception is thrown synchronously. I found a situation where the Ignore() method fails to catch exceptions and demonstrated it with the code below.

Method ",,jason-bragg,,
4730,Orleans performance issue with GetGrain and saving to Event Store,"I'm using Orelans (2.0.3) with SQL database (2017). Database is on the same host where application is located. Currently I'm struggling with performance issue for:



Example execution time in miliseconds for **ConfirmEvents**:
20-50ms

Those delays causes that I can't process more than 15-30 messages/s.

Everything is working on my local machine with CPU intel core i7 16 GB of RAM.
Please let me know which configruation should I provide to find the reason of this long time execution.
Thanks for any help !","Orleans performance issue with GetGrain and saving to Event Store I'm using Orelans (2.0.3) with SQL database (2017). Database is on the same host where application is located. Currently I'm struggling with performance issue for:



Example execution time in miliseconds for **ConfirmEvents**:
20-50ms

Those delays causes that I can't process more than 15-30 messages/s.

Everything is working on my local machine with CPU intel core i7 16 GB of RAM.
Please let me know which configruation should I provide to find the reason of this long time execution.
Thanks for any help !",,jason-bragg,,
4729,Updated Ignore(this Task) method,https://github.com/dotnet/orleans/issues/4728,Updated Ignore(this Task) method https://github.com/dotnet/orleans/issues/4728,,jason-bragg,,
4728,Improve the Ignore method,The ,Improve the Ignore method The ,P3,ReubenBond,,
4725,Removed unnecessary parts configuration,#NAME?,Removed unnecessary parts configuration @jason-bragg ,,ReubenBond,,
4722,Update Adventure.md,Edited instructions with guidance from @richorama,Update Adventure.md Edited instructions with guidance from @richorama,documentation,jason-bragg,,
4721,ServiceId_SiloRestart fails intermittently,"
Orleans.Runtime.OrleansLifecycleCanceledException : Lifecycle start canceled due to errors at stage 19999
2018-06-28T18:46:13.4380282Z       ---- System.TimeoutException : MembershipOracle activating failed due to timeout 00:05:00
2018-06-28T18:46:13.4390296Z       Stack Trace:
2018-06-28T18:46:13.4400270Z         D:\build\agent2\_work\13\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs(630): at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext()
2018-06-28T18:46:13.4410272Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4420308Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4430311Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4440267Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Scheduler\ClosureWorkItem.cs(670): at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.<Execute>d__8.MoveNext()
2018-06-28T18:46:13.4450349Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4460312Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4470268Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4480310Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Silo\Silo.cs(2720): at Orleans.Runtime.Silo.<StartAsync>d__64.MoveNext()
2018-06-28T18:46:13.4490358Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4500269Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4520274Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4530310Z         D:\build\agent2\_work\13\s\src\Orleans.TestingHost\InProcessSiloHandle.cs(360): at Orleans.TestingHost.InProcessSiloHandle.Create(String siloName IList1 configurationOverrides Boolean startSiloOnNewPort)
2018-06-28T18:46:13.4550314Z         D:\build\agent2\_work\13\s\src\Orleans.TestingHost\TestCluster.cs(4190): at Orleans.TestingHost.TestCluster.RestartSilo(SiloHandle instance)
2018-06-28T18:46:13.4560208Z         D:\build\agent2\_work\13\s\test\TesterInternal\StreamProvidersTests.cs(900): at UnitTests.Streaming.StreamProvidersTests_ProviderConfigNotLoaded.<ServiceId_SiloRestart>d__9.MoveNext()
2018-06-28T18:46:13.4570308Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4580241Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4590278Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4600348Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4610265Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4630367Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4640374Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4650422Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4660310Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4670239Z         ----- Inner Stack Trace -----
2018-06-28T18:46:13.4680201Z         D:\build\agent2\_work\13\s\src\Orleans.Core\Async\TaskExtensions.cs(2250): at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext()
2018-06-28T18:46:13.4690294Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4700308Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4710156Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4720307Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Silo\Silo.cs(5250): at Orleans.Runtime.Silo.<<OnBecomeActiveStart>g__BecomeActive|72_1>d.MoveNext()
2018-06-28T18:46:13.4730269Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4740231Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4761713Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4770267Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Silo\Silo.cs(3930): at Orleans.Runtime.Silo.<StartAsyncTaskWithPerfAnalysis>d__69.MoveNext()
2018-06-28T18:46:13.4780337Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4790334Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4800336Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4820323Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Silo\Silo.cs(5270): at Orleans.Runtime.Silo.<OnBecomeActiveStart>d__72.MoveNext()
2018-06-28T18:46:13.4830308Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4840265Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4850267Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4860281Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Lifecycle\SiloLifecycleSubject.cs(820): at Orleans.Runtime.SiloLifecycleSubject.MonitoredObserver.<OnStart>d__9.MoveNext()
2018-06-28T18:46:13.4870306Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4880348Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4890265Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4900353Z         D:\build\agent2\_work\13\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs(1150): at Orleans.LifecycleSubject.<WrapExecution>d__10.MoveNext()
2018-06-28T18:46:13.4910389Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4920300Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4930325Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4940265Z         D:\build\agent2\_work\13\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs(550): at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext()","ServiceId_SiloRestart fails intermittently 
Orleans.Runtime.OrleansLifecycleCanceledException : Lifecycle start canceled due to errors at stage 19999
2018-06-28T18:46:13.4380282Z       ---- System.TimeoutException : MembershipOracle activating failed due to timeout 00:05:00
2018-06-28T18:46:13.4390296Z       Stack Trace:
2018-06-28T18:46:13.4400270Z         D:\build\agent2\_work\13\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs(630): at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext()
2018-06-28T18:46:13.4410272Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4420308Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4430311Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4440267Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Scheduler\ClosureWorkItem.cs(670): at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.<Execute>d__8.MoveNext()
2018-06-28T18:46:13.4450349Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4460312Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4470268Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4480310Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Silo\Silo.cs(2720): at Orleans.Runtime.Silo.<StartAsync>d__64.MoveNext()
2018-06-28T18:46:13.4490358Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4500269Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4520274Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4530310Z         D:\build\agent2\_work\13\s\src\Orleans.TestingHost\InProcessSiloHandle.cs(360): at Orleans.TestingHost.InProcessSiloHandle.Create(String siloName IList1 configurationOverrides Boolean startSiloOnNewPort)
2018-06-28T18:46:13.4550314Z         D:\build\agent2\_work\13\s\src\Orleans.TestingHost\TestCluster.cs(4190): at Orleans.TestingHost.TestCluster.RestartSilo(SiloHandle instance)
2018-06-28T18:46:13.4560208Z         D:\build\agent2\_work\13\s\test\TesterInternal\StreamProvidersTests.cs(900): at UnitTests.Streaming.StreamProvidersTests_ProviderConfigNotLoaded.<ServiceId_SiloRestart>d__9.MoveNext()
2018-06-28T18:46:13.4570308Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4580241Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4590278Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4600348Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4610265Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4630367Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4640374Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4650422Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4660310Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4670239Z         ----- Inner Stack Trace -----
2018-06-28T18:46:13.4680201Z         D:\build\agent2\_work\13\s\src\Orleans.Core\Async\TaskExtensions.cs(2250): at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext()
2018-06-28T18:46:13.4690294Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4700308Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4710156Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4720307Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Silo\Silo.cs(5250): at Orleans.Runtime.Silo.<<OnBecomeActiveStart>g__BecomeActive|72_1>d.MoveNext()
2018-06-28T18:46:13.4730269Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4740231Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4761713Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4770267Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Silo\Silo.cs(3930): at Orleans.Runtime.Silo.<StartAsyncTaskWithPerfAnalysis>d__69.MoveNext()
2018-06-28T18:46:13.4780337Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4790334Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4800336Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4820323Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Silo\Silo.cs(5270): at Orleans.Runtime.Silo.<OnBecomeActiveStart>d__72.MoveNext()
2018-06-28T18:46:13.4830308Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4840265Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4850267Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4860281Z         D:\build\agent2\_work\13\s\src\Orleans.Runtime\Lifecycle\SiloLifecycleSubject.cs(820): at Orleans.Runtime.SiloLifecycleSubject.MonitoredObserver.<OnStart>d__9.MoveNext()
2018-06-28T18:46:13.4870306Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4880348Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4890265Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4900353Z         D:\build\agent2\_work\13\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs(1150): at Orleans.LifecycleSubject.<WrapExecution>d__10.MoveNext()
2018-06-28T18:46:13.4910389Z         --- End of stack trace from previous location where exception was thrown ---
2018-06-28T18:46:13.4920300Z            at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
2018-06-28T18:46:13.4930325Z            at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
2018-06-28T18:46:13.4940265Z         D:\build\agent2\_work\13\s\src\Orleans.Core\Lifecycle\LifecycleSubject.cs(550): at Orleans.LifecycleSubject.<OnStart>d__5.MoveNext()",P2,benjaminpetit,,
4720,Several azure storage tests failing due silo lifecycle,"PersistenceProvider_Azure_ChangeReadFormat and 23 others are failing due to:

""System.InvalidOperationException : A suitable constructor for type 'Orleans.Runtime.SiloLifecycleSubject' could not be located. Ensure the type is concrete and services are registered for all parameters of a public constructor.""","Several azure storage tests failing due silo lifecycle PersistenceProvider_Azure_ChangeReadFormat and 23 others are failing due to:

""System.InvalidOperationException : A suitable constructor for type 'Orleans.Runtime.SiloLifecycleSubject' could not be located. Ensure the type is concrete and services are registered for all parameters of a public constructor.""",test-issue,xiazen,,
4719,AzureStorage Reminders does not replace invalide path chars in Row and Partition Keys,"Hello

We've experienced an issue recently when our Orleans Cluster has been migrated to Service Fabric.
We are using AzureStorage Table Service for clustering GrainState persistence and Reminders.

As the sample shows us we use the ServiceName of the fabric as the ServiceId of the cluster.
(https://github.com/dotnet/orleans/blob/master/Samples/2.0/ServiceFabric/Stateless/StatelessCalculatorService/StatelessCalculatorService.cs )
> // The service id is unique for the entire service over its lifetime. This is used to identify persistent state
> // such as reminders and grain state.
> options.ServiceId = fabricServiceContext.ServiceName.ToString();

This works well for GrainState PartitionKey since invalid path chars like **/** or **\\** are replaced by underscores:


But this seems to be not the case for GrainReminders. 
A lot of 400 bad request errors occured because of the PartitionKey name containing invalid path chars. 

> The following characters are not allowed in values for the PartitionKey and RowKey properties:
> 
> The forward slash (/) character
> The backslash (\\) character
> The number sign (#) character
> The question mark (?) character
> Control characters from U+0000 to U+001F including:
> The horizontal tab (\t) character
> The linefeed (\n) character
> The carriage return (\r) character
> Control characters from U+007F to U+009F

The AzureTableReminderService should use the same sanitization mechanism for PartitionKeys and RowKeys of GrainReminders as GrainState. 

Thank you","AzureStorage Reminders does not replace invalide path chars in Row and Partition Keys Hello

We've experienced an issue recently when our Orleans Cluster has been migrated to Service Fabric.
We are using AzureStorage Table Service for clustering GrainState persistence and Reminders.

As the sample shows us we use the ServiceName of the fabric as the ServiceId of the cluster.
(https://github.com/dotnet/orleans/blob/master/Samples/2.0/ServiceFabric/Stateless/StatelessCalculatorService/StatelessCalculatorService.cs )
> // The service id is unique for the entire service over its lifetime. This is used to identify persistent state
> // such as reminders and grain state.
> options.ServiceId = fabricServiceContext.ServiceName.ToString();

This works well for GrainState PartitionKey since invalid path chars like **/** or **\\** are replaced by underscores:


But this seems to be not the case for GrainReminders. 
A lot of 400 bad request errors occured because of the PartitionKey name containing invalid path chars. 

> The following characters are not allowed in values for the PartitionKey and RowKey properties:
> 
> The forward slash (/) character
> The backslash (\\) character
> The number sign (#) character
> The question mark (?) character
> Control characters from U+0000 to U+001F including:
> The horizontal tab (\t) character
> The linefeed (\n) character
> The carriage return (\r) character
> Control characters from U+007F to U+009F

The AzureTableReminderService should use the same sanitization mechanism for PartitionKeys and RowKeys of GrainReminders as GrainState. 

Thank you",bug,benjaminpetit,,
4717,Documentation URL structure makes no sense lacks default pages,"Let me walk through this to show what I mean.

I go to the 2.0 Documentation... URL is:
https://dotnet.github.io/orleans/Documentation/Introduction.html

![image](https://user-images.githubusercontent.com/13241564/41998681-36a3ce68-7a53-11e8-993c-d734e5b22231.png)

I remove Introduction.html from the URL. New URL is:
https://dotnet.github.io/orleans/Documentation/

![image](https://user-images.githubusercontent.com/13241564/41998728-5a413c5c-7a53-11e8-9e61-23180b4e993d.png)

Of course removing another level is okay because this is the real root of everything:
https://dotnet.github.io/orleans/

![image](https://user-images.githubusercontent.com/13241564/41998785-7aad3176-7a53-11e8-944b-273ad3d6db73.png)

Now let's go into 1.5 Documentation. URL is:
https://dotnet.github.io/orleans/1.5/Documentation/Introduction.html

Removing the filename and going up one or two levels as you can imagine results in a ""this page does not exist"".

![image](https://user-images.githubusercontent.com/13241564/41998933-e9559ca8-7a53-11e8-9d7c-23610ca3101b.png)

I think the least we can do here is toss in an index.html in a few places and use it to redirect to Introduction.html.

But if you think about it you have to do that under:

* /orleans/Documentation/ (points to /orleans/Documentation/Introduction.html)
* /orleans/1.5/Documentation/ (points to /orleans/1.5/Documentation/Introduction.html)
* /orleans/1.5/ (points to /orleans/1.5/Documentation/Introduction.html)

I think the above illustrates how the folder structure doesn't make that much sense. Probably that Documentation folder isn't even necessary.

This is obviously not going to change though for link preservation and SEO reasons.","Documentation URL structure makes no sense, lacks default pages Let me walk through this to show what I mean.

I go to the 2.0 Documentation... URL is:
https://dotnet.github.io/orleans/Documentation/Introduction.html

![image](https://user-images.githubusercontent.com/13241564/41998681-36a3ce68-7a53-11e8-993c-d734e5b22231.png)

I remove Introduction.html from the URL. New URL is:
https://dotnet.github.io/orleans/Documentation/

![image](https://user-images.githubusercontent.com/13241564/41998728-5a413c5c-7a53-11e8-9e61-23180b4e993d.png)

Of course removing another level is okay because this is the real root of everything:
https://dotnet.github.io/orleans/

![image](https://user-images.githubusercontent.com/13241564/41998785-7aad3176-7a53-11e8-944b-273ad3d6db73.png)

Now let's go into 1.5 Documentation. URL is:
https://dotnet.github.io/orleans/1.5/Documentation/Introduction.html

Removing the filename and going up one or two levels as you can imagine results in a ""this page does not exist"".

![image](https://user-images.githubusercontent.com/13241564/41998933-e9559ca8-7a53-11e8-9d7c-23610ca3101b.png)

I think the least we can do here is toss in an index.html in a few places and use it to redirect to Introduction.html.

But if you think about it you have to do that under:

* /orleans/Documentation/ (points to /orleans/Documentation/Introduction.html)
* /orleans/1.5/Documentation/ (points to /orleans/1.5/Documentation/Introduction.html)
* /orleans/1.5/ (points to /orleans/1.5/Documentation/Introduction.html)

I think the above illustrates how the folder structure doesn't make that much sense. Probably that Documentation folder isn't even necessary.

This is obviously not going to change though for link preservation and SEO reasons.",P1,JillHeaden,,
4716,Fixed intermittent Transaction test failures,Tests where unnessessarily fanning out to 64 transactional states when only 8 where necessary for testing.  This led to intermittent failures due to timeouts.  They now only run against the targeted 8 transactional states.,Fixed intermittent Transaction test failures Tests where unnessessarily fanning out to 64 transactional states when only 8 where necessary for testing.  This led to intermittent failures due to timeouts.  They now only run against the targeted 8 transactional states.,test-issue,xiazen,,
4713,Do not use ip address from interface not operational,Should fix #4524 ,Do not use ip address from interface not operational Should fix #4524 ,,ReubenBond,,
4712,Runtime motioning on 1.5.x,"https://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Monitoring/Runtime-Monitoring.html

there's only documentation on how to add Application insights and new relic for 2.0.
is this usable on 1.5.x? would be pretty helpful.","Runtime motioning on 1.5.x https://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Monitoring/Runtime-Monitoring.html

there's only documentation on how to add Application insights and new relic for 2.0.
is this usable on 1.5.x? would be pretty helpful.",,xiazen,,
4710,IGrainStorage null implementation registerd in DI container,"We currently add the mapping:
services.TryAddSingleton<IGrainStorage>(sp => sp.GetServiceByName<IGrainStorage>(ProviderConstants.DEFAULT_STORAGE_PROVIDER_NAME));
any time we add a grain storage not just when the default is added. This is wasteful but also seems to break some containers as returning null for a registered service is considered invalid for some containers. I'm not sure what the 'conforming container' rules are around this but it's sloppy in any case.","IGrainStorage null implementation registerd in DI container We currently add the mapping:
services.TryAddSingleton<IGrainStorage>(sp => sp.GetServiceByName<IGrainStorage>(ProviderConstants.DEFAULT_STORAGE_PROVIDER_NAME));
any time we add a grain storage not just when the default is added. This is wasteful but also seems to break some containers as returning null for a registered service is considered invalid for some containers. I'm not sure what the 'conforming container' rules are around this but it's sloppy in any case.",P3,jason-bragg,,
4709,Message response delay on serialization failures,We observe a situation where Orleans don't return a response immediately on serialization failures but rather response is timing out. Is this by design? ,Message response delay on serialization failures We observe a situation where Orleans don't return a response immediately on serialization failures but rather response is timing out. Is this by design? ,,ReubenBond,,
4708,What happens if I don't await an async operation,"We're using a timeout for slow storage request but since the built in blob storage provider doesn't expose any time out configuration we just stop waiting for the task to complete instead of canceling it (basically racing it with a timeout task we're using Polly's pessimistic timeout for this).

What effect does something like that have in Orleans?
","What happens if I don't await an async operation We're using a timeout for slow storage request but since the built in blob storage provider doesn't expose any time out configuration we just stop waiting for the task to complete instead of canceling it (basically racing it with a timeout task we're using Polly's pessimistic timeout for this).

What effect does something like that have in Orleans?
",question,ReubenBond,,
4706,PerformDeadlockDetection not working in 2.0,"Enabling PerformDeadlockDetection on Silo prevents Orleans Client from connecting with following TypeAccessException:

![image](https://user-images.githubusercontent.com/20849443/41804305-78c87750-76d7-11e8-8db0-67ce2cfcde6e.png)

![image](https://user-images.githubusercontent.com/20849443/41804275-e9835cea-76d6-11e8-96c2-4c27d2b5eaf6.png)

Not sure if I'm missing a certain package or if this is an Orleans bug.","PerformDeadlockDetection not working in 2.0 Enabling PerformDeadlockDetection on Silo prevents Orleans Client from connecting with following TypeAccessException:

![image](https://user-images.githubusercontent.com/20849443/41804305-78c87750-76d7-11e8-8db0-67ce2cfcde6e.png)

![image](https://user-images.githubusercontent.com/20849443/41804275-e9835cea-76d6-11e8-96c2-4c27d2b5eaf6.png)

Not sure if I'm missing a certain package or if this is an Orleans bug.",,jason-bragg,,
4705,Server Core OS support,"Hi

I can't find a list of supported operating systems in any documentation.  Is Orleans supported running on Server 2016 Core?  My assumption is it is but wanted confirmation.

Thanks.","Server Core OS support Hi

I can't find a list of supported operating systems in any documentation.  Is Orleans supported running on Server 2016 Core?  My assumption is it is but wanted confirmation.

Thanks.",question,ReubenBond,22/06/2018 21:21,22/06/2018 21:24
4703,Update Microsoft.Extensions.Options to 2.1.1 and remove duplicate functionality,"Now that Options 2.1.x is released we can update to it and remove:

* 

Note that this would be considered a breaking change since it removes those types (some of which are public) and modifies many configuration APIs to use the equivalent types in the options package (same type names different namespace & assembly)

However if we don't do it then we may see some clashes for users who update that package on their own accord (eg since it's a dependency of ASP.NET bits).

Question is: are we ok with that minor breakage and what kind of version bump do we want to associate with it a minor (2.1.0) or a major (3.0.0)?

PoC branch here: https://github.com/dotnet/orleans/compare/master...ReubenBond:update-options","Update Microsoft.Extensions.Options to 2.1.1 and remove duplicate functionality Now that Options 2.1.x is released we can update to it and remove:

* 

Note that this would be considered a breaking change since it removes those types (some of which are public) and modifies many configuration APIs to use the equivalent types in the options package (same type names different namespace & assembly)

However if we don't do it then we may see some clashes for users who update that package on their own accord (eg since it's a dependency of ASP.NET bits).

Question is: are we ok with that minor breakage and what kind of version bump do we want to associate with it a minor (2.1.0) or a major (3.0.0)?

PoC branch here: https://github.com/dotnet/orleans/compare/master...ReubenBond:update-options",,xiazen,,
4702,Support Microsoft.Extensions.Hosting.Abstractions,"In Orleans 2.0 we added : https://github.com/aspnet/Hosting/issues/1421. They've scheduled it for 3.0.0 so I imagine it will be a year or more before they move over.

I have a PoC for this on a branch here: https://github.com/dotnet/orleans/compare/master...ReubenBond:feature-generic-host

cc @galvesribeiro & @attilah who asked for this today","Support Microsoft.Extensions.Hosting.Abstractions In Orleans 2.0 we added : https://github.com/aspnet/Hosting/issues/1421. They've scheduled it for 3.0.0 so I imagine it will be a year or more before they move over.

I have a PoC for this on a branch here: https://github.com/dotnet/orleans/compare/master...ReubenBond:feature-generic-host

cc @galvesribeiro & @attilah who asked for this today",,ReubenBond,,
4701,Clear the data generated by PubSubRendezvousGrain,"I use: 


1、When I generate Guid different PubSubRendezvousGrain generates a lot of data is there a function to clear them?
","Clear the data generated by PubSubRendezvousGrain I use: 


1、When I generate Guid different PubSubRendezvousGrain generates a lot of data is there a function to clear them?
",question,xiazen,,
4700,Grain Disambiguation,"I am working on the project that some grain implementations inherit from an abstract grain implementation . 
Some just like this:
public abstract class A: Grain IGrainInterface
{
abstract method(); 
}

public class B: A
{
override method();
}

public class C: A
{
override method()
}

It seems I can use a grainClassNamePrefix to solve this problem but I haven't found any documents to describe how to use it. 

Thanks!","Grain Disambiguation I am working on the project that some grain implementations inherit from an abstract grain implementation . 
Some just like this:
public abstract class A: Grain IGrainInterface
{
abstract method(); 
}

public class B: A
{
override method();
}

public class C: A
{
override method()
}

It seems I can use a grainClassNamePrefix to solve this problem but I haven't found any documents to describe how to use it. 

Thanks!",question,sergeybykov,20/06/2018 8:04,20/06/2018 17:07
4697,InconsistentStateException with ADO.NET SQL Server grain storage,We've been getting this exception for a while in various grains. Particularly one which is activated in a  and lose that data? We had a grain that during the lifetime of the activation never again could write to state so I'm wondering how you recover from it. I couldn't find info on this in docs maybe I missed it,InconsistentStateException with ADO.NET SQL Server grain storage We've been getting this exception for a while in various grains. Particularly one which is activated in a  and lose that data? We had a grain that during the lifetime of the activation never again could write to state so I'm wondering how you recover from it. I couldn't find info on this in docs maybe I missed it,,jason-bragg,,
4696,Management Grain took to long,"i had this warning on a silo that was running using sql server liveness
WARNING	101215	Scheduler.WorkItemGroup	10.1.0.6:22222]	Task [Id=-1500906100 Status=RanToCompletion] in WorkGroup [Activation: S10.1.0.6:22222:265810487*grn/7483D9D2/00000000@b4f381b7 #GrainType=Orleans.Runtime.Management.ManagementGrain Placement=RandomPlacement State=Valid] took elapsed time 0:00:08.6929183 for execution which is longer than 00:00:00.2000000. Running on thread <Runtime.Scheduler.WorkerPoolThread/3 ManagedThreadId=10 Executing Task Id=-1500906100 Status=RanToCompletion for 00:00:08.6914987 on WorkItem=WorkItemGroup:Name=[Activation: S10.1.0.6:22222:265810487*grn/7483D9D2/00000000@b4f381b7 #GrainType=Orleans.Runtime.Management.ManagementGrain Placement=RandomPlacement]WorkGroupStatus=Running Executing for 00:00:08.6914987. .>	

it is stating that the management grain took 8 seconds i am using orleans 1.4.2
after that i got a callbackdata took 30 seconds error.
what would cause such behaviour ?

","Management Grain took to long i had this warning on a silo that was running using sql server liveness
WARNING	101215	Scheduler.WorkItemGroup	10.1.0.6:22222]	Task [Id=-1500906100 Status=RanToCompletion] in WorkGroup [Activation: S10.1.0.6:22222:265810487*grn/7483D9D2/00000000@b4f381b7 #GrainType=Orleans.Runtime.Management.ManagementGrain Placement=RandomPlacement State=Valid] took elapsed time 0:00:08.6929183 for execution which is longer than 00:00:00.2000000. Running on thread <Runtime.Scheduler.WorkerPoolThread/3 ManagedThreadId=10 Executing Task Id=-1500906100 Status=RanToCompletion for 00:00:08.6914987 on WorkItem=WorkItemGroup:Name=[Activation: S10.1.0.6:22222:265810487*grn/7483D9D2/00000000@b4f381b7 #GrainType=Orleans.Runtime.Management.ManagementGrain Placement=RandomPlacement]WorkGroupStatus=Running Executing for 00:00:08.6914987. .>	

it is stating that the management grain took 8 seconds i am using orleans 1.4.2
after that i got a callbackdata took 30 seconds error.
what would cause such behaviour ?

",,ReubenBond,,
4694,orleans rebalancing,"the load balancing and rebalancing grains into siloes is a very important topicplease provide us with an indepth look at it.
","orleans rebalancing the load balancing and rebalancing grains into siloes is a very important topicplease provide us with an indepth look at it.
",P3,jason-bragg,,
4693,How to get Grain primary key from GrainReference string key,"Hey
we're using azure blob storage for grain state persistence.
all our grains are IGrainWithGuidKey.
We're investigating storage issues getting lots of 404 errors for blobs.
our problem is the primary key in the grainState table looks like this:
GrainReference=11e798b4058027ec3ea216eb790ad2bf03ffffff810989d7

how do we get the grain's primary key from this? i want to be able to troubleshoot this but this grainReference string means nothing to me.","How to get Grain primary key from GrainReference string key Hey
we're using azure blob storage for grain state persistence.
all our grains are IGrainWithGuidKey.
We're investigating storage issues getting lots of 404 errors for blobs.
our problem is the primary key in the grainState table looks like this:
GrainReference=11e798b4058027ec3ea216eb790ad2bf03ffffff810989d7

how do we get the grain's primary key from this? i want to be able to troubleshoot this but this grainReference string means nothing to me.",question,ReubenBond,,
4692,"Docs: Possible mistake in ""Unreliable Deployment on a Cluster of Dedicated Servers""","I tried to follow the guide for DevelopmentClustering
https://github.com/dotnet/orleans/blob/gh-pages/src/Documentation/Deployment-and-Operations/Configuration-Guide/Typical-Configurations.md/#unreliable-deployment-on-a-cluster-of-dedicated-servers

When I ran the code the client couldn't connect so I tried changing the client port in the .UseStaticClustering()-call to the gateway port (30000). That seemed to do the trick.

I guess that it's a typo in the Docs but I'm extremely new to Orleans so I don't want to assume to much.

If it is a typo I can fix it and submit a PR

Also the ClusterId and and ServiceId mismatch between the silo and the client config but I caught that before I even tried to run the code.","Docs: Possible mistake in ""Unreliable Deployment on a Cluster of Dedicated Servers"" I tried to follow the guide for DevelopmentClustering
https://github.com/dotnet/orleans/blob/gh-pages/src/Documentation/Deployment-and-Operations/Configuration-Guide/Typical-Configurations.md/#unreliable-deployment-on-a-cluster-of-dedicated-servers

When I ran the code the client couldn't connect so I tried changing the client port in the .UseStaticClustering()-call to the gateway port (30000). That seemed to do the trick.

I guess that it's a typo in the Docs but I'm extremely new to Orleans so I don't want to assume to much.

If it is a typo I can fix it and submit a PR

Also the ClusterId and and ServiceId mismatch between the silo and the client config but I caught that before I even tried to run the code.",P1,JillHeaden,,
4691,Enhance ADO.NET with ability to create user supplied tuning knobs,"This issue records some ideas from Gitter discussion with regards ADO.NET functionality. This started from an idea to make using ""non-official"" libraries easier such as https://mysql-net.github.io/MySqlConnector/ but it appears this library is drop-in compatible with the official one so for that case this refactoring isn't strictly needed. It may be there are others that are not.

Currently the ADO.NET provider does not surface the options to load the library to the public configuration surface but instead uses a user-supplied (well-known) ADO.NET invariant to load libraries. It happens at https://github.com/dotnet/orleans/blob/master/src/AdoNet/Shared/Storage/DbConnectionFactory.cs#L26 and the options being set are at https://github.com/dotnet/orleans/blob/master/src/AdoNet/Shared/Storage/DbConstantsStore.cs#L43 and used at https://github.com/dotnet/orleans/blob/master/src/AdoNet/Shared/Storage/RelationalStorage.cs#L274 for instance.

It could be beneficial to:
1. Consider that now that .NET Standard has again included  (such as if it's non-blocking or not)
3. give the user the option to supply the path to the connector dll to be loaded
4. and optionally create an utility function to extract the version of the library so it would become possible to just determine somewhat automatically if the library has certain properties such as truly non-blocking queries as-per some version.

It's notable these options are there to give some very fine-tuning knobs to certain situations but aren't strictly necessary.","Enhance ADO.NET with ability to create user supplied tuning knobs This issue records some ideas from Gitter discussion with regards ADO.NET functionality. This started from an idea to make using ""non-official"" libraries easier such as https://mysql-net.github.io/MySqlConnector/ but it appears this library is drop-in compatible with the official one so for that case this refactoring isn't strictly needed. It may be there are others that are not.

Currently the ADO.NET provider does not surface the options to load the library to the public configuration surface but instead uses a user-supplied (well-known) ADO.NET invariant to load libraries. It happens at https://github.com/dotnet/orleans/blob/master/src/AdoNet/Shared/Storage/DbConnectionFactory.cs#L26 and the options being set are at https://github.com/dotnet/orleans/blob/master/src/AdoNet/Shared/Storage/DbConstantsStore.cs#L43 and used at https://github.com/dotnet/orleans/blob/master/src/AdoNet/Shared/Storage/RelationalStorage.cs#L274 for instance.

It could be beneficial to:
1. Consider that now that .NET Standard has again included  (such as if it's non-blocking or not)
3. give the user the option to supply the path to the connector dll to be loaded
4. and optionally create an utility function to extract the version of the library so it would become possible to just determine somewhat automatically if the library has certain properties such as truly non-blocking queries as-per some version.

It's notable these options are there to give some very fine-tuning knobs to certain situations but aren't strictly necessary.",enhancement,veikkoeeva,15/06/2018 15:55,
4688,Rename UseDistributedTM method,The  or something more obvious.,Rename UseDistributedTM method The  or something more obvious.,P2,xiazen,,
4687,2.0.3 versions of TelemetryConsumers.AI and TelemetryConsumers.NewRelic haven't been released,#4392 had fixes for these packages but we haven't released them.,2.0.3 versions of TelemetryConsumers.AI and TelemetryConsumers.NewRelic haven't been released #4392 had fixes for these packages but we haven't released them.,,sergeybykov,,
4686,EHStatistics_MonitorCalledAccordingly test fails intermittently,"ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.EHStatistics_MonitorCalledAccordingly

MESSAGE:
Assert.True() Failure\r\nExpected: True\r\nActual: False
+++++++++++++++++++
STACK TRACE:
at ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.AssertCacheMonitorCallCounters(CacheMonitorCounters totalCacheMonitorCallCounters) in D:\j\workspace\functional_pr---83d31c72\test\Extensions\ServiceBus.Tests\StatisticMonitorTests\EHStatisticMonitorTests.cs:line 118 at ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.<EHStatistics_MonitorCalledAccordingly>d__9.MoveNext() in D:\j\workspace\functional_pr---83d31c72\test\Extensions\ServiceBus.Tests\StatisticMonitorTests\EHStatisticMonitorTests.cs:line 103 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","EHStatistics_MonitorCalledAccordingly test fails intermittently ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.EHStatistics_MonitorCalledAccordingly

MESSAGE:
Assert.True() Failure\r\nExpected: True\r\nActual: False
+++++++++++++++++++
STACK TRACE:
at ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.AssertCacheMonitorCallCounters(CacheMonitorCounters totalCacheMonitorCallCounters) in D:\j\workspace\functional_pr---83d31c72\test\Extensions\ServiceBus.Tests\StatisticMonitorTests\EHStatisticMonitorTests.cs:line 118 at ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.<EHStatistics_MonitorCalledAccordingly>d__9.MoveNext() in D:\j\workspace\functional_pr---83d31c72\test\Extensions\ServiceBus.Tests\StatisticMonitorTests\EHStatisticMonitorTests.cs:line 103 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",testing,jason-bragg,,
4685,Fix more bugs in transactions code,"While developing the randomized consistency tests I found more bugs. These are the fixes.
","Fix more bugs in transactions code While developing the randomized consistency tests I found more bugs. These are the fixes.
",,jason-bragg,,
4683,Orleans.TelemetryConsumers.AI and Telemetry interfaces are not DI and usage friendly,"We are upgrading our Orleans solution from 1.5.x to 2.0 and we have to port the telemetry consumer code for the new version.
We are using the Application Insights telemetry consumer and the current implementation looks like this which is not to friendly to use it.


I also for this I have to register all these interfaces into the DI container separately

Would be great a Common Interface to register and use.

","Orleans.TelemetryConsumers.AI and Telemetry interfaces are not DI and usage friendly We are upgrading our Orleans solution from 1.5.x to 2.0 and we have to port the telemetry consumer code for the new version.
We are using the Application Insights telemetry consumer and the current implementation looks like this which is not to friendly to use it.


I also for this I have to register all these interfaces into the DI container separately

Would be great a Common Interface to register and use.

",,xiazen,,
4681,Resubmitting #4667 for an unsquashed merge,#4667 got squash-merged which is not good for tracking history. I reset the 1.5.4 branch so that these fixes can be re-merged without getting squashed.,Resubmitting #4667 for an unsquashed merge #4667 got squash-merged which is not good for tracking history. I reset the 1.5.4 branch so that these fixes can be re-merged without getting squashed.,,benjaminpetit,,
4680,Silo can't start in docker,"I have strange error that can be reproduced in docker container only. When I run my application as regular application(not in the docker) all works as expected. 
What is interesting that the silo terminating in case when there is a startup task and orphan records in OrleansMembershipTable table I use ado.net membership.
If I remove orphan records from OrleansMembershipTable table or comment my startup task silo able to start and works.
Startup task activate a grain with reminder and timer for several background staff.

Below the full log of orleans from docker. 
I've skipped several sensitive info from the log
I use .NET 462 Orleans 2.0.3
<details>
<summary>Full Orleans Log</summary>
<pre>
host.server_1   | [12:45:10 WRN] No implementation of IHostEnvironmentStatistics was found. Load shedding will not work yet
host.server_1   | [12:45:10 INF] Starting OrleansTaskScheduler with 4 Max Active application Threads and 1 system thread.
host.server_1   | [12:45:10 INF] Silo starting with GC settings: ServerGC=True GCLatencyMode=Interactive
host.server_1   | [12:45:10 INF] -------------- Initializing silo on host 5a5cb449241b MachineName 5A5CB449241B at 172.26.83.96:11111 gen 266492710 --------------
host.server_1   | [12:45:10 INF] Starting silo Silo_d97f1
host.server_1   | [12:45:10 INF] Opened a listening socket at address 0.0.0.0:11111
host.server_1   | [12:45:10 INF] Opened a listening socket at address 0.0.0.0:30000
host.server_1   | [12:45:10 INF] Starting VirtualBucketsRingProvider on silo S172.26.83.96:11111:266492710/x28220225.
host.server_1   | [12:45:10 INF] Added Server S172.26.83.96:11111:266492710/x28220225. Current view: [S172.26.83.96:11111:266492710 -> <MultiRange: Size=x100000000 %Ring=100.000%>]
host.server_1   | [12:45:10 INF] -NotifyLocalRangeSubscribers about old <(0 0] Size=x100000000 %Ring=100.000%> new <MultiRange: Size=x100000000 %Ring=100.000%> increased? True
host.server_1   | [12:45:11 INF] Skip multicluster oracle creation (no multicluster network configured)
host.server_1   | [12:45:11 INF] -------------- Started silo S172.26.83.96:11111:266492710 ConsistentHashCode 28220225 --------------
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/System.5 on managed thread 7
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/0 on managed thread 8
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/1 on managed thread 9
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/2 on managed thread 10
host.server_1   | [12:45:11 INF] Start Scheduler took 11 Milliseconds to finish
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/3 on managed thread 11
host.server_1   | [12:45:11 INF] Stage 2000: Orleans.Runtime.InsideRuntimeClient Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Stage 4000: Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Stage 8000: Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Stage 10000: Orleans.Runtime.Versions.GrainVersionStore Orleans.Storage.AdoNetGrainStorage-Default Orleans.Storage.AdoNetGrainStorage-OrleansStorage
host.server_1   | [12:45:11 INF] Stage 19999: Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Stage 20000: Orleans.Hosting.SiloBuilderStartupExtensions+StartupTask Orleans.Hosting.SiloBuilderStartupExtensions+StartupTask Orleans.Hosting.SiloBuilderStartupExtensions+StartupTask Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Start InsideRuntimeClient took 9 Milliseconds
host.server_1   | [12:45:11 INF] Lifecycle observer Orleans.Runtime.InsideRuntimeClient started in stage 2000 which took 10 Milliseconds.
host.server_1   | [12:45:11 INF] Silo Start()
host.server_1   | [12:45:11 INF] Configured ThreadPool.SetMinThreads() to values: 200200. Previous values are: 22.
host.server_1   | [12:45:11 INF] Configured .NET ServicePointManager to Expect100Continue=False DefaultConnectionLimit=200 UseNagleAlgorithm=False to improve Azure storage performance.
host.server_1   | [12:45:11 INF] ConfigureThreadPoolAndServicePointSettings took 4 Milliseconds to finish
host.server_1   | [12:45:11 INF] Lifecycle observer Orleans.Runtime.Silo started in stage 2000 which took 10 Milliseconds.
host.server_1   | [12:45:11 INF] Starting lifecycle stage 2000 took 24 Milliseconds
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.IncomingMessageAcceptor on managed thread 12
host.server_1   | [12:45:11 INF] Stopping AsyncAgent Runtime.Messaging.IncomingMessageAcceptor that runs on managed thread 12
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.SiloMessageSender/PingSender on managed thread 13
host.server_1   | [12:45:11 INF] Start Message center took 3 Milliseconds to finish
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.SiloMessageSender/SystemSender on managed thread 15
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.IncomingMessageAgent/Ping on managed thread 16
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.IncomingMessageAgent/System on managed thread 17
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.IncomingMessageAgent/Application on managed thread 18
host.server_1   | [12:45:11 INF] Start Incoming message agents took 2 Milliseconds to finish
host.server_1   | [12:45:11 INF] Start
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.GrainDirectory.AdaptiveDirectoryCacheMaintainer1.<Execute>d__8.MoveNext()
host.server_1   | --- End of stack trace from previous location where exception was thrown ---
host.server_1   |    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
host.server_1   |    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
host.server_1   |    at Orleans.Runtime.Placement.RandomPlacementDirector.<OnSelectActivation>d__1.MoveNext()
host.server_1   | --- End of stack trace from previous location where exception was thrown ---
host.server_1   |    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
host.server_1   |    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
host.server_1   |    at Orleans.Runtime.Placement.PlacementDirectorsManager.<SelectOrAddActivation>d__10.MoveNext()
host.server_1   | --- End of stack trace from previous location where exception was thrown ---
host.server_1   |    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
host.server_1   |    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
host.server_1   |    at Orleans.Runtime.Dispatcher.<AddressMessageAsync>d__41.MoveNext()
host.server_1   | --- End of stack trace from previous location where exception was thrown ---
host.server_1   |    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
host.server_1   |    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
host.server_1   |    at Orleans.Runtime.Dispatcher.<>c__DisplayClass37_0.<<AsyncSendMessage>b__1>d.MoveNext()) Response S172.26.83.96:11111:266492710*grn/B3628901/00000000+Default->S172.26.83.96:11111:266492710*stg/20/00000014@S00000014 #44: >
host.server_1   | --System*WorkItemGroup:Name=*stg/22/00000016WorkGroupStatus=Waiting. Currently QueuedWorkItems=0; Total EnQueued=14; Total processed=14; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-4:Queued=0; Detailed SchedulingContext=<[SystemTarget: S172.26.83.96:11111:266492710*stg/22/00000016@S00000016] CurrentlyExecuting=Transient Rejection (info: Silo S172.26.83.96:11111:266492710 is rejecting message: Request S172.26.83.96:11111:266492710*stg/22/00000016@S00000016->S172.26.95.237:11111:266481757*stg/22/00000016@S00000016 #8: . Reason = Recent (00:00:00 ago at 2018-06-12 09:45:21.353 GMT) connection failure trying to reach target silo S172.26.95.237:11111:266481757. Going to drop Request msg 8 without sending. CONNECTION_RETRY_DELAY = 00:00:01.) Response S172.26.95.237:11111:266481757*stg/22/00000016@S00000016->S172.26.83.96:11111:266492710*stg/22/00000016@S00000016 #8: >
host.server_1   | --System*WorkItemGroup:Name=*stg/24/00000018WorkGroupStatus=Waiting. Currently QueuedWorkItems=0; Total EnQueued=0; Total processed=0; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-7:Queued=0; Detailed SchedulingContext=<[SystemTarget: S172.26.83.96:11111:266492710*stg/24/00000018@S00000018] CurrentlyExecuting=null>
host.server_1   | --System*WorkItemGroup:Name=*stg/27/0000001bWorkGroupStatus=Waiting. Currently QueuedWorkItems=0; Total EnQueued=0; Total processed=0; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-3:Queued=0; Detailed SchedulingContext=<[SystemTarget: S172.26.83.96:11111:266492710*stg/27/0000001b@S0000001b] CurrentlyExecuting=null>
host.server_1   | --System*WorkItemGroup:Name=*stg/28/0000001cWorkGroupStatus=Waiting. Currently QueuedWorkItems=0; Total EnQueued=656; Total processed=656; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-11:Queued=0; Detailed SchedulingContext=<[SystemTarget: S172.26.83.96:11111:266492710*stg/28/0000001c@S0000001c] CurrentlyExecuting=null>]
host.server_1   | [12:45:21 INF] Silo Stopped
host.server_1   | [12:45:21 WRN] Process is exiting
host.server_1   | [12:45:21 INF] Silo termination is in progress - Will wait for it to finish
host.server_1 exited with code 1

</pre>
</details>","Silo can't start in docker I have strange error that can be reproduced in docker container only. When I run my application as regular application(not in the docker) all works as expected. 
What is interesting that the silo terminating in case when there is a startup task and orphan records in OrleansMembershipTable table I use ado.net membership.
If I remove orphan records from OrleansMembershipTable table or comment my startup task silo able to start and works.
Startup task activate a grain with reminder and timer for several background staff.

Below the full log of orleans from docker. 
I've skipped several sensitive info from the log
I use .NET 462 Orleans 2.0.3
<details>
<summary>Full Orleans Log</summary>
<pre>
host.server_1   | [12:45:10 WRN] No implementation of IHostEnvironmentStatistics was found. Load shedding will not work yet
host.server_1   | [12:45:10 INF] Starting OrleansTaskScheduler with 4 Max Active application Threads and 1 system thread.
host.server_1   | [12:45:10 INF] Silo starting with GC settings: ServerGC=True GCLatencyMode=Interactive
host.server_1   | [12:45:10 INF] -------------- Initializing silo on host 5a5cb449241b MachineName 5A5CB449241B at 172.26.83.96:11111 gen 266492710 --------------
host.server_1   | [12:45:10 INF] Starting silo Silo_d97f1
host.server_1   | [12:45:10 INF] Opened a listening socket at address 0.0.0.0:11111
host.server_1   | [12:45:10 INF] Opened a listening socket at address 0.0.0.0:30000
host.server_1   | [12:45:10 INF] Starting VirtualBucketsRingProvider on silo S172.26.83.96:11111:266492710/x28220225.
host.server_1   | [12:45:10 INF] Added Server S172.26.83.96:11111:266492710/x28220225. Current view: [S172.26.83.96:11111:266492710 -> <MultiRange: Size=x100000000 %Ring=100.000%>]
host.server_1   | [12:45:10 INF] -NotifyLocalRangeSubscribers about old <(0 0] Size=x100000000 %Ring=100.000%> new <MultiRange: Size=x100000000 %Ring=100.000%> increased? True
host.server_1   | [12:45:11 INF] Skip multicluster oracle creation (no multicluster network configured)
host.server_1   | [12:45:11 INF] -------------- Started silo S172.26.83.96:11111:266492710 ConsistentHashCode 28220225 --------------
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/System.5 on managed thread 7
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/0 on managed thread 8
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/1 on managed thread 9
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/2 on managed thread 10
host.server_1   | [12:45:11 INF] Start Scheduler took 11 Milliseconds to finish
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Scheduler.WorkerPoolThread/3 on managed thread 11
host.server_1   | [12:45:11 INF] Stage 2000: Orleans.Runtime.InsideRuntimeClient Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Stage 4000: Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Stage 8000: Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Stage 10000: Orleans.Runtime.Versions.GrainVersionStore Orleans.Storage.AdoNetGrainStorage-Default Orleans.Storage.AdoNetGrainStorage-OrleansStorage
host.server_1   | [12:45:11 INF] Stage 19999: Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Stage 20000: Orleans.Hosting.SiloBuilderStartupExtensions+StartupTask Orleans.Hosting.SiloBuilderStartupExtensions+StartupTask Orleans.Hosting.SiloBuilderStartupExtensions+StartupTask Orleans.Runtime.Silo
host.server_1   | [12:45:11 INF] Start InsideRuntimeClient took 9 Milliseconds
host.server_1   | [12:45:11 INF] Lifecycle observer Orleans.Runtime.InsideRuntimeClient started in stage 2000 which took 10 Milliseconds.
host.server_1   | [12:45:11 INF] Silo Start()
host.server_1   | [12:45:11 INF] Configured ThreadPool.SetMinThreads() to values: 200200. Previous values are: 22.
host.server_1   | [12:45:11 INF] Configured .NET ServicePointManager to Expect100Continue=False DefaultConnectionLimit=200 UseNagleAlgorithm=False to improve Azure storage performance.
host.server_1   | [12:45:11 INF] ConfigureThreadPoolAndServicePointSettings took 4 Milliseconds to finish
host.server_1   | [12:45:11 INF] Lifecycle observer Orleans.Runtime.Silo started in stage 2000 which took 10 Milliseconds.
host.server_1   | [12:45:11 INF] Starting lifecycle stage 2000 took 24 Milliseconds
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.IncomingMessageAcceptor on managed thread 12
host.server_1   | [12:45:11 INF] Stopping AsyncAgent Runtime.Messaging.IncomingMessageAcceptor that runs on managed thread 12
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.SiloMessageSender/PingSender on managed thread 13
host.server_1   | [12:45:11 INF] Start Message center took 3 Milliseconds to finish
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.SiloMessageSender/SystemSender on managed thread 15
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.IncomingMessageAgent/Ping on managed thread 16
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.IncomingMessageAgent/System on managed thread 17
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.Messaging.IncomingMessageAgent/Application on managed thread 18
host.server_1   | [12:45:11 INF] Start Incoming message agents took 2 Milliseconds to finish
host.server_1   | [12:45:11 INF] Start
host.server_1   | [12:45:11 INF] Starting AsyncAgent Runtime.GrainDirectory.AdaptiveDirectoryCacheMaintainer1.<Execute>d__8.MoveNext()
host.server_1   | --- End of stack trace from previous location where exception was thrown ---
host.server_1   |    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
host.server_1   |    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
host.server_1   |    at Orleans.Runtime.Placement.RandomPlacementDirector.<OnSelectActivation>d__1.MoveNext()
host.server_1   | --- End of stack trace from previous location where exception was thrown ---
host.server_1   |    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
host.server_1   |    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
host.server_1   |    at Orleans.Runtime.Placement.PlacementDirectorsManager.<SelectOrAddActivation>d__10.MoveNext()
host.server_1   | --- End of stack trace from previous location where exception was thrown ---
host.server_1   |    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
host.server_1   |    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
host.server_1   |    at Orleans.Runtime.Dispatcher.<AddressMessageAsync>d__41.MoveNext()
host.server_1   | --- End of stack trace from previous location where exception was thrown ---
host.server_1   |    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
host.server_1   |    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
host.server_1   |    at Orleans.Runtime.Dispatcher.<>c__DisplayClass37_0.<<AsyncSendMessage>b__1>d.MoveNext()) Response S172.26.83.96:11111:266492710*grn/B3628901/00000000+Default->S172.26.83.96:11111:266492710*stg/20/00000014@S00000014 #44: >
host.server_1   | --System*WorkItemGroup:Name=*stg/22/00000016WorkGroupStatus=Waiting. Currently QueuedWorkItems=0; Total EnQueued=14; Total processed=14; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-4:Queued=0; Detailed SchedulingContext=<[SystemTarget: S172.26.83.96:11111:266492710*stg/22/00000016@S00000016] CurrentlyExecuting=Transient Rejection (info: Silo S172.26.83.96:11111:266492710 is rejecting message: Request S172.26.83.96:11111:266492710*stg/22/00000016@S00000016->S172.26.95.237:11111:266481757*stg/22/00000016@S00000016 #8: . Reason = Recent (00:00:00 ago at 2018-06-12 09:45:21.353 GMT) connection failure trying to reach target silo S172.26.95.237:11111:266481757. Going to drop Request msg 8 without sending. CONNECTION_RETRY_DELAY = 00:00:01.) Response S172.26.95.237:11111:266481757*stg/22/00000016@S00000016->S172.26.83.96:11111:266492710*stg/22/00000016@S00000016 #8: >
host.server_1   | --System*WorkItemGroup:Name=*stg/24/00000018WorkGroupStatus=Waiting. Currently QueuedWorkItems=0; Total EnQueued=0; Total processed=0; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-7:Queued=0; Detailed SchedulingContext=<[SystemTarget: S172.26.83.96:11111:266492710*stg/24/00000018@S00000018] CurrentlyExecuting=null>
host.server_1   | --System*WorkItemGroup:Name=*stg/27/0000001bWorkGroupStatus=Waiting. Currently QueuedWorkItems=0; Total EnQueued=0; Total processed=0; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-3:Queued=0; Detailed SchedulingContext=<[SystemTarget: S172.26.83.96:11111:266492710*stg/27/0000001b@S0000001b] CurrentlyExecuting=null>
host.server_1   | --System*WorkItemGroup:Name=*stg/28/0000001cWorkGroupStatus=Waiting. Currently QueuedWorkItems=0; Total EnQueued=656; Total processed=656; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-11:Queued=0; Detailed SchedulingContext=<[SystemTarget: S172.26.83.96:11111:266492710*stg/28/0000001c@S0000001c] CurrentlyExecuting=null>]
host.server_1   | [12:45:21 INF] Silo Stopped
host.server_1   | [12:45:21 WRN] Process is exiting
host.server_1   | [12:45:21 INF] Silo termination is in progress - Will wait for it to finish
host.server_1 exited with code 1

</pre>
</details>",P4,benjaminpetit,12/06/2018 20:33,
4678,Help generating documents from code comments,"Has anyone successfully used a document generator like DocFX to create documents from the comments in the Orleans code? 
If so would you be willing to tell me exactly what you did?","Help generating documents from code comments Has anyone successfully used a document generator like DocFX to create documents from the comments in the Orleans code? 
If so would you be willing to tell me exactly what you did?",P2,JillHeaden,,
4675,Documentation for GrainServices,"@JillHeaden I made this during a gitter conversation hopefully it'll be of some use to whoever's making Orleans documentation :)

https://docs.google.com/document/d/1JW8nJW8yK7ZhzO_pMWgWUfMNMq8og90qBmCWdOaX9iQ/edit#","Documentation for GrainServices @JillHeaden I made this during a gitter conversation hopefully it'll be of some use to whoever's making Orleans documentation :)

https://docs.google.com/document/d/1JW8nJW8yK7ZhzO_pMWgWUfMNMq8og90qBmCWdOaX9iQ/edit#",documentation,JillHeaden,,
4674,Remove dead code that used to track extended statistics,Fixes #4494.,Remove dead code that used to track extended statistics Fixes #4494.,,xiazen,,
4672,Remove unused settings MaxPendingWorkItemsHardLimit in SchedulingOptions,MaxPendingWorkItemsHardLimit is not used. No reason for it to be exposed through SchedulingOptions,Remove unused settings MaxPendingWorkItemsHardLimit in SchedulingOptions MaxPendingWorkItemsHardLimit is not used. No reason for it to be exposed through SchedulingOptions,breaking-change,xiazen,9/06/2018 8:11,9/06/2018 9:35
4669,Tutorial on Custom Grain Storage for 2.0,"This is a tutorial on how to create a custom grain storage for 2.0.

It is taking as base the previous document on storage provider 1.5 but updated to follow the current grain storage implementation found in Azure persistence and AWS persistence

It is explaining implementation of .

_I am not sure if this is the right place to merge could you please advise and I will move the tutorial. Thanks!_","Tutorial on Custom Grain Storage for 2.0 This is a tutorial on how to create a custom grain storage for 2.0.

It is taking as base the previous document on storage provider 1.5 but updated to follow the current grain storage implementation found in Azure persistence and AWS persistence

It is explaining implementation of .

_I am not sure if this is the right place to merge could you please advise and I will move the tutorial. Thanks!_",documentation,JillHeaden,,
4668,Fix wire backward compatibility,Addresses https://github.com/dotnet/orleans/issues/4666.,Fix wire backward compatibility Addresses https://github.com/dotnet/orleans/issues/4666.,,benjaminpetit,,
4667,Fixes for v1.5.4,,Fixes for v1.5.4 ,,benjaminpetit,,
4666,#4479 broke Silo backward compatibility,"#4479 introduced a breaking change in the wire protocol between silos.

Not sure if it could be fixed easily or if we could just revert this change.

@dVakulen?

","#4479 broke Silo backward compatibility #4479 introduced a breaking change in the wire protocol between silos.

Not sure if it could be fixed easily or if we could just revert this change.

@dVakulen?

",bug,dVakulen,8/06/2018 8:00,15/06/2018 7:26
4664,Problem starting single silo cluster after ungraceful silo shutdown,"The default cluster membership options will have it take 10 minutes of failing to contact another silo before it can be marked dead but only 5 minutes for a new silo to attempt to join a cluster. This results in a 5 minute window where a new silo can't join the cluster if the previous silo(s) was ungracefully shutdown.
I can certainly change the timeouts in our application but I'm a) not super familiar with their function and b) wondering if the defaults should prevent that situation.

The other problem is that the new silo continues to run after failing to join and doesn't seem to try again. Perhaps I am missing some configuration or a try/catch but I would like to not leave a silo around in a broken state.","Problem starting single silo cluster after ungraceful silo shutdown The default cluster membership options will have it take 10 minutes of failing to contact another silo before it can be marked dead but only 5 minutes for a new silo to attempt to join a cluster. This results in a 5 minute window where a new silo can't join the cluster if the previous silo(s) was ungracefully shutdown.
I can certainly change the timeouts in our application but I'm a) not super familiar with their function and b) wondering if the defaults should prevent that situation.

The other problem is that the new silo continues to run after failing to join and doesn't seem to try again. Perhaps I am missing some configuration or a try/catch but I would like to not leave a silo around in a broken state.",,benjaminpetit,,
4662,Orleans 1.5.2 bug - GrainStateStorageBridge loses exception callstack,"Hi

I've looked into code of ","Orleans 1.5.2 bug - GrainStateStorageBridge loses exception callstack Hi

I've looked into code of ",,xiazen,,
4661,Lock Microsoft.AzureEventHubs version to 1.0.3,Use nuget exact version match because Microsoft.Orleans.OrleansServiceBus will get runtime errors if a higher version of Microsoft.AzureEventHubs is referenced.,Lock Microsoft.AzureEventHubs version to 1.0.3 Use nuget exact version match because Microsoft.Orleans.OrleansServiceBus will get runtime errors if a higher version of Microsoft.AzureEventHubs is referenced.,,jason-bragg,,
4660,Make LifecycleSubject logging less verbose,For #4659 ,Make LifecycleSubject logging less verbose For #4659 ,,jason-bragg,,
4659,Logging is too verbose for LifecycleSubject,"Currently both silo and grain has a lifecycle  and they both uses  class. But in LifecycleSubject class it would record how long each stage took and log the timelapse as INFO level message. This is fine for silo lifecycle. but too verbose for grain lifecycle logging. Suggest 
- downgrade the logging from INFO to VERBOS for grain lifecycle or 
- turn grain lifecycle stage timelapse logging into some statistics 


","Logging is too verbose for LifecycleSubject Currently both silo and grain has a lifecycle  and they both uses  class. But in LifecycleSubject class it would record how long each stage took and log the timelapse as INFO level message. This is fine for silo lifecycle. but too verbose for grain lifecycle logging. Suggest 
- downgrade the logging from INFO to VERBOS for grain lifecycle or 
- turn grain lifecycle stage timelapse logging into some statistics 


",,xiazen,,
4658,Expected GrainFactory behavior in a heterogeneous silos environment?,"Hi

I've set up [heterogeneous silos](http://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Heterogeneous-Silos.html) and verified that a client indeed doesn't need to know where grains are hosted (and that's fine).

However the scenario of agnostic grain invocation fails with the following setup:

- The environment is a cluster (I've used [Consul](https://www.consul.io/) as a membership provider)
- First silo has one grain of type 'A' (in my case it's a simple 'Hello' grain)
- Second silo has one grain of type 'B' (a simple 'AnotherHello' grain)
- Both interfaces and implementations are isolated (one assembly for each artifact - 4 projects)

The first grain 'A' has one responsibility to find and invoke grain 'B'. Grain 'B' logs a simple message ('AnotherHello').

The client begin the call chain by invoking 'A'.

When control hits 'A' it tries to resolve 'B' by using  then grains have to know what grains are hosted in the silo (agnostic grain invocation won't work) to avoid generating the exception.

Kind regards
Jan
","Expected GrainFactory behavior in a heterogeneous silos environment? Hi

I've set up [heterogeneous silos](http://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Heterogeneous-Silos.html) and verified that a client indeed doesn't need to know where grains are hosted (and that's fine).

However the scenario of agnostic grain invocation fails with the following setup:

- The environment is a cluster (I've used [Consul](https://www.consul.io/) as a membership provider)
- First silo has one grain of type 'A' (in my case it's a simple 'Hello' grain)
- Second silo has one grain of type 'B' (a simple 'AnotherHello' grain)
- Both interfaces and implementations are isolated (one assembly for each artifact - 4 projects)

The first grain 'A' has one responsibility to find and invoke grain 'B'. Grain 'B' logs a simple message ('AnotherHello').

The client begin the call chain by invoking 'A'.

When control hits 'A' it tries to resolve 'B' by using  then grains have to know what grains are hosted in the silo (agnostic grain invocation won't work) to avoid generating the exception.

Kind regards
Jan
",P3,JillHeaden,,
4657,Cannot configure MessagingOptions.ResponseTimeoutWithDebugger via builder extension methods,"Perhaps I simply can't find the means but it doesn't seem possible to use either the legacy ClientConfiguration or a new method to set MessagingOptions.ResponseTimeoutWithDebugger. The ""Messaging"" option in client configuration .xml's are from MessagingConfiguration which doesn't support the field.

As a workaround I am simply post configuring the ClientMessagingOptions:
","Cannot configure MessagingOptions.ResponseTimeoutWithDebugger via builder extension methods Perhaps I simply can't find the means but it doesn't seem possible to use either the legacy ClientConfiguration or a new method to set MessagingOptions.ResponseTimeoutWithDebugger. The ""Messaging"" option in client configuration .xml's are from MessagingConfiguration which doesn't support the field.

As a workaround I am simply post configuring the ClientMessagingOptions:
",,xiazen,,
4656,Legacy UseConfiguration doesn't properly set DynamoDBReminderStorageOptions,"Upgrading from 2.0.0-beta3 I've observed:

> Orleans.Runtime.OrleansLifecycleCanceledException: 'Lifecycle start canceled due to errors at stage 20000'

> InnerException | {System.ArgumentNullException: Value cannot be null. Parameter name: service    at Orleans.Reminders.DynamoDB.DynamoDBStorage..ctor(ILoggerFactory loggerFactory String service String accessKey String secretKey Int32 readCapacityUnits Int32 writeCapacityUnits)    at Orleans.Reminders.DynamoDB.DynamoDBReminderTable.Init()    at Orleans.Runtime.ReminderService.LocalReminderService.<Start>d__16.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.<Execute>d__8.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.Silo.<<OnActiveStart>g__StartReminderService73_0>d.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.Silo.<StartAsyncTaskWithPerfAnalysis>d__69.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.Silo.<OnActiveStart>d__73.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.SiloLifecycleSubject.MonitoredObserver.<OnStart>d__9.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.LifecycleSubject.<WrapExecution>d__8.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.LifecycleSubject.<OnStart>d__4.MoveNext()} | System.Exception {System.ArgumentNullException}

This seems to be caused by the DynamoDBReminderStorageOptions object not properly being configured when using the legacy extension method UseConfiguration. DynamoDBClusteringOptions does get properly set however.

After manually setting these fields via UseDynamoDBReminderService() everything works:

","Legacy UseConfiguration doesn't properly set DynamoDBReminderStorageOptions Upgrading from 2.0.0-beta3 I've observed:

> Orleans.Runtime.OrleansLifecycleCanceledException: 'Lifecycle start canceled due to errors at stage 20000'

> InnerException | {System.ArgumentNullException: Value cannot be null. Parameter name: service    at Orleans.Reminders.DynamoDB.DynamoDBStorage..ctor(ILoggerFactory loggerFactory String service String accessKey String secretKey Int32 readCapacityUnits Int32 writeCapacityUnits)    at Orleans.Reminders.DynamoDB.DynamoDBReminderTable.Init()    at Orleans.Runtime.ReminderService.LocalReminderService.<Start>d__16.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.Scheduler.AsyncClosureWorkItem.<Execute>d__8.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.Silo.<<OnActiveStart>g__StartReminderService73_0>d.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.Silo.<StartAsyncTaskWithPerfAnalysis>d__69.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.Silo.<OnActiveStart>d__73.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.Runtime.SiloLifecycleSubject.MonitoredObserver.<OnStart>d__9.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.LifecycleSubject.<WrapExecution>d__8.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Orleans.LifecycleSubject.<OnStart>d__4.MoveNext()} | System.Exception {System.ArgumentNullException}

This seems to be caused by the DynamoDBReminderStorageOptions object not properly being configured when using the legacy extension method UseConfiguration. DynamoDBClusteringOptions does get properly set however.

After manually setting these fields via UseDynamoDBReminderService() everything works:

",P4,xiazen,7/06/2018 0:32,
4655,How to debug deadlocks in orleans 2.0 ? (Target History),"When running into deadlocks due to circular references or other reasons orleans gets stuck until it eventualy times out with a TimeoutException.

In orleans 1.5 it used to give an error including the grain/method name that got stuck in readable form in the target history.

In orleans 2.0 I just get something like this:

![image](https://user-images.githubusercontent.com/20849443/41015805-3f19c518-698f-11e8-94d7-241a99b7c243.png)

I have no idea how to debug this in a sane way to find which method got stuck.

Is there some kind of setting I can use to get better error messages?","How to debug deadlocks in orleans 2.0 ? (Target History) When running into deadlocks due to circular references or other reasons orleans gets stuck until it eventualy times out with a TimeoutException.

In orleans 1.5 it used to give an error including the grain/method name that got stuck in readable form in the target history.

In orleans 2.0 I just get something like this:

![image](https://user-images.githubusercontent.com/20849443/41015805-3f19c518-698f-11e8-94d7-241a99b7c243.png)

I have no idea how to debug this in a sane way to find which method got stuck.

Is there some kind of setting I can use to get better error messages?",,ReubenBond,,
4654,The target silo became unavailable for message.  The silo appears to be running.,"I've upgraded to Orleans 2.0 and I'm able to successfully run the silo and client web application on my dev machine. The client application is able to connect to the silo obtain grains all seems to work fine. When i deploy the silo and client application to our dev server I'm getting the ""The target silo became unavailable for message"" exception when trying to connect to the silo. I know that this can happen if the silo isn't yet ready for connections so we have a retry mechanism when connecting however the silo appears to be running and doing work (reminders are firing and such). I've read through https://dotnet.github.io/orleans/Documentation/Advanced-Concepts/Troubleshooting-Deployments.html to no avail.

Here is the code used to configure the silo


Please note when I revert back to our orleans 1.5 application on the DEV server everything works so it shouldn't be a network connectivity issue on the server.  Here are the logs of the silo starting.
[OrleansDebugLog.xlsx](https://github.com/dotnet/orleans/files/2073614/OrleansDebugLog.xlsx)

Here is the exception from the client:

> ""The target silo became unavailable for message: Request *cli/d0621ab9@97ba6db4->S10.10.92.113:30000:265920396*stg/17/00000011@S00000011 #10: . Target History is: <S10.10.92.113:30000:265920396:*stg/17/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help."" Data: {…} InnerException: null TargetSite: ""Void Throw()"" StackTrace: ""   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.OutsideRuntimeClient.<<StartInternal>b__58_2>d.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Runtime\\OutsideRuntimeClient.cs:line 249\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.OutsideRuntimeClient.<<StartInternal>g__ExecuteWithRetries58_3>d.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Runtime\\OutsideRuntimeClient.cs:line 269\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.OutsideRuntimeClient.<StartInternal>d__58.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Runtime\\OutsideRuntimeClient.cs:line 252\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.OutsideRuntimeClient.<Start>d__57.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Runtime\\OutsideRuntimeClient.cs:line 193\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.ClusterClient.<Connect>d__19.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Core\\ClusterClient.cs:line 120"" HelpLink: null Source: ""mscorlib"" HResult: -2146233088 Type: ""Orleans.Runtime.SiloUnavailableException""}

 Any suggestions on how I can debug this issue?  Thanks!","The target silo became unavailable for message.  The silo appears to be running. I've upgraded to Orleans 2.0 and I'm able to successfully run the silo and client web application on my dev machine. The client application is able to connect to the silo obtain grains all seems to work fine. When i deploy the silo and client application to our dev server I'm getting the ""The target silo became unavailable for message"" exception when trying to connect to the silo. I know that this can happen if the silo isn't yet ready for connections so we have a retry mechanism when connecting however the silo appears to be running and doing work (reminders are firing and such). I've read through https://dotnet.github.io/orleans/Documentation/Advanced-Concepts/Troubleshooting-Deployments.html to no avail.

Here is the code used to configure the silo


Please note when I revert back to our orleans 1.5 application on the DEV server everything works so it shouldn't be a network connectivity issue on the server.  Here are the logs of the silo starting.
[OrleansDebugLog.xlsx](https://github.com/dotnet/orleans/files/2073614/OrleansDebugLog.xlsx)

Here is the exception from the client:

> ""The target silo became unavailable for message: Request *cli/d0621ab9@97ba6db4->S10.10.92.113:30000:265920396*stg/17/00000011@S00000011 #10: . Target History is: <S10.10.92.113:30000:265920396:*stg/17/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help."" Data: {…} InnerException: null TargetSite: ""Void Throw()"" StackTrace: ""   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.OutsideRuntimeClient.<<StartInternal>b__58_2>d.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Runtime\\OutsideRuntimeClient.cs:line 249\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.OutsideRuntimeClient.<<StartInternal>g__ExecuteWithRetries58_3>d.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Runtime\\OutsideRuntimeClient.cs:line 269\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.OutsideRuntimeClient.<StartInternal>d__58.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Runtime\\OutsideRuntimeClient.cs:line 252\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.OutsideRuntimeClient.<Start>d__57.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Runtime\\OutsideRuntimeClient.cs:line 193\r\n--- End of stack trace from previous location where exception was thrown ---\r\n   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()\r\n   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)\r\n   at Orleans.ClusterClient.<Connect>d__19.MoveNext() in D:\\build\\agent\\_work\\18\\s\\src\\Orleans.Core\\Core\\ClusterClient.cs:line 120"" HelpLink: null Source: ""mscorlib"" HResult: -2146233088 Type: ""Orleans.Runtime.SiloUnavailableException""}

 Any suggestions on how I can debug this issue?  Thanks!",,benjaminpetit,,
4652,Orleans - Consul clustering,"
We have been able to successfully integrate Consul for Orleans clustering. But recently we enabled ACL (Access Control List) to restrict the access to data and api and generated a acl master token and acl agent token.

Do you have an sample of passing the token from the Orleans Silo application.

var builder = new SiloHostBuilder()
                    .Configure<ClusterOptions>(options =>
                    {
                        options.ClusterId = ""Cluster1"";
                        options.ServiceId = ""Service1"";
                    })
                    .UseServiceProviderFactory(HostStartUp.ConfigureServices)
                    .UseConsulClustering(gatewayOptions =>
                    {
                        gatewayOptions.Address =   new Uri(""http://10.203.xxx.xx:8500/"");
                    })
                    .ConfigureEndpoints(siloPort: 11112) 
                        gatewayPort: 30002 hostname: Dns.GetHostName() )
                    .AddMemoryGrainStorageAsDefault();

","Orleans - Consul clustering 
We have been able to successfully integrate Consul for Orleans clustering. But recently we enabled ACL (Access Control List) to restrict the access to data and api and generated a acl master token and acl agent token.

Do you have an sample of passing the token from the Orleans Silo application.

var builder = new SiloHostBuilder()
                    .Configure<ClusterOptions>(options =>
                    {
                        options.ClusterId = ""Cluster1"";
                        options.ServiceId = ""Service1"";
                    })
                    .UseServiceProviderFactory(HostStartUp.ConfigureServices)
                    .UseConsulClustering(gatewayOptions =>
                    {
                        gatewayOptions.Address =   new Uri(""http://10.203.xxx.xx:8500/"");
                    })
                    .ConfigureEndpoints(siloPort: 11112) 
                        gatewayPort: 30002 hostname: Dns.GetHostName() )
                    .AddMemoryGrainStorageAsDefault();

",enhancement,sergeybykov,6/06/2018 0:47,7/09/2018 17:09
4651,Overridden method OnDeactivateAsync not called if CollectionAge set in seconds range,"Dependencies:



With TimeSpan.FromMinutes( ... ); OnDeactivateAsync work as expected. ","Overridden method OnDeactivateAsync not called if CollectionAge set in seconds range Dependencies:



With TimeSpan.FromMinutes( ... ); OnDeactivateAsync work as expected. ",,benjaminpetit,,
4650,Runtime code generation does not support unicode characters like Ø,"When the code is running in the silo this happens:

.","Runtime code generation does not support unicode characters like Ø When the code is running in the silo this happens:

.",,ReubenBond,,
4647,The question of Orleans memory?,"Why does the amount of memory that goes into my Orleans service go up all the way to about 500M？

code：
 siloHost = new SiloHostBuilder()
              .Configure<ClusterOptions>(options =>
              {
                  options.ClusterId = clusterId;
                  options.ServiceId = serviceId;

              })
                 .UsePerfCounterEnvironmentStatistics()
               // .UseEnvironment(environment)
                //.ConfigureHostConfiguration(option=> {

                //})
                // .ConfigureEndpoints(System.Net.Dns.GetHostName() int.Parse(siloPort) int.Parse(gatewayPort))
                .Configure<EndpointOptions>(options =>
                {
                    options.AdvertisedIPAddress = GetLocalIp();// IPAddress.Parse(""192.168.11.143"") ;
                    options.GatewayPort = int.Parse(gatewayPort);
                    options.SiloPort = int.Parse(siloPort);
                })
              //.Configure<LoadSheddingOptions>(op =>
              //{
              //    op.LoadSheddingEnabled = true;
              //    op.LoadSheddingLimit = 90;
              //})
              .Configure<GrainCollectionOptions>(options =>
              {
                  //配置grain的回收
                  options.CollectionAge = TimeSpan.FromMinutes(10);
                  options.CollectionQuantum = TimeSpan.FromMinutes(5);
              })
              //.Configure<PerformanceTuningOptions>(option =>
              //{
              //    option.UseNagleAlgorithm = true;
              //    option.MinDotNetThreadPoolSize = 90;
              //})

              .UseAdoNetClustering(options =>
              {
                  options.ConnectionString = DBConnStr;
                  options.Invariant = ""System.Data.SqlClient"";
              })
              // .ConfigureApplicationParts(parts => parts.AddApplicationPart(typeof(IProduct).Assembly).WithReferences())
              .ConfigureLogging(logging =>
              {
                  logging.AddFile(logPath + $""\\OrleansSilos -{ DateTime.Now.ToString(""yyyy.MM.dd"")}.txt"");
                  logging.SetMinimumLevel((LogLevel) Enum.Parse(typeof(LogLevel) logLevel));
              })
              .Build();
            siloHost.StartAsync().Wait();","The question of Orleans memory? Why does the amount of memory that goes into my Orleans service go up all the way to about 500M？

code：
 siloHost = new SiloHostBuilder()
              .Configure<ClusterOptions>(options =>
              {
                  options.ClusterId = clusterId;
                  options.ServiceId = serviceId;

              })
                 .UsePerfCounterEnvironmentStatistics()
               // .UseEnvironment(environment)
                //.ConfigureHostConfiguration(option=> {

                //})
                // .ConfigureEndpoints(System.Net.Dns.GetHostName() int.Parse(siloPort) int.Parse(gatewayPort))
                .Configure<EndpointOptions>(options =>
                {
                    options.AdvertisedIPAddress = GetLocalIp();// IPAddress.Parse(""192.168.11.143"") ;
                    options.GatewayPort = int.Parse(gatewayPort);
                    options.SiloPort = int.Parse(siloPort);
                })
              //.Configure<LoadSheddingOptions>(op =>
              //{
              //    op.LoadSheddingEnabled = true;
              //    op.LoadSheddingLimit = 90;
              //})
              .Configure<GrainCollectionOptions>(options =>
              {
                  //配置grain的回收
                  options.CollectionAge = TimeSpan.FromMinutes(10);
                  options.CollectionQuantum = TimeSpan.FromMinutes(5);
              })
              //.Configure<PerformanceTuningOptions>(option =>
              //{
              //    option.UseNagleAlgorithm = true;
              //    option.MinDotNetThreadPoolSize = 90;
              //})

              .UseAdoNetClustering(options =>
              {
                  options.ConnectionString = DBConnStr;
                  options.Invariant = ""System.Data.SqlClient"";
              })
              // .ConfigureApplicationParts(parts => parts.AddApplicationPart(typeof(IProduct).Assembly).WithReferences())
              .ConfigureLogging(logging =>
              {
                  logging.AddFile(logPath + $""\\OrleansSilos -{ DateTime.Now.ToString(""yyyy.MM.dd"")}.txt"");
                  logging.SetMinimumLevel((LogLevel) Enum.Parse(typeof(LogLevel) logLevel));
              })
              .Build();
            siloHost.StartAsync().Wait();",question,ReubenBond,,
4646,Orleans 1.5.2 - Grain doesn't de-activate on InconsistentStateException from timer tick,Hi I have a grain that performs periodic work using a grain timer (not reminder) and I noticed in Orleans code that only grain messages are checked for  in order to de-activate the grain but for timer ticks it's not the case. I find it a bug since I expect the de-activation behavior to take place for timers as well.,Orleans 1.5.2 - Grain doesn't de-activate on InconsistentStateException from timer tick Hi I have a grain that performs periodic work using a grain timer (not reminder) and I noticed in Orleans code that only grain messages are checked for  in order to de-activate the grain but for timer ticks it's not the case. I find it a bug since I expect the de-activation behavior to take place for timers as well.,Hacktoberfest,benjaminpetit,,
4645,Update Dependency-Injection.md,fixed the typo.,Update Dependency-Injection.md fixed the typo.,documentation,xiazen,,
4637,Orleans Client 1.5.2 issue with .NET PerformanceCounter constructor,"We (@amccool) have a Windows Service that is an Orleans Client. The service startup initializes the Orleans Client and on some VMs this is causing a timeout (from the Service Control Manager) and silent failure - no errors in logs (Orleans/text) no Windows Event other than the usual System one: ""A timeout was reached (30000 milliseconds) while waiting for the XXX service to connect"".

The program never has this issue when you run it on a command line it only fails like this as a service. The service is running as ""SYSTEM"" but changing the ""Log On"" has no effect . The program does not have this problem on every VM nor on my development machine.

I tracked the error down to the class RuntimeStatisticsGroup and its InitCpuMemoryCounters method. This line:

Orleans 1.5.2 sources [HERE](https://github.com/dotnet/orleans/blob/d5ea8dc4e0ef104562a05fe05ce9a3abb181c271/src/Orleans/Statistics/RuntimeStatisticsGroup.cs#L89).
_sometimes_ does not return within 30 seconds; pretty much ever-other-time I start the service about 50% of the time.

I found this related issue on [MSDN](https://social.msdn.microsoft.com/Forums/en-US/cd6adebf-231d-40a8-842f-ba06e849889e/ccli-performancecounter-constructor-is-really-slow?forum=vcgeneral).

Sure enough if I hack the Orleans source to use the empty/default constructor then the service does not timeout on that line although I assume we would still eventually run into some kind of timeout once ""NextValue"" gets called - I haven't mangled my copy of the Orleans Client to test that yet. My hope would be that I can get the service started and whatever failure happens after that would at least get logged.

Is there some way to configure the ClientConfiguration to disable the Performance Counter setup? Windows Performance Counters are notoriously fragile and hard to work with...
","Orleans Client 1.5.2 issue with .NET PerformanceCounter constructor We (@amccool) have a Windows Service that is an Orleans Client. The service startup initializes the Orleans Client and on some VMs this is causing a timeout (from the Service Control Manager) and silent failure - no errors in logs (Orleans/text) no Windows Event other than the usual System one: ""A timeout was reached (30000 milliseconds) while waiting for the XXX service to connect"".

The program never has this issue when you run it on a command line it only fails like this as a service. The service is running as ""SYSTEM"" but changing the ""Log On"" has no effect . The program does not have this problem on every VM nor on my development machine.

I tracked the error down to the class RuntimeStatisticsGroup and its InitCpuMemoryCounters method. This line:

Orleans 1.5.2 sources [HERE](https://github.com/dotnet/orleans/blob/d5ea8dc4e0ef104562a05fe05ce9a3abb181c271/src/Orleans/Statistics/RuntimeStatisticsGroup.cs#L89).
_sometimes_ does not return within 30 seconds; pretty much ever-other-time I start the service about 50% of the time.

I found this related issue on [MSDN](https://social.msdn.microsoft.com/Forums/en-US/cd6adebf-231d-40a8-842f-ba06e849889e/ccli-performancecounter-constructor-is-really-slow?forum=vcgeneral).

Sure enough if I hack the Orleans source to use the empty/default constructor then the service does not timeout on that line although I assume we would still eventually run into some kind of timeout once ""NextValue"" gets called - I haven't mangled my copy of the Orleans Client to test that yet. My hope would be that I can get the service started and whatever failure happens after that would at least get logged.

Is there some way to configure the ClientConfiguration to disable the Performance Counter setup? Windows Performance Counters are notoriously fragile and hard to work with...
",,benjaminpetit,,
4636,[Migration from 1.4.2 to 2.0] Could there be incompatibility issues during deployment when upgrade is taking place?,"We are currently using Orleans 1.4.2 and upgrading the solution to Orleans 2.0.0. Ours is an Azure Cloud Service with multiple client and Silo instances.
When we will be deploying the latest build with upgraded version of Orleans there could be some instances still up and working on Orleans 1.4.2 while others on 2.0.0. The concern is the potential incompatibility between these instances (could be because of a change in wire protocol or something else). It would be great if you can help in highlighting any such potential incompatibility and possible workarounds.

Thanks","[Migration from 1.4.2 to 2.0] Could there be incompatibility issues during deployment when upgrade is taking place? We are currently using Orleans 1.4.2 and upgrading the solution to Orleans 2.0.0. Ours is an Azure Cloud Service with multiple client and Silo instances.
When we will be deploying the latest build with upgraded version of Orleans there could be some instances still up and working on Orleans 1.4.2 while others on 2.0.0. The concern is the potential incompatibility between these instances (could be because of a change in wire protocol or something else). It would be great if you can help in highlighting any such potential incompatibility and possible workarounds.

Thanks",,benjaminpetit,,
4635,AlwaysInterleave mode request timeout?,"This problem occurs when traffic suddenly rises，All requested Grain PrimaryKeys are the same.

Interface：
","AlwaysInterleave mode request timeout? This problem occurs when traffic suddenly rises，All requested Grain PrimaryKeys are the same.

Interface：
",,ReubenBond,,
4634,how do build distrubuted base on orleans framewrok,,how do build distrubuted base on orleans framewrok ,question,sergeybykov,29/05/2018 14:35,13/07/2018 4:03
4630,Silo Dead,"In a two silos cluster we got the following in the log of one of them
[2018-05-26 22:14:34.069 GMT    44	WARNING	100150	Watchdog	10.1.0.6:22222]	.NET Runtime Platform stalled for 00:00:02.3323971 - possibly GC? We are now using total of 487MB memory. gc=330899 131795 2104	
after that with about three minutes the silo failed.
this is a log of this silo

[----APP-01-2018-05-24-11.39.24.307Z.zip](https://github.com/dotnet/orleans/files/2042566/----APP-01-2018-05-24-11.39.24.307Z.zip)

the other silo log is
[APP-01-2018-05-24-11.39.29.339Z.zip](https://github.com/dotnet/orleans/files/2042568/APP-01-2018-05-24-11.39.29.339Z.zip)

","Silo Dead In a two silos cluster we got the following in the log of one of them
[2018-05-26 22:14:34.069 GMT    44	WARNING	100150	Watchdog	10.1.0.6:22222]	.NET Runtime Platform stalled for 00:00:02.3323971 - possibly GC? We are now using total of 487MB memory. gc=330899 131795 2104	
after that with about three minutes the silo failed.
this is a log of this silo

[----APP-01-2018-05-24-11.39.24.307Z.zip](https://github.com/dotnet/orleans/files/2042566/----APP-01-2018-05-24-11.39.24.307Z.zip)

the other silo log is
[APP-01-2018-05-24-11.39.29.339Z.zip](https://github.com/dotnet/orleans/files/2042568/APP-01-2018-05-24-11.39.29.339Z.zip)

",question,sergeybykov,27/05/2018 21:36,9/06/2018 5:53
4629,Optimize removing consumed buffers from read buffer,Remove O(n^2) buffer cleanup logic.,Optimize removing consumed buffers from read buffer Remove O(n^2) buffer cleanup logic.,performance,benjaminpetit,,
4628,Cleanup pass on Transaction abstractions and public surface.,#NAME?,"Cleanup pass on Transaction abstractions and public surface. - Removed leftover code from singleton TM.
- Moves agent abtraction from core to runtime abstractions
- Cleaned up agent initialization and usage pattern
- Reduced public surface of transactional state abstraction
- Moved transaction info out of abstractions
- Removed old unsused logging errorcodes.
- Moved serialization generation assembly statements to files that defined the serializable classes.",enhancement,xiazen,,
4625,Orleans Documentation Tech Writer,"Hi! My name is Jill Headen and I've been brought onto the Orleans team at Microsoft to improve the documentation for this project. I thought I'd start out by asking you what you want. Please feel free to send me suggestions ideas links etc. 
I'm in the process of setting up my development environment and getting some hands-on experience with Orleans so if you have tips for me about that please let me know. 

Update:
As I work through the Documentation-tagged issues I am going to compile general reminders for myself here such as:

- add ""last edited: 5 June 2018"" information to the bottom of my edited pages.
","Orleans Documentation Tech Writer Hi! My name is Jill Headen and I've been brought onto the Orleans team at Microsoft to improve the documentation for this project. I thought I'd start out by asking you what you want. Please feel free to send me suggestions ideas links etc. 
I'm in the process of setting up my development environment and getting some hands-on experience with Orleans so if you have tips for me about that please let me know. 

Update:
As I work through the Documentation-tagged issues I am going to compile general reminders for myself here such as:

- add ""last edited: 5 June 2018"" information to the bottom of my edited pages.
",documentation,JillHeaden,25/05/2018 1:48,
4624,environment connections,"server
   var siloPort = 20028;
            int gatewayPort = 30020;
            var siloAddress = IPAddress.Parse(""0.0.0.0"");// IPAddress.Loopback;
            var builder = new SiloHostBuilder()
                .UseEnvironment(""Development"")
                 .Configure<ClusterOptions>(options =>
                 {
                     options.ClusterId = ""test1"";
                     options.ServiceId = ""test1"";
                 })
                .UseDevelopmentClustering(options => options.PrimarySiloEndpoint = new IPEndPoint(siloAddress siloPort))
                .ConfigureEndpoints(siloAddress siloPort gatewayPort)
                 .ConfigureApplicationParts(parts => parts.AddApplicationPart(typeof(Test).Assembly).WithReferences());

client 
   var siloAddress = ""127.0.0.1""; //IPAddress.Loopback; 
                    var gatewayPort = 30020;
                    var uri = (new IPEndPoint(IPAddress.Parse(siloAddress) gatewayPort)).ToGatewayUri();
                    client = new ClientBuilder()
                        .ConfigureDefaults()
                       // .UseLocalhostClustering(gatewayPort)
                       .Configure<ClusterOptions>(opt =>
                       {
                           opt.ClusterId = ""test1"";
                           opt.ServiceId = ""test1"";
                       })
                        ////集群
                        .UseStaticClustering(options => options.Gateways.Add(uri))//集群  
                        .ConfigureApplicationParts(parts => parts.AddApplicationPart(typeof(ITest).Assembly).WithReferences())

server
 var siloAddress = IPAddress.Parse(""0.0.0.0"");      Can connect but cannot get information
 var siloAddress=IPAddress.Loopback;     Cannot connect service Should be server port listening failed

can you tell me the reason？
I want to test the deployment of the production environment，A silo A client silo is deployed on the server，Local test is normal access

","environment connections server
   var siloPort = 20028;
            int gatewayPort = 30020;
            var siloAddress = IPAddress.Parse(""0.0.0.0"");// IPAddress.Loopback;
            var builder = new SiloHostBuilder()
                .UseEnvironment(""Development"")
                 .Configure<ClusterOptions>(options =>
                 {
                     options.ClusterId = ""test1"";
                     options.ServiceId = ""test1"";
                 })
                .UseDevelopmentClustering(options => options.PrimarySiloEndpoint = new IPEndPoint(siloAddress siloPort))
                .ConfigureEndpoints(siloAddress siloPort gatewayPort)
                 .ConfigureApplicationParts(parts => parts.AddApplicationPart(typeof(Test).Assembly).WithReferences());

client 
   var siloAddress = ""127.0.0.1""; //IPAddress.Loopback; 
                    var gatewayPort = 30020;
                    var uri = (new IPEndPoint(IPAddress.Parse(siloAddress) gatewayPort)).ToGatewayUri();
                    client = new ClientBuilder()
                        .ConfigureDefaults()
                       // .UseLocalhostClustering(gatewayPort)
                       .Configure<ClusterOptions>(opt =>
                       {
                           opt.ClusterId = ""test1"";
                           opt.ServiceId = ""test1"";
                       })
                        ////集群
                        .UseStaticClustering(options => options.Gateways.Add(uri))//集群  
                        .ConfigureApplicationParts(parts => parts.AddApplicationPart(typeof(ITest).Assembly).WithReferences())

server
 var siloAddress = IPAddress.Parse(""0.0.0.0"");      Can connect but cannot get information
 var siloAddress=IPAddress.Loopback;     Cannot connect service Should be server port listening failed

can you tell me the reason？
I want to test the deployment of the production environment，A silo A client silo is deployed on the server，Local test is normal access

",,ReubenBond,,
4622,SiloHost ResponseTimeout won't let me change it from 30 seconds,"We have some grain methods that take longer than 30 seconds to execute so I am trying to set the response timeout to 2 minutes. I set it on the config.Globals.ResponseTimeout and pass that config object to the SiloHost and then call InitializeOrleansSilo(). Which runs and resets the ResponseTimeout back to 30 seconds.

We've tried setting it in our config.xml file as well to no avail. What am I doing wrong here?","SiloHost ResponseTimeout won't let me change it from 30 seconds We have some grain methods that take longer than 30 seconds to execute so I am trying to set the response timeout to 2 minutes. I set it on the config.Globals.ResponseTimeout and pass that config object to the SiloHost and then call InitializeOrleansSilo(). Which runs and resets the ResponseTimeout back to 30 seconds.

We've tried setting it in our config.xml file as well to no avail. What am I doing wrong here?",,ReubenBond,,
4621,Stream data adapter,"Custom handling of the conversion of application data to and from the underlying queue is a common concern for users of  Orleans persistent streams.  There are many reasons for this:

* The default conversion logic does not handle schema changes for event data or changes to the Orleans data structures so if an application alters the contents of the persisted events or the Orleans team changes how the events are wrapped the old events will become unreadable.
* Without changes to the conversion application developers cannot read/process events using streaming for pre-existing queues or data written to queues by other processes.
* Without changes to the conversion application developers cannot write events in formats suitable for pre-existing systems or external consumers.

Some stream providers like azure queue memory and eventhub provide some support for custom data conversion but there is no common pattern and some patterns are quite painful.

Given that **_every_** internal service using Orleans persistent streams has had to customize their handling of queue data for one of the above reasons and in every case it’s made the use of Orleans persistent stream significantly more complicated I am of the opinion that addressing this should be a fairly high priority.","Stream data adapter Custom handling of the conversion of application data to and from the underlying queue is a common concern for users of  Orleans persistent streams.  There are many reasons for this:

* The default conversion logic does not handle schema changes for event data or changes to the Orleans data structures so if an application alters the contents of the persisted events or the Orleans team changes how the events are wrapped the old events will become unreadable.
* Without changes to the conversion application developers cannot read/process events using streaming for pre-existing queues or data written to queues by other processes.
* Without changes to the conversion application developers cannot write events in formats suitable for pre-existing systems or external consumers.

Some stream providers like azure queue memory and eventhub provide some support for custom data conversion but there is no common pattern and some patterns are quite painful.

Given that **_every_** internal service using Orleans persistent streams has had to customize their handling of queue data for one of the above reasons and in every case it’s made the use of Orleans persistent stream significantly more complicated I am of the opinion that addressing this should be a fairly high priority.",P2,jason-bragg,,
4620,Error when client tries to communicate with silo: Gateway received unexpected non-proxied connection,"Please see this repo that should help replicate the issue. The README should explain the issue and reproduction steps in detail:

https://github.com/petargyurov/orleans-gateway-issue/tree/master

There has been some discussion on Gitter with @benjaminpetit already.


Thanks.","Error when client tries to communicate with silo: Gateway received unexpected non-proxied connection Please see this repo that should help replicate the issue. The README should explain the issue and reproduction steps in detail:

https://github.com/petargyurov/orleans-gateway-issue/tree/master

There has been some discussion on Gitter with @benjaminpetit already.


Thanks.",,benjaminpetit,,
4618,Skip TransactionWillRecoverAfterRandomSiloUnGracefulShutdown (see #4617),I see this failing a lot in VSO,Skip TransactionWillRecoverAfterRandomSiloUnGracefulShutdown (see #4617) I see this failing a lot in VSO,,xiazen,,
4617,[Test] TransactionWillRecoverAfterRandomSiloUnGracefulShutdown fails frequently,,[Test] TransactionWillRecoverAfterRandomSiloUnGracefulShutdown fails frequently ,P1,jason-bragg,,
4614,Added correctness checks to recovery testing,,Added correctness checks to recovery testing ,,xiazen,,
4612,WriteStateAsync() works a lot slower since upgrading to Orleans2,"Since upgrading to Orleans2 we have had general slowness in writing grain state. We tried to pin down the issue and we gauged the time it took for us to write jsons of about 1mb each to azure blob storage and the mean went up from about 100ms to 400ms in peak times. 
We looked in the blob storage to see if the data got any larger but it was about the same size (1mb).
We suspected the upgrade to orleans2 to be the cause and when we downgraded back to orleans1 the write time got back to normal (this was the only change we made) so if the cause was something else the downgrade should not have effected this.

This is the graph of the  time from one of our grains ""expert-grain"":
![screen shot 2018-05-20 at 15 11 21](https://user-images.githubusercontent.com/10612685/40278772-1790bb16-5c40-11e8-902e-57e1159c0be7.png)


We noticed that after restarting the nodes the write time goes down for a few hours before going up again (we used a script to restart the nodes every 4 hours for that reason).

Any suggestions to how we can investigate this further?","WriteStateAsync() works a lot slower since upgrading to Orleans2 Since upgrading to Orleans2 we have had general slowness in writing grain state. We tried to pin down the issue and we gauged the time it took for us to write jsons of about 1mb each to azure blob storage and the mean went up from about 100ms to 400ms in peak times. 
We looked in the blob storage to see if the data got any larger but it was about the same size (1mb).
We suspected the upgrade to orleans2 to be the cause and when we downgraded back to orleans1 the write time got back to normal (this was the only change we made) so if the cause was something else the downgrade should not have effected this.

This is the graph of the  time from one of our grains ""expert-grain"":
![screen shot 2018-05-20 at 15 11 21](https://user-images.githubusercontent.com/10612685/40278772-1790bb16-5c40-11e8-902e-57e1159c0be7.png)


We noticed that after restarting the nodes the write time goes down for a few hours before going up again (we used a script to restart the nodes every 4 hours for that reason).

Any suggestions to how we can investigate this further?",,jason-bragg,,
4611,How to deploy Orleans client and silos to SF as containers?,"How to deploy Orleans client and silos to SF as containers?
The question is how to configure the cluster and gateway settings?
I haven't find any sample. 

Thanks","How to deploy Orleans client and silos to SF as containers? How to deploy Orleans client and silos to SF as containers?
The question is how to configure the cluster and gateway settings?
I haven't find any sample. 

Thanks",documentation,ReubenBond,,
4610,memory consumption non equal,"i have two silos running on the same machine with sql membership database one of the two silos is consuming more memory  than the other(14 g and .9 g)
while the grains are balanced nearly equal 
is there some silo responsible for some function that i do not know about ?
i know there is no primary concept in case of membership database.
why is this happening ?

","memory consumption non equal i have two silos running on the same machine with sql membership database one of the two silos is consuming more memory  than the other(14 g and .9 g)
while the grains are balanced nearly equal 
is there some silo responsible for some function that i do not know about ?
i know there is no primary concept in case of membership database.
why is this happening ?

",,ReubenBond,,
4607,SerializationManager measures ticks not milliseconds,"The serialization manager measures the ticks: https://github.com/dotnet/orleans/blob/e87f0e458d36dccf145de06295475831331ff0bf/src/Orleans.Core/Serialization/SerializationManager.cs#L609

But the counter says: Serialization.Body.DeepCopy.Milliseconds.Current
","SerializationManager measures ticks, not milliseconds The serialization manager measures the ticks: https://github.com/dotnet/orleans/blob/e87f0e458d36dccf145de06295475831331ff0bf/src/Orleans.Core/Serialization/SerializationManager.cs#L609

But the counter says: Serialization.Body.DeepCopy.Milliseconds.Current
",,ReubenBond,,
4604,Cluster-to-Cluster communication extensibility,"I want to use Orleans Multi-cluster feature but I am hitting a road block.  I want to build a primary and failover cluster and use event sourcing to synchronize the cluster.  The problem is that I cannot set up a VPN between the two cluster.  Being able to synchronized clusters without an exposed gateway is a very valid and important scenario.

I was trying to figure out if I can extend and plug in an alternate ILogConsistencyProtocolGateway which will make calls to the other cluster through [Service Bus relays](https://docs.microsoft.com/en-us/azure/service-bus-relay/relay-hybrid-connections-http-requests-dotnet-get-started).  I difficulty because some interfaces are internal only.

What I am looking for is to be able to write implementations for the interfaces below and override the default implementation.  This was I can use other technologies proxy or relay the calls into the remote cluster.



","Cluster-to-Cluster communication extensibility I want to use Orleans Multi-cluster feature but I am hitting a road block.  I want to build a primary and failover cluster and use event sourcing to synchronize the cluster.  The problem is that I cannot set up a VPN between the two cluster.  Being able to synchronized clusters without an exposed gateway is a very valid and important scenario.

I was trying to figure out if I can extend and plug in an alternate ILogConsistencyProtocolGateway which will make calls to the other cluster through [Service Bus relays](https://docs.microsoft.com/en-us/azure/service-bus-relay/relay-hybrid-connections-http-requests-dotnet-get-started).  I difficulty because some interfaces are internal only.

What I am looking for is to be able to write implementations for the interfaces below and override the default implementation.  This was I can use other technologies proxy or relay the calls into the remote cluster.



",enhancement,benjaminpetit,,
4603,Test MetaData can be (de)serialzied,,Test MetaData can be (de)serialzied ,,ReubenBond,,
4602,Enable tx recovery tests,I forgot to enable these tests..,Enable tx recovery tests I forgot to enable these tests..,,jason-bragg,,
4601,NuGet Client and Server Collections not updated with 2.0.3 release,"The 2.0.3 release was a patch update that published updated packages for the code generator and runtime/core. If the Microsoft.Orleans.Server and/or Microsoft.Orleans.Client collections are used to provide the runtime then the code generator is updated but the runtime is not.

Behavior: When updating to the latest versions a mismatch is created and attempting to run with the two different versions causes an exception to be thrown:
 with code that works fine with the 2.0.0 generator.

Expected: Server and Client collections should be updated anytime a ""child"" package is updated","NuGet Client and Server Collections not updated with 2.0.3 release The 2.0.3 release was a patch update that published updated packages for the code generator and runtime/core. If the Microsoft.Orleans.Server and/or Microsoft.Orleans.Client collections are used to provide the runtime then the code generator is updated but the runtime is not.

Behavior: When updating to the latest versions a mismatch is created and attempting to run with the two different versions causes an exception to be thrown:
 with code that works fine with the 2.0.0 generator.

Expected: Server and Client collections should be updated anytime a ""child"" package is updated",bug,benjaminpetit,,
4600,Grain activation,"Hello
Few queries on grain activation:

1) Lets assume we have an application deployed in a cluster of three silos. Client connected to a silo and have grain activation with it. And now if that silo goes down for some reason does orleans framework create entirely new grain activation in other silo? Will grain have new primary key?
2) I have been experimenting explict stream subscription with RabbitMQ. 

	And my application looke likes this:
	**SILOHOST** 

			1.  CommandBusGrain 	
                             1.  OnactivateAsync creates a stream (stream id: GUID.Empty)
                             2.  Register method does subscription to the stream
                             3.  Send method publish message to stream (that is _stream.OnNextAsync(msg))
			2.  On silo startup
                             1.  calls CommandBusGrain register method to initiate subscription
			
			
    **SILO Client**

			1.  Create CommandBusGrain reference (Graind id: GUID.Empty)
			2.  Triggers ""Send"" method to publish message.

		
     This works fine but I need some suggestion on whether to call grain method to publish message to 
     the stream or create stream reference in the client and publish message directly to stream instead of 
     calling grain.
     Which one would be a better implementation?","Grain activation Hello
Few queries on grain activation:

1) Lets assume we have an application deployed in a cluster of three silos. Client connected to a silo and have grain activation with it. And now if that silo goes down for some reason does orleans framework create entirely new grain activation in other silo? Will grain have new primary key?
2) I have been experimenting explict stream subscription with RabbitMQ. 

	And my application looke likes this:
	**SILOHOST** 

			1.  CommandBusGrain 	
                             1.  OnactivateAsync creates a stream (stream id: GUID.Empty)
                             2.  Register method does subscription to the stream
                             3.  Send method publish message to stream (that is _stream.OnNextAsync(msg))
			2.  On silo startup
                             1.  calls CommandBusGrain register method to initiate subscription
			
			
    **SILO Client**

			1.  Create CommandBusGrain reference (Graind id: GUID.Empty)
			2.  Triggers ""Send"" method to publish message.

		
     This works fine but I need some suggestion on whether to call grain method to publish message to 
     the stream or create stream reference in the client and publish message directly to stream instead of 
     calling grain.
     Which one would be a better implementation?",question,sergeybykov,17/05/2018 2:23,20/06/2018 2:17
4598,Fix bug where Issue is never assigned and retry delays never happen,The class is RecordedConnectionIssue never assigns the Issue property which causes DelayBeforeRetry() to never delay.,Fix bug where Issue is never assigned and retry delays never happen The class is RecordedConnectionIssue never assigns the Issue property which causes DelayBeforeRetry() to never delay.,,ReubenBond,,
4596,Remove unused tx metrics,TransactionsStatisticsGroup.cs  was used by single TM and is currently not used in the system. delete to clean the code base up ,Remove unused tx metrics TransactionsStatisticsGroup.cs  was used by single TM and is currently not used in the system. delete to clean the code base up ,,jason-bragg,,
4595,Transaction concurrency tests,#NAME?,Transaction concurrency tests - failing against memory storage unclear why.  Tests disabled will open bug,testing,xiazen,,
4594,EHStatistics_MonitorCalledAccordingly intermitently failing,"ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.EHStatistics_MonitorCalledAccordingly fails intermittently.

Stacktrace
MESSAGE:
Assert.True() Failure\r\nExpected: True\r\nActual: False
+++++++++++++++++++
STACK TRACE:
at ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.AssertCacheMonitorCallCounters(CacheMonitorCounters totalCacheMonitorCallCounters) in D:\j\workspace\functional_pr---83d31c72\test\Extensions\ServiceBus.Tests\StatisticMonitorTests\EHStatisticMonitorTests.cs:line 118 at ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.<EHStatistics_MonitorCalledAccordingly>d__9.MoveNext() in D:\j\workspace\functional_pr---83d31c72\test\Extensions\ServiceBus.Tests\StatisticMonitorTests\EHStatisticMonitorTests.cs:line 103 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","EHStatistics_MonitorCalledAccordingly intermitently failing ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.EHStatistics_MonitorCalledAccordingly fails intermittently.

Stacktrace
MESSAGE:
Assert.True() Failure\r\nExpected: True\r\nActual: False
+++++++++++++++++++
STACK TRACE:
at ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.AssertCacheMonitorCallCounters(CacheMonitorCounters totalCacheMonitorCallCounters) in D:\j\workspace\functional_pr---83d31c72\test\Extensions\ServiceBus.Tests\StatisticMonitorTests\EHStatisticMonitorTests.cs:line 118 at ServiceBus.Tests.MonitorTests.EHStatisticMonitorTests.<EHStatistics_MonitorCalledAccordingly>d__9.MoveNext() in D:\j\workspace\functional_pr---83d31c72\test\Extensions\ServiceBus.Tests\StatisticMonitorTests\EHStatisticMonitorTests.cs:line 103 --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) --- End of stack trace from previous location where exception was thrown --- at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,jason-bragg,16/05/2018 0:40,
4593,Unexpected token '100' introducing type specifier,"We're getting strange error from our web app that uses Orleans.Client. The strange thing is that app works it calls Orleans cluster and gets response but spikes to ~50% cpu every 5 minutes and writes this error to log every second or so.
","Unexpected token '100' introducing type specifier We're getting strange error from our web app that uses Orleans.Client. The strange thing is that app works it calls Orleans cluster and gets response but spikes to ~50% cpu every 5 minutes and writes this error to log every second or so.
",P2,ReubenBond,,
4592,Fix tx recovery test intermittent failure,"- removed unused testing method for old singleTM
- change stop silo method from ungracefully shutdown to gracefully shutdown. Recovery tests was failed before because silos are shutdown ungracefully and alive silos somehow still keep sending those requests to the dead silo and get time out exception back. So I think it is failing because clustering isn't recovering from ungracefully shutdown instead of tx isn't recovering. So to tests tx recovery in a clean box I think shutdown silo gracefully is the right way. In this way tx will be the only one which need to recovery the test won't be testing clustering recovery. ","Fix tx recovery test intermittent failure - removed unused testing method for old singleTM
- change stop silo method from ungracefully shutdown to gracefully shutdown. Recovery tests was failed before because silos are shutdown ungracefully and alive silos somehow still keep sending those requests to the dead silo and get time out exception back. So I think it is failing because clustering isn't recovering from ungracefully shutdown instead of tx isn't recovering. So to tests tx recovery in a clean box I think shutdown silo gracefully is the right way. In this way tx will be the only one which need to recovery the test won't be testing clustering recovery. ",,jason-bragg,,
4591,Generate correct serializer for TransactionParticipantExtensionWrapper,TransactionParticipantExtensionWrapper is serialized as part of StorageBatch Metadata need to generate correct serializer for it otherwise gets serialization exception when trying to (de)serialization StorageBatch Metadata,Generate correct serializer for TransactionParticipantExtensionWrapper TransactionParticipantExtensionWrapper is serialized as part of StorageBatch Metadata need to generate correct serializer for it otherwise gets serialization exception when trying to (de)serialization StorageBatch Metadata,,jason-bragg,,
4589,Orleans.Configuration.Validators.ClientClusteringValidator.ClusterIdNotConfigured,"Hi

When I was trying using local development configuration to set up a server I got an error 

And the sentry exception log is https://sentry.io/share/issue/d4d5026ae2ca44f29528d1b3d784f763/ .

Thank you.","Orleans.Configuration.Validators.ClientClusteringValidator.ClusterIdNotConfigured Hi

When I was trying using local development configuration to set up a server I got an error 

And the sentry exception log is https://sentry.io/share/issue/d4d5026ae2ca44f29528d1b3d784f763/ .

Thank you.",,benjaminpetit,,
4588,Why is Microsoft.Orleans.Clustering.ServiceFabric not available for v2.0.0?,"Why is Microsoft.Orleans.Clustering.ServiceFabric not available for v2.0.0?

It is available for v2.0.0-rc2 but not v2.0.0.","Why is Microsoft.Orleans.Clustering.ServiceFabric not available for v2.0.0? Why is Microsoft.Orleans.Clustering.ServiceFabric not available for v2.0.0?

It is available for v2.0.0-rc2 but not v2.0.0.",question,ReubenBond,,
4585,code generation fails with dotnet 2.1 rc1,"This is a console app. 

Orleans-CodeGen - Generating file C:\Games\aigame\Game\Server\obj\Debug\netcoreapp2.1\Server.orleans.g.cs
1>-- Code Generation FAILED --
1>
1>Exc level 0: System.IO.FileNotFoundException: Could not load file or assembly 'System.Runtime Version=4.2.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
1>   at System.ModuleHandle.ResolveType(RuntimeModule module Int32 typeToken IntPtr* typeInstArgs Int32 typeInstCount IntPtr* methodInstArgs Int32 methodInstCount ObjectHandleOnStack type)
1>   at System.ModuleHandle.ResolveTypeHandleInternal(RuntimeModule module Int32 typeToken RuntimeTypeHandle[] typeInstantiationContext RuntimeTypeHandle[] methodInstantiationContext)
1>   at System.Reflection.RuntimeModule.ResolveType(Int32 metadataToken Type[] genericTypeArguments Type[] genericMethodArguments)
1>   at System.Reflection.CustomAttribute.FilterCustomAttributeRecord(CustomAttributeRecord caRecord MetadataImport scope Assembly& lastAptcaOkAssembly RuntimeModule decoratedModule MetadataToken decoratedToken RuntimeType attributeFilterType Boolean mustBeInheritable Object[] attributes IList derivedAttributes RuntimeType& attributeType IRuntimeMethodInfo& ctor Boolean& ctorHasParameters Boolean& isVarArg)
1>   at System.Reflection.CustomAttribute.GetCustomAttributes(RuntimeModule decoratedModule Int32 decoratedMetadataToken Int32 pcaCount RuntimeType attributeFilterType Boolean mustBeInheritable IList derivedAttributes Boolean isDecoratedTargetSecurityTransparent)
1>   at System.Reflection.CustomAttribute.GetCustomAttributes(RuntimeAssembly assembly RuntimeType caType)
1>   at System.Attribute.GetCustomAttributes(Assembly element Type attributeType Boolean inherit)
1>   at System.Reflection.CustomAttributeExtensions.GetCustomAttributes[T](Assembly element)
1>   at Orleans.ApplicationParts.AssemblyAttributeFeatureProvider1 parts TFeature feature) in D:\build\agent\_work\18\s\src\Orleans.Core\ApplicationParts\AssemblyAttributeFeatureProvider.cs:line 41
1>   at Orleans.ApplicationParts.ApplicationPartManager.PopulateFeature[TFeature](TFeature feature) in D:\build\agent\_work\18\s\src\Orleans.Core\ApplicationParts\ApplicationPartManager.cs:line 49
1>   at Orleans.ApplicationPartManagerExtensions.CreateAndPopulateFeature[TFeature](IApplicationPartManager applicationPartManager) in D:\build\agent\_work\18\s\src\Orleans.Core\ApplicationParts\ApplicationPartManagerExtensions.cs:line 60
1>   at Orleans.CodeGenerator.RoslynCodeGenerator..ctor(IApplicationPartManager partManager ILoggerFactory loggerFactory) in D:\build\agent\_work\18\s\src\Orleans.CodeGeneration\RoslynCodeGenerator.cs:line 43
1>   at Orleans.CodeGeneration.CodeGenerator.GenerateSourceForAssembly(Assembly grainAssembly LogLevel logLevel)
1>   at Orleans.CodeGeneration.CodeGenerator.GenerateCodeInternal(CodeGenOptions options)
1>   at Orleans.CodeGeneration.CodeGenerator.GenerateCode(CodeGenOptions options)
1>   at Orleans.CodeGeneration.Program.Main(String[] args)
1>C:\Users\chris\.nuget\packages\microsoft.orleans.orleanscodegenerator.build\2.0.3\build\Microsoft.Orleans.OrleansCodeGenerator.Build.targets(765): error MSB3073: The command """"dotnet"" ""C:\Users\chris\.nuget\packages\microsoft.orleans.orleanscodegenerator.build\2.0.3\build\..\tasks\netcoreapp2.0\Orleans.CodeGeneration.Build.dll"" ""@obj\Debug\netcoreapp2.1\codegen\Server.orleans.g.args.txt"""" exited with code 3.
1>Done building project ""Server.csproj"" -- FAILED.","code generation fails with dotnet 2.1 rc1 This is a console app. 

Orleans-CodeGen - Generating file C:\Games\aigame\Game\Server\obj\Debug\netcoreapp2.1\Server.orleans.g.cs
1>-- Code Generation FAILED --
1>
1>Exc level 0: System.IO.FileNotFoundException: Could not load file or assembly 'System.Runtime Version=4.2.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
1>   at System.ModuleHandle.ResolveType(RuntimeModule module Int32 typeToken IntPtr* typeInstArgs Int32 typeInstCount IntPtr* methodInstArgs Int32 methodInstCount ObjectHandleOnStack type)
1>   at System.ModuleHandle.ResolveTypeHandleInternal(RuntimeModule module Int32 typeToken RuntimeTypeHandle[] typeInstantiationContext RuntimeTypeHandle[] methodInstantiationContext)
1>   at System.Reflection.RuntimeModule.ResolveType(Int32 metadataToken Type[] genericTypeArguments Type[] genericMethodArguments)
1>   at System.Reflection.CustomAttribute.FilterCustomAttributeRecord(CustomAttributeRecord caRecord MetadataImport scope Assembly& lastAptcaOkAssembly RuntimeModule decoratedModule MetadataToken decoratedToken RuntimeType attributeFilterType Boolean mustBeInheritable Object[] attributes IList derivedAttributes RuntimeType& attributeType IRuntimeMethodInfo& ctor Boolean& ctorHasParameters Boolean& isVarArg)
1>   at System.Reflection.CustomAttribute.GetCustomAttributes(RuntimeModule decoratedModule Int32 decoratedMetadataToken Int32 pcaCount RuntimeType attributeFilterType Boolean mustBeInheritable IList derivedAttributes Boolean isDecoratedTargetSecurityTransparent)
1>   at System.Reflection.CustomAttribute.GetCustomAttributes(RuntimeAssembly assembly RuntimeType caType)
1>   at System.Attribute.GetCustomAttributes(Assembly element Type attributeType Boolean inherit)
1>   at System.Reflection.CustomAttributeExtensions.GetCustomAttributes[T](Assembly element)
1>   at Orleans.ApplicationParts.AssemblyAttributeFeatureProvider1 parts TFeature feature) in D:\build\agent\_work\18\s\src\Orleans.Core\ApplicationParts\AssemblyAttributeFeatureProvider.cs:line 41
1>   at Orleans.ApplicationParts.ApplicationPartManager.PopulateFeature[TFeature](TFeature feature) in D:\build\agent\_work\18\s\src\Orleans.Core\ApplicationParts\ApplicationPartManager.cs:line 49
1>   at Orleans.ApplicationPartManagerExtensions.CreateAndPopulateFeature[TFeature](IApplicationPartManager applicationPartManager) in D:\build\agent\_work\18\s\src\Orleans.Core\ApplicationParts\ApplicationPartManagerExtensions.cs:line 60
1>   at Orleans.CodeGenerator.RoslynCodeGenerator..ctor(IApplicationPartManager partManager ILoggerFactory loggerFactory) in D:\build\agent\_work\18\s\src\Orleans.CodeGeneration\RoslynCodeGenerator.cs:line 43
1>   at Orleans.CodeGeneration.CodeGenerator.GenerateSourceForAssembly(Assembly grainAssembly LogLevel logLevel)
1>   at Orleans.CodeGeneration.CodeGenerator.GenerateCodeInternal(CodeGenOptions options)
1>   at Orleans.CodeGeneration.CodeGenerator.GenerateCode(CodeGenOptions options)
1>   at Orleans.CodeGeneration.Program.Main(String[] args)
1>C:\Users\chris\.nuget\packages\microsoft.orleans.orleanscodegenerator.build\2.0.3\build\Microsoft.Orleans.OrleansCodeGenerator.Build.targets(765): error MSB3073: The command """"dotnet"" ""C:\Users\chris\.nuget\packages\microsoft.orleans.orleanscodegenerator.build\2.0.3\build\..\tasks\netcoreapp2.0\Orleans.CodeGeneration.Build.dll"" ""@obj\Debug\netcoreapp2.1\codegen\Server.orleans.g.args.txt"""" exited with code 3.
1>Done building project ""Server.csproj"" -- FAILED.",,benjaminpetit,,
4584,Microsoft.Orleans.OrleansCodeGenerator.Build and IntelliSense,"Hello.

I want to show the problem by an example because it is difficult for me to describe it.

In the project I created the MyGrain class and the interface IMyGrain MyGrain (heir Grain) and when I write the code the studio tells me where I made a mistake (ctrl+. ""Quick actions and refactorings"") but as soon as I install the package Microsoft.Orleans.OrleansCodeGenerator.Build all the hints disappear and ""quick actions and refactorings"" does not work. 
All hints related to the work of the text analyzer (code) in the visual studio are lost.

Here is a link to the project where you can check it by simply running commands:
[https://github.com/amarf/OrleansBug]()
**install-package Microsoft.Orleans.OrleansCodeGenerator.Build
uninstall-package Microsoft.Orleans.OrleansCodeGenerator.Build**

PS. After executing the uninstall-package command the studio is working normally","Microsoft.Orleans.OrleansCodeGenerator.Build and IntelliSense Hello.

I want to show the problem by an example because it is difficult for me to describe it.

In the project I created the MyGrain class and the interface IMyGrain MyGrain (heir Grain) and when I write the code the studio tells me where I made a mistake (ctrl+. ""Quick actions and refactorings"") but as soon as I install the package Microsoft.Orleans.OrleansCodeGenerator.Build all the hints disappear and ""quick actions and refactorings"" does not work. 
All hints related to the work of the text analyzer (code) in the visual studio are lost.

Here is a link to the project where you can check it by simply running commands:
[https://github.com/amarf/OrleansBug]()
**install-package Microsoft.Orleans.OrleansCodeGenerator.Build
uninstall-package Microsoft.Orleans.OrleansCodeGenerator.Build**

PS. After executing the uninstall-package command the studio is working normally",,ReubenBond,,
4583,Azure transaction benchmark,"Added transaction benchmark that runs against azure storage.
Fixed bugs in transaction bentchmark.","Azure transaction benchmark Added transaction benchmark that runs against azure storage.
Fixed bugs in transaction bentchmark.",,xiazen,,
4581,Clock skew transaction testing,Ensure transaction timestamps work correctly even with clock skew and system time changes.,Clock skew transaction testing Ensure transaction timestamps work correctly even with clock skew and system time changes.,,xiazen,,
4580,Multi tenency DI,"We are looking into implementing multi-tenancy with DI do you have any recommendations? Is possible?

What we like to achieve
 
 - Replace some services based on the tenant (which we will handle ofc)
 - When Grain is initiated it will have the specified tenant so constructor injection will work

I just had did this for aspnetcore by using [Grace](https://github.com/ipjohnson/Grace/) (DI container) which supports child containers.

 Basically what I had to do in order to integrate in aspnet is:
 - Implement custom middleware (which most of the time should be one of the first one)
 - Implement some kind of Tenant resolver which in our case would resolve via domain
 - Replace aspnet  with the our child container.

As far as i know in Orleans its not possible to implement something as I did in aspnet.","Multi tenency DI We are looking into implementing multi-tenancy with DI do you have any recommendations? Is possible?

What we like to achieve
 
 - Replace some services based on the tenant (which we will handle ofc)
 - When Grain is initiated it will have the specified tenant so constructor injection will work

I just had did this for aspnetcore by using [Grace](https://github.com/ipjohnson/Grace/) (DI container) which supports child containers.

 Basically what I had to do in order to integrate in aspnet is:
 - Implement custom middleware (which most of the time should be one of the first one)
 - Implement some kind of Tenant resolver which in our case would resolve via domain
 - Replace aspnet  with the our child container.

As far as i know in Orleans its not possible to implement something as I did in aspnet.",,ReubenBond,,
4579,Add dependency in nuget package Microsoft.Orleans.OrleansCodeGenerator.Build on Microsoft.Orleans.Core.Abstractions,,Add dependency in nuget package Microsoft.Orleans.OrleansCodeGenerator.Build on Microsoft.Orleans.Core.Abstractions ,,ReubenBond,,
4577,"Sanitize ""."" for Azure Queue name and make Queue name configurable","I'm getting exceptions when project name isn't so long or contains ""."" for example name is ""SiloHost.NetCore"".

1. Make Azure Queue name configurable or partially configurable. For example for case when silo host is SF service my queue name is ""fabric--distrtestapplication-silohost.netcore-azurequeueprovider-0"".  It contains 66 symbols instead of max allowed. I want to remove or configure ""fabric--"" prefix or something else.

2. Sanitize ""."" with dash ""-"" as other symbols in AzureQueueDataManager.SanitizeQueueName.","Sanitize ""."" for Azure Queue name and make Queue name configurable I'm getting exceptions when project name isn't so long or contains ""."" for example name is ""SiloHost.NetCore"".

1. Make Azure Queue name configurable or partially configurable. For example for case when silo host is SF service my queue name is ""fabric--distrtestapplication-silohost.netcore-azurequeueprovider-0"".  It contains 66 symbols instead of max allowed. I want to remove or configure ""fabric--"" prefix or something else.

2. Sanitize ""."" with dash ""-"" as other symbols in AzureQueueDataManager.SanitizeQueueName.",,xiazen,,
4576,Lots of warnings after using UseAdoNetReminderService,"Lots of warnings after using UseAdoNetReminderService，Guess #4505  is related to himdo with him

![image](https://user-images.githubusercontent.com/28291464/39905610-ae8f9744-5510-11e8-8ff9-63eca7bdbcdc.png)
","Lots of warnings after using UseAdoNetReminderService Lots of warnings after using UseAdoNetReminderService，Guess #4505  is related to himdo with him

![image](https://user-images.githubusercontent.com/28291464/39905610-ae8f9744-5510-11e8-8ff9-63eca7bdbcdc.png)
",Hacktoberfest,lfzm,11/05/2018 13:45,
4575,HashBasedPlacement,"Hello

Any documentation available on HashBasedPlacement strategy implementation and how it works?

Thanks","HashBasedPlacement Hello

Any documentation available on HashBasedPlacement strategy implementation and how it works?

Thanks",P3,JillHeaden,,
4573,Fix Dependency Injection without changing Abstractions project,,Fix Dependency Injection without changing Abstractions project ,,jason-bragg,,
4572,Using IoT Hub with streams,"My goal is to read events from an IoT Hub and process those events in grains. I wasn't able to find docs on this anywhere but would be grateful if someone would point me in the right direction.

I've used the following code to configure the connection to the IoT Hub. I'm using the Event Hub compatible endpoint.



My intended design is to have a grain per device and have those grains implicitly wired to a stream based on device ID. How should I setup the grain? What does the stream config look like (e.g. namespace and GUID)?

Best
Andrew
","Using IoT Hub with streams My goal is to read events from an IoT Hub and process those events in grains. I wasn't able to find docs on this anywhere but would be grateful if someone would point me in the right direction.

I've used the following code to configure the connection to the IoT Hub. I'm using the Event Hub compatible endpoint.



My intended design is to have a grain per device and have those grains implicitly wired to a stream based on device ID. How should I setup the grain? What does the stream config look like (e.g. namespace and GUID)?

Best
Andrew
",,jason-bragg,,
4571,[WIP] Implementation of a DynamoDB-based gossip channel,"Hi

This is an attempt to bring DynamoDB as a gossip channel.
Still a work-in-progress but I think that some of the main components are now built.

Design is heavily inspired from the already-existing Azure-based gossip channel. I tried to keep the same conventions but feel free to ask me some changes if this does not comply with your dev rules.

Work is not over yet as
- not a single test has been done :)
- I have not yet used DynamoDB before so there may be design errors
- the gossip channel still has to be registered in the MultiClusterGossipChannelFactory

I have made the choice to split data into two different tables: one for the configuration and one for the gateway. This is not the way it has been implemented in the Azure channel but I am not at all familiar with AzureTable.
This may or may be not a good choice feel free to comment

Also a LegacyDynamoDBMembershipConfigurator has been used to parse DynamoDB connection string. I have to so as IGossipChannel's Initialize makes it mandatory. There may be better ways to do that","[WIP] Implementation of a DynamoDB-based gossip channel Hi

This is an attempt to bring DynamoDB as a gossip channel.
Still a work-in-progress but I think that some of the main components are now built.

Design is heavily inspired from the already-existing Azure-based gossip channel. I tried to keep the same conventions but feel free to ask me some changes if this does not comply with your dev rules.

Work is not over yet as
- not a single test has been done :)
- I have not yet used DynamoDB before so there may be design errors
- the gossip channel still has to be registered in the MultiClusterGossipChannelFactory

I have made the choice to split data into two different tables: one for the configuration and one for the gateway. This is not the way it has been implemented in the Azure channel but I am not at all familiar with AzureTable.
This may or may be not a good choice feel free to comment

Also a LegacyDynamoDBMembershipConfigurator has been used to parse DynamoDB connection string. I have to so as IGossipChannel's Initialize makes it mandatory. There may be better ways to do that",,sebastianburckhardt,,
4570,Orleans 1.5 IManagementGrain.GetRuntimeStatistics returns incorrect value for memory usage,"Orleans 1.5.

An issue has been raised on the OrleansDashboard where memory usage is reported to be a large negative number. 

https://github.com/OrleansContrib/OrleansDashboard/issues/140

The percentage is calculated with this formula:  be used instead?

It's interesting to note that AvailableMemory is a float? and MemoryUsage and TotalPhysicalMemory are both long?.

All values are passed straight through the dashboard API without being stored on alternative variables.

I haven't got a repro.","Orleans 1.5 IManagementGrain.GetRuntimeStatistics returns incorrect value for memory usage Orleans 1.5.

An issue has been raised on the OrleansDashboard where memory usage is reported to be a large negative number. 

https://github.com/OrleansContrib/OrleansDashboard/issues/140

The percentage is calculated with this formula:  be used instead?

It's interesting to note that AvailableMemory is a float? and MemoryUsage and TotalPhysicalMemory are both long?.

All values are passed straight through the dashboard API without being stored on alternative variables.

I haven't got a repro.",,benjaminpetit,,
4568,Transactions simplified to use distributed transaction manager only.,"Removed singleton transaction manager and abstractions related to that pattern.
Still work in progress as it should be rebased on Sebastian's transaction storage work once that goes in.

Removed dynamoDb transaction work because there was nothing left once log storage was removed.  Related assemblies and tests are still under source control and can be brought back if/when transactional storage impl is introduced.","Transactions simplified to use distributed transaction manager only. Removed singleton transaction manager and abstractions related to that pattern.
Still work in progress as it should be rebased on Sebastian's transaction storage work once that goes in.

Removed dynamoDb transaction work because there was nothing left once log storage was removed.  Related assemblies and tests are still under source control and can be brought back if/when transactional storage impl is introduced.",,xiazen,,
4567,Fix tests on partial builds,Bump up version of Azure extension packages and fix versions of some references.,Fix tests on partial builds Bump up version of Azure extension packages and fix versions of some references.,,ReubenBond,,
4566,Azure table transactional storage for distributed TM,"New implementation for Azure table transactional storage for distributed TM.
Supports arbitrarily sized batches.

Passes existing transactions tests (NOTE: fails on devstorage must use actual Azure table).
Testing is somewhat incomplete we still need more tests to exercise all the recovery situations.","Azure table transactional storage for distributed TM New implementation for Azure table transactional storage for distributed TM.
Supports arbitrarily sized batches.

Passes existing transactions tests (NOTE: fails on devstorage must use actual Azure table).
Testing is somewhat incomplete we still need more tests to exercise all the recovery situations.",,jason-bragg,,
4563,Incorrect docs about ObserverSubscriptionManager<T> in 2.0," has been moved to legacy package thus docs regarding Observers should be updated accordingly.
note that equivalent class has already been introduced at https://github.com/dotnet/orleans/issues/4378

Page that should be updated:
https://dotnet.github.io/orleans/Documentation/Core-Features/Observers.html","Incorrect docs about ObserverSubscriptionManager<T> in 2.0  has been moved to legacy package thus docs regarding Observers should be updated accordingly.
note that equivalent class has already been introduced at https://github.com/dotnet/orleans/issues/4378

Page that should be updated:
https://dotnet.github.io/orleans/Documentation/Core-Features/Observers.html",P3,JillHeaden,,
4562,Support of ValueTask as a grain method return type,"#2480
Added support of ValueTask as a return type of grain method.
It's a first step of ValueTask support. For now it's just allow users to use ValueTask as a return type to improve their grain performance. Later on we can try to improve our own performance by using ValueTask instead of Task.
Even so if users start using ValueTask they will have more freedom of writing their code and when we implement full support of ValueTask they will suddenly fill performance improvement without need of changing their code.","Support of ValueTask as a grain method return type #2480
Added support of ValueTask as a return type of grain method.
It's a first step of ValueTask support. For now it's just allow users to use ValueTask as a return type to improve their grain performance. Later on we can try to improve our own performance by using ValueTask instead of Task.
Even so if users start using ValueTask they will have more freedom of writing their code and when we implement full support of ValueTask they will suddenly fill performance improvement without need of changing their code.",,ReubenBond,,
4561,TransactionAgent: avoid checking for work if transactions are not in use,Currently the TransactionAgent will start when the silo starts and wake up and check for work every 10ms even if transactions are not configured or being used,TransactionAgent: avoid checking for work if transactions are not in use Currently the TransactionAgent will start when the silo starts and wake up and check for work every 10ms even if transactions are not configured or being used,,jason-bragg,,
4560,Fixes for v2.0.3 release,,Fixes for v2.0.3 release ,,ReubenBond,,
4559,Bump up versions of legacy packages for partial builds,Bump up versions of legacy packages for partial builds due to changes in #4515,Bump up versions of legacy packages for partial builds Bump up versions of legacy packages for partial builds due to changes in #4515,,jason-bragg,,
4558,Remove saving of minidumps,"Fixes #4545.

Remove saving of minidumps because that functionality is platform specific.","Remove saving of minidumps Fixes #4545.

Remove saving of minidumps because that functionality is platform specific.",,jason-bragg,,
4557,Azure retry policy in Orleans,"Pretty much the same issue as ""Json serialization settings in Orleans"" #4555 but with azure table retry policies.","Azure retry policy in Orleans Pretty much the same issue as ""Json serialization settings in Orleans"" #4555 but with azure table retry policies.",P3,jason-bragg,5/05/2018 7:41,
4556,Default provider pattern,"In the legacy provider model providers could be acquired by name or a system could request the default.  The default was the provider named “Default”.  When we moved to using dependency injection where keyed services were used instead of provider managers systems could resolve the provider by name as a keyed service or by the service type to get the default.
For example:

            IGrainStorage storageProvider = string.IsNullOrEmpty(providerName)
                ? services.GetServiceByName<IGrainStorage>(providerName)  // get by name or
                : services.GetService<IGrainStorage>(); // get default

To support the legacy naming conventions we continued using the pattern wherein naming a provider “Default” would signal that it’s the default provider.  This is supported by adding a mapping of the provider interface to the ‘default’ named service into the container.  Something like:

            services.TryAddSingleton<IGrainStorage>(sp => sp.GetServiceByName<IGrainStorage>(ProviderConstants.DEFAULT_STORAGE_PROVIDER_NAME));

This works but has some peculiarities.

* Users may not know about this rule and name a provider “Default” without knowing that name has special meaning in the system.
* Users may not register a default in which the default would always be null (or throw if GetRequiredServiceByName was called).
* The mapping to the default may be registered in the container multiple times which does no harm but is wasteful.

Questions:
Do we want to continue to support default providers?
If so how do we want them to work?
Does the above pattern fit our needs?
Is there a better pattern?
","Default provider pattern In the legacy provider model providers could be acquired by name or a system could request the default.  The default was the provider named “Default”.  When we moved to using dependency injection where keyed services were used instead of provider managers systems could resolve the provider by name as a keyed service or by the service type to get the default.
For example:

            IGrainStorage storageProvider = string.IsNullOrEmpty(providerName)
                ? services.GetServiceByName<IGrainStorage>(providerName)  // get by name or
                : services.GetService<IGrainStorage>(); // get default

To support the legacy naming conventions we continued using the pattern wherein naming a provider “Default” would signal that it’s the default provider.  This is supported by adding a mapping of the provider interface to the ‘default’ named service into the container.  Something like:

            services.TryAddSingleton<IGrainStorage>(sp => sp.GetServiceByName<IGrainStorage>(ProviderConstants.DEFAULT_STORAGE_PROVIDER_NAME));

This works but has some peculiarities.

* Users may not know about this rule and name a provider “Default” without knowing that name has special meaning in the system.
* Users may not register a default in which the default would always be null (or throw if GetRequiredServiceByName was called).
* The mapping to the default may be registered in the container multiple times which does no harm but is wasteful.

Questions:
Do we want to continue to support default providers?
If so how do we want them to work?
Does the above pattern fit our needs?
Is there a better pattern?
",documentation,jason-bragg,,
4555,Json serialization settings in Orleans,"Several Orleans systems/components use json serialization.  Orleans sets up its own default json settings and some systems allow certain overrides of this default.  Much of this seems to have been setup before the introduction of dependency injection names services or options and has some shortcomings.

•	Unclear why default settings are necessary.  Do we need a default or should each system just provide its own settings.
•	Not discoverable.  How do users know we have default json settings.
•	No way to modify the default.  Only per component overrides are provided.
•	Ease of use.  To get the default settings one needs a type resolver and grain interface both of which have internal implementations.

Suggest examination of whether a global default is necessary and if necessary a refactor of how it is configured used and overridden.
","Json serialization settings in Orleans Several Orleans systems/components use json serialization.  Orleans sets up its own default json settings and some systems allow certain overrides of this default.  Much of this seems to have been setup before the introduction of dependency injection names services or options and has some shortcomings.

•	Unclear why default settings are necessary.  Do we need a default or should each system just provide its own settings.
•	Not discoverable.  How do users know we have default json settings.
•	No way to modify the default.  Only per component overrides are provided.
•	Ease of use.  To get the default settings one needs a type resolver and grain interface both of which have internal implementations.

Suggest examination of whether a global default is necessary and if necessary a refactor of how it is configured used and overridden.
",P3,jason-bragg,5/05/2018 7:17,
4554,Orleans Persistence,"Orleans persists state for many reasons both in the core framework and extension libraries.  Persistent state introduces several concerns among which are:

•	Data partitioning.
•	Schema changes.
•	Supported backend storage systems.
•	Data migration and management tools.
•	Custom serialization.

Of the above issues some are addressed some are addressed inconsistently and others are not addressed.  This introduces risk to developers using Orleans because the ease of use hides the complexity associated with persisting state in an evolving production service.  The responsibility ultimately lives with the service developer but the way Orleans manages persistent state offers little to help developers be successful and can in some ways hinder them by hiding the risks.  Without addressing these concerns adding new features like Transactions or Indexing are more difficult and aggravate the problem while refactoring systems which have strong dependencies on storage like streaming or reminders are significantly hindered.

This issue is intended as a starting point for resolving these issues.  The problems are beyond what should be covered in a single issue so I suggest this thread be focused on identifying issues that need be solved which should be spun off as separate issues to be resolved independently.

To start the conversation:

*Data Partitioning*
Currently each silo is part of a cluster which is identified by a service Id which identifies the type of service running on the cluster and should remain constant through the life time of the service and a cluster Id which identifies a deployment of the service.  Storage is partitioned by the service Id.

*Schema Changes*
Storage is inconsistent in how data schemas are translated to storage but most persistence logic uses Orleans serialization to convert complex objects to byte arrays to be stored.  This does not support changes to the persisted state’s schema.  This both limits the Orleans team’s ability to improve Orleans without introducing breaking changes to customers (for which few options are available to work around) as well as application developers ability to modify their own persisted data schema’s when persisted using Orleans features.

*Supported backend storage systems*
We support abstractions for various components which allow for integration with different backends.  However these abstractions are not well defined enough for engineers to implement or program against them with clear expected behaviors.  For instance supported state size error handling and monitoring expectations are often unspecified and vary per implementation.  In more recent additions we’ve attempted to add test harnesses which can be used to vet the behaviors of implementations in an effort to standardize and formalize these abstraction layers but there is still much to be done.

*Data migration and management tools*
There is little to no support for cleaning up migrating or managing persisted state outside the context of the public abstractions.

*Custom serialization*
Custom serializers are primarily supported via the extensibility points in the serialization manager but the serialization manager was initially and primarily intended for networking serialization not storage which has different requirements.  Some other patterns have been attempted for special cases like streaming but no storage specific custom serialization pattern is in use uniformly in the system.

Thought/comments?
What did I miss or get wrong?
","Orleans Persistence Orleans persists state for many reasons both in the core framework and extension libraries.  Persistent state introduces several concerns among which are:

•	Data partitioning.
•	Schema changes.
•	Supported backend storage systems.
•	Data migration and management tools.
•	Custom serialization.

Of the above issues some are addressed some are addressed inconsistently and others are not addressed.  This introduces risk to developers using Orleans because the ease of use hides the complexity associated with persisting state in an evolving production service.  The responsibility ultimately lives with the service developer but the way Orleans manages persistent state offers little to help developers be successful and can in some ways hinder them by hiding the risks.  Without addressing these concerns adding new features like Transactions or Indexing are more difficult and aggravate the problem while refactoring systems which have strong dependencies on storage like streaming or reminders are significantly hindered.

This issue is intended as a starting point for resolving these issues.  The problems are beyond what should be covered in a single issue so I suggest this thread be focused on identifying issues that need be solved which should be spun off as separate issues to be resolved independently.

To start the conversation:

*Data Partitioning*
Currently each silo is part of a cluster which is identified by a service Id which identifies the type of service running on the cluster and should remain constant through the life time of the service and a cluster Id which identifies a deployment of the service.  Storage is partitioned by the service Id.

*Schema Changes*
Storage is inconsistent in how data schemas are translated to storage but most persistence logic uses Orleans serialization to convert complex objects to byte arrays to be stored.  This does not support changes to the persisted state’s schema.  This both limits the Orleans team’s ability to improve Orleans without introducing breaking changes to customers (for which few options are available to work around) as well as application developers ability to modify their own persisted data schema’s when persisted using Orleans features.

*Supported backend storage systems*
We support abstractions for various components which allow for integration with different backends.  However these abstractions are not well defined enough for engineers to implement or program against them with clear expected behaviors.  For instance supported state size error handling and monitoring expectations are often unspecified and vary per implementation.  In more recent additions we’ve attempted to add test harnesses which can be used to vet the behaviors of implementations in an effort to standardize and formalize these abstraction layers but there is still much to be done.

*Data migration and management tools*
There is little to no support for cleaning up migrating or managing persisted state outside the context of the public abstractions.

*Custom serialization*
Custom serializers are primarily supported via the extensibility points in the serialization manager but the serialization manager was initially and primarily intended for networking serialization not storage which has different requirements.  Some other patterns have been attempted for special cases like streaming but no storage specific custom serialization pattern is in use uniformly in the system.

Thought/comments?
What did I miss or get wrong?
",P2,jason-bragg,5/05/2018 6:59,
4553,orleans silo using zookeeper clustering.,i want to run orleans silo with zookeeper. i downloaded the doker image of ZK and run it on a container. i did not get any sample code to connect ZK. Please provide any sample for client and silo. i already running same with azure table. i did not found any documentation for it if you have please provide me.,orleans silo using zookeeper clustering. i want to run orleans silo with zookeeper. i downloaded the doker image of ZK and run it on a container. i did not get any sample code to connect ZK. Please provide any sample for client and silo. i already running same with azure table. i did not found any documentation for it if you have please provide me.,documentation,sergeybykov,4/05/2018 21:31,21/05/2019 0:21
4552,Add Client/SiloHost builder delegate to legacy GrainClient and SIlo/AzureSilo,"Since now providers need to be configured using the builder pattern developer stuck with the legacy Silo and GrainClient can no longer configure thingks like storage or stream providers.

This PR enable them to configure it so transition is more easy.","Add Client/SiloHost builder delegate to legacy GrainClient and SIlo/AzureSilo Since now providers need to be configured using the builder pattern developer stuck with the legacy Silo and GrainClient can no longer configure thingks like storage or stream providers.

This PR enable them to configure it so transition is more easy.",,ReubenBond,,
4551,There is no support plan for the Http protocol？,There is no support plan for the Http protocol？,There is no support plan for the Http protocol？ There is no support plan for the Http protocol？,question,sergeybykov,3/05/2018 13:49,24/05/2018 12:00
4549,[doc] Links need updating,"This thread concerns [Links](https://dotnet.github.io/orleans/Community/Links.html) part of the documentation under the Community section.

* Several of the links listed are broken (result in 404). They should either be removed or replaced with internet archive equivalent links.
* They are in no particular order so it's hard to determine which are historical and which are still relevant today. They should be categorised better.","[doc] Links need updating This thread concerns [Links](https://dotnet.github.io/orleans/Community/Links.html) part of the documentation under the Community section.

* Several of the links listed are broken (result in 404). They should either be removed or replaced with internet archive equivalent links.
* They are in no particular order so it's hard to determine which are historical and which are still relevant today. They should be categorised better.",P1,sergeybykov,,
4548,[doc] Ideas for Contributions needs updating,"This thread concerns [Ideas for Contributions](https://dotnet.github.io/orleans/Community/Ideas-for-Contributions.html) which is part of the documentation under Community.

* What is OrleansMonitor? Some earlier incarnation of the OrleansDashboard?
* Port Orleans to coreclr - does this mean .NET Core? (which obviously would be resolved as of 2.0)

Not sure what other points may be obsolete and what others may be worth adding.","[doc] Ideas for Contributions needs updating This thread concerns [Ideas for Contributions](https://dotnet.github.io/orleans/Community/Ideas-for-Contributions.html) which is part of the documentation under Community.

* What is OrleansMonitor? Some earlier incarnation of the OrleansDashboard?
* Port Orleans to coreclr - does this mean .NET Core? (which obviously would be resolved as of 2.0)

Not sure what other points may be obsolete and what others may be worth adding.",P2,jason-bragg,,
4547,Create Basic Clustering Sample,"With the 2.0 release I am seeing more and more demand for examples of how to do things in Orleans 2.0. I have partly addressed this for initial ""getting started"" through the articles on my own blog. However there is a lot of value in having more [samples](https://github.com/dotnet/orleans/tree/master/Samples/2.0)  and [tutorials](https://dotnet.github.io/orleans/Tutorials/index.html). This is because while the docs serve as a comprehensive reference on how Orleans works newcomers learn better when they can be taken through the concepts step by step.

To this end a tutorial is better for a newcomer than comprehensive documentation. And a sample that demonstrates just one thing (e.g. clustering or persistence or reminders) is better than a full-blown application demonstrating everything working together.

I've been asked on my [basic clustering](http://gigi.nullneuron.net/gigilabs/your-first-microsoft-orleans-cluster/) article (written for Orleans 1.4.2) how to do the same for 2.0 i.e. very basic unreliable MembershipTableGrain clustering.

A sample for this would great to have for 2.0 because clustering is typically what newcomers want to try out after they've mastered the basics and before they move onto more reliable clustering options. And it can be a bit of a pain to set up the first time so it would save them a bit of hassle. Also the fact that it uses built-in (even if unreliable) clustering means that people can focus on learning Orleans concepts and defer the need to get into any store-specific details.","Create Basic Clustering Sample With the 2.0 release I am seeing more and more demand for examples of how to do things in Orleans 2.0. I have partly addressed this for initial ""getting started"" through the articles on my own blog. However there is a lot of value in having more [samples](https://github.com/dotnet/orleans/tree/master/Samples/2.0)  and [tutorials](https://dotnet.github.io/orleans/Tutorials/index.html). This is because while the docs serve as a comprehensive reference on how Orleans works newcomers learn better when they can be taken through the concepts step by step.

To this end a tutorial is better for a newcomer than comprehensive documentation. And a sample that demonstrates just one thing (e.g. clustering or persistence or reminders) is better than a full-blown application demonstrating everything working together.

I've been asked on my [basic clustering](http://gigi.nullneuron.net/gigilabs/your-first-microsoft-orleans-cluster/) article (written for Orleans 1.4.2) how to do the same for 2.0 i.e. very basic unreliable MembershipTableGrain clustering.

A sample for this would great to have for 2.0 because clustering is typically what newcomers want to try out after they've mastered the basics and before they move onto more reliable clustering options. And it can be a bit of a pain to set up the first time so it would save them a bit of hassle. Also the fact that it uses built-in (even if unreliable) clustering means that people can focus on learning Orleans concepts and defer the need to get into any store-specific details.",P3,sergeybykov,3/05/2018 6:20,
4546,How to register a BootstrapProvider in Orleans 2.0 programmatically?,"Hi
With Orleans 1.x.x we used to register a BootstrapProvider in OrleansConfiguration.xml as below:
 but didn't get any example or code sample for that. I need your guidance here to register a BootstrapProvider.
Thanks.","How to register a BootstrapProvider in Orleans 2.0 programmatically? Hi
With Orleans 1.x.x we used to register a BootstrapProvider in OrleansConfiguration.xml as below:
 but didn't get any example or code sample for that. I need your guidance here to register a BootstrapProvider.
Thanks.",question,ReubenBond,,
4544,Disable multi-state transactional grain tests,Disable multi-state transactional grain tests for singleton transaction manager tests.,Disable multi-state transactional grain tests Disable multi-state transactional grain tests for singleton transaction manager tests.,,xiazen,,
4543,Update tests for distributed TM to use multiple states,"Now distributed TM also has tests that use multiple states per grain.

(I basically just copied the pattern in Orleans.Transactions.Tests/Grains/MultiStateTransactionalGrains.cs over to Orleans.Transactions.Tests/DistributedTM/MultiStateTransactionalGrain.cs)
","Update tests for distributed TM to use multiple states Now distributed TM also has tests that use multiple states per grain.

(I basically just copied the pattern in Orleans.Transactions.Tests/Grains/MultiStateTransactionalGrains.cs over to Orleans.Transactions.Tests/DistributedTM/MultiStateTransactionalGrain.cs)
",,jason-bragg,,
4541,Rearrange test projects and make them support partial build,,Rearrange test projects and make them support partial build ,,ReubenBond,,
4540,Question about  Item System*WorkItemGroup:Name=*stg/28/0000001c,"I got much warning infomation on my application that base on Orleans 2.0 
 on my system  why is this  ? 
","Question about  Item System*WorkItemGroup:Name=*stg/28/0000001c I got much warning infomation on my application that base on Orleans 2.0 
 on my system  why is this  ? 
",,ReubenBond,,
4539,Add transaction recoverbility test runner,"- Add transaction recoverability test runners. 
- Add transaction recoverability tests running against single TM. currently isn't included into functional or bvt because single TM has recoverability problems  so the tests isn't passing. But it is higher priority to get the test runner merged in so we can test the new distributed TM. If you don't like it I can remove the actual tests.","Add transaction recoverbility test runner - Add transaction recoverability test runners. 
- Add transaction recoverability tests running against single TM. currently isn't included into functional or bvt because single TM has recoverability problems  so the tests isn't passing. But it is higher priority to get the test runner merged in so we can test the new distributed TM. If you don't like it I can remove the actual tests.",,jason-bragg,,
4538,Azure table TransactionalStateStorage,,Azure table TransactionalStateStorage ,,xiazen,,
4537,Document placement policies,"Dear Orleans Team

I have been trouble shooting my application for the past 2 months because I wasn't gaining any benefit from adding additional silos. Can you create a topic in your documentation regarding placement location [PreferLocalPlacement] and so on. My problem was that every time Grain A was called by my clients Grain A had to call 3 instances of Grain B when placement was set to random these were activated on the different silos but when I changed Grain B to prefer local placement it always activated them with Grain A so the RPCs where minimized.

I have looked through the entire documentation (I am pretty sure it is mentioned in one of the scientific papers published or a blog post somewhere since that was the only reason I ended up thinking about it).

I found this description today that saved my day. http://richorama.github.io/blog/2015/01/02/grain-placement-in-orleans/","Document placement policies Dear Orleans Team

I have been trouble shooting my application for the past 2 months because I wasn't gaining any benefit from adding additional silos. Can you create a topic in your documentation regarding placement location [PreferLocalPlacement] and so on. My problem was that every time Grain A was called by my clients Grain A had to call 3 instances of Grain B when placement was set to random these were activated on the different silos but when I changed Grain B to prefer local placement it always activated them with Grain A so the RPCs where minimized.

I have looked through the entire documentation (I am pretty sure it is mentioned in one of the scientific papers published or a blog post somewhere since that was the only reason I ended up thinking about it).

I found this description today that saved my day. http://richorama.github.io/blog/2015/01/02/grain-placement-in-orleans/",P1,sergeybykov,1/05/2018 7:45,
4536,Regression on ClusterClient,"The ClusterClient seems very persnickety when it comes to maintaining a connection



This just seems to happen randomly during the lifecycle of a ClusterClient and there is no way for the ClusterClient to recover it just needs to be torn down and replaced which means major rearchitecting my application.","Regression on ClusterClient The ClusterClient seems very persnickety when it comes to maintaining a connection



This just seems to happen randomly during the lifecycle of a ClusterClient and there is no way for the ClusterClient to recover it just needs to be torn down and replaced which means major rearchitecting my application.",,ReubenBond,,
4535,Revert GrainReference.FromKeyString() back to internal,"Revert  package which we'd prefer not to.

This change is a workaround that allows us to avoid updating abstractions unnecessarily.","Revert GrainReference.FromKeyString() back to internal Revert  package which we'd prefer not to.

This change is a workaround that allows us to avoid updating abstractions unnecessarily.",,jason-bragg,,
4534,Unit Testing & OrleansTestKit Path Forward,"We have been discussing our testing strategy internally and would like to see if anyone else has opinions on how we can make testing better in Orleans. We are thinking about using a similar API to the one I created in OrleansTestKit but run it within the actual Orleans runtime. The OrleansTestKit is able to run tests for many simple use cases however it will not support more complex grain that are deeply integrated with Orleans for example Lifecycle events. There are many other things that Orleans does that would not be able to be tested inside the TestKit. Rather than spending more time emulating Orleans behaviors we are thinking about a new approach that would allow the same assertions that exist within the current TestKit but would allow grain code to execute exactly as it does when running in a real silo.

 In reality most of this proposal is just to allow developers to assert grain state  grain calls to other grains and provide a way for a developer configure a mock grain that will return the desired value or exception when a grain is called.

What would need to be built:

**Storage provider**
- Assert the current grain state
- Setup the grain state prior to activation

**Stream provider**
- Assert that a grain is subscribed to a specific stream
- Assert that a grain sends the proper message on a stream
- Assert that a grain received a message from a stream without error
- Assert that a grain unsubscribed from a specific stream

**Reminder Provider**
- Assert that a reminder was registered for the correct time
- Fire a reminder on demand from within a test 

**Mock Grain Call Filter**
- Assert that another grain was called with the correct values
- Intercept grain-to-grain method calls and return a specific value or throw an exception

**Other**
- Deactivate a grain on demand
- Activate a grain on demand

Please let me know if you have other things that you would like exposed and we can talk about a roadmap to build out these features. We are going to start prototyping some of these behaviors this week to see how they work in practice.","Unit Testing & OrleansTestKit Path Forward We have been discussing our testing strategy internally and would like to see if anyone else has opinions on how we can make testing better in Orleans. We are thinking about using a similar API to the one I created in OrleansTestKit but run it within the actual Orleans runtime. The OrleansTestKit is able to run tests for many simple use cases however it will not support more complex grain that are deeply integrated with Orleans for example Lifecycle events. There are many other things that Orleans does that would not be able to be tested inside the TestKit. Rather than spending more time emulating Orleans behaviors we are thinking about a new approach that would allow the same assertions that exist within the current TestKit but would allow grain code to execute exactly as it does when running in a real silo.

 In reality most of this proposal is just to allow developers to assert grain state  grain calls to other grains and provide a way for a developer configure a mock grain that will return the desired value or exception when a grain is called.

What would need to be built:

**Storage provider**
- Assert the current grain state
- Setup the grain state prior to activation

**Stream provider**
- Assert that a grain is subscribed to a specific stream
- Assert that a grain sends the proper message on a stream
- Assert that a grain received a message from a stream without error
- Assert that a grain unsubscribed from a specific stream

**Reminder Provider**
- Assert that a reminder was registered for the correct time
- Fire a reminder on demand from within a test 

**Mock Grain Call Filter**
- Assert that another grain was called with the correct values
- Intercept grain-to-grain method calls and return a specific value or throw an exception

**Other**
- Deactivate a grain on demand
- Activate a grain on demand

Please let me know if you have other things that you would like exposed and we can talk about a roadmap to build out these features. We are going to start prototyping some of these behaviors this week to see how they work in practice.",design-review,dsarfati,1/05/2018 4:50,
4532,DI documentation incorrect client sample,"This concerns the [Dependency Injection](https://dotnet.github.io/orleans/Documentation/Core-Features/Dependency-Injection.html) documentation page for Orleans 2.0.

There's this code sample that shows how the _client_ should be configured to use DI:

![image](https://user-images.githubusercontent.com/13241564/39409406-6d25766a-4bde-11e8-9cbf-1b2a2be293cb.png)


It seems to be a direct copy/paste from the sample above which is for the silo. The name of the builder variable was changed but the rest was left the same.","DI documentation incorrect client sample This concerns the [Dependency Injection](https://dotnet.github.io/orleans/Documentation/Core-Features/Dependency-Injection.html) documentation page for Orleans 2.0.

There's this code sample that shows how the _client_ should be configured to use DI:

![image](https://user-images.githubusercontent.com/13241564/39409406-6d25766a-4bde-11e8-9cbf-1b2a2be293cb.png)


It seems to be a direct copy/paste from the sample above which is for the silo. The name of the builder variable was changed but the rest was left the same.",documentation,ReubenBond,,
4531,Grain timeouts,Hi. I want to use grain with different lifetime by type. Some my grains execute so long and this normal. Then i call grain from client i can registered standardClient and longTimeLive client but i can do this inside silo host. When i cal my grain A from grain B i want that grain B can wait A more that another grains. How i can do this?,Grain timeouts Hi. I want to use grain with different lifetime by type. Some my grains execute so long and this normal. Then i call grain from client i can registered standardClient and longTimeLive client but i can do this inside silo host. When i cal my grain A from grain B i want that grain B can wait A more that another grains. How i can do this?,question,sergeybykov,30/04/2018 2:59,20/06/2018 0:30
4530,Error during serialization of Entity Framework objects,"If Lazy Load enabled in EF the serialization process throws ArgumentException: Invalid token for impersonation - it cannot be duplicated error

","Error during serialization of Entity Framework objects If Lazy Load enabled in EF the serialization process throws ArgumentException: Invalid token for impersonation - it cannot be duplicated error

",,ReubenBond,,
4528,Orleans 2.0 documentation page inaccuracies,"This thread relates to the [Orleans 2.0 documentation page](https://dotnet.github.io/orleans/Documentation/Orleans-2.0.html).

> Explicit programmatic specification of application assemblies that replaces automatic scanning of folders by the Orleans runtime upon silo or client initialization. Orleans will still automatically find relevant types such as grain interfaces and classes serializers etc. in the specified assemblies but **it will not anymore try to load every assembly it can find in the folder**. An optional helper method for loading all assemblies in the folder is provided for backward compatibility. See Configuration and Migration sections for more details.

I thought that automatic scanning for assemblies was the default behaviour - ref [Application Parts documentation](https://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Configuration-Guide/Server-Configuration.html#application-parts) and https://github.com/dotnet/orleans/issues/4420#issuecomment-379962127 .

> Overhaul of code generation. **While mostly invisible for developer** code generation became much more robust in handling serialization of various possible types. Special handling is required for F# assemblies. See Code generation section for more details.

Code generation is not very invisible given that Orleans won't work without it - ref https://github.com/dotnet/orleans/issues/4417 .","Orleans 2.0 documentation page inaccuracies This thread relates to the [Orleans 2.0 documentation page](https://dotnet.github.io/orleans/Documentation/Orleans-2.0.html).

> Explicit programmatic specification of application assemblies that replaces automatic scanning of folders by the Orleans runtime upon silo or client initialization. Orleans will still automatically find relevant types such as grain interfaces and classes serializers etc. in the specified assemblies but **it will not anymore try to load every assembly it can find in the folder**. An optional helper method for loading all assemblies in the folder is provided for backward compatibility. See Configuration and Migration sections for more details.

I thought that automatic scanning for assemblies was the default behaviour - ref [Application Parts documentation](https://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Configuration-Guide/Server-Configuration.html#application-parts) and https://github.com/dotnet/orleans/issues/4420#issuecomment-379962127 .

> Overhaul of code generation. **While mostly invisible for developer** code generation became much more robust in handling serialization of various possible types. Special handling is required for F# assemblies. See Code generation section for more details.

Code generation is not very invisible given that Orleans won't work without it - ref https://github.com/dotnet/orleans/issues/4417 .",P1,sergeybykov,,
4527,This problem has not been resolved in 2.0.【#4178】,@ReubenBond  This problem has not been resolved in 2.0.#4178。,This problem has not been resolved in 2.0.【#4178】 @ReubenBond  This problem has not been resolved in 2.0.#4178。,,ReubenBond,,
4525,Orleans Client in front end web server - Setup,"Scenario: I've got a front end web api which is going to invoke the grain to execute the business logic.

In Orleans 1.5 GrainClient once initialized it was available across basically I had the client initialization code in by WebApiConfig class.

 GrainClient.Initialize(HttpContext.Current.Server.MapPath(""OrleansConfiguration.xml""));

And in my end point I would simply access the GrainClient static class to create the grain factory and all the method like this.

 public async Task<HttpResponseMessage> HealthCheckGrain()
 {
     GrainClient.GrainFactory.GetGrain<IHello>(0).SayHello(""Test"");
}

Since 2.0 doesn't have this how can I initialize the client once and then use the same client again to invoke the grain or is it expected to create the client each time you invoke the grain.","Orleans Client in front end web server - Setup Scenario: I've got a front end web api which is going to invoke the grain to execute the business logic.

In Orleans 1.5 GrainClient once initialized it was available across basically I had the client initialization code in by WebApiConfig class.

 GrainClient.Initialize(HttpContext.Current.Server.MapPath(""OrleansConfiguration.xml""));

And in my end point I would simply access the GrainClient static class to create the grain factory and all the method like this.

 public async Task<HttpResponseMessage> HealthCheckGrain()
 {
     GrainClient.GrainFactory.GetGrain<IHello>(0).SayHello(""Test"");
}

Since 2.0 doesn't have this how can I initialize the client once and then use the same client again to invoke the grain or is it expected to create the client each time you invoke the grain.",question,sergeybykov,28/04/2018 7:44,2/05/2018 7:55
4524,Error on type 'MessageCenter'.  The requested address is not valid in its context,"After moving to the V2.0 from v2-rc3 several developers get the ""The requested address is not valid in its context"" error. At several devs all works as expected. We use the ado.net clustering.
From this message is not clear where is a problem



","Error on type 'MessageCenter'.  The requested address is not valid in its context After moving to the V2.0 from v2-rc3 several developers get the ""The requested address is not valid in its context"" error. At several devs all works as expected. We use the ado.net clustering.
From this message is not clear where is a problem



",,benjaminpetit,,
4523,Orleans call grain within a grain,"I've got a requirement to call a grain within a grain. I had tried this in version 1.5 not sure how it works in 2.0. If somebody can provide a sample it would be great. This was what I was trying.

 public class CustomerRule : Grain ICustomerRule
{
    private ISomeGrain _someGrain;
    public override async Task OnActivateAsync()
        {
              _someGrain = GrainFactory.GetGrain<ISomeGrain>(this.GetPrimaryKeyString());
              await base.OnActivateAsync();
         }
     public Task<bool> TestHello(GrainCancellationToken tc string customer)
     {
               var string =  _someGrain.SayHello(tc customer);
              return Task.FromResult(string);
      }
}

Due to some reason SayHello() is not being invoked. 
","Orleans call grain within a grain I've got a requirement to call a grain within a grain. I had tried this in version 1.5 not sure how it works in 2.0. If somebody can provide a sample it would be great. This was what I was trying.

 public class CustomerRule : Grain ICustomerRule
{
    private ISomeGrain _someGrain;
    public override async Task OnActivateAsync()
        {
              _someGrain = GrainFactory.GetGrain<ISomeGrain>(this.GetPrimaryKeyString());
              await base.OnActivateAsync();
         }
     public Task<bool> TestHello(GrainCancellationToken tc string customer)
     {
               var string =  _someGrain.SayHello(tc customer);
              return Task.FromResult(string);
      }
}

Due to some reason SayHello() is not being invoked. 
",question,sergeybykov,28/04/2018 3:19,28/04/2018 7:15
4522,Running on dotnetcore on Windows Subsystem for Linux,"* Standard Ubuntu on Windows 10 **Windows Subsytem for Linux** (WSL )
* Installed dotnecore SDK as per 
* * https://www.microsoft.com/net/learn/get-started/linux/ubuntu16-04
* * Version 2.1.105
* Simple Hello world project compiled on the Ubuntu WSL using 

There is a related issue on marked as BUG

https://github.com/dotnet/corefx/issues/22048

Any work around to get this working or should I not push my luck with WSL ?



","Running on dotnetcore on Windows Subsystem for Linux * Standard Ubuntu on Windows 10 **Windows Subsytem for Linux** (WSL )
* Installed dotnecore SDK as per 
* * https://www.microsoft.com/net/learn/get-started/linux/ubuntu16-04
* * Version 2.1.105
* Simple Hello world project compiled on the Ubuntu WSL using 

There is a related issue on marked as BUG

https://github.com/dotnet/corefx/issues/22048

Any work around to get this working or should I not push my luck with WSL ?



",,benjaminpetit,,
4519,Feature request: IActivationFilter,"In obit you have this extension interface: https://github.com/orbit/orbit/blob/master/actors/core/src/main/java/cloud/orbit/actors/extensions/LifetimeExtension.java 

I thing it would be great to introduce IActionFilter with a similar signature to IIncomingGrainCallFilter.

Use cases:

1. Custom storage solutions
2. Logging
3. Exception handling
4. Integration to Orleans Dashboard","Feature request: IActivationFilter In obit you have this extension interface: https://github.com/orbit/orbit/blob/master/actors/core/src/main/java/cloud/orbit/actors/extensions/LifetimeExtension.java 

I thing it would be great to introduce IActionFilter with a similar signature to IIncomingGrainCallFilter.

Use cases:

1. Custom storage solutions
2. Logging
3. Exception handling
4. Integration to Orleans Dashboard",Hacktoberfest,ReubenBond,,
4518,[2.0] Grain inherits IGrainWithStringKey  but IsPrimaryKeyBasedOnLong returns True ,"  Grain inherits IGrainWithStringKey  but IsPrimaryKeyBasedOnLong returns True .
@ReubenBond @sergeybykov 

![image](https://user-images.githubusercontent.com/28291464/39353879-87ffcd2c-4a3b-11e8-84c6-e5e65bda53e7.png)
","[2.0] Grain inherits IGrainWithStringKey , but IsPrimaryKeyBasedOnLong returns True    Grain inherits IGrainWithStringKey  but IsPrimaryKeyBasedOnLong returns True .
@ReubenBond @sergeybykov 

![image](https://user-images.githubusercontent.com/28291464/39353879-87ffcd2c-4a3b-11e8-84c6-e5e65bda53e7.png)
",,ReubenBond,,
4517,Enabling DeadlockDetection will cause an Exception,"This file should be move to Orleans.Runtime.Abstraction/Messaging. Otherwise when DetectDeadlock is enabled it will get an exception


https://github.com/dotnet/orleans/blob/426a4b4c09a23b5e99a87700c6b496bfb8c07154/src/Orleans.Runtime/Messaging/RequestInvocationHistory.cs#L7","Enabling DeadlockDetection will cause an Exception This file should be move to Orleans.Runtime.Abstraction/Messaging. Otherwise when DetectDeadlock is enabled it will get an exception


https://github.com/dotnet/orleans/blob/426a4b4c09a23b5e99a87700c6b496bfb8c07154/src/Orleans.Runtime/Messaging/RequestInvocationHistory.cs#L7",,ReubenBond,,
4515,Non static statistics: Round 1,"Note that this is based upon #4509
Fixes #4499

Submitting for CI testing but it passed in VSO already.

This starts the process of removing statics from the statistics system. It doesn't complete the process but it is already enough to fix initialization order problems like we see in #4499.","Non static statistics: Round 1 Note that this is based upon #4509
Fixes #4499

Submitting for CI testing but it passed in VSO already.

This starts the process of removing statics from the statistics system. It doesn't complete the process but it is already enough to fix initialization order problems like we see in #4499.",,xiazen,,
4509,Consolidate SiloStatisticsOptions and ClientStatisticsOptions,"The options system doesn't handle inheritance.
The divide between ","Consolidate SiloStatisticsOptions and ClientStatisticsOptions The options system doesn't handle inheritance.
The divide between ",,xiazen,,
4508,Fix Exception thrown in MembershipOracle.TryToSuspectOrKill,"Related issue: #4507 

This is the bare minimum fix to avoid any exception at runtime because of logging in Orleans. We will need to do several passes to remove entirely numbered format string.","Fix Exception thrown in MembershipOracle.TryToSuspectOrKill Related issue: #4507 

This is the bare minimum fix to avoid any exception at runtime because of logging in Orleans. We will need to do several passes to remove entirely numbered format string.",,ReubenBond,,
4507,Exception thrown in MembershipOracle.TryToSuspectOrKill when debug level set to Debug,"The following line is incorrect:

 so it will throw an exception ""System.FormatException : Index (zero based) must be greater than or equal to zero and less than the size of the argument list"".

Format should respect this format: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging/?view=aspnetcore-2.1&tabs=aspnetcore2x#log-message-template

We need to do a pass in Orleans codebase to see if we did the same mistake in other places.
","Exception thrown in MembershipOracle.TryToSuspectOrKill when debug level set to Debug The following line is incorrect:

 so it will throw an exception ""System.FormatException : Index (zero based) must be greater than or equal to zero and less than the size of the argument list"".

Format should respect this format: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging/?view=aspnetcore-2.1&tabs=aspnetcore2x#log-message-template

We need to do a pass in Orleans codebase to see if we did the same mistake in other places.
",bug,benjaminpetit,25/04/2018 8:23,6/06/2018 1:52
4506,Metrics Documentation Community Effort,"The Orleans Telemetry interface outputs a lot of metrics. Some are crucial some are less useful (and it depends on your needs).

As it stands there is no centralized space where these are documented and one shouldn't have to do guesswork to figure out which metrics they need to track. Some are self explanatory (
 
And I am including this definition from @sergeybykov as well:

> In general Current is the latest value of the counter and Delta is the change in its value since the last time metrics were reported. By default metrics are reported every 5 minutes. So deltas give a rough idea of the counters' velocity.

also:

> Storage.* counters except for .Latency simply count invocations of the corresponding methods and their failures.

It would be good to start providing worded definitions and units for these as most are relatively clear in their functionality. 

To stress once more this work would be greatly improved if it was a community effort 😃 **What is the best way/place to start contributing to this?**
________________________________________________________________________________________
","Metrics Documentation Community Effort The Orleans Telemetry interface outputs a lot of metrics. Some are crucial some are less useful (and it depends on your needs).

As it stands there is no centralized space where these are documented and one shouldn't have to do guesswork to figure out which metrics they need to track. Some are self explanatory (
 
And I am including this definition from @sergeybykov as well:

> In general Current is the latest value of the counter and Delta is the change in its value since the last time metrics were reported. By default metrics are reported every 5 minutes. So deltas give a rough idea of the counters' velocity.

also:

> Storage.* counters except for .Latency simply count invocations of the corresponding methods and their failures.

It would be good to start providing worded definitions and units for these as most are relatively clear in their functionality. 

To stress once more this work would be greatly improved if it was a community effort 😃 **What is the best way/place to start contributing to this?**
________________________________________________________________________________________
",P2,sergeybykov,,
4505,Orleans gets slower over time,"Hi

it is a little bit vague but I have the impression that Orleans gets slower over time.

My specs are:

* .NET Core 2.0
* Running on Kubernetes in GCloud 2 Nodes/Silos
* Co-Hosted with ASP.NET Core

I have a very simple grain that just returns the snapshot (my own state system):

https://github.com/Squidex/squidex/blob/master/src/Squidex.Domain.Apps.Entities/Schemas/SchemaGrain.cs#L305

I use my own serializer with JSON.NET and my benchmarks show that the serialization takes 2-3 ms usually. I also tested it with 100x larger states that expected and the performance is great.

I added some profiling to the client side and I have experienced that the call takes 4-5 ms after I deploy it and several days later up to 200ms or even more (the max I have seen is 10seconds).

I also checked my MongoDB logs where I save all slow queries and there is nothing related.

I am a little bit lost.","Orleans gets slower over time Hi

it is a little bit vague but I have the impression that Orleans gets slower over time.

My specs are:

* .NET Core 2.0
* Running on Kubernetes in GCloud 2 Nodes/Silos
* Co-Hosted with ASP.NET Core

I have a very simple grain that just returns the snapshot (my own state system):

https://github.com/Squidex/squidex/blob/master/src/Squidex.Domain.Apps.Entities/Schemas/SchemaGrain.cs#L305

I use my own serializer with JSON.NET and my benchmarks show that the serialization takes 2-3 ms usually. I also tested it with 100x larger states that expected and the performance is great.

I added some profiling to the client side and I have experienced that the call takes 4-5 ms after I deploy it and several days later up to 200ms or even more (the max I have seen is 10seconds).

I also checked my MongoDB logs where I save all slow queries and there is nothing related.

I am a little bit lost.",,ReubenBond,,
4502,Archive transaction logs,"- Archive transaction logs
- Add minimum query API
- Add minimum testing on the feature


Since no enough information for me to know which queries will be most useful so I didn't add any specific query API just the general API which takes a ","Archive transaction logs - Archive transaction logs
- Add minimum query API
- Add minimum testing on the feature


Since no enough information for me to know which queries will be most useful so I didn't add any specific query API just the general API which takes a ",,jason-bragg,,
4501,Orleans on Azure Container Instances?,"Is it possible to run Orleans on Azure Container Instances?

The main reason I would want to use Orleans is to save costs as something like Cosmos DB is very expensive. Here is a [quote](https://azure.com/e/513c4c8421424d0ebdb94b9dfc51b796) from the Azure pricing calculator comparing AKS to Azure Container Instances. Azure Container Instances is an order of magnitude cheaper.

My understanding is that it's not recommended to expose Orleans to the internet which is what you'd be doing if you used Azure Container Instances. I'm also not sure how you'd secure it.","Orleans on Azure Container Instances? Is it possible to run Orleans on Azure Container Instances?

The main reason I would want to use Orleans is to save costs as something like Cosmos DB is very expensive. Here is a [quote](https://azure.com/e/513c4c8421424d0ebdb94b9dfc51b796) from the Azure pricing calculator comparing AKS to Azure Container Instances. Azure Container Instances is an order of magnitude cheaper.

My understanding is that it's not recommended to expose Orleans to the internet which is what you'd be doing if you used Azure Container Instances. I'm also not sure how you'd secure it.",question,benjaminpetit,,
4500,[2.0] Build-time Code Generation fails when referencing a project that contains service references.,"As above. With a library targeting .NET Standard 2.0 a grain interface project references a project that contains a service reference leading to the following build-time error:

","[2.0] Build-time Code Generation fails when referencing a project that contains service references. As above. With a library targeting .NET Standard 2.0 a grain interface project references a project that contains a service reference leading to the following build-time error:

",,ReubenBond,,
4499,StatisticsLevel.Verbose causes serialization exceptions,"
- Orleans 2.0

**config:**



**log:**
> warn: Messaging.GatewayConnection/GatewayClientSender_gwy.tcp://10.0.1.18:10300/262055360[100159]                               
      Unexpected error serializing message to gateway gwy.tcp://10.0.1.18:10300/262055360.                                      
System.NullReferenceException: Object reference not set to an instance of an object.                                            
   at Orleans.Serialization.SerializationManager.SerializeMessageHeaders(HeadersContainer headers SerializationContext context)
   at Orleans.Runtime.Message.Serialize(SerializationManager serializationManager Int32& headerLengthOut Int32& bodyLengthOut)
   at Orleans.Messaging.OutgoingMessageSender.Process(Message msg)                                                              
warn: Orleans.OutsideRuntimeClient[104202]                                                                                      
      Refresh the GrainTypeResolver failed. WIll be retried after                                                               
Orleans.Runtime.OrleansMessageRejectionException: Unexpected error serializing message to gateway gwy.tcp://10.0.1.18:10300/262055360. System.NullReferenceException: Object reference not set to an instance of an object.
    at Orleans.Serialization.SerializationManager.SerializeMessageHeaders(HeadersContainer headers SerializationContext context)
    at Orleans.Runtime.Message.Serialize(SerializationManager serializationManager Int32& headerLengthOut Int32& bodyLengthOut)
    at Orleans.Messaging.OutgoingMessageSender.Process(Message msg)                                                              
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()                                                            
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)                            
    at Orleans.Runtime.OutgoingCallInvoker.<Invoke>d__21.MoveNext()     

                                                         ","StatisticsLevel.Verbose causes serialization exceptions 
- Orleans 2.0

**config:**



**log:**
> warn: Messaging.GatewayConnection/GatewayClientSender_gwy.tcp://10.0.1.18:10300/262055360[100159]                               
      Unexpected error serializing message to gateway gwy.tcp://10.0.1.18:10300/262055360.                                      
System.NullReferenceException: Object reference not set to an instance of an object.                                            
   at Orleans.Serialization.SerializationManager.SerializeMessageHeaders(HeadersContainer headers SerializationContext context)
   at Orleans.Runtime.Message.Serialize(SerializationManager serializationManager Int32& headerLengthOut Int32& bodyLengthOut)
   at Orleans.Messaging.OutgoingMessageSender.Process(Message msg)                                                              
warn: Orleans.OutsideRuntimeClient[104202]                                                                                      
      Refresh the GrainTypeResolver failed. WIll be retried after                                                               
Orleans.Runtime.OrleansMessageRejectionException: Unexpected error serializing message to gateway gwy.tcp://10.0.1.18:10300/262055360. System.NullReferenceException: Object reference not set to an instance of an object.
    at Orleans.Serialization.SerializationManager.SerializeMessageHeaders(HeadersContainer headers SerializationContext context)
    at Orleans.Runtime.Message.Serialize(SerializationManager serializationManager Int32& headerLengthOut Int32& bodyLengthOut)
    at Orleans.Messaging.OutgoingMessageSender.Process(Message msg)                                                              
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()                                                            
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)                            
    at Orleans.Runtime.OutgoingCallInvoker.<Invoke>d__21.MoveNext()     

                                                         ",,ReubenBond,,
4498,[2.0] TestCluster .Deploy() / SiloHost.StartAsync().Wait() never return.,"Using Orleans 2.0 with .NET Core 2.0 I have a TestCluster set up as an xunit collection fixture:

 allows it to continue successfully.","[2.0] TestCluster .Deploy() / SiloHost.StartAsync().Wait() never return. Using Orleans 2.0 with .NET Core 2.0 I have a TestCluster set up as an xunit collection fixture:

 allows it to continue successfully.",,benjaminpetit,,
4496,Golden path multi-resource transactional grain testing,Add golden path tests for transactional grains which consist of 2 and TransactionTestConstants.MaxCoordinatedTransactions transactional resources.,Golden path multi-resource transactional grain testing Add golden path tests for transactional grains which consist of 2 and TransactionTestConstants.MaxCoordinatedTransactions transactional resources.,,jason-bragg,,
4491,Update Bond serialization provider to allow customizing protocol,Currently the Bond serialization provider does not allow the user to select the protocol being used and is using SimpleBinary which is *not* version tolerant. Hence the protocol should be configurable and the documentation should clearly state that this option needs to be configured for version-tolerant serialization.,Update Bond serialization provider to allow customizing protocol Currently the Bond serialization provider does not allow the user to select the protocol being used and is using SimpleBinary which is *not* version tolerant. Hence the protocol should be configurable and the documentation should clearly state that this option needs to be configured for version-tolerant serialization.,Hacktoberfest,ReubenBond,,
4488,Remove unused method and namespaces,"Remove unused method and namespaces
","Remove unused method and namespaces Remove unused method and namespaces
",,benjaminpetit,,
4487,Don't generate serializers for foreign types in Orleans.Streaming.EventHubs,,Don't generate serializers for foreign types in Orleans.Streaming.EventHubs ,,jason-bragg,,
4486,iis8 + orleans error!!!!!,"[2018-04-18 04:12:12.646 GMT 37	Information	100313	Orleans.OutsideRuntimeClient]	---------- Initializing OutsideRuntimeClient on ljsvr-2-27 at 192.168.2.27 Client Id = *cli/6c8ed7a4 ----------	
[2018-04-18 04:12:12.649 GMT 37	Information	100314	Orleans.OutsideRuntimeClient]	---------- Starting OutsideRuntimeClient with runtime Version='2.0.0. Commit Hash: 89ebbe67d2266b24b34e704935fe70577d30408a (Release).' in AppDomain=<AppDomain.Id=8 AppDomain.FriendlyName=/LM/W3SVC/57/ROOT/testmallol-7-131684983183817379>	
[2018-04-18 04:12:12.810 GMT 65	Information	101309	Orleans.Messaging.GatewayManager]	Found 2 knownGateways from Gateway listProvider [gwy.tcp://192.168.2.15:30000/261655706 gwy.tcp://192.168.2.27:30000/261709551]	
[2018-04-18 04:12:12.883 GMT 65	Warning	100178	Messaging.GatewayConnection/GatewayClientSender_gwy.tcp://192.168.2.27:30000/261709551]	Unable to connect to gateway at address gwy.tcp://192.168.2.27:30000/261709551 on trial 0 (Exception: 未能加载文件或程序集“System.Runtime.InteropServices.RuntimeInformation Version=0.0.0.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a”或它的某一个依赖项。找到的程序集清单定义与程序集引用不匹配。 (异常来自 HRESULT:0x80131040))	
[2018-04-18 04:12:12.885 GMT 65	Warning	100913	Messaging.GatewayConnection/GatewayClientSender_gwy.tcp://192.168.2.27:30000/261709551]	Marking gateway at address gwy.tcp://192.168.2.27:30000/261709551 as Disconnected	
[2018-04-18 04:12:12.892 GMT 50	Information	101309	Orleans.Messaging.GatewayManager]	Refreshed the live Gateway list. Found 2 gateways from Gateway listProvider: [gwy.tcp://192.168.2.15:30000/261655706 gwy.tcp://192.168.2.27:30000/261709551]. Picked only known live out of them. Now has 2 live Gateways: [gwy.tcp://192.168.2.15:30000/261655706 gwy.tcp://192.168.2.27:30000/261709551]. Previous refresh time was = 04/18/2018 04:12:12	","iis8 + orleans error!!!!! [2018-04-18 04:12:12.646 GMT 37	Information	100313	Orleans.OutsideRuntimeClient]	---------- Initializing OutsideRuntimeClient on ljsvr-2-27 at 192.168.2.27 Client Id = *cli/6c8ed7a4 ----------	
[2018-04-18 04:12:12.649 GMT 37	Information	100314	Orleans.OutsideRuntimeClient]	---------- Starting OutsideRuntimeClient with runtime Version='2.0.0. Commit Hash: 89ebbe67d2266b24b34e704935fe70577d30408a (Release).' in AppDomain=<AppDomain.Id=8 AppDomain.FriendlyName=/LM/W3SVC/57/ROOT/testmallol-7-131684983183817379>	
[2018-04-18 04:12:12.810 GMT 65	Information	101309	Orleans.Messaging.GatewayManager]	Found 2 knownGateways from Gateway listProvider [gwy.tcp://192.168.2.15:30000/261655706 gwy.tcp://192.168.2.27:30000/261709551]	
[2018-04-18 04:12:12.883 GMT 65	Warning	100178	Messaging.GatewayConnection/GatewayClientSender_gwy.tcp://192.168.2.27:30000/261709551]	Unable to connect to gateway at address gwy.tcp://192.168.2.27:30000/261709551 on trial 0 (Exception: 未能加载文件或程序集“System.Runtime.InteropServices.RuntimeInformation Version=0.0.0.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a”或它的某一个依赖项。找到的程序集清单定义与程序集引用不匹配。 (异常来自 HRESULT:0x80131040))	
[2018-04-18 04:12:12.885 GMT 65	Warning	100913	Messaging.GatewayConnection/GatewayClientSender_gwy.tcp://192.168.2.27:30000/261709551]	Marking gateway at address gwy.tcp://192.168.2.27:30000/261709551 as Disconnected	
[2018-04-18 04:12:12.892 GMT 50	Information	101309	Orleans.Messaging.GatewayManager]	Refreshed the live Gateway list. Found 2 gateways from Gateway listProvider: [gwy.tcp://192.168.2.15:30000/261655706 gwy.tcp://192.168.2.27:30000/261709551]. Picked only known live out of them. Now has 2 live Gateways: [gwy.tcp://192.168.2.15:30000/261655706 gwy.tcp://192.168.2.27:30000/261709551]. Previous refresh time was = 04/18/2018 04:12:12	",,ReubenBond,,
4485,Rearrange test projects for easier consolidation of references,This is another step toward enabling partial builds for patch releases.,Rearrange test projects for easier consolidation of references This is another step toward enabling partial builds for patch releases.,,ReubenBond,,
4480,Add autofac DI tests,both internal and external customer has reported they are using Autofac with Orleans. In theory Orleans should work with Autofac after fix #4453  I just want to ensure it really worksby adding DI tests running against Autofac DI container. ,Add autofac DI tests both internal and external customer has reported they are using Autofac with Orleans. In theory Orleans should work with Autofac after fix #4453  I just want to ensure it really worksby adding DI tests running against Autofac DI container. ,,ReubenBond,,
4479, Convert IMembershipTableGrain into a SystemTarget,Addresses https://github.com/dotnet/orleans/issues/3129. , Convert IMembershipTableGrain into a SystemTarget Addresses https://github.com/dotnet/orleans/issues/3129. ,,ReubenBond,,
4478,Is it possible to configure silo using DNS name instead of IP address,"Team
Below is code snippet for Silo host. Is there any option where I can configure endpoint using DNS name instead of IP address.

            var siloPort = Convert.ToInt32(ConfigurationManager.AppSettings[""SiloPort""]);
            var gatewayPort = Convert.ToInt32(ConfigurationManager.AppSettings[""GatewayPort""]);
            var advertisedIp = IPAddress.Parse(ConfigurationManager.AppSettings[""AdvertisedIP""]);
            var builder = new SiloHostBuilder()
                .Configure<ClusterOptions>(options =>
                {
                    options.ClusterId = ConfigurationManager.AppSettings(""CLUSTER_ID"");
                    options.ServiceId = ConfigurationManager.AppSettings(""SERVICE_ID"");
                })
                .ConfigureEndpoints(siloPort: siloPort gatewayPort: gatewayPort advertisedIP: advertisedIp)
                .UseConsulClustering(gatewayOptions =>
                {
                    gatewayOptions.Address =
                        new Uri(ConfigurationManager.AppSettings(""ServiceDiscoverEndPoint""));
                })

Thanks","Is it possible to configure silo using DNS name instead of IP address Team
Below is code snippet for Silo host. Is there any option where I can configure endpoint using DNS name instead of IP address.

            var siloPort = Convert.ToInt32(ConfigurationManager.AppSettings[""SiloPort""]);
            var gatewayPort = Convert.ToInt32(ConfigurationManager.AppSettings[""GatewayPort""]);
            var advertisedIp = IPAddress.Parse(ConfigurationManager.AppSettings[""AdvertisedIP""]);
            var builder = new SiloHostBuilder()
                .Configure<ClusterOptions>(options =>
                {
                    options.ClusterId = ConfigurationManager.AppSettings(""CLUSTER_ID"");
                    options.ServiceId = ConfigurationManager.AppSettings(""SERVICE_ID"");
                })
                .ConfigureEndpoints(siloPort: siloPort gatewayPort: gatewayPort advertisedIP: advertisedIp)
                .UseConsulClustering(gatewayOptions =>
                {
                    gatewayOptions.Address =
                        new Uri(ConfigurationManager.AppSettings(""ServiceDiscoverEndPoint""));
                })

Thanks",question,ReubenBond,17/04/2018 7:16,19/04/2018 0:54
4477,Orleans Core public surface insufficient for extension development,"External and application engineers cannot build extension libraries on Orleans without access to internals.  This is evidenced by our internally maintained extension libraries many of which require access to Orleans Core internals.

[assembly: InternalsVisibleTo(""Orleans.Clustering.AzureStorage"")]
[assembly: InternalsVisibleTo(""Orleans.Clustering.DynamoDB"")]
[assembly: InternalsVisibleTo(""Orleans.Hosting.AzureCloudServices"")]
[assembly: InternalsVisibleTo(""Orleans.Persistence.AzureStorage"")]
[assembly: InternalsVisibleTo(""Orleans.Persistence.DynamoDB"")]
[assembly: InternalsVisibleTo(""Orleans.Reminders.AzureStorage"")]
[assembly: InternalsVisibleTo(""Orleans.Reminders.DynamoDB"")]
[assembly: InternalsVisibleTo(""Orleans.Streaming.AzureStorage"")]
[assembly: InternalsVisibleTo(""Orleans.Streaming.EventHubs"")]
[assembly: InternalsVisibleTo(""Orleans.Streaming.SQS"")]
[assembly: InternalsVisibleTo(""Orleans.TelemetryConsumers.Counters"")]
[assembly: InternalsVisibleTo(""Orleans.Transactions.DynamoDB"")]

Internal access needs be removed for extension libraries.  Where extension libraries currently require internal access either alternate solutions need be found or the accessed capabilities need be exposed in maintainable public apis.
","Orleans Core public surface insufficient for extension development External and application engineers cannot build extension libraries on Orleans without access to internals.  This is evidenced by our internally maintained extension libraries many of which require access to Orleans Core internals.

[assembly: InternalsVisibleTo(""Orleans.Clustering.AzureStorage"")]
[assembly: InternalsVisibleTo(""Orleans.Clustering.DynamoDB"")]
[assembly: InternalsVisibleTo(""Orleans.Hosting.AzureCloudServices"")]
[assembly: InternalsVisibleTo(""Orleans.Persistence.AzureStorage"")]
[assembly: InternalsVisibleTo(""Orleans.Persistence.DynamoDB"")]
[assembly: InternalsVisibleTo(""Orleans.Reminders.AzureStorage"")]
[assembly: InternalsVisibleTo(""Orleans.Reminders.DynamoDB"")]
[assembly: InternalsVisibleTo(""Orleans.Streaming.AzureStorage"")]
[assembly: InternalsVisibleTo(""Orleans.Streaming.EventHubs"")]
[assembly: InternalsVisibleTo(""Orleans.Streaming.SQS"")]
[assembly: InternalsVisibleTo(""Orleans.TelemetryConsumers.Counters"")]
[assembly: InternalsVisibleTo(""Orleans.Transactions.DynamoDB"")]

Internal access needs be removed for extension libraries.  Where extension libraries currently require internal access either alternate solutions need be found or the accessed capabilities need be exposed in maintainable public apis.
",P2,sergeybykov,,
4476,changed framework to netcoreapp2.0,"The example uses .NET Framework 4.6.2. Changing it makes it easier for
others to get started; updated readme to reflect changes.

Signed-off-by: Mike Lloyd <mike@reboot3times.org>","changed framework to netcoreapp2.0 The example uses .NET Framework 4.6.2. Changing it makes it easier for
others to get started; updated readme to reflect changes.

Signed-off-by: Mike Lloyd <mike@reboot3times.org>",,benjaminpetit,,
4475,Question: Removing grain from data store,"Hi

What is the best way to remove a grain from data store (when the grain is not needed anymore)? The documentation describes how to persist read and write - but not to remove from store.

Kind regards
Jan","Question: Removing grain from data store Hi

What is the best way to remove a grain from data store (when the grain is not needed anymore)? The documentation describes how to persist read and write - but not to remove from store.

Kind regards
Jan",P3,sergeybykov,17/04/2018 3:07,
4473,TestCluster ignores UserLocalhostClustering,"I'm trying to set up TestCluster:

","TestCluster ignores UserLocalhostClustering I'm trying to set up TestCluster:

",,benjaminpetit,,
4469,Add serviceId parameters to ClientBuilder/ServiceHostBuilder helper methods,"Fix for #4468 

With this PR test failures from PR #4450 should be gone.

I added check to not override ClusterId/ServiceId set from this methods if they were set explicitely by a call to  before calling them.","Add serviceId parameters to ClientBuilder/ServiceHostBuilder helper methods Fix for #4468 

With this PR test failures from PR #4450 should be gone.

I added check to not override ClusterId/ServiceId set from this methods if they were set explicitely by a call to  before calling them.",,ReubenBond,,
4466,Question - Heterogenous Silo configuration in runtime,"Hello guys 
is it possible to make Heterogenous Silos configuration by supplying the same build package with all grain implementations but configuring which parts to host by AddApplicationParts or any similar way (but still referencing all grains)?
We are just considering to supply the silo with some config and select required set of grains ( and dependent services to inject etc. ) to host when starting the silo. 
It will be very useful if you have the silo capable of hosting N feature-sets and when the demand arises for some parts of functionality/services you can choose for which features you need to allocate more resources (and resource configurations required) and start additional silos only for these instead of running the one big silo.

","Question - Heterogenous Silo configuration in runtime Hello guys 
is it possible to make Heterogenous Silos configuration by supplying the same build package with all grain implementations but configuring which parts to host by AddApplicationParts or any similar way (but still referencing all grains)?
We are just considering to supply the silo with some config and select required set of grains ( and dependent services to inject etc. ) to host when starting the silo. 
It will be very useful if you have the silo capable of hosting N feature-sets and when the demand arises for some parts of functionality/services you can choose for which features you need to allocate more resources (and resource configurations required) and start additional silos only for these instead of running the one big silo.

",question,ReubenBond,,
4463,Copy elements in-place in InvokeMethodAsync,"Arguments passed to  (from generated GrainReference code) are copied in-place: i.e without creating a new argument array. This saves some cost in making calls without breaking semantics (reference equality between arguments). It saves one allocation per call and avoids invoking DeepCopyHelper for the array.

The distributed tests are too noisy for such a minor fix:

| Test | Run 1 | Run 2 | Run 3 | Run 4 | Master
|-|-|-|-|-|-|
| NightlyLoadTest | 235957 | 233753 | 239428 | 244787 | 240383
| ActivationCollectorStressTest | 256907 | 253961 | 261432 | 260869 | 250575
| PingLoadTest_LocalReentrant | 151081 | 146504 | 151071 | 137274 | 151688
| PingLoadTest_RandomReentrant_MultiSilos | 474047 | 271112 | 270071 | 285268 | 338229

cc @dVakulen
","Copy elements in-place in InvokeMethodAsync Arguments passed to  (from generated GrainReference code) are copied in-place: i.e without creating a new argument array. This saves some cost in making calls without breaking semantics (reference equality between arguments). It saves one allocation per call and avoids invoking DeepCopyHelper for the array.

The distributed tests are too noisy for such a minor fix:

| Test | Run 1 | Run 2 | Run 3 | Run 4 | Master
|-|-|-|-|-|-|
| NightlyLoadTest | 235957 | 233753 | 239428 | 244787 | 240383
| ActivationCollectorStressTest | 256907 | 253961 | 261432 | 260869 | 250575
| PingLoadTest_LocalReentrant | 151081 | 146504 | 151071 | 137274 | 151688
| PingLoadTest_RandomReentrant_MultiSilos | 474047 | 271112 | 270071 | 285268 | 338229

cc @dVakulen
",performance,dVakulen,13/04/2018 10:21,14/04/2018 0:02
4461,Move test grain interfaces and classes to Grains subdirectory,This is on top of #4460 to consolidate test grain interfaces and classes.,Move test grain interfaces and classes to Grains subdirectory This is on top of #4460 to consolidate test grain interfaces and classes.,,benjaminpetit,,
4458,Questions related to reliability,"Your implementation of the Actor pattern is obviously more geared around intuitiveness and implicit reliability than other implementations.  I do really like how intuitive things are however have 2 questions:

1. You obviously support streams which means one grain can fire off some request into a stream and then exit.  My question is; should streams be optional?  My understanding from reading the docs is that the most simple and intuitive route to follow is to not use them and to block (asynchronously) while dependant grains execute. However I think that I could easily get into more trouble using Orleans in this way than I would by developing traditional locking code.

Say I have a Grain A which depends on Grain B which depends on Grain C etc.  If Grain C maintains state but A and B don't then are potential activations of A and B blocked until C completes even though work could be performed in A and B during this period - perhaps A and B don't even always lead to C.

Hopefully it's clear what I'm trying to say.  In a sentence it makes perfect sense to make grains atomic however I'm not so sure about chains of grains.  

Have I misinterpreted the architecture? Assuming I haven't I'll repeat that I know I can use streams and there will be certain patterns I can follow to help me here.  I'm just wondering if there is any value in going the simple/intuitive route (if indeed it's better than a more traditional approach)?

2. I understand why streams are reliable and it's very nice to have this.  I'm not clear how to best use them though.  I'll give an example to demonstrate my question - along with some extra detail so you can correct me if I'm missing something fundamental:

Grain A posts a message to Stream A (it blocks while it's posting to the stream but after this can then return and handle further activations).  Now if for whatever reason the message posted to the stream isn't processed as expected (e.g. the grain which consumes the message doesn't die but somehow drops the message).  I'm assuming I have to build checks into my system for this type of thing?

If it is the case that I've got to build these checks into my system I'm wondering if it's worth paying the cost for the reliable stream?","Questions related to reliability Your implementation of the Actor pattern is obviously more geared around intuitiveness and implicit reliability than other implementations.  I do really like how intuitive things are however have 2 questions:

1. You obviously support streams which means one grain can fire off some request into a stream and then exit.  My question is; should streams be optional?  My understanding from reading the docs is that the most simple and intuitive route to follow is to not use them and to block (asynchronously) while dependant grains execute. However I think that I could easily get into more trouble using Orleans in this way than I would by developing traditional locking code.

Say I have a Grain A which depends on Grain B which depends on Grain C etc.  If Grain C maintains state but A and B don't then are potential activations of A and B blocked until C completes even though work could be performed in A and B during this period - perhaps A and B don't even always lead to C.

Hopefully it's clear what I'm trying to say.  In a sentence it makes perfect sense to make grains atomic however I'm not so sure about chains of grains.  

Have I misinterpreted the architecture? Assuming I haven't I'll repeat that I know I can use streams and there will be certain patterns I can follow to help me here.  I'm just wondering if there is any value in going the simple/intuitive route (if indeed it's better than a more traditional approach)?

2. I understand why streams are reliable and it's very nice to have this.  I'm not clear how to best use them though.  I'll give an example to demonstrate my question - along with some extra detail so you can correct me if I'm missing something fundamental:

Grain A posts a message to Stream A (it blocks while it's posting to the stream but after this can then return and handle further activations).  Now if for whatever reason the message posted to the stream isn't processed as expected (e.g. the grain which consumes the message doesn't die but somehow drops the message).  I'm assuming I have to build checks into my system for this type of thing?

If it is the case that I've got to build these checks into my system I'm wondering if it's worth paying the cost for the reliable stream?",question,jason-bragg,12/04/2018 23:00,22/06/2018 7:55
4455,Azure blob storage provider: respect UseJson setting,"Fixes #4439 

Submitted for testing","Azure blob storage provider: respect UseJson setting Fixes #4439 

Submitted for testing",,xiazen,,
4454,Question - Orleans real world usage scenario.,"Hi.
I'm new to orleans. I wonder if there are any useful scenarios using Orleans.
The only scenario i can think of this moment is ticketing service.
One of my customers have ticketing service for concerts.
When they host famous singer's concert they receive lots of traffic in
very short amounts of time like Ddos attacks.
As a results sometimes bottleneck is web servers sometimes it's database.
I think Orleans will help to mitigate this situation.
So i have two questions.

1.  Are there any other useful scenarios ?
2.  If I had to convert a traditional three-tier(webapidb) application into Orleans 
    what would it be changed? I know that this is a broad question but please give me 
    any descriptions or link to help me understand the general idea.
   (ex - Azure's table storage is recommended than traditional Relational Database)

Thanks.
      


","Question - Orleans real world usage scenario. Hi.
I'm new to orleans. I wonder if there are any useful scenarios using Orleans.
The only scenario i can think of this moment is ticketing service.
One of my customers have ticketing service for concerts.
When they host famous singer's concert they receive lots of traffic in
very short amounts of time like Ddos attacks.
As a results sometimes bottleneck is web servers sometimes it's database.
I think Orleans will help to mitigate this situation.
So i have two questions.

1.  Are there any other useful scenarios ?
2.  If I had to convert a traditional three-tier(webapidb) application into Orleans 
    what would it be changed? I know that this is a broad question but please give me 
    any descriptions or link to help me understand the general idea.
   (ex - Azure's table storage is recommended than traditional Relational Database)

Thanks.
      


",question,sergeybykov,12/04/2018 11:30,20/04/2018 13:41
4452,Update stream-extensibility section docs,fix for #4434 . the section is outdated still in the 1.5 and before state. ,Update stream-extensibility section docs fix for #4434 . the section is outdated still in the 1.5 and before state. ,documentation,ReubenBond,,
4450,Add validator for ClusterOptions,Currently we check that . I added a validator to test this.,Add validator for ClusterOptions Currently we check that . I added a validator to test this.,,ReubenBond,,
4449,why my orleans being slow with 3 node?,"when 1 node was running the client is fast
when 3 node was running the client is fast At first， but being slow after A few minutes。

 const string connectionString = ""Server=192.168.2.113;Database=TestOrleans;User Id=sa;Password=sa;"";

            //  var  configuration = new ConfigurationBuilder()
            //   .AddJsonFile(""HostSettings.json"" true true)
            //   .Build();
            //var port=  configuration.GetValue<int>(""configProperties:Net.Port"");
            //var gatePort=  configuration.GetValue<int>(""configProperties:GateWay.Port"");
            var netport = System.Configuration.ConfigurationManager.AppSettings[""netport""];
            var gatewayport = System.Configuration.ConfigurationManager.AppSettings[""gatewayport""];

            var silo = new SiloHostBuilder()
                .Configure<ClusterOptions>(options =>
                {
                    options.ClusterId = ""mycluster"";
                    options.ServiceId = ""product"";
                    
                })
                .Configure <GrainCollectionOptions>(options=> {
                    //配置grain的回收
                    options.CollectionAge = TimeSpan.FromMinutes(10);
                    options.CollectionQuantum = TimeSpan.FromMinutes(5);
                })
                .UseAdoNetClustering(options =>
                {
                    options.ConnectionString = connectionString;
                    options.Invariant = ""System.Data.SqlClient"";
                })
                
                .ConfigureEndpoints(System.Net.Dns.GetHostName()int .Parse( netport)int .Parse( gatewayport))
                
                .ConfigureLogging(logging =>logging.SetMinimumLevel(LogLevel.Warning).AddConsole())
                // .ConfigureLogging(builder => builder.SetMinimumLevel(LogLevel.Warning).AddConsole())
                .Build();

            silo.StartAsync().Wait();
            Console.WriteLine(""启动成功"");
            Console.Read();
            silo.Dispose();
","why my orleans being slow with 3 node? when 1 node was running the client is fast
when 3 node was running the client is fast At first， but being slow after A few minutes。

 const string connectionString = ""Server=192.168.2.113;Database=TestOrleans;User Id=sa;Password=sa;"";

            //  var  configuration = new ConfigurationBuilder()
            //   .AddJsonFile(""HostSettings.json"" true true)
            //   .Build();
            //var port=  configuration.GetValue<int>(""configProperties:Net.Port"");
            //var gatePort=  configuration.GetValue<int>(""configProperties:GateWay.Port"");
            var netport = System.Configuration.ConfigurationManager.AppSettings[""netport""];
            var gatewayport = System.Configuration.ConfigurationManager.AppSettings[""gatewayport""];

            var silo = new SiloHostBuilder()
                .Configure<ClusterOptions>(options =>
                {
                    options.ClusterId = ""mycluster"";
                    options.ServiceId = ""product"";
                    
                })
                .Configure <GrainCollectionOptions>(options=> {
                    //配置grain的回收
                    options.CollectionAge = TimeSpan.FromMinutes(10);
                    options.CollectionQuantum = TimeSpan.FromMinutes(5);
                })
                .UseAdoNetClustering(options =>
                {
                    options.ConnectionString = connectionString;
                    options.Invariant = ""System.Data.SqlClient"";
                })
                
                .ConfigureEndpoints(System.Net.Dns.GetHostName()int .Parse( netport)int .Parse( gatewayport))
                
                .ConfigureLogging(logging =>logging.SetMinimumLevel(LogLevel.Warning).AddConsole())
                // .ConfigureLogging(builder => builder.SetMinimumLevel(LogLevel.Warning).AddConsole())
                .Build();

            silo.StartAsync().Wait();
            Console.WriteLine(""启动成功"");
            Console.Read();
            silo.Dispose();
",question,sergeybykov,11/04/2018 20:05,9/05/2018 2:13
4448,One or more errors occurred. (Not connected to a gateway),"Hi

We are running 2 small sized worker roles (Orleans 2.0) and client app service (ASP.Net core) also networked as per the [documentation](http://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Using-Azure-Web-Apps.html) App service and orleans silo(cloudservice) share same vNET and configured the subnet of vNET to Network security group. Both workerrole and appservice use same clusterId and serviceId.

While trying to connect from azure app service(client) to orleans silo(workerrole) am getting an error in client as ""Not connected to a gateway"" can someone help me what configurations should do to resolve this?

Below is the error log

An error occurred while starting the application.
AggregateException: One or more errors occurred. (Not connected to a gateway)
System.Threading.Tasks.Task.ThrowIfExceptional(bool includeTaskCanceledExceptions)

OrleansException: Not connected to a gateway
Orleans.Messaging.ClientMessageCenter.GetLiveGatewaySiloAddress()

AggregateException: One or more errors occurred. (Not connected to a gateway)
System.Threading.Tasks.Task.ThrowIfExceptional(bool includeTaskCanceledExceptions)
System.Threading.Tasks.Task.Wait(int millisecondsTimeout CancellationToken cancellationToken)
NetCoreSPA.Startup+<>c__DisplayClass5_0.<ConfigureServices>b__0(IServiceProvider sp) in Startup.cs
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite ServiceProvider provider)
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor.VisitCallSite(IServiceCallSite callSite TArgument argument)
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite ServiceProvider provider)
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitSingleton(SingletonCallSite singletonCallSite ServiceProvider provider)
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor.VisitCallSite(IServiceCallSite callSite TArgument argument)
Microsoft.Extensions.DependencyInjection.ServiceProvider+<>c__DisplayClass22_0.<RealizeService>b__0(ServiceProvider provider)
Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService<T>(IServiceProvider provider)
NetCoreSPA.Startup.Configure(IApplicationBuilder app IHostingEnvironment env) in Startup.cs
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter+<>c__DisplayClass3_0.<Configure>b__0(IApplicationBuilder app)
Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter+<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()

Show raw exception details
OrleansException: Not connected to a gateway
Orleans.Messaging.ClientMessageCenter.GetLiveGatewaySiloAddress()
Orleans.Messaging.ClientMessageCenter.GetImplicitStreamSubscriberTable(IInternalGrainFactory grainFactory)
Orleans.OutsideRuntimeClient+<StreamingInitialize>d__56.MoveNext()
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
Orleans.OutsideRuntimeClient+<<StartInternal>g__ExecuteWithRetries58_3>d.MoveNext()
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
Orleans.OutsideRuntimeClient+<StartInternal>d__58.MoveNext()
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
Orleans.OutsideRuntimeClient+<Start>d__57.MoveNext()
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
Orleans.ClusterClient+<Connect>d__19.MoveNext()

Show raw exception details
Orleans.Runtime.OrleansException: Not connected to a gateway
   at Orleans.Messaging.ClientMessageCenter.GetLiveGatewaySiloAddress()
   at Orleans.Messaging.ClientMessageCenter.GetImplicitStreamSubscriberTable(IInternalGrainFactory grainFactory)
   at Orleans.OutsideRuntimeClient.<StreamingInitialize>d__56.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Orleans.OutsideRuntimeClient.<<StartInternal>g__ExecuteWithRetries58_3>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Orleans.OutsideRuntimeClient.<StartInternal>d__58.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Orleans.OutsideRuntimeClient.<Start>d__57.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Orleans.ClusterClient.<Connect>d__19.MoveNext()


![image](https://user-images.githubusercontent.com/37177494/38605000-b70a555a-3d8f-11e8-9563-3f0d0b69ff52.png)
","One or more errors occurred. (Not connected to a gateway) Hi

We are running 2 small sized worker roles (Orleans 2.0) and client app service (ASP.Net core) also networked as per the [documentation](http://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Using-Azure-Web-Apps.html) App service and orleans silo(cloudservice) share same vNET and configured the subnet of vNET to Network security group. Both workerrole and appservice use same clusterId and serviceId.

While trying to connect from azure app service(client) to orleans silo(workerrole) am getting an error in client as ""Not connected to a gateway"" can someone help me what configurations should do to resolve this?

Below is the error log

An error occurred while starting the application.
AggregateException: One or more errors occurred. (Not connected to a gateway)
System.Threading.Tasks.Task.ThrowIfExceptional(bool includeTaskCanceledExceptions)

OrleansException: Not connected to a gateway
Orleans.Messaging.ClientMessageCenter.GetLiveGatewaySiloAddress()

AggregateException: One or more errors occurred. (Not connected to a gateway)
System.Threading.Tasks.Task.ThrowIfExceptional(bool includeTaskCanceledExceptions)
System.Threading.Tasks.Task.Wait(int millisecondsTimeout CancellationToken cancellationToken)
NetCoreSPA.Startup+<>c__DisplayClass5_0.<ConfigureServices>b__0(IServiceProvider sp) in Startup.cs
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite ServiceProvider provider)
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor.VisitCallSite(IServiceCallSite callSite TArgument argument)
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite ServiceProvider provider)
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitSingleton(SingletonCallSite singletonCallSite ServiceProvider provider)
Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor.VisitCallSite(IServiceCallSite callSite TArgument argument)
Microsoft.Extensions.DependencyInjection.ServiceProvider+<>c__DisplayClass22_0.<RealizeService>b__0(ServiceProvider provider)
Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)
Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService<T>(IServiceProvider provider)
NetCoreSPA.Startup.Configure(IApplicationBuilder app IHostingEnvironment env) in Startup.cs
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
Microsoft.AspNetCore.Server.IISIntegration.IISSetupFilter+<>c__DisplayClass3_0.<Configure>b__0(IApplicationBuilder app)
Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter+<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()

Show raw exception details
OrleansException: Not connected to a gateway
Orleans.Messaging.ClientMessageCenter.GetLiveGatewaySiloAddress()
Orleans.Messaging.ClientMessageCenter.GetImplicitStreamSubscriberTable(IInternalGrainFactory grainFactory)
Orleans.OutsideRuntimeClient+<StreamingInitialize>d__56.MoveNext()
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
Orleans.OutsideRuntimeClient+<<StartInternal>g__ExecuteWithRetries58_3>d.MoveNext()
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
Orleans.OutsideRuntimeClient+<StartInternal>d__58.MoveNext()
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
Orleans.OutsideRuntimeClient+<Start>d__57.MoveNext()
System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
Orleans.ClusterClient+<Connect>d__19.MoveNext()

Show raw exception details
Orleans.Runtime.OrleansException: Not connected to a gateway
   at Orleans.Messaging.ClientMessageCenter.GetLiveGatewaySiloAddress()
   at Orleans.Messaging.ClientMessageCenter.GetImplicitStreamSubscriberTable(IInternalGrainFactory grainFactory)
   at Orleans.OutsideRuntimeClient.<StreamingInitialize>d__56.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Orleans.OutsideRuntimeClient.<<StartInternal>g__ExecuteWithRetries58_3>d.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Orleans.OutsideRuntimeClient.<StartInternal>d__58.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Orleans.OutsideRuntimeClient.<Start>d__57.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Orleans.ClusterClient.<Connect>d__19.MoveNext()


![image](https://user-images.githubusercontent.com/37177494/38605000-b70a555a-3d8f-11e8-9563-3f0d0b69ff52.png)
",,ReubenBond,,
4446,Proposal for fine-grain control of package versions,"This is a proposal for #4445.

https://github.com/dotnet/orleans/commit/4d9e8de210f8542a5b8533dd0f74b98be2825b78 defines the build variables.

https://github.com/dotnet/orleans/commit/0689e7ff27cb613eb257cae4325f84736795f7fd moves intra-solution project references from .csproj files into per-directory  to 2.1.0 for the next minor release.","Proposal for fine-grain control of package versions This is a proposal for #4445.

https://github.com/dotnet/orleans/commit/4d9e8de210f8542a5b8533dd0f74b98be2825b78 defines the build variables.

https://github.com/dotnet/orleans/commit/0689e7ff27cb613eb257cae4325f84736795f7fd moves intra-solution project references from .csproj files into per-directory  to 2.1.0 for the next minor release.",,ReubenBond,,
4443,High memory consumption by SerializationContext in SerializationManager,"I noticed memory slowly being exhausted on client side servers.  A process dump from one server shows over 5GB of memory for SerializationContext records.  This averages 11MB / instance.

Count    TotalSize        Class Name
480        5629484224  System.Collections.Generic.Dictionary1+LinkedSlot[[Orleans.Serialization.SerializationContext Orleans]]
.....

This process dump showed 591 background threads and based on the count above a lot of these seem to have an Orleans serialization context in thread local storage.  Would it be more memory efficient to keep a pool of SerializationContexts inside the SerializationManager instead of using ThreadLocal storage?  

Our application does have objects with large serialization subgraphs but even if we reduced this from an average of 11MB to say 2MB if there are 500 threads with a SerializationContext in local storage we're still looking at 1GB of consumed memory.  We don't create threads and most of the threads in the process dump are marked (Threadpool Worker) so I'm not sure we have a good way to reduce thread count.","High memory consumption by SerializationContext in SerializationManager I noticed memory slowly being exhausted on client side servers.  A process dump from one server shows over 5GB of memory for SerializationContext records.  This averages 11MB / instance.

Count    TotalSize        Class Name
480        5629484224  System.Collections.Generic.Dictionary1+LinkedSlot[[Orleans.Serialization.SerializationContext Orleans]]
.....

This process dump showed 591 background threads and based on the count above a lot of these seem to have an Orleans serialization context in thread local storage.  Would it be more memory efficient to keep a pool of SerializationContexts inside the SerializationManager instead of using ThreadLocal storage?  

Our application does have objects with large serialization subgraphs but even if we reduced this from an average of 11MB to say 2MB if there are 500 threads with a SerializationContext in local storage we're still looking at 1GB of consumed memory.  We don't create threads and most of the threads in the process dump are marked (Threadpool Worker) so I'm not sure we have a good way to reduce thread count.",,ReubenBond,,
4442,StructureMap and Orleans,"Hi! I try to integrate the StructureMap in Orleans (v 2.0.0).

I use the following code:

 throws an exception:
""Specified argument was out of the range of valid values.
Parameter name: Orleans.Runtime.StatelessWorkerPlacement must have at least one public constructor to be plugged in by StructureMap"".

So what is the correct way to inject StructureMap into Orleans DI framework?","StructureMap and Orleans Hi! I try to integrate the StructureMap in Orleans (v 2.0.0).

I use the following code:

 throws an exception:
""Specified argument was out of the range of valid values.
Parameter name: Orleans.Runtime.StatelessWorkerPlacement must have at least one public constructor to be plugged in by StructureMap"".

So what is the correct way to inject StructureMap into Orleans DI framework?",,xiazen,,
4441,Large Number of threads,"is a large number of threads used by a silo an indication of blocking IO operation ?
and what could be else  causing such ?

by large number i mean 600 threads per silo

","Large Number of threads is a large number of threads used by a silo an indication of blocking IO operation ?
and what could be else  causing such ?

by large number i mean 600 threads per silo

",,ReubenBond,,
4439,Azure blob storage provider ignores UseJson option,Currently the provider does not access the UseJson property and will always use JSON for serialization.,Azure blob storage provider ignores UseJson option Currently the provider does not access the UseJson property and will always use JSON for serialization.,,ReubenBond,,
4438,Clarify UseDevelopmentClustering and UseLocalhostClustering,"Fixes #4421
","Clarify UseDevelopmentClustering and UseLocalhostClustering Fixes #4421
",,benjaminpetit,,
4437,[2.0][question] Is it possible to opt out (partially) from CodeGen?,"When I have a custom serializer for the grain state is it necessary to generate anything for it?

Currently I refer System.Activities + related .dll-s codegen goes berserk and generates the whole world and beyond it generates 2k lines of code even for  interface.

Is it somehow possible to opt out on some level from codegen? Eg. opt out the complete chain starting from System.Activities and other assemblies and optionally opt in some simple types???","[2.0][question] Is it possible to opt out (partially) from CodeGen? When I have a custom serializer for the grain state is it necessary to generate anything for it?

Currently I refer System.Activities + related .dll-s codegen goes berserk and generates the whole world and beyond it generates 2k lines of code even for  interface.

Is it somehow possible to opt out on some level from codegen? Eg. opt out the complete chain starting from System.Activities and other assemblies and optionally opt in some simple types???",,ReubenBond,,
4436,Issues with IClusterClient,1. Should we call  (or other Task-based approach).,Issues with IClusterClient 1. Should we call  (or other Task-based approach).,,ReubenBond,,
4434,Orleans Streams Extensibility: Writing a Custom Queue Adapter for 2.0,"Team
Please guide me how to implement custom stream provider.

Below documentation doesn't seems to be correct for Orleans 2.0.
https://dotnet.github.io/orleans/Documentation/Orleans-Streams/Streams-Extensibility.html

Step 4: as per above link
4. Declare public class MyQueueStreamProvider : PersistentStreamProvider<MyQueueFactory>. This is your new Stream Provider.

Thanks","Orleans Streams Extensibility: Writing a Custom Queue Adapter for 2.0 Team
Please guide me how to implement custom stream provider.

Below documentation doesn't seems to be correct for Orleans 2.0.
https://dotnet.github.io/orleans/Documentation/Orleans-Streams/Streams-Extensibility.html

Step 4: as per above link
4. Declare public class MyQueueStreamProvider : PersistentStreamProvider<MyQueueFactory>. This is your new Stream Provider.

Thanks",P3,jason-bragg,,
4431,NullReferenceException when Silo is configured to use EventHub,"We're trying to use 



","NullReferenceException when Silo is configured to use EventHub We're trying to use 



",,xiazen,,
4428,[2.0]Orleans does not have an instance or document for unit testing. Only 1.5 versions of the document seem to be outdated.,Orleans does not have an instance or document for unit testing. Only 1.5 versions of the document seem to be outdated.,[2.0]Orleans does not have an instance or document for unit testing. Only 1.5 versions of the document seem to be outdated. Orleans does not have an instance or document for unit testing. Only 1.5 versions of the document seem to be outdated.,P3,JillHeaden,,
4427,ClusterClient.Connect() retryFilter causes NullReferenceException,"Introduced with #4161.

First bug (?): When client tries to connect but fails in ","ClusterClient.Connect() retryFilter causes NullReferenceException Introduced with #4161.

First bug (?): When client tries to connect but fails in ",,ReubenBond,,
4426,Azure Queues Orleans.Streams.QueueCacheMissException ,We are using 2.0.0 with Azure Queues we are getting a ,Azure Queues Orleans.Streams.QueueCacheMissException  We are using 2.0.0 with Azure Queues we are getting a ,,xiazen,,
4421,Local and Development clustering?," says: ""Configures the silo to use development-only clustering"".

What is the difference between localhost and development clustering? What is involved in the ""development and testing"" configuration? What does ""development-only"" clustering mean?

The method docs should be improved to explain what they actually do and why there are two different methods for what seems to be the same thing. This should also be added to the online documentation if it is not already there.","Local and Development clustering?  says: ""Configures the silo to use development-only clustering"".

What is the difference between localhost and development clustering? What is involved in the ""development and testing"" configuration? What does ""development-only"" clustering mean?

The method docs should be improved to explain what they actually do and why there are two different methods for what seems to be the same thing. This should also be added to the online documentation if it is not already there.",,ReubenBond,,
4420,Application Parts usability issues,"I think there are several areas where this new ""Application Parts"" concept can be improved.

First of all why ""application parts""? As someone new to the term I see it as something very vague and unintuitive. What is an ""application part"" anyway? Is it just a location where grains are loaded or does it serve some additional purpose? Why was there the need to confuse people with a new term rather than just providing an API like  do?

Well let's check out the method documentation:

![image](https://user-images.githubusercontent.com/13241564/38455761-aa8b1012-3a74-11e8-85f3-bb323411a625.png)

![image](https://user-images.githubusercontent.com/13241564/38455769-bf2421d0-3a74-11e8-893a-31da9eb28631.png)

![image](https://user-images.githubusercontent.com/13241564/38455773-dde649f4-3a74-11e8-8eee-541c730f616e.png)

![image](https://user-images.githubusercontent.com/13241564/38455780-ebde5308-3a74-11e8-9f5e-a20907dbcff2.png)

As it turns out [Application Parts documentation](https://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Configuration-Guide/Server-Configuration.html) is buried deep within the Deployment section of the documentation.

> ""Although this step is not technically required (if not configured Orleans will scan all assembly in the current folder) developers are encouraged to configure this. This step will help Orleans to load user assemblies and types. These assemblies are referred to as Application Parts. All Grains Grain Interfaces and Serializers are discovered using Application Parts.""

If developers are encouraged to configure application parts then I believe they should be referenced in all documentation which describes setting up a basic silo. That includes the [Hello World sample documentation](https://dotnet.github.io/orleans/Documentation/Samples-Overview/Hello-World.html) and [Running the Application](https://dotnet.github.io/orleans/Documentation/Getting-Started-With-Orleans/Running-the-Application.html) (although this needs to be cleaned up first as per #4416).","Application Parts usability issues I think there are several areas where this new ""Application Parts"" concept can be improved.

First of all why ""application parts""? As someone new to the term I see it as something very vague and unintuitive. What is an ""application part"" anyway? Is it just a location where grains are loaded or does it serve some additional purpose? Why was there the need to confuse people with a new term rather than just providing an API like  do?

Well let's check out the method documentation:

![image](https://user-images.githubusercontent.com/13241564/38455761-aa8b1012-3a74-11e8-85f3-bb323411a625.png)

![image](https://user-images.githubusercontent.com/13241564/38455769-bf2421d0-3a74-11e8-893a-31da9eb28631.png)

![image](https://user-images.githubusercontent.com/13241564/38455773-dde649f4-3a74-11e8-8eee-541c730f616e.png)

![image](https://user-images.githubusercontent.com/13241564/38455780-ebde5308-3a74-11e8-9f5e-a20907dbcff2.png)

As it turns out [Application Parts documentation](https://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Configuration-Guide/Server-Configuration.html) is buried deep within the Deployment section of the documentation.

> ""Although this step is not technically required (if not configured Orleans will scan all assembly in the current folder) developers are encouraged to configure this. This step will help Orleans to load user assemblies and types. These assemblies are referred to as Application Parts. All Grains Grain Interfaces and Serializers are discovered using Application Parts.""

If developers are encouraged to configure application parts then I believe they should be referenced in all documentation which describes setting up a basic silo. That includes the [Hello World sample documentation](https://dotnet.github.io/orleans/Documentation/Samples-Overview/Hello-World.html) and [Running the Application](https://dotnet.github.io/orleans/Documentation/Getting-Started-With-Orleans/Running-the-Application.html) (although this needs to be cleaned up first as per #4416).",,ReubenBond,,
4419,Issues with Hello World sample documentation,"The [Hello World sample documentation](https://dotnet.github.io/orleans/Documentation/Samples-Overview/Hello-World.html) could use a few improvements:

1. Missing  in this case) as anyone not already familiar with that will be scratching his head and wondering why it's not working.
4. As per #4417 the code does not work if it all resides in the same project.

Additionally the interface/grain code samples can be simplified as follows:

    public interface IHello : IGrainWithIntegerKey
    {
        Task<string> SayHello(string greeting);
    }

    public class HelloGrain : Grain IHello
    {
        Task<string> IHello.SayHello(string greeting)
            => Task.FromResult($""You said: '{greeting}' I say: Hello!"");
    }","Issues with Hello World sample documentation The [Hello World sample documentation](https://dotnet.github.io/orleans/Documentation/Samples-Overview/Hello-World.html) could use a few improvements:

1. Missing  in this case) as anyone not already familiar with that will be scratching his head and wondering why it's not working.
4. As per #4417 the code does not work if it all resides in the same project.

Additionally the interface/grain code samples can be simplified as follows:

    public interface IHello : IGrainWithIntegerKey
    {
        Task<string> SayHello(string greeting);
    }

    public class HelloGrain : Grain IHello
    {
        Task<string> IHello.SayHello(string greeting)
            => Task.FromResult($""You said: '{greeting}' I say: Hello!"");
    }",P3,JillHeaden,,
4418,Orleans not recognising ServerGC setting,"I am running Orleans in a .NET Core console app. The project is basically the same as #4417.

In order to turn on ServerGC I follow [this Stack Overflow answer](https://stackoverflow.com/a/44035370/983064) and add the following in my  file:

    <PropertyGroup>
      <ServerGarbageCollection>true</ServerGarbageCollection>
    </PropertyGroup>

Despite this I still get the following warning:

> info: Orleans.Runtime.Silo[100404]
>       Silo starting with GC settings: ServerGC=False GCLatencyMode=Interactive
> warn: Orleans.Runtime.Silo[100405]
>       Note: Silo not running with ServerGC turned on - recommend checking app config : <configuration>-<runtime>-<gcServer enabled=""true"">
> warn: Orleans.Runtime.Silo[100405]
>       Note: ServerGC only kicks in on multi-core systems (settings enabling ServerGC have no effect on single-core machines).","Orleans not recognising ServerGC setting I am running Orleans in a .NET Core console app. The project is basically the same as #4417.

In order to turn on ServerGC I follow [this Stack Overflow answer](https://stackoverflow.com/a/44035370/983064) and add the following in my  file:

    <PropertyGroup>
      <ServerGarbageCollection>true</ServerGarbageCollection>
    </PropertyGroup>

Despite this I still get the following warning:

> info: Orleans.Runtime.Silo[100404]
>       Silo starting with GC settings: ServerGC=False GCLatencyMode=Interactive
> warn: Orleans.Runtime.Silo[100405]
>       Note: Silo not running with ServerGC turned on - recommend checking app config : <configuration>-<runtime>-<gcServer enabled=""true"">
> warn: Orleans.Runtime.Silo[100405]
>       Note: ServerGC only kicks in on multi-core systems (settings enabling ServerGC have no effect on single-core machines).",,benjaminpetit,,
4416,Running the Application documentation obsolete,The [Running the Application](https://dotnet.github.io/orleans/Documentation/Getting-Started-With-Orleans/Running-the-Application.html) documentation is obsolete probably based on Orleans 1.5 and does not work with Orleans 2.0.,Running the Application documentation obsolete The [Running the Application](https://dotnet.github.io/orleans/Documentation/Getting-Started-With-Orleans/Running-the-Application.html) documentation is obsolete probably based on Orleans 1.5 and does not work with Orleans 2.0.,P3,JillHeaden,,
4415,Startup Task fails when old member in membership table,"I cannot reproduce it yet but sometimes my application fails to start. When I have old members in the membership table I sometimes get this error:



(I just changed the IP address of the entry to simulate it therefore the message might be not 100% correct). 

For me it seems that the startup tasks are running before the state of the old entries is clarified.  In my startup tasks I run a method on a grain to activate it.","Startup Task fails when old member in membership table I cannot reproduce it yet but sometimes my application fails to start. When I have old members in the membership table I sometimes get this error:



(I just changed the IP address of the entry to simulate it therefore the message might be not 100% correct). 

For me it seems that the startup tasks are running before the state of the old entries is clarified.  In my startup tasks I run a method on a grain to activate it.",,benjaminpetit,,
4414,Client hangs in 2.0," In 2.0rc1 I used the following config. The client is co-hosted in the same process



It works when I change it to:

    builder.ConfigureEndpoints(IPAddress.Loopback 11111 40000 listenOnAnyHostAddress: true)

But I have no idea how the advertised IP address is related to the client connection.","Client hangs in 2.0  In 2.0rc1 I used the following config. The client is co-hosted in the same process



It works when I change it to:

    builder.ConfigureEndpoints(IPAddress.Loopback 11111 40000 listenOnAnyHostAddress: true)

But I have no idea how the advertised IP address is related to the client connection.",,benjaminpetit,,
4413,Move Service Fabric projects to Azure folder,For better code organization and to simplify future independent versioning of packages.,Move Service Fabric projects to Azure folder For better code organization and to simplify future independent versioning of packages.,,benjaminpetit,,
4410,Issue in configuring Orleans Load balancing,"
I have 2 Silos running on 2 different ports and is using consul for clustering. Now I have multiple clients trying to connect to the host to invoke a grain but it seems the request is always going to the first silo. As soon as I bring the first Silo down the requests starts flowing to the 2nd Silo.

Not sure what I'm missing here any help is highly appreciated. Please find below the code for Silo host and the client. 

Silo Host configuration
+++++++++++++++
 var builder = new SiloHostBuilder()
                    .Configure<ClusterOptions>(options =>
                    {
                        options.ClusterId = ""Clust1"";
                        options.ServiceId = ""Service1"";
                    })
                    .UseServiceProviderFactory(HostStartUp.ConfigureServices)
                    .UseConsulClustering(gatewayOptions =>
                    {
                        gatewayOptions.Address =
                            new Uri(ConfigurationManager.AppSettings[""ServiceDiscoverEndPoint""]);
                    })
                    .Configure<EndpointOptions>(options =>
                    {
                        options.SiloPort = Convert.ToInt32(ConfigurationManager.AppSettings[""SiloPort""]);
                        options.GatewayPort = Convert.ToInt32(ConfigurationManager.AppSettings[""GatewayPort""]);
                        options.AdvertisedIPAddress =
                            IPAddress.Parse(ConfigurationManager.AppSettings[""AdvertisedIPAddress""]);
                    })
                    .AddMemoryGrainStorageAsDefault();

                var host = builder.Build();
                host.StartAsync().Wait();

Client Configuration
+++++++++++++

 var builder = new SiloHostBuilder()
                    .UseLocalhostClustering()
                    .Configure<ClusterOptions>(options =>
                    {
                        options.ClusterId = ""Cluster1"";
                        options.ServiceId = ""Service1"";
                    })
                    .UseServiceProviderFactory(HostStartUp.ConfigureServices)
                    .Configure<EndpointOptions>(options => options.AdvertisedIPAddress = IPAddress.Loopback);
                var client = builder.Build();
                await client.StartAsync().Wait();




","Issue in configuring Orleans Load balancing 
I have 2 Silos running on 2 different ports and is using consul for clustering. Now I have multiple clients trying to connect to the host to invoke a grain but it seems the request is always going to the first silo. As soon as I bring the first Silo down the requests starts flowing to the 2nd Silo.

Not sure what I'm missing here any help is highly appreciated. Please find below the code for Silo host and the client. 

Silo Host configuration
+++++++++++++++
 var builder = new SiloHostBuilder()
                    .Configure<ClusterOptions>(options =>
                    {
                        options.ClusterId = ""Clust1"";
                        options.ServiceId = ""Service1"";
                    })
                    .UseServiceProviderFactory(HostStartUp.ConfigureServices)
                    .UseConsulClustering(gatewayOptions =>
                    {
                        gatewayOptions.Address =
                            new Uri(ConfigurationManager.AppSettings[""ServiceDiscoverEndPoint""]);
                    })
                    .Configure<EndpointOptions>(options =>
                    {
                        options.SiloPort = Convert.ToInt32(ConfigurationManager.AppSettings[""SiloPort""]);
                        options.GatewayPort = Convert.ToInt32(ConfigurationManager.AppSettings[""GatewayPort""]);
                        options.AdvertisedIPAddress =
                            IPAddress.Parse(ConfigurationManager.AppSettings[""AdvertisedIPAddress""]);
                    })
                    .AddMemoryGrainStorageAsDefault();

                var host = builder.Build();
                host.StartAsync().Wait();

Client Configuration
+++++++++++++

 var builder = new SiloHostBuilder()
                    .UseLocalhostClustering()
                    .Configure<ClusterOptions>(options =>
                    {
                        options.ClusterId = ""Cluster1"";
                        options.ServiceId = ""Service1"";
                    })
                    .UseServiceProviderFactory(HostStartUp.ConfigureServices)
                    .Configure<EndpointOptions>(options => options.AdvertisedIPAddress = IPAddress.Loopback);
                var client = builder.Build();
                await client.StartAsync().Wait();




",P3,benjaminpetit,,
4409,System.InvalidOperationException: 'Grain was created outside of the Orleans creation process and no runtime was specified.',"Team

Am getting below exception while trying to call a grain in startup task during silohost generation:
System.InvalidOperationException: 'Grain was created outside of the Orleans creation process and no runtime was specified.'
Grain Constructor: Exception is thrown in first line : GetStreamProvider
public Aggregator()
        {
            var streamProvider = GetStreamProvider(""samplestream"");
            _stream = streamProvider.GetStream<RequestMessage>(Guid.NewGuid() ""TestNamespace"");
            this._observer = GrainFactory.GetGrain<ITestObserver>(Guid.Empty);
        }

Thanks","System.InvalidOperationException: 'Grain was created outside of the Orleans creation process and no runtime was specified.' Team

Am getting below exception while trying to call a grain in startup task during silohost generation:
System.InvalidOperationException: 'Grain was created outside of the Orleans creation process and no runtime was specified.'
Grain Constructor: Exception is thrown in first line : GetStreamProvider
public Aggregator()
        {
            var streamProvider = GetStreamProvider(""samplestream"");
            _stream = streamProvider.GetStream<RequestMessage>(Guid.NewGuid() ""TestNamespace"");
            this._observer = GrainFactory.GetGrain<ITestObserver>(Guid.Empty);
        }

Thanks",,ReubenBond,,
4408,Move IHealthCheckable from Core.Abstractions to Core,There is no need for IHealthCheckable to be in Core.Abstractions as it has nothing to do with developing grain code. If we don't move it we'll be forced to update the Core.Abstractions package in the next release which isn't really necessary.,Move IHealthCheckable from Core.Abstractions to Core There is no need for IHealthCheckable to be in Core.Abstractions as it has nothing to do with developing grain code. If we don't move it we'll be forced to update the Core.Abstractions package in the next release which isn't really necessary.,,ReubenBond,,
4407,DependencyResolutionException while using Autofac & SMS,"Hello

After start using SMS in Host configuration I have been having below exceptions.  

Exception 1:
DependencyResolutionException: An error occurred during the activation of a particular registration. See the inner exception for details. Registration: Activator = IGrainStorage (DelegateActivator) Services = [Orleans.Storage.IGrainStorage] Lifetime = Autofac.Core.Lifetime.RootScopeLifetime Sharing = Shared Ownership = OwnedByLifetimeScope
Exception 2:
DependencyResolutionException: A delegate registered to create instances of 'Orleans.Storage.IGrainStorage' returned null.

Code Snippet:
var builder = new SiloHostBuilder()
                .Configure<ClusterOptions>(options => options.ClusterId = ""TestCluster"")
                .UseDevelopmentClustering(
                    options => options.PrimarySiloEndpoint = new IPEndPoint(siloAddress siloPort))
                .ConfigureEndpoints(siloAddress siloPort gatewayPort)
                .AddMemoryGrainStorage(""PubSubStore"")
                .AddSimpleMessageStreamProvider(""Teststream"")
                .UseServiceProviderFactory(Startup.ConfigureServices)
                .ConfigureApplicationParts(parts =>
                    parts.AddApplicationPart(typeof(IEventAggregator).Assembly).WithReferences());

Startup:
  public static IServiceProvider ConfigureServices(IServiceCollection services)
        {
            var builder = new ContainerBuilder();
            builder.Populate(services);
            builder.RegisterModule<TestModule>();
            var container = builder.Build();
            //Create the IServiceProvider based on the container.
            return new AutofacServiceProvider(container);
        }","DependencyResolutionException while using Autofac & SMS Hello

After start using SMS in Host configuration I have been having below exceptions.  

Exception 1:
DependencyResolutionException: An error occurred during the activation of a particular registration. See the inner exception for details. Registration: Activator = IGrainStorage (DelegateActivator) Services = [Orleans.Storage.IGrainStorage] Lifetime = Autofac.Core.Lifetime.RootScopeLifetime Sharing = Shared Ownership = OwnedByLifetimeScope
Exception 2:
DependencyResolutionException: A delegate registered to create instances of 'Orleans.Storage.IGrainStorage' returned null.

Code Snippet:
var builder = new SiloHostBuilder()
                .Configure<ClusterOptions>(options => options.ClusterId = ""TestCluster"")
                .UseDevelopmentClustering(
                    options => options.PrimarySiloEndpoint = new IPEndPoint(siloAddress siloPort))
                .ConfigureEndpoints(siloAddress siloPort gatewayPort)
                .AddMemoryGrainStorage(""PubSubStore"")
                .AddSimpleMessageStreamProvider(""Teststream"")
                .UseServiceProviderFactory(Startup.ConfigureServices)
                .ConfigureApplicationParts(parts =>
                    parts.AddApplicationPart(typeof(IEventAggregator).Assembly).WithReferences());

Startup:
  public static IServiceProvider ConfigureServices(IServiceCollection services)
        {
            var builder = new ContainerBuilder();
            builder.Populate(services);
            builder.RegisterModule<TestModule>();
            var container = builder.Build();
            //Create the IServiceProvider based on the container.
            return new AutofacServiceProvider(container);
        }",,xiazen,,
4406,Remove hot string allocations in MessagingStatisticsGroup,"Avoids ~900 bytes of allocs per call.

Before:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 338.1 us | 254.3 us | 14.37 us | 3.4180 |  15.83 KB |

After:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 326.5 us | 85.51 us | 4.832 us | 3.4180 |  14.93 KB |

","Remove hot string allocations in MessagingStatisticsGroup Avoids ~900 bytes of allocs per call.

Before:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 338.1 us | 254.3 us | 14.37 us | 3.4180 |  15.83 KB |

After:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 326.5 us | 85.51 us | 4.832 us | 3.4180 |  14.93 KB |

",performance,ReubenBond,5/04/2018 20:12,17/04/2018 8:39
4405,Nullpointer exception when running ping benchmark in release mode,"debug mode runns fine but if i run ping benchmark in release i get this:

Running Ping benchmark
----------------------------- STARTING NEW UNIT TEST SILO HOST: Orleans.TestingHost.TestCluster -------------------------------------


Unbehandelte Ausnahme: System.NullReferenceException: Der Objektverweis wurde nicht auf eine Objektinstanz festgelegt.
   bei Orleans.Serialization.FieldUtils.GetGetter(FieldInfo field) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\FieldUtils.cs:Zeile 12.
   bei OrleansGeneratedCode5C168FDA.OrleansCodeGenOrleans_Serialization_SerializationManagerSerializer..ctor(IFieldUtils fieldUtils) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Runtime\obj\Release\netstandard2.0\Orleans.Runtime.orleans.g.cs:Zeile 1733.
--- Ende der Stapelüberwachung vom vorhergehenden Ort an dem die Ausnahme ausgelöst wurde ---
   bei System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   bei Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   bei Orleans.Serialization.SerializationManager.InitializeSerializer(Type serializerType) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\SerializationManager.cs:Zeile 242.
   bei Orleans.Serialization.SerializationManager.Register(Type type Type serializerType) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\SerializationManager.cs:Zeile 445.
   bei Orleans.Serialization.SerializationManager.RegisterSerializers(SerializerFeature serializerFeature) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\SerializationManager.cs:Zeile 204.
   bei Orleans.Serialization.SerializationManager.RegisterSerializers(IApplicationPartManager applicationPartManager) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\SerializationManager.cs:Zeile 176.
   bei Orleans.Runtime.Silo..ctor(ILocalSiloDetails siloDetails IServiceProvider services) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Runtime\Silo\Silo.cs:Zeile 146.
--- Ende der Stapelüberwachung vom vorhergehenden Ort an dem die Ausnahme ausgelöst wurde ---
   bei System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   bei Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceProvider.<>c__DisplayClass22_0.<RealizeService>b__0(ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider Type serviceType)
   bei Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   bei Orleans.TestingHost.TestClusterHostFactory.CreateSiloHost(String hostName IEnumerable1 tearDown) in C:\Users\Jan Eggers\Documents\orleans\test\Benchmarks\Benchmarks\Program.cs:Zeile 112.
   bei Benchmarks.Program.<>c.<.cctor>b__4_5() in C:\Users\Jan Eggers\Documents\orleans\test\Benchmarks\Benchmarks\Program.cs:Zeile 82.
   bei Benchmarks.Program.Main(String[] args) in C:\Users\Jan Eggers\Documents\orleans\test\Benchmarks\Benchmarks\Program.cs:Zeile 107.

","Nullpointer exception when running ping benchmark in release mode debug mode runns fine but if i run ping benchmark in release i get this:

Running Ping benchmark
----------------------------- STARTING NEW UNIT TEST SILO HOST: Orleans.TestingHost.TestCluster -------------------------------------


Unbehandelte Ausnahme: System.NullReferenceException: Der Objektverweis wurde nicht auf eine Objektinstanz festgelegt.
   bei Orleans.Serialization.FieldUtils.GetGetter(FieldInfo field) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\FieldUtils.cs:Zeile 12.
   bei OrleansGeneratedCode5C168FDA.OrleansCodeGenOrleans_Serialization_SerializationManagerSerializer..ctor(IFieldUtils fieldUtils) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Runtime\obj\Release\netstandard2.0\Orleans.Runtime.orleans.g.cs:Zeile 1733.
--- Ende der Stapelüberwachung vom vorhergehenden Ort an dem die Ausnahme ausgelöst wurde ---
   bei System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   bei Microsoft.Extensions.Internal.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
   bei Orleans.Serialization.SerializationManager.InitializeSerializer(Type serializerType) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\SerializationManager.cs:Zeile 242.
   bei Orleans.Serialization.SerializationManager.Register(Type type Type serializerType) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\SerializationManager.cs:Zeile 445.
   bei Orleans.Serialization.SerializationManager.RegisterSerializers(SerializerFeature serializerFeature) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\SerializationManager.cs:Zeile 204.
   bei Orleans.Serialization.SerializationManager.RegisterSerializers(IApplicationPartManager applicationPartManager) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Core\Serialization\SerializationManager.cs:Zeile 176.
   bei Orleans.Runtime.Silo..ctor(ILocalSiloDetails siloDetails IServiceProvider services) in C:\Users\Jan Eggers\Documents\orleans\src\Orleans.Runtime\Silo\Silo.cs:Zeile 146.
--- Ende der Stapelüberwachung vom vorhergehenden Ort an dem die Ausnahme ausgelöst wurde ---
   bei System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   bei Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceProvider.<>c__DisplayClass22_0.<RealizeService>b__0(ServiceProvider provider)
   bei Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider Type serviceType)
   bei Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   bei Orleans.TestingHost.TestClusterHostFactory.CreateSiloHost(String hostName IEnumerable1 tearDown) in C:\Users\Jan Eggers\Documents\orleans\test\Benchmarks\Benchmarks\Program.cs:Zeile 112.
   bei Benchmarks.Program.<>c.<.cctor>b__4_5() in C:\Users\Jan Eggers\Documents\orleans\test\Benchmarks\Benchmarks\Program.cs:Zeile 82.
   bei Benchmarks.Program.Main(String[] args) in C:\Users\Jan Eggers\Documents\orleans\test\Benchmarks\Benchmarks\Program.cs:Zeile 107.

",,ReubenBond,,
4403,Unused Stopwatch instance in the Grain<TGrainState>.OnSetupState function ,"There is unused Stopwatch instance in the Grain<>.OnSetupState function. It should be commented out until StorageStatisticsGroup is commented

","Unused Stopwatch instance in the Grain<TGrainState>.OnSetupState function  There is unused Stopwatch instance in the Grain<>.OnSetupState function. It should be commented out until StorageStatisticsGroup is commented

",,ReubenBond,,
4401,Getting a null reference error on ServiceId when I call GetReminder on a silo with no ServiceId,"Hey
I was using Orleans 2.0.0 Stable and have the following code in my grain


I believe Orleans requires serviceid to be set but does not do a validation of this when I create my silo which leads to this issue down the line. We should add in validation that causes the silo init to break if serviceId is not passed in.","Getting a null reference error on ServiceId when I call GetReminder on a silo with no ServiceId Hey
I was using Orleans 2.0.0 Stable and have the following code in my grain


I believe Orleans requires serviceid to be set but does not do a validation of this when I create my silo which leads to this issue down the line. We should add in validation that causes the silo init to break if serviceId is not passed in.",,benjaminpetit,,
4400,Documention of the logic behind of clusterclient.GetGrain<ISomeGrain>(),"I think we need a original rational explanation of  what happening when our cluster client send a request(
?

According to our test results when the client sends the message it seems that only 3 silos ( _i have 5 total_) opened the socket connection (in order to be effective I used **client per request**) and then close the connection(why 3?)","Documention of the logic behind of clusterclient.GetGrain<ISomeGrain>() I think we need a original rational explanation of  what happening when our cluster client send a request(
?

According to our test results when the client sends the message it seems that only 3 silos ( _i have 5 total_) opened the socket connection (in order to be effective I used **client per request**) and then close the connection(why 3?)",documentation,sergeybykov,4/04/2018 17:58,
4399,Remove per-call timer allocation,"* Split  and the cost associated with creating it.
* Avoid starting a .NET Timer for every grain call instead use a single timer in the runtime client and expire calls in succession

The timer period is set to 1 second in this PR - I figure that is a fine interval but we could reduce it as we see fit or make it configurable.

These callback timers were causing significant contention (due to how .NET's Timer class is implemented) and allocating ~400 bytes per call

cc @dVakulen - we talked about this back in January & Dmytro has an implementation of a timer wheel which may be suitable to use for Grain timers (which this PR doesn't address)","Remove per-call timer allocation * Split  and the cost associated with creating it.
* Avoid starting a .NET Timer for every grain call instead use a single timer in the runtime client and expire calls in succession

The timer period is set to 1 second in this PR - I figure that is a fine interval but we could reduce it as we see fit or make it configurable.

These callback timers were causing significant contention (due to how .NET's Timer class is implemented) and allocating ~400 bytes per call

cc @dVakulen - we talked about this back in January & Dmytro has an implementation of a timer wheel which may be suitable to use for Grain timers (which this PR doesn't address)",performance,dVakulen,4/04/2018 16:45,23/06/2018 3:35
4398,Use linked list for activation message queue,"* Instead of a  for an activation's message queue.
* Responses are added to the front of the queue Requests are added to the back of the queue.","Use linked list for activation message queue * Instead of a  for an activation's message queue.
* Responses are added to the front of the queue Requests are added to the back of the queue.",performance,ReubenBond,4/04/2018 14:57,17/04/2018 8:39
4397,Reduce allocations in IncomingMessageAgent,"Before: 15.84 KB/call
After: 15.75 KB/call","Reduce allocations in IncomingMessageAgent Before: 15.84 KB/call
After: 15.75 KB/call",performance,ReubenBond,4/04/2018 14:30,17/04/2018 8:39
4396,Avoid costly Message.GetTargetHistory() on gateway reroute,"Results in 1.5Kb less allocs per call and ~17us faster RTT

Before: 

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 375.3 us | 166.1 us | 9.387 us | 3.4180 |  15.83 KB |

After:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 353.9 us | 6.983 us | 13.78 us | 3.4180 |  14.28 KB |
","Avoid costly Message.GetTargetHistory() on gateway reroute Results in 1.5Kb less allocs per call and ~17us faster RTT

Before: 

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 375.3 us | 166.1 us | 9.387 us | 3.4180 |  15.83 KB |

After:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 353.9 us | 6.983 us | 13.78 us | 3.4180 |  14.28 KB |
",performance,ReubenBond,4/04/2018 14:19,17/04/2018 8:39
4395,Reduce allocs in Interner,"This is a minor improvement one in a string of several to come. This change reduces the allocs for each call by approximately 300 bytes and reduces RTT (in proc) by ~21us on my machine.

Allocations are like paper cuts: too many and you bleed out.

For this and the other allocation related PRs the targets are found by profiling looking at hot spots and picking the low-hanging fruit.

Before:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 375.3 us | 166.1 us | 9.387 us | 3.4180 |  15.83 KB |

After ""Reduce allocs in Interner"" commit:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 360.5 us | 200.2 us | 11.31 us | 3.4180 |  15.66 KB |

After ""Intern ActivationAddress"" commit:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 354.4 us | 119.1 us | 6.731 us | 3.4180 |  15.54 KB |
","Reduce allocs in Interner This is a minor improvement one in a string of several to come. This change reduces the allocs for each call by approximately 300 bytes and reduces RTT (in proc) by ~21us on my machine.

Allocations are like paper cuts: too many and you bleed out.

For this and the other allocation related PRs the targets are found by profiling looking at hot spots and picking the low-hanging fruit.

Before:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 375.3 us | 166.1 us | 9.387 us | 3.4180 |  15.83 KB |

After ""Reduce allocs in Interner"" commit:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 360.5 us | 200.2 us | 11.31 us | 3.4180 |  15.66 KB |

After ""Intern ActivationAddress"" commit:

 Method |     Mean |    Error |   StdDev |  Gen 0 | Allocated |
------- |---------:|---------:|---------:|-------:|----------:|
   Ping | 354.4 us | 119.1 us | 6.731 us | 3.4180 |  15.54 KB |
",performance,ReubenBond,4/04/2018 13:44,6/04/2018 7:48
4393,GrainTypeResolver is null,"Hello! After upgrading to Orleans 2.0 I've been having this problem almost random doesn't seems to be related to something in specific.


NOTE: I'm just supposing that all this three things are related I'm not sure if the warning logged has to do with everything else.

UPDATE: I'm using Azure TableStorage clusterting and seems that deleting the table of old registries helps to avoid the exception.","GrainTypeResolver is null Hello! After upgrading to Orleans 2.0 I've been having this problem almost random doesn't seems to be related to something in specific.


NOTE: I'm just supposing that all this three things are related I'm not sure if the warning logged has to do with everything else.

UPDATE: I'm using Azure TableStorage clusterting and seems that deleting the table of old registries helps to avoid the exception.",,benjaminpetit,,
4391,Application Insights Telemetry failing to initialize,"I'm trying to add the Application Insights Telemetry to our 2.0 app and im getting the following exception 
 takes a string causing the exception. Simply adding a DI compatible constructor should fix the issue. I'll submit a PR if this makes sense.","Application Insights Telemetry failing to initialize I'm trying to add the Application Insights Telemetry to our 2.0 app and im getting the following exception 
 takes a string causing the exception. Simply adding a DI compatible constructor should fix the issue. I'll submit a PR if this makes sense.",,xiazen,,
4389,No implementation of IHostEnvironmentStatistics was found,"Warning	100708	Orleans.Runtime.NoOpHostEnvironmentStatistics]	No implementation of IHostEnvironmentStatistics was found. Load shedding will not work yet.

What should I write in StartSilo","No implementation of IHostEnvironmentStatistics was found Warning	100708	Orleans.Runtime.NoOpHostEnvironmentStatistics]	No implementation of IHostEnvironmentStatistics was found. Load shedding will not work yet.

What should I write in StartSilo",,benjaminpetit,,
4386,Unsubscribe from SMS stream fails with timeout,"I'm facing an issue when calling 

Mentioned unsubscribe call can be seen here: https://github.com/smolyakoff/conreign/blob/feature/bots/src/Conreign.Server/Gameplay/LobbyGrain.cs#L93

I use a common helper for stream subscription which does conditional logic based on active subscription handles: https://github.com/smolyakoff/conreign/blob/feature/bots/src/Conreign.Server/Communication/StreamExtensions.cs#L14","Unsubscribe from SMS stream fails with timeout I'm facing an issue when calling 

Mentioned unsubscribe call can be seen here: https://github.com/smolyakoff/conreign/blob/feature/bots/src/Conreign.Server/Gameplay/LobbyGrain.cs#L93

I use a common helper for stream subscription which does conditional logic based on active subscription handles: https://github.com/smolyakoff/conreign/blob/feature/bots/src/Conreign.Server/Communication/StreamExtensions.cs#L14",documentation,sergeybykov,3/04/2018 4:35,
4385,The type or namespace name 'GenericMethodInvoker' does not exist in the namespace 'Orleans.CodeGeneration' ,"orleans2.0
ex:  
Error	CS0234	The type or namespace name 'GenericMethodInvoker' does not exist in the namespace 'Orleans.CodeGeneration' (are you missing an assembly reference?)

Do not support generics?

1.5.3 is ok","The type or namespace name 'GenericMethodInvoker' does not exist in the namespace 'Orleans.CodeGeneration'  orleans2.0
ex:  
Error	CS0234	The type or namespace name 'GenericMethodInvoker' does not exist in the namespace 'Orleans.CodeGeneration' (are you missing an assembly reference?)

Do not support generics?

1.5.3 is ok",,ReubenBond,,
4384, Can I Use localhost clustering for multiple local silo?,"I have 2 silos if using AdoNet membership all works fine.
when switch to  localhost clustering my client throw some errors
"," Can I Use localhost clustering for multiple local silo? I have 2 silos if using AdoNet membership all works fine.
when switch to  localhost clustering my client throw some errors
",,benjaminpetit,,
4381,Looking source of TaskCanceledException [1.5.2],"We are seeing this 

we will try to attach more details to like as we find them


The initial thought was that a grain call was made (maybe from client maybe from another grain) that causes many hundreds of new activation to occur and that time was a lengthy process.  However we haven't been able to deduce the exception.","Looking source of TaskCanceledException [1.5.2] We are seeing this 

we will try to attach more details to like as we find them


The initial thought was that a grain call was made (maybe from client maybe from another grain) that causes many hundreds of new activation to occur and that time was a lengthy process.  However we haven't been able to deduce the exception.",,ReubenBond,,
4378,"what is the equivalent class of ""ObserverSubscriptionManager"" in Orleans 2.0","what is equivalent class of ""ObserverSubscriptionManager"" in Orleans 2.0. If this is obsolete how do I implement client observer in 2.0? ","what is the equivalent class of ""ObserverSubscriptionManager"" in Orleans 2.0 what is equivalent class of ""ObserverSubscriptionManager"" in Orleans 2.0. If this is obsolete how do I implement client observer in 2.0? ",question,ReubenBond,,
4374,Update doc page on grain garbage collection,,Update doc page on grain garbage collection ,documentation,benjaminpetit,31/03/2018 5:15,31/03/2018 9:15
4373,Update transactions page,,Update transactions page ,documentation,benjaminpetit,31/03/2018 5:02,31/03/2018 10:10
4372,Update reminders doc page,,Update reminders doc page ,documentation,benjaminpetit,31/03/2018 4:50,31/03/2018 9:36
4371,Add a warning banner on all 1.5 doc pages,I could have done it with paying with the template but since 1.5 and 2.0 share the same it was easier that way.,Add a warning banner on all 1.5 doc pages I could have done it with paying with the template but since 1.5 and 2.0 share the same it was easier that way.,documentation,benjaminpetit,31/03/2018 4:26,31/03/2018 10:09
4370,I have some questions about Orleans Best Practices,"I've already read [this guide](https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/Orleans20Best20Practices.pdf) but still have some questions. Please see the code bellow:



I'm trying to organize long running transactional process (in the future maybe with compensating actions aka [saga/state machine/call it what you want] it doesn't matter).

1. I need to do some piece of work in the Start method.
2. After run some method (ExecuteTransaction) without waiting and immediately return some result (in this example value which will notify that process has been successfully started).

What is the right way to do it? Use async void method or one more additional grain? Is async void bad practice here?

Also sometimes I'm getting Orleans.Storage.TableStorageUpdateConditionNotSatisfiedException in the 
ExecuteTransaction() method. I put two breakpoints in this method:

1. At the beginning of method.
2. After block of // Step 2.

The second breakpoint hits two times without stack trace when first only once. How it is possible magic?
","I have some questions about Orleans Best Practices I've already read [this guide](https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/Orleans20Best20Practices.pdf) but still have some questions. Please see the code bellow:



I'm trying to organize long running transactional process (in the future maybe with compensating actions aka [saga/state machine/call it what you want] it doesn't matter).

1. I need to do some piece of work in the Start method.
2. After run some method (ExecuteTransaction) without waiting and immediately return some result (in this example value which will notify that process has been successfully started).

What is the right way to do it? Use async void method or one more additional grain? Is async void bad practice here?

Also sometimes I'm getting Orleans.Storage.TableStorageUpdateConditionNotSatisfiedException in the 
ExecuteTransaction() method. I put two breakpoints in this method:

1. At the beginning of method.
2. After block of // Step 2.

The second breakpoint hits two times without stack trace when first only once. How it is possible magic?
",question,sergeybykov,31/03/2018 0:53,13/07/2018 4:09
4369,Update Reentrancy docs,cc @dVakulen if you want to take a look.,Update Reentrancy docs cc @dVakulen if you want to take a look.,documentation,dVakulen,30/03/2018 19:40,31/03/2018 3:06
4368,Rewrite code generation docs,,Rewrite code generation docs ,documentation,ReubenBond,30/03/2018 16:06,31/03/2018 3:05
4366,Rewrite bootstrap docs,I *did* rename the file this time. The old file/title was a bit too long. Tested locally,Rewrite bootstrap docs I *did* rename the file this time. The old file/title was a bit too long. Tested locally,documentation,ReubenBond,30/03/2018 14:23,30/03/2018 14:34
4365,Update Interceptors.md,,Update Interceptors.md ,documentation,ReubenBond,30/03/2018 13:59,30/03/2018 14:11
4364,Update Service-Fabric.md,,Update Service-Fabric.md ,documentation,ReubenBond,30/03/2018 13:41,30/03/2018 14:11
4358,Update samples section1,"- update outdated sample doc
- remove sample doc whose sample are not upgraded to 2.0 yet.

Update samples section2 will add docs for samples ServiceFabric and docker-aspnet core which doesn't have dosc in samples section before ","Update samples section1 - update outdated sample doc
- remove sample doc whose sample are not upgraded to 2.0 yet.

Update samples section2 will add docs for samples ServiceFabric and docker-aspnet core which doesn't have dosc in samples section before ",,ReubenBond,,
4357,Fix reference to Microsoft.Orleans.Hosting.ServiceFabric in Microsoft.Orleans.ServiceFabric to 2.0.0,Fix reference to Microsoft.Orleans.Hosting.ServiceFabric in Microsoft.Orleans.ServiceFabric to 2.0.0 version of the package so that it doesn't point to a non existing version of the package (2.0.1 or 2.0.2).,Fix reference to Microsoft.Orleans.Hosting.ServiceFabric in Microsoft.Orleans.ServiceFabric to 2.0.0 Fix reference to Microsoft.Orleans.Hosting.ServiceFabric in Microsoft.Orleans.ServiceFabric to 2.0.0 version of the package so that it doesn't point to a non existing version of the package (2.0.1 or 2.0.2).,,benjaminpetit,,
4356,Simplify top level structure of the docs,"Merge Installation menu into Getting Started.
Merge New in Orleans 2.0 into other top level submenus.","Simplify top level structure of the docs Merge Installation menu into Getting Started.
Merge New in Orleans 2.0 into other top level submenus.",documentation,sergeybykov,30/03/2018 7:23,30/03/2018 8:38
4355,Add 2.0.0 final to What's New page,,Add 2.0.0 final to What's New page ,documentation,sergeybykov,30/03/2018 3:46,30/03/2018 8:18
4353,Multi cluster and practical use discussion," assume that there are some 3 teams(A B C)
- team **A** provide silos with ? I think it's not always feasible.
3. What is the best practice in such a scene?  
use one cluster or multi cluster?  if multi cluster can orleans work on other cloud server?
each team must predefine there grain interfaces which will be refferenced（used） by other teams?","Multi cluster and practical use discussion  assume that there are some 3 teams(A B C)
- team **A** provide silos with ? I think it's not always feasible.
3. What is the best practice in such a scene?  
use one cluster or multi cluster?  if multi cluster can orleans work on other cloud server?
each team must predefine there grain interfaces which will be refferenced（used） by other teams?",question,jason-bragg,30/03/2018 1:53,26/06/2018 8:36
4350,Microsoft.Orleans.ServiceFabric meta package references non-released 2.0.0 package," on 2.0.x
","Microsoft.Orleans.ServiceFabric meta package references non-released 2.0.0 package  on 2.0.x
",,ReubenBond,,
4348,Add a note about the change in provider configuration in 2.0,"Add a note about the change in provider configuration in 2.0 and the potential implications.
We should probably lift the general Cluster/Service ID part to the configuration section after we rewrite it for 2.0","Add a note about the change in provider configuration in 2.0 Add a note about the change in provider configuration in 2.0 and the potential implications.
We should probably lift the general Cluster/Service ID part to the configuration section after we rewrite it for 2.0",documentation,jason-bragg,,
4347,Adding simple Azure Worker Role Sample app,,Adding simple Azure Worker Role Sample app ,,ReubenBond,,
4346,More streaming documentation cleanup,,More streaming documentation cleanup ,,sergeybykov,,
4345,Edit migration page for Azure Cloud Services and add it to the menu.,,Edit migration page for Azure Cloud Services and add it to the menu. ,documentation,xiazen,,
4341,Fix title of the ADO.NET configuration page,,Fix title of the ADO.NET configuration page ,documentation,xiazen,,
4337,Update of Orleans stream documentation.,Still more to do but will do that in next PR.  Getting this out for review / merge while working on more involved changes.,Update of Orleans stream documentation. Still more to do but will do that in next PR.  Getting this out for review / merge while working on more involved changes.,,sergeybykov,,
4333,How Cluster calls each other?,"Hi. everybody
I learned from the tutorial how the client invokes silo's Grains.
But I didn't find a way for silo to call silo (cluster call cluster).
Orleans 2.x has very little documentation","How Cluster calls each other? Hi. everybody
I learned from the tutorial how the client invokes silo's Grains.
But I didn't find a way for silo to call silo (cluster call cluster).
Orleans 2.x has very little documentation",question,ReubenBond,,
4331,Old data in zookeeper don't get  removed,I find out when my orleans application restarts there will be a new record in the deploy node in zookeeper but it seems that the old record never get removed.  Will that cause performance or other problem?,Old data in zookeeper don't get  removed I find out when my orleans application restarts there will be a new record in the deploy node in zookeeper but it seems that the old record never get removed.  Will that cause performance or other problem?,help wanted,sergeybykov,28/03/2018 17:33,9/10/2018 8:31
4328,Timeout set by client is only respected by top-level grain,"According to https://github.com/dotnet/orleans/issues/1693#issuecomment-212984821 the timeout set by the client should be respected and propagated down to grains invoked by the grain running on the silo. I have a (fairly) minimal project here that demonstrates it is not: https://github.com/pmsanford/orleans-timeout-propagation-demo

It appears that the request to the first grain completes even if it takes longer than the SiloMessagingOptions.ResponseTimeout. However any grain calls beyond the initial call only respect the SiloMessagingOptions.ResponseTimeout. Have I misinterpreted the comment on the linked issue or is this a bug?

**Should a timeout set on MessagingOptions (or ClientMessagingOptions (??)) on the client side propagate through all grain activations on the silo?**

Edited to add: This is on OSX with ","Timeout set by client is only respected by top-level grain According to https://github.com/dotnet/orleans/issues/1693#issuecomment-212984821 the timeout set by the client should be respected and propagated down to grains invoked by the grain running on the silo. I have a (fairly) minimal project here that demonstrates it is not: https://github.com/pmsanford/orleans-timeout-propagation-demo

It appears that the request to the first grain completes even if it takes longer than the SiloMessagingOptions.ResponseTimeout. However any grain calls beyond the initial call only respect the SiloMessagingOptions.ResponseTimeout. Have I misinterpreted the comment on the linked issue or is this a bug?

**Should a timeout set on MessagingOptions (or ClientMessagingOptions (??)) on the client side propagate through all grain activations on the silo?**

Edited to add: This is on OSX with ",Hacktoberfest,ReubenBond,,
4326,"Do not add ""-dev"" version suffix to Release build if suffix isn't set.","Without this fix final builds of 2.0.0 are marked as ""2.0.0-dev"".","Do not add ""-dev"" version suffix to Release build if suffix isn't set. Without this fix final builds of 2.0.0 are marked as ""2.0.0-dev"".",,ReubenBond,,
4325,Skip ShouldUseInjectedQueueBalancerAndBalanceCorrectly tests.,Will be addressed with https://github.com/dotnet/orleans/issues/4317.,Skip ShouldUseInjectedQueueBalancerAndBalanceCorrectly tests. Will be addressed with https://github.com/dotnet/orleans/issues/4317.,test-issue,sergeybykov,,
4324,Skipping LogConsistencyTestsTwoClusters tests.,Until we resolve https://github.com/dotnet/orleans/issues/4293,Skipping LogConsistencyTestsTwoClusters tests. Until we resolve https://github.com/dotnet/orleans/issues/4293,test-issue,sergeybykov,,
4323,Fixed bug in custom storage log consistency provider factory.,#NAME?,Fixed bug in custom storage log consistency provider factory. - Was passing name to constructor when name was not one of the construction parameteres.,,sergeybykov,,
4322,Intermittent failures of  SMS_AllSilosRestart_UnsubscribeConsumer test,"https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4155&resultId=101189
>Error message
Orleans.Runtime.OrleansMessageRejectionException : No gateways available
Stack trace
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.Streaming.Reliability.StreamReliabilityTests.<SMS_AllSilosRestart_UnsubscribeConsumer>d__40.MoveNext() in D:\build\agent\_work\15\s\test\TesterAzureUtils\Streaming\StreamReliabilityTests.cs:line 626
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","Intermittent failures of  SMS_AllSilosRestart_UnsubscribeConsumer test https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4155&resultId=101189
>Error message
Orleans.Runtime.OrleansMessageRejectionException : No gateways available
Stack trace
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.Streaming.Reliability.StreamReliabilityTests.<SMS_AllSilosRestart_UnsubscribeConsumer>d__40.MoveNext() in D:\build\agent\_work\15\s\test\TesterAzureUtils\Streaming\StreamReliabilityTests.cs:line 626
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,sergeybykov,28/03/2018 7:42,
4321,Intermittent failures of Sched_Task_SubTaskExecutionSequencing test,"https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4155&resultId=100410
>Error message
Assert.Equal() Failure\r\nExpected: 10\r\nActual: 8
Stack trace
at UnitTests.SchedulerTests.OrleansTaskSchedulerBasicTests.Sched_Task_SubTaskExecutionSequencing() in D:\build\agent\_work\15\s\test\NonSilo.Tests\SchedulerTests\OrleansTaskSchedulerBasicTests.cs:line 558","Intermittent failures of Sched_Task_SubTaskExecutionSequencing test https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4155&resultId=100410
>Error message
Assert.Equal() Failure\r\nExpected: 10\r\nActual: 8
Stack trace
at UnitTests.SchedulerTests.OrleansTaskSchedulerBasicTests.Sched_Task_SubTaskExecutionSequencing() in D:\build\agent\_work\15\s\test\NonSilo.Tests\SchedulerTests\OrleansTaskSchedulerBasicTests.cs:line 558",test-issue,ReubenBond,,
4320,Intermittent failures of PersistentStreamingOverSingleGatewayTest test,"https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4147&resultId=100810
>Error message
Assert.Equal() Failure\r\nExpected: 653\r\nActual: 654
Stack trace
at Tester.StreamingTests.SystemTargetRouteTests.<>c__DisplayClass5_0.<PersistentStreamingOverSingleGatewayTest>b__6(Boolean lastTry) in D:\build\agent2\_work\8\s\test\Tester\StreamingTests\SystemTargetRouteTests.cs:line 96
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent2\_work\8\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 89
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent2\_work\8\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 102
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.SystemTargetRouteTests.<PersistentStreamingOverSingleGatewayTest>d__5.MoveNext() in D:\build\agent2\_work\8\s\test\Tester\StreamingTests\SystemTargetRouteTests.cs:line 96
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","Intermittent failures of PersistentStreamingOverSingleGatewayTest test https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4147&resultId=100810
>Error message
Assert.Equal() Failure\r\nExpected: 653\r\nActual: 654
Stack trace
at Tester.StreamingTests.SystemTargetRouteTests.<>c__DisplayClass5_0.<PersistentStreamingOverSingleGatewayTest>b__6(Boolean lastTry) in D:\build\agent2\_work\8\s\test\Tester\StreamingTests\SystemTargetRouteTests.cs:line 96
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent2\_work\8\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 89
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent2\_work\8\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 102
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.SystemTargetRouteTests.<PersistentStreamingOverSingleGatewayTest>d__5.MoveNext() in D:\build\agent2\_work\8\s\test\Tester\StreamingTests\SystemTargetRouteTests.cs:line 96
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,sergeybykov,28/03/2018 7:39,
4319,intermittent failures of Rem_Azure_GT_1F1J_MultiGrain,"https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4144&resultId=101129
>Error message
Orleans.Runtime.OrleansMessageRejectionException : Forwarding failed: tried to forward message Request S127.0.0.1:27480:259533019*cli/c5a628a4@ac0793a9->S127.0.0.1:27480:259533019*grn/60DF7002/9f44629c@07e6ffa6 #7449[ForwardCount=2]: for 2 times after Non-existent activation to invalid activation. Rejecting now. 
Stack trace
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansTaskExtentions.<<ToTypedTask>g__ConvertAsync4_0>d1.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.Core\Async\TaskExtensions.cs:line 100
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.TimerTests.ReminderTests_Base.<PerCopyGrainFailureTest>d__25.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\TimerTests\ReminderTests_Base.cs:line 342
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.Core\Async\TaskExtensions.cs:line 218
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.AzureUtils.TimerTests.ReminderTests_AzureTable.<Rem_Azure_GT_1F1J_MultiGrain>d__16.MoveNext() in D:\build\agent\_work\18\s\test\TesterAzureUtils\Reminder\ReminderTests_AzureTable.cs:line 365
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","intermittent failures of Rem_Azure_GT_1F1J_MultiGrain https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4144&resultId=101129
>Error message
Orleans.Runtime.OrleansMessageRejectionException : Forwarding failed: tried to forward message Request S127.0.0.1:27480:259533019*cli/c5a628a4@ac0793a9->S127.0.0.1:27480:259533019*grn/60DF7002/9f44629c@07e6ffa6 #7449[ForwardCount=2]: for 2 times after Non-existent activation to invalid activation. Rejecting now. 
Stack trace
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansTaskExtentions.<<ToTypedTask>g__ConvertAsync4_0>d1.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.Core\Async\TaskExtensions.cs:line 100
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.TimerTests.ReminderTests_Base.<PerCopyGrainFailureTest>d__25.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\TimerTests\ReminderTests_Base.cs:line 342
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.Core\Async\TaskExtensions.cs:line 218
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.AzureUtils.TimerTests.ReminderTests_AzureTable.<Rem_Azure_GT_1F1J_MultiGrain>d__16.MoveNext() in D:\build\agent\_work\18\s\test\TesterAzureUtils\Reminder\ReminderTests_AzureTable.cs:line 365
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,sergeybykov,28/03/2018 7:32,
4318,Intermittent failures of Rem_Grain_1J_MultiGrainMultiReminders test,"https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4164&resultId=101330
>Error message
Orleans.Runtime.ReminderException : Could not unregister reminder <IOrleansReminder: GrainRef=GrainReference:*grn/549BB267/40733213fcc201daf462fc6a472e3e9403000000549bb267-0xB3D221CC ReminderName=REMINDER_1 ETag=bd94968a-6ff0-4986-9088-53bac5792d6d> from the reminder table due to tag mismatch. You can retry.
Stack trace
Server stack trace: 
at Orleans.Runtime.ReminderService.LocalReminderService.<UnregisterReminder>d__19.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\ReminderService\LocalReminderService.cs:line 148
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansCodeGenReminderServiceMethodInvoker.<Invoke>d__0.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Core\obj\Release\netstandard2.0\Orleans.Core.orleans.g.cs:line 947
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.GrainMethodInvoker.<Invoke>d__21.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\Core\GrainMethodInvoker.cs:line 91
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.InsideRuntimeClient.<Invoke>d__64.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\Core\InsideRuntimeClient.cs:line 364
Exception rethrown at [0]: 
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.Grains.ReminderTestGrain2.<StopReminder>d__14.MoveNext() in D:\build\agent\_work\15\s\test\TestInternalGrains\ReminderTestGrain2.cs:line 129
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.GrainInterfaces.OrleansCodeGenReminderTestGrain2MethodInvoker.<Invoke>d__0.MoveNext() in D:\build\agent\_work\15\s\test\TestGrainInterfaces\obj\Release\netstandard2.0\win10-x64\TestGrainInterfaces.orleans.g.cs:line 26485
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.GrainMethodInvoker.<Invoke>d__21.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\Core\GrainMethodInvoker.cs:line 91
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.InsideRuntimeClient.<Invoke>d__64.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\Core\InsideRuntimeClient.cs:line 364
Exception rethrown at [1]: 
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Core\Async\TaskExtensions.cs:line 218
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.TimerTests.ReminderTests_Base.<ExecuteWithRetriesStop>d__29.MoveNext() in D:\build\agent\_work\15\s\test\TesterInternal\TimerTests\ReminderTests_Base.cs:line 420
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()","Intermittent failures of Rem_Grain_1J_MultiGrainMultiReminders test https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4164&resultId=101330
>Error message
Orleans.Runtime.ReminderException : Could not unregister reminder <IOrleansReminder: GrainRef=GrainReference:*grn/549BB267/40733213fcc201daf462fc6a472e3e9403000000549bb267-0xB3D221CC ReminderName=REMINDER_1 ETag=bd94968a-6ff0-4986-9088-53bac5792d6d> from the reminder table due to tag mismatch. You can retry.
Stack trace
Server stack trace: 
at Orleans.Runtime.ReminderService.LocalReminderService.<UnregisterReminder>d__19.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\ReminderService\LocalReminderService.cs:line 148
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansCodeGenReminderServiceMethodInvoker.<Invoke>d__0.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Core\obj\Release\netstandard2.0\Orleans.Core.orleans.g.cs:line 947
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.GrainMethodInvoker.<Invoke>d__21.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\Core\GrainMethodInvoker.cs:line 91
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.InsideRuntimeClient.<Invoke>d__64.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\Core\InsideRuntimeClient.cs:line 364
Exception rethrown at [0]: 
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.Grains.ReminderTestGrain2.<StopReminder>d__14.MoveNext() in D:\build\agent\_work\15\s\test\TestInternalGrains\ReminderTestGrain2.cs:line 129
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.GrainInterfaces.OrleansCodeGenReminderTestGrain2MethodInvoker.<Invoke>d__0.MoveNext() in D:\build\agent\_work\15\s\test\TestGrainInterfaces\obj\Release\netstandard2.0\win10-x64\TestGrainInterfaces.orleans.g.cs:line 26485
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.GrainMethodInvoker.<Invoke>d__21.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\Core\GrainMethodInvoker.cs:line 91
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.Runtime.InsideRuntimeClient.<Invoke>d__64.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Runtime\Core\InsideRuntimeClient.cs:line 364
Exception rethrown at [1]: 
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansTaskExtentions.<WithTimeout>d__16.MoveNext() in D:\build\agent\_work\15\s\src\Orleans.Core\Async\TaskExtensions.cs:line 218
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.TimerTests.ReminderTests_Base.<ExecuteWithRetriesStop>d__29.MoveNext() in D:\build\agent\_work\15\s\test\TesterInternal\TimerTests\ReminderTests_Base.cs:line 420
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()",P3,sergeybykov,28/03/2018 7:31,
4317,Intermittent failures of PluggableQueueBalancerTest_ShouldUseInjectedQueueBalancerAndBalanceCorrectly test,"Likely related to #3993.

https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4144&resultId=100678
>Error message
Assert.Equal() Failure\r\nExpected: 1\r\nActual: 2
Stack trace
at Tester.StreamingTests.PluggableQueueBalancerTestBase.<CheckLeases>d__4.MoveNext() in D:\build\agent\_work\18\s\test\Tester\StreamingTests\PlugableQueueBalancerTests\PluggableQueueBalancerTestBase.cs:line 41
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 89
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 102
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.PluggableQueueBalancerTestBase.<ShouldUseInjectedQueueBalancerAndBalanceCorrectly>d__2.MoveNext() in D:\build\agent\_work\18\s\test\Tester\StreamingTests\PlugableQueueBalancerTests\PluggableQueueBalancerTestBase.cs:line 23
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","Intermittent failures of PluggableQueueBalancerTest_ShouldUseInjectedQueueBalancerAndBalanceCorrectly test Likely related to #3993.

https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4144&resultId=100678
>Error message
Assert.Equal() Failure\r\nExpected: 1\r\nActual: 2
Stack trace
at Tester.StreamingTests.PluggableQueueBalancerTestBase.<CheckLeases>d__4.MoveNext() in D:\build\agent\_work\18\s\test\Tester\StreamingTests\PlugableQueueBalancerTests\PluggableQueueBalancerTestBase.cs:line 41
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<>c__DisplayClass4_0.<<WaitUntilAsync>b__0>d.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 89
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.TestingHost.Utils.TestingUtils.<WaitUntilAsync>d__4.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.TestingHost\Utils\TestingUtils.cs:line 102
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tester.StreamingTests.PluggableQueueBalancerTestBase.<ShouldUseInjectedQueueBalancerAndBalanceCorrectly>d__2.MoveNext() in D:\build\agent\_work\18\s\test\Tester\StreamingTests\PlugableQueueBalancerTests\PluggableQueueBalancerTestBase.cs:line 23
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,jason-bragg,,
4316,CustomStorage test is failing consistently,"We should probably rename it to something less generic.

https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4144&resultId=101473
>Error message
System.InvalidOperationException : A suitable constructor for type 'Orleans.EventSourcing.CustomStorage.LogConsistencyProvider' could not be located. Ensure the type is concrete and services are registered for all parameters of a public constructor.
Stack trace
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.BasicLogTestGrainTests.<>c__DisplayClass12_0.<<ThreeCheckers>b__0>d.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\BasicLogTestGrainTests.cs:line 111
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.BasicLogTestGrainTests.<ThreeCheckers>d__12.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\BasicLogTestGrainTests.cs:line 141
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.BasicLogTestGrainTests.<DoBasicLogTestGrainTest>d__11.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\BasicLogTestGrainTests.cs:line 100
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.BasicLogTestGrainTests.<CustomStorage>d__8.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\BasicLogTestGrainTests.cs:line 83
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","CustomStorage test is failing consistently We should probably rename it to something less generic.

https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4144&resultId=101473
>Error message
System.InvalidOperationException : A suitable constructor for type 'Orleans.EventSourcing.CustomStorage.LogConsistencyProvider' could not be located. Ensure the type is concrete and services are registered for all parameters of a public constructor.
Stack trace
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.BasicLogTestGrainTests.<>c__DisplayClass12_0.<<ThreeCheckers>b__0>d.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\BasicLogTestGrainTests.cs:line 111
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.BasicLogTestGrainTests.<ThreeCheckers>d__12.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\BasicLogTestGrainTests.cs:line 141
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.BasicLogTestGrainTests.<DoBasicLogTestGrainTest>d__11.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\BasicLogTestGrainTests.cs:line 100
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.BasicLogTestGrainTests.<CustomStorage>d__8.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\BasicLogTestGrainTests.cs:line 83
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,sergeybykov,28/03/2018 7:27,
4315,WIP: Azure Kubernetes Service sample,"I am working on a Azure Kubernetes sample with instructions on how to build and deploy into Kubernetes.

I could use feed back if this is what people what to see.

https://github.com/jms69/orleans/tree/akssample/Samples/2.0/Kubernetes","WIP: Azure Kubernetes Service sample I am working on a Azure Kubernetes sample with instructions on how to build and deploy into Kubernetes.

I could use feed back if this is what people what to see.

https://github.com/jms69/orleans/tree/akssample/Samples/2.0/Kubernetes",P3,JillHeaden,,
4314,HelloWorld Sample Error for netcore 2.0,"I try to run the HelloWorld sample on my mac I use .netcore 2.0 it throws the exception below:
System.ArgumentException: Cannot find an implementation class for grain interface: HelloWorld.Interfaces.IHello. Make sure the grain assembly was correctly deployed and loaded in the silo.
   at Orleans.GrainFactory.GetGrainClassData(Type interfaceType String grainClassNamePrefix)
   at Orleans.GrainFactory.GetGrain[TGrainInterface](Int64 primaryKey String grainClassNamePrefix)
   at OrleansClient.Program.<DoClientWork>d__3.MoveNext() in /Users/echo/Documents/Github/orleans/Samples/2.0/HelloWorld/src/OrleansClient/Program.cs:line 78
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at OrleansClient.Program.<RunMainAsync>d__1.MoveNext() in /Users/echo/Documents/Github/orleans/Samples/2.0/HelloWorld/src/OrleansClient/Program.cs:line 29
","HelloWorld Sample Error for netcore 2.0 I try to run the HelloWorld sample on my mac I use .netcore 2.0 it throws the exception below:
System.ArgumentException: Cannot find an implementation class for grain interface: HelloWorld.Interfaces.IHello. Make sure the grain assembly was correctly deployed and loaded in the silo.
   at Orleans.GrainFactory.GetGrainClassData(Type interfaceType String grainClassNamePrefix)
   at Orleans.GrainFactory.GetGrain[TGrainInterface](Int64 primaryKey String grainClassNamePrefix)
   at OrleansClient.Program.<DoClientWork>d__3.MoveNext() in /Users/echo/Documents/Github/orleans/Samples/2.0/HelloWorld/src/OrleansClient/Program.cs:line 78
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at OrleansClient.Program.<RunMainAsync>d__1.MoveNext() in /Users/echo/Documents/Github/orleans/Samples/2.0/HelloWorld/src/OrleansClient/Program.cs:line 29
",,benjaminpetit,,
4313,Redundant Dictionary allocation in RequestContext.Set ?,There is a extra allocation of  anymore? I tried remove this allocation and all still works fine. Could you investigate this question?,Redundant Dictionary allocation in RequestContext.Set ? There is a extra allocation of  anymore? I tried remove this allocation and all still works fine. Could you investigate this question?,,ReubenBond,,
4312,Silo requests failing with error The target silo is no longer active,"From last few days (from 23rd of March) in one of our environment with 6 Orleans instances we started seeing an error - Error message: **The target silo is no longer active: target was S100.115.122.69:11111:259510909 but this silo is S100.115.122.69:11111:259777677. The rejected message is Request S100.115.164.34:11111:259777673*grn/89AD686A/7415dd99@dcbdc496->S100.115.122.69:11111:259510909*grn/D850AA86/5b444c9d@d6c97486 #298658: global::CloudPlatform.Tenant.Grain.Interfaces.Device.Event.IEventGrain:ProcessEventAsync()."" Argument1="" Server stack trace: at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)** 
The error is observed in all the instances of the cluster and all the communication to this one silo (S100.115.122.69) fails continuously. 
From the OrleansSiloInstances table I can see that S100.115.122.69:11111:259510909 is marked to be dead on 23rd (2018-03-23 15:52:08.479 GMT)
![image](https://user-images.githubusercontent.com/14808657/37955528-7a01a016-31c6-11e8-956d-4faf5506e653.png)

There were these following warnings from other silos soon after the faulty silo was marked as dead - 
**EventName=""MessageEvent"" Message=""[2018-03-23 15:52:52.990 GMT 53	WARNING	100148	Dispatcher	100.115.116.30:11111]	No target activation S100.115.138.17:11111:259511483*grn/D66845D2/643cd8bd@ad32d9b5 for response message: Transient Rejection (info: Silo S100.115.116.30:11111:259511374 is rejecting message: Request S100.115.138.17:11111:259511483*grn/D66845D2/643cd8bd@ad32d9b5->S100.115.122.69:11111:259510909*grn/716E8E94/643cd8bd+CovStreamProvider_CovStreamNameSpace@165c009c #25883[ForwardCount=1]: global::Orleans.Streams.IPubSubRendezvousGrain:RegisterProducer(). Reason = Target S100.115.122.69:11111:259510909 silo is known to be dead) Response S100.115.122.69:11111:259510909*grn/716E8E94/643cd8bd+CovStreamProvider_CovStreamNameSpace@165c009c->S100.115.138.17:11111:259511483*grn/D66845D2/643cd8bd@ad32d9b5 #25883: global::Orleans.Streams.IPubSubRendezvousGrain:RegisterProducer()	"" TraceSource=""WaWorkerHost.exe""**

These warning from the **faulty silo:**
**EventName=""MessageEvent"" Message=""[2018-03-23 15:52:52.236 GMT 54	WARNING	100602	MembershipOracle	100.115.122.69:11111]	Silo CloudPlatform.Tenant.Worker.OrleansHost_IN_0 restarted on same host RD0003FFA01D47 New silo address = S100.115.122.69:11111:259516351 Previous silo address = S100.115.122.69:11111:259510909	"" TraceSource=""WaWorkerHost.exe""**

**EventName=""MessageEvent"" Message=""[2018-03-23 15:52:50.923 GMT 54	WARNING	100824	AzureBasedMembershipTable	100.115.122.69:11111]	Update failed due to contention on the table. Will retry. Entry SiloAddress=S100.115.122.69:11111:259516351 SiloName=CloudPlatform.Tenant.Worker.OrleansHost_IN_0 Status=Joining eTag W/""datetime'2018-03-23T15%3A52%3A33.0728507Z'"" table version = <6255 W/""datetime'2018-03-23T15%3A52%3A08.7128507Z'""> "" TraceSource=""WaWorkerHost.exe""**

**EventName=""MessageEvent"" Message=""[2018-03-23 15:52:08.369 GMT 115	WARNING	100325	Silo	100.115.122.69:11111]	Ignoring System.TimeoutException exception thrown from an action called by Silo.Stop.	Exc level 0: System.TimeoutException: Task.WaitWithThrow has timed out after 00:01:00. at Orleans.OrleansTaskExtentions.WaitWithThrow(Task task TimeSpan timeout) at Orleans.Runtime.Utils.SafeExecute(Action action Logger logger Func1 callerGetter)"" TraceSource=""WaWorkerHost.exe""**

We did a couple of re starts and deployments but nothing seemed to have fixed the issue. Even now other silos are trying to connect to the faulty silo using older epoch S100.115.122.69:11111:259510909 and getting No longer active error.
Could you please help us finding what is the cause of this and how can we fix this? ","Silo requests failing with error The target silo is no longer active From last few days (from 23rd of March) in one of our environment with 6 Orleans instances we started seeing an error - Error message: **The target silo is no longer active: target was S100.115.122.69:11111:259510909 but this silo is S100.115.122.69:11111:259777677. The rejected message is Request S100.115.164.34:11111:259777673*grn/89AD686A/7415dd99@dcbdc496->S100.115.122.69:11111:259510909*grn/D850AA86/5b444c9d@d6c97486 #298658: global::CloudPlatform.Tenant.Grain.Interfaces.Device.Event.IEventGrain:ProcessEventAsync()."" Argument1="" Server stack trace: at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task) at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)** 
The error is observed in all the instances of the cluster and all the communication to this one silo (S100.115.122.69) fails continuously. 
From the OrleansSiloInstances table I can see that S100.115.122.69:11111:259510909 is marked to be dead on 23rd (2018-03-23 15:52:08.479 GMT)
![image](https://user-images.githubusercontent.com/14808657/37955528-7a01a016-31c6-11e8-956d-4faf5506e653.png)

There were these following warnings from other silos soon after the faulty silo was marked as dead - 
**EventName=""MessageEvent"" Message=""[2018-03-23 15:52:52.990 GMT 53	WARNING	100148	Dispatcher	100.115.116.30:11111]	No target activation S100.115.138.17:11111:259511483*grn/D66845D2/643cd8bd@ad32d9b5 for response message: Transient Rejection (info: Silo S100.115.116.30:11111:259511374 is rejecting message: Request S100.115.138.17:11111:259511483*grn/D66845D2/643cd8bd@ad32d9b5->S100.115.122.69:11111:259510909*grn/716E8E94/643cd8bd+CovStreamProvider_CovStreamNameSpace@165c009c #25883[ForwardCount=1]: global::Orleans.Streams.IPubSubRendezvousGrain:RegisterProducer(). Reason = Target S100.115.122.69:11111:259510909 silo is known to be dead) Response S100.115.122.69:11111:259510909*grn/716E8E94/643cd8bd+CovStreamProvider_CovStreamNameSpace@165c009c->S100.115.138.17:11111:259511483*grn/D66845D2/643cd8bd@ad32d9b5 #25883: global::Orleans.Streams.IPubSubRendezvousGrain:RegisterProducer()	"" TraceSource=""WaWorkerHost.exe""**

These warning from the **faulty silo:**
**EventName=""MessageEvent"" Message=""[2018-03-23 15:52:52.236 GMT 54	WARNING	100602	MembershipOracle	100.115.122.69:11111]	Silo CloudPlatform.Tenant.Worker.OrleansHost_IN_0 restarted on same host RD0003FFA01D47 New silo address = S100.115.122.69:11111:259516351 Previous silo address = S100.115.122.69:11111:259510909	"" TraceSource=""WaWorkerHost.exe""**

**EventName=""MessageEvent"" Message=""[2018-03-23 15:52:50.923 GMT 54	WARNING	100824	AzureBasedMembershipTable	100.115.122.69:11111]	Update failed due to contention on the table. Will retry. Entry SiloAddress=S100.115.122.69:11111:259516351 SiloName=CloudPlatform.Tenant.Worker.OrleansHost_IN_0 Status=Joining eTag W/""datetime'2018-03-23T15%3A52%3A33.0728507Z'"" table version = <6255 W/""datetime'2018-03-23T15%3A52%3A08.7128507Z'""> "" TraceSource=""WaWorkerHost.exe""**

**EventName=""MessageEvent"" Message=""[2018-03-23 15:52:08.369 GMT 115	WARNING	100325	Silo	100.115.122.69:11111]	Ignoring System.TimeoutException exception thrown from an action called by Silo.Stop.	Exc level 0: System.TimeoutException: Task.WaitWithThrow has timed out after 00:01:00. at Orleans.OrleansTaskExtentions.WaitWithThrow(Task task TimeSpan timeout) at Orleans.Runtime.Utils.SafeExecute(Action action Logger logger Func1 callerGetter)"" TraceSource=""WaWorkerHost.exe""**

We did a couple of re starts and deployments but nothing seemed to have fixed the issue. Even now other silos are trying to connect to the faulty silo using older epoch S100.115.122.69:11111:259510909 and getting No longer active error.
Could you please help us finding what is the cause of this and how can we fix this? ",question,sergeybykov,27/03/2018 19:49,26/06/2018 8:32
4311,[2.0 RC2]What's wrong with this?,2018-03-27 04:30:08.626 +08:00 [fail] Runtime.Scheduler.WorkerPoolThread/2[101212]: Worker pool thread Runtime.Scheduler.WorkerPoolThread/2 (ManagedThreadId=26) has been busy for long time: Executing Task Id=158 Status=Running for 00:00:00.3903356 on WorkItem=System*WorkItemGroup:Name=*stg/0/00000000WorkGroupStatus=Running Executing for 00:00:00.3903596. WorkItemGroup Details: System*WorkItemGroup:Name=*stg/0/00000000WorkGroupStatus=Running. Currently QueuedWorkItems=25; Total EnQueued=4870; Total processed=4844; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-12:Queued=25; Detailed SchedulingContext=<[LowPrioritySystemTarget: S127.0.0.1:11111:259745611*stg/0/00000000@S00000000] CurrentlyExecuting=Response S127.0.0.1:11111:259745611*grn/44515979/e01548b0@4cb04888->S127.0.0.1:11111:259745611*stg/0/00000000@S00000000 #9896: >.,[2.0 RC2]What's wrong with this? 2018-03-27 04:30:08.626 +08:00 [fail] Runtime.Scheduler.WorkerPoolThread/2[101212]: Worker pool thread Runtime.Scheduler.WorkerPoolThread/2 (ManagedThreadId=26) has been busy for long time: Executing Task Id=158 Status=Running for 00:00:00.3903356 on WorkItem=System*WorkItemGroup:Name=*stg/0/00000000WorkGroupStatus=Running Executing for 00:00:00.3903596. WorkItemGroup Details: System*WorkItemGroup:Name=*stg/0/00000000WorkGroupStatus=Running. Currently QueuedWorkItems=25; Total EnQueued=4870; Total processed=4844; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-12:Queued=25; Detailed SchedulingContext=<[LowPrioritySystemTarget: S127.0.0.1:11111:259745611*stg/0/00000000@S00000000] CurrentlyExecuting=Response S127.0.0.1:11111:259745611*grn/44515979/e01548b0@4cb04888->S127.0.0.1:11111:259745611*stg/0/00000000@S00000000 #9896: >.,question,lfzm,27/03/2018 12:31,11/04/2018 16:22
4310,Tutorials for Orleans 2.0,This is issue ticket is intended to start a discussion on how the tutorials for Orleans 2.0 (and beyond) should  be developed. As we come up with tangible items to take action on we can populate this post to track progress on these items.,Tutorials for Orleans 2.0 This is issue ticket is intended to start a discussion on how the tutorials for Orleans 2.0 (and beyond) should  be developed. As we come up with tangible items to take action on we can populate this post to track progress on these items.,P3,JillHeaden,,
4308,Does this make sense for Orleans or SF and if so guidance please,"We’re working to take our  software to Azure cloud and looking at Orleans and Service Fabric (SF) as potential frameworks.  We need to:

1)	Populate our analysis engines with lots of data (e.g. 100MB to 2GB) per engine instance.
2)	Maintain that state and if an engine instance goes idle for say 20 minutes or more we’d like to unload it (i.e. and not pay for the engine instance resource).
3)	Each engine instance will support one to several end users with a specific data set.
4)	Each engine instance can be highly interactive generating lots of plot data near realtime.  We’re maintaining state as we don’t want to pay the price to populate engine instance for each engine interaction.
5)	An engine instance action can take a few seconds a few minutes to even tens of minutes.  We’ll want some feedback.
6)	Users may access an engine instance every few seconds (e.g. to steer the engine towards a result based on feedback) and will want live plot data.
7)	Each user will want to talk to a specific engine instance.
8)	As a user expresses interest in running a simulation (i.e. standing up an engine instance) ideally we want him to choose small/medium/large computing resource to run his engine instance (i.e. based on the problem he’s trying to solve he may want more or less computing/memory power).

We’re considering Orleans and SF but we’re having difficulty specifying architecture based on above requirements.  We’ve considered:

1)	Trying to think about an SF node or an Orleans silo as an ‘engine instance’ described above.
2)	Leveraging both Orleans and SF notion of fault tolerance through replication.
3)	Leveraging local (i.e. to node or silo) storage to store results and maintain state (i.e. for long periods or until idle for 20 minutes).

We’ve not understood how to:

1)	Limit a silo or a node to a single engine instance so that we can control resourcing of the engine instance.
2)	Keep a user’s engine instance data separate from another users engine instance data.  
3)	Direct a request from a user (e.g. through a web API) to a particular engine instance.

Does this make sense for Orleans does it make more sense for SF?  Any pointers on how to implement the above would be helpful.
","Does this make sense for Orleans or SF and if so guidance please We’re working to take our  software to Azure cloud and looking at Orleans and Service Fabric (SF) as potential frameworks.  We need to:

1)	Populate our analysis engines with lots of data (e.g. 100MB to 2GB) per engine instance.
2)	Maintain that state and if an engine instance goes idle for say 20 minutes or more we’d like to unload it (i.e. and not pay for the engine instance resource).
3)	Each engine instance will support one to several end users with a specific data set.
4)	Each engine instance can be highly interactive generating lots of plot data near realtime.  We’re maintaining state as we don’t want to pay the price to populate engine instance for each engine interaction.
5)	An engine instance action can take a few seconds a few minutes to even tens of minutes.  We’ll want some feedback.
6)	Users may access an engine instance every few seconds (e.g. to steer the engine towards a result based on feedback) and will want live plot data.
7)	Each user will want to talk to a specific engine instance.
8)	As a user expresses interest in running a simulation (i.e. standing up an engine instance) ideally we want him to choose small/medium/large computing resource to run his engine instance (i.e. based on the problem he’s trying to solve he may want more or less computing/memory power).

We’re considering Orleans and SF but we’re having difficulty specifying architecture based on above requirements.  We’ve considered:

1)	Trying to think about an SF node or an Orleans silo as an ‘engine instance’ described above.
2)	Leveraging both Orleans and SF notion of fault tolerance through replication.
3)	Leveraging local (i.e. to node or silo) storage to store results and maintain state (i.e. for long periods or until idle for 20 minutes).

We’ve not understood how to:

1)	Limit a silo or a node to a single engine instance so that we can control resourcing of the engine instance.
2)	Keep a user’s engine instance data separate from another users engine instance data.  
3)	Direct a request from a user (e.g. through a web API) to a particular engine instance.

Does this make sense for Orleans does it make more sense for SF?  Any pointers on how to implement the above would be helpful.
",question,ReubenBond,,
4306,Question: Is there a stream example?,"Hi 

I am working on my master thesis about the fault tolerance techniques in Actor Based Stream Processing Frameworks. I have read through the documentation about stream and before starting programming a code sample(even a hello world program) about stream can definitely helps me a lot. The only example I can find is the quick start example in the documentation. 

I am new to stream processing so I hope to get some help here. Is there any code sample about stream?  

Thanks a lot!
","Question: Is there a stream example? Hi 

I am working on my master thesis about the fault tolerance techniques in Actor Based Stream Processing Frameworks. I have read through the documentation about stream and before starting programming a code sample(even a hello world program) about stream can definitely helps me a lot. The only example I can find is the quick start example in the documentation. 

I am new to stream processing so I hope to get some help here. Is there any code sample about stream?  

Thanks a lot!
",documentation,jason-bragg,,
4305,ProtobufSerializer,"Hi
I called this method in the Client & Silo

To ensure the Protobuf Serialization is work.What do I need to do?
Do I need to manually call serialization before calling Grains?","ProtobufSerializer Hi
I called this method in the Client & Silo

To ensure the Protobuf Serialization is work.What do I need to do?
Do I need to manually call serialization before calling Grains?",question,ReubenBond,,
4301,Add Dns name look up clustering for container frameworks,"Docker/Kubernetes can communicate with other containers using DNS name lookup.  When the silo containers are scaled and there are multiple instances we can use Dns.GetHostEntry to look up the multiple addresses and pass it to UseStaticClustering().

The problem is that this list is static so as I scale up and down or as containers shutdown and restart the client only has a static list of gateways.  We should do a continuous DNS resolution so the client will have the most recent list of IPs.

I had created a web UI Orleans client in a container and the silo in another container.  After scaling the silo container up and down and failing out some of the original containers the client could no longer connect with the silo because it has a stale IP list.","Add Dns name look up clustering for container frameworks Docker/Kubernetes can communicate with other containers using DNS name lookup.  When the silo containers are scaled and there are multiple instances we can use Dns.GetHostEntry to look up the multiple addresses and pass it to UseStaticClustering().

The problem is that this list is static so as I scale up and down or as containers shutdown and restart the client only has a static list of gateways.  We should do a continuous DNS resolution so the client will have the most recent list of IPs.

I had created a web UI Orleans client in a container and the silo in another container.  After scaling the silo container up and down and failing out some of the original containers the client could no longer connect with the silo because it has a stale IP list.",,benjaminpetit,,
4299,Update NuGet Packages page for 2.0,,Update NuGet Packages page for 2.0 ,documentation,xiazen,,
4298,tutorial about of Grain Persistence,Do you plan on creating tutorial about of Grain Persistence？,tutorial about of Grain Persistence Do you plan on creating tutorial about of Grain Persistence？,question,sergeybykov,24/03/2018 10:02,28/03/2018 20:53
4296,Update Prerequisites page and fix a copy-paste error in What's New,,Update Prerequisites page and fix a copy-paste error in What's New ,documentation,sergeybykov,24/03/2018 3:57,24/03/2018 6:40
4295,Build-time generation issue in Microsoft.Orleans.OrleansCodeGenerator.Build,"Hi guys

Found the following issue in the latest 2.0.0-rc-2 version.

**Download for the the reproduction:**
[OrleansIssue.Libs.zip](https://github.com/dotnet/orleans/files/1841533/OrleansIssue.Libs.zip)

One of my grain uses RabbitMq to receive messages.
The moment I reference the NuGet pacakge RabbitMQ.Client v5.0.1 (.NET 4.5.1) and used a type from the package in a grain the this error comes up:



Can someone find out what goes wrong here?","Build-time generation issue in Microsoft.Orleans.OrleansCodeGenerator.Build Hi guys

Found the following issue in the latest 2.0.0-rc-2 version.

**Download for the the reproduction:**
[OrleansIssue.Libs.zip](https://github.com/dotnet/orleans/files/1841533/OrleansIssue.Libs.zip)

One of my grain uses RabbitMq to receive messages.
The moment I reference the NuGet pacakge RabbitMQ.Client v5.0.1 (.NET 4.5.1) and used a type from the package in a grain the this error comes up:



Can someone find out what goes wrong here?",,ReubenBond,,
4294,Added test to exersize queue rebalancing while actively streaming,"It's a continuation of #4272. GitHub is angry with me and is not letting me force push (this force is not with me) 
This test is a follow-up on stream rebalancing issues raised by @ilyalukyanov in Stream resubscription issues #3484.
","Added test to exersize queue rebalancing while actively streaming It's a continuation of #4272. GitHub is angry with me and is not letting me force push (this force is not with me) 
This test is a follow-up on stream rebalancing issues raised by @ilyalukyanov in Stream resubscription issues #3484.
",P3,xiazen,,
4293,LogConsistencyTestsFourClusters are not passing,This has been hidden by the fact that they are not marked as functionals.,LogConsistencyTestsFourClusters are not passing This has been hidden by the fact that they are not marked as functionals.,,jason-bragg,,
4292,Ported log consistency providers from IProvider.,"- Should no longer require legacy systems to use.

This should address ""Configuring LogConsistencyProvider still requires legacy config in 2.0-rc2"" #4286 ","Ported log consistency providers from IProvider. - Should no longer require legacy systems to use.

This should address ""Configuring LogConsistencyProvider still requires legacy config in 2.0-rc2"" #4286 ",,sergeybykov,,
4291,Error calling grain's,"0.
""Exception"" : ""Orleans.Storage.BadGrainStorageConfigException: No storage provider named \""Default\"" found loading grain type Orleans.Runtime.Versions.VersionStoreGrain.
1.
Lifecycle start canceled due to errors at stage 1000
2.
Error calling grain's OnActivateAsync() method - Grain type = Orleans.Runtime.Versions.VersionStoreGrain Activation = [Activation: S127.0.0.1:8271:259483257*grn/13BAB4D8/00000000+fabric:/SecurityApp/StatelessCommandService@1cbfe087 #GrainType=Orleans.Runtime.Versions.VersionStoreGrain Placement=RandomPlacement State=Activating]
3.
Failed to InvokeActivate for [Activation: S127.0.0.1:8271:259483257*grn/13BAB4D8/00000000+fabric:/SecurityApp/StatelessCommandService@d6345997 #GrainType=Orleans.Runtime.Versions.VersionStoreGrain Placement=RandomPlacement State=Invalid].","Error calling grain's 0.
""Exception"" : ""Orleans.Storage.BadGrainStorageConfigException: No storage provider named \""Default\"" found loading grain type Orleans.Runtime.Versions.VersionStoreGrain.
1.
Lifecycle start canceled due to errors at stage 1000
2.
Error calling grain's OnActivateAsync() method - Grain type = Orleans.Runtime.Versions.VersionStoreGrain Activation = [Activation: S127.0.0.1:8271:259483257*grn/13BAB4D8/00000000+fabric:/SecurityApp/StatelessCommandService@1cbfe087 #GrainType=Orleans.Runtime.Versions.VersionStoreGrain Placement=RandomPlacement State=Activating]
3.
Failed to InvokeActivate for [Activation: S127.0.0.1:8271:259483257*grn/13BAB4D8/00000000+fabric:/SecurityApp/StatelessCommandService@d6345997 #GrainType=Orleans.Runtime.Versions.VersionStoreGrain Placement=RandomPlacement State=Invalid].",,benjaminpetit,,
4290,Second pass at options overrides,"- Added registration functions that use named options and register the options for logging
- Updated named components that use cluster options to support the overrides.

Unclear what to do about unnamed components that use cluster options.  At this time they are not being overridden.  Maybe we can use the component name or abstraction name?  (IReminderTable? for instance).  What to do with unnamed components is for discussion and planning possible additional pass should not block this PR.","Second pass at options overrides - Added registration functions that use named options and register the options for logging
- Updated named components that use cluster options to support the overrides.

Unclear what to do about unnamed components that use cluster options.  At this time they are not being overridden.  Maybe we can use the component name or abstraction name?  (IReminderTable? for instance).  What to do with unnamed components is for discussion and planning possible additional pass should not block this PR.",,ReubenBond,,
4289,Remove inconsistent sub builder pattern in streaming,Remove ISiloHostBuilder and IClientBuilder extensions methods which returns a stream sub builder instead of a ISiloHostbuilder or IClientBuilder. To keep consistency hence reduce confusion. ,Remove inconsistent sub builder pattern in streaming Remove ISiloHostBuilder and IClientBuilder extensions methods which returns a stream sub builder instead of a ISiloHostbuilder or IClientBuilder. To keep consistency hence reduce confusion. ,,jason-bragg,,
4288,Update FAQ,,Update FAQ ,documentation,ReubenBond,,
4287,Reminders: Improve error message when using reminders without a reminder table,"Alternative implementation of #4280

Fixes #4278","Reminders: Improve error message when using reminders without a reminder table Alternative implementation of #4280

Fixes #4278",,jason-bragg,,
4286,Configuring LogConsistencyProvider still requires legacy config in 2.0-rc2,"To configure the EventSourcing I can only use legacy config.

Will this be added to 2.0 config by release?


","Configuring LogConsistencyProvider still requires legacy config in 2.0-rc2 To configure the EventSourcing I can only use legacy config.

Will this be added to 2.0 config by release?


",,jason-bragg,,
4285,Update What's New page,,Update What's New page ,documentation,ReubenBond,,
4284,Remove 1.5 content from 2.0 Tutorials page,This is to prevent confusion and to prepare a clean slate for 2.0 tutorials.,Remove 1.5 content from 2.0 Tutorials page This is to prevent confusion and to prepare a clean slate for 2.0 tutorials.,documentation,ReubenBond,,
4283,WorkGroup X took elapsed time and Task pressure,"I've been investigating grain client timeouts and with that a large number of WorkGroup timeout warnings. After a fair amount of logging commenting and digging around I think I've distilled it down into being Task pressure on the scheduler. I'll try to describe out scenario summarize the investigatory steps and findings and then provide a simple example that results in the same warnings.

# Our Usage
We use Orleans as a means of importing normalizing processing and ultimately storing data from external data sources into a cloud based database. Additionally as new data and updates to old data come in we update external clients with the normalized and processed data.

Each document that comes in has a primary key to which we use to create an import grain. This import grain does some work to map external source IDs to normalized ones and then passes the normalized data to a ""model"" grain who's primary key is the mapped external primary key. These ""model"" grains use a custom storage provider that reads/writes to the cloud based database. This call also calls update on registered observers which end up flowing through to externally connected clients subscribed to document changes.

That's a pretty brief description of what we're trying to accomplish. I can dig into how we're doing it if necessary but I don't want to get side tracked on the approach yet.

# Investigations
- Eliminated possible blocking calls (Task.Run all the things)
- Added logging with timestamps around turns (start stop and around await calls)
- Added logging to the database to check query times

## Findings
- The timing logs ended up not really correlating well to any of the ""WorkGroup X took elapsed time""
- The timing logs showed pretty random and sporadic long duration tasks (explained below)

### Sporadic long-running tasks
One of the best examples I encountered was when investigating some long execution database calls in a WriteStateAsync call to a storage provider. Generally the database call would take 100-150ms (keep in mind these are called via Task.Run). The database's logs were showing 10-40ms for the actual query. While attempting to determine the difference here I noticed that individual statements in the code would sometimes very dramatically in how long they ""took"" and the query itself was not always the thing that took 100-150ms. An example is:

1. Do some small amount of work
2. Do some other small amount of work
3. Build a 200-300 character string using $"""" interpolation
4. Execute query

""Generally"" step 4 would take 100-150ms; however _sometimes_ steps 1 or 2 or 3 would take 150ms and step 4 would take 10-40ms.

### Conclusions
So based on that I put together a simple grain call that generates a bunch of Tasks and I end up seeing the same ""WorkGroup X took elapsed time"" warnings.

### Is this normal and/or expected?
We do generate a number of tasks throughout many of our grains. Not an inordinately large number but it's probably 1-10 per document.

I would expect this type of behavior spinning up a large number of threads that would then end up having to compete for CPU core time. Thus I feel like this is probably normal given a large number of Tasks would end up competing for Thread time? What seems strange to me; however is that the warning message implies the WorkGroup was _started_ preempted and then completed.

# Simple Example
## Grain Client
The client just calls a grain's Echo method 100 times. Each iteration is a new grain.
","WorkGroup X took elapsed time and Task pressure I've been investigating grain client timeouts and with that a large number of WorkGroup timeout warnings. After a fair amount of logging commenting and digging around I think I've distilled it down into being Task pressure on the scheduler. I'll try to describe out scenario summarize the investigatory steps and findings and then provide a simple example that results in the same warnings.

# Our Usage
We use Orleans as a means of importing normalizing processing and ultimately storing data from external data sources into a cloud based database. Additionally as new data and updates to old data come in we update external clients with the normalized and processed data.

Each document that comes in has a primary key to which we use to create an import grain. This import grain does some work to map external source IDs to normalized ones and then passes the normalized data to a ""model"" grain who's primary key is the mapped external primary key. These ""model"" grains use a custom storage provider that reads/writes to the cloud based database. This call also calls update on registered observers which end up flowing through to externally connected clients subscribed to document changes.

That's a pretty brief description of what we're trying to accomplish. I can dig into how we're doing it if necessary but I don't want to get side tracked on the approach yet.

# Investigations
- Eliminated possible blocking calls (Task.Run all the things)
- Added logging with timestamps around turns (start stop and around await calls)
- Added logging to the database to check query times

## Findings
- The timing logs ended up not really correlating well to any of the ""WorkGroup X took elapsed time""
- The timing logs showed pretty random and sporadic long duration tasks (explained below)

### Sporadic long-running tasks
One of the best examples I encountered was when investigating some long execution database calls in a WriteStateAsync call to a storage provider. Generally the database call would take 100-150ms (keep in mind these are called via Task.Run). The database's logs were showing 10-40ms for the actual query. While attempting to determine the difference here I noticed that individual statements in the code would sometimes very dramatically in how long they ""took"" and the query itself was not always the thing that took 100-150ms. An example is:

1. Do some small amount of work
2. Do some other small amount of work
3. Build a 200-300 character string using $"""" interpolation
4. Execute query

""Generally"" step 4 would take 100-150ms; however _sometimes_ steps 1 or 2 or 3 would take 150ms and step 4 would take 10-40ms.

### Conclusions
So based on that I put together a simple grain call that generates a bunch of Tasks and I end up seeing the same ""WorkGroup X took elapsed time"" warnings.

### Is this normal and/or expected?
We do generate a number of tasks throughout many of our grains. Not an inordinately large number but it's probably 1-10 per document.

I would expect this type of behavior spinning up a large number of threads that would then end up having to compete for CPU core time. Thus I feel like this is probably normal given a large number of Tasks would end up competing for Thread time? What seems strange to me; however is that the warning message implies the WorkGroup was _started_ preempted and then completed.

# Simple Example
## Grain Client
The client just calls a grain's Echo method 100 times. Each iteration is a new grain.
",,jason-bragg,,
4281,Intermittent failure of GlobalSingleInstanceClusterTests.All_Small test,"https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4113&resultId=101389
>Error message
Assert.True() Failure\r\nExpected: True\r\nActual: False
Stack trace
at Tests.GeoClusterTests.GlobalSingleInstanceClusterTests.<ConflictResolution>d__14.MoveNext() in D:\build\agent\_work\13\s\test\TesterInternal\GeoClusterTests\GlobalSingleInstanceClusterTests.cs:line 412
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.TestingClusterHost.<RunWithTimeout>d__6.MoveNext() in D:\build\agent\_work\13\s\test\TesterInternal\GeoClusterTests\TestingClusterHost.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.GlobalSingleInstanceClusterTests.<All_Small>d__1.MoveNext() in D:\build\agent\_work\13\s\test\TesterInternal\GeoClusterTests\GlobalSingleInstanceClusterTests.cs:line 40
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","Intermittent failure of GlobalSingleInstanceClusterTests.All_Small test https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4113&resultId=101389
>Error message
Assert.True() Failure\r\nExpected: True\r\nActual: False
Stack trace
at Tests.GeoClusterTests.GlobalSingleInstanceClusterTests.<ConflictResolution>d__14.MoveNext() in D:\build\agent\_work\13\s\test\TesterInternal\GeoClusterTests\GlobalSingleInstanceClusterTests.cs:line 412
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.TestingClusterHost.<RunWithTimeout>d__6.MoveNext() in D:\build\agent\_work\13\s\test\TesterInternal\GeoClusterTests\TestingClusterHost.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.GlobalSingleInstanceClusterTests.<All_Small>d__1.MoveNext() in D:\build\agent\_work\13\s\test\TesterInternal\GeoClusterTests\GlobalSingleInstanceClusterTests.cs:line 40
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,jason-bragg,,
4278,Obscure error message when using Reminders without registering a reminders provider,"
I want to implement ReceiveReminder at ten o'clock every day
","Obscure error message when using Reminders without registering a reminders provider 
I want to implement ReceiveReminder at ten o'clock every day
",,ReubenBond,,
4277,Overridable options,Another prototype like #4276 which allows override of options by registering names services to override an option.,Overridable options Another prototype like #4276 which allows override of options by registering names services to override an option.,,ReubenBond,,
4275,WIP - More aggressively cleanup system target stream producers.,"This is part of a follow-up on stream rebalancing issues raised by @ilyalukyanov in Stream resubscription issues #3484.

The concern was that inactive system target stream producers were not being cleaned up in the pubsub state leading to streams that could no longer be subscribed to or unsubscribed from.

There is an issue here though I am unconvinced it is the cause of the behaviors @ilyalukyanov is seeing.  This conclusion comes from the fact that in @ilyalukyanov's scenario silos were being killed so the system target stream producers on those silo by the existing logic should be cleaned up.  The system target stream producers that where rebalanced would have unregistered as part of the queue rebalancing.  Only if the unregister operation had failed would this bug manifest.  That would have shown up in the logs.

This PR is marked WIP because it's not yet obvious that this is the right fix.  It's not clear under what conditions the OrleansMessageRejectionException is returned.  The GetApproximateSiloStatus check implies that it was expected that there was a possibility for OrleansMessageRejectionException to be received when the producer was still valid and I've yet been unable to rule this out.  The cost of getting this wrong is that healthy producers could be removed thus no longer be notified of subscription changes on that stream.","WIP - More aggressively cleanup system target stream producers. This is part of a follow-up on stream rebalancing issues raised by @ilyalukyanov in Stream resubscription issues #3484.

The concern was that inactive system target stream producers were not being cleaned up in the pubsub state leading to streams that could no longer be subscribed to or unsubscribed from.

There is an issue here though I am unconvinced it is the cause of the behaviors @ilyalukyanov is seeing.  This conclusion comes from the fact that in @ilyalukyanov's scenario silos were being killed so the system target stream producers on those silo by the existing logic should be cleaned up.  The system target stream producers that where rebalanced would have unregistered as part of the queue rebalancing.  Only if the unregister operation had failed would this bug manifest.  That would have shown up in the logs.

This PR is marked WIP because it's not yet obvious that this is the right fix.  It's not clear under what conditions the OrleansMessageRejectionException is returned.  The GetApproximateSiloStatus check implies that it was expected that there was a possibility for OrleansMessageRejectionException to be received when the producer was still valid and I've yet been unable to rule this out.  The cost of getting this wrong is that healthy producers could be removed thus no longer be notified of subscription changes on that stream.",work-in-progress,ilyalukyanov,22/03/2018 8:30,1/03/2019 8:51
4273,Add validation for pubsubstore when using persistent streams,"Persistent streams which has Explicit pubsub configured requires a grain storage with name  configured with silo. But this is not obvious to users. So in this PR adding a validation for this if user forget to configure one. 

Fix for #4196 ","Add validation for pubsubstore when using persistent streams Persistent streams which has Explicit pubsub configured requires a grain storage with name  configured with silo. But this is not obvious to users. So in this PR adding a validation for this if user forget to configure one. 

Fix for #4196 ",,ReubenBond,,
4272,Added test to exersize queue rebalancing while actively streaming,"This tests is a follow-up on stream rebalancing issues raised by @ilyalukyanov in Stream resubscription issues #3484.
It will not compile or pass tests until Lease based queue balancer fixes #4267 is merged.","Added test to exersize queue rebalancing while actively streaming This tests is a follow-up on stream rebalancing issues raised by @ilyalukyanov in Stream resubscription issues #3484.
It will not compile or pass tests until Lease based queue balancer fixes #4267 is merged.",,xiazen,,
4271,Clean up EH checkpointing,#NAME?,"Clean up EH checkpointing - checkpoints new uses serviceid for partitioning
- table name has default",,xiazen,,
4269,Fix race condition in ClientMessageCenter,"Fix for #3171 

We could add code to make request fail quicker (not waiting the default timeout) but it a very edge case so I don't think it is worth it.","Fix race condition in ClientMessageCenter Fix for #3171 

We could add code to make request fail quicker (not waiting the default timeout) but it a very edge case so I don't think it is worth it.",,ReubenBond,,
4268,How to determine message is delivered on OneWay mode ？,"Seems orleans send self a rejection response message while request message fail to send
but in OneWay mode  error message will not throw so i can't catch it

is there any way could ensure message will arrive in OneWay mode?","How to determine message is delivered on OneWay mode ？ Seems orleans send self a rejection response message while request message fail to send
but in OneWay mode  error message will not throw so i can't catch it

is there any way could ensure message will arrive in OneWay mode?",,ReubenBond,,
4267,Lease based queue balancer fixes,"- Timers were not on orleans thread so couldn't make grain calls.
- Aqure logic could be too greedy
- logging and spelling cleanup (can you believe -I- fixed spelling?)
- prevented possible devide by 0 issues.","Lease based queue balancer fixes - Timers were not on orleans thread so couldn't make grain calls.
- Aqure logic could be too greedy
- logging and spelling cleanup (can you believe -I- fixed spelling?)
- prevented possible devide by 0 issues.",,xiazen,,
4265,Intermittent failures of ThreeClusterBattery test,"https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4079&resultId=101380
>Error message
System.AggregateException : One or more errors occurred.\r\n---- Orleans.Runtime.OrleansMessageRejectionException : Forwarding failed: tried to forward message NewPlacement Request S127.0.0.1:21300:259343047*gcl/C/562f28b3+C@ef6312b6->S127.0.0.1:21301:259343061*grn/21E58844/4fe3f9d0@ca8917b6 #865358[ForwardCount=2]: for 2 times after Duplicate activation to invalid activation. Rejecting now. 
Stack trace
at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout CancellationToken cancellationToken)
at UnitTests.GeoClusterTests.MultiClusterRegistrationTests.ClientWrapper.GetRuntimeId(Int32 i) in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\MultiClusterRegistrationTests.cs:line 179
at UnitTests.GeoClusterTests.MultiClusterRegistrationTests.<Deact>d__17.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\MultiClusterRegistrationTests.cs:line 0
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.TestingClusterHost.<RunWithTimeout>d__6.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\TestingClusterHost.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.GeoClusterTests.MultiClusterRegistrationTests.<ThreeClusterBattery>d__5.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\MultiClusterRegistrationTests.cs:line 70
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
----- Inner Stack Trace -----
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansTaskExtentions.<<ToTypedTask>g__ConvertAsync4_0>d1.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.Core\Async\TaskExtensions.cs:line 100","Intermittent failures of ThreeClusterBattery test https://orleans.visualstudio.com/Orleans/_TestManagement/Runs?_a=resultSummary&runId=4079&resultId=101380
>Error message
System.AggregateException : One or more errors occurred.\r\n---- Orleans.Runtime.OrleansMessageRejectionException : Forwarding failed: tried to forward message NewPlacement Request S127.0.0.1:21300:259343047*gcl/C/562f28b3+C@ef6312b6->S127.0.0.1:21301:259343061*grn/21E58844/4fe3f9d0@ca8917b6 #865358[ForwardCount=2]: for 2 times after Duplicate activation to invalid activation. Rejecting now. 
Stack trace
at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout CancellationToken cancellationToken)
at UnitTests.GeoClusterTests.MultiClusterRegistrationTests.ClientWrapper.GetRuntimeId(Int32 i) in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\MultiClusterRegistrationTests.cs:line 179
at UnitTests.GeoClusterTests.MultiClusterRegistrationTests.<Deact>d__17.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\MultiClusterRegistrationTests.cs:line 0
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Tests.GeoClusterTests.TestingClusterHost.<RunWithTimeout>d__6.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\TestingClusterHost.cs:line 72
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.GeoClusterTests.MultiClusterRegistrationTests.<ThreeClusterBattery>d__5.MoveNext() in D:\build\agent\_work\18\s\test\TesterInternal\GeoClusterTests\MultiClusterRegistrationTests.cs:line 70
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
----- Inner Stack Trace -----
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at Orleans.OrleansTaskExtentions.<<ToTypedTask>g__ConvertAsync4_0>d1.MoveNext() in D:\build\agent\_work\18\s\src\Orleans.Core\Async\TaskExtensions.cs:line 100",test-issue,sebastianburckhardt,,
4264,Remove duplicate references to AdoNet.targets,"This is a follow-up to #4243.

There are currently build warnings while building . This change seems to make build happy and the content files still get copied to the project folder.

@veikkoeeva Could you double-check please.","Remove duplicate references to AdoNet.targets This is a follow-up to #4243.

There are currently build warnings while building . This change seems to make build happy and the content files still get copied to the project folder.

@veikkoeeva Could you double-check please.",,ReubenBond,,
4263,Support for Method Invoke Attributes on Interface to apply to all methods,"I'm running into a case where I am adding an attribute (specifically  to generate the invoke options for the interface and then merge with individual method options into the invocation expression.

I'm happy to work on a PR for this but I wanted to get some feedback before pursuing.","Support for Method Invoke Attributes on Interface to apply to all methods I'm running into a case where I am adding an attribute (specifically  to generate the invoke options for the interface and then merge with individual method options into the invocation expression.

I'm happy to work on a PR for this but I wanted to get some feedback before pursuing.",,ReubenBond,,
4260,What is PubSubStore for? Running one night will produce more than 140000 data,What is PubSubStore for? Running one night will produce more than 140000 data,"What is PubSubStore for? Running one night will produce more than 140,000 data What is PubSubStore for? Running one night will produce more than 140000 data",question,jason-bragg,,
4255,Remove [Obsolete] attributes from most legacy types,"Fixes #4252.

I only left .","Remove [Obsolete] attributes from most legacy types Fixes #4252.

I only left .",,jason-bragg,,
4253,Fix build break by fixing GeoClusterTests,,Fix build break by fixing GeoClusterTests ,,benjaminpetit,,
4251,Azure Table API with Orleans rc2,"Is it possible to use persist grain state in Azure Table API or any other Azure storage? I'm trying to configure it but I haven't found any useful example. Is it ready?

I'm referring to Orleans on .net core.","Azure Table API with Orleans rc2 Is it possible to use persist grain state in Azure Table API or any other Azure storage? I'm trying to configure it but I haven't found any useful example. Is it ready?

I'm referring to Orleans on .net core.",documentation,sergeybykov,20/03/2018 7:59,3/04/2018 22:25
4250,Question: Orleans dependencies across all assemblies.,"Question about orleans dependencies across all assemblies.

Hello! 
Perhaps this question is not the first and a little bit naive but i could not find similar issue.

http://dotnet.github.io/orleans/Tutorials/My-First-Orleans-Application.html

In you tutorial for Orleans 2.0 solution has 3 assemblies:

?

After this call IPlayerGrain does not need to implement IGrainWithGuidKey and GrainIneterfaces assembly will be clean.","Question: Orleans dependencies across all assemblies. Question about orleans dependencies across all assemblies.

Hello! 
Perhaps this question is not the first and a little bit naive but i could not find similar issue.

http://dotnet.github.io/orleans/Tutorials/My-First-Orleans-Application.html

In you tutorial for Orleans 2.0 solution has 3 assemblies:

?

After this call IPlayerGrain does not need to implement IGrainWithGuidKey and GrainIneterfaces assembly will be clean.",P3,JillHeaden,,
4248,Orleans 2.0-rc2 - enums with GeneratedCode attribute cannot be serialized by grain client,"First off I want to be very clear that I don't see this as an issue per se.  Just FYI in case others deem this worthwhile to deal with.

My grain interfaces project referenced a common business model project with classes generated from an xml schema codegen tool adding  attribute are not serializable - particualrly enums.

Again not a real issue as it's simple enough for me to remove this attribute.  We're considering separating our silo business models from the xml generated ones anyway so I'm good.  Just posting this in case others encounter this issue or if people feel it's worth resolving.","Orleans 2.0-rc2 - enums with GeneratedCode attribute cannot be serialized by grain client First off I want to be very clear that I don't see this as an issue per se.  Just FYI in case others deem this worthwhile to deal with.

My grain interfaces project referenced a common business model project with classes generated from an xml schema codegen tool adding  attribute are not serializable - particualrly enums.

Again not a real issue as it's simple enough for me to remove this attribute.  We're considering separating our silo business models from the xml generated ones anyway so I'm good.  Just posting this in case others encounter this issue or if people feel it's worth resolving.",,ReubenBond,,
4247,How to configure Default Collection Age Limit in Orleans 2.0,"Hello
I need to configure Default Collection Age in Orleans 2.0.
Could you please tell me how can I do this?
I found this documentation but it's not for Orleans 2.0
http://dotnet.github.io/orleans/Documentation/Advanced-Concepts/Activation-Garbage-Collection.html

I think it's related to #4244 ","How to configure Default Collection Age Limit in Orleans 2.0 Hello
I need to configure Default Collection Age in Orleans 2.0.
Could you please tell me how can I do this?
I found this documentation but it's not for Orleans 2.0
http://dotnet.github.io/orleans/Documentation/Advanced-Concepts/Activation-Garbage-Collection.html

I think it's related to #4244 ",documentation,sergeybykov,20/03/2018 1:51,3/04/2018 6:23
4244,Is there any sample for the 2.0 configuraton?,"There is no sample no document about common orleans 2.0 configuration usage. 
UseLocalhostClustering in http://dotnet.github.io/orleans/Documentation/2.0/Configuration2.0.html is not enough","Is there any sample for the 2.0 configuraton? There is no sample no document about common orleans 2.0 configuration usage. 
UseLocalhostClustering in http://dotnet.github.io/orleans/Documentation/2.0/Configuration2.0.html is not enough",documentation,xiazen,,
4237,How to represent a database table?,"Newbie question: Suppose I have a database table and would like to expose some basic methods like Add/Update/Delete through grains.
1) Should the grain be the table or the individual rows?
2) If the table is represented with grains as individual rows how do I create a master grain that can find the right grain to update?
Thanks
","How to represent a database table? Newbie question: Suppose I have a database table and would like to expose some basic methods like Add/Update/Delete through grains.
1) Should the grain be the table or the individual rows?
2) If the table is represented with grains as individual rows how do I create a master grain that can find the right grain to update?
Thanks
",question,sergeybykov,16/03/2018 19:01,3/04/2018 7:30
4236,Use Orleans and AspNetCore or The Battle for IServiceProvider,"I opened an issue for aspnet/hosting [#1349](https://github.com/aspnet/Hosting/issues/1349) regarding dependency injection. 
The [gist ](https://gist.github.com/eisendle/b1bc2259e5d753d7d460cc27a182191e)in this issue shows the problems which arise when AspNetCore is used together withOrleans in terms of ownership of the IServiceProvider.

I have read somewhere that there will be an generic HostBuilder implementation and Orleans will switch to this new nuget package for building the SiloHost. Is this the plan?

If so I´d like to challenge this decision because the HostBuilder enforces ownership of the IServiceProvider and when using two frameworks which use HostBuilder (like in my example AspNetCore and Orleans) there is no easy way to use only one IServiceProvider.

As a result it would be difficult to use AspNetCore and Orleans together.","Use Orleans and AspNetCore or The Battle for IServiceProvider I opened an issue for aspnet/hosting [#1349](https://github.com/aspnet/Hosting/issues/1349) regarding dependency injection. 
The [gist ](https://gist.github.com/eisendle/b1bc2259e5d753d7d460cc27a182191e)in this issue shows the problems which arise when AspNetCore is used together withOrleans in terms of ownership of the IServiceProvider.

I have read somewhere that there will be an generic HostBuilder implementation and Orleans will switch to this new nuget package for building the SiloHost. Is this the plan?

If so I´d like to challenge this decision because the HostBuilder enforces ownership of the IServiceProvider and when using two frameworks which use HostBuilder (like in my example AspNetCore and Orleans) there is no easy way to use only one IServiceProvider.

As a result it would be difficult to use AspNetCore and Orleans together.",,jason-bragg,,
4235,Make providers use Cluster ID and Service ID from ClusterOptions,"Make providers use Cluster ID and Service ID from ClusterOptions.
Also fix Azure Queue SQS and GCP pubsub providers to use Service ID instead of Cluster ID.","Make providers use Cluster ID and Service ID from ClusterOptions Make providers use Cluster ID and Service ID from ClusterOptions.
Also fix Azure Queue SQS and GCP pubsub providers to use Service ID instead of Cluster ID.",,benjaminpetit,,
4233,Generic interface non-generic grain causes Exception from Method property in interceptor,"The following code demonstrates an issue which occurs in 

xref: #4178","Generic interface, non-generic grain causes Exception from Method property in interceptor The following code demonstrates an issue which occurs in 

xref: #4178",bug,ReubenBond,,
4232,New query functionality,"@wentaowu and I are planning to add more query functionality beyond what's in http://github.com/OrleansContrib/Orleans.Indexing . We'd welcome recommendations for high-priority additions e.g. ones you had to implement in your app due to a lack of built-in Orleans support. We have two questions. First what types of query expressions are most important? For example:
 
1.	Select grains in a grain class satisfying a {< ≤> ≥} predicate on a property. E.g. Employee.Salary < 100K. This requires adding B-trees to Orleans.Indexing which currently supports only hash indexes. 
 
2.	Top-K query over a group of grains in a grain class. E.g. top-10 players in a game grouped by game type which is a property of the game grain-type.
 
3.	Aggregate queries i.e. count sum max min average over a collection. E.g. number of devices of each device type where device type is a property of the device grain-type.
 
4.	Path queries. E.g. a list of teams that have a member M with M.Languages containing ""F#"" where Team is a grain-type that has a collection-valued property called Members and Member is a grain type with a collection-valued property called Languages.
 
Second over which set of grains can a query be executed? For example:
 
5.	Queries over all initialized grains of one or more grain-types where grains are mapped to persistent storage.
 
6.	Same as (5) but one or more of the grain types is not persisted.
 
7.	Queries over active grains only.  
 
8.	Queries over streams with a window function. E.g. all devices that reported a failure in the last 5 minutes.
 
9.	Materialized views. For a given query maintain its result in the face of updates to the underlying grains. E.g. a count of the number of faulty devices of each device type (which is a grain class).



","New query functionality @wentaowu and I are planning to add more query functionality beyond what's in http://github.com/OrleansContrib/Orleans.Indexing . We'd welcome recommendations for high-priority additions e.g. ones you had to implement in your app due to a lack of built-in Orleans support. We have two questions. First what types of query expressions are most important? For example:
 
1.	Select grains in a grain class satisfying a {< ≤> ≥} predicate on a property. E.g. Employee.Salary < 100K. This requires adding B-trees to Orleans.Indexing which currently supports only hash indexes. 
 
2.	Top-K query over a group of grains in a grain class. E.g. top-10 players in a game grouped by game type which is a property of the game grain-type.
 
3.	Aggregate queries i.e. count sum max min average over a collection. E.g. number of devices of each device type where device type is a property of the device grain-type.
 
4.	Path queries. E.g. a list of teams that have a member M with M.Languages containing ""F#"" where Team is a grain-type that has a collection-valued property called Members and Member is a grain type with a collection-valued property called Languages.
 
Second over which set of grains can a query be executed? For example:
 
5.	Queries over all initialized grains of one or more grain-types where grains are mapped to persistent storage.
 
6.	Same as (5) but one or more of the grain types is not persisted.
 
7.	Queries over active grains only.  
 
8.	Queries over streams with a window function. E.g. all devices that reported a failure in the last 5 minutes.
 
9.	Materialized views. For a given query maintain its result in the face of updates to the underlying grains. E.g. a count of the number of faulty devices of each device type (which is a grain class).



",enhancement,philbe,16/03/2018 5:27,
4230,Chirper Scale Subscriber (Follower),"Is there a limit to the number of subscribers of a publisher? Example: users with 20 million followers each. pub-sub cache in Pulling Protocol resolves this? I've seen Benchmarks in [https://www.researchgate.net/publication/233416056_Orleans_Cloud_Computing_for_Everyone](url) but the example each user only has 27 followers each. I'm having a Fan-out-on-write feed project and would like to know if this is the correct way?
Thanks
","Chirper Scale Subscriber (Follower) Is there a limit to the number of subscribers of a publisher? Example: users with 20 million followers each. pub-sub cache in Pulling Protocol resolves this? I've seen Benchmarks in [https://www.researchgate.net/publication/233416056_Orleans_Cloud_Computing_for_Everyone](url) but the example each user only has 27 followers each. I'm having a Fan-out-on-write feed project and would like to know if this is the correct way?
Thanks
",question,sergeybykov,16/03/2018 1:20,3/04/2018 7:30
4229,Is IServiceCollection.AddScoped seemingly invalid in Orleans?,,Is IServiceCollection.AddScoped seemingly invalid in Orleans? ,question,xiazen,,
4228,Fix build errors with dotnet core sdk 2.1.101,"I got some build errors after updating Visual Studio and dotnet SDK.  These changes fixed the build errors.
","Fix build errors with dotnet core sdk 2.1.101 I got some build errors after updating Visual Studio and dotnet SDK.  These changes fixed the build errors.
",,ReubenBond,,
4227,Orleans.Clustering.ZooKeeper When is it released?,,Orleans.Clustering.ZooKeeper When is it released? ,question,sergeybykov,15/03/2018 18:27,16/03/2018 12:32
4226,ServiceFabric :  A cluster id has not been configured BUG,"what's error with me?
how to do it?

","ServiceFabric :  A cluster id has not been configured, BUG what's error with me?
how to do it?

",,ReubenBond,,
4225,Adding Orleans.Client to ASP.Net Core WebApi project causes a stack overflow,"Repo:
1. In VS.Net 2017 create an ASP.Net Core WebApi project then run it in debug.
2. Add Microsoft.Orlenas.Client 2.0.0-rc2 package to the project and run it again in debug.

Result:
Stack overflow error.
","Adding Orleans.Client to ASP.Net Core WebApi project causes a stack overflow Repo:
1. In VS.Net 2017 create an ASP.Net Core WebApi project then run it in debug.
2. Add Microsoft.Orlenas.Client 2.0.0-rc2 package to the project and run it again in debug.

Result:
Stack overflow error.
",,ReubenBond,,
4222,Intemittent failures of ValidateGeneratedStreamsTest,,Intemittent failures of ValidateGeneratedStreamsTest ,P3,sergeybykov,15/03/2018 8:19,
4221,Intermittent failure of  StressHandlingMultipleDelayedRequests test,,Intermittent failure of  StressHandlingMultipleDelayedRequests test ,test-issue,benjaminpetit,,
4220,Intermittent failures of ControllableAdapter* tests,"ControllableAdapterEchoTest
ControllableAdapterFactoryEchoTest","Intermittent failures of ControllableAdapter* tests ControllableAdapterEchoTest
ControllableAdapterFactoryEchoTest",test-issue,xiazen,,
4219,Fix for #4129,,Fix for #4129 ,,benjaminpetit,,
4218,One minute minimum restriction on Reminder period,"It would be useful to be able to set the minimum Reminder period to less than one minute for a handful of critical grains that may not receive messages often and that we don't want to leave deactivated for up to a minute.

One example would be a grain that primarily runs a _timer_ to perform some critical work that should ideally always be performed at intervals below a minute.

If it was possible to set the reminder to less than one minute then the _timer_ might not even be necessary if the reminder period was sufficient.

I am guessing that the one minute restriction is performance related. If so in my opinion the decision should be left to the application designer...","One minute minimum restriction on Reminder period It would be useful to be able to set the minimum Reminder period to less than one minute for a handful of critical grains that may not receive messages often and that we don't want to leave deactivated for up to a minute.

One example would be a grain that primarily runs a _timer_ to perform some critical work that should ideally always be performed at intervals below a minute.

If it was possible to set the reminder to less than one minute then the _timer_ might not even be necessary if the reminder period was sufficient.

I am guessing that the one minute restriction is performance related. If so in my opinion the decision should be left to the application designer...",question,ReubenBond,14/03/2018 18:59,
4217,Grains on SiloA deactivated because of SiloB shutting down,"Hi there.

I've found an issue where app grains on one silo are often being deactivated because another silo shut down. This seems like a serious reliability problem to me as any grain can essentially be deactivated anywhere in the cluster at any time even though their hosting silo is not affected.

Hoping this is not expected behaviour as any grain that uses timers and does not regularly receive messages could be deactivated in this way.

It's easy to reproduce (see steps at end) and I have been able to repro in v1.5.1 and v1.5.3 using memory and azure table storage (via emulator).

Here are the entries in the log that precede the deactivation:

    [2018-03-14 05:57:13.401 GMT    10      INFO    100524  Catalog 10.1.26.61:11111]       Catalog is deactivating 11 activations due to a failure of silo S10.1.26.61:11112:258702790/x177DA9FF since it is a primary directory partition to these grain ids.
    [2018-03-14 05:57:13.407 GMT    14      INFO    103004  VirtualBucketsRingProvider      10.1.26.61:11111]       Removed Server S10.1.26.61:11112:258702790/x177DA9FF. Current view: [S10.1.26.61:11111:258702592 -> <MultiRange: Size=x100000000 %Ring=100.000%>]
    [2018-03-14 05:57:13.419 GMT    10      INFO    100541  Catalog 10.1.26.61:11111]       DeactivateActivations: total 11 to shutdown out of them 11 promptly 0 later when become idle and 0 are already being destroyed or invalid.
    [2018-03-14 05:57:13.425 GMT    14      INFO    103005  VirtualBucketsRingProvider      10.1.26.61:11111]       -NotifyLocalRangeSubscribers about old <MultiRange: Size=x863E5CFB %Ring=52.439%> new <MultiRange: Size=x100000000 %Ring=100.000%> increased? True
    [2018-03-14 05:57:13.442 GMT    10      INFO    100503  Catalog 10.1.26.61:11111]       Starting DestroyActivations #0 of 11 activations
    [2018-03-14 05:57:13.447 GMT    14      INFO    100612  MembershipOracle        10.1.26.61:11111]   Will watch (actively ping) 0 silos: []
    [2018-03-14 05:57:13.447 GMT    13      INFO    102934  Orleans.Runtime.ReminderService.LocalReminderService    10.1.26.61:11111]    My range changed from <MultiRange: Size=x863E5CFB %Ring=52.439%> to <MultiRange: Size=x100000000 %Ring=100.000%> increased = True
    [2018-03-14 05:57:13.476 GMT     8      ERROR   -1      OrleansTest.PubSubGrain ]       !!!!!!!!!! PubSubGrain on silo S10.1.26.61:11111:258702592 being deactivated because of shutdown of another silo!

The last error above is being logged by me in OnDeactivateAsync() of the grain that should not be deactivated. It was created on the initial silo and requests delayed deactivation in OnActivateAsync().

I've attached a simple project that makes it easy to repro and debug by following these steps:
* Open OrleansTest.sln in VS 2017 build and update the debug executable to the OrleansHost.exe in the bin/Debug directory.
* Start the Azure Storage Emulator. Alternatively rename the included OrleansConfiguration_memorystorage.xml and OrleansConfiguration2_memorystorage.xml files to OrleansConfiguration.xml and OrleansConfiguration2.xml respectively.
* Start Debug session.
* Wait for first silo to start successfully and for one of the messages to be logged e.g. ""Processing message 'some message' in grain ...""
* Open command line in bin/Debug directory.
*## Start the second silo by executing ""OrleansHost.exe SecondSilo OrleansConfiguration2.xml"".
* Wait for this second silo to start logging ""Processing message 'some message' in grain ..."". This indicates that a grain on the second silo is also now receiving messages.
* Press Ctrl+C to stop second silo.
* About 60% of the time the grain sending the messages (which started on the first silo) will be shut down because of the second silo being stopped. The other 40% of the time the grains on the second silo will be activated on the first silo and everything continues working as expected.
* If the incorrect deactivation does not occur just keep repeating from step *## above and it will happen.

Thanks.

[OrleansDeactivationRepro.zip](https://github.com/dotnet/orleans/files/1809832/OrleansDeactivationRepro.zip)
","Grains on SiloA deactivated because of SiloB shutting down Hi there.

I've found an issue where app grains on one silo are often being deactivated because another silo shut down. This seems like a serious reliability problem to me as any grain can essentially be deactivated anywhere in the cluster at any time even though their hosting silo is not affected.

Hoping this is not expected behaviour as any grain that uses timers and does not regularly receive messages could be deactivated in this way.

It's easy to reproduce (see steps at end) and I have been able to repro in v1.5.1 and v1.5.3 using memory and azure table storage (via emulator).

Here are the entries in the log that precede the deactivation:

    [2018-03-14 05:57:13.401 GMT    10      INFO    100524  Catalog 10.1.26.61:11111]       Catalog is deactivating 11 activations due to a failure of silo S10.1.26.61:11112:258702790/x177DA9FF since it is a primary directory partition to these grain ids.
    [2018-03-14 05:57:13.407 GMT    14      INFO    103004  VirtualBucketsRingProvider      10.1.26.61:11111]       Removed Server S10.1.26.61:11112:258702790/x177DA9FF. Current view: [S10.1.26.61:11111:258702592 -> <MultiRange: Size=x100000000 %Ring=100.000%>]
    [2018-03-14 05:57:13.419 GMT    10      INFO    100541  Catalog 10.1.26.61:11111]       DeactivateActivations: total 11 to shutdown out of them 11 promptly 0 later when become idle and 0 are already being destroyed or invalid.
    [2018-03-14 05:57:13.425 GMT    14      INFO    103005  VirtualBucketsRingProvider      10.1.26.61:11111]       -NotifyLocalRangeSubscribers about old <MultiRange: Size=x863E5CFB %Ring=52.439%> new <MultiRange: Size=x100000000 %Ring=100.000%> increased? True
    [2018-03-14 05:57:13.442 GMT    10      INFO    100503  Catalog 10.1.26.61:11111]       Starting DestroyActivations #0 of 11 activations
    [2018-03-14 05:57:13.447 GMT    14      INFO    100612  MembershipOracle        10.1.26.61:11111]   Will watch (actively ping) 0 silos: []
    [2018-03-14 05:57:13.447 GMT    13      INFO    102934  Orleans.Runtime.ReminderService.LocalReminderService    10.1.26.61:11111]    My range changed from <MultiRange: Size=x863E5CFB %Ring=52.439%> to <MultiRange: Size=x100000000 %Ring=100.000%> increased = True
    [2018-03-14 05:57:13.476 GMT     8      ERROR   -1      OrleansTest.PubSubGrain ]       !!!!!!!!!! PubSubGrain on silo S10.1.26.61:11111:258702592 being deactivated because of shutdown of another silo!

The last error above is being logged by me in OnDeactivateAsync() of the grain that should not be deactivated. It was created on the initial silo and requests delayed deactivation in OnActivateAsync().

I've attached a simple project that makes it easy to repro and debug by following these steps:
* Open OrleansTest.sln in VS 2017 build and update the debug executable to the OrleansHost.exe in the bin/Debug directory.
* Start the Azure Storage Emulator. Alternatively rename the included OrleansConfiguration_memorystorage.xml and OrleansConfiguration2_memorystorage.xml files to OrleansConfiguration.xml and OrleansConfiguration2.xml respectively.
* Start Debug session.
* Wait for first silo to start successfully and for one of the messages to be logged e.g. ""Processing message 'some message' in grain ...""
* Open command line in bin/Debug directory.
*## Start the second silo by executing ""OrleansHost.exe SecondSilo OrleansConfiguration2.xml"".
* Wait for this second silo to start logging ""Processing message 'some message' in grain ..."". This indicates that a grain on the second silo is also now receiving messages.
* Press Ctrl+C to stop second silo.
* About 60% of the time the grain sending the messages (which started on the first silo) will be shut down because of the second silo being stopped. The other 40% of the time the grains on the second silo will be activated on the first silo and everything continues working as expected.
* If the incorrect deactivation does not occur just keep repeating from step *## above and it will happen.

Thanks.

[OrleansDeactivationRepro.zip](https://github.com/dotnet/orleans/files/1809832/OrleansDeactivationRepro.zip)
",documentation,sergeybykov,14/03/2018 17:30,
4213,Intermittent failures of InterSiloClientCancellationTokenPassing test,"**Error message**
System.Exception : Could not make requested grains placement

**Stack trace**
>at UnitTests.CancellationTests.GrainCancellationTokenTests.<GetGrains>d__161.MoveNext() in D:\build\agent\_work\18\s\test\Tester\CancellationTests\GrainCancellationTokenTests.cs:line 194
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.CancellationTests.GrainCancellationTokenTests.<ClientGrainGrainTokenPassing>d__14.MoveNext() in D:\build\agent\_work\18\s\test\Tester\CancellationTests\GrainCancellationTokenTests.cs:line 161
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.CancellationTests.GrainCancellationTokenTests.<InterSiloClientCancellationTokenPassing>d__12.MoveNext() in D:\build\agent\_work\18\s\test\Tester\CancellationTests\GrainCancellationTokenTests.cs:line 147
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)","Intermittent failures of InterSiloClientCancellationTokenPassing test **Error message**
System.Exception : Could not make requested grains placement

**Stack trace**
>at UnitTests.CancellationTests.GrainCancellationTokenTests.<GetGrains>d__161.MoveNext() in D:\build\agent\_work\18\s\test\Tester\CancellationTests\GrainCancellationTokenTests.cs:line 194
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.CancellationTests.GrainCancellationTokenTests.<ClientGrainGrainTokenPassing>d__14.MoveNext() in D:\build\agent\_work\18\s\test\Tester\CancellationTests\GrainCancellationTokenTests.cs:line 161
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
at UnitTests.CancellationTests.GrainCancellationTokenTests.<InterSiloClientCancellationTokenPassing>d__12.MoveNext() in D:\build\agent\_work\18\s\test\Tester\CancellationTests\GrainCancellationTokenTests.cs:line 147
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
--- End of stack trace from previous location where exception was thrown ---
at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)",P3,sergeybykov,14/03/2018 5:20,
4211,Fix validator ordering,"Fix #4203 

The issue is that  from DI and they require themselves a lot of other components in DI...

So if this validator is called before the validators from the options used in these membership constructors it will fail without a good error message.

I think we should move these ""advanced"" check in the silo startup to avoid any trouble in the future but for now it should fix the issue.","Fix validator ordering Fix #4203 

The issue is that  from DI and they require themselves a lot of other components in DI...

So if this validator is called before the validators from the options used in these membership constructors it will fail without a good error message.

I think we should move these ""advanced"" check in the silo startup to avoid any trouble in the future but for now it should fix the issue.",,jason-bragg,,
4210,ISiloHostBuilder.UseLocalhostClustering with primarySiloEndpoint set to null throw exception,"The doc says:


But then the silo fails to start with:

> Orleans.Runtime.OrleansLifecycleCanceledException: Lifecycle start canceled due to errors at stage 8000 ---> Orleans.Runtime.OrleansConfigurationException: > DevelopmentClusterMembershipOptions.PrimarySiloEndpoint must be set when using development clustering.
","ISiloHostBuilder.UseLocalhostClustering with primarySiloEndpoint set to null throw exception The doc says:


But then the silo fails to start with:

> Orleans.Runtime.OrleansLifecycleCanceledException: Lifecycle start canceled due to errors at stage 8000 ---> Orleans.Runtime.OrleansConfigurationException: > DevelopmentClusterMembershipOptions.PrimarySiloEndpoint must be set when using development clustering.
",bug,benjaminpetit,,
4207,[2.0 RC2] Ado.Net reminders provider is broken in RC2,"After upgrade to RC2 I have exception when using Ado.Net reminders provider. I configure it as:


","[2.0 RC2] Ado.Net reminders provider is broken in RC2 After upgrade to RC2 I have exception when using Ado.Net reminders provider. I configure it as:


",,ReubenBond,,
4206,Orleans.OrleansCodeGenerator.Build Failed to execute,"![image](https://user-images.githubusercontent.com/28291464/37336461-67e10050-26ec-11e8-8746-aa2eb16bb703.png)
","Orleans.OrleansCodeGenerator.Build Failed to execute ![image](https://user-images.githubusercontent.com/28291464/37336461-67e10050-26ec-11e8-8746-aa2eb16bb703.png)
",,ReubenBond,,
4205,[2.0 RC2 ]recommends IServiceCollection.AddIncomingGrainCallFilter to restore Public,"@ReubenBond 

2.0 RC2 ","[2.0 RC2 ]recommends IServiceCollection.AddIncomingGrainCallFilter to restore Public @ReubenBond 

2.0 RC2 ",,ReubenBond,,
4203,NullReferenceException if EndpointOptions.AdvertisedIPAddress is not specified,The following test fails with a ,NullReferenceException if EndpointOptions.AdvertisedIPAddress is not specified The following test fails with a ,,benjaminpetit,,
4202,How does Orleans unit test? Is there an instance or document?,How does Orleans unit test? Is there an instance or document?,How does Orleans unit test? Is there an instance or document? How does Orleans unit test? Is there an instance or document?,question,sergeybykov,13/03/2018 13:30,14/03/2018 17:20
4201,Bboyle1234 shutdowndocs,,Bboyle1234 shutdowndocs ,documentation,sergeybykov,13/03/2018 12:23,22/03/2018 10:38
4200,Gateways route system target calls correctly - test,Added test demonstrating that system target calls are not routed correctly from the client.  The test demonstrates this by showing persistent streams fail to work when Gateways are not defined on every silo.,Gateways route system target calls correctly - test Added test demonstrating that system target calls are not routed correctly from the client.  The test demonstrates this by showing persistent streams fail to work when Gateways are not defined on every silo.,,benjaminpetit,,
4198,Streaming questions,"This is not an issue but questions. The answers could be useful for a streaming FAQ:

- For ImplicitStreamSubscriptions there is a great amount of housekeeping that the developer must do to subscribe to its own stream and unsubscribe resume and such. Can it be enhanced to a degree to get these done by the runtime and not by the developer? It is easy to miss and there is no sample code on how to do streaming (right).

- Streaming implementation does not fan out to all subscribers but calling and awaiting them one-by-one (if not fire and forget specified). For me fire and forget is a misleading name but documentation states what it does. Perhaps getting all the  payload happens for every subscriber and not just once? For multiple subscribers it could be a great overhead.","Streaming questions This is not an issue but questions. The answers could be useful for a streaming FAQ:

- For ImplicitStreamSubscriptions there is a great amount of housekeeping that the developer must do to subscribe to its own stream and unsubscribe resume and such. Can it be enhanced to a degree to get these done by the runtime and not by the developer? It is easy to miss and there is no sample code on how to do streaming (right).

- Streaming implementation does not fan out to all subscribers but calling and awaiting them one-by-one (if not fire and forget specified). For me fire and forget is a misleading name but documentation states what it does. Perhaps getting all the  payload happens for every subscriber and not just once? For multiple subscribers it could be a great overhead.",documentation,sergeybykov,13/03/2018 9:57,
4197,Grain could stuck until timeout when stream subscriber is not reachable (disconnected),"Problem:
I'm facing a streaming issue. I configured a SimpleMessageStream with Memory storage for pubsub. I'm having a simple client who instantiates a Grain invoking a method on it and inside the method the Grain calls 
","Grain could stuck until timeout, when stream subscriber is not reachable (disconnected) Problem:
I'm facing a streaming issue. I configured a SimpleMessageStream with Memory storage for pubsub. I'm having a simple client who instantiates a Grain invoking a method on it and inside the method the Grain calls 
",,xiazen,,
4196,Silo should validate if a PubSubStore is configured or not before starting,"Issue:
When you setup the streaming but not adding a storage with the baked in name of ""PubSubStore"" the Silo starts without errors and then later when it needs to access the store to persist a subscription it fails during runtime.

Solution:
Add additional validation if a ""PubSubStore"" is registered in DI or not. If not fail early with configuration exception.

Nice to have:
Make ""PubSubStore"" provider name configurable
","Silo should validate if a PubSubStore is configured or not before starting Issue:
When you setup the streaming but not adding a storage with the baked in name of ""PubSubStore"" the Silo starts without errors and then later when it needs to access the store to persist a subscription it fails during runtime.

Solution:
Add additional validation if a ""PubSubStore"" is registered in DI or not. If not fail early with configuration exception.

Nice to have:
Make ""PubSubStore"" provider name configurable
",,xiazen,,
4189,Removing a grain interface from the project fails the build,"How to reproduce:

1. Create a new project for grain interfaces
2. Reference  directory helps.
","Removing a grain interface from the project fails the build How to reproduce:

1. Create a new project for grain interfaces
2. Reference  directory helps.
",,ReubenBond,,
4188,"System.TypeAccessException: Named type ""..."" is invalid: Type string ""..."" cannot be resolved.","I believe I encounter a bug. It seems Orleans doesn't work well with generic type that is located in another project. Could be related to #4012 
I've prepared a minimal repro project for the case: https://github.com/alexandrnikitin/orleans-repro-4188

To reproduce:

","System.TypeAccessException: Named type ""..."" is invalid: Type string ""..."" cannot be resolved. I believe I encounter a bug. It seems Orleans doesn't work well with generic type that is located in another project. Could be related to #4012 
I've prepared a minimal repro project for the case: https://github.com/alexandrnikitin/orleans-repro-4188

To reproduce:

",,ReubenBond,,
4187,Search grains by value in state. Is it possible?,"I have a problem I need to find all grains with a certain value in their state.
For example a grain in a state has a variable IsOnline and I would like to get a list of all such grains.
Now I'm doing this with queries in the repository (I'm using CosmosDB) but maybe there is a better way?","Search grains by value in state. Is it possible? I have a problem I need to find all grains with a certain value in their state.
For example a grain in a state has a variable IsOnline and I would like to get a list of all such grains.
Now I'm doing this with queries in the repository (I'm using CosmosDB) but maybe there is a better way?",question,philbe,12/03/2018 21:19,14/03/2018 3:44
4186,Problems using `Microsoft.Orleans.TestingHost` in a separate .NET Core console app,"I want to use the Test Cluster in a separate console app so I create one and reference the latest 

The same happens if I have references to Grain interfaces and Grains library projects from that console app. What am I doing wrong?","Problems using 

The same happens if I have references to Grain interfaces and Grains library projects from that console app. What am I doing wrong?",,xiazen,,
4184,Correct way to add GrainCallFilter,"The extension methods  are marked as obsolete but after https://github.com/dotnet/orleans/pull/4091 the methods they say to use instead have been made internal.

Should either remove obsolete designation put other methods back to public or create and link to a desired implementation.","Correct way to add GrainCallFilter The extension methods  are marked as obsolete but after https://github.com/dotnet/orleans/pull/4091 the methods they say to use instead have been made internal.

Should either remove obsolete designation put other methods back to public or create and link to a desired implementation.",question,sergeybykov,10/03/2018 7:14,10/03/2018 9:11
4180,Set GrainService.Status to Started in the base implementation of StartInBackground(),"Fixes #4128.
This should help prevent mistakes of not setting the status to started which leads to not receiving cluster repartitioning notifications.","Set GrainService.Status to Started in the base implementation of StartInBackground() Fixes #4128.
This should help prevent mistakes of not setting the status to started which leads to not receiving cluster repartitioning notifications.",,benjaminpetit,,
4179,Pkg Check Always change.,"Reference Microsoft.Orleans.OrleansCodeGenerator.Build

Unable to incrementally upgrade

pkg Check Always change.

2018-03-09t08:35:21.7251126z Searching for application packages: C:VSTSAgentWork219aapplicationpackage
2018-03-09t08:35:21.8161145z Find application Package: C:VSTSAgentWork219aapplicationpackage
2018-03-09t08:35:21.8431113z version value: "". 20180309.9""
2018-03-09t08:35:22.0131140z Previous build Number: ""20180309.8""
2018-03-09T08:35:22.6151082Z Downloading Project ""Drop"" ...
2018-03-09t08:35:33.8640326z Progress Update: 786426 bytes Received ...
2018-03-09t08:35:45.0289523z Progress Update: 1572858 bytes Received ...
2018-03-09t08:35:50.9359148z has completed the download Project ""Drop"".
2018-03-09t08:36:23.1906931z Progress Update: 2146297 bytes Received ...
2018-03-09t08:36:23.2056934z Previous build location: ""C:VSTSAgentWorktmpdrop""
2018-03-09T08:36:23.2056934Z is searching for changes to the application type ' Jobapptype ' ...
2018-03-09t08:36:23.3666896z is searching for changes to the service ""statelessdenormalizerservicepkg"" ...
2018-03-09T08:36:23.4136911Z is searching for a change in package ' Code ' ...
2018-03-09T08:36:43.2015585Z is searching for package ""Config"" for changes ...
2018-03-09T08:36:43.5135588Z is searching for changes to the service ""statelesscommandservicepkg"" ...
2018-03-09t08:36:43.5205567z is searching for a change in package ' Code ' ...
# **2018-03-09t08:36:46.9865323z changed the file ""Labor.job.commandhandler.dll"".**
2018-03-09t08:37:03.1944208z updates the package ""Statelesscommandservicepkgcode"" from version ""1.0.0.20180309.8"" to ""1.0.0.20180309.9"".
2018-03-09T08:37:03.2044209Z is searching for package ""Config"" for changes ...
2018-03-09T08:37:03.3584199Z has changed the service manifest.
2018-03-09t08:37:03.3594197z updates the service ""statelesscommandservicepkg"" from version ""1.0.0.20180309.8"" to ""1.0.0.20180309.9"".
2018-03-09T08:37:03.3944184Z has changed the application manifest. 2018-03-09t08:37:03.3954176z updates the application type ""Jobapptype"" from version ""1.0.0.20180309.8"" to ""1.0.0.20180309.9"".


","Pkg Check Always change. Reference Microsoft.Orleans.OrleansCodeGenerator.Build

Unable to incrementally upgrade

pkg Check Always change.

2018-03-09t08:35:21.7251126z Searching for application packages: C:VSTSAgentWork219aapplicationpackage
2018-03-09t08:35:21.8161145z Find application Package: C:VSTSAgentWork219aapplicationpackage
2018-03-09t08:35:21.8431113z version value: "". 20180309.9""
2018-03-09t08:35:22.0131140z Previous build Number: ""20180309.8""
2018-03-09T08:35:22.6151082Z Downloading Project ""Drop"" ...
2018-03-09t08:35:33.8640326z Progress Update: 786426 bytes Received ...
2018-03-09t08:35:45.0289523z Progress Update: 1572858 bytes Received ...
2018-03-09t08:35:50.9359148z has completed the download Project ""Drop"".
2018-03-09t08:36:23.1906931z Progress Update: 2146297 bytes Received ...
2018-03-09t08:36:23.2056934z Previous build location: ""C:VSTSAgentWorktmpdrop""
2018-03-09T08:36:23.2056934Z is searching for changes to the application type ' Jobapptype ' ...
2018-03-09t08:36:23.3666896z is searching for changes to the service ""statelessdenormalizerservicepkg"" ...
2018-03-09T08:36:23.4136911Z is searching for a change in package ' Code ' ...
2018-03-09T08:36:43.2015585Z is searching for package ""Config"" for changes ...
2018-03-09T08:36:43.5135588Z is searching for changes to the service ""statelesscommandservicepkg"" ...
2018-03-09t08:36:43.5205567z is searching for a change in package ' Code ' ...
# **2018-03-09t08:36:46.9865323z changed the file ""Labor.job.commandhandler.dll"".**
2018-03-09t08:37:03.1944208z updates the package ""Statelesscommandservicepkgcode"" from version ""1.0.0.20180309.8"" to ""1.0.0.20180309.9"".
2018-03-09T08:37:03.2044209Z is searching for package ""Config"" for changes ...
2018-03-09T08:37:03.3584199Z has changed the service manifest.
2018-03-09t08:37:03.3594197z updates the service ""statelesscommandservicepkg"" from version ""1.0.0.20180309.8"" to ""1.0.0.20180309.9"".
2018-03-09T08:37:03.3944184Z has changed the application manifest. 2018-03-09t08:37:03.3954176z updates the application type ""Jobapptype"" from version ""1.0.0.20180309.8"" to ""1.0.0.20180309.9"".


",,ReubenBond,,
4178,Can I use Grain like this?,"![image](https://user-images.githubusercontent.com/28291464/37198769-5a20d380-23ba-11e8-88e9-557e8e4a09fd.png)
![image](https://user-images.githubusercontent.com/28291464/37198881-bb6d189c-23ba-11e8-86fe-5f0573c13d8d.png)



Don't know if the above example is not allowed or have other problems?","Can I use Grain like this? ![image](https://user-images.githubusercontent.com/28291464/37198769-5a20d380-23ba-11e8-88e9-557e8e4a09fd.png)
![image](https://user-images.githubusercontent.com/28291464/37198881-bb6d189c-23ba-11e8-86fe-5f0573c13d8d.png)



Don't know if the above example is not allowed or have other problems?",,ReubenBond,,
4174,When Silo shutdown Grain deactivation is happening too late in the lifecycle,Silo will accept new activation in the  state (like storage providers...),"When Silo shutdown, Grain deactivation is happening too late in the lifecycle Silo will accept new activation in the  state (like storage providers...)",,benjaminpetit,,
4170,protobuf-net serializer,Hey considering using [protobuf-net](https://github.com/mgravell/protobuf-net) since it's so easy to use as opposed to the code-generation approach (imo). Thought this might be a nice addition here.,protobuf-net serializer Hey considering using [protobuf-net](https://github.com/mgravell/protobuf-net) since it's so easy to use as opposed to the code-generation approach (imo). Thought this might be a nice addition here.,,ReubenBond,,
4169,"Revert ""Improved transparancy and timing of silo lifecycle. (#4116)""",This reverts commit 3a7b5710a2b2f7bc250e15ccb48a47dd8dcb57ec. It broke some functional tests.,"Revert ""Improved transparancy and timing of silo lifecycle. (#4116)"" This reverts commit 3a7b5710a2b2f7bc250e15ccb48a47dd8dcb57ec. It broke some functional tests.",,benjaminpetit,,
4168,RequestContext not available in next operation,"We have a Grain that uses the RequestContext to pass along the user information. When we use the same Grain instance twice in our calling code the second call no longer has access to the RequestContext which seems normal since it (the second operation) is completed on another thread. However it would seem to me that the RequestContext should be migrated to the new thread or am I completely missing the point?
Should every Grain instance be used only once? Likely refetching the instance would resolve the issue (not tested will try this out later).

Client:
RequestContext.Set(""User"" User.Id);
var grain = ClusterClient.GetGrain<OurGrain>();
grain.Operation1();
grain.Operation2();

OurGrain:
Operation1():
RequestContext.Get(""User"") => Fine

Operation2():
RequestContext.Get(""User"") => null","RequestContext not available in next operation We have a Grain that uses the RequestContext to pass along the user information. When we use the same Grain instance twice in our calling code the second call no longer has access to the RequestContext which seems normal since it (the second operation) is completed on another thread. However it would seem to me that the RequestContext should be migrated to the new thread or am I completely missing the point?
Should every Grain instance be used only once? Likely refetching the instance would resolve the issue (not tested will try this out later).

Client:
RequestContext.Set(""User"" User.Id);
var grain = ClusterClient.GetGrain<OurGrain>();
grain.Operation1();
grain.Operation2();

OurGrain:
Operation1():
RequestContext.Get(""User"") => Fine

Operation2():
RequestContext.Get(""User"") => null",question,sergeybykov,8/03/2018 22:06,12/03/2018 20:02
4167,Will the 2.0RC version of the cluster how to configure?,Will the 2.0RC version of the cluster how to configure?,Will the 2.0RC version of the cluster how to configure? Will the 2.0RC version of the cluster how to configure?,question,lfzm,8/03/2018 18:49,12/03/2018 12:25
4163,Client is not initialized. Current client state is Created.,"ServiceFabric RunAsync Finish : 
protected override async Task RunAsync(CancellationToken cancellationToken)
        {
            // Creat the client and connect to the cluster.
            GrainFactory.PayQuery = GrainFactory.CreateFromFabricClient(""fabric:/PayApp/StatelessQueryService"");

            await GrainFactory.PayQuery.ConnectAsync();

        }

","Client is not initialized. Current client state is Created. ServiceFabric RunAsync Finish : 
protected override async Task RunAsync(CancellationToken cancellationToken)
        {
            // Creat the client and connect to the cluster.
            GrainFactory.PayQuery = GrainFactory.CreateFromFabricClient(""fabric:/PayApp/StatelessQueryService"");

            await GrainFactory.PayQuery.ConnectAsync();

        }

",,ReubenBond,,
4162,Fix legacy configuration,Fix implicit overriding of cluster ID in legacy membership configuration.,Fix legacy configuration Fix implicit overriding of cluster ID in legacy membership configuration.,,ReubenBond,,
4159,Throw on Build if ClusterId is not set on silo/client,,Throw on Build if ClusterId is not set on silo/client ,,ReubenBond,,
4158,Dns.GetHostAddressesAsync failure preventing Silo start,I'm getting the following stack trace when attempting to start a silo. I believe the cause is the default value for ,Dns.GetHostAddressesAsync failure preventing Silo start I'm getting the following stack trace when attempting to start a silo. I believe the cause is the default value for ,,benjaminpetit,,
4157,Lifecycle participant - is it working correctly?,This is a lifecycle participant intended to run ,Lifecycle participant - is it working correctly? This is a lifecycle participant intended to run ,,benjaminpetit,,
4155,Improve how grain services are registered,"Remove service ID as a configurable argument as 0 is currently hardcoded.
Add a silo builder extension method for registering grain services.
Update and extend tests to cover both the legacy way and the new way of handling of grain services.","Improve how grain services are registered Remove service ID as a configurable argument as 0 is currently hardcoded.
Add a silo builder extension method for registering grain services.
Update and extend tests to cover both the legacy way and the new way of handling of grain services.",,xiazen,,
4154,Some 2.0 samples are in 1.x directory,"I foudn this samples located in wrong directory:
https://github.com/dotnet/orleans/tree/master/Samples/1.x/FSharp.NetCore
https://github.com/dotnet/orleans/tree/master/Samples/1.x/Orleans-Docker
https://github.com/dotnet/orleans/tree/master/Samples/1.x/Docker-Simple","Some 2.0 samples are in 1.x directory I foudn this samples located in wrong directory:
https://github.com/dotnet/orleans/tree/master/Samples/1.x/FSharp.NetCore
https://github.com/dotnet/orleans/tree/master/Samples/1.x/Orleans-Docker
https://github.com/dotnet/orleans/tree/master/Samples/1.x/Docker-Simple",Hacktoberfest,sergeybykov,7/03/2018 21:57,
4153,Documentation: Garbage collection in dotnet core app,"Consider including something like this in the article about garbage collection

A dotnet core app will give this warning at startup: 
","Documentation: Garbage collection in dotnet core app Consider including something like this in the article about garbage collection

A dotnet core app will give this warning at startup: 
",P3,JillHeaden,,
4151,Interesting shutdown behaviour,"Repo to reproduce observations
https://github.com/bboyle1234/OrleansSiloShutdownIssue

# OrleansSiloShutdownIssue

An interesting investigation of console app shutdown behaviour. Now that I've come this far with the experiment it looks like it may have nothing to do with Orleans itself. 

If the 
","Interesting shutdown behaviour Repo to reproduce observations
https://github.com/bboyle1234/OrleansSiloShutdownIssue

# OrleansSiloShutdownIssue

An interesting investigation of console app shutdown behaviour. Now that I've come this far with the experiment it looks like it may have nothing to do with Orleans itself. 

If the 
",documentation,benjaminpetit,7/03/2018 16:40,
4150,Silo hang while shutdown,"Since 2.0 beta shutdown isn't being properly handled. It never call grain services stream providers storage Shutdown()/Close() methods.

While trying to debug the issue several of those NRE happens and the silo hang:



If I enable Orleans debug I can see it breaks on this exception:

![image](https://user-images.githubusercontent.com/4714040/37073886-50d12e06-21a8-11e8-8b33-86fd12c9bb80.png)

And this one:

![image](https://user-images.githubusercontent.com/4714040/37073897-62fbdf4a-21a8-11e8-9c38-07908e5ecbce.png)

After that the silo hangs in a state that it never shutdown but is not active either as new activations nor stream messages are being processed. Funny enough the dump of statistics and Activation Collection is printed on the console as if it were running.
","Silo hang while shutdown Since 2.0 beta shutdown isn't being properly handled. It never call grain services stream providers storage Shutdown()/Close() methods.

While trying to debug the issue several of those NRE happens and the silo hang:



If I enable Orleans debug I can see it breaks on this exception:

![image](https://user-images.githubusercontent.com/4714040/37073886-50d12e06-21a8-11e8-8b33-86fd12c9bb80.png)

And this one:

![image](https://user-images.githubusercontent.com/4714040/37073897-62fbdf4a-21a8-11e8-9c38-07908e5ecbce.png)

After that the silo hangs in a state that it never shutdown but is not active either as new activations nor stream messages are being processed. Funny enough the dump of statistics and Activation Collection is printed on the console as if it were running.
",,benjaminpetit,,
4149,Silos start running timer,"What to do when the silo starts running the timer，Not through the client call

 public class Test: Orleans.Grain
    {
        public void TestTime()
        {
            Console.WriteLine(""get.."");
            TimeSpan t1 = TimeSpan.FromSeconds(10);
            base.RegisterTimer(OnClientRefreshTimer null t1 - TimeSpan.FromSeconds(2) t1);
        }

        private async Task OnClientRefreshTimer(object data)
        {
            Console.WriteLine(""write"");
        }
    }","Silos start running timer What to do when the silo starts running the timer，Not through the client call

 public class Test: Orleans.Grain
    {
        public void TestTime()
        {
            Console.WriteLine(""get.."");
            TimeSpan t1 = TimeSpan.FromSeconds(10);
            base.RegisterTimer(OnClientRefreshTimer null t1 - TimeSpan.FromSeconds(2) t1);
        }

        private async Task OnClientRefreshTimer(object data)
        {
            Console.WriteLine(""write"");
        }
    }",question,sergeybykov,7/03/2018 14:11,12/03/2018 14:13
4145,Rename MembershipOptions to ClusteringOptions,Rename .,Rename MembershipOptions to ClusteringOptions Rename .,,xiazen,,
4144,Silo Host Could not load file or assembly for 3rd party libraries used in Grain implementation project,"Silo Host Could not load file or assembly for 3rd party libraries used in Grain implementation project.
For ex. I'm using NuGet package -> Microsoft.Store.PartnerCenter Version=1.7.0.0 in Grain implementation project (targets .net framework 4.7.1) and the SiloHost project (targets .netstandard2.0) has -> Microsoft.Store.PartnerCenter.dll in bin folder(SiloHostProject\bin\Debug\netcoreapp2.0) but it throws an exception -> Could not load file or assembly.","Silo Host Could not load file or assembly for 3rd party libraries used in Grain implementation project Silo Host Could not load file or assembly for 3rd party libraries used in Grain implementation project.
For ex. I'm using NuGet package -> Microsoft.Store.PartnerCenter Version=1.7.0.0 in Grain implementation project (targets .net framework 4.7.1) and the SiloHost project (targets .netstandard2.0) has -> Microsoft.Store.PartnerCenter.dll in bin folder(SiloHostProject\bin\Debug\netcoreapp2.0) but it throws an exception -> Could not load file or assembly.",,ReubenBond,,
4137,Interceptor use problems？？？,"Use interceptors to do permission verification return insufficient rights message the client can not receive the message because the message can not be converted is there any solution?

![image](https://user-images.githubusercontent.com/28291464/37013715-7e9d3950-2136-11e8-8aab-38216d202968.png)
","Interceptor use problems？？？ Use interceptors to do permission verification return insufficient rights message the client can not receive the message because the message can not be converted is there any solution?

![image](https://user-images.githubusercontent.com/28291464/37013715-7e9d3950-2136-11e8-8aab-38216d202968.png)
",question,ReubenBond,,
4136,Normalize cluster config & simplify binding IConfiguration to TOptions,"Fixes #4086.

Unsure if we should also add some sugar methods like  if it's not otherwise set.","Normalize cluster config & simplify binding IConfiguration to TOptions Fixes #4086.

Unsure if we should also add some sugar methods like  if it's not otherwise set.",,xiazen,,
4130,In ActivationCountPlacementDirector place locally if the cache is not ready,"It's possible that when using  strategy the silo will try to choose a place for an activation before the cache used in the director is populated.

The proposed fix is just to place locally until the cache is ready.
","In ActivationCountPlacementDirector, place locally if the cache is not ready It's possible that when using  strategy the silo will try to choose a place for an activation before the cache used in the director is populated.

The proposed fix is just to place locally until the cache is ready.
",,sergeybykov,,
4129,Bug: PerfCounterEnvironmentStatistics never reports CpuUsage,"I think the registration is wrong because OnStart is never called. 

cpuCounterPF != null but cpuUsageTimer == null","Bug: PerfCounterEnvironmentStatistics never reports CpuUsage I think the registration is wrong because OnStart is never called. 

cpuCounterPF != null but cpuUsageTimer == null",,benjaminpetit,,
4128,How to let timers survive a (graceful) silo shutdown,"I have a Game grain which manages the logic for a turn-based game between two players. Inside this grain a timer is used to measure the time for each turn and forcefully end a player's turn if they fail to play in a timely manner.

If this grain gets deactivated (even gracefully) the timer will cease to exist. The creation of a new activation of this grain will depend on it receiving external calls which means it may not happen until one of the players makes a move which defeats the purpose of the timer. I can save the game's state and let it continue off from where the old silo was shut down but I currently have no way of bringing the timer back online.

One way is to constantly poll the grain from another grain. This fails because the other grain is also subject to the same limitations as the original (namely it may get deactivated with no way to restore its timers).

Another way is to have a second grain (let's call it pinger). One could have the game ask the pinger (on deactivation) to call it back after a second or so. This is likely to succeed most of the time but if the pinger happens to be on the same silo and get deactivated after the game it will still fail.

Yet another may be to have the game call itself. However I'm not entirely sure this is a stable solution as I don't know how the silos handle the case of a grain receiving a call while it's already deactivating but not yet fully deactivated. If the grain is removed from the global directory *before* the OnDeactivateAsync call this may succeed. I just thought of this while writing this question so I have yet to see if this actually works.

A reminder is not appropriate in this scenario because the minimum interval for a reminder is 60 seconds IIRC. An entire turn takes about half a minute.

Any other ideas on how to handle this (and other similar cases)?","How to let timers survive a (graceful) silo shutdown I have a Game grain which manages the logic for a turn-based game between two players. Inside this grain a timer is used to measure the time for each turn and forcefully end a player's turn if they fail to play in a timely manner.

If this grain gets deactivated (even gracefully) the timer will cease to exist. The creation of a new activation of this grain will depend on it receiving external calls which means it may not happen until one of the players makes a move which defeats the purpose of the timer. I can save the game's state and let it continue off from where the old silo was shut down but I currently have no way of bringing the timer back online.

One way is to constantly poll the grain from another grain. This fails because the other grain is also subject to the same limitations as the original (namely it may get deactivated with no way to restore its timers).

Another way is to have a second grain (let's call it pinger). One could have the game ask the pinger (on deactivation) to call it back after a second or so. This is likely to succeed most of the time but if the pinger happens to be on the same silo and get deactivated after the game it will still fail.

Yet another may be to have the game call itself. However I'm not entirely sure this is a stable solution as I don't know how the silos handle the case of a grain receiving a call while it's already deactivating but not yet fully deactivated. If the grain is removed from the global directory *before* the OnDeactivateAsync call this may succeed. I just thought of this while writing this question so I have yet to see if this actually works.

A reminder is not appropriate in this scenario because the minimum interval for a reminder is 60 seconds IIRC. An entire turn takes about half a minute.

Any other ideas on how to handle this (and other similar cases)?",question,sergeybykov,5/03/2018 20:53,10/03/2018 9:08
4125,Docker Deployment Client Connection Failed,"I Follow the Sample:

https://github.com/dotnet/orleans/tree/master/Samples/2.0/docker-aspnet-core

Silo has been successful but the client connection failed

![image](https://user-images.githubusercontent.com/7261408/36946992-d457a3b2-2000-11e8-9fb9-99eabc37296d.png)


System.AggregateException
  HResult=0x80131500
  Message=One or more errors occurred. (The target silo became unavailable for message: Request *cli/193b298f@0e75cbb3->S172.22.0.3:30000:257871284*stg/17/00000011@S00000011 #2: . Target History is: <S172.22.0.3:30000:257871284:*stg/17/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help.)
  Source=System.Private.CoreLib
  StackTrace:
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout CancellationToken cancellationToken)
   at System.Threading.Tasks.Task.Wait()
   at Client.Program.Main(String[] args) in D:\jinbiao\OrleansSamples\OrleansDocker\Client\Program.cs:line 34

内部异常 1:
SiloUnavailableException: The target silo became unavailable for message: Request *cli/193b298f@0e75cbb3->S172.22.0.3:30000:257871284*stg/17/00000011@S00000011 #2: . Target History is: <S172.22.0.3:30000:257871284:*stg/17/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help.
","Docker Deployment Client Connection Failed I Follow the Sample:

https://github.com/dotnet/orleans/tree/master/Samples/2.0/docker-aspnet-core

Silo has been successful but the client connection failed

![image](https://user-images.githubusercontent.com/7261408/36946992-d457a3b2-2000-11e8-9fb9-99eabc37296d.png)


System.AggregateException
  HResult=0x80131500
  Message=One or more errors occurred. (The target silo became unavailable for message: Request *cli/193b298f@0e75cbb3->S172.22.0.3:30000:257871284*stg/17/00000011@S00000011 #2: . Target History is: <S172.22.0.3:30000:257871284:*stg/17/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help.)
  Source=System.Private.CoreLib
  StackTrace:
   at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
   at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout CancellationToken cancellationToken)
   at System.Threading.Tasks.Task.Wait()
   at Client.Program.Main(String[] args) in D:\jinbiao\OrleansSamples\OrleansDocker\Client\Program.cs:line 34

内部异常 1:
SiloUnavailableException: The target silo became unavailable for message: Request *cli/193b298f@0e75cbb3->S172.22.0.3:30000:257871284*stg/17/00000011@S00000011 #2: . Target History is: <S172.22.0.3:30000:257871284:*stg/17/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help.
",question,benjaminpetit,,
4123,Change the type of the Gateways property in StaticGatewayListProviderOptions in rc1,"The type of Gateways in StaticGatewayListProviderOptions is IList<Uri>.
The absence of the AddRange method in IList makes adding multiple gateway endpoints in ClientBuilder unnecessarily cumbersome.

Changing it to a List resolves this issue.

","Change the type of the Gateways property in StaticGatewayListProviderOptions in rc1 The type of Gateways in StaticGatewayListProviderOptions is IList<Uri>.
The absence of the AddRange method in IList makes adding multiple gateway endpoints in ClientBuilder unnecessarily cumbersome.

Changing it to a List resolves this issue.

",,benjaminpetit,,
4120,Register InMemoryRemindersTable,There is no registration for this class. Therefore reminders do not work out of the box.,Register InMemoryRemindersTable There is no registration for this class. Therefore reminders do not work out of the box.,,ReubenBond,,
4119,Is Orleans a microservice framework?,"I'm new to .
could some one tell me and give some brief explanations?","Is Orleans a microservice framework? I'm new to .
could some one tell me and give some brief explanations?",question,sergeybykov,4/03/2018 3:47,22/06/2018 7:52
4118,Code Review of Orlean.Providers.MongoDB,"Hi

We'd appreciate a code review of the rc1 branch ( https://github.com/OrleansContrib/Orleans.Providers.MongoDB/tree/rc1)
There is a test application as well as unit tests.

Packages can be found at https://www.nuget.org/packages/Orleans.Providers.MongoDB

@SebastianStehle has done a significant refactor of the providers(https://github.com/OrleansContrib/Orleans.Providers.MongoDB/issues/26).  

Would it be possible to add this to the Orleans Providers? It feels like MongoDb would be ideal for an opensource Linux enviroment.","Code Review of Orlean.Providers.MongoDB Hi

We'd appreciate a code review of the rc1 branch ( https://github.com/OrleansContrib/Orleans.Providers.MongoDB/tree/rc1)
There is a test application as well as unit tests.

Packages can be found at https://www.nuget.org/packages/Orleans.Providers.MongoDB

@SebastianStehle has done a significant refactor of the providers(https://github.com/OrleansContrib/Orleans.Providers.MongoDB/issues/26).  

Would it be possible to add this to the Orleans Providers? It feels like MongoDb would be ideal for an opensource Linux enviroment.",,ReubenBond,,
4116,Improved transparancy and timing of silo lifecycle.,"- Subscrivers are now named.
- Silo lifecycle now reports stages prior to start.

**_Example stage reporting:_**

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage -2147483648: Orleans.Runtime.SiloOptionsLogger	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 2000: Orleans.Runtime.InsideRuntimeClient Orleans.Runtime.Silo	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 4000: Orleans.Runtime.Silo	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 8000: Orleans.Runtime.Silo	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 10000: Orleans.Runtime.Versions.GrainVersionStore Orleans.Storage.AzureTableGrainStorage-AzureStore Orleans.Storage.AzureTableGrainStorage-PubSubStore Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 20000: Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2	

**_Example timing information:_**

...100452	Orleans.Runtime.SiloLifecycleSubject]	Lifecycle observer Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2 started in stage 10000 which took 21 Milliseconds.	

...100452	Orleans.Runtime.SiloLifecycleSubject]	Lifecycle observer Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2 started in stage 20000 which took 65 Milliseconds.	

...100452	Orleans.Runtime.SiloLifecycleSubject]	Lifecycle observer Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2 stopped in stage 20000 which took 20 Milliseconds.	

...100452	Orleans.Runtime.SiloLifecycleSubject]	Lifecycle observer Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2 stopped in stage 10000 which took 0 Milliseconds.

Stream provider started in two stages because it initializes in stage 10000 and starts reading events running in stage 20000.","Improved transparancy and timing of silo lifecycle. - Subscrivers are now named.
- Silo lifecycle now reports stages prior to start.

**_Example stage reporting:_**

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage -2147483648: Orleans.Runtime.SiloOptionsLogger	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 2000: Orleans.Runtime.InsideRuntimeClient Orleans.Runtime.Silo	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 4000: Orleans.Runtime.Silo	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 8000: Orleans.Runtime.Silo	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 10000: Orleans.Runtime.Versions.GrainVersionStore Orleans.Storage.AzureTableGrainStorage-AzureStore Orleans.Storage.AzureTableGrainStorage-PubSubStore Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2	

...100453	Orleans.Runtime.SiloLifecycleSubject]	Stage 20000: Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2	

**_Example timing information:_**

...100452	Orleans.Runtime.SiloLifecycleSubject]	Lifecycle observer Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2 started in stage 10000 which took 21 Milliseconds.	

...100452	Orleans.Runtime.SiloLifecycleSubject]	Lifecycle observer Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2 started in stage 20000 which took 65 Milliseconds.	

...100452	Orleans.Runtime.SiloLifecycleSubject]	Lifecycle observer Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2 stopped in stage 20000 which took 20 Milliseconds.	

...100452	Orleans.Runtime.SiloLifecycleSubject]	Lifecycle observer Orleans.Providers.Streams.Common.PersistentStreamProvider-AzureQueueProvider2 stopped in stage 10000 which took 0 Milliseconds.

Stream provider started in two stages because it initializes in stage 10000 and starts reading events running in stage 20000.",,benjaminpetit,,
4115,EndpointOptions enhancement concerns/suggestions,"This issue is more about ""how to"" and not an actual bug.

[ property.","EndpointOptions enhancement concerns/suggestions This issue is more about ""how to"" and not an actual bug.

[ property.",,benjaminpetit,,
4114,does orleans2.0 rc1 support client discovery?,at client side the hello demo use ,does orleans2.0 rc1 support client discovery? at client side the hello demo use ,question,sergeybykov,3/03/2018 2:56,3/03/2018 17:03
4113,[Question] Silo shutdown and OnDeactivateAsync,"I've been digging through the docs and the issues but I didn't find an answer to the following question:

_When a silo is shut down what happens inside a grain's_  which already got deactivated - will an exception be thrown in this case? Or will that referenced grain become reactivated? If so how will the reactivated grain eventually get deactivated? Is the silo trying to drain the silo from grains by retrying a deactivation again and again (until a timeout)?","[Question] Silo shutdown and OnDeactivateAsync I've been digging through the docs and the issues but I didn't find an answer to the following question:

_When a silo is shut down what happens inside a grain's_  which already got deactivated - will an exception be thrown in this case? Or will that referenced grain become reactivated? If so how will the reactivated grain eventually get deactivated? Is the silo trying to drain the silo from grains by retrying a deactivation again and again (until a timeout)?",question,sergeybykov,3/03/2018 2:17,13/03/2018 20:59
4112,SystemTarget not active on this silo,"In 2.0 rc1 grain services are not working as it was before it.


Redacted the sample for simplicity.

What is wrong there?  I would appreciate anyone jump in as this is a blocker for me.","SystemTarget not active on this silo In 2.0 rc1 grain services are not working as it was before it.


Redacted the sample for simplicity.

What is wrong there?  I would appreciate anyone jump in as this is a blocker for me.",,sergeybykov,,
4110,Warning in logs: Ignoring unhandled exception during PubSub.UnregisterProducer,"I'm running Orleans 1.5.3 and currently playing around with Orleans streams especially with the SMSProvider.

I wrote a grain called  the next morning in order to find out whether the change notification is still working regardless of the exception everything worked okay. Can I safely ignore the exception?","Warning in logs: Ignoring unhandled exception during PubSub.UnregisterProducer I'm running Orleans 1.5.3 and currently playing around with Orleans streams especially with the SMSProvider.

I wrote a grain called  the next morning in order to find out whether the change notification is still working regardless of the exception everything worked okay. Can I safely ignore the exception?",,jason-bragg,,
4109,2.0 rc1 ServiceFabric clustering is dependent on Legacy Configuration,"The service fabric clustering components are still dependent on the Legacy GlobalConfiguration object (and legacy nuget package).  

Is ServiceFabric clustering considered to be legacy as well? Since I saw some threads indicating to use another membership provider (like azure table) in SF.

","2.0 rc1 ServiceFabric clustering is dependent on Legacy Configuration The service fabric clustering components are still dependent on the Legacy GlobalConfiguration object (and legacy nuget package).  

Is ServiceFabric clustering considered to be legacy as well? Since I saw some threads indicating to use another membership provider (like azure table) in SF.

",,ReubenBond,,
4107,[question]Is there any guide for orleans upgrade?,"In the production environment applications which have many nodes will be upgraded node by node.

Test users may be migrated to the new released node. And then 10% user and then 30%... finally 100%.
New silos have been added to the cluster with no active grain until test users are manually migrated to the new silo.

New software is released in a controllable reversible way.  This is very important for large applications.

Is there any guide for upgrade orleans for example if the application has to be upgraded from orleans 1.5 to 2.0 without downtime  in the controllable reversible way?","[question]Is there any guide for orleans upgrade? In the production environment applications which have many nodes will be upgraded node by node.

Test users may be migrated to the new released node. And then 10% user and then 30%... finally 100%.
New silos have been added to the cluster with no active grain until test users are manually migrated to the new silo.

New software is released in a controllable reversible way.  This is very important for large applications.

Is there any guide for upgrade orleans for example if the application has to be upgraded from orleans 1.5 to 2.0 without downtime  in the controllable reversible way?",P2,JillHeaden,,
4099,Using AzureTableStorage for grain state in 2.0.0-rc1 results in exception,"I'm not sure if I've misconfigured the provider after upgrading or what but I'm getting the following exception:


","Using AzureTableStorage for grain state in 2.0.0-rc1 results in exception I'm not sure if I've misconfigured the provider after upgrading or what but I'm getting the following exception:


",,sergeybykov,,
4098,Custom placement strategy usability improvements,"In 2.0.0-rc1 custom placement strategy registration isn't as obvious as it should be:


The director registration should be obvious and discoverable. The strategy registration should not be needed.

cc @yzhao174","Custom placement strategy usability improvements In 2.0.0-rc1 custom placement strategy registration isn't as obvious as it should be:


The director registration should be obvious and discoverable. The strategy registration should not be needed.

cc @yzhao174",,ReubenBond,,
4097,Improve configuration validators for ADO.NET configuration,* Consolidate naming of ADO.NET invariant option: now it's  parameter on reminder config extension method which takes a connection string.,Improve configuration validators for ADO.NET configuration * Consolidate naming of ADO.NET invariant option: now it's  parameter on reminder config extension method which takes a connection string.,,xiazen,,
4096,TypeMap are not dynamically refreshed on clients,"Related to #4028 with in-place upgrades.

The issue is that if you try to update both silo and client at the same time new clients are more likely to start before the new silos so they get an outdated when needed (but since clients are connected to multiple silos but only one of them should send such notifications?)

","TypeMap are not dynamically refreshed on clients Related to #4028 with in-place upgrades.

The issue is that if you try to update both silo and client at the same time new clients are more likely to start before the new silos so they get an outdated when needed (but since clients are connected to multiple silos but only one of them should send such notifications?)

",,benjaminpetit,,
4095,Unclear dependency of Reminders to Membership on ADO.net providers,"If I have something like this:

.","Unclear dependency of Reminders to Membership on ADO.net providers If I have something like this:

.",,benjaminpetit,,
4093,Move ConfigureEndpoints to Orleans.Hosting,,Move ConfigureEndpoints to Orleans.Hosting ,,benjaminpetit,,
4086,SiloBuilder extensions/options usability issues,"Let's track here all change that we should do in SiloBuilder extensions methods and options before release.

- [x]  on the silo","SiloBuilder extensions/options usability issues Let's track here all change that we should do in SiloBuilder extensions methods and options before release.

- [x]  on the silo",,ReubenBond,,
4084,Failure loading MemoryStorageGrain,"On latest RC calling  to the App parts internally.

Logs attached.

Thanks
[logs-from-kubesilo-in-kubesilo-57bf49b4b7-zzs9f (1).txt](https://github.com/dotnet/orleans/files/1764074/logs-from-kubesilo-in-kubesilo-57bf49b4b7-zzs9f.1.txt)
","Failure loading MemoryStorageGrain On latest RC calling  to the App parts internally.

Logs attached.

Thanks
[logs-from-kubesilo-in-kubesilo-57bf49b4b7-zzs9f (1).txt](https://github.com/dotnet/orleans/files/1764074/logs-from-kubesilo-in-kubesilo-57bf49b4b7-zzs9f.1.txt)
",,ReubenBond,,
4082,Can I connect Orleans server with golang，nodejs...  another language ？,"please ：

Can I connect Orleans server with golang，nodejs...  another language ？","Can I connect Orleans server with golang，nodejs...  another language ？ please ：

Can I connect Orleans server with golang，nodejs...  another language ？",question,sergeybykov,27/02/2018 18:35,3/04/2018 7:11
4080,Improve persistent stream provider configuration pattern ,"Persistent stream providers are very complex it has many components which user can customize. Now the configuration of those components has scattered in three places one is through inheritance another one is through giant god  stream provider options which is intended to configure everything third one is through the component's own option. All three of them has pain points listed below. 

- Use inheritance  instead of DI to configure some core component such as . This make configuring harder since if user want to configure those they need to actually have a reasonable understanding of how Orleans streaming is wired up internally to know which class to inherit and when to set those factories. Although this is true before so one may argue it might be fine now. But the fact is after provider been integrated with lifecycle its configuration process has been changed entirely. For users who configured those factory through inheritance they cannot use our extension methods to configure their custom stream provider and the configuration their are familiar with is gone and they need to get used to a new one which is almost as bad as before. So I think we should kill this pain point because we provided a new configuration method it will suck if it is as bad as before. 

- The disadvantage of god stream provider options is its poor flexibility extensibility and complexity. I will skipped listing its cons here since I think there's a consensus on Why god configuration is bad. 

- Configure one component through its own option is the way to go forward. The problem with it right now is poor discoverability especially when the configuration is in three places. For example to configure a queue balancer now you need to first set the queue balancer type right in the stream provider options then you need to configure the specific type of queue balancer options through DI which there's no extra infrastructure to guide you on how to do that. 

I would argue some of those need to be improved in 2.0 scope because we create a fuss to provide a new way of configuration it will be bad if this new configuration method is as bad as before and user need to learn about this new bad way and adapt to it instead of happily adapt a better way. 

General direction is to uniform these three ways of configuration and develop one consistent and better way to configure stream providers which also has good discoverability extensibility and flexibility.  
","Improve persistent stream provider configuration pattern  Persistent stream providers are very complex it has many components which user can customize. Now the configuration of those components has scattered in three places one is through inheritance another one is through giant god  stream provider options which is intended to configure everything third one is through the component's own option. All three of them has pain points listed below. 

- Use inheritance  instead of DI to configure some core component such as . This make configuring harder since if user want to configure those they need to actually have a reasonable understanding of how Orleans streaming is wired up internally to know which class to inherit and when to set those factories. Although this is true before so one may argue it might be fine now. But the fact is after provider been integrated with lifecycle its configuration process has been changed entirely. For users who configured those factory through inheritance they cannot use our extension methods to configure their custom stream provider and the configuration their are familiar with is gone and they need to get used to a new one which is almost as bad as before. So I think we should kill this pain point because we provided a new configuration method it will suck if it is as bad as before. 

- The disadvantage of god stream provider options is its poor flexibility extensibility and complexity. I will skipped listing its cons here since I think there's a consensus on Why god configuration is bad. 

- Configure one component through its own option is the way to go forward. The problem with it right now is poor discoverability especially when the configuration is in three places. For example to configure a queue balancer now you need to first set the queue balancer type right in the stream provider options then you need to configure the specific type of queue balancer options through DI which there's no extra infrastructure to guide you on how to do that. 

I would argue some of those need to be improved in 2.0 scope because we create a fuss to provide a new way of configuration it will be bad if this new configuration method is as bad as before and user need to learn about this new bad way and adapt to it instead of happily adapt a better way. 

General direction is to uniform these three ways of configuration and develop one consistent and better way to configure stream providers which also has good discoverability extensibility and flexibility.  
",,xiazen,,
4077,Start GrainVersionStore later at runtime,Related issue: #4075 ,Start GrainVersionStore later at runtime Related issue: #4075 ,,jason-bragg,,
4075,IVersionStore should not be used before the silo is ready,Right now it is used in ,IVersionStore should not be used before the silo is ready Right now it is used in ,,benjaminpetit,,
4073,Fix test configuration bug in AzureQueue tests introduced in #4067,"Need a memory store provider named ""MemoryStore"" instead of the default one.","Fix test configuration bug in AzureQueue tests introduced in #4067 Need a memory store provider named ""MemoryStore"" instead of the default one.",,ReubenBond,,
4069,End-To-End Identity,"Hello

are there any plans to integrate ""end-to-end (windows)identity"" feature into Orleans?

By this I mean ""running the grain method in the context of a windows-user"" - something which you get for free for most other MS-Products (WCF / ASMX services etc).

This is mandatory for our use case and I have been struggling implementing this (I kinda have it working now using SSPI Api....but right now the solution is a little messy and implementing that in all places where it is needed will be a lot of work).

So - are there any plans on integrating this into Orleans?","End-To-End Identity Hello

are there any plans to integrate ""end-to-end (windows)identity"" feature into Orleans?

By this I mean ""running the grain method in the context of a windows-user"" - something which you get for free for most other MS-Products (WCF / ASMX services etc).

This is mandatory for our use case and I have been struggling implementing this (I kinda have it working now using SSPI Api....but right now the solution is a little messy and implementing that in all places where it is needed will be a lot of work).

So - are there any plans on integrating this into Orleans?",question,sergeybykov,22/02/2018 21:54,3/04/2018 7:11
4066,Port AWS libraries to use options/lifecycle.,"This updates the AWS libraries use options and lifecycle rather than the legacy provider model.
Work was done by @galvesribeiro I'm just shepherding it through the process.","Port AWS libraries to use options/lifecycle. This updates the AWS libraries use options and lifecycle rather than the legacy provider model.
Work was done by @galvesribeiro I'm just shepherding it through the process.",,ReubenBond,,
4065,Duplicate cluster ID on the client.,"ClusterId is defined in the SiloOptions which is available on the client (per my understanding) and in the ClusterClientOptions.  This ambiguity introduces a number of maintenance and configuration questions. 

Client and silo should each have only one source of cluster information if it's the same or different option is less important than each having only a single source.","Duplicate cluster ID on the client. ClusterId is defined in the SiloOptions which is available on the client (per my understanding) and in the ClusterClientOptions.  This ambiguity introduces a number of maintenance and configuration questions. 

Client and silo should each have only one source of cluster information if it's the same or different option is less important than each having only a single source.",,benjaminpetit,,
4063,Silo lifecycle performance fix,"Attempt to address performance issues related to silo lifecycle.
- Silo lifecycle actions are not run in lifecycle context.","Silo lifecycle performance fix Attempt to address performance issues related to silo lifecycle.
- Silo lifecycle actions are not run in lifecycle context.",,sergeybykov,,
4061,Update Samples and docs to show necessity of using ObserverSubscriptionManager.IsSubscribed(),Both the Orleans docs and several samples just call ObserverSubscriptionManager.Subscribe() without handling the OrleansException that is generated if the observer that is subbed/unsubbed is already subbed/unsubbed. That seems like an important failure state to handle especially since the current docs actually suggest re-subbing as a means of improving reliability of this feature.,Update Samples and docs to show necessity of using ObserverSubscriptionManager.IsSubscribed() Both the Orleans docs and several samples just call ObserverSubscriptionManager.Subscribe() without handling the OrleansException that is generated if the observer that is subbed/unsubbed is already subbed/unsubbed. That seems like an important failure state to handle especially since the current docs actually suggest re-subbing as a means of improving reliability of this feature.,documentation,sergeybykov,22/02/2018 3:52,21/04/2018 3:49
4060,Client unable to talk to Gateways,"We have an established product that uses Orleans.  It has been stably running for some time now but today out the blue some clients struggled to talk to the Silos.  Can anyone help me figure out why?

**Setup:**
- 8 machines
- Each machine runs one Silo and one Client
- The Client takes messages off a MSMQ and forwards it to the Cluster
- Using SQL membership
- This is our development system so no hardware or windows firewalls are on

**Observed behaviour**
- Communication issues happened at the same time
- Some clients work normally
- Some clients fail to talk to the cluster (log below)
- When a client fails to send data no data can be sent from that client at all (we allow up to messages sent to Orleans simultaneously)
- Clients failed within 30-60 minutes of each other
- The clients that fail fail on a ""known"" error.  I.e. an Orleans exception is thrown the client retries to send its data forever.

**Log**

","Client unable to talk to Gateways We have an established product that uses Orleans.  It has been stably running for some time now but today out the blue some clients struggled to talk to the Silos.  Can anyone help me figure out why?

**Setup:**
- 8 machines
- Each machine runs one Silo and one Client
- The Client takes messages off a MSMQ and forwards it to the Cluster
- Using SQL membership
- This is our development system so no hardware or windows firewalls are on

**Observed behaviour**
- Communication issues happened at the same time
- Some clients work normally
- Some clients fail to talk to the cluster (log below)
- When a client fails to send data no data can be sent from that client at all (we allow up to messages sent to Orleans simultaneously)
- Clients failed within 30-60 minutes of each other
- The clients that fail fail on a ""known"" error.  I.e. an Orleans exception is thrown the client retries to send its data forever.

**Log**

",,benjaminpetit,,
4056,DynamoDB transaction log,"Ported Azure transaction log to dynamodb.
Made a small api change to DynamoDBStorage in order to get continuation information from queries.","DynamoDB transaction log Ported Azure transaction log to dynamodb.
Made a small api change to DynamoDBStorage in order to get continuation information from queries.",,jason-bragg,,
4055,Fix various AzureStorage tests,Only config/initialization issues in functional tests,Fix various AzureStorage tests Only config/initialization issues in functional tests,,sergeybykov,,
4053,MemoryStorage - etag mismatch,"We have noticed we are getting a lot of etag mismatch issues and we couldn't figure out why as during dev they don't usually appear but in prod they do.

Today I had investigated a bit and finally I found out why its happening. This is how to do it:

- Use a MemoryStorage as persistence for a stateful grain
- Set 

Not entirely sure if its a bug or a misuse i think its a bit of both but either or ideally it can be prevented because it can lead to some quite hard to track issues.","MemoryStorage - etag mismatch We have noticed we are getting a lot of etag mismatch issues and we couldn't figure out why as during dev they don't usually appear but in prod they do.

Today I had investigated a bit and finally I found out why its happening. This is how to do it:

- Use a MemoryStorage as persistence for a stateful grain
- Set 

Not entirely sure if its a bug or a misuse i think its a bit of both but either or ideally it can be prevented because it can lead to some quite hard to track issues.",,benjaminpetit,,
4052,Cannot find generated GrainReference class,"Hi，in my test environment a silo and a client are started.
There are two grains in the silo: GrainA and GrainB.

When I try to get a GrainB reference in the CLIENT it works fine.

But when I try to get a GrainB reference in the GrainA's OnActivateAsync  an exception is thrown out:
System.InvalidOperationException: 'Cannot find generated GrainReference class for interface 'MyInterfaces.IInterfaceOrleans''

Orleans version: 2.0.0 beta3 from nuget.org

Any suggestion for further diagnosing?","Cannot find generated GrainReference class Hi，in my test environment a silo and a client are started.
There are two grains in the silo: GrainA and GrainB.

When I try to get a GrainB reference in the CLIENT it works fine.

But when I try to get a GrainB reference in the GrainA's OnActivateAsync  an exception is thrown out:
System.InvalidOperationException: 'Cannot find generated GrainReference class for interface 'MyInterfaces.IInterfaceOrleans''

Orleans version: 2.0.0 beta3 from nuget.org

Any suggestion for further diagnosing?",question,sergeybykov,18/02/2018 2:38,3/04/2018 7:09
4051,Removed more legacy dependencies.,"Removed from:
- Orleans.Cluster.AdoNet
- Orleans.Persistence.AdoNet
- Orleans.Clustering.DynomoDb
- Orleans.Persistence.AzureStorage
- Orleans.Clustering.Consul
- Orleans.Clustering.ZooKeeper","Removed more legacy dependencies. Removed from:
- Orleans.Cluster.AdoNet
- Orleans.Persistence.AdoNet
- Orleans.Clustering.DynomoDb
- Orleans.Persistence.AzureStorage
- Orleans.Clustering.Consul
- Orleans.Clustering.ZooKeeper",,benjaminpetit,,
4047,Execute lifecycle on OrleansTaskScheduler,,Execute lifecycle on OrleansTaskScheduler ,,jason-bragg,,
4044,Added optional listenerAddress parameter to ConfigureEndpoints(),"@benjaminpetit please review.

Instead of using this code:


","Added optional listenerAddress parameter to ConfigureEndpoints() @benjaminpetit please review.

Instead of using this code:


",,benjaminpetit,,
4043,[Question] With FastKillOnCancel removed whats the guidance on handling CTRL-C fast shutdown.,"With FastKillOnCancel removed and AppDomain wired for fast kill what is guidance on handling CTRL-C fast kill?

This way:



","[Question] With FastKillOnCancel removed whats the guidance on handling CTRL-C fast shutdown. With FastKillOnCancel removed and AppDomain wired for fast kill what is guidance on handling CTRL-C fast kill?

This way:



",documentation,sergeybykov,15/02/2018 18:40,
4042,Persistent stream provider to lifecycle,"Pushing this PR out to get eyes on it but it's not passing testing yet.  Still WIP.

Since persistent stream provider is the base for most of our steam providers we couldn't refactor these one at a time.

Following stream providers now use options and lifecycle.
* Azure Queue
* EventHub
* Sqs
* PubSub
* Memory
* Generator
* EventDataGenerator
* Various test providers

TBD:
Fix tests.
Move options to Orleans.Configuration namespace.
Replace DataConnectionStream with ConnectionString in options to conform to other options.
Possibly validators but would like to push that to separate PR given the size of this change.

NOTE:  Persistent stream providers and various adapters are complex and patterns can be improved now that we can inject dependencies but current patterns are best effort port.  Please note where further refactoring in the future is warranted.

Future Refactor:
* Data Adapters
* Inject checkpointing
* Inject generators (for generated streams)
* Inject failure handlers
* Possible adapter or provider builders
","Persistent stream provider to lifecycle Pushing this PR out to get eyes on it but it's not passing testing yet.  Still WIP.

Since persistent stream provider is the base for most of our steam providers we couldn't refactor these one at a time.

Following stream providers now use options and lifecycle.
* Azure Queue
* EventHub
* Sqs
* PubSub
* Memory
* Generator
* EventDataGenerator
* Various test providers

TBD:
Fix tests.
Move options to Orleans.Configuration namespace.
Replace DataConnectionStream with ConnectionString in options to conform to other options.
Possibly validators but would like to push that to separate PR given the size of this change.

NOTE:  Persistent stream providers and various adapters are complex and patterns can be improved now that we can inject dependencies but current patterns are best effort port.  Please note where further refactoring in the future is warranted.

Future Refactor:
* Data Adapters
* Inject checkpointing
* Inject generators (for generated streams)
* Inject failure handlers
* Possible adapter or provider builders
",,xiazen,,
4039,Using a generic method on a grain interface results in needed reference to Orleans.Core from interface project,"The generated code when a grain interface has a generic method results in a reference to GenericMethodInvoker which is in Orleans.Core. Following the sample projects the interface project only has references to Orleans.Core.Abstractions and code gen.

While it isn't hard to add the extra reference that may not be the desired fix. 

Looking into what GenericMethodInvoker depends on in core / what it is doing it doesn't really feel like it should be moved. Perhaps an IGenericMethodInvoker would make sense but I'm not sure where the implementation would get injected.","Using a generic method on a grain interface results in needed reference to Orleans.Core from interface project The generated code when a grain interface has a generic method results in a reference to GenericMethodInvoker which is in Orleans.Core. Following the sample projects the interface project only has references to Orleans.Core.Abstractions and code gen.

While it isn't hard to add the extra reference that may not be the desired fix. 

Looking into what GenericMethodInvoker depends on in core / what it is doing it doesn't really feel like it should be moved. Perhaps an IGenericMethodInvoker would make sense but I'm not sure where the implementation would get injected.",,ReubenBond,,
4038,Grain Bulk Creation,"Does anyone have an ideas on how to create grains in batch? We use DynamoDB to store JSON records which I'm hoping to deserialize into Grains. I've tried code in two ways:

1. Do a BatchGetItemAsync and then for each result create a grain and set the value
2. Do a GetItemAsync in the Grain OnActivateAsync() and set the value

Option 1 is much faster by doing the batch but it means I have code in a different grain to do the BatchGetItemsAsync and then set the Grain values. Option 2 leads to cleaner code but is significantly slower.

I would like to have my Grain know how to initialize itself but need to do it some way using Batch.","Grain Bulk Creation Does anyone have an ideas on how to create grains in batch? We use DynamoDB to store JSON records which I'm hoping to deserialize into Grains. I've tried code in two ways:

1. Do a BatchGetItemAsync and then for each result create a grain and set the value
2. Do a GetItemAsync in the Grain OnActivateAsync() and set the value

Option 1 is much faster by doing the batch but it means I have code in a different grain to do the BatchGetItemsAsync and then set the Grain values. Option 2 leads to cleaner code but is significantly slower.

I would like to have my Grain know how to initialize itself but need to do it some way using Batch.",question,tinpl,14/02/2018 23:48,27/02/2018 0:34
4036,Remove FastKillOnCancel setting add ProcessExitHandlingOptions,"- Remove FastKillOnCancelKeyPress setting from SiloOptions and also legacy configuration per #3957 
- Add ProcessExitHandlingOptions to configure whether to fast kill on process exit. per #4016 ","Remove FastKillOnCancel setting, add ProcessExitHandlingOptions - Remove FastKillOnCancelKeyPress setting from SiloOptions and also legacy configuration per #3957 
- Add ProcessExitHandlingOptions to configure whether to fast kill on process exit. per #4016 ",,benjaminpetit,,
4034,PerformanceTuningOptions,"Merge ServicePointOptions and ThreadPoolOptions into one option  and keep it in core. Reasons as follows

They exists for configuring environment to be optimal for orleans cluster performance. Yes none of the target they configure is maintained by orleans but we think configure them to be at optimal  values is orleans’s responsibility because they are essential for orleans performance. If we don’t configure them the default settings for ThreadPool or ServicePointManager greatly affects performance especially ThreadPool settings. If we ask our user to configure them then we run risks of low discoverability of the need to configure them and mysterious performance drop after adopting 2.0. 

Default MinThreads for ThreadPool is small while Orleans needs hundreds of threads to have optimal performance. 
And also ServicePointOptions are not just for optimization when using AzureStorage. The settings there are for optimizing ServicePointManager to handle small requests to our understanding. See blog post https://blogs.msdn.microsoft.com/windowsazurestorage/2010/06/25/nagles-algorithm-is-not-friendly-towards-small-requests/ for more info. 

So based on above reasons. We merge those two options into one with default values. 
","PerformanceTuningOptions Merge ServicePointOptions and ThreadPoolOptions into one option  and keep it in core. Reasons as follows

They exists for configuring environment to be optimal for orleans cluster performance. Yes none of the target they configure is maintained by orleans but we think configure them to be at optimal  values is orleans’s responsibility because they are essential for orleans performance. If we don’t configure them the default settings for ThreadPool or ServicePointManager greatly affects performance especially ThreadPool settings. If we ask our user to configure them then we run risks of low discoverability of the need to configure them and mysterious performance drop after adopting 2.0. 

Default MinThreads for ThreadPool is small while Orleans needs hundreds of threads to have optimal performance. 
And also ServicePointOptions are not just for optimization when using AzureStorage. The settings there are for optimizing ServicePointManager to handle small requests to our understanding. See blog post https://blogs.msdn.microsoft.com/windowsazurestorage/2010/06/25/nagles-algorithm-is-not-friendly-towards-small-requests/ for more info. 

So based on above reasons. We merge those two options into one with default values. 
",,xiazen,,
4033,Endpointoptions default values,"* Add default values for 
* Add ip value check in the validator","Endpointoptions default values * Add default values for 
* Add ip value check in the validator",,ReubenBond,,
4032,Add more logging to AzureTableGrainStorage init Add ConfiguratorValidator,#NAME?,"Add more logging to AzureTableGrainStorage init, Add ConfiguratorValidator - Add more logging to AzureTableGrainStorage init to improve debugging experience
- Add Configuration validator to   in AzureGatewaylistprovider and AzureMembershipProvier",,benjaminpetit,,
4031,Move Azure blob storage to options and lifecycle pattern,Sorry for the single big commit but it was a bit hard to split.,Move Azure blob storage to options and lifecycle pattern Sorry for the single big commit but it was a bit hard to split.,,xiazen,,
4030,Move remaining *Options classes to Orleans.Configuration namespace,,Move remaining *Options classes to Orleans.Configuration namespace ,,xiazen,,
4028,New grain Implementation is not loaded after its first upgrade,"We are running Orleans 2.0 on ServiceFabric cluster. When we try to add a new interface/implementation of a grain or change the name of existing interface/implementation it will fail with error message:

> {""error"":{""innererror"":""System.ArgumentException: Cannot find an implementation class for grain interface: Fog.GrainInterfaces.IFogFailureManagementGrain. Make sure the grain assembly was correctly deployed and loaded in the silo.
  at Orleans.GrainFactory.GetGrainClassData(Type interfaceType String grainClassNamePrefix)
  at Orleans.GrainFactory.GetGrain[TGrainInterface](Guid primaryKey String grainClassNamePrefix)
  at Orleans.ClusterClient.GetGrain[TGrainInterface](Guid primaryKey String grainClassNamePrefix)
  at Fog.GrainInterfaces.GrainFactoryExtension.GetFogFailureManagementGrainReference(IGrainFactory grainFactory Guid key) in C:\\BA\\185\\s\\src\\ControlPlane\\Fog.GrainInterfaces\\GrainFactoryExtension.cs:line 37
  at Fog.Frontend.Controllers.BatchController.ThrowIfFailureOn(AzureRegion regionId String accountName String poolId String methodName) in C:\\BA\\185\\s\\src\\ControlPlane\\Fog.Frontend\\Controllers\\BatchController.cs:line 49
  at Fog.Frontend.Controllers.BatchController.<CreatePool>d__6.MoveNext() in C:\\BA\\185\\s\\src\\ControlPlane\\Fog.Frontend\\Controllers\\BatchController.cs:line 186\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at System.Threading.Tasks.TaskHelpersExtensions.<CastToObject>d__31.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at System.Web.Http.Controllers.ApiControllerActionInvoker.<InvokeActionAsyncCore>d__0.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at System.Web.Http.Controllers.ActionFilterResult.<ExecuteAsync>d__2.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at System.Web.Http.Dispatcher.HttpControllerDispatcher.<SendAsync>d__1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Web.Http.Dispatcher.HttpControllerDispatcher.<SendAsync>d__1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at Microsoft.Gaming.Common.WebApi.RootMessageHandler.<SendAsync>d__5.MoveNext() in C:\\BA\\185\\s\\src\\Common\\Common.WebApi\\RootMessageHandler.cs:line 52""""code"":null""message"":null}}

3 scenarios:
1. If we deploy the new code cleanly from scratch everything is working
2. If we have old version in ServiceFabric and we make an upgrade with this new version then new grain is not loaded
3. If we have old version in ServiceFabric and we make an upgrade with this new version and upgrade again everything is working. New grain is loaded. This is just to make the same upgrade twice.","New grain Implementation is not loaded after its first upgrade We are running Orleans 2.0 on ServiceFabric cluster. When we try to add a new interface/implementation of a grain or change the name of existing interface/implementation it will fail with error message:

> {""error"":{""innererror"":""System.ArgumentException: Cannot find an implementation class for grain interface: Fog.GrainInterfaces.IFogFailureManagementGrain. Make sure the grain assembly was correctly deployed and loaded in the silo.
  at Orleans.GrainFactory.GetGrainClassData(Type interfaceType String grainClassNamePrefix)
  at Orleans.GrainFactory.GetGrain[TGrainInterface](Guid primaryKey String grainClassNamePrefix)
  at Orleans.ClusterClient.GetGrain[TGrainInterface](Guid primaryKey String grainClassNamePrefix)
  at Fog.GrainInterfaces.GrainFactoryExtension.GetFogFailureManagementGrainReference(IGrainFactory grainFactory Guid key) in C:\\BA\\185\\s\\src\\ControlPlane\\Fog.GrainInterfaces\\GrainFactoryExtension.cs:line 37
  at Fog.Frontend.Controllers.BatchController.ThrowIfFailureOn(AzureRegion regionId String accountName String poolId String methodName) in C:\\BA\\185\\s\\src\\ControlPlane\\Fog.Frontend\\Controllers\\BatchController.cs:line 49
  at Fog.Frontend.Controllers.BatchController.<CreatePool>d__6.MoveNext() in C:\\BA\\185\\s\\src\\ControlPlane\\Fog.Frontend\\Controllers\\BatchController.cs:line 186\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at System.Threading.Tasks.TaskHelpersExtensions.<CastToObject>d__31.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at System.Web.Http.Controllers.ApiControllerActionInvoker.<InvokeActionAsyncCore>d__0.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at System.Web.Http.Controllers.ActionFilterResult.<ExecuteAsync>d__2.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at System.Web.Http.Dispatcher.HttpControllerDispatcher.<SendAsync>d__1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Web.Http.Dispatcher.HttpControllerDispatcher.<SendAsync>d__1.MoveNext()\r\n--- End of stack trace from previous location where exception was thrown ---
  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
  at Microsoft.Gaming.Common.WebApi.RootMessageHandler.<SendAsync>d__5.MoveNext() in C:\\BA\\185\\s\\src\\Common\\Common.WebApi\\RootMessageHandler.cs:line 52""""code"":null""message"":null}}

3 scenarios:
1. If we deploy the new code cleanly from scratch everything is working
2. If we have old version in ServiceFabric and we make an upgrade with this new version then new grain is not loaded
3. If we have old version in ServiceFabric and we make an upgrade with this new version and upgrade again everything is working. New grain is loaded. This is just to make the same upgrade twice.",,benjaminpetit,,
4026,Add startup tasks to replace deprecated bootstrap providers,"Resolves #4014

Developers can register an implementation of  for the purpose of scheduling startup tasks. I didn't extend scheduling to all lifecycle participants because the scheduler itself is only started at a certain silo lifecycle stage and therefore wont pump tasks before then. If this is an issue maybe someone has an idea for how to solve it?

See the tests at the bottom for usage.","Add startup tasks to replace deprecated bootstrap providers Resolves #4014

Developers can register an implementation of  for the purpose of scheduling startup tasks. I didn't extend scheduling to all lifecycle participants because the scheduler itself is only started at a certain silo lifecycle stage and therefore wont pump tasks before then. If this is an issue maybe someone has an idea for how to solve it?

See the tests at the bottom for usage.",,benjaminpetit,,
4024,Add a configuration validator and options formatter for EndpointOptions,#NAME?,"Add a configuration validator and options formatter for EndpointOptions @benjaminpetit this might also need a default value for  or something else.

",,benjaminpetit,,
4021,[Question] Running beta 3 on azure worker role,"Hello! I'm trying the latest beta of 2.0.0 on a azure worker role but I can not even start the silo the error thrown is the next one 

OrleansMessageRejectionException: Silo S10.43.44.207:54629:256167661 is rejecting message: Request S10.43.44.207:0:256167661???/00000013@S00000013->S10.43.44.207:0:256167661???/dc13e0a2@Sdc13e0a2 #5: global::Orleans.Streams.IPersistentStreamPullingManager:Initialize(). Reason = Recent (00:00:00.7408936 ago at 2018-02-12 21:41:16.135 GMT) connection failure trying to reach target silo S10.43.44.207:0:256167661. Going to drop Request msg 5 without sending. CONNECTION_RETRY_DELAY = 00:00:01.

and the configuration I'm using the next config 
","[Question] Running beta 3 on azure worker role Hello! I'm trying the latest beta of 2.0.0 on a azure worker role but I can not even start the silo the error thrown is the next one 

OrleansMessageRejectionException: Silo S10.43.44.207:54629:256167661 is rejecting message: Request S10.43.44.207:0:256167661???/00000013@S00000013->S10.43.44.207:0:256167661???/dc13e0a2@Sdc13e0a2 #5: global::Orleans.Streams.IPersistentStreamPullingManager:Initialize(). Reason = Recent (00:00:00.7408936 ago at 2018-02-12 21:41:16.135 GMT) connection failure trying to reach target silo S10.43.44.207:0:256167661. Going to drop Request msg 5 without sending. CONNECTION_RETRY_DELAY = 00:00:01.

and the configuration I'm using the next config 
",,xiazen,,
4020,Move Orleans.Core and Orleans.Runtime options to Orleans.Configuration namespace,This is for #3956 - move  namespace.,Move Orleans.Core and Orleans.Runtime options to Orleans.Configuration namespace This is for #3956 - move  namespace.,,xiazen,,
4019,Rename ProxiedMessageCenter to ClientMessageCenter,Rename ,Rename ProxiedMessageCenter to ClientMessageCenter Rename ,,ReubenBond,,
4018,More cleanup of types,Move .,More cleanup of types Move .,,ReubenBond,,
4016,Add a config option to not intercept AppDomain.CurrentDomain.ProcessExit in Silo,"Dev that want to intercept  we always listen to this event and do a ""FastKill"".

We should add an option to disable this behavior but let it by default
","Add a config option to not intercept AppDomain.CurrentDomain.ProcessExit in Silo Dev that want to intercept  we always listen to this event and do a ""FastKill"".

We should add an option to disable this behavior but let it by default
",,xiazen,,
4015,Logger is not used currently in Orleans.Runtime.Dispatcher,"There is a bug in the usage of the logger in Orleans.Runtime.Dispatcher and possibly in other places.
For example the LoggerExtensions.Info method signature is:





","Logger is not used currently in Orleans.Runtime.Dispatcher There is a bug in the usage of the logger in Orleans.Runtime.Dispatcher and possibly in other places.
For example the LoggerExtensions.Info method signature is:





",,xiazen,,
4014,[Question] - How to build bootstrap providers without legacy package?,"Hi

I try to figure out how to build a bootstrap provider without the legacy stuff in beta3.

My attempt:

    public sealed class EventConsumerBootstrap : ILifecycleParticipant<ISiloLifecycle>
    {
        private readonly IGrainFactory grainFactory;

        public EventConsumerBootstrap(IGrainFactory grainFactory)
        {
            this.grainFactory = grainFactory;
        }

        public void Participate(ISiloLifecycle lifecycle)
        {
            lifecycle.Subscribe(SiloLifecycleStage.SiloActive ct =>
            {
                var grain = grainFactory.GetGrain<IEventConsumerManagerGrain>(""Default"");

                return grain.ActivateAsync();
            });
        }
    }

But the problem is that I have no access to the scheduler. The legacy package uses the OrleansScheduler which is internal. Therefore my call to the grain fails.","[Question] - How to build bootstrap providers without legacy package? Hi

I try to figure out how to build a bootstrap provider without the legacy stuff in beta3.

My attempt:

    public sealed class EventConsumerBootstrap : ILifecycleParticipant<ISiloLifecycle>
    {
        private readonly IGrainFactory grainFactory;

        public EventConsumerBootstrap(IGrainFactory grainFactory)
        {
            this.grainFactory = grainFactory;
        }

        public void Participate(ISiloLifecycle lifecycle)
        {
            lifecycle.Subscribe(SiloLifecycleStage.SiloActive ct =>
            {
                var grain = grainFactory.GetGrain<IEventConsumerManagerGrain>(""Default"");

                return grain.ActivateAsync();
            });
        }
    }

But the problem is that I have no access to the scheduler. The legacy package uses the OrleansScheduler which is internal. Therefore my call to the grain fails.",,ReubenBond,,
4013,[Question] - Grain Placement,"I am attempting to model a cluster of Hyper-V servers where I want a Grain to represent a particular Hyper-V image but where that Hyper-V image can only exist in silo's where the HyperVisor actually has that image available!

For example the cluster consists of:

1. Silo A for HyperVisor machine A has Images ""A"" and ""B""
2. Silo B for HyperVisor machine B has Images ""A"" ""B"" and ""C""

When an orleans client requests the grain for Image ""A"" - I'd like this grain to be activated in either Silo 1 or 2. 

When an orleans client requests the grain for Image ""C"" - I'd like this grain to be activate in Silo B because thats the only silo where the image is available.

Is it possible for me to achieve something like this? Or is this kind of thing frowned upon? (If so any suggestions on how I would change the model would be welcome.

Thanks
","[Question] - Grain Placement I am attempting to model a cluster of Hyper-V servers where I want a Grain to represent a particular Hyper-V image but where that Hyper-V image can only exist in silo's where the HyperVisor actually has that image available!

For example the cluster consists of:

1. Silo A for HyperVisor machine A has Images ""A"" and ""B""
2. Silo B for HyperVisor machine B has Images ""A"" ""B"" and ""C""

When an orleans client requests the grain for Image ""A"" - I'd like this grain to be activated in either Silo 1 or 2. 

When an orleans client requests the grain for Image ""C"" - I'd like this grain to be activate in Silo B because thats the only silo where the image is available.

Is it possible for me to achieve something like this? Or is this kind of thing frowned upon? (If so any suggestions on how I would change the model would be welcome.

Thanks
",question,benjaminpetit,,
4012,Not support generic type on Grain. ,"Hi there is there any way to support generic type on an Grain? e.g.



here is my test repo
https://github.com/darting/orleans-fsharp/blob/master/src/Client/Program.fs#L19
https://github.com/darting/orleans-fsharp/blob/master/src/Grains/Library.fs#L19
https://github.com/darting/orleans-fsharp/blob/master/src/Host/Program.fs#L12

Thanks","Not support generic type on Grain.  Hi there is there any way to support generic type on an Grain? e.g.



here is my test repo
https://github.com/darting/orleans-fsharp/blob/master/src/Client/Program.fs#L19
https://github.com/darting/orleans-fsharp/blob/master/src/Grains/Library.fs#L19
https://github.com/darting/orleans-fsharp/blob/master/src/Host/Program.fs#L12

Thanks",,ReubenBond,,
4010,[Question] - SqlServerStorage provider issue,"I am trying to get sqlserver storage working and on startup I am getting this exception:

> OrleansException: Provider of type Orleans.Storage.AdoNetStorageProvider name AdoNetStorage was not loaded.Please check that you deployed the assembly in which the provider class is defined to the execution folder.

I am referencing these packages:

","[Question] - SqlServerStorage provider issue I am trying to get sqlserver storage working and on startup I am getting this exception:

> OrleansException: Provider of type Orleans.Storage.AdoNetStorageProvider name AdoNetStorage was not loaded.Please check that you deployed the assembly in which the provider class is defined to the execution folder.

I am referencing these packages:

",,jason-bragg,,
4008,Intermittent failures of ElasticityTest_AllSilosOverloaded test,"
I suspect this is happening due to a race when making a call to a grain in the second silo via the gateway in the first silo that is getting set to the overloaded state on the previous line.","Intermittent failures of ElasticityTest_AllSilosOverloaded test 
I suspect this is happening due to a race when making a call to a grain in the second silo via the gateway in the first silo that is getting set to the overloaded state on the previous line.",P3,sergeybykov,11/02/2018 13:00,
4007,Update Docker-Deployment.md,Including reference to OrleansContrib\Orleans.Clustering.Kubernetes,Update Docker-Deployment.md Including reference to OrleansContrib\Orleans.Clustering.Kubernetes,documentation,benjaminpetit,,
4003,Improved error logging of legacy systems,,Improved error logging of legacy systems ,,xiazen,,
4002,Upgrade Suggestions - How to Handle Persisted Grain States,"I have been trying to upgrade from v1.2.2 to v1.5.3 but I am having some issues. Our code persists instances of grains using [Orleans.StorageProviders.SimpleSQLServerStorage](https://github.com/OrleansContrib/Orleans.StorageProviders.SimpleSQLServerStorage) and after upgrading Orleans and SimpleSQLServerStorage the grains fail to deserialize:


The grains were serialized as binary to a SQL Server DB before VersionStoreGrain was added so the deserialize always fails and I can't find an easy way to add a fallback serializer to the old 1.2.2 way. This could work for new/clean installs but existing installs of our current codebase would require deleting all of the stored grains before upgrading which requires too much manual work to document and re-create all the grain configurations during an upgrade.

I really like the recent work that was done to add versioning to the grains which addresses one of our main limitations of using v1.2.2.  Does anyone have any suggestions on how they have handled these types of situations?","Upgrade Suggestions - How to Handle Persisted Grain States I have been trying to upgrade from v1.2.2 to v1.5.3 but I am having some issues. Our code persists instances of grains using [Orleans.StorageProviders.SimpleSQLServerStorage](https://github.com/OrleansContrib/Orleans.StorageProviders.SimpleSQLServerStorage) and after upgrading Orleans and SimpleSQLServerStorage the grains fail to deserialize:


The grains were serialized as binary to a SQL Server DB before VersionStoreGrain was added so the deserialize always fails and I can't find an easy way to add a fallback serializer to the old 1.2.2 way. This could work for new/clean installs but existing installs of our current codebase would require deleting all of the stored grains before upgrading which requires too much manual work to document and re-create all the grain configurations during an upgrade.

I really like the recent work that was done to add versioning to the grains which addresses one of our main limitations of using v1.2.2.  Does anyone have any suggestions on how they have handled these types of situations?",,ReubenBond,,
3998,Removed Core.Legacy dependency some azure extension pacakges,"Removed Orleans.Core.Legacy dependency from:
Orleans.Cluster.AzureStorage
Orleans.Reminders.AzureStorage
Orleans.Streaming.Eventhubs","Removed Core.Legacy dependency some azure extension pacakges Removed Orleans.Core.Legacy dependency from:
Orleans.Cluster.AzureStorage
Orleans.Reminders.AzureStorage
Orleans.Streaming.Eventhubs",,sergeybykov,,
3996,Skip CallThatShouldHaveBeenDroppedNotExecutedTest for now,#3995 is tracking failures of the test.,Skip CallThatShouldHaveBeenDroppedNotExecutedTest for now #3995 is tracking failures of the test.,,benjaminpetit,,
3995,Intermittent failures of CallThatShouldHaveBeenDroppedNotExecutedTest,">Assert.Throws() Failure\r\nExpected: typeof(System.TimeoutException)\r\nActual: (No exception was thrown)

Need to investigate.","Intermittent failures of CallThatShouldHaveBeenDroppedNotExecutedTest >Assert.Throws() Failure\r\nExpected: typeof(System.TimeoutException)\r\nActual: (No exception was thrown)

Need to investigate.",P3,sergeybykov,9/02/2018 6:35,
3994,Skip faling tests until they are fixed,"Skip DelayedQueueRebalancingTests_* for now.
#3993 is tracking fixing of these tests.","Skip faling tests until they are fixed Skip DelayedQueueRebalancingTests_* for now.
#3993 is tracking fixing of these tests.",,xiazen,,
3993,Test failures in DelayedQueueRebalancingTests_*,"DelayedQueueRebalancingTests_2 seems to be failing consistently with errors like the following:
>Assert.Equal() Failure\r\nExpected: 2\r\nActual: 4

>Assert.Equal() Failure\r\nExpected: 2\r\nActual: 3

and sometimes
>Orleans.Runtime.OrleansMessageRejectionException : Silo S127.0.0.1:28513:255762038 is rejecting message: Request S127.0.0.1:28513:255762038*stg/14/0000000e@S0000000e->S127.0.0.1:28514:255762039*stg/10/0000000a@S0000000a #110: . Reason = Recent (00:00:00.0468768 ago at 2018-02-08 05:00:52.321 GMT) connection failure trying to reach target silo S127.0.0.1:28514:255762039. Going to drop Request msg 110 without sending. CONNECTION_RETRY_DELAY = 00:00:01.

DelayedQueueRebalancingTests_1 is failing infrequently
>Orleans.Runtime.OrleansMessageRejectionException : Silo S127.0.0.1:22815:255804984 is rejecting message: Request S127.0.0.1:22815:255804984*stg/10/0000000a@S0000000a->S127.0.0.1:22816:255804985*stg/10/0000000a@S0000000a #215: . Reason = Recent (00:00:00 ago at 2018-02-08 16:56:43.128 GMT) connection failure trying to reach target silo S127.0.0.1:22816:255804985. Going to drop Request msg 215 without sending. CONNECTION_RETRY_DELAY = 00:00:01.","Test failures in DelayedQueueRebalancingTests_* DelayedQueueRebalancingTests_2 seems to be failing consistently with errors like the following:
>Assert.Equal() Failure\r\nExpected: 2\r\nActual: 4

>Assert.Equal() Failure\r\nExpected: 2\r\nActual: 3

and sometimes
>Orleans.Runtime.OrleansMessageRejectionException : Silo S127.0.0.1:28513:255762038 is rejecting message: Request S127.0.0.1:28513:255762038*stg/14/0000000e@S0000000e->S127.0.0.1:28514:255762039*stg/10/0000000a@S0000000a #110: . Reason = Recent (00:00:00.0468768 ago at 2018-02-08 05:00:52.321 GMT) connection failure trying to reach target silo S127.0.0.1:28514:255762039. Going to drop Request msg 110 without sending. CONNECTION_RETRY_DELAY = 00:00:01.

DelayedQueueRebalancingTests_1 is failing infrequently
>Orleans.Runtime.OrleansMessageRejectionException : Silo S127.0.0.1:22815:255804984 is rejecting message: Request S127.0.0.1:22815:255804984*stg/10/0000000a@S0000000a->S127.0.0.1:22816:255804985*stg/10/0000000a@S0000000a #215: . Reason = Recent (00:00:00 ago at 2018-02-08 16:56:43.128 GMT) connection failure trying to reach target silo S127.0.0.1:22816:255804985. Going to drop Request msg 215 without sending. CONNECTION_RETRY_DELAY = 00:00:01.",test-issue,xiazen,,
3992,Fix DelayedQueueRebalancingTests, started to fail intermittently. we skipped the two tests for 2.0 rc. But need to fix it for 2.0 ,Fix DelayedQueueRebalancingTests  started to fail intermittently. we skipped the two tests for 2.0 rc. But need to fix it for 2.0 ,,xiazen,,
3989,Proxy Gateway should honor address settings and allow localhost calls from client,"
This setting does not work because the Gateway endpoint will always be set to the IP address of the silo.
I sidecar scenarios we want to be able to call the gateway as localhost:40000 by setting the service to IPAddress.Any or IPAddress.Loopback.
This fix allows the Gateway address setting to be honored. If the IPAddress is set to None then we function same as today by copying Silo address to Gateway address.","Proxy Gateway should honor address settings and allow localhost calls from client 
This setting does not work because the Gateway endpoint will always be set to the IP address of the silo.
I sidecar scenarios we want to be able to call the gateway as localhost:40000 by setting the service to IPAddress.Any or IPAddress.Loopback.
This fix allows the Gateway address setting to be honored. If the IPAddress is set to None then we function same as today by copying Silo address to Gateway address.",,benjaminpetit,,
3984,Gateway cannot be called using localhost when running in non-local silo mode.  Kubernetes pod scenerio,"This is the scenario that breaks:

- Orleans silo running in container listening on port 22222 and gateway 40000 with IP.Any using Azure table membership
- Web app in container listening to port 80 using Orleans client calling Gateway client endpoint 127.0.0.1 port 40000
- Both containers are in side one Kubernetes Statefulset pod with external port 80 exposed.
- Silo to silo communications works well.

It is expected that the web app can communicate with the Orleans silo at localhost:40000 inside the pod.  This is not the case.  It seems that the gateway will always listen on the same address as the silo address.



This breaks any sidecar scenarios in containerized applications.
","Gateway cannot be called using localhost when running in non-local silo mode.  Kubernetes pod scenerio This is the scenario that breaks:

- Orleans silo running in container listening on port 22222 and gateway 40000 with IP.Any using Azure table membership
- Web app in container listening to port 80 using Orleans client calling Gateway client endpoint 127.0.0.1 port 40000
- Both containers are in side one Kubernetes Statefulset pod with external port 80 exposed.
- Silo to silo communications works well.

It is expected that the web app can communicate with the Orleans silo at localhost:40000 inside the pod.  This is not the case.  It seems that the gateway will always listen on the same address as the silo address.



This breaks any sidecar scenarios in containerized applications.
",,benjaminpetit,,
3983,[Proposal] IClusterClient.Connect retry could simplify user code,"As a newcomer to Orleans I was surprised to learn that  I think it could improve the new user experience a bit. I'm sure established projects and users also use a very similar pattern so maybe it can help others too.

","[Proposal] IClusterClient.Connect retry could simplify user code As a newcomer to Orleans I was surprised to learn that  I think it could improve the new user experience a bit. I'm sure established projects and users also use a very similar pattern so maybe it can help others too.

",,ReubenBond,,
3981,Options formating improvements.,"Removed catalog as it was deemed unnecessary.
Order logging by formatter name.  Helps with grouping of related options when using default formatters.
Allow user override of formatters before or after defaults.
Fixed issues with named options not reporting correctly.
Updated tests to verify by confirming expected log output.

","Options formating improvements. Removed catalog as it was deemed unnecessary.
Order logging by formatter name.  Helps with grouping of related options when using default formatters.
Allow user override of formatters before or after defaults.
Fixed issues with named options not reporting correctly.
Updated tests to verify by confirming expected log output.

",,xiazen,,
3980,Add networking mask options in EndpointOptions,"Related issue: #3203 

Right now using the legacy configuration in the case of a ""multi-homed"" server to force the selection of a specific IP address for the membership/gateway table users have to use  the user can use a real network address with a real network mask.
","Add networking mask options in EndpointOptions Related issue: #3203 

Right now using the legacy configuration in the case of a ""multi-homed"" server to force the selection of a specific IP address for the membership/gateway table users have to use  the user can use a real network address with a real network mask.
",,ReubenBond,,
3979,When is version 2.0 expected to be used in a production environment? We are now new system development intended to be applied if the time is too long we can only choose other,When is version 2.0 expected to be used in a production environment? We are now new system development intended to be applied if the time is too long we can only choose other,"When is version 2.0 expected to be used in a production environment? We are now new system development, intended to be applied, if the time is too long, we can only choose other When is version 2.0 expected to be used in a production environment? We are now new system development intended to be applied if the time is too long we can only choose other",question,sergeybykov,7/02/2018 13:08,1/03/2018 22:08
3978,Fix intermittent failures in custom placement tests,Make sorting of silos in the custom placement tests match the order used in the placement director.,Fix intermittent failures in custom placement tests Make sorting of silos in the custom placement tests match the order used in the placement director.,,xiazen,,
3977,Move load shedding settings to LoadSheddingOptions,This is a preparation step for #3948 and a useful cleanup step in general.,Move load shedding settings to LoadSheddingOptions This is a preparation step for #3948 and a useful cleanup step in general.,,jason-bragg,,
3976,Refactor statistic and metric system,"Currently orleans metric and statistic system has some problems which  made it confusing to use and error prone 
- [ ]  use assembly loading to configure default  whose difference isn't clear. For example Which metrics belongs to statistics and which belongs to metrics? 
- [ ] overlap with telemetry. So basically now we have three system reporting metrics in orleans and their responsibility and infrastructure overlap with each other. This made metrics harder to maintain and harder to use. 

Considering refactor it. ","Refactor statistic and metric system Currently orleans metric and statistic system has some problems which  made it confusing to use and error prone 
- [ ]  use assembly loading to configure default  whose difference isn't clear. For example Which metrics belongs to statistics and which belongs to metrics? 
- [ ] overlap with telemetry. So basically now we have three system reporting metrics in orleans and their responsibility and infrastructure overlap with each other. This made metrics harder to maintain and harder to use. 

Considering refactor it. ",,ReubenBond,,
3975,Lifecycle for ClusterClient,"A lifecycle was added to the client to support component initialization made necessary when the provider model was removed.  This lifecycle is minimal and is weakly integrated with client initialization/shutdown.

We need to drive client initialization/shutdown from the lifecycle and declare well defined stages as we do for the silo.","Lifecycle for ClusterClient A lifecycle was added to the client to support component initialization made necessary when the provider model was removed.  This lifecycle is minimal and is weakly integrated with client initialization/shutdown.

We need to drive client initialization/shutdown from the lifecycle and declare well defined stages as we do for the silo.",,jason-bragg,,
3974,Fixes for Multi-Cluster Support,"It's been a while since we added multi-cluster support. Running all the tests I found some bugs:

- when running with at least three clusters and activating a grain concurrently messages could get forwarded excessively causing activation to fail (due to the forward count limit). I fixed this by forwarding only to destinations that are known to be the owner.
- Message.cs contained a bug that made the IsReturnedFromRemoteCluster flag not work correctly. This could also cause excessive forwarding and failure to remove stale directory cache entries.
- in two places NullReferenceExceptions were thrown when multi-clusters had no gateways reporting. I put in the proper handling of these situations.
- some tests were failing because the gsi-directory-maintenance was happening too late. To fix this I changed the periodic maintenance loop so it  runs the maintenance immediately after each multi-cluster-configuration change.

I also fixed some tracing issues and added more tests to the Functional category so we can cover these types of errors in regression.
","Fixes for Multi-Cluster Support It's been a while since we added multi-cluster support. Running all the tests I found some bugs:

- when running with at least three clusters and activating a grain concurrently messages could get forwarded excessively causing activation to fail (due to the forward count limit). I fixed this by forwarding only to destinations that are known to be the owner.
- Message.cs contained a bug that made the IsReturnedFromRemoteCluster flag not work correctly. This could also cause excessive forwarding and failure to remove stale directory cache entries.
- in two places NullReferenceExceptions were thrown when multi-clusters had no gateways reporting. I put in the proper handling of these situations.
- some tests were failing because the gsi-directory-maintenance was happening too late. To fix this I changed the periodic maintenance loop so it  runs the maintenance immediately after each multi-cluster-configuration change.

I also fixed some tracing issues and added more tests to the Functional category so we can cover these types of errors in regression.
",,ReubenBond,,
3971,Contributing guide - getting started,"I and my team are willing to try and contribute to Orleans source however currently there's no guide on how to start and for a big project like this we don't know where to start.

Can you create a very simple guide on how to get started in order to contribute e.g. clone build run (ideally in our project so we can test better + debuggable)

Something along these lines is what im thinking:

In order to contribute to the project follow these simple steps:

- Clone orleans repo - 

If you are able to help us where to start we are willing to contribute thanks!","Contributing guide - getting started I and my team are willing to try and contribute to Orleans source however currently there's no guide on how to start and for a big project like this we don't know where to start.

Can you create a very simple guide on how to get started in order to contribute e.g. clone build run (ideally in our project so we can test better + debuggable)

Something along these lines is what im thinking:

In order to contribute to the project follow these simple steps:

- Clone orleans repo - 

If you are able to help us where to start we are willing to contribute thanks!",P3,JillHeaden,,
3969,Using system given free ports in tests to remove transient test failures in CI,"Anedoctally I experienced multiple errors in opening sockets in CI server which appeared to be due to some socket being already reserved. 

As a first measure I suggest adding a functionality to ask the system to give a free port from the ephemeral range and use that. The code could be like:



When this change is implemented it needs to be ensured all places are modified and the current code does not assume _well known_ ports. Assuming all places are changed to use system given free ports failing tests should reveal places that assume _well known_ ports.

One option to refactor the tests could be to implement a cache or a DI-like container to (lazily) generate and hold parameters that are then injected in all test class constructors. This could would allow sharing assets where feasible and perhaps make the testing infrastructure more uniform (and more approachable). There are some examples on how to do this at https://github.com/xunit/xunit/issues/687.
","Using system given free ports in tests to remove transient test failures in CI Anedoctally I experienced multiple errors in opening sockets in CI server which appeared to be due to some socket being already reserved. 

As a first measure I suggest adding a functionality to ask the system to give a free port from the ephemeral range and use that. The code could be like:



When this change is implemented it needs to be ensured all places are modified and the current code does not assume _well known_ ports. Assuming all places are changed to use system given free ports failing tests should reveal places that assume _well known_ ports.

One option to refactor the tests could be to implement a cache or a DI-like container to (lazily) generate and hold parameters that are then injected in all test class constructors. This could would allow sharing assets where feasible and perhaps make the testing infrastructure more uniform (and more approachable). There are some examples on how to do this at https://github.com/xunit/xunit/issues/687.
",,benjaminpetit,,
3968,silo.StopAsync()  indefinite wait,"  private static async Task StopSilo()
        {
            Console.WriteLine(""Start Silo stop"");

            await silo.StopAsync();
            
            Console.WriteLine(""Silo stopped"");

        }","silo.StopAsync()  indefinite wait   private static async Task StopSilo()
        {
            Console.WriteLine(""Start Silo stop"");

            await silo.StopAsync();
            
            Console.WriteLine(""Silo stopped"");

        }",,benjaminpetit,,
3967,Suggest RequestContext add an IServiceProvider property so easy to control,Suggest RequestContext add an IServiceProvider property so easy to control,"Suggest RequestContext add an IServiceProvider property, so easy to control Suggest RequestContext add an IServiceProvider property so easy to control",,xiazen,,
3964,Sort list of silos in HashBasedPlacementDirector,"Sort list of available compatible silos before picking a target one based on the grain ID hash.
Fixes non-deterministic behavior of HashBasedPlacementDirector and related tests.","Sort list of silos in HashBasedPlacementDirector Sort list of available compatible silos before picking a target one based on the grain ID hash.
Fixes non-deterministic behavior of HashBasedPlacementDirector and related tests.",,benjaminpetit,,
3960,Allow OrleansJsonSerializer to be used as an external serialization provider,"Fixes #3853

Problem: ","Allow OrleansJsonSerializer to be used as an external serialization provider Fixes #3853

Problem: ",,benjaminpetit,,
3959,Reference Microsoft.Orleans.OrleansCodeGenerator.Build problem？,"Reference Microsoft.Orleans.OrleansCodeGenerator.Build it seems invalid it is not completed 2.0 or I configure here?
![image](https://user-images.githubusercontent.com/28291464/35715634-bcf3d8f8-080e-11e8-846c-496511b5c92d.png)

![image](https://user-images.githubusercontent.com/28291464/35715660-dad566fc-080e-11e8-9ea6-707b255a9ccc.png)
","Reference Microsoft.Orleans.OrleansCodeGenerator.Build problem？ Reference Microsoft.Orleans.OrleansCodeGenerator.Build it seems invalid it is not completed 2.0 or I configure here?
![image](https://user-images.githubusercontent.com/28291464/35715634-bcf3d8f8-080e-11e8-846c-496511b5c92d.png)

![image](https://user-images.githubusercontent.com/28291464/35715660-dad566fc-080e-11e8-9ea6-707b255a9ccc.png)
",question,lfzm,2/02/2018 14:48,2/02/2018 17:04
3957,Configuration Work - unwanted or improperly organized settings,"While moving from monolithic Cluster and Client configurations to options settings surfaced which should probably not be part of Orleans core or may not be categorized correctly.

Below is a list of some such settings and I encourage others to contribute to this list if the current options seem ill conceived or unnecessary.

AdoNetOptions - should not be in Orleans core.
ServicePointOptions - should not be in Orleans core.
Load shedding settings - Probably should not be part of statistics. (EDIT: moved to its own options)
FastKillOnCancelKeyPress - probably should not be in Orleans core.

Figure out what to do about these.

[Edit]
Thread pool options - don't think thread pool settup should be part of orleans core.
","Configuration Work - unwanted or improperly organized settings While moving from monolithic Cluster and Client configurations to options settings surfaced which should probably not be part of Orleans core or may not be categorized correctly.

Below is a list of some such settings and I encourage others to contribute to this list if the current options seem ill conceived or unnecessary.

AdoNetOptions - should not be in Orleans core.
ServicePointOptions - should not be in Orleans core.
Load shedding settings - Probably should not be part of statistics. (EDIT: moved to its own options)
FastKillOnCancelKeyPress - probably should not be in Orleans core.

Figure out what to do about these.

[Edit]
Thread pool options - don't think thread pool settup should be part of orleans core.
",,xiazen,,
3956,Configuration Work - Option home and namespace,"Currently all options derived from legacy cluster and client configurations live in Orleans.Core and are under the namespace Orleans.Host.

The namespace was selected for discoverability.
The location was selected to avoid dependency issues since Orleans Core is where the original configurations lived.

It's not clear if this pattern is what we want to maintain in the long run.

Revisit where options should live what should be in core runtime and what options should be with their components.","Configuration Work - Option home and namespace Currently all options derived from legacy cluster and client configurations live in Orleans.Core and are under the namespace Orleans.Host.

The namespace was selected for discoverability.
The location was selected to avoid dependency issues since Orleans Core is where the original configurations lived.

It's not clear if this pattern is what we want to maintain in the long run.

Revisit where options should live what should be in core runtime and what options should be with their components.",,sergeybykov,,
3955,Configuration Work - Formatters,Add options formatters for all the new options. (many already have formatters),Configuration Work - Formatters Add options formatters for all the new options. (many already have formatters),,jason-bragg,,
3954,Configuration Works - StorageOptions,"The original cluster and client configurations used a shared account key for general storage and reminder storage.  This pattern has been carried over in the StorageOptions.  This is a questionable pattern as there is no reason to assume authentication/authorization for various storage systems can be generalized in such a way nor is it possible to provide reasonable defaults or security for such information.

Identify storage needs (by component) for framework work out abstractions and configuration.  Leave extension configurations to the extensions.","Configuration Works - StorageOptions The original cluster and client configurations used a shared account key for general storage and reminder storage.  This pattern has been carried over in the StorageOptions.  This is a questionable pattern as there is no reason to assume authentication/authorization for various storage systems can be generalized in such a way nor is it possible to provide reasonable defaults or security for such information.

Identify storage needs (by component) for framework work out abstractions and configuration.  Leave extension configurations to the extensions.",,ReubenBond,,
3953,Configuration Work - assembly loaded types,"Many patterns carried over from the legacy configuration use strings or enums to identify component implementations.  These settings trigger assembly loads of pre defined assemblies and creation of types assumed to be in those assemblies.  This pattern is error prone and poorly maintainable.

In new systems this is done by requiring component implementations to be registered in the container by name and configured values are used by named service resolution but no consensus has been built around this pattern.

We need to design a better pattern and replace the legacy pattern.  ","Configuration Work - assembly loaded types Many patterns carried over from the legacy configuration use strings or enums to identify component implementations.  These settings trigger assembly loads of pre defined assemblies and creation of types assumed to be in those assemblies.  This pattern is error prone and poorly maintainable.

In new systems this is done by requiring component implementations to be registered in the container by name and configured values are used by named service resolution but no consensus has been built around this pattern.

We need to design a better pattern and replace the legacy pattern.  ",,ReubenBond,,
3952,Configuration Work - Extension libraries,We need to remove references to legacy configuration classes (and references to legacy packages) from extension libraries and their test assemblies.  This work can (should) be subdivided into per extension library change sets.,Configuration Work - Extension libraries We need to remove references to legacy configuration classes (and references to legacy packages) from extension libraries and their test assemblies.  This work can (should) be subdivided into per extension library change sets.,,ReubenBond,,
3951,Configuration Work - TestingHost,Remove use of legacy configuration from Orleans.TestingHost introducing a Orleans.TestingHost.Legacy if necessary.,Configuration Work - TestingHost Remove use of legacy configuration from Orleans.TestingHost introducing a Orleans.TestingHost.Legacy if necessary.,,xiazen,,
3950,Configuration Work - XML docs,"While moving from monolithic Cluster and Client configurations to options settings without xml comments were copied without comment leaving it unclear what these settings are for.

We need to go through all of the new options and ensure that the options themselves as well as all of it's properties have xml comments.","Configuration Work - XML docs While moving from monolithic Cluster and Client configurations to options settings without xml comments were copied without comment leaving it unclear what these settings are for.

We need to go through all of the new options and ensure that the options themselves as well as all of it's properties have xml comments.",,sergeybykov,,
3949,Configuration Work - Defaults,"While moving from monolithic Cluster and Client configurations to options we've duplicated defaults. Many of the options introduced duplicated the defaults in the options rather than having the options have the authoritative default and referencing these defaults from the legacy configurations.

We need to go through all of the added options and ensure the defaults in the options are correct and authoritative.","Configuration Work - Defaults While moving from monolithic Cluster and Client configurations to options we've duplicated defaults. Many of the options introduced duplicated the defaults in the options rather than having the options have the authoritative default and referencing these defaults from the legacy configurations.

We need to go through all of the added options and ensure the defaults in the options are correct and authoritative.",,jason-bragg,,
3948,Move Silo-specific options from Orleans.Core to Orleans.Runtime,"There no need for silo-specific options to pollute .

While it is somewhat ugly to duplicate some default values in the legacy config classes I think that's an acceptable price to pay for cleanness of the forward looking APIs. The legacy classes are ... legacy anyway and their defaults are unlikely to change anyway.

Moved the following options classes to Orleans.Runtime:

* SiloMessagingOptions
* SiloStatisticsOptions
* ConsistentRingOptions
* GrainCollectionOptions
* GrainDirectoryOptions
* GrainPlacementOptions
* GrainServiceOptions
* ReminderOptions
* SchedulingOptions

Also moved OrleansConfiguration.xsd to Orleans.Core.Legacy.","Move Silo-specific options from Orleans.Core to Orleans.Runtime There no need for silo-specific options to pollute .

While it is somewhat ugly to duplicate some default values in the legacy config classes I think that's an acceptable price to pay for cleanness of the forward looking APIs. The legacy classes are ... legacy anyway and their defaults are unlikely to change anyway.

Moved the following options classes to Orleans.Runtime:

* SiloMessagingOptions
* SiloStatisticsOptions
* ConsistentRingOptions
* GrainCollectionOptions
* GrainDirectoryOptions
* GrainPlacementOptions
* GrainServiceOptions
* ReminderOptions
* SchedulingOptions

Also moved OrleansConfiguration.xsd to Orleans.Core.Legacy.",,xiazen,,
3947,More options formatting and related cleanup,"Added formatters for grain directory options grain placement options schedualling options thread pool options type managment options versioning options and silo options.
Fixed formatting of messaging options.
Fixed some options defaults.","More options formatting, and related cleanup Added formatters for grain directory options grain placement options schedualling options thread pool options type managment options versioning options and silo options.
Fixed formatting of messaging options.
Fixed some options defaults.",,xiazen,,
3945,Ping Benchmark fixes,,Ping Benchmark fixes ,,ReubenBond,,
3944,2.0 version can be configured to optimize it?,"![image](https://user-images.githubusercontent.com/28291464/35657078-94d68246-0735-11e8-9cfa-25a06ec968af.png)
","2.0 version can be configured to optimize it? ![image](https://user-images.githubusercontent.com/28291464/35657078-94d68246-0735-11e8-9cfa-25a06ec968af.png)
",question,sergeybykov,1/02/2018 12:52,2/02/2018 15:09
3943,Fix tests. Remove ServiceId and ClusterId getter turn on file logging,"- fix some tests
- remove . 
- turn on file logger for TestCluster by default
","Fix tests. Remove ServiceId and ClusterId getter, turn on file logging - fix some tests
- remove . 
- turn on file logger for TestCluster by default
",,ReubenBond,,
3935,Fix FastKillOnCancelKeyPress not stopping the process.,When FastKillOnCancelKeyPress=true State is set to Closing but Stop process never starts.,Fix FastKillOnCancelKeyPress not stopping the process. When FastKillOnCancelKeyPress=true State is set to Closing but Stop process never starts.,,ReubenBond,,
3933,FastKillOnCancelKeyPress waits forever,"When FastKillOnCancelKeyPress=true SystemStatus is set to stopping but nothing signals the LifeCycle to stop.

The Stop() method then wait for the SystemStatus to Terminate but it never does.

Working on a local fix.","FastKillOnCancelKeyPress waits forever When FastKillOnCancelKeyPress=true SystemStatus is set to stopping but nothing signals the LifeCycle to stop.

The Stop() method then wait for the SystemStatus to Terminate but it never does.

Working on a local fix.",,benjaminpetit,,
3930,Consult a cluster configuration problem.,"Whether the Orleans can be assembled into a cluster between different systems.
Example:
A system (user system) : obtain user information function and configure gateway address: 123.135.13.13:4545.
B system (message system) : send message function configure gateway address and A system. Is it feasible?
If the client can call 123.135.13.13:4545 gateway address it can obtain the user of A system and send information to system B.
Because I didn't succeed in the experiment.","Consult a cluster configuration problem. Whether the Orleans can be assembled into a cluster between different systems.
Example:
A system (user system) : obtain user information function and configure gateway address: 123.135.13.13:4545.
B system (message system) : send message function configure gateway address and A system. Is it feasible?
If the client can call 123.135.13.13:4545 gateway address it can obtain the user of A system and send information to system B.
Because I didn't succeed in the experiment.",question,sergeybykov,30/01/2018 14:17,2/02/2018 17:05
3929,TestMultiClusterConf_3_3 fails intermittently,"TestMultiClusterConf_3_3 has been failing intermittently for some time now. I submitted #3928 to skip it for now. This issue is to remember to investigate it.

https://orleans.visualstudio.com/Orleans/Orleans%20Team/_TestManagement/Runs#_a=resultSummary&runId=3414&resultId=101084
>Assert.Equal() Failure\r\n ↓ (pos 10)\r\nExpected: 2110021101\r\nActual: 2110021102\r\n ↑ (pos 10)

https://orleans.visualstudio.com/Orleans/Orleans%20Team/_TestManagement/Runs?_a=resultSummary&runId=3397&resultId=101169
>Assert.Equal() Failure\r\n ↓ (pos 10)\r\nExpected: 2110021101\r\nActual: 2110021102\r\n ↑ (pos 10)

https://orleans.visualstudio.com/Orleans/Orleans%20Team/_TestManagement/Runs#_a=resultSummary&runId=3341&resultId=101222
>Assert.Equal() Failure\r\n ↓ (pos 10)\r\nExpected: 2120021201\r\nActual: 2120021202\r\n ↑ (pos 10)","TestMultiClusterConf_3_3 fails intermittently TestMultiClusterConf_3_3 has been failing intermittently for some time now. I submitted #3928 to skip it for now. This issue is to remember to investigate it.

https://orleans.visualstudio.com/Orleans/Orleans%20Team/_TestManagement/Runs#_a=resultSummary&runId=3414&resultId=101084
>Assert.Equal() Failure\r\n ↓ (pos 10)\r\nExpected: 2110021101\r\nActual: 2110021102\r\n ↑ (pos 10)

https://orleans.visualstudio.com/Orleans/Orleans%20Team/_TestManagement/Runs?_a=resultSummary&runId=3397&resultId=101169
>Assert.Equal() Failure\r\n ↓ (pos 10)\r\nExpected: 2110021101\r\nActual: 2110021102\r\n ↑ (pos 10)

https://orleans.visualstudio.com/Orleans/Orleans%20Team/_TestManagement/Runs#_a=resultSummary&runId=3341&resultId=101222
>Assert.Equal() Failure\r\n ↓ (pos 10)\r\nExpected: 2120021201\r\nActual: 2120021202\r\n ↑ (pos 10)",,sebastianburckhardt,,
3928,Skip TestMultiClusterConf_3_3,Skip TestMultiClusterConf_3_3 because it fails intermittently and needs to be investigated.,Skip TestMultiClusterConf_3_3 Skip TestMultiClusterConf_3_3 because it fails intermittently and needs to be investigated.,,xiazen,,
3927,Replaced AzureTableStorage storage provider with AzureTableGrainStorage.,"Moved the first provider  to the new extension pattern.

Split storage calls and initialization from IStorageProvider so usage patterns are independent of initialization.

IGrainStorage is the new grain storage abstraction.

IStorageProvider is supported for legacy storage providers and inherits from IGrainStorage and IProvider.

All grain storage logic now talks to IGrainStorage.

AzureTableStorage was replaced with AzureTableGrainStorage which no longer uses the provider pattern but instead uses DI and the silo lifecycle directly and is configured using options.
","Replaced AzureTableStorage storage provider with AzureTableGrainStorage. Moved the first provider  to the new extension pattern.

Split storage calls and initialization from IStorageProvider so usage patterns are independent of initialization.

IGrainStorage is the new grain storage abstraction.

IStorageProvider is supported for legacy storage providers and inherits from IGrainStorage and IProvider.

All grain storage logic now talks to IGrainStorage.

AzureTableStorage was replaced with AzureTableGrainStorage which no longer uses the provider pattern but instead uses DI and the silo lifecycle directly and is configured using options.
",,ReubenBond,,
3926,Remove Newtonsoft.JSON Dependency from core abstractions,Per https://github.com/dotnet/orleans/issues/3913,Remove Newtonsoft.JSON Dependency from core abstractions Per https://github.com/dotnet/orleans/issues/3913,,ReubenBond,,
3925,Error starting orleans beta 3 silo in .net core stateless service fabric,"I have a trivial set of .net core 2.0 orleans beta 3 interfaces/implementations . A local host silo works fine. When I use the .net core preview azure service fabric tools to create a stateless silo I get an unhandled exception error when starting.

https://gist.github.com/jamiemitchellconsultants/fa498a292f7342ee4f61d6b126848010","Error starting orleans beta 3 silo in .net core stateless service fabric I have a trivial set of .net core 2.0 orleans beta 3 interfaces/implementations . A local host silo works fine. When I use the .net core preview azure service fabric tools to create a stateless silo I get an unhandled exception error when starting.

https://gist.github.com/jamiemitchellconsultants/fa498a292f7342ee4f61d6b126848010",,ReubenBond,,
3924,I would like to ask each request to call Grain can be viewed in EventSourcing?,,"I would like to ask, each request to call Grain can be viewed in EventSourcing? ",question,sergeybykov,29/01/2018 20:59,31/01/2018 13:27
3922,When released 2.0 stable version?,When released 2.0 stable version?,When released 2.0 stable version? When released 2.0 stable version?,question,lfzm,29/01/2018 14:22,29/01/2018 20:57
3920,Sending an impl instead of the interface as parameter can fail silently,"I have a  

What happened was that I was getting InvalidOperationException in Orleans.dl-l>mscorlib.dll which was being swallowed and i only was getting a log message. 

This can be improved in two ways. More important is to throw it and let it crash (maybe if it doesn't break backward compatibility) and another is writing a Roslyn analyzer which checks you are only passing interfaces if there is no elegant way of preventing it altogether 

Today I got reminded of the type errors which we sometimes got in Erlang and actually felt great about Orleans after 3 hours of debugging","Sending an impl instead of the interface as parameter can fail silently I have a  

What happened was that I was getting InvalidOperationException in Orleans.dl-l>mscorlib.dll which was being swallowed and i only was getting a log message. 

This can be improved in two ways. More important is to throw it and let it crash (maybe if it doesn't break backward compatibility) and another is writing a Roslyn analyzer which checks you are only passing interfaces if there is no elegant way of preventing it altogether 

Today I got reminded of the type errors which we sometimes got in Erlang and actually felt great about Orleans after 3 hours of debugging",,ReubenBond,,
3919,Connection failed after restart client/silo in docker-deployment,"Error log:
> Unhandled Exception: System.AggregateException: One or more errors occurred. (The target silo became unavailable for message: Request *cli/b1d88196@02695dbc->S10.0.2.6:10400:0???/00000011@S00000011 #2: global::Orleans.Runtime.IClusterTypeManager:GetClusterTypeCodeMap(). Target History is: <S10.0.2.6:10400:0:???/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help.) ---> Orleans.Runtime.SiloUnavailableException: The target silo became unavailable for message: Request *cli/b1d88196@02695dbc->S10.0.2.6:10400:0???/00000011@S00000011 #2: global::Orleans.Runtime.IClusterTypeManager:GetClusterTypeCodeMap(). Target History is: <S10.0.2.6:10400:0:???/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help.

It happens sometimes when:
1. start silo then start client
2. silos are running and then restart clients.
and if those errors occurred **clients cannot connect to silos unless i restart silos.**

And:
If clients are running then restart silos
clients will mark silo dead and will not connect silo again
it's a faulty error because in [docker-deployment](https://github.com/dotnet/orleans/blob/master/Samples/Docker-Simple/Client/Program.cs) there's only one gateway endpoint. ","Connection failed after restart client/silo in docker-deployment Error log:
> Unhandled Exception: System.AggregateException: One or more errors occurred. (The target silo became unavailable for message: Request *cli/b1d88196@02695dbc->S10.0.2.6:10400:0???/00000011@S00000011 #2: global::Orleans.Runtime.IClusterTypeManager:GetClusterTypeCodeMap(). Target History is: <S10.0.2.6:10400:0:???/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help.) ---> Orleans.Runtime.SiloUnavailableException: The target silo became unavailable for message: Request *cli/b1d88196@02695dbc->S10.0.2.6:10400:0???/00000011@S00000011 #2: global::Orleans.Runtime.IClusterTypeManager:GetClusterTypeCodeMap(). Target History is: <S10.0.2.6:10400:0:???/00000011:@S00000011>. See https://aka.ms/orleans-troubleshooting for troubleshooting help.

It happens sometimes when:
1. start silo then start client
2. silos are running and then restart clients.
and if those errors occurred **clients cannot connect to silos unless i restart silos.**

And:
If clients are running then restart silos
clients will mark silo dead and will not connect silo again
it's a faulty error because in [docker-deployment](https://github.com/dotnet/orleans/blob/master/Samples/Docker-Simple/Client/Program.cs) there's only one gateway endpoint. ",,benjaminpetit,,
3916,Fix logger exceptions,"PR fixing the issue https://github.com/dotnet/orleans/issues/3909
Removed  some logging code seems to be left from testing
Test for big 1-dimensional array of primitive type serialization showing off the issue
","Fix logger exceptions PR fixing the issue https://github.com/dotnet/orleans/issues/3909
Removed  some logging code seems to be left from testing
Test for big 1-dimensional array of primitive type serialization showing off the issue
",,xiazen,,
3915,ADO.NET configuration methods naming (Sql -> AdoNet?),It appears the new Orleans ADO.NET related configuration methods use the term .,ADO.NET configuration methods naming (Sql -> AdoNet?) It appears the new Orleans ADO.NET related configuration methods use the term .,,sergeybykov,,
3913,Remove Orleans.Core.Abstractions Newtonsoft.Json Dependency,"Would it be possible to remove the Newtonsoft.Json dependency from Orleans.Core.Abstractions?
It appears to only be used here: https://github.com/dotnet/orleans/blob/f98bd17fa980160c348ff75a4e819d39ff740eb1/src/Orleans.Core.Abstractions/IDs/UniqueIdentifier.cs#L10

I am sharing some classes that use Orleans attributes with a Unity project. I am able to add the dependency in Unity but it causes an error message on startup. It doesn't actually break anything so this isn't a high priority but it would be nice to clean it up.","Remove Orleans.Core.Abstractions Newtonsoft.Json Dependency Would it be possible to remove the Newtonsoft.Json dependency from Orleans.Core.Abstractions?
It appears to only be used here: https://github.com/dotnet/orleans/blob/f98bd17fa980160c348ff75a4e819d39ff740eb1/src/Orleans.Core.Abstractions/IDs/UniqueIdentifier.cs#L10

I am sharing some classes that use Orleans attributes with a Unity project. I am able to add the dependency in Unity but it causes an error message on startup. It doesn't actually break anything so this isn't a high priority but it would be nice to clean it up.",,ReubenBond,,
3912,Update activation GC page,Updated activation GC page to document and emphasize programmatic configuration and hopefully for better clarity.,Update activation GC page Updated activation GC page to document and emphasize programmatic configuration and hopefully for better clarity.,documentation,ReubenBond,,
3911,Odd virtual methods in Grain class,"Why following methods are virtual:
- RegisterTimer
- RegisterOrUpdateReminder
- UnregisterReminder
- GetReminder
- GetReminders
- GetStreamProvider
- DeactivateOnIdle
- DelayDeactivation
- GetLogger
- Participate

Those are considered to be called by consumers not by Orleans (like . IMHO it might be better to seal them to not confuse developers.

If this was done for unit-testing (mocking) purposes this now seems unnecessary as all mocking could be done against IGrainRuntime.XXX. ","Odd virtual methods in Grain class Why following methods are virtual:
- RegisterTimer
- RegisterOrUpdateReminder
- UnregisterReminder
- GetReminder
- GetReminders
- GetStreamProvider
- DeactivateOnIdle
- DelayDeactivation
- GetLogger
- Participate

Those are considered to be called by consumers not by Orleans (like . IMHO it might be better to seal them to not confuse developers.

If this was done for unit-testing (mocking) purposes this now seems unnecessary as all mocking could be done against IGrainRuntime.XXX. ",,sergeybykov,,
3910,[Proposal] New codegen hint,The functional way (style) for doing communication is via messages which in C# are usually implemented by classes. Currently Orleans codegen can only generate serializers for class if it's marked with ). Having this ability will save 1 line of code per each message definition and will make them more compact. ,[Proposal] New codegen hint The functional way (style) for doing communication is via messages which in C# are usually implemented by classes. Currently Orleans codegen can only generate serializers for class if it's marked with ). Having this ability will save 1 line of code per each message definition and will make them more compact. ,,ReubenBond,,
3909,Microsoft.Extensions.Logging issue,"Seems that from v2 release of Microsoft.Extensions.Logging the way of providing messages templates to logger.Log* functions became more suitable for structured/semantic logging.
https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging/?tabs=aspnetcore2x#log-message-template
However Orleans still uses the 'string.Format' style of generating messages. In comparison to M.E.L proposed way of naming variables it just hides the possibility to implement custom log providers to have more intuitive/straightforward extraction of key/value pairs of important variables.
Moreover in case of line https://github.com/dotnet/orleans/blob/master/src/Orleans.Core/Serialization/SerializationManager.cs#L747   the old code leads to a bug. Calling this ( case of serializing non-immutable 1dim arrays of primitive types ) throws a 

do not mind the NLog here had this exceptiong on office pc using regular M.E.L.Console
","Microsoft.Extensions.Logging issue Seems that from v2 release of Microsoft.Extensions.Logging the way of providing messages templates to logger.Log* functions became more suitable for structured/semantic logging.
https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging/?tabs=aspnetcore2x#log-message-template
However Orleans still uses the 'string.Format' style of generating messages. In comparison to M.E.L proposed way of naming variables it just hides the possibility to implement custom log providers to have more intuitive/straightforward extraction of key/value pairs of important variables.
Moreover in case of line https://github.com/dotnet/orleans/blob/master/src/Orleans.Core/Serialization/SerializationManager.cs#L747   the old code leads to a bug. Calling this ( case of serializing non-immutable 1dim arrays of primitive types ) throws a 

do not mind the NLog here had this exceptiong on office pc using regular M.E.L.Console
",,xiazen,,
3906,【2.0.0-beta3】When the invalid Silo exists in Consul other SiloHost will be reported to be wrong in startup,"![tim 20180125183508](https://user-images.githubusercontent.com/8308243/35383995-e7ee81cc-01fe-11e8-8576-31ccf13c277a.png)
![tim 20180125183416](https://user-images.githubusercontent.com/8308243/35383999-ea87006c-01fe-11e8-9c01-2db504e1fee5.png)
","【2.0.0-beta3】When the invalid Silo exists in Consul, other SiloHost will be reported to be wrong in startup ![tim 20180125183508](https://user-images.githubusercontent.com/8308243/35383995-e7ee81cc-01fe-11e8-8576-31ccf13c277a.png)
![tim 20180125183416](https://user-images.githubusercontent.com/8308243/35383999-ea87006c-01fe-11e8-9c01-2db504e1fee5.png)
",question,sergeybykov,25/01/2018 21:38,5/02/2018 18:04
3905,Does orleans support permission verification or is there any way to achieve?,Does orleans support permission verification or is there any way to achieve?,"Does orleans support permission verification, or is there any way to achieve? Does orleans support permission verification or is there any way to achieve?",question,sergeybykov,25/01/2018 21:07,30/01/2018 14:09
3903,how to use IClusterClient ,"1.Create a static IClusterClient all use it. ex: static IClusterClient clusterClient = clusterClient.Connect().Wait();

2.or each client's method build a instance (IClusterClient clusterClient=IClientBuilder.Build() cost 0.5second)
then clusterClient.Connect()-> todo->clusterClient.Dispose()  
next time IClusterClient clusterClient=IClientBuilder.Build()  clusterClient.Connect()-> todo->clusterClient.Dispose()

Which one? or other?","how to use IClusterClient  1.Create a static IClusterClient all use it. ex: static IClusterClient clusterClient = clusterClient.Connect().Wait();

2.or each client's method build a instance (IClusterClient clusterClient=IClientBuilder.Build() cost 0.5second)
then clusterClient.Connect()-> todo->clusterClient.Dispose()  
next time IClusterClient clusterClient=IClientBuilder.Build()  clusterClient.Connect()-> todo->clusterClient.Dispose()

Which one? or other?",question,ReubenBond,25/01/2018 13:41,25/01/2018 17:23
3901,Move ClusterConfiguration to legacy,"Moved Cluster configuration to Orleans.Core.Legacy.
All references to it and related configuration classes have been removed from core Orleans packages.
Added a number of options to account for configuration data that had not been moved to options.
External packages and test libraries still rely on ClusterConfiguration and now depend on Orleans.Core.Legacy.  This can be cleaned up in future passes.","Move ClusterConfiguration to legacy Moved Cluster configuration to Orleans.Core.Legacy.
All references to it and related configuration classes have been removed from core Orleans packages.
Added a number of options to account for configuration data that had not been moved to options.
External packages and test libraries still rely on ClusterConfiguration and now depend on Orleans.Core.Legacy.  This can be cleaned up in future passes.",,sergeybykov,,
3900,Add IOptionFormatter and IOptionResolver interfaces,"- Add IOptionFormatter and IOptionResolver interfaces
- Add extension methods to provide better usability to configure option and option formatter together 
- Added option formatter for some options as a starting point

Didn't end up adding interface . SiloOptionsLogger subscribed to silo lifecycle and ClientOptionsLogger subscribed to client lifecycle 

","Add IOptionFormatter and IOptionResolver interfaces - Add IOptionFormatter and IOptionResolver interfaces
- Add extension methods to provide better usability to configure option and option formatter together 
- Added option formatter for some options as a starting point

Didn't end up adding interface . SiloOptionsLogger subscribed to silo lifecycle and ClientOptionsLogger subscribed to client lifecycle 

",,jason-bragg,,
3897,Add TelemetryOptions to configure Telemetry consumers,"I tested locally but unfortunately I don't have unit tests for this since it is a Windows specific features...

We should be able to add some testing in the future I think.","Add TelemetryOptions to configure Telemetry consumers I tested locally but unfortunately I don't have unit tests for this since it is a Windows specific features...

We should be able to add some testing in the future I think.",,jason-bragg,,
3889,[Question] Azure network configuration for Orleans in Service Fabric,"I try run Orleans in Serivce Fabric. I have error ""Invalid port specified"" on client.
My client is web application defined in App Service
Silos run on Service Fabric. 
How I should to define the azure network for orleans client and server? Thanks
","[Question] Azure network configuration for Orleans in Service Fabric I try run Orleans in Serivce Fabric. I have error ""Invalid port specified"" on client.
My client is web application defined in App Service
Silos run on Service Fabric. 
How I should to define the azure network for orleans client and server? Thanks
",,ReubenBond,,
3888,Silo to Silo Communication,"Hi we got a few questions regarding **silo to silo communication**. We have created an implementation using streams (SMS provider) and the communication works but we are facing a couple of issues with handling of subscriptions.

There are 2 different silos in this example: Silo A - the producer of the streaming events and Silo B - subscribes to these streams.
Below is a code sample for Silo B which demonstrates the usage with .
![Other solution](https://www.lucidchart.com/publicSegments/view/62f6062b-83a9-438f-83f8-925be3880d62/image.png)

We couldn't find any documentation describing approaches for silo-to-silo communication. Issue #1670 suggest communication over HTTP but will this be a viable solution? Some guidelines for best practices on this would be much appreciated. ","Silo to Silo Communication Hi we got a few questions regarding **silo to silo communication**. We have created an implementation using streams (SMS provider) and the communication works but we are facing a couple of issues with handling of subscriptions.

There are 2 different silos in this example: Silo A - the producer of the streaming events and Silo B - subscribes to these streams.
Below is a code sample for Silo B which demonstrates the usage with .
![Other solution](https://www.lucidchart.com/publicSegments/view/62f6062b-83a9-438f-83f8-925be3880d62/image.png)

We couldn't find any documentation describing approaches for silo-to-silo communication. Issue #1670 suggest communication over HTTP but will this be a viable solution? Some guidelines for best practices on this would be much appreciated. ",question,sergeybykov,22/01/2018 21:10,30/01/2018 3:00
3887,Replaced life cycle stage enums with constants,Lifecycle stage enums gave the impression that the stages were limited to only the defined enumes which was not the intention of the design.  They also necessitated the development and maintenance of extensions to support each enum.,Replaced life cycle stage enums with constants Lifecycle stage enums gave the impression that the stages were limited to only the defined enumes which was not the intention of the design.  They also necessitated the development and maintenance of extensions to support each enum.,,benjaminpetit,,
3885,2.0.0-ci.20180118.3 build breaks transactional state storage,"After updating to 2.0.0-ci.20180118.3  I now get 

Switching back to 2.0.0-ci.20180116.5 makes the error go away. I suspect it is related to this commit: https://github.com/dotnet/orleans/commit/9bd486bb7368a83a37b7565e2d267aed959e4df7","2.0.0-ci.20180118.3 build breaks transactional state storage After updating to 2.0.0-ci.20180118.3  I now get 

Switching back to 2.0.0-ci.20180116.5 makes the error go away. I suspect it is related to this commit: https://github.com/dotnet/orleans/commit/9bd486bb7368a83a37b7565e2d267aed959e4df7",,jason-bragg,,
3884, Updating Interceptors.md to include graincalls made from interceptors,Adding grain calls from interceptors as a useful use case., Updating Interceptors.md to include graincalls made from interceptors Adding grain calls from interceptors as a useful use case.,documentation,ReubenBond,,
3883,SerializationException under high load,"This issue tracks a non-root-caused issue whereby a SerializationException is thrown in the Message deserialization path usually during header deserialization when the system is under high load.

I don't know how to reproduce the issue.

**Example 1**



cc @sujesharukil who experienced this error [here](https://gitter.im/dotnet/orleans?at=5a544256290a1f456166ce91) [+here](https://gitter.im/dotnet/orleans?at=5a54341a0505ad8b45cf7192) [+here](https://gitter.im/dotnet/orleans?at=5a5430ef290a1f4561667f71)

Try reproducing with very large messages (> 500KB) and high concurrency (concurrent messages)","SerializationException under high load This issue tracks a non-root-caused issue whereby a SerializationException is thrown in the Message deserialization path usually during header deserialization when the system is under high load.

I don't know how to reproduce the issue.

**Example 1**



cc @sujesharukil who experienced this error [here](https://gitter.im/dotnet/orleans?at=5a544256290a1f456166ce91) [+here](https://gitter.im/dotnet/orleans?at=5a54341a0505ad8b45cf7192) [+here](https://gitter.im/dotnet/orleans?at=5a5430ef290a1f4561667f71)

Try reproducing with very large messages (> 500KB) and high concurrency (concurrent messages)",bug,ReubenBond,,
3882,[Question] - IExternalSerializer issue,"Just seeking some advice on how to get to the bottom of this problem.
I can see my custom serialiser is serialising my object on the client side and deserialising it on the server side.
I can see my grain is then activated on the server side.
However after activation my grain method on the server side is not actually invoked. The client instead reports an exception. I can't find anywhere to intercept this exception which I assume is happening on the server side but I am not sure. The stack trace isn't particularly hepful:

 for when orlenas asks it if it can serialise them. Because of this my serialiser only takes responsibility for serialising the types that I am interested in - I am assuming that this is ok because the fallback serialisation methods will handle those other types?

I guess I am just wondering how I go about diagnosing why the grain method isn;t being invoked - how can I get some more detailed information? Starting with whether the server is reporting the exception (as I suspect as it happens after grain activation) or whether it purely happening on the client side.

","[Question] - IExternalSerializer issue Just seeking some advice on how to get to the bottom of this problem.
I can see my custom serialiser is serialising my object on the client side and deserialising it on the server side.
I can see my grain is then activated on the server side.
However after activation my grain method on the server side is not actually invoked. The client instead reports an exception. I can't find anywhere to intercept this exception which I assume is happening on the server side but I am not sure. The stack trace isn't particularly hepful:

 for when orlenas asks it if it can serialise them. Because of this my serialiser only takes responsibility for serialising the types that I am interested in - I am assuming that this is ok because the fallback serialisation methods will handle those other types?

I guess I am just wondering how I go about diagnosing why the grain method isn;t being invoked - how can I get some more detailed information? Starting with whether the server is reporting the exception (as I suspect as it happens after grain activation) or whether it purely happening on the client side.

",,ReubenBond,,
3881,GrainClient OutOfMemoryException,"This is my Grain Client initialise code.  If it fails to connect to a gateway for long enough it runs out of memory.  Can someone help me identify why?

","GrainClient OutOfMemoryException This is my Grain Client initialise code.  If it fails to connect to a gateway for long enough it runs out of memory.  Can someone help me identify why?

",,benjaminpetit,,
3880,Build Time Code Generation on MacOS Failing 2.0.0-beta3,"When attempting to build a 2.0.0 project on MacOS Sierra we get the attached Msbuild error: https://i.imgur.com/ikpdTq1.png

The text if the image won't load is as follows:

The ""Orleans.CodeGeneration.GetDotNetHost"" task could not be loaded for the assembly '.../Orleans.CodeGeneration.Build.dll'. Could not resolve type with token 0100001e (from typeref class/assembly System.MarshalByRefObject System.Runtime Version=4.2.0.0 Culture=neutral....

It looks like that goes on to cause a ReflectionTypeLoadException in MSBuild.

","Build Time Code Generation on MacOS Failing 2.0.0-beta3 When attempting to build a 2.0.0 project on MacOS Sierra we get the attached Msbuild error: https://i.imgur.com/ikpdTq1.png

The text if the image won't load is as follows:

The ""Orleans.CodeGeneration.GetDotNetHost"" task could not be loaded for the assembly '.../Orleans.CodeGeneration.Build.dll'. Could not resolve type with token 0100001e (from typeref class/assembly System.MarshalByRefObject System.Runtime Version=4.2.0.0 Culture=neutral....

It looks like that goes on to cause a ReflectionTypeLoadException in MSBuild.

",P2,ReubenBond,,
3879,Blocked when trying to create QueueClient,"Hi Guys

    Recently we are facing a timeout: ""Response did not arrive on time in 00:01:00 for message""
 
    Here is the detailed of error:
   EventName=""MessageEvent"" Message=""[2018-01-17 07:43:15.900 GMT    15	ERROR  	101212	Runtime.Scheduler.WorkerPoolThread/0	10.96.138.81:11111]	!!!!!!!!!! Worker pool thread Runtime.Scheduler.WorkerPoolThread/0 (ManagedThreadId=16) has been busy for long time: Executing Task Id=1 Status=Running for 00:09:26.4995991 on WorkItem=WorkItemGroup:Name=[Activation: xxxx Placement=RandomPlacement]WorkGroupStatus=Running Executing for 00:09:26.4995991. WorkItemGroup Details: WorkItemGroup:Name=[Activation: Placement=RandomPlacement]WorkGroupStatus=Running. Currently QueuedWorkItems=2; Total EnQueued=7; Total processed=4; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-13:Queued=2; Detailed SchedulingContext=<[Activation:xxxx  Placement=RandomPlacement State=Valid NonReentrancyQueueSize=0 EnqueuedOnDispatcher=1 InFlightCount=0 NumRunning=0 IdlenessTimeSpan=00:09:39.5444282 CollectionAgeLimit=02:00:00]>.	"" TraceSource=""WaWorkerHost.exe""

     after add tracing we found that it's blocked at line of:
     QueueClient.CreateFromConnectionString(connectionString queueName)

     The strange is that it's only blocked when running in a cloud service while no block found if running locally. 

Here are the detailed info of the environment: 
Orleans: 1.2.3
WindowsAzure.ServiceBus: 3.2.2
<package id=""WindowsAzure.ServiceBus"" version=""3.2.2"" targetFramework=""net452"" />

is there any graceful way to resolve it?

Many Thanks","Blocked when trying to create QueueClient Hi Guys

    Recently we are facing a timeout: ""Response did not arrive on time in 00:01:00 for message""
 
    Here is the detailed of error:
   EventName=""MessageEvent"" Message=""[2018-01-17 07:43:15.900 GMT    15	ERROR  	101212	Runtime.Scheduler.WorkerPoolThread/0	10.96.138.81:11111]	!!!!!!!!!! Worker pool thread Runtime.Scheduler.WorkerPoolThread/0 (ManagedThreadId=16) has been busy for long time: Executing Task Id=1 Status=Running for 00:09:26.4995991 on WorkItem=WorkItemGroup:Name=[Activation: xxxx Placement=RandomPlacement]WorkGroupStatus=Running Executing for 00:09:26.4995991. WorkItemGroup Details: WorkItemGroup:Name=[Activation: Placement=RandomPlacement]WorkGroupStatus=Running. Currently QueuedWorkItems=2; Total EnQueued=7; Total processed=4; Quantum expirations=0; TaskRunner=ActivationTaskScheduler-13:Queued=2; Detailed SchedulingContext=<[Activation:xxxx  Placement=RandomPlacement State=Valid NonReentrancyQueueSize=0 EnqueuedOnDispatcher=1 InFlightCount=0 NumRunning=0 IdlenessTimeSpan=00:09:39.5444282 CollectionAgeLimit=02:00:00]>.	"" TraceSource=""WaWorkerHost.exe""

     after add tracing we found that it's blocked at line of:
     QueueClient.CreateFromConnectionString(connectionString queueName)

     The strange is that it's only blocked when running in a cloud service while no block found if running locally. 

Here are the detailed info of the environment: 
Orleans: 1.2.3
WindowsAzure.ServiceBus: 3.2.2
<package id=""WindowsAzure.ServiceBus"" version=""3.2.2"" targetFramework=""net452"" />

is there any graceful way to resolve it?

Many Thanks",,xiazen,,
3877,[Question] What is the suggested pattern to use and query multiple unique keys in a single Grain?,"Lets say I have a simple Grain for an user account that stores data like this:

For every user:
- UserID
- Name
- Email

Now lets say I want to be able to do all of this:

1. Get Name from UserID
2. Get UserID from Name
3. Get Name and/or ID from Email Addr

Now what is the best approach here to store the data in a scalable way (not a single grain for all users) gaurantee each Fields uniqueness and also be able to query them using Orleans?

I assume it's not possible with Orleans by itself unless I make multiple mapping Grains that are shitty to maintain and require data duplications but what would be the suggested way to implement this functionalty?
","[Question] What is the suggested pattern to use and query multiple unique keys in a single Grain? Lets say I have a simple Grain for an user account that stores data like this:

For every user:
- UserID
- Name
- Email

Now lets say I want to be able to do all of this:

1. Get Name from UserID
2. Get UserID from Name
3. Get Name and/or ID from Email Addr

Now what is the best approach here to store the data in a scalable way (not a single grain for all users) gaurantee each Fields uniqueness and also be able to query them using Orleans?

I assume it's not possible with Orleans by itself unless I make multiple mapping Grains that are shitty to maintain and require data duplications but what would be the suggested way to implement this functionalty?
",question,sergeybykov,17/01/2018 16:41,31/01/2018 16:04
3876,Deserialiser issue: Message: System.TypeAccessException ,"I am using latest beta packages running on netcoreapp2.0 targeting netstandard2.0

I am having an issue implementing an  in test explorer window and click ""Debug Selected Test""


On the client side I can step through my custom serialiser and it seems to be serialising the object fine.

On the server side I can't see deserialising happening.

I then get the above error :-(

Any pointers greatly appreciated!","Deserialiser issue: Message: System.TypeAccessException  I am using latest beta packages running on netcoreapp2.0 targeting netstandard2.0

I am having an issue implementing an  in test explorer window and click ""Debug Selected Test""


On the client side I can step through my custom serialiser and it seems to be serialising the object fine.

On the server side I can't see deserialising happening.

I then get the above error :-(

Any pointers greatly appreciated!",question,ReubenBond,,
3874,Custom serializer and Stream,"I am attempting to write a custom serialiser based on CSLA's serialiser here:

https://github.com/MarimerLLC/csla/blob/0041bc665942aa7e3a4a546adde6e5f8ad715aab/Source/Csla.Shared/Serialization/Mobile/MobileFormatter.cs

Most serialiser implementations support deserializing from a 

I am assuming this will essentially make a copy of the data? I am worried about performance of that.

Many Thanks","Custom serializer and Stream I am attempting to write a custom serialiser based on CSLA's serialiser here:

https://github.com/MarimerLLC/csla/blob/0041bc665942aa7e3a4a546adde6e5f8ad715aab/Source/Csla.Shared/Serialization/Mobile/MobileFormatter.cs

Most serialiser implementations support deserializing from a 

I am assuming this will essentially make a copy of the data? I am worried about performance of that.

Many Thanks",question,ReubenBond,,
3866,Documentation clarification,"[The DI page](https://dotnet.github.io/orleans/Documentation/Advanced-Concepts/Dependency-Injection.html) says this

> However Orleans supports every container dependent injection mechanisms one of the most commonly used method is constructor injection.

I think what was intended was something like this

> Orleans supports every container-dependent injection mechanism but one of the most commonly used methods is constructor injection shown here.

If I'm correct I think the sentence should be replaced as it is neither grammatical nor clear","Documentation clarification [The DI page](https://dotnet.github.io/orleans/Documentation/Advanced-Concepts/Dependency-Injection.html) says this

> However Orleans supports every container dependent injection mechanisms one of the most commonly used method is constructor injection.

I think what was intended was something like this

> Orleans supports every container-dependent injection mechanism but one of the most commonly used methods is constructor injection shown here.

If I'm correct I think the sentence should be replaced as it is neither grammatical nor clear",documentation,sergeybykov,16/01/2018 6:57,
3865,Improve and fix ADO.NET configuration documentation,"The ADO.NET documentation should be both fixed and improved.

- There is a problem described at https://github.com/dotnet/orleans/issues/3862.
- The documentation should also be clear that one ought to consider schemas and filegroups in a production application.

Cross-referenging https://github.com/dotnet/orleans/issues/3864.","Improve and fix ADO.NET configuration documentation The ADO.NET documentation should be both fixed and improved.

- There is a problem described at https://github.com/dotnet/orleans/issues/3862.
- The documentation should also be clear that one ought to consider schemas and filegroups in a production application.

Cross-referenging https://github.com/dotnet/orleans/issues/3864.",documentation,sergeybykov,16/01/2018 4:40,
3863,DeploymentLoadPublisher implications of reducing inteval,"

Would be great with a documented API in the code so that one could understand in the IDE what a setting affects.","DeploymentLoadPublisher implications of reducing inteval 

Would be great with a documented API in the code so that one could understand in the IDE what a setting affects.",question,sergeybykov,15/01/2018 7:10,18/01/2018 4:10
3859,Grain.InvokeException being reported as a Warning?,"why is Grain.InvokeException being reported as a Warning?

When tracking down a problem especially a problem with a stream message we get a Warning in the logs when an exception occurs.

Exception during Grain method call of message: Request S172.18.124.51:11111:253489437*cli/b116d8b2@db94af81->S172.18.124.53:11111:253489427*grn/3159BD7A/00000000+STRING_IDENT@069db998 #24: global::Rb.ReactivePrototype.PhoneGrainInterfaces.IPhoneGrain:PhoneGrainInviteReceived()


https://github.com/dotnet/orleans/blob/b0d7edfdb148614b1210cf37e0c0d555dc68b6c7/src/Orleans.Runtime/Core/InsideRuntimeClient.cs#L382



obviously we dont want to re-throw the exception but it would be nice to have it reported as an Error.   Was this intention?
","Grain.InvokeException being reported as a Warning? why is Grain.InvokeException being reported as a Warning?

When tracking down a problem especially a problem with a stream message we get a Warning in the logs when an exception occurs.

Exception during Grain method call of message: Request S172.18.124.51:11111:253489437*cli/b116d8b2@db94af81->S172.18.124.53:11111:253489427*grn/3159BD7A/00000000+STRING_IDENT@069db998 #24: global::Rb.ReactivePrototype.PhoneGrainInterfaces.IPhoneGrain:PhoneGrainInviteReceived()


https://github.com/dotnet/orleans/blob/b0d7edfdb148614b1210cf37e0c0d555dc68b6c7/src/Orleans.Runtime/Core/InsideRuntimeClient.cs#L382



obviously we dont want to re-throw the exception but it would be nice to have it reported as an Error.   Was this intention?
",question,sergeybykov,13/01/2018 12:32,31/01/2018 12:34
3858,Move some streaming related helpers in abstractions,While they are not really abstractions they are used by Grain project and it would be a pity to add a dependency on Core just for this helper functions...,Move some streaming related helpers in abstractions While they are not really abstractions they are used by Grain project and it would be a pity to add a dependency on Core just for this helper functions...,,jason-bragg,,
3853,Add OrleansJsonSerializer to external serializers causes circular references,"OrleansJsonSerializer's constructor:
","Add OrleansJsonSerializer to external serializers causes circular references OrleansJsonSerializer's constructor:
",,ReubenBond,,
3852,Display grain type name in GrainId.ToString(),Right now when a  are logged. It could be useful to log the grain implementation name used instead.,Display grain type name in GrainId.ToString() Right now when a  are logged. It could be useful to log the grain implementation name used instead.,enhancement,benjaminpetit,11/01/2018 10:58,
3851,Add StreamSubscriptionHandleFactory to subscribe onbehalf feature,"subscribe on behalf feature has a bug in it which makes it unusable. The cause of the bug is in streaming infra stream type is not parsed correctly to  which requires user to give that type information as a way to fix that bug. 

There were other solutions discussed for this bug  but they all require more engineer hours. Based on the team's current capacity this seems to be the best way ATM to fix it. ","Add StreamSubscriptionHandleFactory to subscribe onbehalf feature subscribe on behalf feature has a bug in it which makes it unusable. The cause of the bug is in streaming infra stream type is not parsed correctly to  which requires user to give that type information as a way to fix that bug. 

There were other solutions discussed for this bug  but they all require more engineer hours. Based on the team's current capacity this seems to be the best way ATM to fix it. ",,jason-bragg,,
3850,Process Response messages before Request messages,"Currently response messages and request messages are both treated equally by .

For improving call latency on hot grains it might be beneficial to process response messages with higher priority than request messages.","Process Response messages before Request messages Currently response messages and request messages are both treated equally by .

For improving call latency on hot grains it might be beneficial to process response messages with higher priority than request messages.",performance,ReubenBond,11/01/2018 10:44,
3849,Display GrainId/type of SystemGrain and SystemTarget in GrainId.ToStringImpl,Related to #3844 ,Display GrainId/type of SystemGrain and SystemTarget in GrainId.ToStringImpl Related to #3844 ,,ReubenBond,,
3848,[Question] Streams limitations lots of subscribe/unsubscribes,"I'm trying to use orleans streams to manage channel subscriptions in a websocket server. What happens is when sockets are connected the server will ask a grain to give back a stream Id. The socket server (orleans client) then creates a subscription to that stream. Now these are a lot of subscriptions/unsubscriptions and when the numbers grow I start to receive lots of exceptions on the client side when adding a message to the stream. SerializationExceptions to be exact.

Now my question is does the runtime sends a message from the silo for each subscription on the client side or one message will be sent to the client and then the client forwards it to all local subscribers?
And on the broader sense is using streams in this way a good choice for this scenario?

_I'm using SMS provider with fire and forget and a memory storage provider for pubsubstore._

Things I've already tried to find the cause:
- Made stream messages Immutable. This was actually the way it was from the beginning this leads to NullReferenceExceptions which made me think maybe the message is disposed (well not technically speaking).
- Added ILBasedSerializer for fallback serializer. No help to get the actual exception message.","[Question] Streams limitations, lots of subscribe/unsubscribes I'm trying to use orleans streams to manage channel subscriptions in a websocket server. What happens is when sockets are connected the server will ask a grain to give back a stream Id. The socket server (orleans client) then creates a subscription to that stream. Now these are a lot of subscriptions/unsubscriptions and when the numbers grow I start to receive lots of exceptions on the client side when adding a message to the stream. SerializationExceptions to be exact.

Now my question is does the runtime sends a message from the silo for each subscription on the client side or one message will be sent to the client and then the client forwards it to all local subscribers?
And on the broader sense is using streams in this way a good choice for this scenario?

_I'm using SMS provider with fire and forget and a memory storage provider for pubsubstore._

Things I've already tried to find the cause:
- Made stream messages Immutable. This was actually the way it was from the beginning this leads to NullReferenceExceptions which made me think maybe the message is disposed (well not technically speaking).
- Added ILBasedSerializer for fallback serializer. No help to get the actual exception message.",,xiazen,,
3847,Dependency Injection in ASP.NET Core,Hi there .. for orleans 2.0 what I should register to IServiceCollection? ClientBuilder? what will be its lifetimes? Transient or Scoped or Singleton? Thanks for help.,Dependency Injection in ASP.NET Core Hi there .. for orleans 2.0 what I should register to IServiceCollection? ClientBuilder? what will be its lifetimes? Transient or Scoped or Singleton? Thanks for help.,question,ReubenBond,10/01/2018 22:04,11/01/2018 13:31
3846,A fsharp sample for .net core based on orleans 2.0,This PRs is reated to issue #3845. It is a fsharp sample for .net core. Thanks to @ReubenBond for his help.,"A fsharp sample for .net core, based on orleans 2.0 This PRs is reated to issue #3845. It is a fsharp sample for .net core. Thanks to @ReubenBond for his help.",,ReubenBond,,
3845,New samples for fsharp based on version 2,"Hi there

can we have a new sample for fsharp which based on version 2? thanks :)
  ","New samples for fsharp based on version 2 Hi there

can we have a new sample for fsharp which based on version 2? thanks :)
  ",,ReubenBond,,
3844,Resolve code omitted by ABSTRACTIONS_TODO,"https://github.com/dotnet/orleans/blob/a132a5acaf74ceb233fdf08ba497f384ce1c95ff/src/Orleans.Core.Abstractions/IDs/GrainId.cs#L219

https://github.com/dotnet/orleans/blob/a132a5acaf74ceb233fdf08ba497f384ce1c95ff/src/Orleans.Core.Abstractions/IDs/GrainId.cs#L253

SystemTargets are showing up in logs with with ","Resolve code omitted by ABSTRACTIONS_TODO https://github.com/dotnet/orleans/blob/a132a5acaf74ceb233fdf08ba497f384ce1c95ff/src/Orleans.Core.Abstractions/IDs/GrainId.cs#L219

https://github.com/dotnet/orleans/blob/a132a5acaf74ceb233fdf08ba497f384ce1c95ff/src/Orleans.Core.Abstractions/IDs/GrainId.cs#L253

SystemTargets are showing up in logs with with ",,benjaminpetit,,
3841,How to create a reader-writer grain with parallel reads,"I'm facing an issue similar to what is discussed (but not resolved) in #1468. Basically I need a reader-writer grain(s?) to hold some values so other parts of the system can reference them frequently and in parallel.

What I'm after is storing some system-wide config values which are accessed frequently and subject to change but only *extremely* rarely (once a month or so at most). The system should be reconfigurable without downtime. What I'm currently considering is to store the data in some database. Then it will be read at silo startup and there will be a special callback to read the data again after it changes externally. I don't want to read the data from the database every time I need it because:

1. It'll create unnecessary processing overhead inside the silo as some of the data must be processed and filtered out.
2. It'll increase load on the database which I cannot guarantee will be as good at handling high load as the silo environment.
3. The data is verified by the silo environment before it is updated. Reading directly from the database means there will be no middle layer to hold the last known valid data while the operator updates and fixes the new data.

I can easily create a reader-writer locked in-memory data store but Orleans' single-threaded execution policy doesn't allow parallel access to the grain that holds the data. I can think of the following ways to bypass this:

1. Have multiple copies of the data inside multiple grains. This is obviously not optimal.
2. Use static fields to store the data and make the grain a stateless worker. This means every silo has its own copy of the data (which also helps with reducing network load) but there is no means of asking every *silo* to update its copy of the data (that I know of at least).

Suggestions?
  ","How to create a reader-writer grain with parallel reads I'm facing an issue similar to what is discussed (but not resolved) in #1468. Basically I need a reader-writer grain(s?) to hold some values so other parts of the system can reference them frequently and in parallel.

What I'm after is storing some system-wide config values which are accessed frequently and subject to change but only *extremely* rarely (once a month or so at most). The system should be reconfigurable without downtime. What I'm currently considering is to store the data in some database. Then it will be read at silo startup and there will be a special callback to read the data again after it changes externally. I don't want to read the data from the database every time I need it because:

1. It'll create unnecessary processing overhead inside the silo as some of the data must be processed and filtered out.
2. It'll increase load on the database which I cannot guarantee will be as good at handling high load as the silo environment.
3. The data is verified by the silo environment before it is updated. Reading directly from the database means there will be no middle layer to hold the last known valid data while the operator updates and fixes the new data.

I can easily create a reader-writer locked in-memory data store but Orleans' single-threaded execution policy doesn't allow parallel access to the grain that holds the data. I can think of the following ways to bypass this:

1. Have multiple copies of the data inside multiple grains. This is obviously not optimal.
2. Use static fields to store the data and make the grain a stateless worker. This means every silo has its own copy of the data (which also helps with reducing network load) but there is no means of asking every *silo* to update its copy of the data (that I know of at least).

Suggestions?
  ",question,rikbosch,8/01/2018 17:35,31/01/2018 12:32
3840,ClientInvokeCallback for grain to grain call in Orleans 1.5.3,I am migrating project from Orleans 1.4.2 to 1.5.3 and faced with issue set ClientInvokeCallback inside Silo. We are using ClientInvokeCallback/IGrainCallFilter(IProviderRuntime.SetInvokeInterceptor in 1.4.2) for propagate log correlation id between http frontend -> grain and grain to grain call but looks like in Orleans v1.5.3 it is not possible anymore set ClientInvokeCallback inside Silo as GrainClient uses directly OutsideRuntimeClient class (and guard which checks client initialization was added). What is proper way to add ClientInvokeCallback for grain to grain call inside Silo? or something other should be used for the same purpose?,ClientInvokeCallback for grain to grain call in Orleans 1.5.3 I am migrating project from Orleans 1.4.2 to 1.5.3 and faced with issue set ClientInvokeCallback inside Silo. We are using ClientInvokeCallback/IGrainCallFilter(IProviderRuntime.SetInvokeInterceptor in 1.4.2) for propagate log correlation id between http frontend -> grain and grain to grain call but looks like in Orleans v1.5.3 it is not possible anymore set ClientInvokeCallback inside Silo as GrainClient uses directly OutsideRuntimeClient class (and guard which checks client initialization was added). What is proper way to add ClientInvokeCallback for grain to grain call inside Silo? or something other should be used for the same purpose?,,ReubenBond,,
3839,Docs: missing lifetime info about client,"Regarding: http://dotnet.github.io/orleans/Documentation/Getting-Started-With-Orleans/Developing-a-Client.html

It would be nice with a couple of notes of recommended lifetime scope of clients for different environments e.g. web.

Also would be nice with information about what happens if the socket goes down after some requests? Will it auto-reconnect?","Docs: missing lifetime info about client Regarding: http://dotnet.github.io/orleans/Documentation/Getting-Started-With-Orleans/Developing-a-Client.html

It would be nice with a couple of notes of recommended lifetime scope of clients for different environments e.g. web.

Also would be nice with information about what happens if the socket goes down after some requests? Will it auto-reconnect?",documentation,sergeybykov,7/01/2018 21:53,
3838,Use e.g. extension methods on config to make it more obvious,"Was trying to find good info about configuration e.g. on how to turn trace logging and statistics off. Found this: http://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Configuration-Guide/Client-Configuration.html

Which says: 

","Use e.g. extension methods on config to make it more obvious Was trying to find good info about configuration e.g. on how to turn trace logging and statistics off. Found this: http://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Configuration-Guide/Client-Configuration.html

Which says: 

",,xiazen,,
3837,Docs and logs inconsistent,"Docs (http://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Configuration-Guide/Configuring-.NET-Garbage-Collection.html) says GC should be configured:



How should it be?","Docs and logs, inconsistent Docs (http://dotnet.github.io/orleans/Documentation/Deployment-and-Operations/Configuration-Guide/Configuring-.NET-Garbage-Collection.html) says GC should be configured:



How should it be?",,sergeybykov,,
3835,ClientConfiguration.LoadFromFile sync over async,Works like a charm when executing in a context where restoring on captured context isn't a problem (e.g. Console) but when switching to e.g. ASP.Net environment where bootstraping happens in a non async flow one might think that the exposed  is hard is not an option since that seem to violate the naming convention with other async methods.,"ClientConfiguration.LoadFromFile, sync over async Works like a charm when executing in a context where restoring on captured context isn't a problem (e.g. Console) but when switching to e.g. ASP.Net environment where bootstraping happens in a non async flow one might think that the exposed  is hard is not an option since that seem to violate the naming convention with other async methods.",,xiazen,,
3833,Remove dependency on Orleans.Runtime from most extension projects,"This address #198 although a bit indirectly.

With this change most extensions don't need to reference  is probably not the best name for this assembly/package but I couldn't come up with a better one.","Remove dependency on Orleans.Runtime from most extension projects This address #198 although a bit indirectly.

With this change most extensions don't need to reference  is probably not the best name for this assembly/package but I couldn't come up with a better one.",,ReubenBond,,
3832,ToGatewayUri will cause exception when using IPv6,"Orleans.Core\Utils\Utils.cs 
Method 
        **public static Uri ToGatewayUri(this System.Net.IPEndPoint ep)**
and         
        **public static Uri ToGatewayUri(this SiloAddress address)**
will generate UriFormatException exception when Address is the IPv6 format.

I think UriBuilder should fix the problem.
Code below:

        public static Uri ToGatewayUri(this System.Net.IPEndPoint ep)
        {
            var builder = new UriBuilder(""gwy.tcp"" ep.Address.ToString() ep.Port);
            return builder.Uri;
        }

        /// <summary>
        /// Represent a silo address in the gateway URI format.
        /// </summary>
        /// <param name=""address"">The input silo address</param>
        /// <returns></returns>
        public static Uri ToGatewayUri(this SiloAddress address)
        {
            var builder = new UriBuilder(""gwy.tcp"" address.Endpoint.Address.ToString() address.Endpoint.Port address.Generation.ToString());
            return builder.Uri;
        }","ToGatewayUri will cause exception when using IPv6 Orleans.Core\Utils\Utils.cs 
Method 
        **public static Uri ToGatewayUri(this System.Net.IPEndPoint ep)**
and         
        **public static Uri ToGatewayUri(this SiloAddress address)**
will generate UriFormatException exception when Address is the IPv6 format.

I think UriBuilder should fix the problem.
Code below:

        public static Uri ToGatewayUri(this System.Net.IPEndPoint ep)
        {
            var builder = new UriBuilder(""gwy.tcp"" ep.Address.ToString() ep.Port);
            return builder.Uri;
        }

        /// <summary>
        /// Represent a silo address in the gateway URI format.
        /// </summary>
        /// <param name=""address"">The input silo address</param>
        /// <returns></returns>
        public static Uri ToGatewayUri(this SiloAddress address)
        {
            var builder = new UriBuilder(""gwy.tcp"" address.Endpoint.Address.ToString() address.Endpoint.Port address.Generation.ToString());
            return builder.Uri;
        }",bug,sergeybykov,6/01/2018 8:03,31/01/2018 8:36
3831,Remove unnecessary dependencies on Orleans.Runtime from extension projects,With this change only .Clustering .Reminders and .Hosting extensions will have a dependency on Orleans.Runtime. Removing those requires a bigger change.,Remove unnecessary dependencies on Orleans.Runtime from extension projects With this change only .Clustering .Reminders and .Hosting extensions will have a dependency on Orleans.Runtime. Removing those requires a bigger change.,,benjaminpetit,,
3830,Calling grain method using GrainClient hangs after running for some time,"I am using ASP.NET and I have a controller method uses 

Oddly enough this exception doesnt seem to bubble up through ASP.NET and make the call fail.","Calling grain method using GrainClient hangs after running for some time I am using ASP.NET and I have a controller method uses 

Oddly enough this exception doesnt seem to bubble up through ASP.NET and make the call fail.",,benjaminpetit,,
19814,Local test run experience is systematically degrading,"Observing recent changes to the test run infrastructure I have been impacted by the following problems:

1. Test run startup is painfully slow
    1. Python script runs very slow and seems to be very inefficient (it may take up to 2 - 3 min before actual tests start
    2. Test discovery after CoreRun is launched takes ad infinitum in comparison to experience from before couple of weeks

2. Test run info:
    1. Std out info is polluted with multiple error messages from python script
    2. There is no summary table after test run if tests fail - it was possible so far to see breakdown of failing tests per XUnit wrapper

","Local test run experience is systematically degrading Observing recent changes to the test run infrastructure I have been impacted by the following problems:

1. Test run startup is painfully slow
    1. Python script runs very slow and seems to be very inefficient (it may take up to 2 - 3 min before actual tests start
    2. Test discovery after CoreRun is launched takes ad infinitum in comparison to experience from before couple of weeks

2. Test run info:
    1. Std out info is polluted with multiple error messages from python script
    2. There is no summary table after test run if tests fail - it was possible so far to see breakdown of failing tests per XUnit wrapper

",area-Infrastructure-coreclr,jkotas,4/09/2018 8:09,
19812,Fix ICU load on OpenSUSE Tumbleweed,"For some reason OpenSUSE Tumbleweed has decided to prefix the
version number in the SO name of the ICU libraries by ""suse"".
That prevents our ICU version detection code from working.

This change adds scanning for SO names that contain that prefix too.","Fix ICU load on OpenSUSE Tumbleweed For some reason OpenSUSE Tumbleweed has decided to prefix the
version number in the SO name of the ICU libraries by ""suse"".
That prevents our ICU version detection code from working.

This change adds scanning for SO names that contain that prefix too.",area-System.Globalization,janvorli,,
19810,Allow StructLayoutAttribute to specify automatic size rounding up to next power of 2 for better perf,"One of the uses is - say there is raw buffer allocated for N instances of structure which may contain generic fields say constrained with .

In my somewhat skewed benchmarks manually rounding up structure sizes shows execution time improvement up to x1.5-2.","Allow StructLayoutAttribute to specify automatic size rounding up to next power of 2 for better perf One of the uses is - say there is raw buffer allocated for N instances of structure which may contain generic fields say constrained with .

In my somewhat skewed benchmarks manually rounding up structure sizes shows execution time improvement up to x1.5-2.",area-TypeSystem,jkotas,4/09/2018 4:29,
19807,Missing IL offset information sometimes causes bad stack traces,"The repro is here: [https://github.com/evgrud/dotnet-stack-trace-offsets-issue](https://github.com/evgrud/dotnet-stack-trace-offsets-issue)

When running it on Release (with tiered compilation disabled) you will see that the stack trace of the exception that is thrown points to the beginning of the function while the correct location is at its end.

I tested it on Windows 10 x64.

I ran it with JITDump and it seems that during  some of the statements aren't getting IL offsets which later during the inlining are expanded into new basic blocks without IL offsets which eventually during runtime results in a bad stack trace when an exception is thrown within those basic blocks.

I don't know if this issue should be fixed but I can suggest reporting native offsets in those cases instead of pointing to the top of the function which could be way off.

category:implementation
theme:debug-info
skill-level:intermediate
cost:small","Missing IL offset information sometimes causes bad stack traces The repro is here: [https://github.com/evgrud/dotnet-stack-trace-offsets-issue](https://github.com/evgrud/dotnet-stack-trace-offsets-issue)

When running it on Release (with tiered compilation disabled) you will see that the stack trace of the exception that is thrown points to the beginning of the function while the correct location is at its end.

I tested it on Windows 10 x64.

I ran it with JITDump and it seems that during  some of the statements aren't getting IL offsets which later during the inlining are expanded into new basic blocks without IL offsets which eventually during runtime results in a bad stack trace when an exception is thrown within those basic blocks.

I don't know if this issue should be fixed but I can suggest reporting native offsets in those cases instead of pointing to the top of the function which could be way off.

category:implementation
theme:debug-info
skill-level:intermediate
cost:small",area-CodeGen,AndyAyersMS,,
19806,Not consistent integer remainder behavior at the corner case,"The remainder operator under consideration is the [% operator](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/expressions#remainder-operator)

The corner case is the following:
- the left operand equals  into zero (against the spec) and .NET doesn't mirror that behavior yet.","Not consistent integer remainder behavior at the corner case The remainder operator under consideration is the [% operator](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/expressions#remainder-operator)

The corner case is the following:
- the left operand equals  into zero (against the spec) and .NET doesn't mirror that behavior yet.",tracking-external-issue,jkotas,3/09/2018 6:36,3/09/2018 15:35
19805,[arm64|Unix] segmentation fault when running any test,"Stack trace below.

","[arm64|Unix] segmentation fault when running any test Stack trace below.

",arch-arm64,jashook,,
19804,Clean CodeGen::genEmitCall,"This PR cleans ).

Also it refactors their code a bit and extracts common parts into platform independent methods.

Found during my work on #19361.

No diffs on x86/x64.","Clean CodeGen::genEmitCall This PR cleans ).

Also it refactors their code a bit and extracts common parts into platform independent methods.

Found during my work on #19361.

No diffs on x86/x64.",area-CodeGen,sandreenko,2/09/2018 5:31,7/09/2018 9:03
19778,Add 2.2 sdk/runtime to JitBench,,Add 2.2 sdk/runtime to JitBench ,area-TieredCompilation,kouvel,31/08/2018 9:25,19/09/2018 20:29
19777,[local gc] Enable gc_profiling for local gc,Fix for #11515. It turns out most of the work had been done previously and my recent PR (#19500 ) did the remaining work. So all that was left was to re-enable the definition of  for local gc,[local gc] Enable gc_profiling for local gc Fix for #11515. It turns out most of the work had been done previously and my recent PR (#19500 ) did the remaining work. So all that was left was to re-enable the definition of  for local gc,area-GC,davmason,,
19776,[release/2.2] Change prerelease label to be more accurate,Not critical but better than servicing,[release/2.2] Change prerelease label to be more accurate Not critical but better than servicing,,weshaggard,,
19774,[local gc]  move DacNotifyGCMarkEnd and AnalyzeSurvivorsRequested to GCToEEInterface ,Fix for #17771,[local gc]  move DacNotifyGCMarkEnd and AnalyzeSurvivorsRequested to GCToEEInterface  Fix for #17771,area-GC,davmason,,
19773,Add short guide for using tiered compilation and how to provide feedback,,Add short guide for using tiered compilation and how to provide feedback ,area-TieredCompilation,kouvel,,
19770,Fix CoreCLR debug launch,,Fix CoreCLR debug launch ,,mikem8361,,
19769,Build error: MSB4018: System.Exception: The package ID 'runtime.gentoo.-x64.Microsoft.NETCore.Runtime.CoreCLR' contains invalid characters. Examples of valid package IDs include 'MyPackage' and 'MyPackage.Sample'. [/var/tmp/dotnet/source-build/src/coreclr/src/.nuget/Microsoft.NETCore.Runtime.CoreCLR/Microsoft.NETCore.Runtime.CoreCLR.pkgproj],"I'm trying to build Dotnet from the release/2.2 branch on a Gentoo box but run into issues. I'm not (yet) familiar with your project structure please tell me if I'm doing something wrong or reporting this in the wrong place. For what it's worth I observe nearly identical errors with the 2.1 branch.

To avoid errors caused by stale Nuget files HOME is set to an empty directory. The top-level directory is a clean checkout of the current :
 <https://gist.github.com/eroen/d48f0c139e00198a6cb0ef728d4ac3cb>","Build error: MSB4018: System.Exception: The package ID 'runtime.gentoo.-x64.Microsoft.NETCore.Runtime.CoreCLR' contains invalid characters. Examples of valid package IDs include 'MyPackage' and 'MyPackage.Sample'. [/var/tmp/dotnet/source-build/src/coreclr/src/.nuget/Microsoft.NETCore.Runtime.CoreCLR/Microsoft.NETCore.Runtime.CoreCLR.pkgproj] I'm trying to build Dotnet from the release/2.2 branch on a Gentoo box but run into issues. I'm not (yet) familiar with your project structure please tell me if I'm doing something wrong or reporting this in the wrong place. For what it's worth I observe nearly identical errors with the 2.1 branch.

To avoid errors caused by stale Nuget files HOME is set to an empty directory. The top-level directory is a clean checkout of the current :
 <https://gist.github.com/eroen/d48f0c139e00198a6cb0ef728d4ac3cb>",area-Infrastructure-coreclr,jkotas,31/08/2018 5:11,22/06/2019 18:52
19766,Enable BSTR Marshaling Support for x-plat PInvoke,"Fix https://github.com/dotnet/coreclr/issues/19735

Workitem:
1. [Done]Enable BSTR Marshalling on PInvoke
2. [Done]Add more testing for BSTR PInvoke-- Windows compile/run OK
3. [Exclude] Test BSTR Pinvoke in Linux","Enable BSTR Marshaling Support for x-plat PInvoke Fix https://github.com/dotnet/coreclr/issues/19735

Workitem:
1. [Done]Enable BSTR Marshalling on PInvoke
2. [Done]Add more testing for BSTR PInvoke-- Windows compile/run OK
3. [Exclude] Test BSTR Pinvoke in Linux",area-Interop,luqunl,,
19764,[TieredCompilation] Hot method when inlined never reaches tier 1,"The problem arises in application processing data with one very hot method doing 9999% of the work which is inlined into cold method. Hot method never reaches tier1 compilation due to lack of tracking of it's pseudo calls and never gets optimized. The impact on application overall performance is 5 - 7 % performance regression.

Hot method cannot be prevented from inlining as this would cause much higher performance regression.","[TieredCompilation] Hot method when inlined never reaches tier 1 The problem arises in application processing data with one very hot method doing 9999% of the work which is inlined into cold method. Hot method never reaches tier1 compilation due to lack of tracking of it's pseudo calls and never gets optimized. The impact on application overall performance is 5 - 7 % performance regression.

Hot method cannot be prevented from inlining as this would cause much higher performance regression.",area-TieredCompilation,4creators,30/08/2018 18:58,
19763,typo fix,"Fixing typo in DAC notes. 
To be specific 
changed .","typo fix Fixing typo in DAC notes. 
To be specific 
changed .",documentation,sywhang,30/08/2018 18:45,30/08/2018 20:00
19762,Fix UNKNOWN in dump generated by createdump,"https://github.com/dotnet/coreclr/pull/19761

With the current implementation an LLDB analysis of a dump generated with the -h option leads to UNKNOWN instead of type/method names in dumpheap -stat or dumpstack commands.
This is due to missing assemblies from which the sos/mscordac plugin are extracting metadata.

With this pull request the assemblies are now part of the dump without increasing too much the size: on a dual core machine full=11GB withheap=226MB withheap(+patch)=269MB

It is especially important to decrease the size of a ""usable"" memory dump in the context of containers for which disk space is restricted and time during which an application does not respond to help check is limited.

Note: does not seem to be fixed on 2.1*","Fix UNKNOWN in dump generated by createdump https://github.com/dotnet/coreclr/pull/19761

With the current implementation an LLDB analysis of a dump generated with the -h option leads to UNKNOWN instead of type/method names in dumpheap -stat or dumpstack commands.
This is due to missing assemblies from which the sos/mscordac plugin are extracting metadata.

With this pull request the assemblies are now part of the dump without increasing too much the size: on a dual core machine full=11GB withheap=226MB withheap(+patch)=269MB

It is especially important to decrease the size of a ""usable"" memory dump in the context of containers for which disk space is restricted and time during which an application does not respond to help check is limited.

Note: does not seem to be fixed on 2.1*",area-Diagnostics,mikem8361,,
19760,Basic implementation for testing of COM activation of a .NET class,"This represents a partial implementation for dotnet/core-setup#4476

It current contains the following:
* minimal SPCL API implementation - only for RegFree COM scenario
* implementation of a host library for testing of activation scenarios
  - Note the  exe and only for testing 
* basic unit test of the SPCL API
* simple e2e test using RegFree COM

cc @jkotas @jeffschwMSFT @luqunl ","Basic implementation for testing of COM activation of a .NET class This represents a partial implementation for dotnet/core-setup#4476

It current contains the following:
* minimal SPCL API implementation - only for RegFree COM scenario
* implementation of a host library for testing of activation scenarios
  - Note the  exe and only for testing 
* basic unit test of the SPCL API
* simple e2e test using RegFree COM

cc @jkotas @jeffschwMSFT @luqunl ",area-Interop,AaronRobinsonMSFT,30/08/2018 14:26,11/09/2018 10:24
19759,[TieredCompilation] Miscellaneous regressions with tiering need investigation,"- [x] JitBench Word2Vec benchmark’s ""first search"" numbers regressed significantly (350%)
  - Perhaps a case of cold method with hot loops (https://github.com/dotnet/coreclr/issues/19751)
  - Duplicate of https://github.com/dotnet/coreclr/issues/19751 until that is fixed tiering should be turned off for this test
- [x] Word2Vec's ""training"" is also slower but to a much lesser degree perhaps a combination of the above and https://github.com/dotnet/coreclr/issues/19752 until that is fixed tiering should be turned off for this test
  - Duplicate of https://github.com/dotnet/coreclr/issues/19751
- [x] JitBench CscRoslynSource benchark
  - Project compilation completes while there is still tier 0 activity occurring so call counting and tier 1 transitions don't happen
  - There's lots of room for throughput improvement with tier 1 JIT perhaps it needs better heuristics to determine when to transition
  - No regressions in first or subsequent iterations as of https://github.com/dotnet/coreclr/pull/18610
  - Tracking potential improvements separately
- [x] Potential code locality issues - see https://github.com/dotnet/coreclr/pull/19121#issuecomment-408014042 and https://github.com/dotnet/coreclr/pull/19121#issuecomment-409925789
  - Code locality issues are unconfirmed tracking potential improvements separately","[TieredCompilation] Miscellaneous regressions with tiering need investigation - [x] JitBench Word2Vec benchmark’s ""first search"" numbers regressed significantly (350%)
  - Perhaps a case of cold method with hot loops (https://github.com/dotnet/coreclr/issues/19751)
  - Duplicate of https://github.com/dotnet/coreclr/issues/19751 until that is fixed tiering should be turned off for this test
- [x] Word2Vec's ""training"" is also slower but to a much lesser degree perhaps a combination of the above and https://github.com/dotnet/coreclr/issues/19752 until that is fixed tiering should be turned off for this test
  - Duplicate of https://github.com/dotnet/coreclr/issues/19751
- [x] JitBench CscRoslynSource benchark
  - Project compilation completes while there is still tier 0 activity occurring so call counting and tier 1 transitions don't happen
  - There's lots of room for throughput improvement with tier 1 JIT perhaps it needs better heuristics to determine when to transition
  - No regressions in first or subsequent iterations as of https://github.com/dotnet/coreclr/pull/18610
  - Tracking potential improvements separately
- [x] Potential code locality issues - see https://github.com/dotnet/coreclr/pull/19121#issuecomment-408014042 and https://github.com/dotnet/coreclr/pull/19121#issuecomment-409925789
  - Code locality issues are unconfirmed tracking potential improvements separately",area-TieredCompilation,kouvel,30/08/2018 13:12,21/12/2018 5:23
19758,API Proposal: Expose TheadPool.UnsafeQueueCustomWorkItem and IThreadPoolWorkItem,"When looking at a memory dump it would be great if we could see data about work items in the various queues. Some of the things that would be interesting to see per work item
- A display name (HttpRequest/TaskContinuation) that can be provided by the caller
- An elapsed time to know how long an item was in the queue

This sort of info might help when looking at dumps trying to diagnose issues with the thread pool.

To enable this and other optimized scheduling scenarios we should expose an interface that would allow customization of the underlying work item.

Proposal:

 (I'm not sure how it could anyways)

cc @stephentoub @kouvel @vancem ","API Proposal: Expose TheadPool.UnsafeQueueCustomWorkItem and IThreadPoolWorkItem When looking at a memory dump it would be great if we could see data about work items in the various queues. Some of the things that would be interesting to see per work item
- A display name (HttpRequest/TaskContinuation) that can be provided by the caller
- An elapsed time to know how long an item was in the queue

This sort of info might help when looking at dumps trying to diagnose issues with the thread pool.

To enable this and other optimized scheduling scenarios we should expose an interface that would allow customization of the underlying work item.

Proposal:

 (I'm not sure how it could anyways)

cc @stephentoub @kouvel @vancem ",area-System.Threading,stephentoub,30/08/2018 13:03,27/09/2018 1:47
19757,[TieredCompilation] Background jitting at tier 1 may cause temporary noticeable slowdown in throughput,"Background jitting at tier 1 may cause a substantial slowdown in throughput of other threads despite there being enough CPU power to handle all scheduled parallel work without context-switching due to time slicing though for a relatively short duration.

Don't have a repro at the moment but shouldn't be too difficult to create one. There was a scenario where an ASP.NET server saw ~7x slowdown in 2 consecutive requests (out of over 1000) after about 1.5 minutes of serving requests from startup. That coincided with a significant amount of tier 1 jitting.

Any small amount of tier 0 activity (tier 0 jitting or pregenerated code lookup) is treated as ""startup-like work"" and tiered compilation delays call counting and tier 1 transitions as long as such work is happening even occasionally. At some point when such startup-like work stops for a sufficiently long duration the now-long list of pending methods to call-count and transition to tier 1 is processed and the overhead of call counting and background tier 1 jitting becomes noticeable in the decrease in throughput. The overhead of call counting is understandable (and by design at the moment) but background tier 1 jitting also contributes significantly to the degradation in throughput though both are temporary. A suspicion was that there are frequently taken locks in the type system that get in the way of each thread making optimal progress.

The issue is much more noticeable by disabling the call counting delay ().","[TieredCompilation] Background jitting at tier 1 may cause temporary noticeable slowdown in throughput Background jitting at tier 1 may cause a substantial slowdown in throughput of other threads despite there being enough CPU power to handle all scheduled parallel work without context-switching due to time slicing though for a relatively short duration.

Don't have a repro at the moment but shouldn't be too difficult to create one. There was a scenario where an ASP.NET server saw ~7x slowdown in 2 consecutive requests (out of over 1000) after about 1.5 minutes of serving requests from startup. That coincided with a significant amount of tier 1 jitting.

Any small amount of tier 0 activity (tier 0 jitting or pregenerated code lookup) is treated as ""startup-like work"" and tiered compilation delays call counting and tier 1 transitions as long as such work is happening even occasionally. At some point when such startup-like work stops for a sufficiently long duration the now-long list of pending methods to call-count and transition to tier 1 is processed and the overhead of call counting and background tier 1 jitting becomes noticeable in the decrease in throughput. The overhead of call counting is understandable (and by design at the moment) but background tier 1 jitting also contributes significantly to the degradation in throughput though both are temporary. A suspicion was that there are frequently taken locks in the type system that get in the way of each thread making optimal progress.

The issue is much more noticeable by disabling the call counting delay ().",area-TieredCompilation,kouvel,30/08/2018 12:54,
19756,Update existing COM test assets (native/managed) to share CLSIDs with…,… other projects.,Update existing COM test assets (native/managed) to share CLSIDs with… … other projects.,area-Interop,AaronRobinsonMSFT,30/08/2018 11:29,31/08/2018 8:01
19755,Unify assembly name creation,,Unify assembly name creation ,area-Infrastructure-coreclr,AaronRobinsonMSFT,30/08/2018 11:26,12/10/2018 16:31
19754,Fire a runtime event when ThreadPool is being starved,"Thread pool starvation is a pretty common problem when working with code that uses the thread pool extensively. When exhaustion happens the application falls apart at the hinges because the scheduled work items just don't fire:

- Timer callbacks don't run
- Task continuations may not complete

etc.

There are a couple of situations where I think a diagnostic event can help:
- New work items are being enqueued at a rate faster than work items are being completed
- All threads are blocked but there's more work to be done (you've hit the max configured threads)

There's more scenarios but I don't precisely know enough about how the thread pool metrics and thread injection works to articulate it. Any other ideas would be welcome.

cc @brianrob @vancem @stephentoub @kouvel @geoffkizer ","Fire a runtime event when ThreadPool is being starved Thread pool starvation is a pretty common problem when working with code that uses the thread pool extensively. When exhaustion happens the application falls apart at the hinges because the scheduled work items just don't fire:

- Timer callbacks don't run
- Task continuations may not complete

etc.

There are a couple of situations where I think a diagnostic event can help:
- New work items are being enqueued at a rate faster than work items are being completed
- All threads are blocked but there's more work to be done (you've hit the max configured threads)

There's more scenarios but I don't precisely know enough about how the thread pool metrics and thread injection works to articulate it. Any other ideas would be welcome.

cc @brianrob @vancem @stephentoub @kouvel @geoffkizer ",area-System.Threading,stephentoub,30/08/2018 11:02,
19752,[TieredCompilation] Virtual calls may be slower with tiering,"With tiering there is an extra precode that calls would have to go through in some cases. If the processor does not compensate for the extra indirection virtual calls are slower (normal calls are too but that overhead is more easily compensated for with inlining).

See https://github.com/dotnet/coreclr/issues/18361 for an example where virtual call overhead is significant in the measurement.

Considerations:
- For virtual calls I had prototyped using the virtual slot with an indirect call instead of the precode and it eliminated the regression in the test case above. It looks like this would also close most of the steady-state perf gap in JitBench benchmarks between tiering and full-opt JIT alone. The idea seems promising it should be completed.
- For normal calls I had prototyped using an indirect call instead of jumping over a trampoline. There were marginal improvements during startup when with tier 0 JIT there would be more calls than at steady-state but nothing significant since R2R'ed code also does some inlining. Without R2R it may be more interesting.","[TieredCompilation] Virtual calls may be slower with tiering With tiering there is an extra precode that calls would have to go through in some cases. If the processor does not compensate for the extra indirection virtual calls are slower (normal calls are too but that overhead is more easily compensated for with inlining).

See https://github.com/dotnet/coreclr/issues/18361 for an example where virtual call overhead is significant in the measurement.

Considerations:
- For virtual calls I had prototyped using the virtual slot with an indirect call instead of the precode and it eliminated the regression in the test case above. It looks like this would also close most of the steady-state perf gap in JitBench benchmarks between tiering and full-opt JIT alone. The idea seems promising it should be completed.
- For normal calls I had prototyped using an indirect call instead of jumping over a trampoline. There were marginal improvements during startup when with tier 0 JIT there would be more calls than at steady-state but nothing significant since R2R'ed code also does some inlining. Without R2R it may be more interesting.",area-TieredCompilation,kouvel,,
19751,[TieredCompilation] Cold methods with hot loops may run slower with tiering,") for such types of benchmarks

Considerations:
- Consider optimizing loops at tier 0 or methods containing loops. Data needs to be collected on how this would affect startup performance.
- Longer-term: A proper fix would probably involve at least some portions of what OSR involves","[TieredCompilation] Cold methods with hot loops may run slower with tiering ) for such types of benchmarks

Considerations:
- Consider optimizing loops at tier 0 or methods containing loops. Data needs to be collected on how this would affect startup performance.
- Longer-term: A proper fix would probably involve at least some portions of what OSR involves",area-TieredCompilation,kouvel,30/08/2018 9:57,4/04/2019 0:51
19750,Enable IJW Native calling managed,Enables filling in the vtable stubs that IJW native code needs to call into managed code. This change restores some of the code that was removed with the  removal. However that code included quite a bit of infrastructure for maintaining vtable thunks that could enter different AppDomains. That's not necessary on core so all of that code isn't coming back. This change only addresses loading an IJW assembly when the runtime has already been loaded. Activating the runtime and fixing vtables at that time will be handled separately.,Enable IJW Native calling managed Enables filling in the vtable stubs that IJW native code needs to call into managed code. This change restores some of the code that was removed with the  removal. However that code included quite a bit of infrastructure for maintaining vtable thunks that could enter different AppDomains. That's not necessary on core so all of that code isn't coming back. This change only addresses loading an IJW assembly when the runtime has already been loaded. Activating the runtime and fixing vtables at that time will be handled separately.,area-Interop,morganbr,,
19746,Update the emitter to support 2-byte VEX prefix,"Currently the emitter only supports the 3-byte VEX prefix (outside a few specially handled instructions).
For normal floating-point arithmetic (or most 128-bit hardware intrinsics) this incurs an extra 1-byte per instruction.

It may be beneficial (for codegen size and potentially throughput) to update the emitter to also support the 2-byte VEX prefix.","Update the emitter to support 2-byte VEX prefix Currently the emitter only supports the 3-byte VEX prefix (outside a few specially handled instructions).
For normal floating-point arithmetic (or most 128-bit hardware intrinsics) this incurs an extra 1-byte per instruction.

It may be beneficial (for codegen size and potentially throughput) to update the emitter to also support the 2-byte VEX prefix.",area-CodeGen,fiigii,30/08/2018 9:02,11/12/2018 12:41
19744,fix merge conflict in build-test.sh,This method was renamed in #19430 but  #19213 did not notice this merge conflict.,fix merge conflict in build-test.sh This method was renamed in #19430 but  #19213 did not notice this merge conflict.,area-Infrastructure-coreclr,sandreenko,30/08/2018 8:12,30/08/2018 12:54
19741,[Arm64] JIT/Regression/JitBlue/GitHub_19397 fails,,[Arm64] JIT/Regression/JitBlue/GitHub_19397 fails ,arch-arm64,CarolEidt,,
19739,Remove workaround from floatdouble and floatsingle after the /fp:fast bugs are resolved,"https://github.com/dotnet/coreclr/pull/19725 added workarounds to  return the appropriate values when compiled with MSVC.

This is tracked internally in the DevDiv bug database as workitem 673062 and 673060.","Remove workaround from floatdouble and floatsingle after the /fp:fast bugs are resolved https://github.com/dotnet/coreclr/pull/19725 added workarounds to  return the appropriate values when compiled with MSVC.

This is tracked internally in the DevDiv bug database as workitem 673062 and 673060.",area-VM,RussKeldorph,30/08/2018 4:07,
19735,Add support for MarshalAs(UnmanagedType.BSTR) on UNIX systems,"Although Marshal.StringToBStr et al. works fine on Mac. The following code

Is failing on Mac:
System.Runtime.InteropServices.MarshalDirectiveException: ""Cannot marshal 'parameter #1': Invalid managed/unmanaged type combination (String parameters and return types must be paired with LPStr LPWStr or LPTStr).""
  at TestBSTR.Program.MyTest(String s Callback c)\n   at TestBSTR.Program.Main(String[] args) in /Users/odhanson/Projects/MyGuidTest/TestBSTR/Program.cs:15

Seems like (for looking at the code) this has only been implemented for windows (as part of COM support).

We are currently in the process of porting a FX application to Core that has extensive interop with existing native libraries (that are cross platform). The BSTR is used extensively and we would definitely need support for this type of marshaling.","Add support for MarshalAs(UnmanagedType.BSTR) on UNIX systems Although Marshal.StringToBStr et al. works fine on Mac. The following code

Is failing on Mac:
System.Runtime.InteropServices.MarshalDirectiveException: ""Cannot marshal 'parameter #1': Invalid managed/unmanaged type combination (String parameters and return types must be paired with LPStr LPWStr or LPTStr).""
  at TestBSTR.Program.MyTest(String s Callback c)\n   at TestBSTR.Program.Main(String[] args) in /Users/odhanson/Projects/MyGuidTest/TestBSTR/Program.cs:15

Seems like (for looking at the code) this has only been implemented for windows (as part of COM support).

We are currently in the process of porting a FX application to Core that has extensive interop with existing native libraries (that are cross platform). The BSTR is used extensively and we would definitely need support for this type of marshaling.",area-Interop,richlander,30/08/2018 0:17,7/12/2018 10:29
19734,"Question hosting a coreclr runtime with unix apis resolving packages from "".deps.json"" file?","From my understanding the unix hosting apis of the coreclr are low-level primitives that lack that ability to use the runtimeconfig.json file or the .deps.json file (which core-setup does).

So in order to run an application from the hosting APIs I must have deployed my app in it's entirety to a folder (NuGet packages and all) for the coreclr to find all the assemblies required to run my program. I could use )?","Question, hosting a coreclr runtime with unix apis, resolving packages from "".deps.json"" file? From my understanding the unix hosting apis of the coreclr are low-level primitives that lack that ability to use the runtimeconfig.json file or the .deps.json file (which core-setup does).

So in order to run an application from the hosting APIs I must have deployed my app in it's entirety to a folder (NuGet packages and all) for the coreclr to find all the assemblies required to run my program. I could use )?",question,jkotas,29/08/2018 22:54,30/08/2018 0:30
19733,Strange codegen with struct forwarding implementation to another struct,"### Info

Setup: Runtime=.NET Core 2.1.3 (CoreCLR 4.6.26725.06 CoreFX 4.6.26725.05) 64bit RyuJIT
Code for repro is at this commit (I haven't reduced it to a minimal repro yet): https://github.com/Porges/Fastre/commit/3a2f805801556282bb341798edef9206af162256 (the 

You can see more of the disassembly here: https://gist.github.com/Porges/334ca424055be72470a67bc6eefe43a8

category:cq
theme:structs
skill-level:expert
cost:large","Strange codegen with struct forwarding implementation to another struct ### Info

Setup: Runtime=.NET Core 2.1.3 (CoreCLR 4.6.26725.06 CoreFX 4.6.26725.05) 64bit RyuJIT
Code for repro is at this commit (I haven't reduced it to a minimal repro yet): https://github.com/Porges/Fastre/commit/3a2f805801556282bb341798edef9206af162256 (the 

You can see more of the disassembly here: https://gist.github.com/Porges/334ca424055be72470a67bc6eefe43a8

category:cq
theme:structs
skill-level:expert
cost:large",area-CodeGen,AndyAyersMS,29/08/2018 19:45,
19731,Test failure: Interop_IJW._ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_/_ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.DllNotFoundException: Unable to load shared library 'kernel32.dll' or one of its dependencies. In order to help diagnose loading problems consider setting the DYLD_PRINT_LIBRARIES environment variable: dlopen(libkernel32.dll 1): image not found
       at ManagedCallingNative.ManagedCallingNative.LoadLibraryEx(String lpFileName IntPtr hReservedNull Int32 dwFlags)
       at ManagedCallingNative.ManagedCallingNative.Main(String[] args)
    /Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Work/9bddec5f-6560-458e-8d2f-357577529060/Unzip/ManagedCallingNative/ManagedCallingNative/ManagedCallingNative.sh: line 244: 37549 Abort trap: 6           $_DebuggerFullPath \""$CORE_ROOT/corerun\"" $ExePath $CLRTestExecutionArguments
    
    
    Return code:      1
    Raw output file:      /Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Work/9bddec5f-6560-458e-8d2f-357577529060/Unzip/Reports\\Interop.IJW\\ManagedCallingNative\\ManagedCallingNative\\ManagedCallingNative.output.txt
    Raw output:
    BEGIN EXECUTION
    /Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Payload/corerun ManagedCallingNative.exe
    Expected: 100
    Actual: 134
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Payload
    > /Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Work/9bddec5f-6560-458e-8d2f-357577529060/Unzip/ManagedCallingNative/ManagedCallingNative/ManagedCallingNative.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

           at Interop_IJW._ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_._ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_cmd() in E:\A\_work\80\s\bin\tests\Windows_NT.x64.Release\TestWrappers\Interop.IJW\Interop.IJW.XUnitWrapper.cs:line 111
Build : 3.0 - 20180829.01 (Core Tests)
Failing configurations:
- osx.1013.amd64-x64
  - 
- osx.1012.amd64-x64
  - 
- windows.10.arm64-arm
  - 
- Windows.81.Amd64-x64
  - 
- Windows.7.Amd64-x64
  - 
- Windows.10.Amd64.Core-x64
  - 
- Windows.10.Nano.Amd64-x64
  - 
- Windows.10.Amd64-x64
  - 
- Alpine.36.Amd64-x64
  - 
- sles.12.amd64-x64
  - 
- opensuse.423.amd64-x64
  - 
- ubuntu.1804.amd64-x64
  - 
- ubuntu.1604.amd64-x64
  - 
- ubuntu.1404.amd64-x64
  - 
- redhat.73.amd64-x64
  - 
- fedora.28.amd64-x64
  - 
- fedora.27.amd64-x64
  - 
- debian.82.amd64-x64
  - 
- redhat.69.amd64-x64
  - 
Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180829.01/workItem/Interop.IJW.XUnitWrapper/analysis/xunit/Interop_IJW._ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_~2F_ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_cmd","Test failure: Interop_IJW._ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_/_ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.DllNotFoundException: Unable to load shared library 'kernel32.dll' or one of its dependencies. In order to help diagnose loading problems consider setting the DYLD_PRINT_LIBRARIES environment variable: dlopen(libkernel32.dll 1): image not found
       at ManagedCallingNative.ManagedCallingNative.LoadLibraryEx(String lpFileName IntPtr hReservedNull Int32 dwFlags)
       at ManagedCallingNative.ManagedCallingNative.Main(String[] args)
    /Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Work/9bddec5f-6560-458e-8d2f-357577529060/Unzip/ManagedCallingNative/ManagedCallingNative/ManagedCallingNative.sh: line 244: 37549 Abort trap: 6           $_DebuggerFullPath \""$CORE_ROOT/corerun\"" $ExePath $CLRTestExecutionArguments
    
    
    Return code:      1
    Raw output file:      /Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Work/9bddec5f-6560-458e-8d2f-357577529060/Unzip/Reports\\Interop.IJW\\ManagedCallingNative\\ManagedCallingNative\\ManagedCallingNative.output.txt
    Raw output:
    BEGIN EXECUTION
    /Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Payload/corerun ManagedCallingNative.exe
    Expected: 100
    Actual: 134
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Payload
    > /Users/dotnet-bot/dotnetbuild/work/e617ae5c-d07f-4bdb-bb60-bf8d42adec7c/Work/9bddec5f-6560-458e-8d2f-357577529060/Unzip/ManagedCallingNative/ManagedCallingNative/ManagedCallingNative.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

           at Interop_IJW._ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_._ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_cmd() in E:\A\_work\80\s\bin\tests\Windows_NT.x64.Release\TestWrappers\Interop.IJW\Interop.IJW.XUnitWrapper.cs:line 111
Build : 3.0 - 20180829.01 (Core Tests)
Failing configurations:
- osx.1013.amd64-x64
  - 
- osx.1012.amd64-x64
  - 
- windows.10.arm64-arm
  - 
- Windows.81.Amd64-x64
  - 
- Windows.7.Amd64-x64
  - 
- Windows.10.Amd64.Core-x64
  - 
- Windows.10.Nano.Amd64-x64
  - 
- Windows.10.Amd64-x64
  - 
- Alpine.36.Amd64-x64
  - 
- sles.12.amd64-x64
  - 
- opensuse.423.amd64-x64
  - 
- ubuntu.1804.amd64-x64
  - 
- ubuntu.1604.amd64-x64
  - 
- ubuntu.1404.amd64-x64
  - 
- redhat.73.amd64-x64
  - 
- fedora.28.amd64-x64
  - 
- fedora.27.amd64-x64
  - 
- debian.82.amd64-x64
  - 
- redhat.69.amd64-x64
  - 
Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180829.01/workItem/Interop.IJW.XUnitWrapper/analysis/xunit/Interop_IJW._ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_~2F_ManagedCallingNative_ManagedCallingNative_ManagedCallingNative_cmd",test-run-uwp-coreclr,morganbr,29/08/2018 15:59,29/08/2018 21:26
19728,Update BuildTools CoreClr CoreFx CoreSetup PgoData to preview1-03130-04 preview1-26830-04 preview1-26830-04 preview1-26830-01 master-20180830-0102 respectively (master),/cc @dotnet/coreclr-auto-update-notify,"Update BuildTools, CoreClr, CoreFx, CoreSetup, PgoData to preview1-03130-04, preview1-26830-04, preview1-26830-04, preview1-26830-01, master-20180830-0102, respectively (master) /cc @dotnet/coreclr-auto-update-notify",,ViktorHofer,,
19724,R2RDump - Expand diffing functionality,"Presently R2RDump's diffing capabilities are limited to some summary statistics.
This issue tracks ensuring we generate rich and meaningful diff information specifically to be used for driving CQ of the cross-platform AOT compiler during bringup
","R2RDump - Expand diffing functionality Presently R2RDump's diffing capabilities are limited to some summary statistics.
This issue tracks ensuring we generate rich and meaningful diff information specifically to be used for driving CQ of the cross-platform AOT compiler during bringup
",area-R2RDump,nattress,29/08/2018 9:22,
19723,WIP NO-MERGE Dummy change to test dev/unix_test_workflow branch,,WIP NO-MERGE Dummy change to test dev/unix_test_workflow branch ,* NO MERGE *,BruceForstall,29/08/2018 9:16,13/09/2018 5:57
19722,Missing includes in coreclr/src/debug/createdump/,"Attempting to bootstrap (with buildbootstrapcli.sh) fails with the following:

 fixes this but I'm guessing your preferred style puts that elsewhere seeing as this file doesn't include any of the other headers it obviously requires.","Missing includes in coreclr/src/debug/createdump/ Attempting to bootstrap (with buildbootstrapcli.sh) fails with the following:

 fixes this but I'm guessing your preferred style puts that elsewhere seeing as this file doesn't include any of the other headers it obviously requires.",area-Diagnostics,mikem8361,,
26625,ReadyToRunCodegenNodeFactory cleanup / refactor,"* This class has gotten very big and contains several groups of unrelated functionality;
* Usefulness of deriving from NodeFactory is questionable it seems we're using just a fraction of its functionality and overlaps in the various helper names cause repeated aliasing issues;
* If it turns out to be possible to cleanly separate ReadyToRunCodegenNodeFactory from NodeFactory we should either split it into several classes or at least make it a partial class living in several files:
    * CorInfoImpl utility functions for constructing the various helper cells and signatures;
    * Token collection and lookup engine;
* R2R header table collection management.","ReadyToRunCodegenNodeFactory cleanup / refactor * This class has gotten very big and contains several groups of unrelated functionality;
* Usefulness of deriving from NodeFactory is questionable it seems we're using just a fraction of its functionality and overlaps in the various helper names cause repeated aliasing issues;
* If it turns out to be possible to cleanly separate ReadyToRunCodegenNodeFactory from NodeFactory we should either split it into several classes or at least make it a partial class living in several files:
    * CorInfoImpl utility functions for constructing the various helper cells and signatures;
    * Token collection and lookup engine;
* R2R header table collection management.",area-crossgen2,MichalStrehovsky,29/08/2018 9:06,
26624,Multi-module compilation,"* Command-line specifies a number of ""input files"" that get all compiled into a single output R2R PE executable;
* Today architecture will need minor tweaks as we won't have a pre-existing MSIL to start off;
* All input files will be part of the CompilationModuleGroup without any singled-out assembly;
* This is expected to require additional CoreCLR runtime changes to work properly end-to-end;
* This will require a 2-level MethodEntrypointTable to cater for method tables for the individual modules and perhaps a new R2R component module table;
* Alternatively we might want to keep the pre-existing functionality untouched and just add a completely new entrypoint table format specific to the multi-module build.","Multi-module compilation * Command-line specifies a number of ""input files"" that get all compiled into a single output R2R PE executable;
* Today architecture will need minor tweaks as we won't have a pre-existing MSIL to start off;
* All input files will be part of the CompilationModuleGroup without any singled-out assembly;
* This is expected to require additional CoreCLR runtime changes to work properly end-to-end;
* This will require a 2-level MethodEntrypointTable to cater for method tables for the individual modules and perhaps a new R2R component module table;
* Alternatively we might want to keep the pre-existing functionality untouched and just add a completely new entrypoint table format specific to the multi-module build.",area-crossgen2,Dotnet-GitSync-Bot,29/08/2018 9:04,
26623,Investigate ILCompiler R2R Self-Hosting,"* Once CQ allows try building ILCompiler in R2R mode
* This should provide a compilation perf improvement (less jitting) and a sizable CQ indicator local to this repository","Investigate ILCompiler R2R Self-Hosting * Once CQ allows try building ILCompiler in R2R mode
* This should provide a compilation perf improvement (less jitting) and a sizable CQ indicator local to this repository",area-crossgen2,nattress,,
19721,R2RDump - Implement fixup signature parsing,The various fixups supported in the ready-to-run format use signatures to represent types / methods. Parsing the signatures in a ready-to-run image will allow us to add richer symbolic information to the disassembly emitted by r2rdump. This will also make diffing images generated by Crossgen vs ILCompiler easier.,R2RDump - Implement fixup signature parsing The various fixups supported in the ready-to-run format use signatures to represent types / methods. Parsing the signatures in a ready-to-run image will allow us to add richer symbolic information to the disassembly emitted by r2rdump. This will also make diffing images generated by Crossgen vs ILCompiler easier.,area-R2RDump,nattress,29/08/2018 7:49,15/09/2018 9:27
19717,disable NETClientPrimitives test for all platforms.,"As it was before.

Fixes R2R jobs like https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_checked_windows_nt_r2r/.


","disable NETClientPrimitives test for all platforms. As it was before.

Fixes R2R jobs like https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_checked_windows_nt_r2r/.


",disabled-test,sandreenko,29/08/2018 6:00,29/08/2018 8:24
19715,[Windows/arm64] build break: C4723 potential divide by 0,"Apparently this changed with VS 15.8.

","[Windows/arm64] build break: C4723 potential divide by 0 Apparently this changed with VS 15.8.

",arch-arm64,BruceForstall,29/08/2018 5:00,29/08/2018 8:39
19710,COMPlus_JitStdOutFile on Linux - part of the output still goes to StdOut,"**Steps to reproduce:**

Set the following environment variable

","COMPlus_JitStdOutFile on Linux - part of the output still goes to StdOut **Steps to reproduce:**

Set the following environment variable

",area-CodeGen,echesakovMSFT,29/08/2018 2:11,20/09/2018 9:37
19706,Char.GetUnicodeCategory returns wrong category for certain Latin-1 characters,In a nutshell there are certain characters where  instead. This preserves existing behavior and provides a migration story to get developers on to the APIs which provide correct results.,Char.GetUnicodeCategory returns wrong category for certain Latin-1 characters In a nutshell there are certain characters where  instead. This preserves existing behavior and provides a migration story to get developers on to the APIs which provide correct results.,area-System.Globalization,jkotas,28/08/2018 10:05,
19705,[Windows|x86|x64] Incorrect comparison of short,"Example code:



/cc @BruceForstall ","[Windows|x86|x64] Incorrect comparison of short Example code:



/cc @BruceForstall ",area-CodeGen,erozenfeld,,
19704,"CrossGen produces spurious ""Error"" logging on what it later reports as successful compilation","From this log: https://devdiv.visualstudio.com/0bdbc590-a062-4c3f-b0f6-9383f67865ee/_apis/build/builds/1980843/logs/8


(This was from compiling csc.dll)

Some thoughts here:
- If four errors have been written out to the console succeeding with no special ""-force' or other args like this is very confusing
- MSBuild and other systems tend to promote std. out with ""error"" in the string to actual errors
- E_FAIL is not super useful to anyone reading this log.

@eerhardt FYI
","CrossGen produces spurious ""Error"" logging on what it later reports as successful compilation From this log: https://devdiv.visualstudio.com/0bdbc590-a062-4c3f-b0f6-9383f67865ee/_apis/build/builds/1980843/logs/8


(This was from compiling csc.dll)

Some thoughts here:
- If four errors have been written out to the console succeeding with no special ""-force' or other args like this is very confusing
- MSBuild and other systems tend to promote std. out with ""error"" in the string to actual errors
- E_FAIL is not super useful to anyone reading this log.

@eerhardt FYI
",area-CrossGen/NGEN,zacharycmontoya,,
19703,Delete code that tracks stack level in morph.,"The responsibilities of the old code that tracked stack level were:
1) Set 
Fixes #16411.","Delete code that tracks stack level in morph. The responsibilities of the old code that tracked stack level were:
1) Set 
Fixes #16411.",area-CodeGen,sandreenko,28/08/2018 9:47,30/08/2018 12:55
19699,Implement PCLMULQDQ intrinsic,"I will submit a PR to implement all the PCLMULQDQ intrinsic.

cc @CarolEidt @tannergooding @eerhardt ","Implement PCLMULQDQ intrinsic I will submit a PR to implement all the PCLMULQDQ intrinsic.

cc @CarolEidt @tannergooding @eerhardt ",area-CodeGen,CarolEidt,28/08/2018 8:20,11/09/2018 5:55
19698,System.AccessViolationException while formatting stacktrace,"Reported by @BrennanConroy 

We’re getting this exception in a test occasionally. 

","System.AccessViolationException while formatting stacktrace Reported by @BrennanConroy 

We’re getting this exception in a test occasionally. 

",area-Diagnostics,mikem8361,,
19696,[arm64] Remove interpreter fallback,"Remove old code:
","[arm64] Remove interpreter fallback Remove old code:
",arch-arm64,BruceForstall,,
19694,Fix JitDump label output to be multi-thread safe,"We emit labels using a global static  pointer so it might be a little more work than this.

category:implementation
theme:debug-dumps
skill-level:beginner
cost:small","Fix JitDump label output to be multi-thread safe We emit labels using a global static  pointer so it might be a little more work than this.

category:implementation
theme:debug-dumps
skill-level:beginner
cost:small",area-CodeGen,BruceForstall,28/08/2018 6:28,
19691,Enable tiered compilation,"This is a port of several changes that went into master after 2.2 forked including dependencies for and enabling tiered compilation by default in 2.2. Quick summary of commits is below see the commit descriptions and PRs for more info.
- Commit 1 - Fix nested spin locks in thread pool etw firing (#17677)
  - Fixes a lock nesting issue when there is an ETW listener which can occur without tiering but is almost deterministic with tiering enabled because the first event that is fired typically hits this code path
- Commit 2 - Don't close the JIT func info file on shutdown (#18060)
  - Fixes a crash during shutdown that only occurs when JIT logging is enabled (typically in the coreclr tests and CI). More frequent with tiering enabled because of different JIT timing and background jitting.
- Commit 3 - Apply tiering's call counting delay more broadly (#18610)
  - Fixes a perf issue when tiering is enabled in server first-request scenarios where there is a significant gap between process startup and first request
- Commit 4 - Changes only affect debug builds - Eliminate arm64 contract asserts (#19015)
  - Fixes some incorrect asserts that trigger more frequently with tiering
- Commit 5 - Use 16 bytes to spill SIMD12 (#19237)
  - Fixes a crash in corefx System.Numerics.Tests.Vector3Tests.Vector3EqualsTest. Occurs with minopt JIT or with tiering.
- Commit 6 - Fix an apartment state issue (partial port of #19384)
  - This is a partial port of this PR (only the portion that addresses issue #17822)
  - This is a breaking change though a minor one that we have concluded is an acceptable risk to take for 2.2
  - Fixes a behavioral difference that can be seen more easily tiering enabled in APIs on the  class relevant to apartment state. The issue can also be seen in some cases when tiering is disabled.
- Commit 7 - Enable Tiered Compilation by default (#19525)
  - Enables tiering by default can be disabled through environment or through .csproj/.json when using dotnet
  - Removes deprecated config variable (EXPERIMENTAL_TieredCompilation) that was previously exposed in 2.1 along with the current config variable (TieredCompilation) along with miscellaneous test fixes
- Commit 8 - Changes only affect tests - Fix tiered compilation option for case-sensitive systems (#19567)
  - Fixes tiering environment variable casing for non-Windows platforms
- Commit 9 - Disable tiered compilation on arm64
  - There is an open issue that may be partly related to minopts on arm64 (https://github.com/dotnet/coreclr/issues/18895). Disabling tiering by default on arm64 to limit exposing new issues.

This change would be followed up with https://github.com/dotnet/corefx/pull/31822
- Adds tests for Commit 6 - Fix an apartment state issue (partial port of #19384)
  - Changes only affect tests

Closes https://github.com/dotnet/coreclr/issues/18973","Enable tiered compilation This is a port of several changes that went into master after 2.2 forked including dependencies for and enabling tiered compilation by default in 2.2. Quick summary of commits is below see the commit descriptions and PRs for more info.
- Commit 1 - Fix nested spin locks in thread pool etw firing (#17677)
  - Fixes a lock nesting issue when there is an ETW listener which can occur without tiering but is almost deterministic with tiering enabled because the first event that is fired typically hits this code path
- Commit 2 - Don't close the JIT func info file on shutdown (#18060)
  - Fixes a crash during shutdown that only occurs when JIT logging is enabled (typically in the coreclr tests and CI). More frequent with tiering enabled because of different JIT timing and background jitting.
- Commit 3 - Apply tiering's call counting delay more broadly (#18610)
  - Fixes a perf issue when tiering is enabled in server first-request scenarios where there is a significant gap between process startup and first request
- Commit 4 - Changes only affect debug builds - Eliminate arm64 contract asserts (#19015)
  - Fixes some incorrect asserts that trigger more frequently with tiering
- Commit 5 - Use 16 bytes to spill SIMD12 (#19237)
  - Fixes a crash in corefx System.Numerics.Tests.Vector3Tests.Vector3EqualsTest. Occurs with minopt JIT or with tiering.
- Commit 6 - Fix an apartment state issue (partial port of #19384)
  - This is a partial port of this PR (only the portion that addresses issue #17822)
  - This is a breaking change though a minor one that we have concluded is an acceptable risk to take for 2.2
  - Fixes a behavioral difference that can be seen more easily tiering enabled in APIs on the  class relevant to apartment state. The issue can also be seen in some cases when tiering is disabled.
- Commit 7 - Enable Tiered Compilation by default (#19525)
  - Enables tiering by default can be disabled through environment or through .csproj/.json when using dotnet
  - Removes deprecated config variable (EXPERIMENTAL_TieredCompilation) that was previously exposed in 2.1 along with the current config variable (TieredCompilation) along with miscellaneous test fixes
- Commit 8 - Changes only affect tests - Fix tiered compilation option for case-sensitive systems (#19567)
  - Fixes tiering environment variable casing for non-Windows platforms
- Commit 9 - Disable tiered compilation on arm64
  - There is an open issue that may be partly related to minopts on arm64 (https://github.com/dotnet/coreclr/issues/18895). Disabling tiering by default on arm64 to limit exposing new issues.

This change would be followed up with https://github.com/dotnet/corefx/pull/31822
- Adds tests for Commit 6 - Fix an apartment state issue (partial port of #19384)
  - Changes only affect tests

Closes https://github.com/dotnet/coreclr/issues/18973",area-CodeGen,kouvel,,
19690,Automate CoreCLR's CoreFX CI Test Infrastructure,"# CoreFX Tests in CoreCLR CI

## Current State
A suite of CoreFX tests are executed on top of CI builds of CoreCLR during PRs.  Currently these tests are manually built and uploaded to an Azure Blob Storage container and downloaded during the CI pipeline.  The cadence of building and uploading the binaries is completely manual with almost no visibility as to what commit from dotnet/corefx was used to build the tests.  While this works it is inconvenient for maintenance and unfriendly for developers who may want to pull down the same test binaries that are running in the CI for their PR.

## Goals
* Automate the cataloging (upload and versioning) of CoreFX test binaries.
* Simplify the retrieval of a specific version of the CoreFX test binaries.
* Hook into the automation that already updates the CoreFX version in [coreclr/dependencies.props](https://github.com/dotnet/coreclr/blob/master/dependencies.props) via [maestro-bot](https://github.com/dotnet/versions).

This issue is for unifying discussions as this may require changes in dotnet/coreclr and dotnet/corefx.

CC - @A-And @adityamandaleeka 

[WIP]","Automate CoreCLR's CoreFX CI Test Infrastructure # CoreFX Tests in CoreCLR CI

## Current State
A suite of CoreFX tests are executed on top of CI builds of CoreCLR during PRs.  Currently these tests are manually built and uploaded to an Azure Blob Storage container and downloaded during the CI pipeline.  The cadence of building and uploading the binaries is completely manual with almost no visibility as to what commit from dotnet/corefx was used to build the tests.  While this works it is inconvenient for maintenance and unfriendly for developers who may want to pull down the same test binaries that are running in the CI for their PR.

## Goals
* Automate the cataloging (upload and versioning) of CoreFX test binaries.
* Simplify the retrieval of a specific version of the CoreFX test binaries.
* Hook into the automation that already updates the CoreFX version in [coreclr/dependencies.props](https://github.com/dotnet/coreclr/blob/master/dependencies.props) via [maestro-bot](https://github.com/dotnet/versions).

This issue is for unifying discussions as this may require changes in dotnet/coreclr and dotnet/corefx.

CC - @A-And @adityamandaleeka 

[WIP]",area-Infrastructure-coreclr,davmason,,
19689,Hardware intrinsic throw ArgumentOutOfRangeException with IMM parameter name,"Now some hardware intrinsic can throw 

We may need to bring the IMM parameter name in the exception object.

Logged from the conversation https://github.com/dotnet/coreclr/pull/19392#discussion_r213050260

@tannergooding @CarolEidt 

category:implementation
theme:intrinsics
skill-level:beginner
cost:small","Hardware intrinsic throw ArgumentOutOfRangeException with IMM parameter name Now some hardware intrinsic can throw 

We may need to bring the IMM parameter name in the exception object.

Logged from the conversation https://github.com/dotnet/coreclr/pull/19392#discussion_r213050260

@tannergooding @CarolEidt 

category:implementation
theme:intrinsics
skill-level:beginner
cost:small",area-CodeGen,CarolEidt,28/08/2018 3:48,
19688,Update NetPerf File ThreadID to 64-bits,The current value is 32-bits which will truncate the full value on OSX.,Update NetPerf File ThreadID to 64-bits The current value is 32-bits which will truncate the full value on OSX.,area-Tracing,noahfalk,,
19684,Test failure: JIT_jit64._mcc_interop_mcc_i83_mcc_i83_/_mcc_interop_mcc_i83_mcc_i83_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Work\\21104909-527d-4766-99e3-8be351afd714\\Unzip\\Reports\\JIT.jit64\\mcc\\interop\\mcc_i83\\mcc_i83.output.txt
    Raw output:
    BEGIN EXECUTION\r
     \""C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Payload\\corerun.exe\"" mcc_i83.exe \r
    Expected: 100\r
    Actual: -1073741819\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Payload
    > C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Work\\21104909-527d-4766-99e3-8be351afd714\\Unzip\\mcc\\interop\\mcc_i83\\mcc_i83.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

           at JIT_jit64._mcc_interop_mcc_i83_mcc_i83_._mcc_interop_mcc_i83_mcc_i83_cmd() in E:\A\_work\105\s\bin\tests\Windows_NT.arm.Release\TestWrappers\JIT.jit64\JIT.jit64.XUnitWrapper.cs:line 23349
Build : 3.0 - 20180827.01 (Core Tests)
Failing configurations:
- windows.10.arm64-arm
  - 
Details: 
https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180827.01/workItem/JIT.jit64.XUnitWrapper/analysis/xunit/JIT_jit64._mcc_interop_mcc_i83_mcc_i83_~2F_mcc_interop_mcc_i83_mcc_i83_cmd","Test failure: JIT_jit64._mcc_interop_mcc_i83_mcc_i83_/_mcc_interop_mcc_i83_mcc_i83_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Work\\21104909-527d-4766-99e3-8be351afd714\\Unzip\\Reports\\JIT.jit64\\mcc\\interop\\mcc_i83\\mcc_i83.output.txt
    Raw output:
    BEGIN EXECUTION\r
     \""C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Payload\\corerun.exe\"" mcc_i83.exe \r
    Expected: 100\r
    Actual: -1073741819\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Payload
    > C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Work\\21104909-527d-4766-99e3-8be351afd714\\Unzip\\mcc\\interop\\mcc_i83\\mcc_i83.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

           at JIT_jit64._mcc_interop_mcc_i83_mcc_i83_._mcc_interop_mcc_i83_mcc_i83_cmd() in E:\A\_work\105\s\bin\tests\Windows_NT.arm.Release\TestWrappers\JIT.jit64\JIT.jit64.XUnitWrapper.cs:line 23349
Build : 3.0 - 20180827.01 (Core Tests)
Failing configurations:
- windows.10.arm64-arm
  - 
Details: 
https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180827.01/workItem/JIT.jit64.XUnitWrapper/analysis/xunit/JIT_jit64._mcc_interop_mcc_i83_mcc_i83_~2F_mcc_interop_mcc_i83_mcc_i83_cmd",area-CodeGen,jashook,,
19683,Test failure: baseservices_varargs._varargsupport_r_varargsupport_r_/_varargsupport_r_varargsupport_r_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Work\\00d13fb9-5edc-43da-9ceb-c7260abf98d0\\Unzip\\Reports\\baseservices.varargs\\varargsupport_r\\varargsupport_r.output.txt
    Raw output:
    BEGIN EXECUTION\r
     \""C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Payload\\corerun.exe\"" varargsupport_r.exe \r
    Blah Blah\r
    Test failed as InvalidProgramException was not raised.\r
    Expected: 100\r
    Actual: 0\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Payload
    > C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Work\\00d13fb9-5edc-43da-9ceb-c7260abf98d0\\Unzip\\varargsupport_r\\varargsupport_r.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

           at baseservices_varargs._varargsupport_r_varargsupport_r_._varargsupport_r_varargsupport_r_cmd() in E:\A\_work\105\s\bin\tests\Windows_NT.arm.Release\TestWrappers\baseservices.varargs\baseservices.varargs.XUnitWrapper.cs:line 179
Build : 3.0 - 20180827.01 (Core Tests)
Failing configurations:
- windows.10.arm64-arm
  - 
Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180827.01/workItem/baseservices.varargs.XUnitWrapper/analysis/xunit/baseservices_varargs._varargsupport_r_varargsupport_r_~2F_varargsupport_r_varargsupport_r_cmd","Test failure: baseservices_varargs._varargsupport_r_varargsupport_r_/_varargsupport_r_varargsupport_r_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Work\\00d13fb9-5edc-43da-9ceb-c7260abf98d0\\Unzip\\Reports\\baseservices.varargs\\varargsupport_r\\varargsupport_r.output.txt
    Raw output:
    BEGIN EXECUTION\r
     \""C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Payload\\corerun.exe\"" varargsupport_r.exe \r
    Blah Blah\r
    Test failed as InvalidProgramException was not raised.\r
    Expected: 100\r
    Actual: 0\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Payload
    > C:\\dotnetbuild\\work\\31155d77-0bf1-45a2-a51e-dc457ed07fe5\\Work\\00d13fb9-5edc-43da-9ceb-c7260abf98d0\\Unzip\\varargsupport_r\\varargsupport_r.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

           at baseservices_varargs._varargsupport_r_varargsupport_r_._varargsupport_r_varargsupport_r_cmd() in E:\A\_work\105\s\bin\tests\Windows_NT.arm.Release\TestWrappers\baseservices.varargs\baseservices.varargs.XUnitWrapper.cs:line 179
Build : 3.0 - 20180827.01 (Core Tests)
Failing configurations:
- windows.10.arm64-arm
  - 
Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180827.01/workItem/baseservices.varargs.XUnitWrapper/analysis/xunit/baseservices_varargs._varargsupport_r_varargsupport_r_~2F_varargsupport_r_varargsupport_r_cmd",area-CodeGen,jashook,,
19682,Hang when running with pseudo.,"https://www.yoctoproject.org/software-item/pseudo/

This tool allows users to to act as root.

I am using official binaries of v2.1.401 SDK.

Simple running 

This tool is vital for Yocto since it ensures a clean operating system with no host contamination.","Hang when running with pseudo. https://www.yoctoproject.org/software-item/pseudo/

This tool allows users to to act as root.

I am using official binaries of v2.1.401 SDK.

Simple running 

This tool is vital for Yocto since it ensures a clean operating system with no host contamination.",area-Diagnostics,mikem8361,,
19681,re-enable com for local gc,"This codepath is only used when a profiler or ETW walks the heap so an interface call for every COM object:
1. Should only affect COM objects which is usually a very small portion of overall objects
2. Shouldn't be a hot path item
3. Even if it was walking the heap is very slow already and only done for diagnostics so not performance critical

So I think an interface call is fine here.","re-enable com for local gc This codepath is only used when a profiler or ETW walks the heap so an interface call for every COM object:
1. Should only affect COM objects which is usually a very small portion of overall objects
2. Shouldn't be a hot path item
3. Even if it was walking the heap is very slow already and only done for diagnostics so not performance critical

So I think an interface call is fine here.",area-GC,davmason,,
19680,Segfault in ECall::GetQCallImpl on local build.," but I am confident I have deployed both.

Any guidance would be greatly appreciated.","Segfault in ECall::GetQCallImpl on local build.  but I am confident I have deployed both.

Any guidance would be greatly appreciated.",area-Tracing,AaronRobinsonMSFT,27/08/2018 9:55,27/02/2019 9:39
19679,System.Runtime.TieredCompilation configuration knob does not work to turn off tiered compilation,"I can't seem to get this configuration knob working. I am using my issue reported in #19599 as a test for whether tiered compilation is enabled or not. The following PowerShell session illustrates my confusion:

The CoreRun used here is compiled from current master (5d2ae2f) and the dotnet CLI is 2.1.400.

Is this a bug or is there some other way to turn off tiered compilation for an app without requiring the COMPlus_TieredCompilation environment variable to be set correctly before running the app?","System.Runtime.TieredCompilation configuration knob does not work to turn off tiered compilation I can't seem to get this configuration knob working. I am using my issue reported in #19599 as a test for whether tiered compilation is enabled or not. The following PowerShell session illustrates my confusion:

The CoreRun used here is compiled from current master (5d2ae2f) and the dotnet CLI is 2.1.400.

Is this a bug or is there some other way to turn off tiered compilation for an app without requiring the COMPlus_TieredCompilation environment variable to be set correctly before running the app?",area-TieredCompilation,RussKeldorph,27/08/2018 6:09,28/08/2018 4:56
19676,PInvoke function that returns a struct,"One of my customers encountered a problem today that doesn't appear with .NET Framework/Mono.

For some reason in this function (ENet.cs line 747):
 (ENet.cs line 515).

The runtime throws this exception:
> Unhandled Exception: System.Runtime.InteropServices.MarshalDirectiveException: Method's type signature is not PInvoke compatible.
   at ENet.Native.enet_peer_get_address(IntPtr peer)
   at ENet.Peer.get_Address() in E:\TestENetServer\ENet.cs:line 517
   at TestENetServer.Program.Main(String[] args) in E:\TestENetServer\Program.cs:line 25

Here's an example of projects - [ENetCSharpTest.zip](https://github.com/dotnet/coreclr/files/2321643/ENetCSharpTest.zip)
Simple run the server and then the client and you will catch an exception.

Here's repository with a complete source code including the native library - https://github.com/nxrighthere/ENet-CSharp","PInvoke function that returns a struct One of my customers encountered a problem today that doesn't appear with .NET Framework/Mono.

For some reason in this function (ENet.cs line 747):
 (ENet.cs line 515).

The runtime throws this exception:
> Unhandled Exception: System.Runtime.InteropServices.MarshalDirectiveException: Method's type signature is not PInvoke compatible.
   at ENet.Native.enet_peer_get_address(IntPtr peer)
   at ENet.Peer.get_Address() in E:\TestENetServer\ENet.cs:line 517
   at TestENetServer.Program.Main(String[] args) in E:\TestENetServer\Program.cs:line 25

Here's an example of projects - [ENetCSharpTest.zip](https://github.com/dotnet/coreclr/files/2321643/ENetCSharpTest.zip)
Simple run the server and then the client and you will catch an exception.

Here's repository with a complete source code including the native library - https://github.com/nxrighthere/ENet-CSharp",area-Interop,jkoritzinsky,,
19674,Memory Corruption using System.Numerics.Vector3,"I've discovered a memory corruption bug which seems to affect 

As indicated some degree of control is possible so this may have security implications in some regard.  It also only appears to occur when the Vector3 is passed to another function; if you perform the same operations inside a given function everything works as expected.  Also this only seems to occur when you *assign* one of the vector components; accessing components is fine as is assigning whole vectors.","Memory Corruption using System.Numerics.Vector3 I've discovered a memory corruption bug which seems to affect 

As indicated some degree of control is possible so this may have security implications in some regard.  It also only appears to occur when the Vector3 is passed to another function; if you perform the same operations inside a given function everything works as expected.  Also this only seems to occur when you *assign* one of the vector components; accessing components is fine as is assigning whole vectors.",area-CodeGen,CarolEidt,,
19672,StringComparison.Ordinal same as not specified calls?,Should ?,StringComparison.Ordinal same as not specified calls? Should ?,area-System.Runtime,RussKeldorph,25/08/2018 22:42,
19668,Consistency check failed: File has not had execution verified,"The three following assemblies when PMI-d on Linux/arm hit the same assertion

**System.Security.Cryptography.Encoding.dll** 



**Updated:** Also reproduces on Linux/arm64","Consistency check failed: File has not had execution verified The three following assemblies when PMI-d on Linux/arm hit the same assertion

**System.Security.Cryptography.Encoding.dll** 



**Updated:** Also reproduces on Linux/arm64",arch-arm32,AndyAyersMS,,
19667,[WIP] Enable tiered compilation,,[WIP] Enable tiered compilation ,* NO MERGE *,kouvel,,
19666,[WIP] Test CI,,[WIP] Test CI ,* NO MERGE *,kouvel,,
19661,R2RDump ARM and ARM64 UnwindCodes,"R2RDump can parse UnwindInfo headers for ARM and ARM64 but not UnwindCodes yet. 

This can be implemented based on https://github.com/dotnet/coreclr/blob/master/src/jit/unwindarm.cpp and https://github.com/dotnet/coreclr/blob/master/src/jit/unwindarm64.cpp","R2RDump ARM and ARM64 UnwindCodes R2RDump can parse UnwindInfo headers for ARM and ARM64 but not UnwindCodes yet. 

This can be implemented based on https://github.com/dotnet/coreclr/blob/master/src/jit/unwindarm.cpp and https://github.com/dotnet/coreclr/blob/master/src/jit/unwindarm64.cpp",area-R2RDump,nattress,25/08/2018 6:28,
19659,Fix FileStream in WinRT build,,Fix FileStream in WinRT build ,area-System.IO,JeremyKuhne,25/08/2018 4:50,25/08/2018 10:25
19657,Unify the Interop xplatform.h file with the common coreclr test platformdefines.h ,"@luqunl 

See #19576","Unify the Interop xplatform.h file with the common coreclr test platformdefines.h  @luqunl 

See #19576",area-Interop,AaronRobinsonMSFT,25/08/2018 4:23,18/01/2019 11:58
19655,Zeroing stack by rep stosb instead of rep stosd,"Intel improved the performance of  and even faster on some platforms.

related to https://github.com/dotnet/coreclr/issues/19076
","Zeroing stack by rep stosb instead of rep stosd Intel improved the performance of  and even faster on some platforms.

related to https://github.com/dotnet/coreclr/issues/19076
",area-CodeGen,tannergooding,,
19654,P/Invoke custom marshaler sometimes fails type cast,"I'm trying to track down why [my upgrade](https://github.com/AArnott/Nerdbank.GitVersioning/pull/210) of libgit2sharp to 0.25.2 led to nerdbank.gitversioning to fail (reliably) on a seemingly random set of projects across multiple repos.

In [the failure](https://github.com/AArnott/Nerdbank.GitVersioning/issues/215) [a type check](https://github.com/libgit2/libgit2sharp/blob/5199c83d37f7baf5a775eacaffd66322b1d90ef1/LibGit2Sharp/Core/FilePathMarshaler.cs#L67) fails after passing through [a very clearly type constraining method](https://github.com/libgit2/libgit2sharp/blob/5199c83d37f7baf5a775eacaffd66322b1d90ef1/LibGit2Sharp/Core/NativeMethods.cs#L1395-L1398). Considering that perhaps it's a matter of assembly double-loading I checked. The managed debugger reports the assembly is loaded once and that the AssemblyLoadContext is the same at both points of the callstack leading up to the failure. 

This repros only on .NET Core (2.1) and does so on Windows and Linux (I didn't test Mac). This same code works fine within MSBuild running on the .NET Framework.

[The repro](https://github.com/AArnott/Nerdbank.GitVersioning/issues/215#issuecomment-415785686) is super reliable and relatively simple. @rainersigwald also has [a great repro](https://github.com/AArnott/Nerdbank.GitVersioning/issues/215#issuecomment-415774717).","P/Invoke custom marshaler sometimes fails type cast I'm trying to track down why [my upgrade](https://github.com/AArnott/Nerdbank.GitVersioning/pull/210) of libgit2sharp to 0.25.2 led to nerdbank.gitversioning to fail (reliably) on a seemingly random set of projects across multiple repos.

In [the failure](https://github.com/AArnott/Nerdbank.GitVersioning/issues/215) [a type check](https://github.com/libgit2/libgit2sharp/blob/5199c83d37f7baf5a775eacaffd66322b1d90ef1/LibGit2Sharp/Core/FilePathMarshaler.cs#L67) fails after passing through [a very clearly type constraining method](https://github.com/libgit2/libgit2sharp/blob/5199c83d37f7baf5a775eacaffd66322b1d90ef1/LibGit2Sharp/Core/NativeMethods.cs#L1395-L1398). Considering that perhaps it's a matter of assembly double-loading I checked. The managed debugger reports the assembly is loaded once and that the AssemblyLoadContext is the same at both points of the callstack leading up to the failure. 

This repros only on .NET Core (2.1) and does so on Windows and Linux (I didn't test Mac). This same code works fine within MSBuild running on the .NET Framework.

[The repro](https://github.com/AArnott/Nerdbank.GitVersioning/issues/215#issuecomment-415785686) is super reliable and relatively simple. @rainersigwald also has [a great repro](https://github.com/AArnott/Nerdbank.GitVersioning/issues/215#issuecomment-415774717).",area-Interop,AaronRobinsonMSFT,25/08/2018 4:05,15/01/2019 14:47
19652,[release/2.1] Arm stepping fix,"#### Description

A bit ago @chsienki and @davidwrighton made some fixes to debugging that ended up in master after the release/2.2 branch was created. In particular the castings from  were not preserving the thumb bit causing stepping in ARM debugging to break. Issue #19255 is requesting to port these fixes to 2.1 for servicing.

This PR ports the following PR's from master to 2.1 as requested:
- #17617
- #17879
- #17990
- #18129
- #18247
#### Customer Impact

Currently our debugging experience in ARM is not working as expected. In some scenarios stepping will fall into incorrect locations sometimes during testing we find breakpoints that will fire up twice. Some customers have asked us to address this (issue #19255).
#### Regression?

Not a regression.		 
#### Risk

The risk taken from this change should be fairly low. Mostly castings were fixed that were fixed which only turn the thumb bit for ARM (while having no change in other architectures) appropriately on code paths used by the debugger in the VM. ","[release/2.1] Arm stepping fix #### Description

A bit ago @chsienki and @davidwrighton made some fixes to debugging that ended up in master after the release/2.2 branch was created. In particular the castings from  were not preserving the thumb bit causing stepping in ARM debugging to break. Issue #19255 is requesting to port these fixes to 2.1 for servicing.

This PR ports the following PR's from master to 2.1 as requested:
- #17617
- #17879
- #17990
- #18129
- #18247
#### Customer Impact

Currently our debugging experience in ARM is not working as expected. In some scenarios stepping will fall into incorrect locations sometimes during testing we find breakpoints that will fire up twice. Some customers have asked us to address this (issue #19255).
#### Regression?

Not a regression.		 
#### Risk

The risk taken from this change should be fairly low. Mostly castings were fixed that were fixed which only turn the thumb bit for ARM (while having no change in other architectures) appropriately on code paths used by the debugger in the VM. ",Servicing-approved,hoyosjs,,
19651,x64 JIT stack-spilled call parameter lifetime bug,In the x64 JIT (FileVer output for clrjit.dll:  will be passed an invalid object address for parameter 4.,x64 JIT stack-spilled call parameter lifetime bug In the x64 JIT (FileVer output for clrjit.dll:  will be passed an invalid object address for parameter 4.,area-CodeGen,briansull,,
19650,[release/2.1] Determine memory load based on cgroup usage.,"Port #19518 to 2.1

CC @janvorli ","[release/2.1] Determine memory load based on cgroup usage. Port #19518 to 2.1

CC @janvorli ",Servicing-approved,janvorli,24/08/2018 17:22,1/09/2018 2:51
19649,Test failure: baseservices_threading._generics_WaitCallback_thread07_thread07_/_generics_WaitCallback_thread07_thread07_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.IO.FileNotFoundException: Could not load file or assembly 'System.Console Version=4.1.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
    
    /home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Work/4c4b8101-cb8e-49f3-8b01-707b8eaa4799/Unzip/generics/WaitCallback/thread07/thread07.sh: line 244: 98133 Aborted                 (core dumped) $_DebuggerFullPath \""$CORE_ROOT/corerun\"" $ExePath $CLRTestExecutionArguments
    
    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Work/4c4b8101-cb8e-49f3-8b01-707b8eaa4799/Unzip/Reports\\baseservices.threading\\generics\\WaitCallback\\thread07\\thread07.output.txt
    Raw output:
    BEGIN EXECUTION
    /home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Payload/corerun thread07.exe
    Expected: 100
    Actual: 134
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Payload
    > /home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Work/4c4b8101-cb8e-49f3-8b01-707b8eaa4799/Unzip/generics/WaitCallback/thread07/thread07.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

           at baseservices_threading._generics_WaitCallback_thread07_thread07_._generics_WaitCallback_thread07_thread07_cmd() in E:\A\_work\3\s\bin\tests\Windows_NT.x64.Release\TestWrappers\baseservices.threading\baseservices.threading.XUnitWrapper.cs:line 10191
Build : 3.0 - 20180824.01 (Ready-To-Run Tests)
Failing configurations:
- opensuse.423.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180824.01/workItem/baseservices.threading.XUnitWrapper/analysis/xunit/baseservices_threading._generics_WaitCallback_thread07_thread07_~2F_generics_WaitCallback_thread07_thread07_cmd","Test failure: baseservices_threading._generics_WaitCallback_thread07_thread07_/_generics_WaitCallback_thread07_thread07_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.IO.FileNotFoundException: Could not load file or assembly 'System.Console Version=4.1.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
    
    /home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Work/4c4b8101-cb8e-49f3-8b01-707b8eaa4799/Unzip/generics/WaitCallback/thread07/thread07.sh: line 244: 98133 Aborted                 (core dumped) $_DebuggerFullPath \""$CORE_ROOT/corerun\"" $ExePath $CLRTestExecutionArguments
    
    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Work/4c4b8101-cb8e-49f3-8b01-707b8eaa4799/Unzip/Reports\\baseservices.threading\\generics\\WaitCallback\\thread07\\thread07.output.txt
    Raw output:
    BEGIN EXECUTION
    /home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Payload/corerun thread07.exe
    Expected: 100
    Actual: 134
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Payload
    > /home/helixbot/dotnetbuild/work/f079d896-e097-4e55-a032-9f5058b6d014/Work/4c4b8101-cb8e-49f3-8b01-707b8eaa4799/Unzip/generics/WaitCallback/thread07/thread07.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

           at baseservices_threading._generics_WaitCallback_thread07_thread07_._generics_WaitCallback_thread07_thread07_cmd() in E:\A\_work\3\s\bin\tests\Windows_NT.x64.Release\TestWrappers\baseservices.threading\baseservices.threading.XUnitWrapper.cs:line 10191
Build : 3.0 - 20180824.01 (Ready-To-Run Tests)
Failing configurations:
- opensuse.423.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180824.01/workItem/baseservices.threading.XUnitWrapper/analysis/xunit/baseservices_threading._generics_WaitCallback_thread07_thread07_~2F_generics_WaitCallback_thread07_thread07_cmd",test-run-uwp-coreclr,RussKeldorph,24/08/2018 16:33,12/01/2019 9:14
19648,arm Ubuntu machines not processing jobs correctly,"Looks like all arm32 Ubuntu jobs are failing with something like:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_checked_ubuntu_innerloop_tst_prtest/3721/consoleFull

root job: https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_checked_ubuntu_innerloop_flow_prtest/

@dotnet/dnceng @mmitche @jashook @RussKeldorph @MattGal ","arm Ubuntu machines not processing jobs correctly Looks like all arm32 Ubuntu jobs are failing with something like:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_checked_ubuntu_innerloop_tst_prtest/3721/consoleFull

root job: https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_checked_ubuntu_innerloop_flow_prtest/

@dotnet/dnceng @mmitche @jashook @RussKeldorph @MattGal ",area-Infrastructure-coreclr,BruceForstall,24/08/2018 14:34,25/08/2018 3:35
19646,[NO MERGE] Add assert ImmedValNeedsReloc in optCreateAssertion,**NO MERGE** This is for testing ONLY,[NO MERGE] Add assert ImmedValNeedsReloc in optCreateAssertion **NO MERGE** This is for testing ONLY,* NO MERGE *,echesakovMSFT,24/08/2018 12:10,29/08/2018 11:26
19643,[WIP]In Win X64 Return value calling convention diffs between member function and static function…,"Partial fix : https://github.com/dotnet/coreclr/issues/19474
","[WIP]In Win X64, Return value calling convention diffs between member function and static function… Partial fix : https://github.com/dotnet/coreclr/issues/19474
",area-Interop,luqunl,24/08/2018 10:19,9/03/2019 14:52
19642,R2RDump - List of bugs when running R2RDump on CoreFX binaries,"There's an IndexOutOfRangeException when dumping an ARM ReadyToRun System.Private.Corelib.
It happens in R2RDump.NibbleReader.ReadNibble() when decoding fixups.
It also happens in GcTransitions.cs where the slotId is greater than the number of untracked slots","R2RDump - List of bugs when running R2RDump on CoreFX binaries There's an IndexOutOfRangeException when dumping an ARM ReadyToRun System.Private.Corelib.
It happens in R2RDump.NibbleReader.ReadNibble() when decoding fixups.
It also happens in GcTransitions.cs where the slotId is greater than the number of untracked slots",area-R2RDump,acmyu,24/08/2018 9:34,
19641,AppVerifier reports CoInitialize leak in coreclr,Sometimes we get ,AppVerifier reports CoInitialize leak in coreclr Sometimes we get ,area-Interop,jkotas,24/08/2018 8:44,
19640,Workaround to remove unnecessary bounds checks when using {ReadOnly}Span.IsEmpty,"Workaround for https://github.com/dotnet/coreclr/issues/19620



Disassembly for before/after:
![image](https://user-images.githubusercontent.com/6527137/44555124-90fe2b80-a6e8-11e8-882a-c2504ed34924.png)


cc @AndyAyersMS @benaadams @GrabYourPitchforks @mikedn  
","Workaround to remove unnecessary bounds checks when using {ReadOnly}Span.IsEmpty Workaround for https://github.com/dotnet/coreclr/issues/19620



Disassembly for before/after:
![image](https://user-images.githubusercontent.com/6527137/44555124-90fe2b80-a6e8-11e8-882a-c2504ed34924.png)


cc @AndyAyersMS @benaadams @GrabYourPitchforks @mikedn  
",area-System.Memory,ahsonkhan,,
19637,R2RDump CoreDisTools fails to decode on ARM,"Right now disasm works on all architectures except Arm. The TargetArch used by CoreDisTools is Target_Thumb but it reads an invalid assembly code and fails to decode it.

This does not happen in all cases. CoreDisTools worked for an Arm image generated for https://github.com/dotnet/coreclr/blob/master/tests/src/readytorun/r2rdump/files/GcInfoTransitions.cs but not for the other tests in https://github.com/dotnet/coreclr/tree/master/tests/src/readytorun/r2rdump/files","R2RDump CoreDisTools fails to decode on ARM Right now disasm works on all architectures except Arm. The TargetArch used by CoreDisTools is Target_Thumb but it reads an invalid assembly code and fails to decode it.

This does not happen in all cases. CoreDisTools worked for an Arm image generated for https://github.com/dotnet/coreclr/blob/master/tests/src/readytorun/r2rdump/files/GcInfoTransitions.cs but not for the other tests in https://github.com/dotnet/coreclr/tree/master/tests/src/readytorun/r2rdump/files",area-R2RDump,acmyu,24/08/2018 7:48,
19632,How do we debug this MissingMethodException ?,"Hello 
We are trying to update Sql Ops Studio to use a new set of SMO binaries (NetStandard) but one of our services crashes on startup with a MissingMethodException:


I tried setting a breakpoint on MemberLoader:ThrowMissingMethodException but the optimized native code doesn't lend itself to debugging. I didn't find anything more useful than what is already in the message.
","How do we debug this MissingMethodException ? Hello 
We are trying to update Sql Ops Studio to use a new set of SMO binaries (NetStandard) but one of our services crashes on startup with a MissingMethodException:


I tried setting a breakpoint on MemberLoader:ThrowMissingMethodException but the optimized native code doesn't lend itself to debugging. I didn't find anything more useful than what is already in the message.
",area-AssemblyLoader,vitek-karas,24/08/2018 3:27,22/09/2018 6:38
19630,WIP NO-MERGE dummy change to test dev/unix_test_workflow,,WIP NO-MERGE dummy change to test dev/unix_test_workflow ,* NO MERGE *,BruceForstall,24/08/2018 2:38,29/08/2018 8:54
19628,"Sub-optimal code when the operation ""% 1"" on integers is met","Currently the CLR gives result ""0"" (which seems correct) for ""remainder of 1"" operation on integers.

> The formula 

category:cq
theme:optimization
skill-level:beginner
cost:small","Sub-optimal code when the operation ""% 1"" on integers is met Currently the CLR gives result ""0"" (which seems correct) for ""remainder of 1"" operation on integers.

> The formula 

category:cq
theme:optimization
skill-level:beginner
cost:small",area-CodeGen,RussKeldorph,24/08/2018 0:47,
19624,Rewrite deleted tests when corefx Avx.PermuteVar signature changes are absorbed,"This issue tracks reenabling and adding missing  intrinsics. Relevant changes are in:

1. Coreclr - #19582 
2. Corefx - https://github.com/dotnet/corefx/pull/31864","Rewrite deleted tests when corefx Avx.PermuteVar signature changes are absorbed This issue tracks reenabling and adding missing  intrinsics. Relevant changes are in:

1. Coreclr - #19582 
2. Corefx - https://github.com/dotnet/corefx/pull/31864",area-CodeGen,4creators,23/08/2018 20:59,18/01/2019 6:10
19623,Fix FreeBSD build,,Fix FreeBSD build ,area-Infrastructure-coreclr,wfurt,23/08/2018 19:20,
19622,GetFunctionEnter3Info does not return correct argument address on Unix,"This is an issue I found while investigating an issue reported in this thread: https://github.com/dotnet/coreclr/issues/18977

See also: https://github.com/dotnet/docs/issues/6728

On Linux GetFunctionEnter3Info does not return the correct argument addresses (It returns correct numRanges and totalArgumentSize). I've successfully verified this issue on x64 (Ubuntu) but I have yet tried to repro this on other architectures (arm). 

The sample profilee is a very simple program with one function call. 


As shown above the argument address (0x00007fffffffbf50) is does not contain the function arguments (0xaa 0xbb 0xcc ""bar"")

","GetFunctionEnter3Info does not return correct argument address on Unix This is an issue I found while investigating an issue reported in this thread: https://github.com/dotnet/coreclr/issues/18977

See also: https://github.com/dotnet/docs/issues/6728

On Linux GetFunctionEnter3Info does not return the correct argument addresses (It returns correct numRanges and totalArgumentSize). I've successfully verified this issue on x64 (Ubuntu) but I have yet tried to repro this on other architectures (arm). 

The sample profilee is a very simple program with one function call. 


As shown above the argument address (0x00007fffffffbf50) is does not contain the function arguments (0xaa 0xbb 0xcc ""bar"")

",area-Diagnostics,davmason,,
19620,Extra bounds checks are being generated in common span usage pattern,"I would expect the following code to have no bounds checks within the disassembly beyond the explicit length check when accessing the data via the indexer:



[SharpLab Link](https://sharplab.io/#v2:C4LghgzgtgPgAgBgARwIwG4CwAoOBmFAJiQGEkBvHJalAtANiQCMB7FgGyQEkIAxASwBOEYAGUADmADGAUwAUAJRlgAJgHkAduwCeEsBoA8TbcBkA+ZgFcAZtZmCAlBSo1X/a0jlMbdwQDoAGRkNAHNgAAskAyRUJBgYK1t7AG0EAF0kAEIAXiQAcnyHF1cSlAB2JGswdggZLGxS6jgK4EFLOuKkAF8cLqA=)

Version: Microsoft.NETCore.App 3.0.0-preview1-26809-04

cc @AndyAyersMS @benaadams @GrabYourPitchforks 

category:cq
theme:range-check
skill-level:expert
cost:large","Extra bounds checks are being generated in common span usage pattern I would expect the following code to have no bounds checks within the disassembly beyond the explicit length check when accessing the data via the indexer:



[SharpLab Link](https://sharplab.io/#v2:C4LghgzgtgPgAgBgARwIwG4CwAoOBmFAJiQGEkBvHJalAtANiQCMB7FgGyQEkIAxASwBOEYAGUADmADGAUwAUAJRlgAJgHkAduwCeEsBoA8TbcBkA+ZgFcAZtZmCAlBSo1X/a0jlMbdwQDoAGRkNAHNgAAskAyRUJBgYK1t7AG0EAF0kAEIAXiQAcnyHF1cSlAB2JGswdggZLGxS6jgK4EFLOuKkAF8cLqA=)

Version: Microsoft.NETCore.App 3.0.0-preview1-26809-04

cc @AndyAyersMS @benaadams @GrabYourPitchforks 

category:cq
theme:range-check
skill-level:expert
cost:large",area-CodeGen,ahsonkhan,23/08/2018 13:36,
19616,R2RDump - List of sections not yet parsed,- [ ]  is not yet parsed correctly,R2RDump - List of sections not yet parsed - [ ]  is not yet parsed correctly,area-R2RDump,nattress,23/08/2018 8:41,
19615,Enable cron jobs Linux/arm64,,Enable cron jobs Linux/arm64 ,arch-arm64,BruceForstall,,
19614,[Windows|Arm64] init-tools.cmd supports native dotnet cli,https://github.com/dotnet/coreclr/pull/19213 Adds support for init-tools.cmd for arm64 using the x86 toolset. Once packages are produced for windows arm64 use the native dotnetcli.,[Windows|Arm64] init-tools.cmd supports native dotnet cli https://github.com/dotnet/coreclr/pull/19213 Adds support for init-tools.cmd for arm64 using the x86 toolset. Once packages are produced for windows arm64 use the native dotnetcli.,arch-arm64,jashook,23/08/2018 7:41,
19613,[WIP] add test for #18988,This PR is for test purpose only.,[WIP] add test for #18988 This PR is for test purpose only.,* NO MERGE *,sandreenko,23/08/2018 7:24,19/09/2018 3:38
19611,Documentation for EventPipe,We should have a walk through and some documentation on how to use EventPipe.,Documentation for EventPipe We should have a walk through and some documentation on how to use EventPipe.,EventPipe,brianrob,23/08/2018 6:52,
19608,Fix terminology in netci file,,Fix terminology in netci file ,area-Meta,kouvel,,
19607,Fix AsyncLocal<class> changed event to not be raised multiple times for one change in value (#17767),"Port of https://github.com/dotnet/coreclr/pull/17767 to 2.2

- Functional fix for https://github.com/dotnet/coreclr/issues/17758
- This was a regression in 2.1 fixing for 2.2","Fix AsyncLocal<class> changed event to not be raised multiple times for one change in value (#17767) Port of https://github.com/dotnet/coreclr/pull/17767 to 2.2

- Functional fix for https://github.com/dotnet/coreclr/issues/17758
- This was a regression in 2.1 fixing for 2.2",area-System.Threading,kouvel,,
19606,Fix a PAL spin lock issue,"Fixes https://github.com/dotnet/coreclr/issues/18486
- Lock release needs to be at least volatile

master PR: https://github.com/dotnet/coreclr/pull/19604","Fix a PAL spin lock issue Fixes https://github.com/dotnet/coreclr/issues/18486
- Lock release needs to be at least volatile

master PR: https://github.com/dotnet/coreclr/pull/19604",Servicing-approved,kouvel,,
19605,Fix a PAL spin lock issue,"Fix for https://github.com/dotnet/coreclr/issues/18486
- Lock release needs to be at least volatile

master PR: https://github.com/dotnet/coreclr/pull/19604","Fix a PAL spin lock issue Fix for https://github.com/dotnet/coreclr/issues/18486
- Lock release needs to be at least volatile

master PR: https://github.com/dotnet/coreclr/pull/19604",* NO MERGE *,kouvel,,
19604,Fix a PAL spin lock issue,"Fix for https://github.com/dotnet/coreclr/issues/18486
- Lock release needs to be at least volatile","Fix a PAL spin lock issue Fix for https://github.com/dotnet/coreclr/issues/18486
- Lock release needs to be at least volatile",area-PAL,kouvel,,
19603,[WIP] Enable tiered compilation,,[WIP] Enable tiered compilation ,* NO MERGE *,kouvel,,
19602,[WIP] Test CI,,[WIP] Test CI ,* NO MERGE *,kouvel,,
19601,RyuJIT: Incorrect 4-byte immediate emitted for shift causes access violation,In debug RyuJIT seems to try to emit a 4-byte immediate on a .,RyuJIT: Incorrect 4-byte immediate emitted for shift causes access violation In debug RyuJIT seems to try to emit a 4-byte immediate on a .,area-CodeGen,jkotas,23/08/2018 0:07,25/08/2018 1:04
19599,RyuJIT: Missing zeroing of upper bits for small struct used in Volatile.Read,"The example is:
","RyuJIT: Missing zeroing of upper bits for small struct used in Volatile.Read The example is:
",area-CodeGen,jkotas,22/08/2018 22:16,21/12/2018 11:10
19597,Enable eventpipe without restart dotnet process,"Is it any way to enable eventpipe diagnostics without restart dotnet process?
Performance problems with   my application do not start immediately but in around several days after launch.

Now for starting EventPipe diagnostics I need to enter next commands
export COMPlus_EnableEventPipe=1
export COMPlus_EventPipeConfig=Microsoft-DotNETCore-SampleProfiler:1:5

and restart dotnet process.

dotnet --info
Host (useful for support):
  Version: 2.1.2
  Commit:  811c3ce6c0
.NET Core SDKs installed:
  No SDKs were found.
.NET Core runtimes installed:
  Microsoft.NETCore.App 2.1.2 [/usr/share/dotnet/shared/Microsoft.NETCore.App]
To install additional .NET Core runtimes or SDKs:
  https://aka.ms/dotnet-download

","Enable eventpipe without restart dotnet process Is it any way to enable eventpipe diagnostics without restart dotnet process?
Performance problems with   my application do not start immediately but in around several days after launch.

Now for starting EventPipe diagnostics I need to enter next commands
export COMPlus_EnableEventPipe=1
export COMPlus_EventPipeConfig=Microsoft-DotNETCore-SampleProfiler:1:5

and restart dotnet process.

dotnet --info
Host (useful for support):
  Version: 2.1.2
  Commit:  811c3ce6c0
.NET Core SDKs installed:
  No SDKs were found.
.NET Core runtimes installed:
  Microsoft.NETCore.App 2.1.2 [/usr/share/dotnet/shared/Microsoft.NETCore.App]
To install additional .NET Core runtimes or SDKs:
  https://aka.ms/dotnet-download

",EventPipe,jkotas,22/08/2018 20:34,16/04/2019 3:47
19596,Consider implementing Ryu algorithm for double.ToString() ,"***Introduction***
A few months ago a new string formatting algorithm for floating point numbers was presented It is called 
Ryu and the benchmarks show it to be roughly ~3 times faster than the previously fastest algorithm Grisu3 (which was implemented in #14478 for 2.1).

The float version uses mainly ulong arithmetics + table lookups the double version uses mainly uint128 arithmetics + table lookups. 
The double version might be an interesting use case for the intrinsic code as e.g. 128bit shifts are SSE2.

As far as I see the fallback to the Dragon4 algorithm should not be necessary anymore with that algorithm and they claim it to be output-identical to grisu3 otherwise.

***References***
https://dl.acm.org/citation.cfm?id=3192369
https://pldi18.sigplan.org/event/pldi-2018-papers-ry-fast-float-to-string-conversion
https://github.com/ulfjack/ryu

Tags:
@mazong1123 Might be of interest for you as you did the Grisu3 implementation
@tannergooding I think you were looking for algorithms which might be worthwhile for intrinsic implementations
@danmosemsft For reference of https://github.com/dotnet/corefx/issues/31847

***Performance***

I did an experimental port of the current c implementation for the float datatype (https://github.com/ulfjack/ryu/blob/master/ryu/f2s.c)  to c# (purely mechanical just to get it working) and ran a few benchmarks myself and that naive conversion in C# was **~50%** faster than the current grisu3 algorithm. Assuming I didn't make any bad shortcuts in my benchmark I'd say a closer look might be worth it.


My naive conversion is below:

<details>


</details>
","Consider implementing Ryu algorithm for double.ToString()  ***Introduction***
A few months ago a new string formatting algorithm for floating point numbers was presented It is called 
Ryu and the benchmarks show it to be roughly ~3 times faster than the previously fastest algorithm Grisu3 (which was implemented in #14478 for 2.1).

The float version uses mainly ulong arithmetics + table lookups the double version uses mainly uint128 arithmetics + table lookups. 
The double version might be an interesting use case for the intrinsic code as e.g. 128bit shifts are SSE2.

As far as I see the fallback to the Dragon4 algorithm should not be necessary anymore with that algorithm and they claim it to be output-identical to grisu3 otherwise.

***References***
https://dl.acm.org/citation.cfm?id=3192369
https://pldi18.sigplan.org/event/pldi-2018-papers-ry-fast-float-to-string-conversion
https://github.com/ulfjack/ryu

Tags:
@mazong1123 Might be of interest for you as you did the Grisu3 implementation
@tannergooding I think you were looking for algorithms which might be worthwhile for intrinsic implementations
@danmosemsft For reference of https://github.com/dotnet/corefx/issues/31847

***Performance***

I did an experimental port of the current c implementation for the float datatype (https://github.com/ulfjack/ryu/blob/master/ryu/f2s.c)  to c# (purely mechanical just to get it working) and ran a few benchmarks myself and that naive conversion in C# was **~50%** faster than the current grisu3 algorithm. Assuming I didn't make any bad shortcuts in my benchmark I'd say a closer look might be worth it.


My naive conversion is below:

<details>


</details>
",area-System.Runtime,mazong1123,22/08/2018 17:45,
19595,[WIP] Enable tiering,,[WIP] Enable tiering ,* NO MERGE *,kouvel,,
19594,Newly implementd partial loop-unrolling support for RyuJIT ,This will replace PR : https://github.com/dotnet/coreclr/pull/18016,Newly implementd partial loop-unrolling support for RyuJIT  This will replace PR : https://github.com/dotnet/coreclr/pull/18016,area-CodeGen,AndyAyersMS,22/08/2018 14:40,7/11/2019 12:20
19592,R2RDump - Invalid Machine type in the COFF header for Linux images,"Right now for ReadyToRun images created on Linux R2RDump isn't able to read the Machine type (Amd64 arm etc.). When I use dumpbin /HEADERS for Linux native images the machine type is also unknown

It tries to read the machine type from the CoffHeader using the PEReader but gets a large number instead of a valid machine type. The R2RReader currently writes a warning and sets the machine to Amd64
","R2RDump - Invalid Machine type in the COFF header for Linux images Right now for ReadyToRun images created on Linux R2RDump isn't able to read the Machine type (Amd64 arm etc.). When I use dumpbin /HEADERS for Linux native images the machine type is also unknown

It tries to read the machine type from the CoffHeader using the PEReader but gets a large number instead of a valid machine type. The R2RReader currently writes a warning and sets the machine to Amd64
",area-ReadyToRun,acmyu,22/08/2018 11:07,24/08/2018 8:02
19591,Update RyuJIT overview and LSRA doc,"A number of changes have been made to the register allocator in particular #16517 and the documentation needs to be updated accordingly.

category:documentation
theme:ir
skill-level:expert
cost:medium","Update RyuJIT overview and LSRA doc A number of changes have been made to the register allocator in particular #16517 and the documentation needs to be updated accordingly.

category:documentation
theme:ir
skill-level:expert
cost:medium",area-CodeGen,CarolEidt,,
19587,[Win/x64] Visual Studio 2017 15.9.0 prerelease 1 fails to build coreclr repo,"Hitting reproducible build errors which indicate wrong environment for ml64.exe invocations - tool seems of the path at the moment of invocation or in general path is set for tools in build environment is wrong:

","[Win/x64] Visual Studio 2017 15.9.0 prerelease 1 fails to build coreclr repo Hitting reproducible build errors which indicate wrong environment for ml64.exe invocations - tool seems of the path at the moment of invocation or in general path is set for tools in build environment is wrong:

",area-Infrastructure-coreclr,jkotas,22/08/2018 6:57,26/08/2018 6:57
19584,Fix JitBench,"Fixes https://github.com/dotnet/coreclr/issues/19569
- I believe the issue was that JitBench (which was a netstandard1.6 project) was running against a netcoreapp3.0 layout with corerun (layout built using build + recent packages by runtests.cmd) and XmlDocument is in a different place now
- Copied the unofficial project and replaced the official one
- Switched to netcoreapp3.0 along with other miscellaneous fixes to get it working
- I haven't figured out yet how to get one project that builds with the test build and works with dotnet. TargetFramework would have to be different anyway if running with dotnet runtime 2.1. So the unofficial project is still there for use with dotnet.","Fix JitBench Fixes https://github.com/dotnet/coreclr/issues/19569
- I believe the issue was that JitBench (which was a netstandard1.6 project) was running against a netcoreapp3.0 layout with corerun (layout built using build + recent packages by runtests.cmd) and XmlDocument is in a different place now
- Copied the unofficial project and replaced the official one
- Switched to netcoreapp3.0 along with other miscellaneous fixes to get it working
- I haven't figured out yet how to get one project that builds with the test build and works with dotnet. TargetFramework would have to be different anyway if running with dotnet runtime 2.1. So the unofficial project is still there for use with dotnet.",area-Meta,kouvel,,
19583,RyuJIT: Incorrect ordering around Interlocked.Exchange and Interlocked.CompareExchange,"Example:
","RyuJIT: Incorrect ordering around Interlocked.Exchange and Interlocked.CompareExchange Example:
",area-CodeGen,jkotas,21/08/2018 20:50,25/01/2019 6:59
19578,csc.dll code 139 error when building project on .NET Core 2.1.302 Ubuntu 16.04 ARM64,"I have downloaded .NET Core SDK for linux ARM64 on my Jetson TX2 running ubuntu 16.04.




I wish to build iotedge for Jetson TX2 and dotnet Core 2.1 is a dependency for the same.

This is my binary log file. I had to rename it with a .zip extension to upload here.
just rename the file from msbuild.binlog.zip to msbuild.binlog

[msbuild.binlog.zip](https://github.com/dotnet/roslyn/files/2296720/msbuild.binlog.zip)


https://github.com/dotnet/roslyn/issues/29194","csc.dll code 139 error when building project on .NET Core 2.1.302 Ubuntu 16.04 ARM64 I have downloaded .NET Core SDK for linux ARM64 on my Jetson TX2 running ubuntu 16.04.




I wish to build iotedge for Jetson TX2 and dotnet Core 2.1 is a dependency for the same.

This is my binary log file. I had to rename it with a .zip extension to upload here.
just rename the file from msbuild.binlog.zip to msbuild.binlog

[msbuild.binlog.zip](https://github.com/dotnet/roslyn/files/2296720/msbuild.binlog.zip)


https://github.com/dotnet/roslyn/issues/29194",arch-arm64,jashook,,
19574,IBC Optimization changes broke some CoreCLR official builds,"Appears to be a side-effect of https://github.com/dotnet/coreclr/pull/19046  
@adiaaida please see me if I am mistaken or you need any assistance investigating.

Opened on behalf of @MattGal



Warnings: 1
Status Message: failed

Build : 3.0 - 20180821.01 (Product Build)
Failing configurations:
- Windows
  - PortableBuild-Checked-arm
  - PortableBuild-Checked-arm64
  - PortableBuild-Checked-x64
  - PortableBuild-Debug-arm
  - PortableBuild-Debug-arm64
  - PortableBuild-Debug-x64
  - PortableBuild-Release-arm
  - PortableBuild-Release-arm64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180821.01/workItem/Orchestration/analysis/external/Link)","IBC Optimization changes broke some CoreCLR official builds Appears to be a side-effect of https://github.com/dotnet/coreclr/pull/19046  
@adiaaida please see me if I am mistaken or you need any assistance investigating.

Opened on behalf of @MattGal



Warnings: 1
Status Message: failed

Build : 3.0 - 20180821.01 (Product Build)
Failing configurations:
- Windows
  - PortableBuild-Checked-arm
  - PortableBuild-Checked-arm64
  - PortableBuild-Checked-x64
  - PortableBuild-Debug-arm
  - PortableBuild-Debug-arm64
  - PortableBuild-Debug-x64
  - PortableBuild-Release-arm
  - PortableBuild-Release-arm64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180821.01/workItem/Orchestration/analysis/external/Link)",blocking-official-build,MattGal,21/08/2018 10:49,22/08/2018 3:30
19573,roundUp roundDn cleanup,"This PR overloads  at all? Its ""refCount"" is zero right now.","roundUp roundDn cleanup This PR overloads  at all? Its ""refCount"" is zero right now.",area-CodeGen,echesakovMSFT,21/08/2018 10:48,22/08/2018 3:56
19570,Fix dbgshim's > 1000 module bug (issue #19538) (#19553),"Fix dbgshim's > 1000 module bug (issue #19538)

Cap cbNeeded on second EnumProcessModules call. Change the allocations
to HMODULE to make sure they are aligned properly.","Fix dbgshim's > 1000 module bug (issue #19538) (#19553) Fix dbgshim's > 1000 module bug (issue #19538)

Cap cbNeeded on second EnumProcessModules call. Change the allocations
to HMODULE to make sure they are aligned properly.",,mikem8361,,
19569,CoreClr Performance Scenarios broke after PR #19479,"After https://github.com/dotnet/coreclr/pull/19479 the performance scenarios started failing with the following error:


/cc @noahfalk @AndyAyersMS ","CoreClr Performance Scenarios broke after PR #19479 After https://github.com/dotnet/coreclr/pull/19479 the performance scenarios started failing with the following error:


/cc @noahfalk @AndyAyersMS ",tenet-performance,kouvel,,
19568,[Ubuntu 16.04] PR #19525 might have introduced a regression on the CQ benchmarks,"The range of changes that are captured for the run that started showing the regression are these: https://github.com/dotnet/coreclr/compare/a81d9103d23f714a0bd3efb900321b0b9f383311...dotnet:0fc981abe7b9ca6898f157bc247edad265d4088b

This is an example of a single regression of ~24%
![capture](https://user-images.githubusercontent.com/12551699/44367867-d7a01b80-a485-11e8-90ef-76fa39ade628.PNG)

/cc @AndyAyersMS @noahfalk @kouvel ","[Ubuntu 16.04] PR #19525 might have introduced a regression on the CQ benchmarks The range of changes that are captured for the run that started showing the regression are these: https://github.com/dotnet/coreclr/compare/a81d9103d23f714a0bd3efb900321b0b9f383311...dotnet:0fc981abe7b9ca6898f157bc247edad265d4088b

This is an example of a single regression of ~24%
![capture](https://user-images.githubusercontent.com/12551699/44367867-d7a01b80-a485-11e8-90ef-76fa39ade628.PNG)

/cc @AndyAyersMS @noahfalk @kouvel ",tenet-performance,jorive,21/08/2018 7:41,22/08/2018 15:30
19567,Fix tiered compilation option for case-sensitive systems,,Fix tiered compilation option for case-sensitive systems ,area-TieredCompilation,jorive,21/08/2018 7:32,21/08/2018 11:38
19566,Interop request: Support exported symbols,"_From @MV10 on August 19 2018 17:5_

Request: Define a new attribute which maps a managed variable to an exported symbol exactly as we get today using  blocks based on Runtime Identifier build constants once I figure out how it works on the other platforms.

(On a related note I noticed in #24444 the OP asks about _data_ and interfaces but it seems the data portion of the question was overlooked.)

_Copied from original issue: dotnet/corefx#31836_","Interop request: Support exported symbols _From @MV10 on August 19 2018 17:5_

Request: Define a new attribute which maps a managed variable to an exported symbol exactly as we get today using  blocks based on Runtime Identifier build constants once I figure out how it works on the other platforms.

(On a related note I noticed in #24444 the OP asks about _data_ and interfaces but it seems the data portion of the question was overlooked.)

_Copied from original issue: dotnet/corefx#31836_",area-Interop,jkotas,21/08/2018 5:29,
19565,Add no-tiering CI jobs for testing with tiering enabled,"This ports the following PRs to 2.2:
- https://github.com/dotnet/coreclr/pull/18828
- https://github.com/dotnet/coreclr/pull/18864
- https://github.com/dotnet/coreclr/pull/18953
- https://github.com/dotnet/coreclr/pull/19123

See the individual commit descriptions for more info. It looks like the changes need to be merged before the CI jobs can be kicked off for testing them with tiering enabled.","Add no-tiering CI jobs for testing with tiering enabled This ports the following PRs to 2.2:
- https://github.com/dotnet/coreclr/pull/18828
- https://github.com/dotnet/coreclr/pull/18864
- https://github.com/dotnet/coreclr/pull/18953
- https://github.com/dotnet/coreclr/pull/19123

See the individual commit descriptions for more info. It looks like the changes need to be merged before the CI jobs can be kicked off for testing them with tiering enabled.",area-Meta,kouvel,,
19564,R2RDump with x86 disassembler architecture fails to disassemble R2R images,"On my x64 machine I generated a R2R image with crossgen then tried to disassemble with two different R2RDump builds. The x64 version of the tools will disassemble correctly but the x86 version of the tools will fail with an AV. This has been replaced with an exception for the time being but the behavior needs to be fixed

## x64 CoreDisTools disassembling an x64 R2R image
1. dotnet build --runtime win-x64
2. E:\git\dotnet\coreclr\bin\Product\Windows_NT.x64.Debug\netcoreapp2.0\win-x64\R2RDump.exe --in MultipleRuntimeFunctions.ni.dll --disasm


","R2RDump with x86 disassembler architecture fails to disassemble R2R images On my x64 machine I generated a R2R image with crossgen then tried to disassemble with two different R2RDump builds. The x64 version of the tools will disassemble correctly but the x86 version of the tools will fail with an AV. This has been replaced with an exception for the time being but the behavior needs to be fixed

## x64 CoreDisTools disassembling an x64 R2R image
1. dotnet build --runtime win-x64
2. E:\git\dotnet\coreclr\bin\Product\Windows_NT.x64.Debug\netcoreapp2.0\win-x64\R2RDump.exe --in MultipleRuntimeFunctions.ni.dll --disasm


",area-R2RDump,RussKeldorph,21/08/2018 2:51,
19560,Clean up register preservation requirements for Enter callback,"#19023 


I'm still testing this so adding NO_MERGE tag even if CI suggests it is good.

@BruceForstall - PTAL
cc @sergign60 ","Clean up register preservation requirements for Enter callback #19023 


I'm still testing this so adding NO_MERGE tag even if CI suggests it is good.

@BruceForstall - PTAL
cc @sergign60 ",* NO MERGE *,echesakovMSFT,,
19558,RyuJIT: Mishandling of subrange assertion for rewritten call parameter,"The example is:
 to 0 in release) (edit: updated example).

@mikedn has analyzed it here: https://github.com/dotnet/coreclr/issues/18867#issuecomment-413246494","RyuJIT: Mishandling of subrange assertion for rewritten call parameter The example is:
 to 0 in release) (edit: updated example).

@mikedn has analyzed it here: https://github.com/dotnet/coreclr/issues/18867#issuecomment-413246494",area-CodeGen,mikedn,20/08/2018 7:13,6/12/2018 9:26
19555,lzcnt tzcnt popcnt false dependency not handled in CoreCLR,"Hi
Following my successful foray into the brave world of CoreCLR architecture specific intrinsics I think I stumbled upon a relatively known bug/deficiency in most intel CPUs (I have no knowledge on how this affects AMD CPUs if at all) that is now affecting perf on CoreCLR.

It appears that when I write a tight / unrolled loop with any of the intrinsics mentioned in the issue name:
* 

Would this be something that CoreCLR JIT could dynamically detect (according to CPU model/family) and insert into the instruction stream?
","lzcnt, tzcnt, popcnt false dependency not handled in CoreCLR Hi
Following my successful foray into the brave world of CoreCLR architecture specific intrinsics I think I stumbled upon a relatively known bug/deficiency in most intel CPUs (I have no knowledge on how this affects AMD CPUs if at all) that is now affecting perf on CoreCLR.

It appears that when I write a tight / unrolled loop with any of the intrinsics mentioned in the issue name:
* 

Would this be something that CoreCLR JIT could dynamically detect (according to CPU model/family) and insert into the instruction stream?
",area-CodeGen,fiigii,19/08/2018 17:02,1/09/2018 3:21
19553,Fix dbgshim's > 1000 module bug (issue #19538),,Fix dbgshim's > 1000 module bug (issue #19538) ,area-Diagnostics,mikem8361,,
19550,Codegen for Hardware Intrinsics arithmetic operations memory operands is poor,"Majority of hardware intrinsics arithmetic operations support using memory address as one of it's operands. It allows to write more efficient code which would bypass memory bottlenecks. Unfortunately jit does not fold memory loads into one of arithmetic operation operands and generates code for separate loads or stores.

The following example illustrates the problem (expression was specifically written to hint jit that second subtraction operand should not be loaded but folded into memory operand):

 reads into memory operands. Unfortunately the burden to write more code would make use of intrinsics even more harder and some developers would not even know how to use that support without digging into docs. 

IMHO the best solution would be to expand API surface as this would be self documenting enhancement. Furthermore from my experience managing data flow through memory avoiding memory wall while using HW intrinsics is one of the most difficult parts of the coding with them.

cc @AndyAyersMS  @CarolEidt @eerhardt @fiigii @tannergooding ","Codegen for Hardware Intrinsics arithmetic operations memory operands is poor Majority of hardware intrinsics arithmetic operations support using memory address as one of it's operands. It allows to write more efficient code which would bypass memory bottlenecks. Unfortunately jit does not fold memory loads into one of arithmetic operation operands and generates code for separate loads or stores.

The following example illustrates the problem (expression was specifically written to hint jit that second subtraction operand should not be loaded but folded into memory operand):

 reads into memory operands. Unfortunately the burden to write more code would make use of intrinsics even more harder and some developers would not even know how to use that support without digging into docs. 

IMHO the best solution would be to expand API surface as this would be self documenting enhancement. Furthermore from my experience managing data flow through memory avoiding memory wall while using HW intrinsics is one of the most difficult parts of the coding with them.

cc @AndyAyersMS  @CarolEidt @eerhardt @fiigii @tannergooding ",area-CodeGen,CarolEidt,,
19549,Set BUILDTOOLS_SOURCE to local buildtools package dir results in build error,"It seems building coreclr with using locally built buildtools packages fail. I spent couple of hours trying to find the cause I thought it was related with changes I made in buildtools but that also happens when building buildtools from master. I wonder that nobody else hit this therefore I'm not entirely sure if I'm the only one hitting this?

Repro:

","Set BUILDTOOLS_SOURCE to local buildtools package dir results in build error It seems building coreclr with using locally built buildtools packages fail. I spent couple of hours trying to find the cause I thought it was related with changes I made in buildtools but that also happens when building buildtools from master. I wonder that nobody else hit this therefore I'm not entirely sure if I'm the only one hitting this?

Repro:

",area-Infrastructure-coreclr,ViktorHofer,18/08/2018 22:17,
19548,Fix issues with calling convention in tests.,"Fixes #19540 

cc @BruceForstall ","Fix issues with calling convention in tests. Fixes #19540 

cc @BruceForstall ",test bug,BruceForstall,18/08/2018 17:20,21/08/2018 5:00
19545,[WIP] Use target_ssize_t for Lowering::CastInfo::typeMin typeMax typeMask,,[WIP] Use target_ssize_t for Lowering::CastInfo::typeMin typeMax typeMask ,* NO MERGE *,echesakovMSFT,18/08/2018 11:22,8/09/2018 2:16
19544,Use target_ssize_t imm in CodeGen CodeGenInterface,In order to get rid off compilation warnings in cross-bitness compilation scenario  for immediate value argument.,Use target_ssize_t imm in CodeGen CodeGenInterface In order to get rid off compilation warnings in cross-bitness compilation scenario  for immediate value argument.,arch-arm32,echesakovMSFT,18/08/2018 11:15,21/08/2018 13:19
19542,Enable mixed mode assembly loading,"Selectively brings back the deleted code to support mixed mode assembly loading a managed->native calls. Code for native->managed and activation will be in future changes. Also includes a simple test case.

Contributes to https://github.com/dotnet/coreclr/issues/18013","Enable mixed mode assembly loading Selectively brings back the deleted code to support mixed mode assembly loading a managed->native calls. Code for native->managed and activation will be in future changes. Also includes a simple test case.

Contributes to https://github.com/dotnet/coreclr/issues/18013",area-Interop,morganbr,,
19540,Windows x86 tests failing due to missing native dll entrypoints,"Windows test runs are failing due to native components having missing entrypoints. There are 4 test failures. E.g.

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/x86_checked_windows_nt/5151/



This appears to be due to the build changes in https://github.com/dotnet/coreclr/pull/19430.

","Windows x86 tests failing due to missing native dll entrypoints Windows test runs are failing due to native components having missing entrypoints. There are 4 test failures. E.g.

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/x86_checked_windows_nt/5151/



This appears to be due to the build changes in https://github.com/dotnet/coreclr/pull/19430.

",area-Infrastructure-coreclr,AaronRobinsonMSFT,,
19539, Free the alternate signal stack if this PAL's thread allocated it.,Pass the CPalThread instance through to EnsureSignalAlternateStack and save the altstack pointer allocated.   And in FreeSignalAlternateStack use this pointer to ensure that only the proper PAL frees the stack., Free the alternate signal stack if this PAL's thread allocated it. Pass the CPalThread instance through to EnsureSignalAlternateStack and save the altstack pointer allocated.   And in FreeSignalAlternateStack use this pointer to ensure that only the proper PAL frees the stack.,,mikem8361,,
19538,dbgshim.dll!EnumerateCLRs may crash with >1000 modules,[EnumerateCLRs](https://github.com/dotnet/coreclr/blob/0f0320e58fd006a02cdecf7ae45426f54da333e5/src/dlls/dbgshim/dbgshim.cpp#L1095) may crash when inspecting a process with >1000 modules. The issue is that the behavior of [EnumProcessModules](https://docs.microsoft.com/en-us/windows/desktop/api/psapi/nf-psapi-enumprocessmodules#remarks) in the case that more modules are loaded than there is space in the provided buffer is to return TRUE and set cbNeeded to the size to allocate. But this code assumes that cbNeeded will always be <= the size of ,dbgshim.dll!EnumerateCLRs may crash with >1000 modules [EnumerateCLRs](https://github.com/dotnet/coreclr/blob/0f0320e58fd006a02cdecf7ae45426f54da333e5/src/dlls/dbgshim/dbgshim.cpp#L1095) may crash when inspecting a process with >1000 modules. The issue is that the behavior of [EnumProcessModules](https://docs.microsoft.com/en-us/windows/desktop/api/psapi/nf-psapi-enumprocessmodules#remarks) in the case that more modules are loaded than there is space in the provided buffer is to return TRUE and set cbNeeded to the size to allocate. But this code assumes that cbNeeded will always be <= the size of ,area-Diagnostics,mikem8361,,
19537,[Ubuntu/arm32] Assertion failed '(regSet.rsMaskResvd & RBM_OPT_RSVD) != 0',"In corefx testing System.Numerics.Vectors.Tests:



Happens for various JitStressRegs stress modes (list may not be exhaustive):

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs3_tst/20/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs4_flow/20/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_tieredcompilation_flow/8/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs1_flow/21/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x10_flow/22/

This is a recent regression.

@dotnet/arm32-contrib @CarolEidt ","[Ubuntu/arm32] Assertion failed '(regSet.rsMaskResvd & RBM_OPT_RSVD) != 0' In corefx testing System.Numerics.Vectors.Tests:



Happens for various JitStressRegs stress modes (list may not be exhaustive):

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs3_tst/20/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs4_flow/20/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_tieredcompilation_flow/8/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs1_flow/21/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x10_flow/22/

This is a recent regression.

@dotnet/arm32-contrib @CarolEidt ",arch-arm32,BruceForstall,,
19536,Fix wrong sprinf_s format string in gtGetArgMsg getGetLateArgMsg on ARM32,One liner that fixes typo in  for arguments passed on stack,Fix wrong sprinf_s format string in gtGetArgMsg getGetLateArgMsg on ARM32 One liner that fixes typo in  for arguments passed on stack,arch-arm32,echesakovMSFT,18/08/2018 8:13,19/08/2018 11:03
19535,[NO MERGE] Test Linux Binaries,The updated binaries were a commit behind. Connected to https://github.com/dotnet/coreclr/pull/19393 ,[NO MERGE] Test Linux Binaries The updated binaries were a commit behind. Connected to https://github.com/dotnet/coreclr/pull/19393 ,* NO MERGE *,A-And,18/08/2018 7:25,24/08/2018 6:48
19529,Create New Minimal Start From Scratch CoreClr,How to create new minimal start from scratch CoreClr?,Create New Minimal Start From Scratch CoreClr How to create new minimal start from scratch CoreClr?,question,AaronRobinsonMSFT,17/08/2018 15:30,21/08/2018 14:02
19527,Remove tests previously ported to CoreFX repo,"Ported tests in dotnet/corefx#30690

cc @luqunl ","Remove tests previously ported to CoreFX repo Ported tests in dotnet/corefx#30690

cc @luqunl ",area-Interop,AaronRobinsonMSFT,17/08/2018 11:04,18/08/2018 4:09
19526,Only register signals and create alt exception stack in coreclr,"Only register signals and create alt exception stack in coreclr. (#19309)

There was a couple of places where the DAC (IsValidObject GetAppDomainForObject)
assumed that a NULL target/debuggee address would throw an exception that would
be caught by try/catch. Any other invalid address is handled with a software
exception throwed by the read memory functions. In general it is a better overall
design not to have any of the DBI/DAC etc. code depend on hardware exceptions
being caught. On Linux the C++ runtime sometimes can't handle it. There is a
slight risk that there are other places in the DAC that make the NULL address
assumption but testing so far has found any.

Added PAL_SetInitializeDLLFlags as a fallback to allow the PAL_InitializeDLL flags
to be set for a PAL instance for the DAC where we could still register h/w signals
but not the altstack switching to reduce this risk. The flags can't be build time
conditional because we only build one coreclrpal.a library that all the modules
used. Having a PAL_InitializeWithFlags function doesn't really help either because of
the PAL_RegisterModule call to PAL_IntializeDLL and the LoadLibrary dance/protocol
that uses it to call the loading module's DLLMain.

Add PAL_SetInitializeFlags; remove flags from PAL_INITIALIZE and PAL_INITIALIZE_DLL
default. Add PAL_InitializeWithFlags() to allowing the default to be overriden.","Only register signals and create alt exception stack in coreclr Only register signals and create alt exception stack in coreclr. (#19309)

There was a couple of places where the DAC (IsValidObject GetAppDomainForObject)
assumed that a NULL target/debuggee address would throw an exception that would
be caught by try/catch. Any other invalid address is handled with a software
exception throwed by the read memory functions. In general it is a better overall
design not to have any of the DBI/DAC etc. code depend on hardware exceptions
being caught. On Linux the C++ runtime sometimes can't handle it. There is a
slight risk that there are other places in the DAC that make the NULL address
assumption but testing so far has found any.

Added PAL_SetInitializeDLLFlags as a fallback to allow the PAL_InitializeDLL flags
to be set for a PAL instance for the DAC where we could still register h/w signals
but not the altstack switching to reduce this risk. The flags can't be build time
conditional because we only build one coreclrpal.a library that all the modules
used. Having a PAL_InitializeWithFlags function doesn't really help either because of
the PAL_RegisterModule call to PAL_IntializeDLL and the LoadLibrary dance/protocol
that uses it to call the loading module's DLLMain.

Add PAL_SetInitializeFlags; remove flags from PAL_INITIALIZE and PAL_INITIALIZE_DLL
default. Add PAL_InitializeWithFlags() to allowing the default to be overriden.",,mikem8361,,
19525,Enable Tiered Compilation by default,"1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.
5) Adjust config names for JitBench","Enable Tiered Compilation by default 1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.
5) Adjust config names for JitBench",area-VM,kouvel,,
19523,[WIP] Test with tiering,,[WIP] Test with tiering ,* NO MERGE *,kouvel,,
19522,"Codegen for `StoreVector128` followed by return is ""poor""","As per the comment here: https://github.com/dotnet/corefx/pull/31779/files#r210759586

The 

category:cq
theme:vector-codegen
skill-level:intermediate
cost:medium","Codegen for 

category:cq
theme:vector-codegen
skill-level:intermediate
cost:medium",area-CodeGen,fiigii,17/08/2018 8:41,
19521,"Codegen for `LoadVector128` for a field of a struct is ""poor""","As per the comment here: https://github.com/dotnet/corefx/pull/31779/files#r210758497

The ",Codegen for ,area-CodeGen,CarolEidt,,
19519,Add a flag to enable/disable hw intrinsics,This could potentially be a a  as the JIT relies on that flag for much of the code that supports the vector types.,Add a flag to enable/disable hw intrinsics This could potentially be a a  as the JIT relies on that flag for much of the code that supports the vector types.,area-CodeGen,CarolEidt,17/08/2018 3:13,1/11/2018 2:46
19517,C# Wpf Image Memory with High Resolution images(7680 X 2180) ,"Problem:- WPF image holds memory. when I select an image from the directory and displayed to the image after click on destroy-image-button image is destroyed but memory is still on hold as per TaskManager and after done the same operation many times application will crash outof memory exception.. this issue is with High Resolution images(7680 X 2180)

An unhandled exception of type 'System.OutOfMemoryException' occurred in PresentationCore.dll

{The function evaluation was disabled because of an out of memory exception.}

Code & Steps:-

I just simply select the image from the directory and displayed to the WPF image

    private void ImgDisplay_Click(object sender RoutedEventArgs e)
    {
        image.Source = new BitmapImage(new Uri(filePath));
    }

    private void ImgDistry_Click(object sender RoutedEventArgs e)
    {
        image.Source = null;
    }

    private void ImgSelect_Click(object sender RoutedEventArgs e)
    {
        OpenFileDialog openFileDialog1 = new OpenFileDialog();
        openFileDialog1.ShowDialog();
        filePath = openFileDialog1.FileName;
    }

<Window x:Class=""WpfApplication4.MainWindow""
    xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation""
    xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" 
    Title=""MainWindow"" Background=""Transparent"" MaxHeight=""1080"" MaxWidth=""1920"">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height=""Auto""></RowDefinition>
        <RowDefinition Height=""*""></RowDefinition>
        <RowDefinition Height=""Auto""></RowDefinition>
    </Grid.RowDefinitions>
    <Grid Margin=""5"">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width=""Auto""></ColumnDefinition>
            <ColumnDefinition Width=""Auto""></ColumnDefinition>
            <ColumnDefinition Width=""Auto""></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <Button Height=""40"" Width=""120"" Background=""Green"" Name=""ImgDisplay"" Foreground=""White"" Content=""Display Image"" Click=""ImgDisplay_Click"" />
        <Button Margin=""100100"" Grid.Column=""1"" Height=""40"" Width=""120"" Name=""ImgDistry"" Content=""Distroy Image"" Background=""Red"" Foreground=""White"" Click=""ImgDistry_Click"" />
        <Button Grid.Column=""2"" Height=""40"" Width=""120"" x:Name=""ImgDistry_Copy"" Content=""Select Image"" Background=""Yellow"" Foreground=""Black"" Click=""ImgSelect_Click"" />
    </Grid>
    <ScrollViewer Grid.Row=""1"">
        <Image Name=""image""/>
    </ScrollViewer>
</Grid>
After select image from the directory

![6](https://user-images.githubusercontent.com/3060341/44206873-d6ff4080-a178-11e8-97b7-1f53f56c1007.png)
![7](https://user-images.githubusercontent.com/3060341/44206874-d6ff4080-a178-11e8-83af-cf1bb1d0f417.png)
![8](https://user-images.githubusercontent.com/3060341/44206875-d797d700-a178-11e8-899b-cafec48707df.png)


After doing 2-3 time same operation select image then destroy.. memory is increasing after each operation

Memory 
High Resolution images that i used you can download from here https://www.dropbox.com/s/fiodfaedwabtkgg/1.png?dl=0 https://www.dropbox.com/s/2bk0qm1clx4bgq1/2.png?dl=0 https://www.dropbox.com/s/6evtsqmqthu60mu/3.png?dl=0 https://www.dropbox.com/s/6p3o36wcires2jn/4.png?dl=0 https://www.dropbox.com/s/k5t1y9apcj4oee4/5.png?dl=0","C# Wpf Image Memory with High Resolution images(7680 X 2180)  Problem:- WPF image holds memory. when I select an image from the directory and displayed to the image after click on destroy-image-button image is destroyed but memory is still on hold as per TaskManager and after done the same operation many times application will crash outof memory exception.. this issue is with High Resolution images(7680 X 2180)

An unhandled exception of type 'System.OutOfMemoryException' occurred in PresentationCore.dll

{The function evaluation was disabled because of an out of memory exception.}

Code & Steps:-

I just simply select the image from the directory and displayed to the WPF image

    private void ImgDisplay_Click(object sender RoutedEventArgs e)
    {
        image.Source = new BitmapImage(new Uri(filePath));
    }

    private void ImgDistry_Click(object sender RoutedEventArgs e)
    {
        image.Source = null;
    }

    private void ImgSelect_Click(object sender RoutedEventArgs e)
    {
        OpenFileDialog openFileDialog1 = new OpenFileDialog();
        openFileDialog1.ShowDialog();
        filePath = openFileDialog1.FileName;
    }

<Window x:Class=""WpfApplication4.MainWindow""
    xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation""
    xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" 
    Title=""MainWindow"" Background=""Transparent"" MaxHeight=""1080"" MaxWidth=""1920"">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height=""Auto""></RowDefinition>
        <RowDefinition Height=""*""></RowDefinition>
        <RowDefinition Height=""Auto""></RowDefinition>
    </Grid.RowDefinitions>
    <Grid Margin=""5"">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width=""Auto""></ColumnDefinition>
            <ColumnDefinition Width=""Auto""></ColumnDefinition>
            <ColumnDefinition Width=""Auto""></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <Button Height=""40"" Width=""120"" Background=""Green"" Name=""ImgDisplay"" Foreground=""White"" Content=""Display Image"" Click=""ImgDisplay_Click"" />
        <Button Margin=""100100"" Grid.Column=""1"" Height=""40"" Width=""120"" Name=""ImgDistry"" Content=""Distroy Image"" Background=""Red"" Foreground=""White"" Click=""ImgDistry_Click"" />
        <Button Grid.Column=""2"" Height=""40"" Width=""120"" x:Name=""ImgDistry_Copy"" Content=""Select Image"" Background=""Yellow"" Foreground=""Black"" Click=""ImgSelect_Click"" />
    </Grid>
    <ScrollViewer Grid.Row=""1"">
        <Image Name=""image""/>
    </ScrollViewer>
</Grid>
After select image from the directory

![6](https://user-images.githubusercontent.com/3060341/44206873-d6ff4080-a178-11e8-97b7-1f53f56c1007.png)
![7](https://user-images.githubusercontent.com/3060341/44206874-d6ff4080-a178-11e8-83af-cf1bb1d0f417.png)
![8](https://user-images.githubusercontent.com/3060341/44206875-d797d700-a178-11e8-899b-cafec48707df.png)


After doing 2-3 time same operation select image then destroy.. memory is increasing after each operation

Memory 
High Resolution images that i used you can download from here https://www.dropbox.com/s/fiodfaedwabtkgg/1.png?dl=0 https://www.dropbox.com/s/2bk0qm1clx4bgq1/2.png?dl=0 https://www.dropbox.com/s/6evtsqmqthu60mu/3.png?dl=0 https://www.dropbox.com/s/6p3o36wcires2jn/4.png?dl=0 https://www.dropbox.com/s/k5t1y9apcj4oee4/5.png?dl=0",question,AaronRobinsonMSFT,16/08/2018 21:52,17/08/2018 12:33
19515,Test failure: baseservices_threading._waithandle_waitany_waitanyex2_waitanyex2_/_waithandle_waitany_waitanyex2_waitanyex2_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Work\\457012a7-5afe-4a4f-9d87-581100372ea8\\Unzip\\Reports\\baseservices.threading\\waithandle\\waitany\\waitanyex2\\waitanyex2.output.txt
    Raw output:
    BEGIN EXECUTION\r
            1 file(s) copied.\r
    \"" C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Payload\\crossgen.exe\"" /Platform_Assemblies_Paths C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Payload;C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Work\\457012a7-5afe-4a4f-9d87-581100372ea8\\Unzip\\waithandle\\waitany\\waitanyex2\\IL;C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Work\\457012a7-5afe-4a4f-9d87-581100372ea8\\Unzip\\waithandle\\waitany\\waitanyex2 /in waitanyex2.org /out waitanyex2.exe\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image waitanyex2.exe generated successfully.\r
     \""C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Payload\\corerun.exe\"" waitanyex2.exe \r
    Name created: 7e4acc81-1909-4e61-bdea-8c2706c913fd\r
    Testing Mutex and non-Mutex and signaling the other element\r
    Acquire the Mutex\r
    Holding the Mutex\r
    Waiting...\r
    WaitAny did not throw AbandonedMutexException. Result: 1\r
    Test Failed\r
    Expected: 100\r
    Actual: -1\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Payload
    > C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Work\\457012a7-5afe-4a4f-9d87-581100372ea8\\Unzip\\waithandle\\waitany\\waitanyex2\\waitanyex2.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

           at baseservices_threading._waithandle_waitany_waitanyex2_waitanyex2_._waithandle_waitany_waitanyex2_waitanyex2_cmd() in E:\A\_work\4\s\bin\tests\Windows_NT.arm.Release\TestWrappers\baseservices.threading\baseservices.threading.XUnitWrapper.cs:line 28809
Build : 3.0 - 20180816.01 (Ready-To-Run Tests)
Failing configurations:
- windows.10.arm64
  - arm

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180816.01/workItem/baseservices.threading.XUnitWrapper/analysis/xunit/baseservices_threading._waithandle_waitany_waitanyex2_waitanyex2_~2F_waithandle_waitany_waitanyex2_waitanyex2_cmd","Test failure: baseservices_threading._waithandle_waitany_waitanyex2_waitanyex2_/_waithandle_waitany_waitanyex2_waitanyex2_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Work\\457012a7-5afe-4a4f-9d87-581100372ea8\\Unzip\\Reports\\baseservices.threading\\waithandle\\waitany\\waitanyex2\\waitanyex2.output.txt
    Raw output:
    BEGIN EXECUTION\r
            1 file(s) copied.\r
    \"" C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Payload\\crossgen.exe\"" /Platform_Assemblies_Paths C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Payload;C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Work\\457012a7-5afe-4a4f-9d87-581100372ea8\\Unzip\\waithandle\\waitany\\waitanyex2\\IL;C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Work\\457012a7-5afe-4a4f-9d87-581100372ea8\\Unzip\\waithandle\\waitany\\waitanyex2 /in waitanyex2.org /out waitanyex2.exe\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image waitanyex2.exe generated successfully.\r
     \""C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Payload\\corerun.exe\"" waitanyex2.exe \r
    Name created: 7e4acc81-1909-4e61-bdea-8c2706c913fd\r
    Testing Mutex and non-Mutex and signaling the other element\r
    Acquire the Mutex\r
    Holding the Mutex\r
    Waiting...\r
    WaitAny did not throw AbandonedMutexException. Result: 1\r
    Test Failed\r
    Expected: 100\r
    Actual: -1\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Payload
    > C:\\dotnetbuild\\work\\524acbd1-5cfb-4adc-80ec-d2cfa306e357\\Work\\457012a7-5afe-4a4f-9d87-581100372ea8\\Unzip\\waithandle\\waitany\\waitanyex2\\waitanyex2.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

           at baseservices_threading._waithandle_waitany_waitanyex2_waitanyex2_._waithandle_waitany_waitanyex2_waitanyex2_cmd() in E:\A\_work\4\s\bin\tests\Windows_NT.arm.Release\TestWrappers\baseservices.threading\baseservices.threading.XUnitWrapper.cs:line 28809
Build : 3.0 - 20180816.01 (Ready-To-Run Tests)
Failing configurations:
- windows.10.arm64
  - arm

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180816.01/workItem/baseservices.threading.XUnitWrapper/analysis/xunit/baseservices_threading._waithandle_waitany_waitanyex2_waitanyex2_~2F_waithandle_waitany_waitanyex2_waitanyex2_cmd",area-System.Threading,RussKeldorph,16/08/2018 13:46,26/07/2019 11:05
19509,[WIP] Test with tiering enabled,,[WIP] Test with tiering enabled ,* NO MERGE *,kouvel,,
19508,Make file handle checks accurate on Windows,"We can actually check the async state of a handle on Windows so check directly when we have the API available. It is faster and more reliable as the state is literally a flag on the handle.

Also allow all filetypes through when explicitly using extended syntax  . This unblocks a number of advanced customer scenarios.

Fixes https://github.com/dotnet/corefx/issues/187.
","Make file handle checks accurate on Windows We can actually check the async state of a handle on Windows so check directly when we have the API available. It is faster and more reliable as the state is literally a flag on the handle.

Also allow all filetypes through when explicitly using extended syntax  . This unblocks a number of advanced customer scenarios.

Fixes https://github.com/dotnet/corefx/issues/187.
",area-System.IO,JeremyKuhne,,
19507,Add Public API Marshal.IsTypeVisibleFromCom and Marshal.GetEndComSlot,"Fix https://github.com/dotnet/corefx/issues/30393 and https://github.com/dotnet/corefx/issues/30849

There is another corefx PR","Add Public API Marshal.IsTypeVisibleFromCom and Marshal.GetEndComSlot Fix https://github.com/dotnet/corefx/issues/30393 and https://github.com/dotnet/corefx/issues/30849

There is another corefx PR",area-Interop,luqunl,16/08/2018 6:48,16/08/2018 8:52
19505,"Revert ""Temporarily flag a SIMD test as optimization-sensitive (#19163)""",This reverts commit 855ddf52c7b05994cf6728b9169fa6cdc694a537 (PR https://github.com/dotnet/coreclr/pull/19163). Issue https://github.com/dotnet/coreclr/issues/19124 was fixed by PR https://github.com/dotnet/coreclr/pull/19234 so re-enabling the test in minopts and with tiering.,"Revert ""Temporarily flag a SIMD test as optimization-sensitive (#19163)"" This reverts commit 855ddf52c7b05994cf6728b9169fa6cdc694a537 (PR https://github.com/dotnet/coreclr/pull/19163). Issue https://github.com/dotnet/coreclr/issues/19124 was fixed by PR https://github.com/dotnet/coreclr/pull/19234 so re-enabling the test in minopts and with tiering.",area-CodeGen,kouvel,,
19503,[automated] Merge branch 'release/2.1' => 'release/2.2',"I detected changes in the release/2.1 branch which have not been merged yet to release/2.2.
I'm a robot and am configured to help you automatically keep release/2.2 up to date so
I've opened this PR.

This PR merges commits made on release/2.1 by the following committers:

* @wtgodbe
* @dotnet-maestro-bot
* @mmitche

## Instructions for merging

This PR will not be auto-merged. When pull request checks pass please complete this PR
by creating a merge commit *not* a squash or rebase commit.

<img alt=""merge button instructions"" src=""https://i.imgur.com/GepcNJV.png"" width=""300"" />

You can also do this on command line:


## Instructions for resolving conflicts

:warning: If there are merge conflicts you will need to resolve them manually before merging.
You can do this [using GitHub](https://help.github.com/articles/resolving-a-merge-conflict-on-github/)
or using the [command line](https://help.github.com/articles/resolving-a-merge-conflict-using-the-command-line/).

Maintainers of this repo have permission to the branch 'merge/release/2.1-to-release/2.2' on https://github.com/dotnet-maestro-bot/coreclr.
You can push changes to this branch to resolve conflicts or other issues in this pull request. The bot will attempt
to update this branch as more changes are discovered on release/2.1.

Please contact ASP.NET Core Engineering if you have questions or issues.
Also if this PR was generated incorrectly help us fix it. See https://github.com/aspnet/BuildTools/blob/master/scripts/GitHubMergeBranches.ps1.","[automated] Merge branch 'release/2.1' => 'release/2.2' I detected changes in the release/2.1 branch which have not been merged yet to release/2.2.
I'm a robot and am configured to help you automatically keep release/2.2 up to date so
I've opened this PR.

This PR merges commits made on release/2.1 by the following committers:

* @wtgodbe
* @dotnet-maestro-bot
* @mmitche

## Instructions for merging

This PR will not be auto-merged. When pull request checks pass please complete this PR
by creating a merge commit *not* a squash or rebase commit.

<img alt=""merge button instructions"" src=""https://i.imgur.com/GepcNJV.png"" width=""300"" />

You can also do this on command line:


## Instructions for resolving conflicts

:warning: If there are merge conflicts you will need to resolve them manually before merging.
You can do this [using GitHub](https://help.github.com/articles/resolving-a-merge-conflict-on-github/)
or using the [command line](https://help.github.com/articles/resolving-a-merge-conflict-using-the-command-line/).

Maintainers of this repo have permission to the branch 'merge/release/2.1-to-release/2.2' on https://github.com/dotnet-maestro-bot/coreclr.
You can push changes to this branch to resolve conflicts or other issues in this pull request. The bot will attempt
to update this branch as more changes are discovered on release/2.1.

Please contact ASP.NET Core Engineering if you have questions or issues.
Also if this PR was generated incorrectly help us fix it. See https://github.com/aspnet/BuildTools/blob/master/scripts/GitHubMergeBranches.ps1.",,wtgodbe,,
19502,Switch CoreLib to R2R on all platforms,,Switch CoreLib to R2R on all platforms ,area-ReadyToRun,fadimounir,,
19500,Remove NumaNodeInfo CPUGroupInfo AppDomain SystemDomain and EEConfig stubs from local gc,Everything except EEConfig is moved to the interface. EEConfig is only used for STRESS_HEAP which is disabled for local gc so my plan is to delete EEConfig for now and fix it at the same time as STRESS_HEAP.,"Remove NumaNodeInfo, CPUGroupInfo, AppDomain, SystemDomain, and EEConfig stubs from local gc Everything except EEConfig is moved to the interface. EEConfig is only used for STRESS_HEAP which is disabled for local gc so my plan is to delete EEConfig for now and fix it at the same time as STRESS_HEAP.",area-GC,davmason,,
19499,Consider reordering the instrsxarch.h encodings to save space,"The  a large number of INST3 encodings were added and often only one or two of the encodings are used.

It may be beneficial to consider reordering these encodings in order to save additional space. Looking briefly at the encodings I see the following:

encoding | # entries | # bad_code
-- | -- | --
R/M[reg] | 527 | 366
R/Micon | 444 | 390
regR/M | 421 | 56
eaxi32 | 21 | 10
register | 9 | 1


category:implementation
theme:emitter
skill-level:beginner
cost:medium","Consider reordering the instrsxarch.h encodings to save space The  a large number of INST3 encodings were added and often only one or two of the encodings are used.

It may be beneficial to consider reordering these encodings in order to save additional space. Looking briefly at the encodings I see the following:

encoding | # entries | # bad_code
-- | -- | --
R/M[reg] | 527 | 366
R/Micon | 444 | 390
regR/M | 421 | 56
eaxi32 | 21 | 10
register | 9 | 1


category:implementation
theme:emitter
skill-level:beginner
cost:medium",area-CodeGen,CarolEidt,15/08/2018 12:23,
19498,Refactor instrsxarch.h to contain a `flags` field,Currently the ,Refactor instrsxarch.h to contain a ,area-CodeGen,CarolEidt,15/08/2018 11:56,28/08/2018 12:53
19495,Update debugging and createdump docs,,Update debugging and createdump docs ,,mikem8361,,
19492,Unsafe.Unbox is not available inside mscorlib,"I am wondering why  instead of unboxing and wondering if it makes sense or not e.g. https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/shared/System/Guid.cs#L1048
![image](https://user-images.githubusercontent.com/523221/44123805-a870ef4e-a032-11e8-93a7-47f98ef7dd89.png)

","Unsafe.Unbox is not available inside mscorlib I am wondering why  instead of unboxing and wondering if it makes sense or not e.g. https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/shared/System/Guid.cs#L1048
![image](https://user-images.githubusercontent.com/523221/44123805-a870ef4e-a032-11e8-93a7-47f98ef7dd89.png)

",area-Meta,benaadams,15/08/2018 8:02,15/08/2018 11:37
19490,Add an empty console application to measure startup of the runtime.,,Add an empty console application to measure startup of the runtime. ,tenet-performance-benchmarks,jorive,15/08/2018 7:01,17/08/2018 4:25
19488,Disable a regex test that is failing with minopts,See dotnet/coreclr#18912. This test would always fail once tiered compilation is enabled by default in CoreFX test runs in the CoreCLR repo.,Disable a regex test that is failing with minopts See dotnet/coreclr#18912. This test would always fail once tiered compilation is enabled by default in CoreFX test runs in the CoreCLR repo.,disabled-test,kouvel,15/08/2018 6:25,17/08/2018 4:23
19483,Disable constant folding in JIT resulting in NaN infinities etc,"As it was discussed and agreed in #19395 JIT should not statically evaluate expressions resulting in NaNs infinities or any cases left implementation-defined by IEEE754. 

category:correctness
theme:optimization
skill-level:beginner
cost:small","Disable constant folding in JIT resulting in NaN, infinities etc As it was discussed and agreed in #19395 JIT should not statically evaluate expressions resulting in NaNs infinities or any cases left implementation-defined by IEEE754. 

category:correctness
theme:optimization
skill-level:beginner
cost:small",area-CodeGen,echesakovMSFT,15/08/2018 4:04,
19481,Build CoreCLR on FreeBSD11,"Hi
I am trying to use the instructions for FreeBSD to build CoreCLR on FreeBSD11 with llvm3.8
During Build the runtime step (build.sh) I got this error:


![image](https://user-images.githubusercontent.com/24319588/44094619-f82549e2-9fd6-11e8-88ec-e5e6f40395a9.png)
","Build CoreCLR on FreeBSD11 Hi
I am trying to use the instructions for FreeBSD to build CoreCLR on FreeBSD11 with llvm3.8
During Build the runtime step (build.sh) I got this error:


![image](https://user-images.githubusercontent.com/24319588/44094619-f82549e2-9fd6-11e8-88ec-e5e6f40395a9.png)
",area-Infrastructure-coreclr,RussKeldorph,14/08/2018 23:26,1/12/2018 12:18
19480,Chinese Lunisolar Calendar conversion table discrepancy for the years 2057 2089 and 2097,"The [Chinese Lunisolar Calendar](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/shared/System/Globalization/ChineseLunisolarCalendar.cs) uses a table of data for conversion between Chinese lunisolar dates and Gregorian dates. There appears to be a discrepancy for the table entry for the _days in months_ for the lunar years which started in the Gregorian years 2057 2089 and 2097 when compared with other sources. These are:

- output from Calendrical Calculations (4th edition section 19) which implements the Chinese lunisolar calendar rules used by the [Purple Mountain Observatory](http://english.pmo.cas.cn/) as also detailed [here](http://aa.usno.navy.mil/publications/docs/c15_usb_online.pdf)
- footnote on [tables](http://www.hko.gov.hk/gts/time/conversion.htm) published by the Hong Kong Observatory which state their tables are out by one day for the new moons on 28 September 2057 4 September 2089 and 7 August 2097 (which matches exactly with the same discrepancy between the .NET tables and output from Calendrical Calculations)

Year | Days in month | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13
-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
2057 | .NET | 29 | 30 | 30 | 29 | 30 | 29 | 30 | **30** | **29** | 29 | 30 | 29 | 0
2057 | CC    | 29 | 30 | 30 | 29 | 30 | 29 | 30 | **29** | **30** | 29 | 30 | 29 | 0
2089 | .NET | 30 | 30 | 29 | 30 | 29 | 29 | **30** | **29** | 29 | 30 | 30 | 29 | 0
2089 | CC    | 30 | 30 | 29 | 30 | 29 | 29 | **29** | **30** | 29 | 30 | 30 | 29 | 0
2097 | .NET | 30 | 29 | 30 | 29 | 29 | **30** | **29** | 29 | 30 | 30 | 29 | 30 | 0
2097 | CC    | 30 | 29 | 30 | 29 | 29 | **29** | **30** | 29 | 30 | 30 | 29 | 30 | 0

Existing table entries:



","Chinese Lunisolar Calendar conversion table discrepancy for the years 2057, 2089, and 2097 The [Chinese Lunisolar Calendar](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/shared/System/Globalization/ChineseLunisolarCalendar.cs) uses a table of data for conversion between Chinese lunisolar dates and Gregorian dates. There appears to be a discrepancy for the table entry for the _days in months_ for the lunar years which started in the Gregorian years 2057 2089 and 2097 when compared with other sources. These are:

- output from Calendrical Calculations (4th edition section 19) which implements the Chinese lunisolar calendar rules used by the [Purple Mountain Observatory](http://english.pmo.cas.cn/) as also detailed [here](http://aa.usno.navy.mil/publications/docs/c15_usb_online.pdf)
- footnote on [tables](http://www.hko.gov.hk/gts/time/conversion.htm) published by the Hong Kong Observatory which state their tables are out by one day for the new moons on 28 September 2057 4 September 2089 and 7 August 2097 (which matches exactly with the same discrepancy between the .NET tables and output from Calendrical Calculations)

Year | Days in month | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13
-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
2057 | .NET | 29 | 30 | 30 | 29 | 30 | 29 | 30 | **30** | **29** | 29 | 30 | 29 | 0
2057 | CC    | 29 | 30 | 30 | 29 | 30 | 29 | 30 | **29** | **30** | 29 | 30 | 29 | 0
2089 | .NET | 30 | 30 | 29 | 30 | 29 | 29 | **30** | **29** | 29 | 30 | 30 | 29 | 0
2089 | CC    | 30 | 30 | 29 | 30 | 29 | 29 | **29** | **30** | 29 | 30 | 30 | 29 | 0
2097 | .NET | 30 | 29 | 30 | 29 | 29 | **30** | **29** | 29 | 30 | 30 | 29 | 30 | 0
2097 | CC    | 30 | 29 | 30 | 29 | 29 | **29** | **30** | 29 | 30 | 30 | 29 | 30 | 0

Existing table entries:



",area-System.Globalization,elyoh,14/08/2018 19:19,14/09/2018 7:58
19479,Some JitBench fixes,#NAME?,Some JitBench fixes - Fixed  config,area-Meta,kouvel,,
19478, [Test Failure] ApartmentState_NoAttributePresent_STA_Windows_Core,"From the new binary test run
"," [Test Failure] ApartmentState_NoAttributePresent_STA_Windows_Core From the new binary test run
",arch-x64,A-And,14/08/2018 13:42,14/08/2018 14:19
19476,Code review feedback for the alternate stack changes (PR #19309).,"Renamed PAL_InitializeFlags to PAL_InitializeWithFlags. Combined PAL_INITIALIZE_ENSURE_ALT_SIGNAL_STACK and PAL_INITIALIZE_REGISTER_SIGNALS flags.

Also fixed SOS plugin for core dumps.","Code review feedback for the alternate stack changes (PR #19309). Renamed PAL_InitializeFlags to PAL_InitializeWithFlags. Combined PAL_INITIALIZE_ENSURE_ALT_SIGNAL_STACK and PAL_INITIALIZE_REGISTER_SIGNALS flags.

Also fixed SOS plugin for core dumps.",,mikem8361,,
19474,Unexpected results returning struct with floats in RCW,"In trying to wrap [ that exercises it. One can also look at this by tweaking the Direct2dDemo project (i.e. call the method) which runs on .NET Core and sets up a render target that you can use.

As stated I'll try and get a smaller COM repro together for this.

","Unexpected results returning struct with floats in RCW In trying to wrap [ that exercises it. One can also look at this by tweaking the Direct2dDemo project (i.e. call the method) which runs on .NET Core and sets up a render target that you can use.

As stated I'll try and get a smaller COM repro together for this.

",area-Interop,davidwrighton,14/08/2018 10:27,30/03/2019 3:49
19467,Use 64bit Upper/Lower casing in TextInfo,Tracking issue for https://github.com/dotnet/coreclr/pull/19436#discussion_r209666239,Use 64bit Upper/Lower casing in TextInfo Tracking issue for https://github.com/dotnet/coreclr/pull/19436#discussion_r209666239,area-System.Runtime,vancem,14/08/2018 8:12,
19465,disable tests\src\JIT\Methodical\fp\exgen\10w5d_cs_do,in stress modes. The issue is #18988,disable tests\src\JIT\Methodical\fp\exgen\10w5d_cs_do in stress modes. The issue is #18988,disabled-test,sandreenko,14/08/2018 8:00,14/08/2018 9:16
19464,[Windows/arm64] GCStress=c assert: Consistency check failed,"Windows arm64 GCStress=c failure in b163200

In the CI I only saw it with JitStress=1 (https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm64/job/jitstress/job/arm64_cross_checked_windows_nt_gcstress0xc_jitstress1_tst/32/) because of other failures and the CI deleting logs quickly. But I can repro with just GCStress=c locally.

I had to set 
","[Windows/arm64] GCStress=c assert: Consistency check failed Windows arm64 GCStress=c failure in b163200

In the CI I only saw it with JitStress=1 (https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm64/job/jitstress/job/arm64_cross_checked_windows_nt_gcstress0xc_jitstress1_tst/32/) because of other failures and the CI deleting logs quickly. But I can repro with just GCStress=c locally.

I had to set 
",GCStress,AndyAyersMS,,
19462,[Windows/arm32] Failures in HeapVerify job,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_heapverify1_flow/



Failures are all timeouts (>600s)
","[Windows/arm32] Failures in HeapVerify job https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_heapverify1_flow/



Failures are all timeouts (>600s)
",arch-arm32,BruceForstall,14/08/2018 7:05,14/08/2018 9:53
19460,[Windows/arm32] corefx TieredCompilation failure in System.Threading.Threads.Tests,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_tieredcompilation_flow/



@kouvel @noahfalk ","[Windows/arm32] corefx TieredCompilation failure in System.Threading.Threads.Tests https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_tieredcompilation_flow/



@kouvel @noahfalk ",arch-arm32,BruceForstall,14/08/2018 6:02,14/08/2018 6:15
19457,[Windows/arm32] corefx System.Linq.Expressions.Tests failures,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress1_tst/30/consoleFull


","[Windows/arm32] corefx System.Linq.Expressions.Tests failures https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress1_tst/30/consoleFull


",JitStress,sandreenko,,
19455,[dev/unix_test_workflow][NO MERGE] Dummy change,,[dev/unix_test_workflow][NO MERGE] Dummy change ,* NO MERGE *,echesakovMSFT,14/08/2018 4:26,17/08/2018 14:58
19454,System.AccessViolationException with Span,"Following code crashes with System.AccessViolationException when compiled in Release mode with ""Optimize code"". I tried that on Windows 64bit with .NET Core 2.1.302. Older version of .NET Core and Debug does not cause this exception.

Note that this code alone does not make any sense. It was isolated from larger code base. It might be an issue with JIT since the code in for cycle does not even execute it is called with 0.
","System.AccessViolationException with Span Following code crashes with System.AccessViolationException when compiled in Release mode with ""Optimize code"". I tried that on Windows 64bit with .NET Core 2.1.302. Older version of .NET Core and Debug does not cause this exception.

Note that this code alone does not make any sense. It was isolated from larger code base. It might be an issue with JIT since the code in for cycle does not even execute it is called with 0.
",area-CodeGen,AndyAyersMS,,
19453,[NO MERGE] Dummy PR,**NO MERGE** **NO MERGE** **NO MERGE** ,[NO MERGE] Dummy PR **NO MERGE** **NO MERGE** **NO MERGE** ,* NO MERGE *,echesakovMSFT,14/08/2018 4:22,14/08/2018 6:49
19451,[release/2.1] Sign api-ms-win-core-xstate-l2-1-0.dll,This file is only catalog signed in RS4.  Sign during the build. To achieve this copy the CRT binaries locally rather than referencing from the UCRT location directly.,[release/2.1] Sign api-ms-win-core-xstate-l2-1-0.dll This file is only catalog signed in RS4.  Sign during the build. To achieve this copy the CRT binaries locally rather than referencing from the UCRT location directly.,area-Infrastructure-coreclr,mmitche,14/08/2018 4:19,14/08/2018 6:58
19450,Japanese Lunisolar Calendar conversion table discrepancy for the year 1962,"The [Japanese Lunisolar Calendar](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/shared/System/Globalization/JapaneseLunisolarCalendar.cs) uses a table of data for conversion between Japanese lunisolar dates and Gregorian dates.  There appears* to be a discrepancy for the table entry for the _days in months_ for lunar months 6 and 7 of the lunar year which started in the Gregorian year 1962 when compared with two other sources.  These are:
- output from Calendrical Calculations (4th edition section 19.9) which provides algorithms for accurate dates for the period 1860 to at least 2100
- [Rekijitsu taikan : Meiji kaireki 1873-nen--2100-nen shinkyūreki kanshi kyūsei rokuyō taishō](http://www.worldcat.org/title/rekijitsu-taikan/oclc/675252389?referer=di&ht=edition ()) which provides accurate tables of dates in this calendar over the period years 1873 to 2100 (with the exception of 1947)

*there isn't a source given for the existing table data - is it still known / available for cross check?

**Comparison of table data**

Days in month for 1962  | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13
-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
.NET | 29 | 30 | 29 | 29 | 30 | **30** | **29** | 30 | 29 | 30 | 30 | 29 | 0
Calendrical Calculations / Rekijitsu taikan | 29 | 30 | 29 | 29 | 30 | **29** | **30** | 30 | 29 | 30 | 30 | 29 | 0

Assuming the output of Calendrical Calculations algorithms is correct then the current table entry for 1962:


At the same time it would also be a _trivial_ matter to extend the table to support dates for all the Japanese calendar eras currently supported by .NET (Meiji Taisho Showa and Heisei).  Given the recent updates to the Japanese and Japanese Lunisolar calendars relating to the new Japanese calendar era this might be an appropriate time to do that.

I would be happy to submit PR to address these.

","Japanese Lunisolar Calendar conversion table discrepancy for the year 1962 The [Japanese Lunisolar Calendar](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/shared/System/Globalization/JapaneseLunisolarCalendar.cs) uses a table of data for conversion between Japanese lunisolar dates and Gregorian dates.  There appears* to be a discrepancy for the table entry for the _days in months_ for lunar months 6 and 7 of the lunar year which started in the Gregorian year 1962 when compared with two other sources.  These are:
- output from Calendrical Calculations (4th edition section 19.9) which provides algorithms for accurate dates for the period 1860 to at least 2100
- [Rekijitsu taikan : Meiji kaireki 1873-nen--2100-nen shinkyūreki kanshi kyūsei rokuyō taishō](http://www.worldcat.org/title/rekijitsu-taikan/oclc/675252389?referer=di&ht=edition ()) which provides accurate tables of dates in this calendar over the period years 1873 to 2100 (with the exception of 1947)

*there isn't a source given for the existing table data - is it still known / available for cross check?

**Comparison of table data**

Days in month for 1962  | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13
-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
.NET | 29 | 30 | 29 | 29 | 30 | **30** | **29** | 30 | 29 | 30 | 30 | 29 | 0
Calendrical Calculations / Rekijitsu taikan | 29 | 30 | 29 | 29 | 30 | **29** | **30** | 30 | 29 | 30 | 30 | 29 | 0

Assuming the output of Calendrical Calculations algorithms is correct then the current table entry for 1962:


At the same time it would also be a _trivial_ matter to extend the table to support dates for all the Japanese calendar eras currently supported by .NET (Meiji Taisho Showa and Heisei).  Given the recent updates to the Japanese and Japanese Lunisolar calendars relating to the new Japanese calendar era this might be an appropriate time to do that.

I would be happy to submit PR to address these.

",area-System.Globalization,jkotas,14/08/2018 3:47,16/08/2018 11:28
19448,[Ubuntu/arm32] JitStressRegs=8 CoreFX test failures,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs8_tst/17/consoleFull

Many or every test fails with:


Related to https://github.com/dotnet/coreclr/issues/19029?

Even if fixed the job will probably fail with https://github.com/dotnet/coreclr/issues/19447.

@dotnet/arm32-contrib @CarolEidt ","[Ubuntu/arm32] JitStressRegs=8 CoreFX test failures https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs8_tst/17/consoleFull

Many or every test fails with:


Related to https://github.com/dotnet/coreclr/issues/19029?

Even if fixed the job will probably fail with https://github.com/dotnet/coreclr/issues/19447.

@dotnet/arm32-contrib @CarolEidt ",arch-arm32,CarolEidt,,
19447,"Ubuntu/arm32 corefx test infrastructure failures: ""The plugin hasn't been performed correctly""","All the Ubuntu/arm32 corefx tests are failing -- after all the tests actually pass -- with an infrastructure failure message e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst/17/consoleFull



Others:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress1_tst/22/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress2_tst/22/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x1000_tst/19/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x10_tst/20/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x80_tst/20/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs1_tst/19/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs2_tst/18/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs3_tst/19/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs4_tst/18/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_minopts_tst/21/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_tieredcompilation_tst/7/consoleFull

@dotnet/arm32-contrib @jashook @mmitche ","Ubuntu/arm32 corefx test infrastructure failures: ""The plugin hasn't been performed correctly"" All the Ubuntu/arm32 corefx tests are failing -- after all the tests actually pass -- with an infrastructure failure message e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst/17/consoleFull



Others:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress1_tst/22/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress2_tst/22/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x1000_tst/19/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x10_tst/20/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x80_tst/20/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs1_tst/19/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs2_tst/18/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs3_tst/19/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs4_tst/18/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_minopts_tst/21/consoleFull
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_tieredcompilation_tst/7/consoleFull

@dotnet/arm32-contrib @jashook @mmitche ",arch-arm32,BruceForstall,14/08/2018 2:36,18/08/2018 8:22
19444,RyuJIT: By-ref assignment with null leads to runtime crash,"The following example crashes the runtime when compiled and run in either debug or release:
?","RyuJIT: By-ref assignment with null leads to runtime crash The following example crashes the runtime when compiled and run in either debug or release:
?",area-CodeGen,CarolEidt,,
19441,R2RDumpTest debug failure,"This test appears to have started failing in Debug runs with https://github.com/dotnet/coreclr/pull/19419

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/x86_debug_windows_nt/5075/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/debug_windows_nt/5358/

@nattress @acmyu ","R2RDumpTest debug failure This test appears to have started failing in Debug runs with https://github.com/dotnet/coreclr/pull/19419

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/x86_debug_windows_nt/5075/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/debug_windows_nt/5358/

@nattress @acmyu ",area-ReadyToRun,acmyu,,
19440,Assert failure: obj != NULL,"x86 Checked Windows GCStress=c

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_gcstress0xc/96/consoleText



","Assert failure: obj != NULL x86 Checked Windows GCStress=c

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_gcstress0xc/96/consoleText



",GCStress,BruceForstall,13/08/2018 2:09,15/06/2019 6:30
19439,Assertion failed 'varDsc->lvRefCnt() == 0 && !varDsc->lvRegister && !varDsc->lvOnFrame',"From x86 Checked Windows R2R with JITMinOpts=1

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_r2r_jitminopts/135/consoleFull


","Assertion failed 'varDsc->lvRefCnt() == 0 && !varDsc->lvRegister && !varDsc->lvOnFrame' From x86 Checked Windows R2R with JITMinOpts=1

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_r2r_jitminopts/135/consoleFull


",area-CodeGen,AndyAyersMS,,
19438,Regression: Wrapped System.Numerics types are not generating SIMD code,"Greetings

I'm running Visual Studio 2017 v15.7.6 with .Net Core 2.1.400-preview-009171. I've noticed that SIMD types from System.Numerics that are wrapped within structs are not generating optimal code. I've tried running from vanilla JIT as well as AOT (both RyuJIT and CPP CodeGen) to no avail.

I've attached a simple project that demonstrates this along with the disassembly.

Furthermore it appears that this might be a regression given it seems to have been resolved in https://github.com/dotnet/coreclr/issues/7508 for a prior version.

It would be awesome if this issue can be addressed ASAP.

[SimdCodeGen.zip](https://github.com/dotnet/coreclr/files/2280547/SimdCodeGen.zip)
[NativeVector_Disassembly.txt](https://github.com/dotnet/coreclr/files/2280548/NativeVector_Disassembly.txt)
[WrappedVector_Disassembly.txt](https://github.com/dotnet/coreclr/files/2280549/WrappedVector_Disassembly.txt)

Thanks.

@CarolEidt @sivarv ","Regression: Wrapped System.Numerics types are not generating SIMD code Greetings

I'm running Visual Studio 2017 v15.7.6 with .Net Core 2.1.400-preview-009171. I've noticed that SIMD types from System.Numerics that are wrapped within structs are not generating optimal code. I've tried running from vanilla JIT as well as AOT (both RyuJIT and CPP CodeGen) to no avail.

I've attached a simple project that demonstrates this along with the disassembly.

Furthermore it appears that this might be a regression given it seems to have been resolved in https://github.com/dotnet/coreclr/issues/7508 for a prior version.

It would be awesome if this issue can be addressed ASAP.

[SimdCodeGen.zip](https://github.com/dotnet/coreclr/files/2280547/SimdCodeGen.zip)
[NativeVector_Disassembly.txt](https://github.com/dotnet/coreclr/files/2280548/NativeVector_Disassembly.txt)
[WrappedVector_Disassembly.txt](https://github.com/dotnet/coreclr/files/2280549/WrappedVector_Disassembly.txt)

Thanks.

@CarolEidt @sivarv ",area-CodeGen,CarolEidt,,
19437,[Linux/ARM] SIGILL during stepping under managed debugger,"Sometimes during stepping through method that could be called from different threads SIGILL occurs (https://github.com/dotnet/coreclr/pull/19409 does right things but doesn't solve this problem):
 function to do atomic write. What do you think?

Thank you!","[Linux/ARM] SIGILL during stepping under managed debugger Sometimes during stepping through method that could be called from different threads SIGILL occurs (https://github.com/dotnet/coreclr/pull/19409 does right things but doesn't solve this problem):
 function to do atomic write. What do you think?

Thank you!",arch-arm32,hoyosjs,,
19435,StructLayout(LayoutKind.Sequential) is not respected in some cases,"Consider the following repro code.
Here structs ","StructLayout(LayoutKind.Sequential) is not respected in some cases Consider the following repro code.
Here structs ",area-Interop,jkotas,11/08/2018 19:13,12/08/2018 5:16
19432,IL round-trip test failing,"For Windows x64 Release the 

Related: https://github.com/dotnet/coreclr/issues/16540

Seems like the superpmicollect test should be excluded from ILRT testing.","IL round-trip test failing For Windows x64 Release the 

Related: https://github.com/dotnet/coreclr/issues/16540

Seems like the superpmicollect test should be excluded from ILRT testing.",area-ILTools,RussKeldorph,11/08/2018 10:15,
19430,Build-test.sh handles native test assets,"See #19416


cc @janvorli @jashook @RussKeldorph ","Build-test.sh handles native test assets See #19416


cc @janvorli @jashook @RussKeldorph ",area-Infrastructure-coreclr,jashook,11/08/2018 10:05,17/08/2018 4:21
19428,Speculate future methods that will need to be jitted via IL analysis of currently jitting methods,"Multicore Jit has been able to provide 20+% startup wins after it is trained but in many scenarios generating and persisting the training data is problematic. We could instead analyze the IL of methods as they were being generated to infer the additional methods they are likely to call in the near future. As a simple case if we were jitting a method:



We have a pretty strong expectation that Bar() and Baz() will be needed in the near future. Lets naively assume that each of Foo Bar and Baz take 500us to compile Foo takes 1us to run once jitted and at the 100us mark of compiling Foo the JIT will call back to the runtime alerting it that Bar and Baz are good speculative compilation candidates. In the current runtime Foo would complete after 1501us whereas in a perfectly parallelized world with no other overhead it would complete in 601us. In practice the wins would probably be less than what we see from trained Multicore Jit but we'd need further investigation to determine how much less. We might still be able to capture a significant fraction. The advantage is that it doesn't create any dependencies that the application needs to account for which gives it broader scenario reach.

category:throughput
theme:runtime
skill-level:expert
cost:extra-large","Speculate future methods that will need to be jitted via IL analysis of currently jitting methods Multicore Jit has been able to provide 20+% startup wins after it is trained but in many scenarios generating and persisting the training data is problematic. We could instead analyze the IL of methods as they were being generated to infer the additional methods they are likely to call in the near future. As a simple case if we were jitting a method:



We have a pretty strong expectation that Bar() and Baz() will be needed in the near future. Lets naively assume that each of Foo Bar and Baz take 500us to compile Foo takes 1us to run once jitted and at the 100us mark of compiling Foo the JIT will call back to the runtime alerting it that Bar and Baz are good speculative compilation candidates. In the current runtime Foo would complete after 1501us whereas in a perfectly parallelized world with no other overhead it would complete in 601us. In practice the wins would probably be less than what we see from trained Multicore Jit but we'd need further investigation to determine how much less. We might still be able to capture a significant fraction. The advantage is that it doesn't create any dependencies that the application needs to account for which gives it broader scenario reach.

category:throughput
theme:runtime
skill-level:expert
cost:extra-large",area-CodeGen,noahfalk,11/08/2018 9:56,
19426,Generate JIT GC encoding asynchronously to improve JIT throughput,"Currently this is an unvalidated suggestion. Additional investigation would be required to confirm the win exists and that the tradeoff in perf/complexity elsewhere are acceptable.

In the past I think Peter did some JIT investigation and determined that encoding GC data was about 8% of JIT time. This data isn't needed until a GC occurs and the method is on the stack. It is possible that by doing the work on a parallel background thread the user perceivable delay between invoking the PreStub and having code available to run would improve by 8% with a tradeoff that datastructures used by the JIT might need to persist in memory longer and that some of the overhead might resurface as GC delay.


category:throughput
theme:gc-info
skill-level:expert
cost:extra-large","Generate JIT GC encoding asynchronously to improve JIT throughput Currently this is an unvalidated suggestion. Additional investigation would be required to confirm the win exists and that the tradeoff in perf/complexity elsewhere are acceptable.

In the past I think Peter did some JIT investigation and determined that encoding GC data was about 8% of JIT time. This data isn't needed until a GC occurs and the method is on the stack. It is possible that by doing the work on a parallel background thread the user perceivable delay between invoking the PreStub and having code available to run would improve by 8% with a tradeoff that datastructures used by the JIT might need to persist in memory longer and that some of the overhead might resurface as GC delay.


category:throughput
theme:gc-info
skill-level:expert
cost:extra-large",JitThroughput,noahfalk,11/08/2018 9:18,
19425,Unix: Unnecessary struct copy while passsing struct of size <=16,"This is a copy of #6264. For some reason it wasn't possible to update the description of that issue.

Struct arguments whose size is <= 16 bytes generate unnecessary copies. @sivarv  categorized the cases below:

The following are the struct passing cases on Amd64 Unix that are of interest:

struct of size 124 or 8 in memory/register is getting passed in an arg reg or on stack
struct of size 3567 in memory/register is getting passed in an arg reg or on stack
struct of size 9-16 bytes in memory is getting passed in two arg registers
struct of size 9-16 bytes (e.g. SIMD structs Vector3 and Vector4) in a register is getting passed in two arg registers
struct of size 9-16 bytes in memory/register is getting passed on stack.
In fgMorphArgs eeGetSystemVAmd64PassStructInRegisterDescriptor classifies the cases above as register argument except simd from vector<t> and sets structDesc.passedInRegisters to true this always calls fgMakeOutgoingStructArgCopy() and generates copies.

category:cq
theme:calling-convention
skill-level:intermediate
cost:medium","Unix: Unnecessary struct copy while passsing struct of size <=16 This is a copy of #6264. For some reason it wasn't possible to update the description of that issue.

Struct arguments whose size is <= 16 bytes generate unnecessary copies. @sivarv  categorized the cases below:

The following are the struct passing cases on Amd64 Unix that are of interest:

struct of size 124 or 8 in memory/register is getting passed in an arg reg or on stack
struct of size 3567 in memory/register is getting passed in an arg reg or on stack
struct of size 9-16 bytes in memory is getting passed in two arg registers
struct of size 9-16 bytes (e.g. SIMD structs Vector3 and Vector4) in a register is getting passed in two arg registers
struct of size 9-16 bytes in memory/register is getting passed on stack.
In fgMorphArgs eeGetSystemVAmd64PassStructInRegisterDescriptor classifies the cases above as register argument except simd from vector<t> and sets structDesc.passedInRegisters to true this always calls fgMakeOutgoingStructArgCopy() and generates copies.

category:cq
theme:calling-convention
skill-level:intermediate
cost:medium",area-CodeGen,erozenfeld,11/08/2018 9:18,
19424,Clean up genClearStackVec3ArgUpperBits,"This is a copy of #5113. For some reason it wasn't possible to update the description of that issue.

genClearStackVec3ArgUpperBits can be split and implemented in genFnPrologCalleeRegArgs() for argument registers and genEnregisterIncomingStackArgs() for stack arguments.

Related PR: #4963

category:cq
theme:vector-codegen
skill-level:intermediate
cost:small
","Clean up genClearStackVec3ArgUpperBits This is a copy of #5113. For some reason it wasn't possible to update the description of that issue.

genClearStackVec3ArgUpperBits can be split and implemented in genFnPrologCalleeRegArgs() for argument registers and genEnregisterIncomingStackArgs() for stack arguments.

Related PR: #4963

category:cq
theme:vector-codegen
skill-level:intermediate
cost:small
",area-CodeGen,erozenfeld,11/08/2018 9:17,
19418,[NO MERGE] Dummy PR,**NO MERGE** **NO MERGE** **NO MERGE**,[NO MERGE] Dummy PR **NO MERGE** **NO MERGE** **NO MERGE**,* NO MERGE *,echesakovMSFT,11/08/2018 8:12,14/08/2018 2:45
19417,[local gc] Enable numa-awareness ,Right now local gc is not aware of numa (e.g. virtual_alloc_commit_for_heap),[local gc] Enable numa-awareness  Right now local gc is not aware of numa (e.g. virtual_alloc_commit_for_heap),area-GC,davmason,,
19416,Make test building scripts consistent across Windows and non-Windows builds,"The  file.

cc: @RussKeldorph @janvorli @BruceForstall ","Make test building scripts consistent across Windows and non-Windows builds The  file.

cc: @RussKeldorph @janvorli @BruceForstall ",area-Infrastructure-coreclr,AaronRobinsonMSFT,11/08/2018 6:15,17/08/2018 4:22
19415,R2RDump test fails with JITMinOpts,"https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_minopts/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_windows_nt_minopts/


https://github.com/dotnet/coreclr/pull/19155 removed:


so the test now runs with JIT optimization modes. It fails under JITMinOpts. (I haven't checked other optimization cases.)
","R2RDump test fails with JITMinOpts https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_minopts/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_windows_nt_minopts/


https://github.com/dotnet/coreclr/pull/19155 removed:


so the test now runs with JIT optimization modes. It fails under JITMinOpts. (I haven't checked other optimization cases.)
",area-ReadyToRun,acmyu,,
19413,JIT: jitstress2 failure in JIT\Methodical\fp\exgen\10w5d_cs_ro after switch to R2R codegen for corelib,"Fails after #19359 running with x64 checked. Method prints same output stream but return code is now 108 instead of 100.

Fair number of diffs in jitted code before/after this change. Haven't tried pinning it down yet.

cc @dotnet/jit-contrib ","JIT: jitstress2 failure in JIT\Methodical\fp\exgen\10w5d_cs_ro after switch to R2R codegen for corelib Fails after #19359 running with x64 checked. Method prints same output stream but return code is now 108 instead of 100.

Fair number of diffs in jitted code before/after this change. Haven't tried pinning it down yet.

cc @dotnet/jit-contrib ",JitStress,sandreenko,,
19412,Remove GT_ASG nodes,"This came up occasionally in discussions but AFAIK there's no issue associated with it and IMO there should be due to the significant (negative) impact  but its IR was very different looking more like assembly. I know next to nothing about LLVM but I don't think it has assignment.

category:implementation
theme:ir
skill-level:expert
cost:extra-large","Remove GT_ASG nodes This came up occasionally in discussions but AFAIK there's no issue associated with it and IMO there should be due to the significant (negative) impact  but its IR was very different looking more like assembly. I know next to nothing about LLVM but I don't think it has assignment.

category:implementation
theme:ir
skill-level:expert
cost:extra-large",Design Discussion,RussKeldorph,11/08/2018 2:52,
19411,Add gcstress smoketest to CI,"gcstress is somewhat fragile as requires an additional package install and exercises paths in the runtime that aren't normally hit. We should consider adding a gcstress smoketest to the CI that just stresses a few tests to make sure it remains healthy.

cc @BruceForstall ","Add gcstress smoketest to CI gcstress is somewhat fragile as requires an additional package install and exercises paths in the runtime that aren't normally hit. We should consider adding a gcstress smoketest to the CI that just stresses a few tests to make sure it remains healthy.

cc @BruceForstall ",area-Infrastructure-coreclr,AndyAyersMS,11/08/2018 2:15,
19408,Profiling API: Inconsistent stack unwinding after exception in filter handler,"The short example of abnormal Profiling API behavior (.NET Core v2.1 / .NET Framework v4.7.2):
 is absent. The diagram from https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/bb384687(v=vs.100) says that it's impossible.

Could you please comment this behavior?","Profiling API: Inconsistent stack unwinding after exception in filter handler The short example of abnormal Profiling API behavior (.NET Core v2.1 / .NET Framework v4.7.2):
 is absent. The diagram from https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/bb384687(v=vs.100) says that it's impossible.

Could you please comment this behavior?",area-Diagnostics,RussKeldorph,11/08/2018 0:57,
19407,Generic interface method not being called,"Tested sample code on .NET 2/3/4/4.5/4.6.1 & .Net Core 2.1 behavior is the same for all why is this handled like this? 

Clearly the call to 
","Generic interface method not being called Tested sample code on .NET 2/3/4/4.5/4.6.1 & .Net Core 2.1 behavior is the same for all why is this handled like this? 

Clearly the call to 
",question,jkotas,10/08/2018 19:19,11/08/2018 0:24
19406,Test failure: baseservices_threading._waithandle_waitany_waitanyex2a_waitanyex2a_/_waithandle_waitany_waitanyex2a_waitanyex2a_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Work/78d4e7b9-e498-41b3-b8c1-8cc91a8385b3/Unzip/Reports\\baseservices.threading\\waithandle\\waitany\\waitanyex2a\\waitanyex2a.output.txt
    Raw output:
    BEGIN EXECUTION
    in takeLock
    /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Payload/crossgen /Platform_Assemblies_Paths /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Payload:/home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Work/78d4e7b9-e498-41b3-b8c1-8cc91a8385b3/Unzip/waithandle/waitany/waitanyex2a/IL:/home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Work/78d4e7b9-e498-41b3-b8c1-8cc91a8385b3/Unzip/waithandle/waitany/waitanyex2a /in waitanyex2a.org /out waitanyex2a.exe
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0
    Copyright (c) Microsoft Corporation.  All rights reserved.
    
    Native image waitanyex2a.exe generated successfully.
    in ReleaseLock
    in takeLock
    /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Payload/corerun waitanyex2a.exe
    Testing Mutex and non-Mutex and signaling the other element
    Acquire the Mutex
    Holding the Mutex
    Waiting...
    WaitAny did not throw AbandonedMutexException. Result: 1
    Test Failed
    in ReleaseLock
    Expected: 100
    Actual: 255
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Payload
    > /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Work/78d4e7b9-e498-41b3-b8c1-8cc91a8385b3/Unzip/waithandle/waitany/waitanyex2a/waitanyex2a.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180810.01 (Ready-To-Run Tests)
Failing configurations:
- ubuntu.1404.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180810.01/workItem/baseservices.threading.XUnitWrapper/analysis/xunit/baseservices_threading._waithandle_waitany_waitanyex2a_waitanyex2a_~2F_waithandle_waitany_waitanyex2a_waitanyex2a_cmd","Test failure: baseservices_threading._waithandle_waitany_waitanyex2a_waitanyex2a_/_waithandle_waitany_waitanyex2a_waitanyex2a_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Work/78d4e7b9-e498-41b3-b8c1-8cc91a8385b3/Unzip/Reports\\baseservices.threading\\waithandle\\waitany\\waitanyex2a\\waitanyex2a.output.txt
    Raw output:
    BEGIN EXECUTION
    in takeLock
    /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Payload/crossgen /Platform_Assemblies_Paths /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Payload:/home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Work/78d4e7b9-e498-41b3-b8c1-8cc91a8385b3/Unzip/waithandle/waitany/waitanyex2a/IL:/home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Work/78d4e7b9-e498-41b3-b8c1-8cc91a8385b3/Unzip/waithandle/waitany/waitanyex2a /in waitanyex2a.org /out waitanyex2a.exe
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0
    Copyright (c) Microsoft Corporation.  All rights reserved.
    
    Native image waitanyex2a.exe generated successfully.
    in ReleaseLock
    in takeLock
    /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Payload/corerun waitanyex2a.exe
    Testing Mutex and non-Mutex and signaling the other element
    Acquire the Mutex
    Holding the Mutex
    Waiting...
    WaitAny did not throw AbandonedMutexException. Result: 1
    Test Failed
    in ReleaseLock
    Expected: 100
    Actual: 255
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Payload
    > /home/helixbot/dotnetbuild/work/64020330-e696-44f2-9aa4-7a362aff9f95/Work/78d4e7b9-e498-41b3-b8c1-8cc91a8385b3/Unzip/waithandle/waitany/waitanyex2a/waitanyex2a.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180810.01 (Ready-To-Run Tests)
Failing configurations:
- ubuntu.1404.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180810.01/workItem/baseservices.threading.XUnitWrapper/analysis/xunit/baseservices_threading._waithandle_waitany_waitanyex2a_waitanyex2a_~2F_waithandle_waitany_waitanyex2a_waitanyex2a_cmd",area-System.Threading,kouvel,10/08/2018 19:13,26/07/2019 11:03
19405,Test failure: CoreMangLib_cti._system_collections_generic_dictionary_DictionaryAdd_DictionaryAdd_/_system_collections_generic_dictionary_DictionaryAdd_DictionaryAdd_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.

coreclr_initialize failed - status: 0x80004005
    
    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/44e226a1-fc4e-4168-97d8-c8030a8ad273/Work/075808ac-aef4-4559-9400-c36cfddf85ed/Unzip/Reports\\CoreMangLib.cti\\system\\collections\\generic\\dictionary\\DictionaryAdd\\DictionaryAdd.output.txt
    Raw output:
    BEGIN EXECUTION
    /home/helixbot/dotnetbuild/work/44e226a1-fc4e-4168-97d8-c8030a8ad273/Payload/corerun DictionaryAdd.exe
    Expected: 100
    Actual: 255
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/44e226a1-fc4e-4168-97d8-c8030a8ad273/Payload
    > /home/helixbot/dotnetbuild/work/44e226a1-fc4e-4168-97d8-c8030a8ad273/Work/075808ac-aef4-4559-9400-c36cfddf85ed/Unzip/system/collections/generic/dictionary/DictionaryAdd/DictionaryAdd.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180810.01 (Core Tests)
Failing configurations:
- opensuse.423.amd64-x64
  - 

Details:
https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180810.01/workItem/CoreMangLib.cti.XUnitWrapper/analysis/xunit/CoreMangLib_cti._system_collections_generic_dictionary_DictionaryAdd_DictionaryAdd_~2F_system_collections_generic_dictionary_DictionaryAdd_DictionaryAdd_cmd","Test failure: CoreMangLib_cti._system_collections_generic_dictionary_DictionaryAdd_DictionaryAdd_/_system_collections_generic_dictionary_DictionaryAdd_DictionaryAdd_cmd Opened on behalf of @Sunny-pu

The test  has failed.

coreclr_initialize failed - status: 0x80004005
    
    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/44e226a1-fc4e-4168-97d8-c8030a8ad273/Work/075808ac-aef4-4559-9400-c36cfddf85ed/Unzip/Reports\\CoreMangLib.cti\\system\\collections\\generic\\dictionary\\DictionaryAdd\\DictionaryAdd.output.txt
    Raw output:
    BEGIN EXECUTION
    /home/helixbot/dotnetbuild/work/44e226a1-fc4e-4168-97d8-c8030a8ad273/Payload/corerun DictionaryAdd.exe
    Expected: 100
    Actual: 255
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/44e226a1-fc4e-4168-97d8-c8030a8ad273/Payload
    > /home/helixbot/dotnetbuild/work/44e226a1-fc4e-4168-97d8-c8030a8ad273/Work/075808ac-aef4-4559-9400-c36cfddf85ed/Unzip/system/collections/generic/dictionary/DictionaryAdd/DictionaryAdd.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180810.01 (Core Tests)
Failing configurations:
- opensuse.423.amd64-x64
  - 

Details:
https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180810.01/workItem/CoreMangLib.cti.XUnitWrapper/analysis/xunit/CoreMangLib_cti._system_collections_generic_dictionary_DictionaryAdd_DictionaryAdd_~2F_system_collections_generic_dictionary_DictionaryAdd_DictionaryAdd_cmd",test-run-uwp-coreclr,RussKeldorph,10/08/2018 19:06,11/08/2018 0:54
19404,Test failure: reflection_regression._dev10bugs_Dev10_629953_Dev10_629953_/_dev10bugs_Dev10_629953_Dev10_629953_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.

Test Infrastructure Failure: System.TypeInitializationException: The type initializer for 'System.Diagnostics.Process' threw an exception. ---> System.IO.FileNotFoundException: Could not load file or assembly 'System.Text.Encoding.Extensions Version=4.1.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
    
       at System.Diagnostics.Process..cctor()
       --- End of inner exception stack trace ---
       at System.Diagnostics.Process.EnsureSigChildHandler()
       at System.Diagnostics.Process.StartCore(ProcessStartInfo startInfo)
       at System.Diagnostics.Process.Start()
       at CoreclrTestLib.CoreclrTestWrapperLib.RunTest(String executable String outputFile String errorFile)
       at reflection_regression._dev10bugs_Dev10_630880_Dev10_630880_._dev10bugs_Dev10_630880_Dev10_630880_cmd()
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180810.01 (Core Tests)
Failing configurations:
- opensuse.423.amd64-x64
  - 

Details:
https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180810.01/workItem/reflection.regression.XUnitWrapper/analysis/xunit/reflection_regression._dev10bugs_Dev10_629953_Dev10_629953_~2F_dev10bugs_Dev10_629953_Dev10_629953_cmd","Test failure: reflection_regression._dev10bugs_Dev10_629953_Dev10_629953_/_dev10bugs_Dev10_629953_Dev10_629953_cmd Opened on behalf of @Sunny-pu

The test  has failed.

Test Infrastructure Failure: System.TypeInitializationException: The type initializer for 'System.Diagnostics.Process' threw an exception. ---> System.IO.FileNotFoundException: Could not load file or assembly 'System.Text.Encoding.Extensions Version=4.1.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
    
       at System.Diagnostics.Process..cctor()
       --- End of inner exception stack trace ---
       at System.Diagnostics.Process.EnsureSigChildHandler()
       at System.Diagnostics.Process.StartCore(ProcessStartInfo startInfo)
       at System.Diagnostics.Process.Start()
       at CoreclrTestLib.CoreclrTestWrapperLib.RunTest(String executable String outputFile String errorFile)
       at reflection_regression._dev10bugs_Dev10_630880_Dev10_630880_._dev10bugs_Dev10_630880_Dev10_630880_cmd()
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180810.01 (Core Tests)
Failing configurations:
- opensuse.423.amd64-x64
  - 

Details:
https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180810.01/workItem/reflection.regression.XUnitWrapper/analysis/xunit/reflection_regression._dev10bugs_Dev10_629953_Dev10_629953_~2F_dev10bugs_Dev10_629953_Dev10_629953_cmd",test-run-uwp-coreclr,RussKeldorph,10/08/2018 18:34,11/08/2018 1:00
19403,OSX CoreFX CI Leg is Consistently Failing,It appears that all runs of this CI leg are failing due to tests timing out: https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_debug_osx10.12_corefx_innerloop_prtest/,OSX CoreFX CI Leg is Consistently Failing It appears that all runs of this CI leg are failing due to tests timing out: https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_debug_osx10.12_corefx_innerloop_prtest/,area-Infrastructure-coreclr,BruceForstall,10/08/2018 14:23,17/08/2018 9:40
19402,Run DotNet Core App on X86 Without OS,How to run DotNet Core app on X86 without OS?,Run DotNet Core App on X86 Without OS How to run DotNet Core app on X86 without OS?,question,jkotas,10/08/2018 13:34,15/08/2018 23:43
19401,update order of locks so gcstress is unblocked,,update order of locks so gcstress is unblocked ,,davmason,,
19400,Track conversion of Intel Hardware Intrinsics tests to generated format,"This is an umbrella issue to track progress of conversion of all tests as detailed in #19245 and #19246


### Avx
 [ ]  Blend
 [ ]  BroadcastScalarToVector128
 [ ]  BroadcastScalarToVector256
 [ ]  BroadcastVector128ToVector256
 [ ]  CompareScalar
 [ ]  Compare
 [ ]  ConvertToSingle
 [ ]  ConvertToVector
 [ ]  DotProduct
 [ ]  HorizontalAdd
 [ ]  HorizontalSubtract
 [ ]  InsertExtractVector128
 [ ]  LoadAlignedVector256
 [ ]  LoadDquVector256
 [ ]  LoadVector256
 [ ]  MaskLoad
 [ ]  MoveMask
 [ ]  Permute2x128.Avx
 [ ]  SetAllVector256
 [ ]  SetVector256
 [ ]  SetZeroVector256
 [ ]  Sqrt
 [ ]  StaticCast
 [ ]  StoreAlignedNonTemporal
 [ ]  StoreAligned
 [ ]  Store
 [ ]  UnpackHigh
 [ ]  UnpackLow

### Avx2
 [ ]  AddSaturate
 [ ]  BroadcastVector128ToVector256
 [ ]  ConvertToVector256
 [ ]  HorizontalAdd
 [ ]  HorizontalSubtract
 [ ]  LoadAlignedVector256NonTemporal
 [ ]  MoveMask
 [ ]  Multiply
 [ ]  ShiftLeftLogicalVariable
 [ ]  ShiftRightLogicalVariable
 [ ]  SubtractSaturate
 [ ]  UnpackHigh
 [ ]  UnpackLow

### Sse
 [ ]  ConvertScalarToVector128Single
 [ ]  ConvertToInt32WithTruncation #19998
 [ ]  ConvertToInt32 #19998
 [ ]  ConvertToInt64WithTruncation #19998
 [ ]  ConvertToInt64 #19998
 [ ]  ConvertToSingle #19998
 [ ]  LoadAlignedVector128
 [ ]  LoadHigh
 [ ]  LoadLow
 [ ]  LoadScalarVector128
 [ ]  LoadVector128
 [ ]  MoveHighToLow
 [ ]  MoveLowToHigh
 [ ]  MoveMask
 [ ]  MoveScalar
 [ ]  Prefetch
 [ ]  ReciprocalScalar
 [ ]  ReciprocalSqrtScalar
 [ ]  ReciprocalSqrt
 [ ]  Reciprocal
 [ ]  SetAllVector128
 [ ]  SetScalarVector128
 [ ]  SetVector128
 [ ]  SetZeroVector128
 [ ]  Shuffle
 [ ]  SqrtScalar
 [ ]  Sqrt
 [ ]  StaticCast
 [ ]  StoreAlignedNonTemporal
 [ ]  StoreAligned
 [ ]  StoreFence
 [ ]  StoreHigh
 [ ]  StoreLow
 [ ]  StoreScalar
 [ ]  Store
 [ ]  UnpackHigh
 [ ]  UnpackLow

### Sse2
 [x]  CompareEqualOrderedScalar #19673
 [x]  CompareEqualScalar #19673
 [x]  CompareEqualUnorderedScalar #19673
 [x]  CompareGreaterThanOrderedScalar #19673
 [x]  CompareGreaterThanOrEqualOrderedScalar #19673
 [x]  CompareGreaterThanOrEqualScalar #19673
 [x]  CompareGreaterThanOrEqualUnorderedScalar #19673
 [x]  CompareGreaterThanScalar #19673
 [x]  CompareGreaterThanUnorderedScalar #19673
 [x]  CompareLessThanOrderedScalar #19673
 [x]  CompareLessThanOrEqualOrderedScalar #19673
 [x]  CompareLessThanOrEqualScalar #19673
 [x]  CompareLessThanOrEqualUnorderedScalar #19673
 [x]  CompareLessThanScalar #19673
 [x]  CompareLessThanUnorderedScalar #19673
 [x]  CompareNotEqualOrderedScalar #19673
 [x]  CompareNotEqualScalar #19673
 [x]  CompareNotEqualUnorderedScalar #19673
 [x]  CompareNotGreaterThanOrEqualScalar #19673
 [x]  CompareNotGreaterThanScalar #19673
 [x]  CompareNotLessThanOrEqualScalar #19673
 [x]  CompareNotLessThanScalar #19673
 [x]  CompareOrderedScalar #19673
 [x]  CompareUnorderedScalar #19673
 [ ]  ConvertScalarToVector128Double
 [ ]  ConvertScalarToVector128Int32 #19998
 [ ]  ConvertScalarToVector128Int64 #19998
 [ ]  ConvertScalarToVector128Single
 [ ]  ConvertScalarToVector128UInt32 #19998
 [ ]  ConvertScalarToVector128UInt64 #19998
 [x]  ConvertToDouble #19677 
 [x]  ConvertToInt32WithTruncation #19677
 [x]  ConvertToInt32 #19677
 [x]  ConvertToInt64WithTruncation #19677
 [x]  ConvertToInt64 #19677
 [x]  ConvertToUInt32 #19677
 [x]  ConvertToUInt64 #19677
 [x]  ConvertToVector128Double #19677
 [x]  ConvertToVector128Int32WithTruncation #19677
 [x]  ConvertToVector128Int32 #19677
 [x]  ConvertToVector128Single #19677
 [ ]  LoadAlignedVector128
 [ ]  LoadFence
 [ ]  LoadHigh
 [ ]  LoadLow
 [ ]  LoadScalarVector128
 [ ]  LoadVector128
 [ ]  MaskMove
 [ ]  MemoryFence
 [ ]  MoveMask
 [ ]  MoveScalar.Int64
 [ ]  MoveScalar.UInt64
 [ ]  MoveScalar
 [ ]  MultiplyHigh
 [ ]  MultiplyHorizontalAdd
 [ ]  MultiplyLow
 [ ]  Multiply
 [ ]  PackSignedSaturate #19670
 [ ]  PackUnsignedSaturate #19670
 [ ]  SetScalarVector128
 [ ]  SetVector128
 [ ]  SetZeroVector128
 [ ]  ShuffleHigh
 [ ]  ShuffleLow
 [ ]  Shuffle
 [ ]  SqrtScalar
 [ ]  Sqrt
 [ ]  StoreAlignedNonTemporal
 [ ]  StoreAligned
 [ ]  StoreHigh
 [ ]  StoreLow
 [ ]  StoreNonTemporal
 [ ]  StoreScalar
 [ ]  Store
 [ ]  SumAbsoluteDifferences
 [ ]  UnpackHigh #19670
 [ ]  UnpackLow #19670

### Sse3
 [ ]  LoadAndDuplicateToVector128
 [ ]  LoadDquVector128
 [ ]  MoveAndDuplicate
 [ ]  MoveHighAndDuplicate
 [ ]  MoveLowAndDuplicate

### Sse41
 [ ]  Blend
 [ ]  ConvertToVector128
 [ ]  DotProduct
 [ ]  LoadAlignedVector128NonTemporal
 [ ]  MinHorizontal
 [ ]  MultipleSumAbsoluteDifferences
 [ ]  Multiply

### Sse42
 [ ]  Crc32

### Ssse3
 [ ]  AlignRight
","Track conversion of Intel Hardware Intrinsics tests to generated format This is an umbrella issue to track progress of conversion of all tests as detailed in #19245 and #19246


### Avx
 [ ]  Blend
 [ ]  BroadcastScalarToVector128
 [ ]  BroadcastScalarToVector256
 [ ]  BroadcastVector128ToVector256
 [ ]  CompareScalar
 [ ]  Compare
 [ ]  ConvertToSingle
 [ ]  ConvertToVector
 [ ]  DotProduct
 [ ]  HorizontalAdd
 [ ]  HorizontalSubtract
 [ ]  InsertExtractVector128
 [ ]  LoadAlignedVector256
 [ ]  LoadDquVector256
 [ ]  LoadVector256
 [ ]  MaskLoad
 [ ]  MoveMask
 [ ]  Permute2x128.Avx
 [ ]  SetAllVector256
 [ ]  SetVector256
 [ ]  SetZeroVector256
 [ ]  Sqrt
 [ ]  StaticCast
 [ ]  StoreAlignedNonTemporal
 [ ]  StoreAligned
 [ ]  Store
 [ ]  UnpackHigh
 [ ]  UnpackLow

### Avx2
 [ ]  AddSaturate
 [ ]  BroadcastVector128ToVector256
 [ ]  ConvertToVector256
 [ ]  HorizontalAdd
 [ ]  HorizontalSubtract
 [ ]  LoadAlignedVector256NonTemporal
 [ ]  MoveMask
 [ ]  Multiply
 [ ]  ShiftLeftLogicalVariable
 [ ]  ShiftRightLogicalVariable
 [ ]  SubtractSaturate
 [ ]  UnpackHigh
 [ ]  UnpackLow

### Sse
 [ ]  ConvertScalarToVector128Single
 [ ]  ConvertToInt32WithTruncation #19998
 [ ]  ConvertToInt32 #19998
 [ ]  ConvertToInt64WithTruncation #19998
 [ ]  ConvertToInt64 #19998
 [ ]  ConvertToSingle #19998
 [ ]  LoadAlignedVector128
 [ ]  LoadHigh
 [ ]  LoadLow
 [ ]  LoadScalarVector128
 [ ]  LoadVector128
 [ ]  MoveHighToLow
 [ ]  MoveLowToHigh
 [ ]  MoveMask
 [ ]  MoveScalar
 [ ]  Prefetch
 [ ]  ReciprocalScalar
 [ ]  ReciprocalSqrtScalar
 [ ]  ReciprocalSqrt
 [ ]  Reciprocal
 [ ]  SetAllVector128
 [ ]  SetScalarVector128
 [ ]  SetVector128
 [ ]  SetZeroVector128
 [ ]  Shuffle
 [ ]  SqrtScalar
 [ ]  Sqrt
 [ ]  StaticCast
 [ ]  StoreAlignedNonTemporal
 [ ]  StoreAligned
 [ ]  StoreFence
 [ ]  StoreHigh
 [ ]  StoreLow
 [ ]  StoreScalar
 [ ]  Store
 [ ]  UnpackHigh
 [ ]  UnpackLow

### Sse2
 [x]  CompareEqualOrderedScalar #19673
 [x]  CompareEqualScalar #19673
 [x]  CompareEqualUnorderedScalar #19673
 [x]  CompareGreaterThanOrderedScalar #19673
 [x]  CompareGreaterThanOrEqualOrderedScalar #19673
 [x]  CompareGreaterThanOrEqualScalar #19673
 [x]  CompareGreaterThanOrEqualUnorderedScalar #19673
 [x]  CompareGreaterThanScalar #19673
 [x]  CompareGreaterThanUnorderedScalar #19673
 [x]  CompareLessThanOrderedScalar #19673
 [x]  CompareLessThanOrEqualOrderedScalar #19673
 [x]  CompareLessThanOrEqualScalar #19673
 [x]  CompareLessThanOrEqualUnorderedScalar #19673
 [x]  CompareLessThanScalar #19673
 [x]  CompareLessThanUnorderedScalar #19673
 [x]  CompareNotEqualOrderedScalar #19673
 [x]  CompareNotEqualScalar #19673
 [x]  CompareNotEqualUnorderedScalar #19673
 [x]  CompareNotGreaterThanOrEqualScalar #19673
 [x]  CompareNotGreaterThanScalar #19673
 [x]  CompareNotLessThanOrEqualScalar #19673
 [x]  CompareNotLessThanScalar #19673
 [x]  CompareOrderedScalar #19673
 [x]  CompareUnorderedScalar #19673
 [ ]  ConvertScalarToVector128Double
 [ ]  ConvertScalarToVector128Int32 #19998
 [ ]  ConvertScalarToVector128Int64 #19998
 [ ]  ConvertScalarToVector128Single
 [ ]  ConvertScalarToVector128UInt32 #19998
 [ ]  ConvertScalarToVector128UInt64 #19998
 [x]  ConvertToDouble #19677 
 [x]  ConvertToInt32WithTruncation #19677
 [x]  ConvertToInt32 #19677
 [x]  ConvertToInt64WithTruncation #19677
 [x]  ConvertToInt64 #19677
 [x]  ConvertToUInt32 #19677
 [x]  ConvertToUInt64 #19677
 [x]  ConvertToVector128Double #19677
 [x]  ConvertToVector128Int32WithTruncation #19677
 [x]  ConvertToVector128Int32 #19677
 [x]  ConvertToVector128Single #19677
 [ ]  LoadAlignedVector128
 [ ]  LoadFence
 [ ]  LoadHigh
 [ ]  LoadLow
 [ ]  LoadScalarVector128
 [ ]  LoadVector128
 [ ]  MaskMove
 [ ]  MemoryFence
 [ ]  MoveMask
 [ ]  MoveScalar.Int64
 [ ]  MoveScalar.UInt64
 [ ]  MoveScalar
 [ ]  MultiplyHigh
 [ ]  MultiplyHorizontalAdd
 [ ]  MultiplyLow
 [ ]  Multiply
 [ ]  PackSignedSaturate #19670
 [ ]  PackUnsignedSaturate #19670
 [ ]  SetScalarVector128
 [ ]  SetVector128
 [ ]  SetZeroVector128
 [ ]  ShuffleHigh
 [ ]  ShuffleLow
 [ ]  Shuffle
 [ ]  SqrtScalar
 [ ]  Sqrt
 [ ]  StoreAlignedNonTemporal
 [ ]  StoreAligned
 [ ]  StoreHigh
 [ ]  StoreLow
 [ ]  StoreNonTemporal
 [ ]  StoreScalar
 [ ]  Store
 [ ]  SumAbsoluteDifferences
 [ ]  UnpackHigh #19670
 [ ]  UnpackLow #19670

### Sse3
 [ ]  LoadAndDuplicateToVector128
 [ ]  LoadDquVector128
 [ ]  MoveAndDuplicate
 [ ]  MoveHighAndDuplicate
 [ ]  MoveLowAndDuplicate

### Sse41
 [ ]  Blend
 [ ]  ConvertToVector128
 [ ]  DotProduct
 [ ]  LoadAlignedVector128NonTemporal
 [ ]  MinHorizontal
 [ ]  MultipleSumAbsoluteDifferences
 [ ]  Multiply

### Sse42
 [ ]  Crc32

### Ssse3
 [ ]  AlignRight
",area-CodeGen,fiigii,10/08/2018 11:46,21/09/2019 8:47
19398,[dev/unix_test_workflow] Add crossgen_comparison job,,[dev/unix_test_workflow] Add crossgen_comparison job ,* NO MERGE *,echesakovMSFT,10/08/2018 10:43,11/08/2018 8:05
19397,Assertion failed 'op1->OperGet() == GT_LONG || op1->OperGet() == GT_MUL_LONG',"x86 Checked Windows CoreFX JitStressRegs=8

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_corefx_jitstressregs8/554/consoleText

hundreds of instances of:


This has been failing for a while.

@dotnet/jit-contrib ","Assertion failed 'op1->OperGet() == GT_LONG || op1->OperGet() == GT_MUL_LONG' x86 Checked Windows CoreFX JitStressRegs=8

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_corefx_jitstressregs8/554/consoleText

hundreds of instances of:


This has been failing for a while.

@dotnet/jit-contrib ",arch-x86,CarolEidt,,
19388,WIP NO-MERGE Dummy test for dev/unix_test_workflow change of build VMs,,WIP NO-MERGE Dummy test for dev/unix_test_workflow change of build VMs ,* NO MERGE *,BruceForstall,10/08/2018 5:27,14/08/2018 8:28
19386,[Win/Infrastructure] Regression introduced by #19324 - removed parallel msbuild for tests,"PR #19324 lost default MSBuild argument  /maxcpucount which enabled parallel MSBuild test build. Build time on my laptop increased 2x.

cc @AaronRobinsonMSFT ","[Win/Infrastructure] Regression introduced by #19324 - removed parallel msbuild for tests PR #19324 lost default MSBuild argument  /maxcpucount which enabled parallel MSBuild test build. Build time on my laptop increased 2x.

cc @AaronRobinsonMSFT ",area-Infrastructure-coreclr,AaronRobinsonMSFT,10/08/2018 5:06,11/08/2018 4:10
19384,Fix a couple of apartment state issues,"Fix for https://github.com/dotnet/coreclr/issues/17822
- The apartment state now defaults to MTA for the main thread along with a CoInitialize
- Calling  as expected (different behavior from previous netcore same behavior as netfx)

Fix for https://github.com/dotnet/coreclr/issues/19225","Fix a couple of apartment state issues Fix for https://github.com/dotnet/coreclr/issues/17822
- The apartment state now defaults to MTA for the main thread along with a CoInitialize
- Calling  as expected (different behavior from previous netcore same behavior as netfx)

Fix for https://github.com/dotnet/coreclr/issues/19225",area-System.Threading,kouvel,,
19381,Introduce reinterpret in Span<T>,"Hello

I know that there are discussions around Span<T> and having a reinterpret. I'm not quite sure though if this means if there is an explicit method for this or if it will be implicit. So maybe you can point me in some direction with the code below and if Span<T> will support it:

I have a filestream where I read my data. Unfortunately there is no ReadArray<T> but only a ReadBytes().
For that reason I have currently following code.



Are there any plans or suggestions?","Introduce reinterpret in Span<T> Hello

I know that there are discussions around Span<T> and having a reinterpret. I'm not quite sure though if this means if there is an explicit method for this or if it will be implicit. So maybe you can point me in some direction with the code below and if Span<T> will support it:

I have a filestream where I read my data. Unfortunately there is no ReadArray<T> but only a ReadBytes().
For that reason I have currently following code.



Are there any plans or suggestions?",area-System.Memory,RussKeldorph,10/08/2018 1:53,10/08/2018 3:33
19376,CoreClr failed to build on Windows due to MSBUILD ERROR : error MSB1001: Unknown switch. Switch: --,"Hello
I am testing CoreCLR on Windows with VS 2017 15.7.2. It failed due to the ""error MSB1001: Unknown switch. Switch: --"". It casued by commit:https://github.com/dotnet/coreclr/commit/b37c6d8ee5b4ad9833f21cfc30582b56797e37b4.
I noticed you removed '--' on purpose I am surprised why does not support '--' to add  extra MSBUILD options? Is there other way that we can add extra MSBUILD flags when building source!

You can repro the issue as the steps below:
1. git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2. Open a clean x86 prompt (C:\windows\syswow64\cmd.exe) and browse to D:\CoreCLR\src
3. build x86 release -- /clp:ShowCommandLine

Could you please give me a workaround for this or consider rollback this to use '--' when building?
Thank you!","CoreClr failed to build on Windows due to MSBUILD ERROR : error MSB1001: Unknown switch. Switch: -- Hello
I am testing CoreCLR on Windows with VS 2017 15.7.2. It failed due to the ""error MSB1001: Unknown switch. Switch: --"". It casued by commit:https://github.com/dotnet/coreclr/commit/b37c6d8ee5b4ad9833f21cfc30582b56797e37b4.
I noticed you removed '--' on purpose I am surprised why does not support '--' to add  extra MSBUILD options? Is there other way that we can add extra MSBUILD flags when building source!

You can repro the issue as the steps below:
1. git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2. Open a clean x86 prompt (C:\windows\syswow64\cmd.exe) and browse to D:\CoreCLR\src
3. build x86 release -- /clp:ShowCommandLine

Could you please give me a workaround for this or consider rollback this to use '--' when building?
Thank you!",area-Infrastructure-coreclr,BruceForstall,,
19374,[Question] Strange behavior when loading assemblies and its dependencies programatically,Not sure if it's a bug I asked on SO but it seems no one has idea on it. [Question](https://stackoverflow.com/questions/51738633/strange-behavior-when-loading-assemblies-and-its-dependencies-programatically),[Question] Strange behavior when loading assemblies and its dependencies programatically Not sure if it's a bug I asked on SO but it seems no one has idea on it. [Question](https://stackoverflow.com/questions/51738633/strange-behavior-when-loading-assemblies-and-its-dependencies-programatically),area-AssemblyLoader,jkotas,9/08/2018 13:50,10/08/2018 20:25
19370,JIT generates binary different code in x86_arm and arm_arm due to host NaN representation,"It seems that assumption that two crossgens (x86_arm and arm_arm) generate binary identical code is not 100% true. 
I encountered this for 

@dotnet/jit-contrib Is there any better idea how to approach this issue?","JIT generates binary different code in x86_arm and arm_arm due to host NaN representation It seems that assumption that two crossgens (x86_arm and arm_arm) generate binary identical code is not 100% true. 
I encountered this for 

@dotnet/jit-contrib Is there any better idea how to approach this issue?",arch-arm32,echesakovMSFT,9/08/2018 8:21,21/08/2018 3:18
19368,[RyuJIT/arm64] Implement ELT hooks,"It looks like genProfilingEnterCallback and genProfilingLeaveCallback will NYI on arm64.
","[RyuJIT/arm64] Implement ELT hooks It looks like genProfilingEnterCallback and genProfilingLeaveCallback will NYI on arm64.
",area-CodeGen,echesakovMSFT,,
19361,Segfault in libcoreclr.so,"I'm experiencing a segmentation fault on .NET Core 2 on Linux/docker under versions 2.1.2 and 2.0.9 when my process is under heavy load and using a lot of memory. 

I haven't tried to reproduce outside of Linux/docker but I have reproduced on both AWS Kubernetes and my local Docker for Windows with identical stack traces.

Here are some details from capturing the segfault under the debugger:



I don't have the coredump from this particular crash (because it got OOM killed after calling VerifyHeap!) but most times it crashes the top of the stack is identical to this (see attached file 4 for one of the times it didn't look like this). 

Unfortunately I can't post the code because it's proprietary. We're working on trying to produce a minimal test case but that's a lot easier said than done. However if you have somewhere secure and private to upload core dumps to I could do that.

I have also attached information from the debugger from other crashes (the one above is file 3):

[dumpinfo1.txt](https://github.com/dotnet/coreclr/files/2271414/dumpinfo1.txt)
[dumpinfo2.txt](https://github.com/dotnet/coreclr/files/2271413/dumpinfo2.txt)
[dumpinfo3.txt](https://github.com/dotnet/coreclr/files/2271412/dumpinfo3.txt)
[dumpinfo4.txt](https://github.com/dotnet/coreclr/files/2271415/dumpinfo4.txt)


The environment I set up to reproduce the issue is here: https://github.com/ist-ltd/dotnet-core-debug-helper-tools - but it relies on a private docker image.","Segfault in libcoreclr.so I'm experiencing a segmentation fault on .NET Core 2 on Linux/docker under versions 2.1.2 and 2.0.9 when my process is under heavy load and using a lot of memory. 

I haven't tried to reproduce outside of Linux/docker but I have reproduced on both AWS Kubernetes and my local Docker for Windows with identical stack traces.

Here are some details from capturing the segfault under the debugger:



I don't have the coredump from this particular crash (because it got OOM killed after calling VerifyHeap!) but most times it crashes the top of the stack is identical to this (see attached file 4 for one of the times it didn't look like this). 

Unfortunately I can't post the code because it's proprietary. We're working on trying to produce a minimal test case but that's a lot easier said than done. However if you have somewhere secure and private to upload core dumps to I could do that.

I have also attached information from the debugger from other crashes (the one above is file 3):

[dumpinfo1.txt](https://github.com/dotnet/coreclr/files/2271414/dumpinfo1.txt)
[dumpinfo2.txt](https://github.com/dotnet/coreclr/files/2271413/dumpinfo2.txt)
[dumpinfo3.txt](https://github.com/dotnet/coreclr/files/2271412/dumpinfo3.txt)
[dumpinfo4.txt](https://github.com/dotnet/coreclr/files/2271415/dumpinfo4.txt)


The environment I set up to reproduce the issue is here: https://github.com/ist-ltd/dotnet-core-debug-helper-tools - but it relies on a private docker image.",area-CodeGen,sandreenko,,
19360,Invalid flag causing test build failures in master,"Opened on behalf of @MattGal

Maybe something to do with escaping quote characters?



Warnings: 1
Status Message: failed

Build : 3.0 - 20180808.04 (Product Build)
Failing configurations:
- Alpine3.6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat 7
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- OSX
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
  - Build-Tests-R2R-Release
  - Build-Tests-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180808.04/workItem/Orchestration/analysis/external/Link)","Invalid flag causing test build failures in master Opened on behalf of @MattGal

Maybe something to do with escaping quote characters?



Warnings: 1
Status Message: failed

Build : 3.0 - 20180808.04 (Product Build)
Failing configurations:
- Alpine3.6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat 7
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- OSX
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
  - Build-Tests-R2R-Release
  - Build-Tests-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180808.04/workItem/Orchestration/analysis/external/Link)",,BruceForstall,,
19358,MS build failure compling test sources,"Opened on behalf of @spshant
@russkeldorph Can you please take a look:
2018-08-08T12:59:47.9671610Z E:\A\_work\99\s\tests\publishdependency.targets(915): warning : Your project is not referencing the "".NETCoreAppVersion=v3.0"" framework. Add a reference to "".NETCoreAppVersion=v3.0"" in the ""frameworks"" section of your project.json and then re-run NuGet restore. [E:\A\_work\99\s\tests\runtest.proj]
2018-08-08T12:59:47.9672360Z E:\A\_work\99\s\tests\publishdependency.targets(915): warning : Your project is not referencing the "".NETCoreAppVersion=v3.0"" framework. Add a reference to "".NETCoreAppVersion=v3.0"" in the ""frameworks"" section of your project.json and then re-run NuGet restore. [E:\A\_work\99\s\tests\runtest.proj]
2018-08-08T12:59:47.9673128Z E:\A\_work\99\s\tests\publishdependency.targets(915): warning : Your project is not referencing the "".NETCoreAppVersion=v3.0"" framework. Add a reference to "".NETCoreAppVersion=v3.0"" in the ""frameworks"" section of your project.json and then re-run NuGet restore. [E:\A\_work\99\s\tests\runtest.proj]
2018-08-08T12:59:47.9673619Z     7 Warning(s)
2018-08-08T12:59:47.9673822Z     0 Error(s)
2018-08-08T12:59:47.9674005Z 
2018-08-08T12:59:47.9674211Z Time Elapsed 00:00:00.29
2018-08-08T12:59:47.9854416Z Command execution succeeded.
2018-08-08T12:59:47.9934777Z BUILDTEST: Starting the Managed Tests Build
2018-08-08T12:59:47.9970898Z BUILDTEST: Building tests group 2 with 16 subgroups
2018-08-08T12:59:48.0716070Z MSBUILD : error MSB1001: Unknown switch.
2018-08-08T12:59:48.0716402Z Switch: --
2018-08-08T12:59:48.0716528Z 

Warnings: 1
Status Message: failed

Build : 3.0 - 20180808.04 (Product Build)
Failing configurations:
- Alpine3.6
  - Build-Tests-R2R-Release
- RedHat6
  - Build-Tests-R2R-Release
- RedHat 7
  - Build-Tests-R2R-Release
- OSX
  - Build-Tests-R2R-Release
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-R2R-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180808.04/workItem/Orchestration/analysis/external/Link)","MS build failure compling test sources Opened on behalf of @spshant
@russkeldorph Can you please take a look:
2018-08-08T12:59:47.9671610Z E:\A\_work\99\s\tests\publishdependency.targets(915): warning : Your project is not referencing the "".NETCoreAppVersion=v3.0"" framework. Add a reference to "".NETCoreAppVersion=v3.0"" in the ""frameworks"" section of your project.json and then re-run NuGet restore. [E:\A\_work\99\s\tests\runtest.proj]
2018-08-08T12:59:47.9672360Z E:\A\_work\99\s\tests\publishdependency.targets(915): warning : Your project is not referencing the "".NETCoreAppVersion=v3.0"" framework. Add a reference to "".NETCoreAppVersion=v3.0"" in the ""frameworks"" section of your project.json and then re-run NuGet restore. [E:\A\_work\99\s\tests\runtest.proj]
2018-08-08T12:59:47.9673128Z E:\A\_work\99\s\tests\publishdependency.targets(915): warning : Your project is not referencing the "".NETCoreAppVersion=v3.0"" framework. Add a reference to "".NETCoreAppVersion=v3.0"" in the ""frameworks"" section of your project.json and then re-run NuGet restore. [E:\A\_work\99\s\tests\runtest.proj]
2018-08-08T12:59:47.9673619Z     7 Warning(s)
2018-08-08T12:59:47.9673822Z     0 Error(s)
2018-08-08T12:59:47.9674005Z 
2018-08-08T12:59:47.9674211Z Time Elapsed 00:00:00.29
2018-08-08T12:59:47.9854416Z Command execution succeeded.
2018-08-08T12:59:47.9934777Z BUILDTEST: Starting the Managed Tests Build
2018-08-08T12:59:47.9970898Z BUILDTEST: Building tests group 2 with 16 subgroups
2018-08-08T12:59:48.0716070Z MSBUILD : error MSB1001: Unknown switch.
2018-08-08T12:59:48.0716402Z Switch: --
2018-08-08T12:59:48.0716528Z 

Warnings: 1
Status Message: failed

Build : 3.0 - 20180808.04 (Product Build)
Failing configurations:
- Alpine3.6
  - Build-Tests-R2R-Release
- RedHat6
  - Build-Tests-R2R-Release
- RedHat 7
  - Build-Tests-R2R-Release
- OSX
  - Build-Tests-R2R-Release
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-R2R-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180808.04/workItem/Orchestration/analysis/external/Link)",area-Infrastructure-coreclr,AaronRobinsonMSFT,,
19357,Report a better error message when assembly version conflict is encountered,"I’m seeing very odd intermittent failures on .NET Core 2.1.400-preview-009088 when loading a dependency from a build task.

An example of such failure is https://devdiv.visualstudio.com/DevDiv/_build/results?buildId=1916424&_a=summary&view=logs 

E:\A\_work\154\s\.packages\microsoft.dotnet.arcade.sdk\1.0.0-prerelease-63202-02\tools\Sign.proj(395): error MSB4018: System.IO.FileLoadException: Could not load file or assembly 'System.IO.Packaging Version=4.0.3.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. Could not find or load a specific file. (Exception from HRESULT: 0x80131621)
E:\A\_work\154\s\.packages\microsoft.dotnet.arcade.sdk\1.0.0-prerelease-63202-02\tools\Sign.proj(395): error MSB4018: File name: 'System.IO.Packaging Version=4.0.3.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'

The file being loaded (System.IO.Packaging) is located in the same directory as the build task assembly.

Memory dump: %internal_share%\tomat\Bugs\CoreLoaderBug

Turns out we have two tasks that depend on a different version of System.IO.Packaging - 4.0.2.0 and 4.0.3.0. The load error is intermittent since it depends on the order in which these two versions are loaded. The solution to this problem would be to load tasks to separate Assembly Load Contexts: https://github.com/Microsoft/msbuild/issues/1754.

However the assembly loader should report an error that indicates the version mismatch instead of the above error.","Report a better error message when assembly version conflict is encountered I’m seeing very odd intermittent failures on .NET Core 2.1.400-preview-009088 when loading a dependency from a build task.

An example of such failure is https://devdiv.visualstudio.com/DevDiv/_build/results?buildId=1916424&_a=summary&view=logs 

E:\A\_work\154\s\.packages\microsoft.dotnet.arcade.sdk\1.0.0-prerelease-63202-02\tools\Sign.proj(395): error MSB4018: System.IO.FileLoadException: Could not load file or assembly 'System.IO.Packaging Version=4.0.3.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. Could not find or load a specific file. (Exception from HRESULT: 0x80131621)
E:\A\_work\154\s\.packages\microsoft.dotnet.arcade.sdk\1.0.0-prerelease-63202-02\tools\Sign.proj(395): error MSB4018: File name: 'System.IO.Packaging Version=4.0.3.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'

The file being loaded (System.IO.Packaging) is located in the same directory as the build task assembly.

Memory dump: %internal_share%\tomat\Bugs\CoreLoaderBug

Turns out we have two tasks that depend on a different version of System.IO.Packaging - 4.0.2.0 and 4.0.3.0. The load error is intermittent since it depends on the order in which these two versions are loaded. The solution to this problem would be to load tasks to separate Assembly Load Contexts: https://github.com/Microsoft/msbuild/issues/1754.

However the assembly loader should report an error that indicates the version mismatch instead of the above error.",area-AssemblyLoader,tmat,9/08/2018 2:42,11/08/2018 8:16
19355,Slowdown of code when doing subtraction of ints.,"[Reproduction repo](https://github.com/aensidhe/dotnet-core-minus-regression)

**Problem**

Code with writing  class but it's of much smaller magnitude.

If we choose smaller ints (like 200 not 1<<30) it will not change anything.","Slowdown of code when doing subtraction of ints. [Reproduction repo](https://github.com/aensidhe/dotnet-core-minus-regression)

**Problem**

Code with writing  class but it's of much smaller magnitude.

If we choose smaller ints (like 200 not 1<<30) it will not change anything.",area-CodeGen,mikedn,8/08/2018 23:59,26/01/2019 8:37
19352,Add PInvoke/Structures tests,,Add PInvoke/Structures tests ,area-Interop,jkoritzinsky,,
19348,Add PInvoke/SizeParamIndex tests,,Add PInvoke/SizeParamIndex tests ,area-Interop,jkoritzinsky,,
19347,Assert failure: !IsAfContentType_WindowsRuntime(pModule->GetAssemblyRefFlags(tkType)),"Seen in Ubuntu arm32 Checked R2R testing:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/arm_cross_checked_ubuntu_r2r_flow/20/

Also e.g. Ubuntu x64 Checked R2R:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/x64_checked_ubuntu_r2r_flow/2364/

","Assert failure: !IsAfContentType_WindowsRuntime(pModule->GetAssemblyRefFlags(tkType)) Seen in Ubuntu arm32 Checked R2R testing:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/arm_cross_checked_ubuntu_r2r_flow/20/

Also e.g. Ubuntu x64 Checked R2R:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/x64_checked_ubuntu_r2r_flow/2364/

",area-ReadyToRun,BruceForstall,8/08/2018 15:25,13/08/2018 10:09
19346,Assertion failed 'varDsc->lvImplicitlyReferenced',"Looks like a regression due to https://github.com/dotnet/coreclr/pull/19325

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/checked_windows_nt/10114/consoleText

3 failures e.g.


@AndyAyersMS 
cc @dotnet/jit-contrib ","Assertion failed 'varDsc->lvImplicitlyReferenced' Looks like a regression due to https://github.com/dotnet/coreclr/pull/19325

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/checked_windows_nt/10114/consoleText

3 failures e.g.


@AndyAyersMS 
cc @dotnet/jit-contrib ",area-CodeGen,AndyAyersMS,,
19341,WIP NO-MERGE Dummy change,,WIP NO-MERGE Dummy change ,* NO MERGE *,BruceForstall,8/08/2018 8:23,9/08/2018 13:13
19340,Test failure in tracing\runtimeeventsource\runtimeeventsource\runtimeeventsource.cmd,"There is a recent regression in tracing\runtimeeventsource\runtimeeventsource\runtimeeventsource.cmd in (at least?) the Window x64 zapdisable test leg run with:


","Test failure in tracing\runtimeeventsource\runtimeeventsource\runtimeeventsource.cmd There is a recent regression in tracing\runtimeeventsource\runtimeeventsource\runtimeeventsource.cmd in (at least?) the Window x64 zapdisable test leg run with:


",area-Tracing,jorive,,
19339,GThread inconsistent test failures,"I see inconsistent failures in baseservices\threading\generics\threadstart\GThread23\GThread23.cmd as well as GThread22 GThread24 for Windows x64 Checked test jobs in the CI. Looks like timeouts:



Overall: https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/checked_windows_nt/

Also saw one timeout in Regressions\coreclr\1514\InterlockExchange\InterlockExchange.cmd
","GThread inconsistent test failures I see inconsistent failures in baseservices\threading\generics\threadstart\GThread23\GThread23.cmd as well as GThread22 GThread24 for Windows x64 Checked test jobs in the CI. Looks like timeouts:



Overall: https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/checked_windows_nt/

Also saw one timeout in Regressions\coreclr\1514\InterlockExchange\InterlockExchange.cmd
",area-System.Threading,BruceForstall,8/08/2018 7:31,
19337,PDBs for crossgenned binaries on Linux/macOS?,"I've been working on https://github.com/PowerShell/PowerShell/issues/7348 trying to get symbols available for PowerShell releases.

It looks like PDB generation for crossgen builds is:
 - possible on Windows with https://github.com/dotnet/coreclr/pull/4572
 - but not possible on Linux/macOS with DiaSymReader not open source (based on https://github.com/dotnet/coreclr/issues/8175)

Is that still correct?

Just want to register that PowerShell would get use out of PDBs for crossgen builds on Linux/macOS.","PDBs for crossgenned binaries on Linux/macOS? I've been working on https://github.com/PowerShell/PowerShell/issues/7348 trying to get symbols available for PowerShell releases.

It looks like PDB generation for crossgen builds is:
 - possible on Windows with https://github.com/dotnet/coreclr/pull/4572
 - but not possible on Linux/macOS with DiaSymReader not open source (based on https://github.com/dotnet/coreclr/issues/8175)

Is that still correct?

Just want to register that PowerShell would get use out of PDBs for crossgen builds on Linux/macOS.",area-Diagnostics,jkotas,8/08/2018 6:27,8/08/2018 6:59
19333,[automated] Merge branch 'release/2.1' => 'release/2.2',"I detected changes in the release/2.1 branch which have not been merged yet to release/2.2.
I'm a robot and am configured to help you automatically keep release/2.2 up to date so
I've opened this PR.

This PR merges commits made on release/2.1 by the following committers:

* @joshfree

## Instructions for merging

This PR will not be auto-merged. When pull request checks pass please complete this PR
by creating a merge commit *not* a squash or rebase commit.

<img alt=""merge button instructions"" src=""https://i.imgur.com/GepcNJV.png"" width=""300"" />

You can also do this on command line:


:warning: If there are merge conflicts you will need to resolve them manually before merging.

Please contact ASP.NET Core Engineering if you have questions or issues.
Also if this PR was generated incorrectly help us fix it. See https://github.com/aspnet/BuildTools/blob/master/scripts/GitHubMergeBranches.ps1.","[automated] Merge branch 'release/2.1' => 'release/2.2' I detected changes in the release/2.1 branch which have not been merged yet to release/2.2.
I'm a robot and am configured to help you automatically keep release/2.2 up to date so
I've opened this PR.

This PR merges commits made on release/2.1 by the following committers:

* @joshfree

## Instructions for merging

This PR will not be auto-merged. When pull request checks pass please complete this PR
by creating a merge commit *not* a squash or rebase commit.

<img alt=""merge button instructions"" src=""https://i.imgur.com/GepcNJV.png"" width=""300"" />

You can also do this on command line:


:warning: If there are merge conflicts you will need to resolve them manually before merging.

Please contact ASP.NET Core Engineering if you have questions or issues.
Also if this PR was generated incorrectly help us fix it. See https://github.com/aspnet/BuildTools/blob/master/scripts/GitHubMergeBranches.ps1.",os-tizen,wtgodbe,8/08/2018 3:23,9/08/2018 4:03
19330,Add PInvoke/SafeHandles tests,,Add PInvoke/SafeHandles tests ,area-Interop,jkoritzinsky,,
19328,Add PInvoke/NativeCallManagedComVisible tests,,Add PInvoke/NativeCallManagedComVisible tests ,area-Interop,jkoritzinsky,,
19327,Bad check test count,,Bad check test count ,* NO MERGE *,BruceForstall,7/08/2018 16:19,8/08/2018 7:58
19326,Add PInvoke/Miscellaneous tests,,Add PInvoke/Miscellaneous tests ,area-Interop,jkoritzinsky,,
19324,Use dotnet MSBuild for tests,"Revert the revert of #19254

cc @BruceForstall @chsienki ","Use dotnet MSBuild for tests Revert the revert of #19254

cc @BruceForstall @chsienki ",test enhancement,BruceForstall,7/08/2018 12:56,8/08/2018 10:42
19323,Add PInvoke/Delegate tests,,Add PInvoke/Delegate tests ,area-Interop,jkoritzinsky,,
19322,some methods unexpectedly bypass tier0 jitting and go straight to tier1,"Noticed this while messing about with the interpreter. A few methods from corelib unexpectedly end up getting jitted initially at tier1 and bypass tier0. 

@kouvel compiled this list for MusicStore:

These all seem to be methods that use Vector or HW intrinsics. So perhaps when they bail out from crossgen something important gets bypassed and as a result tiering thinks that they're not tiering-eligible.

cc @noahfalk ","some methods unexpectedly bypass tier0 jitting and go straight to tier1 Noticed this while messing about with the interpreter. A few methods from corelib unexpectedly end up getting jitted initially at tier1 and bypass tier0. 

@kouvel compiled this list for MusicStore:

These all seem to be methods that use Vector or HW intrinsics. So perhaps when they bail out from crossgen something important gets bypassed and as a result tiering thinks that they're not tiering-eligible.

cc @noahfalk ",area-TieredCompilation,kouvel,,
19317,spmi shim counter accesses mcs before it is initialized,"To repro: build then set up environment:




","spmi shim counter accesses mcs before it is initialized To repro: build then set up environment:




",area-CodeGen,sandreenko,,
19309,Only register signals and create alt exception stack in coreclr.,"There was a couple of places where the DAC (IsValidObject GetAppDomainForObject)
assumed that a NULL target/debuggee address would throw an exception that would
be caught by try/catch. Any other invalid address is handled with a software
exception throwed by the read memory functions. In general it is a better overall
design not to have any of the DBI/DAC etc. code depend on hardware exceptions
being caught. On Linux the C++ runtime sometimes can't handle it. There is a
slight risk that there are other places in the DAC that make the NULL address
assumption but testing so far has found any.

Added PAL_SetInitializeDLLFlags as a fallback to allow the PAL_InitializeDLL flags
to be set for a PAL instance for the DAC where we could still register h/w signals
but not the altstack switching to reduce this risk. The flags can't be build time
conditional because we only build one coreclrpal.a library that all the modules
used. Having a PAL_InitializeFlags function doesn't really help either because of
the PAL_RegisterModule call to PAL_IntializeDLL and the LoadLibrary dance/protocol
that uses it to call the loading module's DLLMain.

Remove flags from PAL_INITIALIZE and PAL_INITIALIZE_DLL default. Add PAL_InitializeFlags()
to allow the default to be overridden.","Only register signals and create alt exception stack in coreclr. There was a couple of places where the DAC (IsValidObject GetAppDomainForObject)
assumed that a NULL target/debuggee address would throw an exception that would
be caught by try/catch. Any other invalid address is handled with a software
exception throwed by the read memory functions. In general it is a better overall
design not to have any of the DBI/DAC etc. code depend on hardware exceptions
being caught. On Linux the C++ runtime sometimes can't handle it. There is a
slight risk that there are other places in the DAC that make the NULL address
assumption but testing so far has found any.

Added PAL_SetInitializeDLLFlags as a fallback to allow the PAL_InitializeDLL flags
to be set for a PAL instance for the DAC where we could still register h/w signals
but not the altstack switching to reduce this risk. The flags can't be build time
conditional because we only build one coreclrpal.a library that all the modules
used. Having a PAL_InitializeFlags function doesn't really help either because of
the PAL_RegisterModule call to PAL_IntializeDLL and the LoadLibrary dance/protocol
that uses it to call the loading module's DLLMain.

Remove flags from PAL_INITIALIZE and PAL_INITIALIZE_DLL default. Add PAL_InitializeFlags()
to allow the default to be overridden.",,mikem8361,,
19308,Fix type of cast node generated by box import,"Importing box to primitive type may produce a cast node that has ""incorrect"" type:
https://github.com/dotnet/coreclr/blob/ac8f8e52c49b0ffa712d68730a41883d281bea01/src/jit/importer.cpp#L5681
Normally the type of the cast node is ","Fix type of cast node generated by box import Importing box to primitive type may produce a cast node that has ""incorrect"" type:
https://github.com/dotnet/coreclr/blob/ac8f8e52c49b0ffa712d68730a41883d281bea01/src/jit/importer.cpp#L5681
Normally the type of the cast node is ",area-CodeGen,RussKeldorph,7/08/2018 2:51,
19307,Support for reflection-invoking methods that take pointers by reference,"dotnet/coreclr#17732 added support for reflection-invoking methods that return unmanaged pointers by reference (so e.g. .

(Note this behavior is on parity with the desktop CLR so it has quite likely been this broken for 17 years.)","Support for reflection-invoking methods that take pointers by reference dotnet/coreclr#17732 added support for reflection-invoking methods that return unmanaged pointers by reference (so e.g. .

(Note this behavior is on parity with the desktop CLR so it has quite likely been this broken for 17 years.)",area-System.Reflection,MichalStrehovsky,7/08/2018 2:07,
19304,Add PInvoke/Primitives/Int tests,,Add PInvoke/Primitives/Int tests ,area-Interop,jkoritzinsky,,
19303,Add PInvoke/ExactSpelling tests,,Add PInvoke/ExactSpelling tests ,area-Interop,jkoritzinsky,,
19302,Test failure: tracing_eventsource._eventpipeandetw_eventpipeandetw_eventpipeandetw_/_eventpipeandetw_eventpipeandetw_eventpipeandetw_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.InvalidOperationException: TdhEnumerateProviders failed.\r
       at Microsoft.Diagnostics.Tracing.Session.TraceEventSession.get_ProviderNameToGuid()\r
       at Microsoft.Diagnostics.Tracing.Session.TraceEventProviders.GetProviderGuidByName(String name)\r
       at Microsoft.Diagnostics.Tracing.Session.TraceEventSession.EnableProvider(String providerName TraceEventLevel providerLevel UInt64 matchAnyKeywords TraceEventProviderOptions options)\r
       at Tracing.Tests.EventPipeAndEtw.EnableETW(EventSource eventSource EventKeywords keywords String outputFile) in E:\\A\\_work\\138\\s\\tests\\src\\tracing\\eventsource\\eventpipeandetw\\EventPipeAndEtw.cs:line 113\r
       at Tracing.Tests.EventPipeAndEtw.RoundOne(String[] args) in E:\\A\\_work\\138\\s\\tests\\src\\tracing\\eventsource\\eventpipeandetw\\EventPipeAndEtw.cs:line 144\r
       at Tracing.Tests.EventPipeAndEtw.Main(String[] args) in E:\\A\\_work\\138\\s\\tests\\src\\tracing\\eventsource\\eventpipeandetw\\EventPipeAndEtw.cs:line 287
    
    
    Return code:      1
    Raw output file:      C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Work\\c8415983-ece0-46e7-b42d-256fbc794b63\\Unzip\\Reports\\tracing.eventsource\\eventpipeandetw\\eventpipeandetw\\eventpipeandetw.output.txt
    Raw output:
    BEGIN EXECUTION\r
            1 file(s) copied.\r
    \"" C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Payload\\crossgen.exe\"" /Platform_Assemblies_Paths C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Payload;C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Work\\c8415983-ece0-46e7-b42d-256fbc794b63\\Unzip\\eventpipeandetw\\eventpipeandetw\\IL;C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Work\\c8415983-ece0-46e7-b42d-256fbc794b63\\Unzip\\eventpipeandetw\\eventpipeandetw /in eventpipeandetw.org /out eventpipeandetw.exe\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image eventpipeandetw.exe generated successfully.\r
     \""C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Payload\\corerun.exe\"" eventpipeandetw.exe \r
    \tStart: Enable EventPipe.\r
    \tEnd: Enable EventPipe.
    \r
    \tStart: Enable ETW.\r
    Expected: 100\r
    Actual: -532462766\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Payload
    > C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Work\\c8415983-ece0-46e7-b42d-256fbc794b63\\Unzip\\eventpipeandetw\\eventpipeandetw\\eventpipeandetw.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180806.01 (Ready-To-Run Tests)
Failing configurations:
- Windows.10.Nano.Amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180806.01/workItem/tracing.eventsource.XUnitWrapper/analysis/xunit/tracing_eventsource._eventpipeandetw_eventpipeandetw_eventpipeandetw_~2F_eventpipeandetw_eventpipeandetw_eventpipeandetw_cmd","Test failure: tracing_eventsource._eventpipeandetw_eventpipeandetw_eventpipeandetw_/_eventpipeandetw_eventpipeandetw_eventpipeandetw_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.InvalidOperationException: TdhEnumerateProviders failed.\r
       at Microsoft.Diagnostics.Tracing.Session.TraceEventSession.get_ProviderNameToGuid()\r
       at Microsoft.Diagnostics.Tracing.Session.TraceEventProviders.GetProviderGuidByName(String name)\r
       at Microsoft.Diagnostics.Tracing.Session.TraceEventSession.EnableProvider(String providerName TraceEventLevel providerLevel UInt64 matchAnyKeywords TraceEventProviderOptions options)\r
       at Tracing.Tests.EventPipeAndEtw.EnableETW(EventSource eventSource EventKeywords keywords String outputFile) in E:\\A\\_work\\138\\s\\tests\\src\\tracing\\eventsource\\eventpipeandetw\\EventPipeAndEtw.cs:line 113\r
       at Tracing.Tests.EventPipeAndEtw.RoundOne(String[] args) in E:\\A\\_work\\138\\s\\tests\\src\\tracing\\eventsource\\eventpipeandetw\\EventPipeAndEtw.cs:line 144\r
       at Tracing.Tests.EventPipeAndEtw.Main(String[] args) in E:\\A\\_work\\138\\s\\tests\\src\\tracing\\eventsource\\eventpipeandetw\\EventPipeAndEtw.cs:line 287
    
    
    Return code:      1
    Raw output file:      C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Work\\c8415983-ece0-46e7-b42d-256fbc794b63\\Unzip\\Reports\\tracing.eventsource\\eventpipeandetw\\eventpipeandetw\\eventpipeandetw.output.txt
    Raw output:
    BEGIN EXECUTION\r
            1 file(s) copied.\r
    \"" C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Payload\\crossgen.exe\"" /Platform_Assemblies_Paths C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Payload;C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Work\\c8415983-ece0-46e7-b42d-256fbc794b63\\Unzip\\eventpipeandetw\\eventpipeandetw\\IL;C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Work\\c8415983-ece0-46e7-b42d-256fbc794b63\\Unzip\\eventpipeandetw\\eventpipeandetw /in eventpipeandetw.org /out eventpipeandetw.exe\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image eventpipeandetw.exe generated successfully.\r
     \""C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Payload\\corerun.exe\"" eventpipeandetw.exe \r
    \tStart: Enable EventPipe.\r
    \tEnd: Enable EventPipe.
    \r
    \tStart: Enable ETW.\r
    Expected: 100\r
    Actual: -532462766\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Payload
    > C:\\work\\f2125dcf-0985-4d70-b7d0-00824a6edc84\\Work\\c8415983-ece0-46e7-b42d-256fbc794b63\\Unzip\\eventpipeandetw\\eventpipeandetw\\eventpipeandetw.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180806.01 (Ready-To-Run Tests)
Failing configurations:
- Windows.10.Nano.Amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180806.01/workItem/tracing.eventsource.XUnitWrapper/analysis/xunit/tracing_eventsource._eventpipeandetw_eventpipeandetw_eventpipeandetw_~2F_eventpipeandetw_eventpipeandetw_eventpipeandetw_cmd",area-Tracing,jorive,,
19301,Add PInvoke/Decimal tests,Fixes #18908,Add PInvoke/Decimal tests Fixes #18908,area-Interop,jkoritzinsky,,
19300,Cannot run linux-arm64 published binary on CentOS 7 ARM64: GLIBCXX_3.4.21 not found,"The nuget packages built for linux-arm64 uses higher GLIBCXX versions than that on CentOS 7.

Steps to reproduce:
On a x86_64 machine with latest .NET Core SDK installed:
","Cannot run linux-arm64 published binary on CentOS 7 ARM64: GLIBCXX_3.4.21 not found The nuget packages built for linux-arm64 uses higher GLIBCXX versions than that on CentOS 7.

Steps to reproduce:
On a x86_64 machine with latest .NET Core SDK installed:
",arch-arm64,jkotas,6/08/2018 17:45,
19299,Test failure: JIT_HardwareIntrinsics._X86_Avx_Avx_ro_Avx_ro_/_X86_Avx_Avx_ro_Avx_ro_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.

/Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Work/acf3d313-bf55-4ff6-952f-68bfbb7b9dbf/Unzip/X86/Avx/Avx_ro/Avx_ro.sh: line 244: 76085 Abort trap: 6           $_DebuggerFullPath \""$CORE_ROOT/corerun\"" $ExePath $CLRTestExecutionArguments
    
    
    Return code:      1
    Raw output file:      /Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Work/acf3d313-bf55-4ff6-952f-68bfbb7b9dbf/Unzip/Reports\\JIT.HardwareIntrinsics\\X86\\Avx\\Avx_ro\\Avx_ro.output.txt
    Raw output:
    BEGIN EXECUTION
    /Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Payload/corerun Avx_ro.exe
    Supported ISAs:
      AES:       False
      AVX:       True
      AVX2:      False
      BMI1:      False
      BMI2:      False
      FMA:       False
      LZCNT:     False
      PCLMULQDQ: False
      POPCNT:    True
      SSE:       True
      SSE2:      True
      SSE3:      True
      SSE4.1:    True
      SSE4.2:    True
      SSSE3:     True
    
    Beginning test case Add.Double at 08/05/2018 19:26:15
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Add.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case AddSubtract.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case AddSubtract.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case And.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case And.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case AndNot.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case AndNot.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case BlendVariable.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case BlendVariable.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Ceiling.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Ceiling.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Divide.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Divide.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case DuplicateEvenIndexed.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case DuplicateEvenIndexed.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case DuplicateOddIndexed.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Extract.Byte.1 at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    Expected: 100
    Actual: 134
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Payload
    > /Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Work/acf3d313-bf55-4ff6-952f-68bfbb7b9dbf/Unzip/X86/Avx/Avx_ro/Avx_ro.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180806.01 (Core Tests)
Failing configurations:
- osx.1013.amd64-x64
  - 
- osx.1012.amd64-x64
  - 

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180806.01/workItem/JIT.HardwareIntrinsics.XUnitWrapper/analysis/xunit/JIT_HardwareIntrinsics._X86_Avx_Avx_ro_Avx_ro_~2F_X86_Avx_Avx_ro_Avx_ro_cmd","Test failure: JIT_HardwareIntrinsics._X86_Avx_Avx_ro_Avx_ro_/_X86_Avx_Avx_ro_Avx_ro_cmd Opened on behalf of @Sunny-pu

The test  has failed.

/Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Work/acf3d313-bf55-4ff6-952f-68bfbb7b9dbf/Unzip/X86/Avx/Avx_ro/Avx_ro.sh: line 244: 76085 Abort trap: 6           $_DebuggerFullPath \""$CORE_ROOT/corerun\"" $ExePath $CLRTestExecutionArguments
    
    
    Return code:      1
    Raw output file:      /Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Work/acf3d313-bf55-4ff6-952f-68bfbb7b9dbf/Unzip/Reports\\JIT.HardwareIntrinsics\\X86\\Avx\\Avx_ro\\Avx_ro.output.txt
    Raw output:
    BEGIN EXECUTION
    /Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Payload/corerun Avx_ro.exe
    Supported ISAs:
      AES:       False
      AVX:       True
      AVX2:      False
      BMI1:      False
      BMI2:      False
      FMA:       False
      LZCNT:     False
      PCLMULQDQ: False
      POPCNT:    True
      SSE:       True
      SSE2:      True
      SSE3:      True
      SSE4.1:    True
      SSE4.2:    True
      SSSE3:     True
    
    Beginning test case Add.Double at 08/05/2018 19:26:15
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Add.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case AddSubtract.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case AddSubtract.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case And.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case And.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case AndNot.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case AndNot.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case BlendVariable.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case BlendVariable.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Ceiling.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Ceiling.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Divide.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Divide.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case DuplicateEvenIndexed.Double at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case DuplicateEvenIndexed.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case DuplicateOddIndexed.Single at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    
    Ending test case at 08/05/2018 19:26:16
    Beginning test case Extract.Byte.1 at 08/05/2018 19:26:16
    Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
    
    Expected: 100
    Actual: 134
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Payload
    > /Users/dotnet-bot/dotnetbuild/work/94bf0b1f-9c0f-4b51-8b45-bc2c3b20cff7/Work/acf3d313-bf55-4ff6-952f-68bfbb7b9dbf/Unzip/X86/Avx/Avx_ro/Avx_ro.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180806.01 (Core Tests)
Failing configurations:
- osx.1013.amd64-x64
  - 
- osx.1012.amd64-x64
  - 

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180806.01/workItem/JIT.HardwareIntrinsics.XUnitWrapper/analysis/xunit/JIT_HardwareIntrinsics._X86_Avx_Avx_ro_Avx_ro_~2F_X86_Avx_Avx_ro_Avx_ro_cmd",area-CodeGen,CarolEidt,,
19298,Add PInvoke/DateTime tests,,Add PInvoke/DateTime tests ,area-Interop,jkoritzinsky,,
19297,Add PInvoke/CriticalHandles tests,,Add PInvoke/CriticalHandles tests ,area-Interop,jkoritzinsky,,
19295,Frequent failure in CoreFX ReadAsyncCompletesIfFlushAsyncCanceledMidFlush test,"This fails in Jenkins frequently though not always e.g.:

Windows x86:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/562/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/560/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/558/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/557/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/554/

Windows x64:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_windows_nt_corefx_baseline/590/


","Frequent failure in CoreFX ReadAsyncCompletesIfFlushAsyncCanceledMidFlush test This fails in Jenkins frequently though not always e.g.:

Windows x86:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/562/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/560/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/558/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/557/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/554/

Windows x64:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_windows_nt_corefx_baseline/590/


",,pakrym,,
19293,Array -> Memory -> Span overly defensive?,"Creating a {ReadOnly}Memory from an array does lots of checks; which is correct
https://github.com/dotnet/coreclr/blob/9d1e7dd8eb744b14eb4a90b401e854d7a5f79fff/src/System.Private.CoreLib/shared/System/Memory.cs#L96-L113

Slicing a {ReadOnly}Memory also performs bounds checks based on the confirmed offset and lengths

However creating a Span from and array backed {ReadOnly}Memory uses the regular array constructor
https://github.com/dotnet/coreclr/blob/9d1e7dd8eb744b14eb4a90b401e854d7a5f79fff/src/System.Private.CoreLib/shared/System/Memory.cs#L286-L289

Which then rechecks all the parameters again 
https://github.com/dotnet/coreclr/blob/9d1e7dd8eb744b14eb4a90b401e854d7a5f79fff/src/System.Private.CoreLib/shared/System/Span.Fast.cs#L73-L89

This makes an array backed Memory the most expensive kind of Span creator.

Does it need to recheck everything or can it use an internal Span .ctor that bypasses the additional checks?

/cc @jkotas @stephentoub @GrabYourPitchforks @davidfowl @ahsonkhan ","Array -> Memory -> Span overly defensive? Creating a {ReadOnly}Memory from an array does lots of checks; which is correct
https://github.com/dotnet/coreclr/blob/9d1e7dd8eb744b14eb4a90b401e854d7a5f79fff/src/System.Private.CoreLib/shared/System/Memory.cs#L96-L113

Slicing a {ReadOnly}Memory also performs bounds checks based on the confirmed offset and lengths

However creating a Span from and array backed {ReadOnly}Memory uses the regular array constructor
https://github.com/dotnet/coreclr/blob/9d1e7dd8eb744b14eb4a90b401e854d7a5f79fff/src/System.Private.CoreLib/shared/System/Memory.cs#L286-L289

Which then rechecks all the parameters again 
https://github.com/dotnet/coreclr/blob/9d1e7dd8eb744b14eb4a90b401e854d7a5f79fff/src/System.Private.CoreLib/shared/System/Span.Fast.cs#L73-L89

This makes an array backed Memory the most expensive kind of Span creator.

Does it need to recheck everything or can it use an internal Span .ctor that bypasses the additional checks?

/cc @jkotas @stephentoub @GrabYourPitchforks @davidfowl @ahsonkhan ",area-System.Memory,jkotas,5/08/2018 18:36,17/11/2018 11:42
19292,.NET Core 2.1: Non-GAC DLLs Not Found,See https://github.com/PowerShell/PowerShell/issues/7326 and https://github.com/PowerShell/PowerShell/issues/7076 for further details. Thank you!,.NET Core 2.1: Non-GAC DLLs Not Found See https://github.com/PowerShell/PowerShell/issues/7326 and https://github.com/PowerShell/PowerShell/issues/7076 for further details. Thank you!,area-AssemblyLoader,vitek-karas,5/08/2018 12:37,8/08/2018 6:46
19289,AggressiveInlining flaw?,"I can understand why a method with MethodImplOptions.AggressiveInlining attribute passed as Action cannot be in-lined when called. However I don't see any reason why such method couldn't be in-lined in case it is passed to a constructor and stored in a readonly field. See the following code fragment.
I believe the call to ","AggressiveInlining flaw? I can understand why a method with MethodImplOptions.AggressiveInlining attribute passed as Action cannot be in-lined when called. However I don't see any reason why such method couldn't be in-lined in case it is passed to a constructor and stored in a readonly field. See the following code fragment.
I believe the call to ",area-CodeGen,jkotas,4/08/2018 18:32,4/08/2018 23:19
19288,Incorrect up-sizing for non-power-of-2 structs that are not LclVars,"When loading a struct from an arbitrary location it is not safe to load any more bytes than the specified size of the struct. For instance in the case where you're loading a 3-byte struct that's in the last three bytes of a page the next byte following the struct may be on a page that is unmapped or not readable.

A JIT dump showed this transformation during the morph process (note the 

This branch was modified a couple of months ago in https://github.com/dotnet/coreclr/pull/18358 to remove an additional check in there that was also checking if the source was a LclVar before adjusting the size.

@CarolEidt Can you please take a look and determine whether we need to reintroduce that check or make a better fix?","Incorrect up-sizing for non-power-of-2 structs that are not LclVars When loading a struct from an arbitrary location it is not safe to load any more bytes than the specified size of the struct. For instance in the case where you're loading a 3-byte struct that's in the last three bytes of a page the next byte following the struct may be on a page that is unmapped or not readable.

A JIT dump showed this transformation during the morph process (note the 

This branch was modified a couple of months ago in https://github.com/dotnet/coreclr/pull/18358 to remove an additional check in there that was also checking if the source was a LclVar before adjusting the size.

@CarolEidt Can you please take a look and determine whether we need to reintroduce that check or make a better fix?",arch-arm64,CarolEidt,,
19285,r2rdump test failure: FileNotFoundException HelloWorld.xml,"Looks like the x64 release build has been failing with this problem for a while.

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/release_windows_nt/



@acmyu @nattress ","r2rdump test failure: FileNotFoundException HelloWorld.xml Looks like the x64 release build has been failing with this problem for a while.

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/release_windows_nt/



@acmyu @nattress ",,acmyu,,
19283,[RyuJIT] switch statement can be further optimized when using bitmasks,"RyuJIT has room for optimization in switch statements like the case below.

 logic and I'm seeing patterns very similar to this in the optimized code.

category:cq
theme:optimization
skill-level:intermediate
cost:large","[RyuJIT] switch statement can be further optimized when using bitmasks RyuJIT has room for optimization in switch statements like the case below.

 logic and I'm seeing patterns very similar to this in the optimized code.

category:cq
theme:optimization
skill-level:intermediate
cost:large",area-CodeGen,AaronRobinsonMSFT,4/08/2018 9:16,
19282,WIP Update base services tests to SDK style projects,Update all the tests in baseservices to be SDK style projects,WIP Update base services tests to SDK style projects Update all the tests in baseservices to be SDK style projects,* NO MERGE *,chsienki,4/08/2018 8:56,24/05/2019 12:38
19279,[Feature] Have optimizer aggressively fold branches,"I'd like the JIT to detect when one branch leads to another branch and fold them into a single branch.

I'm sure this optimization has a specific name in compiler theory but I don't know it. If you'll excuse a dumb example:

 manually inlined. Having the compiler optimize away these tests would make a huge difference to me.

category:cq
theme:optimization
skill-level:expert
cost:large","[Feature] Have optimizer aggressively fold branches I'd like the JIT to detect when one branch leads to another branch and fold them into a single branch.

I'm sure this optimization has a specific name in compiler theory but I don't know it. If you'll excuse a dumb example:

 manually inlined. Having the compiler optimize away these tests would make a huge difference to me.

category:cq
theme:optimization
skill-level:expert
cost:large",area-CodeGen,RussKeldorph,4/08/2018 7:08,
19277,Test failure: readytorun_r2rdump._R2RDumpTest_R2RDumpTest_/_R2RDumpTest_R2RDumpTest_cmd,"Opened on behalf of @RussKeldorph

The test  has failed.

The system cannot find the path specified.\r
    The system cannot find the path specified.\r
    The system cannot find the path specified.\r
    The system cannot find the path specified.\r
    
    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\83984791-e58e-4726-a52b-550c3a40b9d5\\Work\\9abd53db-5b26-435c-b386-5cb7c26699a8\\Unzip\\Reports\\readytorun.r2rdump\\R2RDumpTest\\R2RDumpTest.output.txt
    Raw output:
    BEGIN EXECUTION\r
    The system cannot find the path specified.\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image HelloWorld.ni.dll generated successfully.\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image GcInfoTransitions.ni.dll generated successfully.\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image GenericFunctions.ni.dll generated successfully.\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image MultipleRuntimeFunctions.ni.dll generated successfully.\r
     \""C:\\dotnetbuild\\work\\83984791-e58e-4726-a52b-550c3a40b9d5\\Payload\\corerun.exe\"" R2RDumpTest.exe \r
    Starting the test\r
    Expected: 100\r
    Actual: -532462766\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\83984791-e58e-4726-a52b-550c3a40b9d5\\Payload
    > C:\\dotnetbuild\\work\\83984791-e58e-4726-a52b-550c3a40b9d5\\Work\\9abd53db-5b26-435c-b386-5cb7c26699a8\\Unzip\\R2RDumpTest\\R2RDumpTest.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

           at readytorun_r2rdump._R2RDumpTest_R2RDumpTest_._R2RDumpTest_R2RDumpTest_cmd() in E:\A\_work\105\s\bin\tests\Windows_NT.arm.Release\TestWrappers\readytorun.r2rdump\readytorun.r2rdump.XUnitWrapper.cs:line 109
Build : 3.0 - 20180803.04 (Core Tests)
Failing configurations:
- windows.10.arm64-arm
  - 
- osx.1013.amd64-x64
  - 
- osx.1012.amd64-x64
  - 
- sles.12.amd64-x64
  - 
- opensuse.423.amd64-x64
  - 
- ubuntu.1804.amd64-x64
  - 
- ubuntu.1710.amd64-x64
  - 
- ubuntu.1604.amd64-x64
  - 
- ubuntu.1404.amd64-x64
  - 
- redhat.73.amd64-x64
  - 
- fedora.27.amd64-x64
  - 
- fedora.26.amd64-x64
  - 
- debian.82.amd64-x64
  - 
- redhat.69.amd64-x64
  - 
- Alpine.36.Amd64-x64
  - 
- Windows.81.Amd64-x64
  - 
- Windows.7.Amd64-x64
  - 
- Windows.10.Amd64.Core-x64
  - 
- Windows.10.Nano.Amd64-x64
  - 
- Windows.10.Amd64-x64
  - 
","Test failure: readytorun_r2rdump._R2RDumpTest_R2RDumpTest_/_R2RDumpTest_R2RDumpTest_cmd Opened on behalf of @RussKeldorph

The test  has failed.

The system cannot find the path specified.\r
    The system cannot find the path specified.\r
    The system cannot find the path specified.\r
    The system cannot find the path specified.\r
    
    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\83984791-e58e-4726-a52b-550c3a40b9d5\\Work\\9abd53db-5b26-435c-b386-5cb7c26699a8\\Unzip\\Reports\\readytorun.r2rdump\\R2RDumpTest\\R2RDumpTest.output.txt
    Raw output:
    BEGIN EXECUTION\r
    The system cannot find the path specified.\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image HelloWorld.ni.dll generated successfully.\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image GcInfoTransitions.ni.dll generated successfully.\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image GenericFunctions.ni.dll generated successfully.\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image MultipleRuntimeFunctions.ni.dll generated successfully.\r
     \""C:\\dotnetbuild\\work\\83984791-e58e-4726-a52b-550c3a40b9d5\\Payload\\corerun.exe\"" R2RDumpTest.exe \r
    Starting the test\r
    Expected: 100\r
    Actual: -532462766\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\83984791-e58e-4726-a52b-550c3a40b9d5\\Payload
    > C:\\dotnetbuild\\work\\83984791-e58e-4726-a52b-550c3a40b9d5\\Work\\9abd53db-5b26-435c-b386-5cb7c26699a8\\Unzip\\R2RDumpTest\\R2RDumpTest.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

           at readytorun_r2rdump._R2RDumpTest_R2RDumpTest_._R2RDumpTest_R2RDumpTest_cmd() in E:\A\_work\105\s\bin\tests\Windows_NT.arm.Release\TestWrappers\readytorun.r2rdump\readytorun.r2rdump.XUnitWrapper.cs:line 109
Build : 3.0 - 20180803.04 (Core Tests)
Failing configurations:
- windows.10.arm64-arm
  - 
- osx.1013.amd64-x64
  - 
- osx.1012.amd64-x64
  - 
- sles.12.amd64-x64
  - 
- opensuse.423.amd64-x64
  - 
- ubuntu.1804.amd64-x64
  - 
- ubuntu.1710.amd64-x64
  - 
- ubuntu.1604.amd64-x64
  - 
- ubuntu.1404.amd64-x64
  - 
- redhat.73.amd64-x64
  - 
- fedora.27.amd64-x64
  - 
- fedora.26.amd64-x64
  - 
- debian.82.amd64-x64
  - 
- redhat.69.amd64-x64
  - 
- Alpine.36.Amd64-x64
  - 
- Windows.81.Amd64-x64
  - 
- Windows.7.Amd64-x64
  - 
- Windows.10.Amd64.Core-x64
  - 
- Windows.10.Nano.Amd64-x64
  - 
- Windows.10.Amd64-x64
  - 
",area-ReadyToRun,acmyu,,
19273,[Linux/ARM] SIGSEGV during GC under managed debugger,"In some cases SIGSEGV occurs during gc:
 is always not NULL in this case for ARM?

Thank you!","[Linux/ARM] SIGSEGV during GC under managed debugger In some cases SIGSEGV occurs during gc:
 is always not NULL in this case for ARM?

Thank you!",arch-arm32,alpencolt,4/08/2018 1:58,10/01/2019 16:34
19272,RyuJIT: Morph forgets about side effects when optimizing casted shift,"The following example does not print anything in release:
","RyuJIT: Morph forgets about side effects when optimizing casted shift The following example does not print anything in release:
",area-CodeGen,sandreenko,,
19271,HW intrinsics: Expose REP MOVSB/D in API to allow conscious use of ERMSB feature,"Please expose REP MOVSB/D in HW intrinsics API to allow use of ERMSB feature to copy memory blocks without use of SSE and later. obvious use case is - transfer of large memory areas like set of VM pages (typically N x 4Kb for Windows).

Example of numbers obtained by benchmarking and some descriptive text can be found here:
https://stackoverflow.com/a/43574756

category:proposal
theme:intrinsics
skill-level:intermediate
cost:medium","HW intrinsics: Expose REP MOVSB/D in API to allow conscious use of ERMSB feature Please expose REP MOVSB/D in HW intrinsics API to allow use of ERMSB feature to copy memory blocks without use of SSE and later. obvious use case is - transfer of large memory areas like set of VM pages (typically N x 4Kb for Windows).

Example of numbers obtained by benchmarking and some descriptive text can be found here:
https://stackoverflow.com/a/43574756

category:proposal
theme:intrinsics
skill-level:intermediate
cost:medium",area-CodeGen,RussKeldorph,3/08/2018 20:53,
19270,Add PInvoke/DllImportpath tests,,Add PInvoke/DllImportpath tests ,area-Interop,jkoritzinsky,,
19269,Add PInvoke/BestFitMapping tests,,Add PInvoke/BestFitMapping tests ,area-Interop,jkoritzinsky,,
19268,Test failure: tracing_runtimeeventsource._runtimeeventsource_runtimeeventsource_/_runtimeeventsource_runtimeeventsource_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.Exception: Condition 'listener.EventCount > 0' is not true\r
       at Tracing.Tests.Common.Assert.True(String name Boolean condition)\r
       at Tracing.Tests.RuntimeEventSourceTest.Main(String[] args)
    
    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Work\\40455e47-1819-41ce-8ba1-d1c1be28e5bf\\Unzip\\Reports\\tracing.runtimeeventsource\\runtimeeventsource\\runtimeeventsource.output.txt
    Raw output:
    BEGIN EXECUTION\r
            1 file(s) copied.\r
    \"" C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Payload\\crossgen.exe\"" /Platform_Assemblies_Paths C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Payload;C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Work\\40455e47-1819-41ce-8ba1-d1c1be28e5bf\\Unzip\\runtimeeventsource\\IL;C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Work\\40455e47-1819-41ce-8ba1-d1c1be28e5bf\\Unzip\\runtimeeventsource /in runtimeeventsource.org /out runtimeeventsource.exe\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image runtimeeventsource.exe generated successfully.\r
     \""C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Payload\\corerun.exe\"" runtimeeventsource.exe \r
    [Simple] ThreadID = 2768 ID = 200 Name = IncreaseMemoryPressure\r
    TimeStamp: 8/3/2018 2:33:49 AM\r
    LocalTime: 8/3/2018 2:33:49 AM\r
    Difference: -00:00:00.0000304\r
    [Simple] ThreadID = 632 ID = 0 Name = EventSourceMessage\r
    TimeStamp: 8/3/2018 2:33:49 AM\r
    LocalTime: 8/3/2018 2:33:49 AM\r
    Difference: 00:00:00\r
    [NoEvents] ThreadID = 632 ID = 0 Name = EventSourceMessage\r
    TimeStamp: 8/3/2018 2:33:49 AM\r
    LocalTime: 8/3/2018 2:33:49 AM\r
    Difference: 00:00:00\r
    Expected: 100\r
    Actual: -532462766\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Payload
    > C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Work\\40455e47-1819-41ce-8ba1-d1c1be28e5bf\\Unzip\\runtimeeventsource\\runtimeeventsource.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180803.01 (Ready-To-Run Tests)
Failing configurations:
- Windows.7.Amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180803.01/workItem/tracing.runtimeeventsource.XUnitWrapper/analysis/xunit/tracing_runtimeeventsource._runtimeeventsource_runtimeeventsource_~2F_runtimeeventsource_runtimeeventsource_cmd","Test failure: tracing_runtimeeventsource._runtimeeventsource_runtimeeventsource_/_runtimeeventsource_runtimeeventsource_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.Exception: Condition 'listener.EventCount > 0' is not true\r
       at Tracing.Tests.Common.Assert.True(String name Boolean condition)\r
       at Tracing.Tests.RuntimeEventSourceTest.Main(String[] args)
    
    
    Return code:      1
    Raw output file:      C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Work\\40455e47-1819-41ce-8ba1-d1c1be28e5bf\\Unzip\\Reports\\tracing.runtimeeventsource\\runtimeeventsource\\runtimeeventsource.output.txt
    Raw output:
    BEGIN EXECUTION\r
            1 file(s) copied.\r
    \"" C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Payload\\crossgen.exe\"" /Platform_Assemblies_Paths C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Payload;C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Work\\40455e47-1819-41ce-8ba1-d1c1be28e5bf\\Unzip\\runtimeeventsource\\IL;C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Work\\40455e47-1819-41ce-8ba1-d1c1be28e5bf\\Unzip\\runtimeeventsource /in runtimeeventsource.org /out runtimeeventsource.exe\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Native image runtimeeventsource.exe generated successfully.\r
     \""C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Payload\\corerun.exe\"" runtimeeventsource.exe \r
    [Simple] ThreadID = 2768 ID = 200 Name = IncreaseMemoryPressure\r
    TimeStamp: 8/3/2018 2:33:49 AM\r
    LocalTime: 8/3/2018 2:33:49 AM\r
    Difference: -00:00:00.0000304\r
    [Simple] ThreadID = 632 ID = 0 Name = EventSourceMessage\r
    TimeStamp: 8/3/2018 2:33:49 AM\r
    LocalTime: 8/3/2018 2:33:49 AM\r
    Difference: 00:00:00\r
    [NoEvents] ThreadID = 632 ID = 0 Name = EventSourceMessage\r
    TimeStamp: 8/3/2018 2:33:49 AM\r
    LocalTime: 8/3/2018 2:33:49 AM\r
    Difference: 00:00:00\r
    Expected: 100\r
    Actual: -532462766\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Payload
    > C:\\dotnetbuild\\work\\e7ea211b-8ea4-4f83-8f9c-587faa935083\\Work\\40455e47-1819-41ce-8ba1-d1c1be28e5bf\\Unzip\\runtimeeventsource\\runtimeeventsource.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180803.01 (Ready-To-Run Tests)
Failing configurations:
- Windows.7.Amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180803.01/workItem/tracing.runtimeeventsource.XUnitWrapper/analysis/xunit/tracing_runtimeeventsource._runtimeeventsource_runtimeeventsource_~2F_runtimeeventsource_runtimeeventsource_cmd",area-Tracing,brianrob,,
19267,Test failure: JIT_CodeGenBringUpTests._DblRoots_r_DblRoots_r_/_DblRoots_r_DblRoots_r_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.

The system cannot find the file specified.\r
    Error compiling DblRoots_r.org: The system cannot find the file specified. (Exception from HRESULT: 0x80070002)\r
    Error: file \""DblRoots_r.org\"" or one of its dependencies was not found\r
    
    
    Return code:      1
    Raw output file:      C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Work\\942af0b4-095f-4dd4-b8b3-f240d618c442\\Unzip\\Reports\\JIT.CodeGenBringUpTests\\DblRoots_r\\DblRoots_r.output.txt
    Raw output:
    BEGIN EXECUTION\r
    The system cannot find the file specified.\r
    \"" C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Payload\\crossgen.exe\"" /Platform_Assemblies_Paths C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Payload;C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Work\\942af0b4-095f-4dd4-b8b3-f240d618c442\\Unzip\\DblRoots_r\\IL;C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Work\\942af0b4-095f-4dd4-b8b3-f240d618c442\\Unzip\\DblRoots_r /in DblRoots_r.org /out DblRoots_r.exe\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Crossgen failed with exitcode - -3\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Payload
    > C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Work\\942af0b4-095f-4dd4-b8b3-f240d618c442\\Unzip\\DblRoots_r\\DblRoots_r.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180803.01 (Ready-To-Run Tests)
Failing configurations:
- Windows.10.Nano.Amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180803.01/workItem/JIT.CodeGenBringUpTests.XUnitWrapper","Test failure: JIT_CodeGenBringUpTests._DblRoots_r_DblRoots_r_/_DblRoots_r_DblRoots_r_cmd Opened on behalf of @Sunny-pu

The test  has failed.

The system cannot find the file specified.\r
    Error compiling DblRoots_r.org: The system cannot find the file specified. (Exception from HRESULT: 0x80070002)\r
    Error: file \""DblRoots_r.org\"" or one of its dependencies was not found\r
    
    
    Return code:      1
    Raw output file:      C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Work\\942af0b4-095f-4dd4-b8b3-f240d618c442\\Unzip\\Reports\\JIT.CodeGenBringUpTests\\DblRoots_r\\DblRoots_r.output.txt
    Raw output:
    BEGIN EXECUTION\r
    The system cannot find the file specified.\r
    \"" C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Payload\\crossgen.exe\"" /Platform_Assemblies_Paths C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Payload;C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Work\\942af0b4-095f-4dd4-b8b3-f240d618c442\\Unzip\\DblRoots_r\\IL;C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Work\\942af0b4-095f-4dd4-b8b3-f240d618c442\\Unzip\\DblRoots_r /in DblRoots_r.org /out DblRoots_r.exe\r
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0\r
    Copyright (c) Microsoft Corporation.  All rights reserved.\r
    \r
    Crossgen failed with exitcode - -3\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Payload
    > C:\\work\\02b4a928-9662-4407-b289-c7f586bb1e7b\\Work\\942af0b4-095f-4dd4-b8b3-f240d618c442\\Unzip\\DblRoots_r\\DblRoots_r.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

        
Build : 3.0 - 20180803.01 (Ready-To-Run Tests)
Failing configurations:
- Windows.10.Nano.Amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180803.01/workItem/JIT.CodeGenBringUpTests.XUnitWrapper",test-run-uwp-coreclr,sandreenko,,
19266,Add PInvoke/Array tests,,Add PInvoke/Array tests ,area-Interop,jkoritzinsky,,
19262,Update debugging doc with symbol downloader instructions.,,Update debugging doc with symbol downloader instructions. ,,mikem8361,,
19257,JIT: emitter assert running PMI,"Compile attached test case (from #9066 requires 

category:correctness
theme:ir
skill-level:expert
cost:large","JIT: emitter assert running PMI Compile attached test case (from #9066 requires 

category:correctness
theme:ir
skill-level:expert
cost:large",area-CodeGen,AndyAyersMS,,
19256,RyuJIT: Argument written to stack too early on Linux,"On Linux x64 the following program prints 

This does not repro on Windows which is likely related to the fact that both args are passed by reference there.","RyuJIT: Argument written to stack too early on Linux On Linux x64 the following program prints 

This does not repro on Windows which is likely related to the fact that both args are passed by reference there.",area-CodeGen,CarolEidt,,
19255,[armel][2.1.1] Incorrect stepping in debugger,"After setting break point we try to make step but CoreCLR crash with abort.
If we attach with gdb we'll see several .

We've checked latest master and it works. There are several PRs which fix stepping after 2.1 release:
https://github.com/dotnet/coreclr/pull/17617
https://github.com/dotnet/coreclr/pull/17879
https://github.com/dotnet/coreclr/pull/17990
https://github.com/dotnet/coreclr/pull/18129
https://github.com/dotnet/coreclr/pull/18247
They help but not at all - application crashed but little bit later with the same abort.
Are there any others fixes which we've missed?

cc @jkotas @BruceForstall @kbaladurin @BredPet ","[armel][2.1.1] Incorrect stepping in debugger After setting break point we try to make step but CoreCLR crash with abort.
If we attach with gdb we'll see several .

We've checked latest master and it works. There are several PRs which fix stepping after 2.1 release:
https://github.com/dotnet/coreclr/pull/17617
https://github.com/dotnet/coreclr/pull/17879
https://github.com/dotnet/coreclr/pull/17990
https://github.com/dotnet/coreclr/pull/18129
https://github.com/dotnet/coreclr/pull/18247
They help but not at all - application crashed but little bit later with the same abort.
Are there any others fixes which we've missed?

cc @jkotas @BruceForstall @kbaladurin @BredPet ",area-Diagnostics,hoyosjs,,
19248,[arm32] Test failures in finalizearraysleep finalizearray,"With JitStress=1

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_jitstress1_tst/36/artifact/bin/tests/Windows_NT.arm.Checked/Smarty.run.0/Smarty.0.fail.smrt/*view*/



@dotnet/arm32-contrib ","[arm32] Test failures in finalizearraysleep, finalizearray With JitStress=1

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_jitstress1_tst/36/artifact/bin/tests/Windows_NT.arm.Checked/Smarty.run.0/Smarty.0.fail.smrt/*view*/



@dotnet/arm32-contrib ",arch-arm32,BruceForstall,3/08/2018 1:52,17/10/2018 11:10
19246,Remaining non-generated HWIntrinsic tests should be moved to be generated,"Currently there are a number of HWIntrinsic tests that are hand written which leads to maintainability issues and gaps in coverage as compared to the other HWIntrinsic tests (templates have been updated a few times in order to fix bugs or add new scenarios which impacts the vast majority of other HWIntrinsic tests).

It would be beneficial to move them to the same code generation templates as the other HWIntrinsic tests. 

category:testing
theme:vector-codegen
skill-level:intermediate
cost:medium","Remaining non-generated HWIntrinsic tests should be moved to be generated Currently there are a number of HWIntrinsic tests that are hand written which leads to maintainability issues and gaps in coverage as compared to the other HWIntrinsic tests (templates have been updated a few times in order to fix bugs or add new scenarios which impacts the vast majority of other HWIntrinsic tests).

It would be beneficial to move them to the same code generation templates as the other HWIntrinsic tests. 

category:testing
theme:vector-codegen
skill-level:intermediate
cost:medium",area-CodeGen,4creators,,
19245,SSE2 HWIntrinsics tests should be moved to use the code templates,"Currently the majority of the SSE2 HWIntrinsic tests are hand written which leads to maintainability issues and gaps in coverage as compared to the other HWIntrinsic tests (templates have been updated a few times in order to fix bugs or add new scenarios which impacts the vast majority of other HWIntrinsic tests).

It would be beneficial to move them to the same code generation templates as the other HWIntrinsic tests. Additionally if the SSE2 tests were covering relevant code patterns not covered by the existing templates it should be reviewed whether or not adding those scenarios to the templates would be generally beneficial.","SSE2 HWIntrinsics tests should be moved to use the code templates Currently the majority of the SSE2 HWIntrinsic tests are hand written which leads to maintainability issues and gaps in coverage as compared to the other HWIntrinsic tests (templates have been updated a few times in order to fix bugs or add new scenarios which impacts the vast majority of other HWIntrinsic tests).

It would be beneficial to move them to the same code generation templates as the other HWIntrinsic tests. Additionally if the SSE2 tests were covering relevant code patterns not covered by the existing templates it should be reviewed whether or not adding those scenarios to the templates would be generally beneficial.",area-CodeGen,tannergooding,3/08/2018 0:21,25/01/2019 5:31
19243,RyuJIT: Invalid ordering when assigning ref-return,"The following example gives different results in debug and release:
","RyuJIT: Invalid ordering when assigning ref-return The following example gives different results in debug and release:
",,CarolEidt,,
19242,[WIP] dummy change to test dev/unix_test_workflow,,[WIP] dummy change to test dev/unix_test_workflow ,* NO MERGE *,BruceForstall,2/08/2018 15:44,7/08/2018 10:10
19238,Fix interop test targets,Remove TargetFramework from Interop.settings.targets since it already gets handled by the build environment and 2.0 doesn't work.,Fix interop test targets Remove TargetFramework from Interop.settings.targets since it already gets handled by the build environment and 2.0 doesn't work.,test bug,morganbr,,
19236,[WIP] dummy change to test dev/unix_test_workflow branch,,[WIP] dummy change to test dev/unix_test_workflow branch ,* NO MERGE *,dotnet-bot,2/08/2018 11:17,2/08/2018 15:45
19235,Improve StreamWriter format perf,"Override the format overloads for TextWriter and skip the extra string allocation for the formatted string by using StringBuilder directly copying straight to the output buffer.

Improves performance roughtly 10% and cuts allocations by 10x and up (formatting a string into a string goes to *zero* allocations).","Improve StreamWriter format perf Override the format overloads for TextWriter and skip the extra string allocation for the formatted string by using StringBuilder directly copying straight to the output buffer.

Improves performance roughtly 10% and cuts allocations by 10x and up (formatting a string into a string goes to *zero* allocations).",area-System.IO,JeremyKuhne,2/08/2018 10:56,6/08/2018 16:22
19232,Support O_DIRECT file open option handling for FileStream.Unix,"As discussed in #19229 changes are very small. The value 0x4000 is [from Mono](https://github.com/mono/mono/blob/78eb8324b20b29544233c3fe42f6c12e78041ba7/mcs/class/Mono.Posix/Mono.Unix.Native/Syscall.cs#L150) and cross-checked with some Google search.

","Support O_DIRECT file open option handling for FileStream.Unix As discussed in #19229 changes are very small. The value 0x4000 is [from Mono](https://github.com/mono/mono/blob/78eb8324b20b29544233c3fe42f6c12e78041ba7/mcs/class/Mono.Posix/Mono.Unix.Native/Syscall.cs#L150) and cross-checked with some Google search.

",area-System.IO,JeremyKuhne,2/08/2018 7:31,17/09/2018 2:24
19231,Better diagnostics for fail-fast conditions,"Given the simulation process used for rich debugging purposes it may happen that bugs could lead the runtime to an unsafe state. 

When CoreCLR crashes the runtime because of fail-fast conditions it should give (if possible) information about the underlying fail-fast trigger that causes the crash.  It doesn't have to be perfect but it could use something better than COR_E_EXECUTIONENGINE(0x80131506). For the impact of not having the information readily available take a look at #19220 

cc @AndyAyersMS ","Better diagnostics for fail-fast conditions Given the simulation process used for rich debugging purposes it may happen that bugs could lead the runtime to an unsafe state. 

When CoreCLR crashes the runtime because of fail-fast conditions it should give (if possible) information about the underlying fail-fast trigger that causes the crash.  It doesn't have to be perfect but it could use something better than COR_E_EXECUTIONENGINE(0x80131506). For the impact of not having the information readily available take a look at #19220 

cc @AndyAyersMS ",area-Diagnostics,AndyAyersMS,2/08/2018 4:42,
19229,Add O_DIRECT file open option handling for FileStream.Unix,[Here](https://github.com/dotnet/coreclr/blob/75e62c545ac5c7195bf846b47e28c4f27736d64c/src/System.Private.CoreLib/shared/System/IO/FileStream.cs#L204) ,Add O_DIRECT file open option handling for FileStream.Unix [Here](https://github.com/dotnet/coreclr/blob/75e62c545ac5c7195bf846b47e28c4f27736d64c/src/System.Private.CoreLib/shared/System/IO/FileStream.cs#L204) ,area-System.IO,JeremyKuhne,1/08/2018 22:43,2/08/2018 10:20
19204,WIndows does not decode EventSource events if they use enums that not based on int or long.,"@brianrob 

See the VS bug https://microsoft.visualstudio.com/OS/_workitems/edit/18408493 which is where this issue arose.  I have copied the important part in the next comment in case the link break. ","WIndows does not decode EventSource events if they use enums that not based on int or long. @brianrob 

See the VS bug https://microsoft.visualstudio.com/OS/_workitems/edit/18408493 which is where this issue arose.  I have copied the important part in the next comment in case the link break. ",area-Tracing,vancem,,
19203,CRT Pow function has bad performance on Windows,"During benchmarking AoS/SoA ray-tracer https://github.com/dotnet/coreclr/pull/18839 we found that the  on Linux.

The data is collected on Core i9 + VS2017 but Core i7+ VS2015 has the same performance gap.","CRT Pow function has bad performance on Windows During benchmarking AoS/SoA ray-tracer https://github.com/dotnet/coreclr/pull/18839 we found that the  on Linux.

The data is collected on Core i9 + VS2017 but Core i7+ VS2015 has the same performance gap.",area-System.Runtime,fiigii,31/07/2018 6:34,
19201,Enable Tiered Compilation by default,"1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.","Enable Tiered Compilation by default 1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.",area-VM,kouvel,,
19199,Why doesn't the EE save volatile registers for profiler function callbacks?,"Apologies in advance if this question is particularly ignorant or does not belong here. I browsed the repo for things tagged ):

> It is VERY IMPORTANT to note that these function implementations must be
> __declspec(naked) since the EE is not saving any registers before calling
> any of them.  YOU MUST SAVE ALL REGISTERS YOU USE INCLUDING FPU REGISTERS
> IF THE FPU STACK IS NOT EMPTY AND YOU INTEND TO USE IT.

Alright so... *why* does the EE not save any registers (as opposed to following the platform ABI rules for volatiles)? This mostly leads to profilers doing a predictable [register saving dance](https://github.com/Microsoft/clr-samples/blob/master/ProfilingAPI/ELTProfiler/CorProfiler.cpp#L27) before invoking another function the regular way. This is nasty since it requires some platform-specific assembler that's not covered by intrinsics (the alternative being [IL rewriting](https://github.com/Microsoft/clr-samples/blob/master/ProfilingAPI/ReJITEnterLeaveHooks/CorProfiler.cpp) of any and all methods you want to instrument which has its own issues).

What's the design or implementation rationale behind this? Speed? But if every profiler has to save registers anyway (practically speaking assuming not too many are written in raw asm) where would those savings come in? If no hook is set surely the EE could just invoke a stub that literally does nothing (as I believe it already does) while if a hook *is* set it can call a stub to save the volatiles before the profiler proper removing this burden from profilers?

This requirement gets onerous as you're going cross-platform as #18977 illustrates but I'm just interested in why this is (or was deemed) necessary/expedient in the first place.","Why doesn't the EE save volatile registers for profiler function callbacks? Apologies in advance if this question is particularly ignorant or does not belong here. I browsed the repo for things tagged ):

> It is VERY IMPORTANT to note that these function implementations must be
> __declspec(naked) since the EE is not saving any registers before calling
> any of them.  YOU MUST SAVE ALL REGISTERS YOU USE INCLUDING FPU REGISTERS
> IF THE FPU STACK IS NOT EMPTY AND YOU INTEND TO USE IT.

Alright so... *why* does the EE not save any registers (as opposed to following the platform ABI rules for volatiles)? This mostly leads to profilers doing a predictable [register saving dance](https://github.com/Microsoft/clr-samples/blob/master/ProfilingAPI/ELTProfiler/CorProfiler.cpp#L27) before invoking another function the regular way. This is nasty since it requires some platform-specific assembler that's not covered by intrinsics (the alternative being [IL rewriting](https://github.com/Microsoft/clr-samples/blob/master/ProfilingAPI/ReJITEnterLeaveHooks/CorProfiler.cpp) of any and all methods you want to instrument which has its own issues).

What's the design or implementation rationale behind this? Speed? But if every profiler has to save registers anyway (practically speaking assuming not too many are written in raw asm) where would those savings come in? If no hook is set surely the EE could just invoke a stub that literally does nothing (as I believe it already does) while if a hook *is* set it can call a stub to save the volatiles before the profiler proper removing this burden from profilers?

This requirement gets onerous as you're going cross-platform as #18977 illustrates but I'm just interested in why this is (or was deemed) necessary/expedient in the first place.",area-Diagnostics,AaronRobinsonMSFT,31/07/2018 5:02,
19198,Add prefix to DAC's PAL exports for alpine,"Added some cmake logic to create assembly include mapping files. One that maps the
prefixed name (DAC_foo) to the actual name (foo) which is included in the DAC module
and another that maps the actual name to the prefixed name that is included in the SOS
DBI and createdump modules.

The data exports like IID_IUnknown are not prefixed and don't need to be (immutable static data).

There were some C++ exports functions exported with their decorated names in
the CatchHardwareExceptionHolder and NativeExceptionHolderBase classes. Created
PAL_* style export functions that implements the code.

Fix lldb plugin cmake file to use LLDB_H/LLDB_LIB env vars to build it.","Add prefix to DAC's PAL exports for alpine Added some cmake logic to create assembly include mapping files. One that maps the
prefixed name (DAC_foo) to the actual name (foo) which is included in the DAC module
and another that maps the actual name to the prefixed name that is included in the SOS
DBI and createdump modules.

The data exports like IID_IUnknown are not prefixed and don't need to be (immutable static data).

There were some C++ exports functions exported with their decorated names in
the CatchHardwareExceptionHolder and NativeExceptionHolderBase classes. Created
PAL_* style export functions that implements the code.

Fix lldb plugin cmake file to use LLDB_H/LLDB_LIB env vars to build it.",,mikem8361,,
19197,[JITMinOpts=1] CoreFX System.Numerics.Vectors.Tests (Vector3EqualsTest) crashes under minopts,"The test crashes on Windows and Unix under JITMinOpts=1 or TieredCompilation=1. Stack:

","[JITMinOpts=1] CoreFX System.Numerics.Vectors.Tests (Vector3EqualsTest) crashes under minopts The test crashes on Windows and Unix under JITMinOpts=1 or TieredCompilation=1. Stack:

",area-CodeGen,CarolEidt,,
19196,Fix mscordbi metadata reader alignment bug on Linux.,"Works fine on Windows minidumps but on Linux (via OpenVirtualProcess
for production breakpoints and future core dumps) the compiler's struct
alignment rules are different. On Windows classes/structs are aligned
based on the largest field. On Linux they are 4 byte aligned regardless
of the field sizes.

https://github.com/dotnet/coreclr/issues/17692","Fix mscordbi metadata reader alignment bug on Linux. Works fine on Windows minidumps but on Linux (via OpenVirtualProcess
for production breakpoints and future core dumps) the compiler's struct
alignment rules are different. On Windows classes/structs are aligned
based on the largest field. On Linux they are 4 byte aligned regardless
of the field sizes.

https://github.com/dotnet/coreclr/issues/17692",,mikem8361,,
19195,Add ICustomMarshaler tests,"Finally got round to getting https://github.com/dotnet/corefx/pull/17804 into coreclr

@AaronRobinsonMSFT @yizhang82 @tijoytom","Add ICustomMarshaler tests Finally got round to getting https://github.com/dotnet/corefx/pull/17804 into coreclr

@AaronRobinsonMSFT @yizhang82 @tijoytom",area-Interop,AaronRobinsonMSFT,30/07/2018 23:48,19/11/2018 5:31
19194,Dataflow cancellation crashes console app when debugger is attached,"Platform: Windows
Debugger: Visual Studio 2017
Version: 2.1.2

After pressing Ctrl+C The following program will hang before the 2nd beakpoint is hit but only when debugger is attached:

","Dataflow cancellation crashes console app when debugger is attached Platform: Windows
Debugger: Visual Studio 2017
Version: 2.1.2

After pressing Ctrl+C The following program will hang before the 2nd beakpoint is hit but only when debugger is attached:

",area-Diagnostics,AaronRobinsonMSFT,30/07/2018 22:48,26/02/2019 6:07
19192,Unable to catch in managed code any user exception thrown from native Linux code,"Basically I have a solution that contains one project of managed C# .NET Core and another native linux C++ project. The managed code project uses the native one. In the native code I throw various C++ exceptions (such as  (again - although I thought I'm not dealing with corrupted-state exceptions).

All to no avail.

I've set-up [this Minimal Complete and Verifiable example](https://github.com/yaireclipse/CatchNativeExceptions) that demonstrates what I currently fail to achieve and the different attempts to solve it.

Tested with .NET Core 2.0 on Ubuntu 16.04.2 LTS (via Bash on Ubuntu on Windows) and CentOS Linux release 7.5.1804 (via Docker for Windows).

This was actually [asked in the past on Stackoverflow](https://stackoverflow.com/questions/50851329/catch-native-exception-in-dotnet-core) by @levhaikin a colleage of mine with no answers so we turn to you :) :

1.  Is my expectation correct? Meaning is there a way in .NET Core to catch an exception thrown from native code in managed code?
2.  If so what am I doing wrong? How should it be done?

Thanks
Yair","Unable to catch in managed code any user exception thrown from native Linux code Basically I have a solution that contains one project of managed C# .NET Core and another native linux C++ project. The managed code project uses the native one. In the native code I throw various C++ exceptions (such as  (again - although I thought I'm not dealing with corrupted-state exceptions).

All to no avail.

I've set-up [this Minimal Complete and Verifiable example](https://github.com/yaireclipse/CatchNativeExceptions) that demonstrates what I currently fail to achieve and the different attempts to solve it.

Tested with .NET Core 2.0 on Ubuntu 16.04.2 LTS (via Bash on Ubuntu on Windows) and CentOS Linux release 7.5.1804 (via Docker for Windows).

This was actually [asked in the past on Stackoverflow](https://stackoverflow.com/questions/50851329/catch-native-exception-in-dotnet-core) by @levhaikin a colleage of mine with no answers so we turn to you :) :

1.  Is my expectation correct? Meaning is there a way in .NET Core to catch an exception thrown from native code in managed code?
2.  If so what am I doing wrong? How should it be done?

Thanks
Yair",area-Interop,jkotas,30/07/2018 10:41,30/07/2018 11:20
19190,[x64/OSX] JitStress=2 JitStressregs=3 Hardware Intrinsics AVX AVX2 test failures,"Recent OSX PR test failed due to several Hardware Intrinsics failures on:

1.  OSX x64 JitStress=2 JitStressregs=3 
2. OSX x64 JitStress=2

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_osx10.12_jitstress2_jitstressregs3_tst_prtest/2/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_osx10.12_jitstress2_flow_prtest/9/

The failures are as follows:



@tannergooding @fiigii @CarolEidt ","[x64/OSX] JitStress=2 JitStressregs=3 Hardware Intrinsics AVX, AVX2 test failures Recent OSX PR test failed due to several Hardware Intrinsics failures on:

1.  OSX x64 JitStress=2 JitStressregs=3 
2. OSX x64 JitStress=2

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_osx10.12_jitstress2_jitstressregs3_tst_prtest/2/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_osx10.12_jitstress2_flow_prtest/9/

The failures are as follows:



@tannergooding @fiigii @CarolEidt ",area-CodeGen,tannergooding,29/07/2018 23:16,11/12/2018 7:59
19185,JIT: Unnecessary field load for promoted struct,"<sub>tl;dr: tried to go plaid got polka dots</sub>
C# code:
 is completely pointless since it's immediately overwritten.","JIT: Unnecessary field load for promoted struct <sub>tl;dr: tried to go plaid got polka dots</sub>
C# code:
 is completely pointless since it's immediately overwritten.",area-CodeGen,AaronRobinsonMSFT,28/07/2018 11:55,7/02/2019 12:41
19183,Create CI jobs for long running tests,"In https://github.com/dotnet/coreclr/pull/15388 a number of tests were disabled as ""long running"" since they exceed normal job timeouts. This means they are currently never running in some scenarios.

Create a new job or set of jobs or other mechanism to run them sometimes.
","Create CI jobs for long running tests In https://github.com/dotnet/coreclr/pull/15388 a number of tests were disabled as ""long running"" since they exceed normal job timeouts. This means they are currently never running in some scenarios.

Create a new job or set of jobs or other mechanism to run them sometimes.
",area-Infrastructure-coreclr,BruceForstall,28/07/2018 10:34,
19182,[arm32] CQ: improved call sequence for JIT code,"JIT'ed code (but not crossgen/ngen code) always generates direct calls using a 10-byte movw/movt/blx sequence e.g.:
 whether it is ok. For ARM32 this function always says no. (For NGEN it says yes but then if we overflow the required relocs by generating a too-large ngen image it restarts the ngen process and disallows direct branches.)

It might be worth doing some investigation to see how many of these calls are likely to be possible to be made direct. Most seem to be to JIT helpers so it would require the generated code buffer to be relatively close to coreclr.dll.


category:cq
theme:optimization
skill-level:expert
cost:large","[arm32] CQ: improved call sequence for JIT code JIT'ed code (but not crossgen/ngen code) always generates direct calls using a 10-byte movw/movt/blx sequence e.g.:
 whether it is ok. For ARM32 this function always says no. (For NGEN it says yes but then if we overflow the required relocs by generating a too-large ngen image it restarts the ngen process and disallows direct branches.)

It might be worth doing some investigation to see how many of these calls are likely to be possible to be made direct. Most seem to be to JIT helpers so it would require the generated code buffer to be relatively close to coreclr.dll.


category:cq
theme:optimization
skill-level:expert
cost:large",arch-arm32,BruceForstall,28/07/2018 10:19,
19180,build-test - fix TestWrapper CS warnings,@BruceForstall I have splitted my PR #19109 and here is fix for test wrappers only. You can cp or cherry-pick my commit,build-test - fix TestWrapper CS warnings @BruceForstall I have splitted my PR #19109 and here is fix for test wrappers only. You can cp or cherry-pick my commit,area-Interop,BruceForstall,28/07/2018 9:51,28/07/2018 13:50
19179,Alpine tests are all broken ,"https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180727.01

It seems some script issue:


Looking back they have been broken for at least a month so we may not be getting any Alpine coverage for that time at least in official runs.

@RussKeldorph ","Alpine tests are all broken  https://mc.dot.net/#/product/netcore/30/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180727.01

It seems some script issue:


Looking back they have been broken for at least a month so we may not be getting any Alpine coverage for that time at least in official runs.

@RussKeldorph ",area-Infrastructure-coreclr,RussKeldorph,28/07/2018 8:31,3/08/2018 4:27
19178,[Windows/arm64] Update runtime used to run tests,"As part of https://github.com/dotnet/coreclr/issues/18048 (building Windows ARM using public tools) we should also update the snapshot of VC CRT used on the test machines.

netci.groovy currently copies a specific cached copy of part of the CRT when running a Windows arm64 job:

","[Windows/arm64] Update runtime used to run tests As part of https://github.com/dotnet/coreclr/issues/18048 (building Windows ARM using public tools) we should also update the snapshot of VC CRT used on the test machines.

netci.groovy currently copies a specific cached copy of part of the CRT when running a Windows arm64 job:

",arch-arm64,BruceForstall,,
19176,Add comment explaining the return value of ToUpper/ToLower,"Fixes https://github.com/dotnet/corefx/issues/31340

cc @Tornhoof @JarLob","Add comment explaining the return value of ToUpper/ToLower Fixes https://github.com/dotnet/corefx/issues/31340

cc @Tornhoof @JarLob",area-System.Memory,ahsonkhan,,
19175,Reduce the scope of the CCW cache or consider lock free,In processes that heavy use of COM can have considerable contention on the CCW cache lock.  Currently the lock is for the whole process (eg. per-appdomain).,Reduce the scope of the CCW cache or consider lock free In processes that heavy use of COM can have considerable contention on the CCW cache lock.  Currently the lock is for the whole process (eg. per-appdomain).,area-Interop,jeffschwMSFT,28/07/2018 6:22,
19174,Make compiler warnings as errors for test projects to enforce explicit handling of warnings during tests build,"Over last couple of months coreclr tests accumulated increasing number of compiler warnings (C# IL C++) which create a lot of noise. According to my checks there were couple of thousands of them for inner loop tests only.

There are increasing number of msbuild warnings as well however they should be fixed after projects are converted to SDK style.

One of actions which would prevent accumulation of warnings would be treating them as errors by compilers what would force everyone to handle them explicitly. Elimination of current warnings may take more than PR and it would be good to avoid them in future.

cc @BruceForstall @jkotas @AaronRobinsonMSFT @jashook @tannergooding @AndyAyersMS 
","Make compiler warnings as errors for test projects to enforce explicit handling of warnings during tests build Over last couple of months coreclr tests accumulated increasing number of compiler warnings (C# IL C++) which create a lot of noise. According to my checks there were couple of thousands of them for inner loop tests only.

There are increasing number of msbuild warnings as well however they should be fixed after projects are converted to SDK style.

One of actions which would prevent accumulation of warnings would be treating them as errors by compilers what would force everyone to handle them explicitly. Elimination of current warnings may take more than PR and it would be good to avoid them in future.

cc @BruceForstall @jkotas @AaronRobinsonMSFT @jashook @tannergooding @AndyAyersMS 
",area-Infrastructure-coreclr,BruceForstall,28/07/2018 6:18,
19171,Lowering: Atomic ops can produce a value,"This code:
) for the case where the result of an atomic op is passed to a call.","Lowering: Atomic ops can produce a value This code:
) for the case where the result of an atomic op is passed to a call.",area-CodeGen,CarolEidt,,
19168,WIP Update baseservices tests to SDK style csprojs,Update the base services test projects to SDK style projects,WIP Update baseservices tests to SDK style csprojs Update the base services test projects to SDK style projects,* NO MERGE *,chsienki,28/07/2018 4:31,2/08/2018 3:24
19167,BuildTest fails in CI for 2.0.0,"> 11:07:05 Locating coredistools.dll
11:07:05 File Not Found
11:07:05 CoreDisTools library path: 
11:07:05 Failed to locate the downloaded library: 
11:07:05 BUILDTEST: Commencing build of native test components for arm/Debug
11:07:05 BUILDTEST: Using environment: ""C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\Tools\\..\..\VC\Auxiliary\Build\vcvarsall.bat"" x86_arm
11:07:06 **********************************************************************
11:07:06 ** Visual Studio 2017 Developer Command Prompt v15.0.26730.16
11:07:06 ** Copyright (c) 2017 Microsoft Corporation
11:07:06 **********************************************************************
11:07:06 The input line is too long.
11:07:06 :export_x86
11:07:06  was unexpected at this time.
11:07:06 

https://ci.dot.net/job/dotnet_coreclr/job/release_2.0.0/job/arm_cross_release_windows_nt_prtest/

CC @joshfree ","BuildTest fails in CI for 2.0.0 > 11:07:05 Locating coredistools.dll
11:07:05 File Not Found
11:07:05 CoreDisTools library path: 
11:07:05 Failed to locate the downloaded library: 
11:07:05 BUILDTEST: Commencing build of native test components for arm/Debug
11:07:05 BUILDTEST: Using environment: ""C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\Tools\\..\..\VC\Auxiliary\Build\vcvarsall.bat"" x86_arm
11:07:06 **********************************************************************
11:07:06 ** Visual Studio 2017 Developer Command Prompt v15.0.26730.16
11:07:06 ** Copyright (c) 2017 Microsoft Corporation
11:07:06 **********************************************************************
11:07:06 The input line is too long.
11:07:06 :export_x86
11:07:06  was unexpected at this time.
11:07:06 

https://ci.dot.net/job/dotnet_coreclr/job/release_2.0.0/job/arm_cross_release_windows_nt_prtest/

CC @joshfree ",area-Infrastructure-coreclr,wtgodbe,28/07/2018 4:29,4/12/2018 8:41
19166,Suggested enhancements to CheckProjects,"The CheckProjects jit test is intended to verify that all the jit test project files meet our expectations:

* test suffix convention (_d _do etc) matches projects settings
* the IL generated for the test does not depend on the ambient build environment

#19132 points out some example where the optimization settings were not checked
#19131 some examples where the suffix convention was misused

We should enhance CheckProjects to catch those cases.

#19165 is removing check exclusions for the codegen bring up tests so all jit tests (modulo the bugs above) should now conform.

In addition because it can rewrite project files we might want to enhance it so that all projects have a unique GUID.

If / when we convert tests over to using SDK style projects we should make corresponding updates to the tool.

category:testing
theme:testing
skill-level:beginner
cost:small","Suggested enhancements to CheckProjects The CheckProjects jit test is intended to verify that all the jit test project files meet our expectations:

* test suffix convention (_d _do etc) matches projects settings
* the IL generated for the test does not depend on the ambient build environment

#19132 points out some example where the optimization settings were not checked
#19131 some examples where the suffix convention was misused

We should enhance CheckProjects to catch those cases.

#19165 is removing check exclusions for the codegen bring up tests so all jit tests (modulo the bugs above) should now conform.

In addition because it can rewrite project files we might want to enhance it so that all projects have a unique GUID.

If / when we convert tests over to using SDK style projects we should make corresponding updates to the tool.

category:testing
theme:testing
skill-level:beginner
cost:small",area-CodeGen,AndyAyersMS,28/07/2018 4:07,
19164,Interop\COM\NETClients\Primitives\NETClientPrimitives fails on r2r and some jitstress jobs,"- See PR https://github.com/dotnet/coreclr/pull/19122
- Example: https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_windows_nt_r2r_prtest/70/



@AaronRobinsonMSFT this test did not seem to get disabled in these jobs by https://github.com/dotnet/coreclr/pull/19047 though I'm not sure if it's related.

@BruceForstall is there something special about the r2r and jitstress jobs do they run in a particular mode? Is there a way to disable a test from those jobs?","Interop\COM\NETClients\Primitives\NETClientPrimitives fails on r2r and some jitstress jobs - See PR https://github.com/dotnet/coreclr/pull/19122
- Example: https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_windows_nt_r2r_prtest/70/



@AaronRobinsonMSFT this test did not seem to get disabled in these jobs by https://github.com/dotnet/coreclr/pull/19047 though I'm not sure if it's related.

@BruceForstall is there something special about the r2r and jitstress jobs do they run in a particular mode? Is there a way to disable a test from those jobs?",area-Interop,AaronRobinsonMSFT,,
19163,Temporarily flag a SIMD test as optimization-sensitive,"The test runs in several PR-triggered jobs. It fails with minopts and once tiering is enabled it would fail in every PR. See https://github.com/dotnet/coreclr/issues/19124.

CC @dotnet/jit-contrib ","Temporarily flag a SIMD test as optimization-sensitive The test runs in several PR-triggered jobs. It fails with minopts and once tiering is enabled it would fail in every PR. See https://github.com/dotnet/coreclr/issues/19124.

CC @dotnet/jit-contrib ",area-CodeGen,kouvel,,
19161,Finalizer is called on live object,"[This test](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Tests/Cursors/AsyncCursorTests.cs#L452-L530) fails not always but reliably when [run multiple times in a loop](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Run/Program.cs#L10-L17).

The [problem I observe](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Tests/Cursors/AsyncCursorTests.cs#L499) is that an object is finalized (and GCed if I comment the finalizer away) when there are strong references to it from within async task that is being awaited later. [Here](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Tests/Cursors/AsyncCursorTests.cs#L512) and [here](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Tests/Cursors/AsyncCursorTests.cs#L514) there are references that cause side effects (
","Finalizer is called on live object [This test](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Tests/Cursors/AsyncCursorTests.cs#L452-L530) fails not always but reliably when [run multiple times in a loop](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Run/Program.cs#L10-L17).

The [problem I observe](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Tests/Cursors/AsyncCursorTests.cs#L499) is that an object is finalized (and GCed if I comment the finalizer away) when there are strong references to it from within async task that is being awaited later. [Here](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Tests/Cursors/AsyncCursorTests.cs#L512) and [here](https://github.com/Spreads/Spreads/blob/d5a9239cbea0df292c14abaac783ecd63efed9d7/tests/Spreads.Core.Tests/Cursors/AsyncCursorTests.cs#L514) there are references that cause side effects (
",area-GC,AaronRobinsonMSFT,27/07/2018 21:35,4/08/2018 0:39
19159,Temporary path being defined as C:\Windows.,"Oddly today while working me and a co-worker experienced a strange encounter where our lockfile was attempting to be created in C:\Windows while running the application as the current logged on user.

We expected this to be a problem with my environment variables however they appear to be set properly.

![image](https://user-images.githubusercontent.com/33913289/43299462-537f9544-9128-11e8-89e6-a534ccea902a.png)


This is the logs from our ASP.NET Core Application.

---

Environment Information:
Windows 10 (10.0.17134 Build 17134)
Dotnet Core/ASP Version: 2.1.2

---

If there's any more information @Wintereise or I can provide we would be glad to help out in solving this issue.","Temporary path being defined as C:\Windows. Oddly today while working me and a co-worker experienced a strange encounter where our lockfile was attempting to be created in C:\Windows while running the application as the current logged on user.

We expected this to be a problem with my environment variables however they appear to be set properly.

![image](https://user-images.githubusercontent.com/33913289/43299462-537f9544-9128-11e8-89e6-a534ccea902a.png)


This is the logs from our ASP.NET Core Application.

---

Environment Information:
Windows 10 (10.0.17134 Build 17134)
Dotnet Core/ASP Version: 2.1.2

---

If there's any more information @Wintereise or I can provide we would be glad to help out in solving this issue.",os-windows,AaronRobinsonMSFT,27/07/2018 13:12,27/07/2018 14:29
19157,Add support for writing EventPipeEvents to ProfAPI,"This augments the EventPipe framework to send data to the Profiler APIs in addition to any other receivers that may be configured.

This change does not add or remove any requirement on how the eventing system is initialized. Although it does provide a provision to the Profiler APIs that despite whatever the eventing system may be initialized to it can eject itself when it needs to.","Add support for writing EventPipeEvents to ProfAPI This augments the EventPipe framework to send data to the Profiler APIs in addition to any other receivers that may be configured.

This change does not add or remove any requirement on how the eventing system is initialized. Although it does provide a provision to the Profiler APIs that despite whatever the eventing system may be initialized to it can eject itself when it needs to.",area-Diagnostics,brianrob,27/07/2018 10:39,6/11/2019 5:26
19152,Enable Tiered Compilation by default,"1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.","Enable Tiered Compilation by default 1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.",* NO MERGE *,kouvel,,
19150,Enable Tiered Compilation by default,"1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.","Enable Tiered Compilation by default 1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.",* NO MERGE *,kouvel,,
19149,Breaking change in netcoreapp2.1 (possibly JIT bug?) re fixed buffers,"New in netcoreapp2.1 (doesn't impact netcoreapp2.0 or net47)

Full repro below; synopsis: fixed buffers go pretty wild when used on a field in a key in a  for both; the first item doesn't have data corruption (but fails anyway) - the second item (longer hits 2 elements) has become corrupted.","Breaking change in netcoreapp2.1 (possibly JIT bug?) re fixed buffers New in netcoreapp2.1 (doesn't impact netcoreapp2.0 or net47)

Full repro below; synopsis: fixed buffers go pretty wild when used on a field in a key in a  for both; the first item doesn't have data corruption (but fails anyway) - the second item (longer hits 2 elements) has become corrupted.",area-CodeGen,AndyAyersMS,,
19148,COM object lifetime is subject to Windows rundown policy (6 minute idle),"Call CoMarshalInterface with MSHLFLAGS_TABLESTRONG (as opposed to MSHLFLAGS_NORMAL) to avoid COM rundown timeouts.

https://github.com/dotnet/coreclr/blob/8e48db2c113052ef18cdafb43e114a8633864ec0/src/vm/comcache.cpp#L178

The lifetime issue tends to hit very large applications.  Viable workarounds are: 1) use the COM objects regularly or 2) avoid the .NET COM cache and get the raw IntPtr then call GetUniqueObjectForIUnknown.","COM object lifetime is subject to Windows rundown policy (6 minute idle) Call CoMarshalInterface with MSHLFLAGS_TABLESTRONG (as opposed to MSHLFLAGS_NORMAL) to avoid COM rundown timeouts.

https://github.com/dotnet/coreclr/blob/8e48db2c113052ef18cdafb43e114a8633864ec0/src/vm/comcache.cpp#L178

The lifetime issue tends to hit very large applications.  Viable workarounds are: 1) use the COM objects regularly or 2) avoid the .NET COM cache and get the raw IntPtr then call GetUniqueObjectForIUnknown.",area-Interop,jeffschwMSFT,27/07/2018 7:45,
19147,Cannot find libSystem.dylib,"Our .net core 2.1.201 app uses native interop on Mac and has methods attributed with  some customers report that it fails to find libSystem.dylib or one of its dependencies:
","Cannot find libSystem.dylib Our .net core 2.1.201 app uses native interop on Mac and has methods attributed with  some customers report that it fails to find libSystem.dylib or one of its dependencies:
",area-Interop,AaronRobinsonMSFT,27/07/2018 7:12,26/10/2018 18:08
19140,JIT: assert compiling System.Runtime.Intrinsics.X86.Avx:TestC via PMI,"I made a couple of improvements to the generic expansions in PMI and am now seeing an assert when running PMI on system.private.corelib:


To repro build x64 checked sync to latest jitutils and build then run the above.","JIT: assert compiling System.Runtime.Intrinsics.X86.Avx:TestC via PMI I made a couple of improvements to the generic expansions in PMI and am now seeing an assert when running PMI on system.private.corelib:


To repro build x64 checked sync to latest jitutils and build then run the above.",area-CodeGen,AndyAyersMS,27/07/2018 2:10,27/07/2018 12:07
19139,Unnecessary code in System.Numerics.ConstantHelper ?,"most of the methods in [System.Private.CoreLib/shared/System/Numerics/ConstantHelper.cs](https://github.com/dotnet/coreclr/blob/1456a38ed9ee3eda8022b9f162a45334723a0d7a/src/System.Private.CoreLib/shared/System/Numerics/ConstantHelper.cs#L12) are using unsafe/unchecked blocks unnecessarly
shouldn't a simple method like 
","Unnecessary code in System.Numerics.ConstantHelper ? most of the methods in [System.Private.CoreLib/shared/System/Numerics/ConstantHelper.cs](https://github.com/dotnet/coreclr/blob/1456a38ed9ee3eda8022b9f162a45334723a0d7a/src/System.Private.CoreLib/shared/System/Numerics/ConstantHelper.cs#L12) are using unsafe/unchecked blocks unnecessarly
shouldn't a simple method like 
",area-Meta-corelib,RussKeldorph,27/07/2018 0:56,
19138,Build failure: error CS1503: Argument 1: cannot convert from 'System.Runtime.Intrinsics.Vector256<sbyte>' to 'System.Runtime.Intrinsics.Vector256<byte>',"Opened on behalf of @RussKeldorph

Warnings: 1
Status Message: failed

Build : 2.1 - 20180726.01 (Product Build)
Failing configurations:
- Alpine3.6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat 7
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- OSX
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
  - Build-Tests-R2R-Release
  - Build-Tests-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/21/source/prodcon~2Fcoreclr~2Frelease~2F2.1~2F/type/build~2Fproduct~2F/build/20180726.01/workItem/Orchestration/analysis/external/Link)
","Build failure: error CS1503: Argument 1: cannot convert from 'System.Runtime.Intrinsics.Vector256<sbyte>' to 'System.Runtime.Intrinsics.Vector256<byte>' Opened on behalf of @RussKeldorph

Warnings: 1
Status Message: failed

Build : 2.1 - 20180726.01 (Product Build)
Failing configurations:
- Alpine3.6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat 7
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- OSX
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
  - Build-Tests-R2R-Release
  - Build-Tests-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/21/source/prodcon~2Fcoreclr~2Frelease~2F2.1~2F/type/build~2Fproduct~2F/build/20180726.01/workItem/Orchestration/analysis/external/Link)
",area-CodeGen,RussKeldorph,27/07/2018 0:52,10/08/2018 6:37
19135,[automated] Merge branch 'release/2.1' => 'release/2.2',"I detected changes in the release/2.1 branch which have not been merged yet to release/2.2.
I'm a robot and am configured to help you automatically keep release/2.2 up to date so
I've opened this PR.

This PR merges commits made on release/2.1 by the following committers:

* @weshaggard
* @dotnet-maestro-bot

## Instructions for merging

This PR will not be auto-merged. When pull request checks pass please complete this PR
by creating a merge commit *not* a squash or rebase commit.

<img alt=""merge button instructions"" src=""https://i.imgur.com/GepcNJV.png"" width=""300"" />

You can also do this on command line:


:warning: If there are merge conflicts you will need to resolve them manually before merging.

Please contact ASP.NET Core Engineering if you have questions or issues.
Also if this PR was generated incorrectly help us fix it. See https://github.com/aspnet/BuildTools/blob/master/scripts/GitHubMergeBranches.ps1.","[automated] Merge branch 'release/2.1' => 'release/2.2' I detected changes in the release/2.1 branch which have not been merged yet to release/2.2.
I'm a robot and am configured to help you automatically keep release/2.2 up to date so
I've opened this PR.

This PR merges commits made on release/2.1 by the following committers:

* @weshaggard
* @dotnet-maestro-bot

## Instructions for merging

This PR will not be auto-merged. When pull request checks pass please complete this PR
by creating a merge commit *not* a squash or rebase commit.

<img alt=""merge button instructions"" src=""https://i.imgur.com/GepcNJV.png"" width=""300"" />

You can also do this on command line:


:warning: If there are merge conflicts you will need to resolve them manually before merging.

Please contact ASP.NET Core Engineering if you have questions or issues.
Also if this PR was generated incorrectly help us fix it. See https://github.com/aspnet/BuildTools/blob/master/scripts/GitHubMergeBranches.ps1.",,wtgodbe,,
19134,Enable optimizations for interoputil.cpp@SafeRelease,"https://github.com/dotnet/coreclr/blob/master/src/vm/interoputil.cpp#L1510

Optimizations were disabled years ago due to a likely now fixed native toolset bug.","Enable optimizations for interoputil.cpp@SafeRelease https://github.com/dotnet/coreclr/blob/master/src/vm/interoputil.cpp#L1510

Optimizations were disabled years ago due to a likely now fixed native toolset bug.",area-Interop,AaronRobinsonMSFT,,
19133,Tiered Compilation: Need an ETW event that explicitly indicates tiering is enabled or disabled,"Right now PerfView assumes that the lack of a jit compilation tier1 event means tiering was disabled but this is error prone in at least two situations:
a) Short running apps may never have time to tier any methods but the feature was enabled
b) Apps that generate large amounts of ETW events may drop events or exhaust the circular buffer causing all tier1 jit events to be lost (this is exacerbated by PerfView's misleading UI that shows you have enough buffer even when events are being dropped)","Tiered Compilation: Need an ETW event that explicitly indicates tiering is enabled or disabled Right now PerfView assumes that the lack of a jit compilation tier1 event means tiering was disabled but this is error prone in at least two situations:
a) Short running apps may never have time to tier any methods but the feature was enabled
b) Apps that generate large amounts of ETW events may drop events or exhaust the circular buffer causing all tier1 jit events to be lost (this is exacerbated by PerfView's misleading UI that shows you have enough buffer even when events are being dropped)",area-TieredCompilation,kouvel,,
19132,Incorrect Optimization setting for tests,"The naming convention is that 

(related: https://github.com/dotnet/coreclr/pull/19083)","Incorrect Optimization setting for tests The naming convention is that 

(related: https://github.com/dotnet/coreclr/pull/19083)",,4creators,,
19131,Incorrect naming for JIT\HardwareIntrinsics\X86\Sse2 test projects,"The naming of the following doesn't follow the correct naming scheme:

","Incorrect naming for JIT\HardwareIntrinsics\X86\Sse2 test projects The naming of the following doesn't follow the correct naming scheme:

",,4creators,,
19129,[RyuJIT] lack of escape analysis makes redundant memory-access of Vector128/256<T> fields,"Related to https://github.com/dotnet/coreclr/issues/19116

The C# source code below is from https://github.com/dotnet/coreclr/pull/18839


category:cq
theme:optimization
skill-level:expert
cost:large","[RyuJIT] lack of escape analysis makes redundant memory-access of Vector128/256<T> fields Related to https://github.com/dotnet/coreclr/issues/19116

The C# source code below is from https://github.com/dotnet/coreclr/pull/18839


category:cq
theme:optimization
skill-level:expert
cost:large",area-CodeGen,CarolEidt,26/07/2018 6:18,
19128,reenable corefx System.Runtime.Tests  on arm32,the issue #17585 was fixed long time ago but this exclusion was forgotten.,reenable corefx System.Runtime.Tests  on arm32 the issue #17585 was fixed long time ago but this exclusion was forgotten.,disabled-test,sandreenko,26/07/2018 5:24,27/07/2018 8:46
19127,JIT: gcstress failure in BMI1 test x64 minopts,"Suspect this is likely a test bug as the test is new....

To repro: build x64 checked build tests\src\jit\HardwareIntrinsics\X86\bmi1\Bmi1_r.csproj


cc @dotnet/jit-contrib @tannergooding ","JIT: gcstress failure in BMI1 test x64 minopts Suspect this is likely a test bug as the test is new....

To repro: build x64 checked build tests\src\jit\HardwareIntrinsics\X86\bmi1\Bmi1_r.csproj


cc @dotnet/jit-contrib @tannergooding ",GCStress,tannergooding,,
19124,JIT: SysV minopts simd assert in fgMorphMultiregStructArg,"To repro on windows: build x64 checked build the jit\SIMD\VectorExp_ro test.


Assert is that morph sees an unexpected GT_COMMA.

You can also repro via PMI if you pick up dotnet/jitutils#159.

cc @dotnet/jit-contrib ","JIT: SysV minopts simd assert in fgMorphMultiregStructArg To repro on windows: build x64 checked build the jit\SIMD\VectorExp_ro test.


Assert is that morph sees an unexpected GT_COMMA.

You can also repro via PMI if you pick up dotnet/jitutils#159.

cc @dotnet/jit-contrib ",area-CodeGen,CarolEidt,,
19123,Add CI PR-triggered Ubuntu x64 innerloop no-tiering job,,Add CI PR-triggered Ubuntu x64 innerloop no-tiering job ,area-TieredCompilation,kouvel,,
19122,[WIP] Test new CI jobs for enabling Tiered Compilation by default,For https://github.com/dotnet/coreclr/pull/19121,[WIP] Test new CI jobs for enabling Tiered Compilation by default For https://github.com/dotnet/coreclr/pull/19121,* NO MERGE *,kouvel,,
19121,Enable Tiered Compilation by default,"1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.","Enable Tiered Compilation by default 1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.",* NO MERGE *,kouvel,,
19120,Support .Net Core in RegAsm and TlbExp,"Currently you can create .net core application with COM object:


How can I register COM objects from .net core and then use it in CPP (existing) application?

I was trying publish application with --self-contained. It doesn't work too.","Support .Net Core in RegAsm and TlbExp Currently you can create .net core application with COM object:


How can I register COM objects from .net core and then use it in CPP (existing) application?

I was trying publish application with --self-contained. It doesn't work too.",area-Interop,AaronRobinsonMSFT,,
19119,Where is source code for .NET Native toolchain?,"Hello

I'm trying to find the source code for the .NET Native toolchain.  Is this in some dotnet repo?  Specifically ilc.exe nutc_driver.exe etc.

Thanks so much","Where is source code for .NET Native toolchain? Hello

I'm trying to find the source code for the .NET Native toolchain.  Is this in some dotnet repo?  Specifically ilc.exe nutc_driver.exe etc.

Thanks so much",question,jkotas,25/07/2018 9:40,26/07/2018 19:04
19118,IMetaDataImport::GetFieldProps reporting size of field name wrong,"Working with this API and in this method:


reports as a size of 8.

Any idea why this is?","IMetaDataImport::GetFieldProps reporting size of field name wrong Working with this API and in this method:


reports as a size of 8.

Any idea why this is?",question,AaronRobinsonMSFT,25/07/2018 9:02,26/07/2018 5:05
19116,[RyuJIT] lack of escape analysis makes high GC overhead in SoA SIMD programs,"According to the VTune characterization https://github.com/dotnet/coreclr/pull/18839#issue-200232155 SoA SIMD programs have higher GC overhead than AoS and scalar programs because of temp object allocation.

SoA SIMD programs use  that will generate so much memory copies and get worse performance.


category:cq
theme:optimization
skill-level:expert
cost:large","[RyuJIT] lack of escape analysis makes high GC overhead in SoA SIMD programs According to the VTune characterization https://github.com/dotnet/coreclr/pull/18839#issue-200232155 SoA SIMD programs have higher GC overhead than AoS and scalar programs because of temp object allocation.

SoA SIMD programs use  that will generate so much memory copies and get worse performance.


category:cq
theme:optimization
skill-level:expert
cost:large",area-CodeGen,CarolEidt,25/07/2018 6:56,
19114,[WIP] Dummy change PR to dev/unix_test_workflow,,[WIP] Dummy change PR to dev/unix_test_workflow ,* NO MERGE *,dotnet-bot,25/07/2018 6:12,2/08/2018 11:10
19113,[WIP] Dummy change PR to dev/unix_test_workflow,,[WIP] Dummy change PR to dev/unix_test_workflow ,* NO MERGE *,BruceForstall,25/07/2018 4:38,25/07/2018 6:13
19112,Lightweight and dynamic driving of P/Invoke,"While Mono has 


","Lightweight and dynamic driving of P/Invoke While Mono has 


",area-Interop,jkotas,25/07/2018 0:22,
19108,CoreCLR failed to run test in VS2017 Update 7,"CoreCLR failed to run test on Windows with VS2017 Update7. Could you please help take a look at this? Thank you!

**You can repro this issue as the steps below:**
1. git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2. Open a clean x86 prompt (C:\windows\syswow64\cmd.exe) and browse to D:\CoreCLR\src
3. build x86 release -Rebuild -- /clp:ShowCommandLine
4. build-test.cmd x86 release -- /clp:ShowCommandLine
5. tests\runtest.cmd x86 release

**Error info:**
The whole log file please see attachment.
[log_x86_test.log](https://github.com/dotnet/coreclr/files/2223051/log_x86_test.log)
","CoreCLR failed to run test in VS2017 Update 7 CoreCLR failed to run test on Windows with VS2017 Update7. Could you please help take a look at this? Thank you!

**You can repro this issue as the steps below:**
1. git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2. Open a clean x86 prompt (C:\windows\syswow64\cmd.exe) and browse to D:\CoreCLR\src
3. build x86 release -Rebuild -- /clp:ShowCommandLine
4. build-test.cmd x86 release -- /clp:ShowCommandLine
5. tests\runtest.cmd x86 release

**Error info:**
The whole log file please see attachment.
[log_x86_test.log](https://github.com/dotnet/coreclr/files/2223051/log_x86_test.log)
",area-Infrastructure-coreclr,sandreenko,,
19107,Add Interop/PInvoke/Attributes tests,,Add Interop/PInvoke/Attributes tests ,area-Interop,jkoritzinsky,,
19093,Leaked ICorProfilerCallback9 in vm/eetoprofinterfaceimpl.cpp,"Hi guys!

Looks like we forgot to Release  in [EEToProfInterfaceImpl::~EEToProfInterfaceImpl()](https://github.com/dotnet/coreclr/blob/67a66156d0307b49522a13618522d289268bc1f9/src/vm/eetoprofinterfaceimpl.cpp#L964). Can anyone check and fix it? 

cc: @mjsabby 

P.S. I can prepare a pull request for this issue.","Leaked ICorProfilerCallback9 in vm/eetoprofinterfaceimpl.cpp Hi guys!

Looks like we forgot to Release  in [EEToProfInterfaceImpl::~EEToProfInterfaceImpl()](https://github.com/dotnet/coreclr/blob/67a66156d0307b49522a13618522d289268bc1f9/src/vm/eetoprofinterfaceimpl.cpp#L964). Can anyone check and fix it? 

cc: @mjsabby 

P.S. I can prepare a pull request for this issue.",area-Diagnostics,mjsabby,24/07/2018 5:15,25/07/2018 2:49
19091,[ARM32] Split CodeGen::instGen_Set_Reg_To_Imm into relocatable immediate/non-relocatable immediate cases,"As suggested in https://github.com/dotnet/coreclr/pull/19013#discussion_r204171338 the next step complement to #19013 should be splitting ). 

@BruceForstall Please feel free to add if I missed anything

category:implementation
theme:emitter
skill-level:beginner
cost:small","[ARM32] Split CodeGen::instGen_Set_Reg_To_Imm into relocatable immediate/non-relocatable immediate cases As suggested in https://github.com/dotnet/coreclr/pull/19013#discussion_r204171338 the next step complement to #19013 should be splitting ). 

@BruceForstall Please feel free to add if I missed anything

category:implementation
theme:emitter
skill-level:beginner
cost:small",arch-arm32,BruceForstall,24/07/2018 4:06,
19090,Properly document memory semantics for marshalling x-plat,"One of the base assumptions on Windows was that  were the canonical memory management mechanism when performing an interop. These function do not exist on x-plat scenarios so we need some explicit documentation or example where this is demonstrated.

See https://github.com/dotnet/coreclr/issues/19082","Properly document memory semantics for marshalling x-plat One of the base assumptions on Windows was that  were the canonical memory management mechanism when performing an interop. These function do not exist on x-plat scenarios so we need some explicit documentation or example where this is demonstrated.

See https://github.com/dotnet/coreclr/issues/19082",area-Interop,AaronRobinsonMSFT,24/07/2018 4:00,24/07/2018 7:25
19089,Support R2RDump on non-Windows and ARM machines,Right now R2RDump is only supported on Windows x64 and x86. It works on Linux but the R2RDumpTests for that OS are disabled because of errors. It hasn't been tested on OSX or ARM.,Support R2RDump on non-Windows and ARM machines Right now R2RDump is only supported on Windows x64 and x86. It works on Linux but the R2RDumpTests for that OS are disabled because of errors. It hasn't been tested on OSX or ARM.,area-R2RDump,nattress,24/07/2018 3:39,
19088,Reduce time in .NET Threadpool's WorkStealingQueue.TrySteal method and ThredPoolWorkQueue.Dequeue methods.  ,"A number of different users have noted a large amount of time in the .NET ThreadPool WorkStealingQueue.TrySteal method (Being called from [ThredPoolWorkQueue.Dequeue](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/src/System/Threading/ThreadPool.cs#L465)  method).    

From what we can tell the scenario that causes is bursty workloads.   For bursty workloads our guidance is to set a MinWorkerThreads high enough so that there are threads available to handle the burst.   For high scale machines (e.g. 16 Proc) it is not uncommon then to set this minimum in the 160-320 thread range.   

When a burst  (lets say it needs 100 threads to do the work) then those 100 threads do the work then calle Dequeue to get the next work.   However the burst is over and thus they all don't find any work left and go through a loop lin the [ThredPoolWorkQueue.Dequeue](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/src/System/Threading/ThreadPool.cs#L465)  method to find work to steal from other threads.  (which will fail).

Thus you have 100 threads spinning through 160-320 worker threads looking for more work thus requring 16K to 32K checks.   These threads 'fight' over the memory to check that the queues are empty and thus even though the check is short it consumes a non-trivial amount of CPU time.    If these bursts come frequently (e.g. every 10-100 msec) then the CPU adds up.   

Here is where we see the CPU time spent (This is on Desktop framework but the code is very similar  for .NET core).  Here is the code in Dequeue. 


In .NET Core the code is a bit different because we have created a helper called 'CanSteal' that does m_headIndex >= m_tailIndex and we call this helper in Dequeue before calling TrySteal.  This helps cut the cost per iteration but does not mitigate the fact that we are doing an O(n) operation and we have to 'fight' over the memory representing m_headIndex and m_tailIndex variables)   Thus on .NET Core the problem will not show up in TrySteal and should be less severe but probably still problematic.  

To really fix the problem we need to be less aggressive about checking for stealing.   Ideally want to do some checking but we want to be much less aggressive if we know that other threads will shortly come along and do a more aggressive check.   This avoids O(N) behavior which is the fundamental problem.  

The solutions probably looks like only looking for work to steal for a subset unless we have been asked to be 'aggressive'.   We are aggressive only after a certain amount of time. 

@kouvel @stephentoub 
","Reduce time in .NET Threadpool's WorkStealingQueue.TrySteal method and ThredPoolWorkQueue.Dequeue methods.   A number of different users have noted a large amount of time in the .NET ThreadPool WorkStealingQueue.TrySteal method (Being called from [ThredPoolWorkQueue.Dequeue](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/src/System/Threading/ThreadPool.cs#L465)  method).    

From what we can tell the scenario that causes is bursty workloads.   For bursty workloads our guidance is to set a MinWorkerThreads high enough so that there are threads available to handle the burst.   For high scale machines (e.g. 16 Proc) it is not uncommon then to set this minimum in the 160-320 thread range.   

When a burst  (lets say it needs 100 threads to do the work) then those 100 threads do the work then calle Dequeue to get the next work.   However the burst is over and thus they all don't find any work left and go through a loop lin the [ThredPoolWorkQueue.Dequeue](https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/src/System/Threading/ThreadPool.cs#L465)  method to find work to steal from other threads.  (which will fail).

Thus you have 100 threads spinning through 160-320 worker threads looking for more work thus requring 16K to 32K checks.   These threads 'fight' over the memory to check that the queues are empty and thus even though the check is short it consumes a non-trivial amount of CPU time.    If these bursts come frequently (e.g. every 10-100 msec) then the CPU adds up.   

Here is where we see the CPU time spent (This is on Desktop framework but the code is very similar  for .NET core).  Here is the code in Dequeue. 


In .NET Core the code is a bit different because we have created a helper called 'CanSteal' that does m_headIndex >= m_tailIndex and we call this helper in Dequeue before calling TrySteal.  This helps cut the cost per iteration but does not mitigate the fact that we are doing an O(n) operation and we have to 'fight' over the memory representing m_headIndex and m_tailIndex variables)   Thus on .NET Core the problem will not show up in TrySteal and should be less severe but probably still problematic.  

To really fix the problem we need to be less aggressive about checking for stealing.   Ideally want to do some checking but we want to be much less aggressive if we know that other threads will shortly come along and do a more aggressive check.   This avoids O(N) behavior which is the fundamental problem.  

The solutions probably looks like only looking for work to steal for a subset unless we have been asked to be 'aggressive'.   We are aggressive only after a certain amount of time. 

@kouvel @stephentoub 
",area-System.Threading,kouvel,24/07/2018 2:56,
19086,[Ubuntu/arm][GCStress=0xC][ZapDisable] Regressions/coreclr/GitHub_12224/Test12224,"This failed twice while testing PR #18784 in 
[Ubuntu arm Cross Checked gcstress0xc_zapdisable Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_zapdisable_tst_prtest/5/consoleText)
[Ubuntu arm Cross Checked gcstress0xc_zapdisable_heapverify1 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_zapdisable_heapverify1_tst_prtest/4/consoleText)


**Note:** when the issue is resolved remove the corresponding line in tests/testsFailing.arm.txt (https://github.com/dotnet/coreclr/pull/19087)","[Ubuntu/arm][GCStress=0xC][ZapDisable] Regressions/coreclr/GitHub_12224/Test12224 This failed twice while testing PR #18784 in 
[Ubuntu arm Cross Checked gcstress0xc_zapdisable Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_zapdisable_tst_prtest/5/consoleText)
[Ubuntu arm Cross Checked gcstress0xc_zapdisable_heapverify1 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_zapdisable_heapverify1_tst_prtest/4/consoleText)


**Note:** when the issue is resolved remove the corresponding line in tests/testsFailing.arm.txt (https://github.com/dotnet/coreclr/pull/19087)",GCStress,AndyAyersMS,,
19085,[Ubuntu/arm][GCStress=0xC][JitStress] GC/API/WeakReference/Finalize2,"This has failed three times while testing PR #18784 in

[Ubuntu arm Cross Checked gcstress0xc_jitstress1 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_jitstress1_tst_prtest/8/consoleText)
[Ubuntu arm Cross Checked gcstress0xc_jitstress2 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_jitstress2_tst_prtest/9/consoleText)


**Note:** when the issue is resolved remove the corresponding line in tests/testsFailing.arm.txt (https://github.com/dotnet/coreclr/pull/19087)","[Ubuntu/arm][GCStress=0xC][JitStress] GC/API/WeakReference/Finalize2 This has failed three times while testing PR #18784 in

[Ubuntu arm Cross Checked gcstress0xc_jitstress1 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_jitstress1_tst_prtest/8/consoleText)
[Ubuntu arm Cross Checked gcstress0xc_jitstress2 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_jitstress2_tst_prtest/9/consoleText)


**Note:** when the issue is resolved remove the corresponding line in tests/testsFailing.arm.txt (https://github.com/dotnet/coreclr/pull/19087)",GCStress,AndyAyersMS,,
19084,Build failure: ARM64 build of Interop\COM\NativeServer\COMNativeServer,"Opened on behalf of @RussKeldorph

Warnings: 1
Status Message: failed

Build : Master - 20180723.04 (Product Build)
Failing configurations:
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180723.04/workItem/Orchestration/analysis/external/Link)
","Build failure: ARM64 build of Interop\COM\NativeServer\COMNativeServer Opened on behalf of @RussKeldorph

Warnings: 1
Status Message: failed

Build : Master - 20180723.04 (Product Build)
Failing configurations:
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180723.04/workItem/Orchestration/analysis/external/Link)
",area-Interop,AaronRobinsonMSFT,,
19082,Cross platform PInvoke - returning strings to .NET core 2.0,"I need to have my C++ dll return a string to .NET core 2.0 wrapper.   I want .NET to free up string when appropriate and not have to make explicit call back to C++ to deallocate string.  I've been able to do this successfully if I use CoTaskMemAlloc() (in Windows) to allocate the memory for string on C++ side but CoTaskMemAlloc is not supported in Linux.  Windows C++ solution with CoTaskMemAlloc:

**[.NET code]**
        [DllImport(EngineDllFullPath CallingConvention = CallingConvention.Cdecl)]
        [return: MarshalAs(UnmanagedType.LPStr)]
        public static extern string getText();

        public static string GetValue()
        {
            string s = getText();  // No need to free; .NET will take care of it
            return s;
        }

**[Unmanaged C++ code]**
       char* getText()
       {
          ...
          char* s = (char*)::CoTaskMemAlloc(size);
          ...
          return s;
       }


Is there a cross platform solution to this that doesn't use CoTaskMemAlloc that can compile/run on windows and linux?

Thanks","Cross platform PInvoke - returning strings to .NET core 2.0 I need to have my C++ dll return a string to .NET core 2.0 wrapper.   I want .NET to free up string when appropriate and not have to make explicit call back to C++ to deallocate string.  I've been able to do this successfully if I use CoTaskMemAlloc() (in Windows) to allocate the memory for string on C++ side but CoTaskMemAlloc is not supported in Linux.  Windows C++ solution with CoTaskMemAlloc:

**[.NET code]**
        [DllImport(EngineDllFullPath CallingConvention = CallingConvention.Cdecl)]
        [return: MarshalAs(UnmanagedType.LPStr)]
        public static extern string getText();

        public static string GetValue()
        {
            string s = getText();  // No need to free; .NET will take care of it
            return s;
        }

**[Unmanaged C++ code]**
       char* getText()
       {
          ...
          char* s = (char*)::CoTaskMemAlloc(size);
          ...
          return s;
       }


Is there a cross platform solution to this that doesn't use CoTaskMemAlloc that can compile/run on windows and linux?

Thanks",area-Interop,jkotas,23/07/2018 21:23,24/07/2018 4:02
19081,[x86/Windows] Assertion failed 'shiftNode->OperIsShiftOrRotate()' in lrsabuild.cpp L782 introduced by PR #18941,"x86 Windows JitStress=2 JitStressRegs=3 Assertion failed 'shiftNode->OperIsShiftOrRotate()' in lrsabuild.cpp L782 - 177 failures for outer loop tests 64 failures for inner loop tests when run with JitStress=2 JitStressRegs=3.

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_jitstress2_jitstressregs3/556/

Failing tests:



Output dump:

[GitHub-18941-test-output.txt](https://github.com/dotnet/coreclr/files/2219026/GitHub-18941-test-output.txt)

cc @CarolEidt @tannergooding @fiigii ","[x86/Windows] Assertion failed 'shiftNode->OperIsShiftOrRotate()' in lrsabuild.cpp L782 introduced by PR #18941 x86 Windows JitStress=2 JitStressRegs=3 Assertion failed 'shiftNode->OperIsShiftOrRotate()' in lrsabuild.cpp L782 - 177 failures for outer loop tests 64 failures for inner loop tests when run with JitStress=2 JitStressRegs=3.

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_jitstress2_jitstressregs3/556/

Failing tests:



Output dump:

[GitHub-18941-test-output.txt](https://github.com/dotnet/coreclr/files/2219026/GitHub-18941-test-output.txt)

cc @CarolEidt @tannergooding @fiigii ",area-CodeGen,CarolEidt,,
19079,Remove hosthook api,cc @luqunl @jkotas ,Remove hosthook api cc @luqunl @jkotas ,area-Interop,luqunl,23/07/2018 14:50,23/07/2018 20:30
19078,JIT: multiply & add not optimized to LEA when destination is a different register," isn't getting used in the scenario where it could also cut out an additional instruction.

category:cq
theme:optimization
skill-level:beginner
cost:small","JIT: multiply & add not optimized to LEA when destination is a different register  isn't getting used in the scenario where it could also cut out an additional instruction.

category:cq
theme:optimization
skill-level:beginner
cost:small",area-CodeGen,AaronRobinsonMSFT,23/07/2018 13:48,
19076,JIT: Stack zeroed with rep stosd,"C# source in this gist: https://gist.github.com/Zhentar/4ffb0a5d597c4c1e788d6007f1602b21

According to vTune 5% of my execution time is in my function's prologue. This was unexpected because it hadn't been in previous iterations (and my function body had unfortunately not improved at all).
Looking at the the disassembly I see:
 shouldn't ever be getting emitted.

category:cq
theme:optimization
skill-level:intermediate
cost:medium","JIT: Stack zeroed with rep stosd C# source in this gist: https://gist.github.com/Zhentar/4ffb0a5d597c4c1e788d6007f1602b21

According to vTune 5% of my execution time is in my function's prologue. This was unexpected because it hadn't been in previous iterations (and my function body had unfortunately not improved at all).
Looking at the the disassembly I see:
 shouldn't ever be getting emitted.

category:cq
theme:optimization
skill-level:intermediate
cost:medium",area-CodeGen,erozenfeld,22/07/2018 15:05,
19075,Pri-1 tests broken as of #18695,"All pri-1 JitStress jobs started failing after https://github.com/dotnet/coreclr/pull/18695 was merged.

I have validated locally that reverting f5f9a3456abcfdea5d886fededaa0265c80281ed fixes the issue.","Pri-1 tests broken as of #18695 All pri-1 JitStress jobs started failing after https://github.com/dotnet/coreclr/pull/18695 was merged.

I have validated locally that reverting f5f9a3456abcfdea5d886fededaa0265c80281ed fixes the issue.",,sbomer,,
19074,JIT can generate redundant TEST operations,"The following C# code generates assembly which has what I understand to be a redundant 

category:cq
theme:optimization
skill-level:beginner
cost:small","JIT can generate redundant TEST operations The following C# code generates assembly which has what I understand to be a redundant 

category:cq
theme:optimization
skill-level:beginner
cost:small",area-CodeGen,AaronRobinsonMSFT,22/07/2018 4:40,
19071,HW Intrinsics: Add BSR BSF and BSWAP intrinsics,"BSR & BSF are functionally equivalent to LZCNT & TZCNT for non-zero values - except that instead of needing Haswell/Piledriver plus the minimum requirement is 80386. Would be nice for things like Span<byte>.IndexOf where it's only applied to non-zero values.

BSWAP is an 80486 instruction that reverses the order of bytes. It's supposed to be good for endian-ness conversions but I care because word on the street is that it's better than rotates for entropy diffusion in hash functions leading to some of the trendy new fast hash functions (such as FarmHash and t1ha) using it.

category:proposal
theme:intrinsics
skill-level:intermediate
cost:medium","HW Intrinsics: Add BSR, BSF, and BSWAP intrinsics BSR & BSF are functionally equivalent to LZCNT & TZCNT for non-zero values - except that instead of needing Haswell/Piledriver plus the minimum requirement is 80386. Would be nice for things like Span<byte>.IndexOf where it's only applied to non-zero values.

BSWAP is an 80486 instruction that reverses the order of bytes. It's supposed to be good for endian-ness conversions but I care because word on the street is that it's better than rotates for entropy diffusion in hash functions leading to some of the trendy new fast hash functions (such as FarmHash and t1ha) using it.

category:proposal
theme:intrinsics
skill-level:intermediate
cost:medium",area-CodeGen,AaronRobinsonMSFT,21/07/2018 13:19,
19070,Fix mscordbi metadata reader alignment bug on Linux.,"Works fine on Windows minidumps but on Linux (via OpenVirtualProcess
for production breakpoints and future core dumps) the compiler's struct
alignment rules are different. On Windows classes/structs are aligned
based on the largest field. On Linux they are 4 byte aligned regardless
of the field sizes.

https://github.com/dotnet/coreclr/issues/17692","Fix mscordbi metadata reader alignment bug on Linux. Works fine on Windows minidumps but on Linux (via OpenVirtualProcess
for production breakpoints and future core dumps) the compiler's struct
alignment rules are different. On Windows classes/structs are aligned
based on the largest field. On Linux they are 4 byte aligned regardless
of the field sizes.

https://github.com/dotnet/coreclr/issues/17692",area-Diagnostics,mikem8361,,
19069,Prep for ported PInvoke tests from .NET Framework,"Add root MSBuild targets for Interop managed test assets
Add root CMake file for Interop native test assets","Prep for ported PInvoke tests from .NET Framework Add root MSBuild targets for Interop managed test assets
Add root CMake file for Interop native test assets",area-Interop,AaronRobinsonMSFT,21/07/2018 8:49,24/07/2018 11:40
19063,Update documentation for testing,,Update documentation for testing ,documentation,AaronRobinsonMSFT,21/07/2018 4:43,21/07/2018 8:27
19061,JIT: review costing logic in gtIsLikelyRegVar and gtSetEvalOrder,"There are a number of things here that seem questionable or holdovers from when floating point used x87.

Floats can be enregistered now:

https://github.com/dotnet/coreclr/blob/b896dd14830b600043a99c2626ea848ad679fb4f/src/jit/gentree.cpp#L2991-L2996

We don't use these instructions for float literals anymore:

https://github.com/dotnet/coreclr/blob/b896dd14830b600043a99c2626ea848ad679fb4f/src/jit/gentree.cpp#L3238-L3253

Why would enregistered variables incur sign or zero extend costs?

https://github.com/dotnet/coreclr/blob/b896dd14830b600043a99c2626ea848ad679fb4f/src/jit/gentree.cpp#L3257-L3266

Extra size cost (if legit; probably is but we should verify) should also apply to x86:

https://github.com/dotnet/coreclr/blob/b896dd14830b600043a99c2626ea848ad679fb4f/src/jit/gentree.cpp#L3279-L3289

There is probably more.

category:implementation
theme:ir
skill-level:beginner
cost:small","JIT: review costing logic in gtIsLikelyRegVar and gtSetEvalOrder There are a number of things here that seem questionable or holdovers from when floating point used x87.

Floats can be enregistered now:

https://github.com/dotnet/coreclr/blob/b896dd14830b600043a99c2626ea848ad679fb4f/src/jit/gentree.cpp#L2991-L2996

We don't use these instructions for float literals anymore:

https://github.com/dotnet/coreclr/blob/b896dd14830b600043a99c2626ea848ad679fb4f/src/jit/gentree.cpp#L3238-L3253

Why would enregistered variables incur sign or zero extend costs?

https://github.com/dotnet/coreclr/blob/b896dd14830b600043a99c2626ea848ad679fb4f/src/jit/gentree.cpp#L3257-L3266

Extra size cost (if legit; probably is but we should verify) should also apply to x86:

https://github.com/dotnet/coreclr/blob/b896dd14830b600043a99c2626ea848ad679fb4f/src/jit/gentree.cpp#L3279-L3289

There is probably more.

category:implementation
theme:ir
skill-level:beginner
cost:small",area-CodeGen,AndyAyersMS,21/07/2018 3:38,
19060,.NET Core applications get oom killed on Kubernetes/OpenShift,"We have been investigating why .net core applications are killed by OpenShift because they exceed their assigned memory.

OpenShift/Kubernetes informs the app via the sysfs  to measure the memory load of the system.

CC @janvorli ",".NET Core applications get oom killed on Kubernetes/OpenShift We have been investigating why .net core applications are killed by OpenShift because they exceed their assigned memory.

OpenShift/Kubernetes informs the app via the sysfs  to measure the memory load of the system.

CC @janvorli ",area-GC,tmds,,
19056,.Net Core and IoThread,In the [document](https://github.com/dotnet/coreclr/blob/master/Documentation/project-docs/clr-configuration-knobs.md)  I not found any about IoThread message .NET Core has no IoThread?,.Net Core and IoThread In the [document](https://github.com/dotnet/coreclr/blob/master/Documentation/project-docs/clr-configuration-knobs.md)  I not found any about IoThread message .NET Core has no IoThread?,question,jkotas,20/07/2018 19:39,21/07/2018 16:12
19054,Allow rejit on attach,,Allow rejit on attach ,area-Diagnostics,davmason,,
19053,Set function size to -1 if sizing info unavailable,If GCInfo and RVA information is unavailable Size needs to be set to .,Set function size to -1 if sizing info unavailable If GCInfo and RVA information is unavailable Size needs to be set to .,area-R2RDump,jkotas,20/07/2018 15:52,29/08/2018 11:09
19050,DO NOT MERGE to master - dummy change for testing CI,,DO NOT MERGE to master - dummy change for testing CI ,* NO MERGE *,noahfalk,20/07/2018 10:24,6/09/2018 7:36
19048,NETClientPrimitives test fails on Windows.Nano,Remove the global disabling of NETClientPrimitives test done in #19047 by investigating why RegFree COM is failing on Windows.Nano. This is only occurring in helix builds - the test still runs properly in Jenkins CI.,NETClientPrimitives test fails on Windows.Nano Remove the global disabling of NETClientPrimitives test done in #19047 by investigating why RegFree COM is failing on Windows.Nano. This is only occurring in helix builds - the test still runs properly in Jenkins CI.,area-Interop,AaronRobinsonMSFT,20/07/2018 9:22,27/10/2018 9:29
19047,Address issues with COM tests in the helix build.,"Presently COM tests does not appear to run properly on Windows.Nano but
there is no way to special case that OS so disabling them on all builds.

see #19017","Address issues with COM tests in the helix build. Presently COM tests does not appear to run properly on Windows.Nano but
there is no way to special case that OS so disabling them on all builds.

see #19017",area-Interop,AaronRobinsonMSFT,20/07/2018 8:57,20/07/2018 12:42
19042,Disable manual COM registration logic on ARM32,"see #19020

cc @jkotas @BruceForstall ","Disable manual COM registration logic on ARM32 see #19020

cc @jkotas @BruceForstall ",area-Interop,jkotas,20/07/2018 5:18,21/07/2018 6:07
19038,Assembly analysis without reflection,"There is sometimes a need to examine the internals of assemblies for various things like does the assembly contain class X or does it have some attribute Y etc. Using reflection and the various load options is fine for many cases but not all.

For example it's not easy to load an assembly by some tool if the app that uses it uses version overrides in its config file this is because to load the assembly requires its referenced assemblies to also be loaded and this only works under specific circumstances the app can load a different version to the one in the parent manifest because it ""knows about"" the overrides but a tool or utility has no idea about these overrides and may fail to load assembly A1 if the version of a referenced assembly file A2 differs from the version defined in the A1 manifest.

If we just want to open some DLL file and examine it for _certain_ things then it must be possible to do this without using reflection because the file format is well defined (as an [ECMA standard](https://www.ecma-international.org/publications/standards/Ecma-335.htm)).

Does anyone know if anything exists to let me analyze assembly files in some way without relying on reflection loading and so on?
","Assembly analysis without reflection There is sometimes a need to examine the internals of assemblies for various things like does the assembly contain class X or does it have some attribute Y etc. Using reflection and the various load options is fine for many cases but not all.

For example it's not easy to load an assembly by some tool if the app that uses it uses version overrides in its config file this is because to load the assembly requires its referenced assemblies to also be loaded and this only works under specific circumstances the app can load a different version to the one in the parent manifest because it ""knows about"" the overrides but a tool or utility has no idea about these overrides and may fail to load assembly A1 if the version of a referenced assembly file A2 differs from the version defined in the A1 manifest.

If we just want to open some DLL file and examine it for _certain_ things then it must be possible to do this without using reflection because the file format is well defined (as an [ECMA standard](https://www.ecma-international.org/publications/standards/Ecma-335.htm)).

Does anyone know if anything exists to let me analyze assembly files in some way without relying on reflection loading and so on?
",area-System.Reflection,jkotas,20/07/2018 4:47,20/07/2018 6:44
19037,CI: convert all builds to new Helix machines,"After https://github.com/dotnet/coreclr/issues/18048 we will use new Helix-provided machines for building ARM32/ARM64.

Convert the rest of the Jenkins CI build pool to use the same machines so all builds use the same toolset.

Currently they use the ""latest-or-auto"" tag (see netci.groovy ).
","CI: convert all builds to new Helix machines After https://github.com/dotnet/coreclr/issues/18048 we will use new Helix-provided machines for building ARM32/ARM64.

Convert the rest of the Jenkins CI build pool to use the same machines so all builds use the same toolset.

Currently they use the ""latest-or-auto"" tag (see netci.groovy ).
",area-Infrastructure-coreclr,BruceForstall,,
19036,CI: Convert arm32/arm64 build to not require whitelist,"Currently the Windows arm32 and arm64 builds use a ""whitelist"" of allowed users to access a set of private build machines. After the arm64 builds change to use public tools remove the whitelist restriction for the builds. (The whitelist restriction will remain for the Windows arm64 test machines which are also used for Windows arm32 test runs.)

Add build-only arm32/arm64 PR-triggered ""innerloop"" jobs to every PR to protect against arm32/arm64 build failures.

Depends on https://github.com/dotnet/coreclr/issues/18048","CI: Convert arm32/arm64 build to not require whitelist Currently the Windows arm32 and arm64 builds use a ""whitelist"" of allowed users to access a set of private build machines. After the arm64 builds change to use public tools remove the whitelist restriction for the builds. (The whitelist restriction will remain for the Windows arm64 test machines which are also used for Windows arm32 test runs.)

Add build-only arm32/arm64 PR-triggered ""innerloop"" jobs to every PR to protect against arm32/arm64 build failures.

Depends on https://github.com/dotnet/coreclr/issues/18048",area-Infrastructure-coreclr,BruceForstall,,
19034,Arm64: Verify that IP0/IP1 are reserved as needed for jumps,"IP0/IP1 are reserved in the ABI for linking stubs. Any branch with target out of range is free to contaminate these.
The register allocator needs to ensure that either 1) no lclVar is allocated to those registers at block end or 2) they are being reserved (elsewhere) if a branch may be out of range.","Arm64: Verify that IP0/IP1 are reserved as needed for jumps IP0/IP1 are reserved in the ABI for linking stubs. Any branch with target out of range is free to contaminate these.
The register allocator needs to ensure that either 1) no lclVar is allocated to those registers at block end or 2) they are being reserved (elsewhere) if a branch may be out of range.",arch-arm64,CarolEidt,,
19031,Update PreReleaseLabel,"to ""alphautf8string"" so it sorts before ""preview1"" and so it's under the nuget 20 character limit","Update PreReleaseLabel to ""alphautf8string"" so it sorts before ""preview1"" and so it's under the nuget 20 character limit",,joshfree,,
19030,R2R build failures - Error: compilation failed for Core_Root/netcoreapp2.0/R2RDump.dll,"This fails in master for Linux r2r test legs https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_release_ubuntu_r2r_tst/1812/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_ubuntu_r2r_tst/1852/consoleText


On Ubuntu arm as well (failed while testing PR #19013 https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_checked_ubuntu_r2r_tst_prtest/8/consoleText)","R2R build failures - Error: compilation failed for Core_Root/netcoreapp2.0/R2RDump.dll This fails in master for Linux r2r test legs https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_release_ubuntu_r2r_tst/1812/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_ubuntu_r2r_tst/1852/consoleText


On Ubuntu arm as well (failed while testing PR #19013 https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_checked_ubuntu_r2r_tst_prtest/8/consoleText)",,acmyu,,
19029,JitStressRegs=0x8 regressions,"The 512 tests started failing recently in JitStress=0x8 mode

Typical failure looks like
","JitStressRegs=0x8 regressions The 512 tests started failing recently in JitStress=0x8 mode

Typical failure looks like
",arch-arm64,CarolEidt,,
19026,hi i use .net core 2.1in raspberry pi os raspbian 8 wil let CPU100%bug .net core 2.0 will not,"this is the arm linux 32 corclr tracing
https://github.com/AirleaderChina/Airleader-Open/blob/master/sampleTrace.trace.zip
bug i can't found any useful information.
the tracing display coreclr use many cpu times ","hi i use .net core 2.1in raspberry pi os raspbian 8 wil let CPU100%,bug .net core 2.0 will not this is the arm linux 32 corclr tracing
https://github.com/AirleaderChina/Airleader-Open/blob/master/sampleTrace.trace.zip
bug i can't found any useful information.
the tracing display coreclr use many cpu times ",arch-arm32,jkotas,20/07/2018 0:40,16/08/2018 13:59
19025,"CoreCLR doesn't boot on a ""modern"" Linux/ARM image","I'm able to compile .NET Core 2.1 for my Linux distribution based on Yocto for ARM. If I'm doing this for the ""pyro"" release from spring 2017 I can run the simple Hello World both when using the dotnet executable I've compiled with the just the dll as well as a self-contained publish for  coming from Windows.

With Yocto's ""sumo"" release from spring 2018 both methods of running the application hang indefinitely and don't printing anything. CTRL+C doesn't do anything and I have to kill -KILL from another shell.

As can be expected there are a couple of updates to the libraries included in the distribution. I'm listing the direct dependencies I've declared for my build in the following table

Library | pyro | sumo
------- | ---- | ----
clang | 4.0.1 | 6.0.1
cmake | 3.7.2 | 3.10.3
glibc | 2.25 | 2.27
libunwind | 1.1 | 1.2.1
icu | 58.2 | 60.2
openssl | 1.0.2n | 1.0.2o
util-linux | 2.29.1 | 2.31
lttng-ust | 2.9.0 | 2.10.1
krb5 | 1.15.1 | 1.16
curl | 7.53.1 | 7.58.0

I'm currently creating a Debug build and try to work with (against?) lldb to get some insight. Running with gdb also hangs and cannot be interrupted for a stack trace or the likes.

Any ideas?","CoreCLR doesn't boot on a ""modern"" Linux/ARM image I'm able to compile .NET Core 2.1 for my Linux distribution based on Yocto for ARM. If I'm doing this for the ""pyro"" release from spring 2017 I can run the simple Hello World both when using the dotnet executable I've compiled with the just the dll as well as a self-contained publish for  coming from Windows.

With Yocto's ""sumo"" release from spring 2018 both methods of running the application hang indefinitely and don't printing anything. CTRL+C doesn't do anything and I have to kill -KILL from another shell.

As can be expected there are a couple of updates to the libraries included in the distribution. I'm listing the direct dependencies I've declared for my build in the following table

Library | pyro | sumo
------- | ---- | ----
clang | 4.0.1 | 6.0.1
cmake | 3.7.2 | 3.10.3
glibc | 2.25 | 2.27
libunwind | 1.1 | 1.2.1
icu | 58.2 | 60.2
openssl | 1.0.2n | 1.0.2o
util-linux | 2.29.1 | 2.31
lttng-ust | 2.9.0 | 2.10.1
krb5 | 1.15.1 | 1.16
curl | 7.53.1 | 7.58.0

I'm currently creating a Debug build and try to work with (against?) lldb to get some insight. Running with gdb also hangs and cannot be interrupted for a stack trace or the likes.

Any ideas?",arch-arm32,jkotas,20/07/2018 0:32,
19023,Clarify calling conventions for profiler Enter callback,"@dotnet/jit-contrib @sywhang 

While investigating #18977 I'm seeing a number of things that look inconsistent and probably need to be fixed or better documented. Jit folks can you let me know what you think?

1) The [FunctionEnter3](https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/profiling/functionenter3-function)/[FunctionLeave3](https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/profiling/functionleave3-function)/[FunctionTailcall3](https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/profiling/functiontailcall3-function) methods are a publicly exposed and have a documented ABI. On Linux x64 we pass FunctionIDOrClientID in R14 MSDN documentation doesn't mention a custom calling convention so developers would expect RDI. I believe we picked R14 for good reason so I propose we change MSDN to match.
2) The runtime sometimes provides the implementation of the ProfileEnter call as an intermediary between the jitted code and other forms of the profiler callback. On Linux x64 that gives us 4 non-agreeing definitions of the register preservation requirements:
  - The MSDN docs claim the caller must preserve all registers
  - The code comments above the runtime ProfileEnterNaked implementation suggest a number of registers are not preserved:
https://github.com/dotnet/coreclr/blob/master/src/vm/amd64/asmhelpers.S#L59
   (Incidentally the comments aren't self-consistent either xmm1 and rdx are both preserved and not preserved ; )
   - The implementation of the JIT has different expectations about what would be preserved (for example is it really safe to trash the argument registers in the prologue of the caller?)
   - The implementation of the assembly routine preserves all the integer argument registers
https://github.com/dotnet/coreclr/blob/master/src/vm/amd64/asmhelpers.S#L135

I don't have a good sense of exactly what the JIT expects to be preserved across this call for the code to run correctly but whatever it is I'd like to bring our own comments implementation and MSDN docs into alignment with it. I suspect there may be discrepancies for the register preservation requirements on other architectures but I'm happy to start with Linux x64.

Thanks!
 -Noah
","Clarify calling conventions for profiler Enter callback @dotnet/jit-contrib @sywhang 

While investigating #18977 I'm seeing a number of things that look inconsistent and probably need to be fixed or better documented. Jit folks can you let me know what you think?

1) The [FunctionEnter3](https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/profiling/functionenter3-function)/[FunctionLeave3](https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/profiling/functionleave3-function)/[FunctionTailcall3](https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/profiling/functiontailcall3-function) methods are a publicly exposed and have a documented ABI. On Linux x64 we pass FunctionIDOrClientID in R14 MSDN documentation doesn't mention a custom calling convention so developers would expect RDI. I believe we picked R14 for good reason so I propose we change MSDN to match.
2) The runtime sometimes provides the implementation of the ProfileEnter call as an intermediary between the jitted code and other forms of the profiler callback. On Linux x64 that gives us 4 non-agreeing definitions of the register preservation requirements:
  - The MSDN docs claim the caller must preserve all registers
  - The code comments above the runtime ProfileEnterNaked implementation suggest a number of registers are not preserved:
https://github.com/dotnet/coreclr/blob/master/src/vm/amd64/asmhelpers.S#L59
   (Incidentally the comments aren't self-consistent either xmm1 and rdx are both preserved and not preserved ; )
   - The implementation of the JIT has different expectations about what would be preserved (for example is it really safe to trash the argument registers in the prologue of the caller?)
   - The implementation of the assembly routine preserves all the integer argument registers
https://github.com/dotnet/coreclr/blob/master/src/vm/amd64/asmhelpers.S#L135

I don't have a good sense of exactly what the JIT expects to be preserved across this call for the code to run correctly but whatever it is I'd like to bring our own comments implementation and MSDN docs into alignment with it. I suspect there may be discrepancies for the register preservation requirements on other architectures but I'm happy to start with Linux x64.

Thanks!
 -Noah
",area-CodeGen,sywhang,19/07/2018 22:16,
19022,Access Violation Exception in clrjit.dll - lclvars.cpp - lvaMarkLocalVars ,"Here's the callstack dump:



Other relevant info:

- Using Latest version of VS2017 community on a x64bit machine.
- The project is a classic Desktop Application
- It was using Net452 by default but it also crashes with Net471.
- Release mode crashes Debug mode works.
- It crashes with target platform x64
- It works well with target platform x86 for now we're going to force x86 as a temporary solution.

I'll post any other info I can get.","Access Violation Exception in clrjit.dll - lclvars.cpp - lvaMarkLocalVars  Here's the callstack dump:



Other relevant info:

- Using Latest version of VS2017 community on a x64bit machine.
- The project is a classic Desktop Application
- It was using Net452 by default but it also crashes with Net471.
- Release mode crashes Debug mode works.
- It crashes with target platform x64
- It works well with target platform x86 for now we're going to force x86 as a temporary solution.

I'll post any other info I can get.",area-CodeGen,briansull,,
19020,Build failure: ARM64 build of Interop\COM\NativeServer\COMNativeServer,"Opened on behalf of @RussKeldorph

Warnings: 1
Status Message: failed

Build : Master - 20180719.01 (Product Build)
Failing configurations:
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180719.01/workItem/Orchestration/analysis/external/Link)
","Build failure: ARM64 build of Interop\COM\NativeServer\COMNativeServer Opened on behalf of @RussKeldorph

Warnings: 1
Status Message: failed

Build : Master - 20180719.01 (Product Build)
Failing configurations:
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180719.01/workItem/Orchestration/analysis/external/Link)
",arch-arm64,AaronRobinsonMSFT,,
19018,Test failure: Exceptions_Finalization._Finalizer_Finalizer_/_Finalizer_Finalizer_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.

Test Infrastructure Failure: Could not load file or assembly 'System.Diagnostics.Process Version=4.2.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180719.01 (Ready-To-Run Tests)
Failing configurations:
- opensuse.423.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180719.01/workItem/Exceptions.Finalization.XUnitWrapper/analysis/xunit/Exceptions_Finalization._Finalizer_Finalizer_~2F_Finalizer_Finalizer_cmd","Test failure: Exceptions_Finalization._Finalizer_Finalizer_/_Finalizer_Finalizer_cmd Opened on behalf of @Sunny-pu

The test  has failed.

Test Infrastructure Failure: Could not load file or assembly 'System.Diagnostics.Process Version=4.2.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180719.01 (Ready-To-Run Tests)
Failing configurations:
- opensuse.423.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180719.01/workItem/Exceptions.Finalization.XUnitWrapper/analysis/xunit/Exceptions_Finalization._Finalizer_Finalizer_~2F_Finalizer_Finalizer_cmd",GCStress,RussKeldorph,19/07/2018 17:19,22/06/2019 9:05
19017,Test failure: Interop_COM._NETClients_Primitives_NETClientPrimitives_NETClientPrimitives_/_NETClients_Primitives_NETClientPrimitives_NETClientPrimitives_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      C:\\work\\3400b627-09fb-4f1a-bd33-2f4c2d5e051f\\Work\\c699e3df-3136-4654-9043-92d2f057c2b0\\Unzip\\Reports\\Interop.COM\\NETClients\\Primitives\\NETClientPrimitives\\NETClientPrimitives.output.txt
    Raw output:
    BEGIN EXECUTION\r
     \""C:\\work\\3400b627-09fb-4f1a-bd33-2f4c2d5e051f\\Payload\\corerun.exe\"" NETClientPrimitives.exe \r
    Numeric RNG seed: 37\r
    Test Failure: Retrieving the COM class factory for component with CLSID {53169A33-E85D-4E3C-B668-24E438D0929B} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)).
       at NetClient.NumericTests..ctor(Int32 seed) in E:\\A\\_work\\124\\s\\tests\\src\\Interop\\COM\\NETClients\\Primitives\\NumericTests.cs:line 22\r
       at NetClient.Program.Main(String[] doNotUse) in E:\\A\\_work\\124\\s\\tests\\src\\Interop\\COM\\NETClients\\Primitives\\Program.cs:line 15\r
    Expected: 100\r
    Actual: 101\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\work\\3400b627-09fb-4f1a-bd33-2f4c2d5e051f\\Payload
    > C:\\work\\3400b627-09fb-4f1a-bd33-2f4c2d5e051f\\Work\\c699e3df-3136-4654-9043-92d2f057c2b0\\Unzip\\NETClients\\Primitives\\NETClientPrimitives\\NETClientPrimitives.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

        
Build : Master - 20180719.01 (Core Tests)
Failing configurations:
- Windows.10.Nano.Amd64-x64
  - 
- sles.12.amd64-x64
  - 
- opensuse.423.amd64-x64
  - 
- ubuntu.1804.amd64-x64
  - 
- ubuntu.1710.amd64-x64
  - 
- ubuntu.1604.amd64-x64
  - 
- ubuntu.1404.amd64-x64
  - 
- redhat.73.amd64-x64
  - 
- fedora.27.amd64-x64
  - 
- fedora.26.amd64-x64
  - 
- debian.82.amd64-x64
  - 
- osx.1013.amd64-x64
  - 
- osx.1012.amd64-x64
  - 

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180719.01/workItem/Interop.COM.XUnitWrapper/analysis/xunit/Interop_COM._NETClients_Primitives_NETClientPrimitives_NETClientPrimitives_~2F_NETClients_Primitives_NETClientPrimitives_NETClientPrimitives_cmd","Test failure: Interop_COM._NETClients_Primitives_NETClientPrimitives_NETClientPrimitives_/_NETClients_Primitives_NETClientPrimitives_NETClientPrimitives_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      C:\\work\\3400b627-09fb-4f1a-bd33-2f4c2d5e051f\\Work\\c699e3df-3136-4654-9043-92d2f057c2b0\\Unzip\\Reports\\Interop.COM\\NETClients\\Primitives\\NETClientPrimitives\\NETClientPrimitives.output.txt
    Raw output:
    BEGIN EXECUTION\r
     \""C:\\work\\3400b627-09fb-4f1a-bd33-2f4c2d5e051f\\Payload\\corerun.exe\"" NETClientPrimitives.exe \r
    Numeric RNG seed: 37\r
    Test Failure: Retrieving the COM class factory for component with CLSID {53169A33-E85D-4E3C-B668-24E438D0929B} failed due to the following error: 80040154 Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG)).
       at NetClient.NumericTests..ctor(Int32 seed) in E:\\A\\_work\\124\\s\\tests\\src\\Interop\\COM\\NETClients\\Primitives\\NumericTests.cs:line 22\r
       at NetClient.Program.Main(String[] doNotUse) in E:\\A\\_work\\124\\s\\tests\\src\\Interop\\COM\\NETClients\\Primitives\\Program.cs:line 15\r
    Expected: 100\r
    Actual: 101\r
    END EXECUTION - FAILED\r
    FAILED\r
    Test Harness Exitcode is : 1\r
    
    To run the test:
    > set CORE_ROOT=C:\\work\\3400b627-09fb-4f1a-bd33-2f4c2d5e051f\\Payload
    > C:\\work\\3400b627-09fb-4f1a-bd33-2f4c2d5e051f\\Work\\c699e3df-3136-4654-9043-92d2f057c2b0\\Unzip\\NETClients\\Primitives\\NETClientPrimitives\\NETClientPrimitives.cmd
    \r
    Expected: True\r
    Actual:   False

        Stack Trace:

        
Build : Master - 20180719.01 (Core Tests)
Failing configurations:
- Windows.10.Nano.Amd64-x64
  - 
- sles.12.amd64-x64
  - 
- opensuse.423.amd64-x64
  - 
- ubuntu.1804.amd64-x64
  - 
- ubuntu.1710.amd64-x64
  - 
- ubuntu.1604.amd64-x64
  - 
- ubuntu.1404.amd64-x64
  - 
- redhat.73.amd64-x64
  - 
- fedora.27.amd64-x64
  - 
- fedora.26.amd64-x64
  - 
- debian.82.amd64-x64
  - 
- osx.1013.amd64-x64
  - 
- osx.1012.amd64-x64
  - 

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180719.01/workItem/Interop.COM.XUnitWrapper/analysis/xunit/Interop_COM._NETClients_Primitives_NETClientPrimitives_NETClientPrimitives_~2F_NETClients_Primitives_NETClientPrimitives_NETClientPrimitives_cmd",area-Interop,AaronRobinsonMSFT,,
19013,[ARM32] Handle MovRelocatableImmediate as a special case (IF_T2_N3),"

Running *jit-diff --pmi --altjit* and *jit-diff --crossgen x86_arm/crossgen.exe* shows no diffs for framework assemblies. 

Ubuntu arm pri1 and corefx tests have passed for these changes.
","[ARM32] Handle MovRelocatableImmediate as a special case (IF_T2_N3) 

Running *jit-diff --pmi --altjit* and *jit-diff --crossgen x86_arm/crossgen.exe* shows no diffs for framework assemblies. 

Ubuntu arm pri1 and corefx tests have passed for these changes.
",arch-arm32,dotnet-bot,19/07/2018 11:29,4/08/2018 5:35
19011,Test failure in r2rdump test,"Test failure in x64 Checked Windows with 
","Test failure in r2rdump test Test failure in x64 Checked Windows with 
",arch-x64,acmyu,,
19010,Script warning in init-tools.sh,"

Perhaps setup-stress-dependencies.sh should also invoke it using ""source""?","Script warning in init-tools.sh 

Perhaps setup-stress-dependencies.sh should also invoke it using ""source""?",area-Infrastructure-coreclr,BruceForstall,19/07/2018 10:40,
19009,Syntax error in build-test.sh script,,Syntax error in build-test.sh script ,area-Infrastructure-coreclr,BruceForstall,19/07/2018 10:25,22/03/2019 4:12
19008,Many x64 checked Ubuntu GCStress=0xC test failures,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_ubuntu_gcstress0xc_flow/91/


","Many x64 checked Ubuntu GCStress=0xC test failures https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_ubuntu_gcstress0xc_flow/91/


",GCStress,BruceForstall,19/07/2018 10:20,12/01/2019 11:59
19007,Ubuntu IL linker test failures in CI,"This job is failing every test:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/illink/job/x64_checked_ubuntu_illink_flow/

e.g.:


Note that there is also a non-flow Ubuntu x64 IL linker test job:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/illink/job/x64_checked_ubuntu_illink/

This one passes but it doesn't look like it's actually doing any interesting testing. I'm not sure this is a related issue or not. If not create a new issue to address removing one of them (if necessary).","Ubuntu IL linker test failures in CI This job is failing every test:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/illink/job/x64_checked_ubuntu_illink_flow/

e.g.:


Note that there is also a non-flow Ubuntu x64 IL linker test job:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/illink/job/x64_checked_ubuntu_illink/

This one passes but it doesn't look like it's actually doing any interesting testing. I'm not sure this is a related issue or not. If not create a new issue to address removing one of them (if necessary).",arch-x64,sbomer,,
19005,Minor interop code changes,,Minor interop code changes ,area-Interop,AaronRobinsonMSFT,19/07/2018 9:57,20/07/2018 17:48
19003,x86 Ubuntu CI jobs are failing,"Namely

https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_debug_ubuntu_flow/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_checked_ubuntu_flow/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_release_ubuntu_flow/

There are several problems:
1. A missing ""mkdir"" leads to:

2. It appears these jobs have (inadvertently?) been partially updated to the ""new"" way of running which uses ""build-test.sh x86 Checked generatelayoutonly"" to generate a Core_Root and download packages. But apparently there are no x86 Linux packages in the official build to pull down. Perhaps the ""tst"" job needs to revert to the previous method of invoking runtest.sh? Or we need to get the correct packages built and published?
","x86 Ubuntu CI jobs are failing Namely

https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_debug_ubuntu_flow/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_checked_ubuntu_flow/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_release_ubuntu_flow/

There are several problems:
1. A missing ""mkdir"" leads to:

2. It appears these jobs have (inadvertently?) been partially updated to the ""new"" way of running which uses ""build-test.sh x86 Checked generatelayoutonly"" to generate a Core_Root and download packages. But apparently there are no x86 Linux packages in the official build to pull down. Perhaps the ""tst"" job needs to revert to the previous method of invoking runtest.sh? Or we need to get the correct packages built and published?
",arch-x86,BruceForstall,19/07/2018 9:29,
19001,JIT.HardwareIntrinsics.X86.Avx.Avx_ro.Avx_ro failed in CI on macOS,"https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4234/
","JIT.HardwareIntrinsics.X86.Avx.Avx_ro.Avx_ro failed in CI on macOS https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4234/
",area-CodeGen,AaronRobinsonMSFT,19/07/2018 7:18,7/12/2018 6:50
19000,[x86/Windows] Failure in JIT\HardwareIntrinsics\X86\Sse2\MaskMove_r\MaskMove_r.cmd,"x86 Windows JitStress=2 JitStressRegs=3 failure

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_jitstress2_jitstressregs3/555/consoleText



Same test failure previously: https://github.com/dotnet/coreclr/issues/17634
","[x86/Windows] Failure in JIT\HardwareIntrinsics\X86\Sse2\MaskMove_r\MaskMove_r.cmd x86 Windows JitStress=2 JitStressRegs=3 failure

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_jitstress2_jitstressregs3/555/consoleText



Same test failure previously: https://github.com/dotnet/coreclr/issues/17634
",arch-x86,4creators,,
18997,GCStress test failure in JIT\HardwareIntrinsics\X86\Bmi1\Bmi1_r\Bmi1_r.cmd,"x86 Checked Windows GCStress=0xc failure

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_gcstress0xc/91/consoleText



","GCStress test failure in JIT\HardwareIntrinsics\X86\Bmi1\Bmi1_r\Bmi1_r.cmd x86 Checked Windows GCStress=0xc failure

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_gcstress0xc/91/consoleText



",GCStress,BruceForstall,19/07/2018 6:30,28/07/2018 8:01
18991,[arm64][R2R] Test failure: VectorDot_ro.cmd_9267,"In R2R tests with JitStress=1 or JitStress=2 there is a failure in:

","[arm64][R2R] Test failure: VectorDot_ro.cmd_9267 In R2R tests with JitStress=1 or JitStress=2 there is a failure in:

",arch-arm64,AndyAyersMS,,
18989,[arm64] Assertion failed '(sizeDif == 4) || (sizeDif == 8)' in 'floatMDArrTest:Main():int',"Failure in

","[arm64] Assertion failed '(sizeDif == 4) || (sizeDif == 8)' in 'floatMDArrTest:Main():int' Failure in

",arch-arm64,briansull,,
18988,[Windows/arm32] Test failure: 10w5d_cs_do.cmd ,"With JitStress=1

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_jitstress1_tst/33/


","[Windows/arm32] Test failure: 10w5d_cs_do.cmd  With JitStress=1

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_jitstress1_tst/33/


",area-CodeGen,sandreenko,,
18987,Infrastructure failure in ubuntu arm32 corefx Jenkins jobs,"It looks like all the ubuntu arm32 corefx jobs I kicked off yesterday passed all tests but failed at the end with what looks like an infrastructure failure e.g.:



example jobs:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress2_tst/17/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs2_tst/12/consoleText

Other (non-corefx) jobs I kicked off did not have this issue.

Ideas? Is there a reason it might be transient and I should just try again?

@mmitche 
cc @jashook @RussKeldorph ","Infrastructure failure in ubuntu arm32 corefx Jenkins jobs It looks like all the ubuntu arm32 corefx jobs I kicked off yesterday passed all tests but failed at the end with what looks like an infrastructure failure e.g.:



example jobs:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress2_tst/17/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs2_tst/12/consoleText

Other (non-corefx) jobs I kicked off did not have this issue.

Ideas? Is there a reason it might be transient and I should just try again?

@mmitche 
cc @jashook @RussKeldorph ",area-Infrastructure-coreclr,mmitche,19/07/2018 2:06,3/01/2019 6:44
18986,Assertion failed 'rhs->OperGet() == GT_LONG',"This is a recent regression.

Every Ubuntu arm32 JitStress=2 with JitStressRegs failed with:


e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_jitstress2_jitstressregs1_tst/15/consoleText.

There is currently no recent run without JitStressRegs to see if it fails with just JitStress=2 (https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_jitstress2_flow/)

@dotnet/arm32-contrib @dotnet/jit-contrib ","Assertion failed 'rhs->OperGet() == GT_LONG' This is a recent regression.

Every Ubuntu arm32 JitStress=2 with JitStressRegs failed with:


e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_jitstress2_jitstressregs1_tst/15/consoleText.

There is currently no recent run without JitStressRegs to see if it fails with just JitStress=2 (https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_jitstress2_flow/)

@dotnet/arm32-contrib @dotnet/jit-contrib ",arch-arm32,sandreenko,,
18984,FriendAccessAllowedAttribute public?,Would it be possible to make the System.Runtime.CompilerServices.FriendAccessAllowedAttribute public to be more explicit and clearly state intent of what exactly should be visible to a friend assembly?,FriendAccessAllowedAttribute public? Would it be possible to make the System.Runtime.CompilerServices.FriendAccessAllowedAttribute public to be more explicit and clearly state intent of what exactly should be visible to a friend assembly?,area-TypeSystem,jkotas,18/07/2018 17:44,25/05/2019 2:37
18977,ELT call stub issues on Linux,"Hi @noahfalk  - this is to continue the discussion from a closed issue prior.

I'm (slowly) porting our windows CLR profiler to linux. Everything was going spectacularly well until I tried to use the ICorProfilerInfo3::GetFunctionEnter3Info method. Calling this immediately results in a segmentation fault:


It seems to me like the frame isn't being set up right but I just have no idea where to begin. Help? Thanks in advance for any insight.



","ELT call stub issues on Linux Hi @noahfalk  - this is to continue the discussion from a closed issue prior.

I'm (slowly) porting our windows CLR profiler to linux. Everything was going spectacularly well until I tried to use the ICorProfilerInfo3::GetFunctionEnter3Info method. Calling this immediately results in a segmentation fault:


It seems to me like the frame isn't being set up right but I just have no idea where to begin. Help? Thanks in advance for any insight.



",area-Diagnostics,sywhang,,
18973,Enable tiered compilation by default,"# Enable tiered compilation by default

Tiered compilation was added as an optional feature in .NET Core 2.1. It has been demonstrated that the [feature has a lot of value](https://github.com/dotnet/coreclr/issues/18361#issuecomment-396402549). We have done additional test runs that show similar gains.

There have been some reports of [degradation due to tiered compilation](https://github.com/dotnet/coreclr/issues/18361). We believe that these cases are in the narrow minority.

We would like to do the following:

- Enable tiered compilation by default in the first .NET Core 2.2 preview.
- Enable an opt-out of the feature. It is opt-in right now.
- Collect user feedback on the feature to make a decision if the feature works well enough to ship in 2.2 enabled.

We would make the same changes in master (AKA .NET Core 3.0) at the same time.

If that doesn't work out we could keep the feature as opt-in and enable it in some set of templates. This option isn't a proposal and would be dissapointing

Relevant links:

* https://github.com/dotnet/coreclr/issues/4331
* https://github.com/dotnet/coreclr/pull/17840
* https://github.com/dotnet/sdk/pull/2201
* https://github.com/dotnet/coreclr/issues/18361
","Enable tiered compilation by default # Enable tiered compilation by default

Tiered compilation was added as an optional feature in .NET Core 2.1. It has been demonstrated that the [feature has a lot of value](https://github.com/dotnet/coreclr/issues/18361#issuecomment-396402549). We have done additional test runs that show similar gains.

There have been some reports of [degradation due to tiered compilation](https://github.com/dotnet/coreclr/issues/18361). We believe that these cases are in the narrow minority.

We would like to do the following:

- Enable tiered compilation by default in the first .NET Core 2.2 preview.
- Enable an opt-out of the feature. It is opt-in right now.
- Collect user feedback on the feature to make a decision if the feature works well enough to ship in 2.2 enabled.

We would make the same changes in master (AKA .NET Core 3.0) at the same time.

If that doesn't work out we could keep the feature as opt-in and enable it in some set of templates. This option isn't a proposal and would be dissapointing

Relevant links:

* https://github.com/dotnet/coreclr/issues/4331
* https://github.com/dotnet/coreclr/pull/17840
* https://github.com/dotnet/sdk/pull/2201
* https://github.com/dotnet/coreclr/issues/18361
",area-TieredCompilation,kouvel,,
18971,Ensure .NET Core respects and plays nicely with Docker limits,"Docker enables you to [limit a container's resources](https://docs.docker.com/config/containers/resource_constraints/). This control is great for high-density hosting and other low-resource scenarios. Developers have the expectation that the application platform respects these limits and does its best to work within them.

I wrote a [crude test framework](https://github.com/richlander/dotnet-docker-limits) to determine how .NET Core behaves when various resource limits are set. You can see the [test results](https://gist.github.com/richlander/48bb0ad51a2406937b61bea01de7cf87).

The results I saw made some sense -- workstation performed better than server gc in this environment -- however some other characteristics were surprising. It could be that my tests were flawed.

Our first goal is to provide developers with guidance. For example if there a minimum memory limit that is required to run an app in production? Is server gc currently safe to run with docker limits?

Our next goal is to update the product as appropriate to ensure that it works well with Docker limits and then to update guidance appropriately.

Once we are done I'd like to re-run this test suite following the guidance. I/we should be able to pick a lower bound number (this app is very simple) and expect it to run w/o memory exhaustion.

[My app](https://github.com/richlander/dotnet-docker-limits/tree/master/src/aspnetapi) is very simple. There will be apps run in containers that require running on multiple cores and take advantage of server GC. Is that appropriate for docker limits or is there a minimum memory level of 250mb for example for that scenario? We should probably find a different test app that better exhibits the behavior of this type of app.
","Ensure .NET Core respects and plays nicely with Docker limits Docker enables you to [limit a container's resources](https://docs.docker.com/config/containers/resource_constraints/). This control is great for high-density hosting and other low-resource scenarios. Developers have the expectation that the application platform respects these limits and does its best to work within them.

I wrote a [crude test framework](https://github.com/richlander/dotnet-docker-limits) to determine how .NET Core behaves when various resource limits are set. You can see the [test results](https://gist.github.com/richlander/48bb0ad51a2406937b61bea01de7cf87).

The results I saw made some sense -- workstation performed better than server gc in this environment -- however some other characteristics were surprising. It could be that my tests were flawed.

Our first goal is to provide developers with guidance. For example if there a minimum memory limit that is required to run an app in production? Is server gc currently safe to run with docker limits?

Our next goal is to update the product as appropriate to ensure that it works well with Docker limits and then to update guidance appropriately.

Once we are done I'd like to re-run this test suite following the guidance. I/we should be able to pick a lower bound number (this app is very simple) and expect it to run w/o memory exhaustion.

[My app](https://github.com/richlander/dotnet-docker-limits/tree/master/src/aspnetapi) is very simple. There will be apps run in containers that require running on multiple cores and take advantage of server GC. Is that appropriate for docker limits or is there a minimum memory level of 250mb for example for that scenario? We should probably find a different test app that better exhibits the behavior of this type of app.
",area-VM,sergiy-k,,
18969,JIT: overview of proposed local var reference count changes,"This issue proposes a series of changes to reduce the overhead and increase the fidelity of local variable reference counts in the jit. The main idea is to get rid of the current costly and buggy incremental count maintenance in favor of batch updates that are done just before accurate ref counts are needed.

See discussion in #13280 for background.

Expected impact is:
* 4-5% improvement in tier0 / minopts / debug throughput
* minimal impact to optimized jit throughput
* smaller frame sizes in some cases where reference counts are currently inflated
* removal of workarounds to artificially inflate reference counts to avoid asserts

The more accurate reference counts and weighted counts are likely to cause widespread codegen diffs. Hopefully these will mostly be improvements but some regressions are certainly possible.

Proposed steps are:
- [x] encapsulate accesses to  to split out ref counting from other activities

cc @dotnet/jit-contrib 


category:implementation
theme:ir
skill-level:expert
cost:large","JIT: overview of proposed local var reference count changes This issue proposes a series of changes to reduce the overhead and increase the fidelity of local variable reference counts in the jit. The main idea is to get rid of the current costly and buggy incremental count maintenance in favor of batch updates that are done just before accurate ref counts are needed.

See discussion in #13280 for background.

Expected impact is:
* 4-5% improvement in tier0 / minopts / debug throughput
* minimal impact to optimized jit throughput
* smaller frame sizes in some cases where reference counts are currently inflated
* removal of workarounds to artificially inflate reference counts to avoid asserts

The more accurate reference counts and weighted counts are likely to cause widespread codegen diffs. Hopefully these will mostly be improvements but some regressions are certainly possible.

Proposed steps are:
- [x] encapsulate accesses to  to split out ref counting from other activities

cc @dotnet/jit-contrib 


category:implementation
theme:ir
skill-level:expert
cost:large",JitThroughput,AndyAyersMS,,
18968,"EventWaitHandle.OpenExisting("""".PadLeft(512)) is throwing ArgumentException instead of ","The following test outputted ""Pass"" in .NET Core 2.1 and is now outputting ""Fail"" with the latest CoreCLR in the master branch.


4. Run the build executable it should output ""Pass"".
5. Build the latest master CoreCLR and copy the new binaries on top of the published ones.
6. Run the build executable it should output ""Fail"".","EventWaitHandle.OpenExisting("""".PadLeft(512)) is throwing ArgumentException instead of  The following test outputted ""Pass"" in .NET Core 2.1 and is now outputting ""Fail"" with the latest CoreCLR in the master branch.


4. Run the build executable it should output ""Pass"".
5. Build the latest master CoreCLR and copy the new binaries on top of the published ones.
6. Run the build executable it should output ""Fail"".",area-System.Threading,kouvel,,
18966,[x64] Assertion failed '!s_pagePool.isPoolPage(page)',"From x64 corefx JitStressRegs=0x1000 run: https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_windows_nt_corefx_jitstressregs0x1000/462/consoleText



","[x64] Assertion failed '!s_pagePool.isPoolPage(page)' From x64 corefx JitStressRegs=0x1000 run: https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_windows_nt_corefx_jitstressregs0x1000/462/consoleText



",area-CodeGen,BruceForstall,18/07/2018 4:57,18/07/2018 5:12
18965,[NO MERGE] Dummy PR for testing IncreaseTimeOutInRegexMatchTestsMatch_ExcessPrefixTest,**NO MERGE**,[NO MERGE] Dummy PR for testing IncreaseTimeOutInRegexMatchTestsMatch_ExcessPrefixTest **NO MERGE**,* NO MERGE *,echesakovMSFT,18/07/2018 4:49,21/07/2018 3:55
18963,[x64] Assertion failed '!BitVecOps::IsMember(&nodesVecTraits uniqueNodes gtTreeID)',"Failure in CI in x64 corefx minopts tests. E.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_windows_nt_corefx_minopts/581/consoleText

There are 60 occurrences of this assert in this run.


","[x64] Assertion failed '!BitVecOps::IsMember(&nodesVecTraits, uniqueNodes, gtTreeID)' Failure in CI in x64 corefx minopts tests. E.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_windows_nt_corefx_minopts/581/consoleText

There are 60 occurrences of this assert in this run.


",area-CodeGen,BruceForstall,18/07/2018 4:41,21/07/2018 8:37
18960,Test failure: CoreMangLib_system._span_SlowTailCallArgs_SlowTailCallArgs_/_span_SlowTailCallArgs_SlowTailCallArgs_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.IO.FileNotFoundException: Could not load file or assembly 'System.Reflection.Emit.ILGeneration Version=4.0.3.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
    
       at SpanTest.Run()
       at Program.Main()
    /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/3938d767-5cf7-42d2-8619-5e5ef7623a10/Unzip/span/SlowTailCallArgs/SlowTailCallArgs.sh: line 251: 48570 Aborted                 (core dumped) $_DebuggerFullPath \""$CORE_ROOT/corerun\"" $ExePath $CLRTestExecutionArguments
    
    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/3938d767-5cf7-42d2-8619-5e5ef7623a10/Unzip/Reports\\CoreMangLib.system\\span\\SlowTailCallArgs\\SlowTailCallArgs.output.txt
    Raw output:
    BEGIN EXECUTION
    /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload/corerun SlowTailCallArgs.exe
        SpanTest: Expected: 100
    Actual: 134
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload
    > /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/3938d767-5cf7-42d2-8619-5e5ef7623a10/Unzip/span/SlowTailCallArgs/SlowTailCallArgs.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180716.04 (Ready-To-Run Tests)
Failing configurations:
- opensuse.423.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180716.04/workItem/CoreMangLib.system.XUnitWrapper/analysis/xunit/CoreMangLib_system._span_SlowTailCallArgs_SlowTailCallArgs_~2F_span_SlowTailCallArgs_SlowTailCallArgs_cmd","Test failure: CoreMangLib_system._span_SlowTailCallArgs_SlowTailCallArgs_/_span_SlowTailCallArgs_SlowTailCallArgs_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    Unhandled Exception: System.IO.FileNotFoundException: Could not load file or assembly 'System.Reflection.Emit.ILGeneration Version=4.0.3.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
    
       at SpanTest.Run()
       at Program.Main()
    /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/3938d767-5cf7-42d2-8619-5e5ef7623a10/Unzip/span/SlowTailCallArgs/SlowTailCallArgs.sh: line 251: 48570 Aborted                 (core dumped) $_DebuggerFullPath \""$CORE_ROOT/corerun\"" $ExePath $CLRTestExecutionArguments
    
    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/3938d767-5cf7-42d2-8619-5e5ef7623a10/Unzip/Reports\\CoreMangLib.system\\span\\SlowTailCallArgs\\SlowTailCallArgs.output.txt
    Raw output:
    BEGIN EXECUTION
    /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload/corerun SlowTailCallArgs.exe
        SpanTest: Expected: 100
    Actual: 134
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload
    > /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/3938d767-5cf7-42d2-8619-5e5ef7623a10/Unzip/span/SlowTailCallArgs/SlowTailCallArgs.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180716.04 (Ready-To-Run Tests)
Failing configurations:
- opensuse.423.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180716.04/workItem/CoreMangLib.system.XUnitWrapper/analysis/xunit/CoreMangLib_system._span_SlowTailCallArgs_SlowTailCallArgs_~2F_span_SlowTailCallArgs_SlowTailCallArgs_cmd",area-ReadyToRun,RussKeldorph,17/07/2018 18:44,20/06/2019 10:24
18959,Test failure: baseservices_regression._v1_threads_functional_threadpool_cs_threadpoolnullchecks_CS_ThreadPoolNullChecks_CS_ThreadPoolNullChecks_/_v1_threads_functional_threadpool_cs_threadpoolnullchecks_CS_ThreadPoolNullChecks_CS_ThreadPoolNullChecks_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.

Error: Could not load file or assembly 'System.Threading.ThreadPool Version=4.1.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
     (Exception from HRESULT: 0x80070002)
    Error compiling CS_ThreadPoolNullChecks.org: Could not find or load a specific file. (Exception from HRESULT: 0x80131621)
    Error: compilation failed for \""CS_ThreadPoolNullChecks.org\"" (0x80131621)
    
    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/b03a8239-5170-4a4b-a231-f0b855577e56/Unzip/Reports\\baseservices.regression\\v1\\threads\\functional\\threadpool\\cs_threadpoolnullchecks\\CS_ThreadPoolNullChecks\\CS_ThreadPoolNullChecks.output.txt
    Raw output:
    BEGIN EXECUTION
    in takeLock
    /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload/crossgen /Platform_Assemblies_Paths /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload:/home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/b03a8239-5170-4a4b-a231-f0b855577e56/Unzip/v1/threads/functional/threadpool/cs_threadpoolnullchecks/CS_ThreadPoolNullChecks/IL:/home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/b03a8239-5170-4a4b-a231-f0b855577e56/Unzip/v1/threads/functional/threadpool/cs_threadpoolnullchecks/CS_ThreadPoolNullChecks /in CS_ThreadPoolNullChecks.org /out CS_ThreadPoolNullChecks.exe
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0
    Copyright (c) Microsoft Corporation.  All rights reserved.
    
    Crossgen failed with exitcode: 33
    in ReleaseLock
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload
    > /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/b03a8239-5170-4a4b-a231-f0b855577e56/Unzip/v1/threads/functional/threadpool/cs_threadpoolnullchecks/CS_ThreadPoolNullChecks/CS_ThreadPoolNullChecks.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180716.04 (Ready-To-Run Tests)
Failing configurations:
- opensuse.423.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180716.04/workItem/baseservices.regression.XUnitWrapper/analysis/xunit/baseservices_regression._v1_threads_functional_threadpool_cs_threadpoolnullchecks_CS_ThreadPoolNullChecks_CS_ThreadPoolNullChecks_~2F_v1_threads_functional_threadpool_cs_threadpoolnullchecks_CS_ThreadPoolNullChecks_CS_ThreadPoolNullChecks_cmd","Test failure: baseservices_regression._v1_threads_functional_threadpool_cs_threadpoolnullchecks_CS_ThreadPoolNullChecks_CS_ThreadPoolNullChecks_/_v1_threads_functional_threadpool_cs_threadpoolnullchecks_CS_ThreadPoolNullChecks_CS_ThreadPoolNullChecks_cmd Opened on behalf of @Sunny-pu

The test  has failed.

Error: Could not load file or assembly 'System.Threading.ThreadPool Version=4.1.1.0 Culture=neutral PublicKeyToken=b03f5f7f11d50a3a'. The system cannot find the file specified.
     (Exception from HRESULT: 0x80070002)
    Error compiling CS_ThreadPoolNullChecks.org: Could not find or load a specific file. (Exception from HRESULT: 0x80131621)
    Error: compilation failed for \""CS_ThreadPoolNullChecks.org\"" (0x80131621)
    
    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/b03a8239-5170-4a4b-a231-f0b855577e56/Unzip/Reports\\baseservices.regression\\v1\\threads\\functional\\threadpool\\cs_threadpoolnullchecks\\CS_ThreadPoolNullChecks\\CS_ThreadPoolNullChecks.output.txt
    Raw output:
    BEGIN EXECUTION
    in takeLock
    /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload/crossgen /Platform_Assemblies_Paths /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload:/home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/b03a8239-5170-4a4b-a231-f0b855577e56/Unzip/v1/threads/functional/threadpool/cs_threadpoolnullchecks/CS_ThreadPoolNullChecks/IL:/home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/b03a8239-5170-4a4b-a231-f0b855577e56/Unzip/v1/threads/functional/threadpool/cs_threadpoolnullchecks/CS_ThreadPoolNullChecks /in CS_ThreadPoolNullChecks.org /out CS_ThreadPoolNullChecks.exe
    Microsoft (R) CoreCLR Native Image Generator - Version 4.5.30319.0
    Copyright (c) Microsoft Corporation.  All rights reserved.
    
    Crossgen failed with exitcode: 33
    in ReleaseLock
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Payload
    > /home/helixbot/dotnetbuild/work/829eb0a1-744b-4dd3-8627-616125703d53/Work/b03a8239-5170-4a4b-a231-f0b855577e56/Unzip/v1/threads/functional/threadpool/cs_threadpoolnullchecks/CS_ThreadPoolNullChecks/CS_ThreadPoolNullChecks.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180716.04 (Ready-To-Run Tests)
Failing configurations:
- opensuse.423.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180716.04/workItem/baseservices.regression.XUnitWrapper/analysis/xunit/baseservices_regression._v1_threads_functional_threadpool_cs_threadpoolnullchecks_CS_ThreadPoolNullChecks_CS_ThreadPoolNullChecks_~2F_v1_threads_functional_threadpool_cs_threadpoolnullchecks_CS_ThreadPoolNullChecks_CS_ThreadPoolNullChecks_cmd",area-ReadyToRun,RussKeldorph,17/07/2018 18:17,20/06/2019 10:26
18958,.NET CORE console appliation crashes randomly on RaspberryPi (mode: 3B+ Linux ARM32),"# Issue Title

My .NET CORE (runtime version 2.1.1) console application crashes randomly on RaspberryPi (mode: 3B+ Linux ARM32 Debian 9)

# General
I have an application that just open 8 tcp connections for read and write the data rate for each connection is about 200Byte/second in most case the application can runs well but sometime later like 7 or 8 hours it randomly crashes I have attached the  with logging but in these cases it never get called and I have seem some extra info shown in console before application crashes and quit they are:

> ./myApp: relocation error: /pathToMyApp/libclrjit.so: symbol pthread_ version GLIBC_2.4 not defined in file libpthread.so.0 with link time reference

and

>Bus error

and

>Aborted

Later I've add my app to daemon mode and this time I can see sth in syslog:

> Jul 17 08:30:51 raspberrypi systemd[1]: myApp.service: Main process exited code=killed status=6/ABRT
> Jul 17 08:30:51 raspberrypi systemd[1]: myApp.service: Unit entered failed state.
> Jul 17 08:30:51 raspberrypi systemd[1]: myApp.service: Failed with result 'signal'.
> Jul 17 08:31:01 raspberrypi systemd[1]: myApp.service: Service hold-off time over scheduling restart.

I've logged the performance counters all the way can see the CPU and memory are all stable.
I've tried followed the [enable core dump on linux](http://blogs.microsoft.co.il/sasha/2017/02/26/analyzing-a-net-core-core-dump-on-linux/) but could never see any dump files generated please help.",".NET CORE console appliation crashes randomly on RaspberryPi (mode: 3B+, Linux ARM32) # Issue Title

My .NET CORE (runtime version 2.1.1) console application crashes randomly on RaspberryPi (mode: 3B+ Linux ARM32 Debian 9)

# General
I have an application that just open 8 tcp connections for read and write the data rate for each connection is about 200Byte/second in most case the application can runs well but sometime later like 7 or 8 hours it randomly crashes I have attached the  with logging but in these cases it never get called and I have seem some extra info shown in console before application crashes and quit they are:

> ./myApp: relocation error: /pathToMyApp/libclrjit.so: symbol pthread_ version GLIBC_2.4 not defined in file libpthread.so.0 with link time reference

and

>Bus error

and

>Aborted

Later I've add my app to daemon mode and this time I can see sth in syslog:

> Jul 17 08:30:51 raspberrypi systemd[1]: myApp.service: Main process exited code=killed status=6/ABRT
> Jul 17 08:30:51 raspberrypi systemd[1]: myApp.service: Unit entered failed state.
> Jul 17 08:30:51 raspberrypi systemd[1]: myApp.service: Failed with result 'signal'.
> Jul 17 08:31:01 raspberrypi systemd[1]: myApp.service: Service hold-off time over scheduling restart.

I've logged the performance counters all the way can see the CPU and memory are all stable.
I've tried followed the [enable core dump on linux](http://blogs.microsoft.co.il/sasha/2017/02/26/analyzing-a-net-core-core-dump-on-linux/) but could never see any dump files generated please help.",arch-arm32,AaronRobinsonMSFT,17/07/2018 17:27,15/01/2019 4:56
18953,Enable the no tiered compilation innerloop PR legs,Also using this PR to manually trigger test jobs. Marking no merge until manual testing is complete.,Enable the no tiered compilation innerloop PR legs Also using this PR to manually trigger test jobs. Marking no merge until manual testing is complete.,area-TieredCompilation,noahfalk,17/07/2018 12:09,20/07/2018 9:36
18951,[WIP] dummy change in dev/unix_test_workflow,,[WIP] dummy change in dev/unix_test_workflow ,* NO MERGE *,BruceForstall,17/07/2018 9:23,25/07/2018 4:39
18946,Update NativeCallable attribute tests,"Fix tests for the NativeCallableAttribute. #18906 

cc @jkotas @luqunl ","Update NativeCallable attribute tests Fix tests for the NativeCallableAttribute. #18906 

cc @jkotas @luqunl ",area-Interop,jkotas,17/07/2018 7:32,18/07/2018 4:12
18945,Assertion failure on Unixes in JIT/SIMD/VectorExp_ro with tiering enabled,.,Assertion failure on Unixes in JIT/SIMD/VectorExp_ro with tiering enabled .,area-CodeGen,kouvel,17/07/2018 5:38,27/07/2018 8:39
18944,LSRA: Consider a stress mode that trashes registers,"The issue https://github.com/dotnet/coreclr/issues/18943 is a case where it appears a register is being incorrectly copied to the wrong register before its intended use. If we had a  mode that would write some trash value to each register when it goes dead a case like this might have been caught.

category:implementation
theme:register-allocator
skill-level:beginner
cost:small","LSRA: Consider a stress mode that trashes registers The issue https://github.com/dotnet/coreclr/issues/18943 is a case where it appears a register is being incorrectly copied to the wrong register before its intended use. If we had a  mode that would write some trash value to each register when it goes dead a case like this might have been caught.

category:implementation
theme:register-allocator
skill-level:beginner
cost:small",area-CodeGen,CarolEidt,17/07/2018 5:37,
18943,Inconsistent reg assignment for tailcall Stub Addr Arg, is apparently unnecessary.,Inconsistent reg assignment for tailcall Stub Addr Arg  is apparently unnecessary.,arch-x64,AndyAyersMS,,
18937,Assert failure in JIT.Methodical.xxobj.ldobj._il_relldobj_V._il_relldobj_V 'arg0VN == VNNormVal(arg0VN)',"Found this regression introduced between [Build #9949 (Jul 13 2018 11:03:21 AM)](https://ci.dot.net/job/dotnet_coreclr/job/master/view/Windows_NT/job/checked_windows_nt/9949/) and [Build #9950 (Jul 13 2018 1:21:43 PM)](https://ci.dot.net/job/dotnet_coreclr/job/master/view/Windows_NT/job/checked_windows_nt/9950/) which corresponds to 

Changes: 
1. JIT: optimize some cases of unused structs (#18819) (commit: dc7492e)

Reproduced on Windows and Linux x64 and arm","Assert failure in JIT.Methodical.xxobj.ldobj._il_relldobj_V._il_relldobj_V 'arg0VN == VNNormVal(arg0VN)' Found this regression introduced between [Build #9949 (Jul 13 2018 11:03:21 AM)](https://ci.dot.net/job/dotnet_coreclr/job/master/view/Windows_NT/job/checked_windows_nt/9949/) and [Build #9950 (Jul 13 2018 1:21:43 PM)](https://ci.dot.net/job/dotnet_coreclr/job/master/view/Windows_NT/job/checked_windows_nt/9950/) which corresponds to 

Changes: 
1. JIT: optimize some cases of unused structs (#18819) (commit: dc7492e)

Reproduced on Windows and Linux x64 and arm",area-CodeGen,pgavlin,17/07/2018 2:35,17/07/2018 11:48
18934,[JIT] Emitted bounds check comparing a constant index against a constant length,"From #18926 the JIT mostly does an impressively good job of optimizing this code:


That... seems like a rather easy bounds check to cut out.

category:cq
theme:bounds-checks
skill-level:intermediate
cost:small","[JIT] Emitted bounds check comparing a constant index against a constant length From #18926 the JIT mostly does an impressively good job of optimizing this code:


That... seems like a rather easy bounds check to cut out.

category:cq
theme:bounds-checks
skill-level:intermediate
cost:small",area-CodeGen,AndyAyersMS,17/07/2018 2:07,
18926,Hardware Intrinsics: Reading out SSE vector values without unsafe or Sse4.1?,Loading values into a Vector128<> is easy enough lots of safe options there. But my options seem rather limited when it comes to reading them back out again... the only choices I've found are  pointer parameter. Is there any safe option that doesn't affect minimum hardware requirements?,Hardware Intrinsics: Reading out SSE vector values without unsafe or Sse4.1? Loading values into a Vector128<> is easy enough lots of safe options there. But my options seem rather limited when it comes to reading them back out again... the only choices I've found are  pointer parameter. Is there any safe option that doesn't affect minimum hardware requirements?,area-System.Runtime,AaronRobinsonMSFT,16/07/2018 5:36,9/12/2018 18:42
18925,Hardware Intrinsics:  Non-volatile xmm regs unnecessarily spilled to stack,"Even though my code only actually needs a total of 4 SSE registers in some cases the JIT is deciding to use 
Full code: [SpanXxHash32.cs.txt](https://github.com/dotnet/coreclr/files/2195999/SpanXxHash32.cs.txt)

","Hardware Intrinsics:  Non-volatile xmm regs unnecessarily spilled to stack Even though my code only actually needs a total of 4 SSE registers in some cases the JIT is deciding to use 
Full code: [SpanXxHash32.cs.txt](https://github.com/dotnet/coreclr/files/2195999/SpanXxHash32.cs.txt)

",area-CodeGen,CarolEidt,16/07/2018 4:54,17/07/2018 3:17
18920,Clean coreclr build incurs ~100 warnings from R2RDump.csproj,,Clean coreclr build incurs ~100 warnings from R2RDump.csproj ,area-ReadyToRun,AaronRobinsonMSFT,15/07/2018 13:05,27/07/2018 4:19
18914,[Windows/arm64] corefx System.Runtime.Tests test failure,"Happens in baseline and all JIT stress runs.



e.g. https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm64_cross_checked_windows_nt_corefx_baseline_tst_prtest/3/consoleText
","[Windows/arm64] corefx System.Runtime.Tests test failure Happens in baseline and all JIT stress runs.



e.g. https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm64_cross_checked_windows_nt_corefx_baseline_tst_prtest/3/consoleText
",arch-arm64,sandreenko,,
18913,[arm64] corefx System.ComponentModel.Composition.Tests failure,"While scouting Windows arm64 corefx testing: https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm64_cross_checked_windows_nt_corefx_baseline_tst_prtest/3/consoleText




Remove exclusion from arm64\corefx_test_exclusions.txt when fixed.
","[arm64] corefx System.ComponentModel.Composition.Tests failure While scouting Windows arm64 corefx testing: https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm64_cross_checked_windows_nt_corefx_baseline_tst_prtest/3/consoleText




Remove exclusion from arm64\corefx_test_exclusions.txt when fixed.
",arch-arm64,sandreenko,,
18912,System.Text.RegularExpressions.Tests JitMinOpts only timeout,"

Related: https://github.com/dotnet/coreclr/issues/17754

category:testing
theme:minopts
skill-level:intermediate
cost:medium","System.Text.RegularExpressions.Tests JitMinOpts only timeout 

Related: https://github.com/dotnet/coreclr/issues/17754

category:testing
theme:minopts
skill-level:intermediate
cost:medium",area-CodeGen,BruceForstall,14/07/2018 8:33,
18910,Add all integer overloads for Avx2.BlendVariable,"Now we only have the ) will significantly improve the user experience.

cc @tannergooding @CarolEidt @eerhardt ","Add all integer overloads for Avx2.BlendVariable Now we only have the ) will significantly improve the user experience.

cc @tannergooding @CarolEidt @eerhardt ",area-CodeGen,tannergooding,14/07/2018 7:43,21/09/2018 6:42
18908,Add tests for DECIMAL PInvoke marshaling,"https://github.com/dotnet/coreclr/pull/18868#discussion_r202166213
https://github.com/dotnet/corert/issues/4994","Add tests for DECIMAL PInvoke marshaling https://github.com/dotnet/coreclr/pull/18868#discussion_r202166213
https://github.com/dotnet/corert/issues/4994",area-Interop,jkotas,14/07/2018 4:57,17/11/2018 11:25
18907,[Linux/arm32][GCStress=0xc] RuntimeEventSourceTest 'listener.EventCount > 0' Assertion Failure,"All the recent Ubuntu arm32 GCStress=0xc runs failed the same way in recently added RuntimeEventSourceTest in #18649 

 added in #18911","[Linux/arm32][GCStress=0xc] RuntimeEventSourceTest 'listener.EventCount > 0' Assertion Failure All the recent Ubuntu arm32 GCStress=0xc runs failed the same way in recently added RuntimeEventSourceTest in #18649 

 added in #18911",GCStress,echesakovMSFT,14/07/2018 4:35,28/02/2019 8:43
18906,Improve NativeCallable tests,"Some of the cases in the [ should be covered.

cc @jaredpar @jeffschwMSFT @luqunl ","Improve NativeCallable tests Some of the cases in the [ should be covered.

cc @jaredpar @jeffschwMSFT @luqunl ",area-Interop,AaronRobinsonMSFT,,
18904,Add prefix to DAC's PAL exports for alpine,"Added some cmake logic to create assembly include mapping files. One that maps the
prefixed name (DAC_foo) to the actual name (foo) which is included in the DAC module
and another that maps the actual name to the prefixed name that is included in the SOS
DBI and createdump modules.

The data exports like IID_IUnknown are not prefixed and don't need to be (immutable static data).

There were some C++ exports functions exported with their decorated names in
the CatchHardwareExceptionHolder and NativeExceptionHolderBase classes. Created
PAL_* style export functions that implements the code.

Fix lldb plugin cmake file to use LLDB_H/LLDB_LIB env vars to build it.","Add prefix to DAC's PAL exports for alpine Added some cmake logic to create assembly include mapping files. One that maps the
prefixed name (DAC_foo) to the actual name (foo) which is included in the DAC module
and another that maps the actual name to the prefixed name that is included in the SOS
DBI and createdump modules.

The data exports like IID_IUnknown are not prefixed and don't need to be (immutable static data).

There were some C++ exports functions exported with their decorated names in
the CatchHardwareExceptionHolder and NativeExceptionHolderBase classes. Created
PAL_* style export functions that implements the code.

Fix lldb plugin cmake file to use LLDB_H/LLDB_LIB env vars to build it.",area-Diagnostics,mikem8361,,
18903,"Assembly.LoadFrom(""System.Threading.Tasks.Extensions.dll"") fails with FileLoadException","We (PostSharp) noticed a weird behavior of .NET Core CLR and are asking for clarifications so we can implement a proper solution.

Consider the following program:

 file and include any assembly that we need to load at runtime but that are not a build-time dependency.

Could you please spread some light on this situation?

Thank you.

-gael
","Assembly.LoadFrom(""System.Threading.Tasks.Extensions.dll"") fails with FileLoadException We (PostSharp) noticed a weird behavior of .NET Core CLR and are asking for clarifications so we can implement a proper solution.

Consider the following program:

 file and include any assembly that we need to load at runtime but that are not a build-time dependency.

Could you please spread some light on this situation?

Thank you.

-gael
",area-AssemblyLoader,jeffschwMSFT,14/07/2018 2:03,17/07/2018 2:52
18901,WIP Fix bit-rot when '#define MEASURE_CLRAPI_CALLS' is used,When I was writing [.NET JIT and CLR - Joined at the Hip](http://mattwarren.org/2018/07/05/.NET-JIT-and-CLR-Joined-at-the-Hip/) I noticed that the JIT wrapper apis had got out of sync although it's only noticeable with  I just wanted to make sure all the builds passed first (hence WIP).,WIP Fix bit-rot when '#define MEASURE_CLRAPI_CALLS' is used When I was writing [.NET JIT and CLR - Joined at the Hip](http://mattwarren.org/2018/07/05/.NET-JIT-and-CLR-Joined-at-the-Hip/) I noticed that the JIT wrapper apis had got out of sync although it's only noticeable with  I just wanted to make sure all the builds passed first (hence WIP).,area-CodeGen,pkukol,14/07/2018 0:10,5/10/2019 9:16
18900,Implement GetComObjectData and SetComObjectData,Contributes to https://github.com/dotnet/corefx/issues/31015,Implement GetComObjectData and SetComObjectData Contributes to https://github.com/dotnet/corefx/issues/31015,area-Interop,AaronRobinsonMSFT,13/07/2018 20:43,19/07/2018 13:29
18898,Test failure: CoreMangLib_cti._system_guid_GuidEquals2_GuidEquals2_/_system_guid_GuidEquals2_GuidEquals2_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.

mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    
    cmdLine:/home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Work/0316fdb5-17c7-4801-9101-89b220f9360a/Unzip/system/guid/GuidEquals2/GuidEquals2.sh Timed Out
    
    
    Return code:      -100
    Raw output file:      /home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Work/0316fdb5-17c7-4801-9101-89b220f9360a/Unzip/Reports\\CoreMangLib.cti\\system\\guid\\GuidEquals2\\GuidEquals2.output.txt
    Raw output:
    BEGIN EXECUTION
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    
    cmdLine:/home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Work/0316fdb5-17c7-4801-9101-89b220f9360a/Unzip/system/guid/GuidEquals2/GuidEquals2.sh Timed Out
    Test Harness Exitcode is : -100
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Payload
    > /home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Work/0316fdb5-17c7-4801-9101-89b220f9360a/Unzip/system/guid/GuidEquals2/GuidEquals2.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180712.06 (Ready-To-Run Tests)
Failing configurations:
- ubuntu.1710.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180712.06/workItem/CoreMangLib.cti.XUnitWrapper/analysis/xunit/CoreMangLib_cti._system_guid_GuidEquals2_GuidEquals2_~2F_system_guid_GuidEquals2_GuidEquals2_cmd","Test failure: CoreMangLib_cti._system_guid_GuidEquals2_GuidEquals2_/_system_guid_GuidEquals2_GuidEquals2_cmd Opened on behalf of @Sunny-pu

The test  has failed.

mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    mkdir: cannot create directory ‘lock’: File exists
    
    cmdLine:/home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Work/0316fdb5-17c7-4801-9101-89b220f9360a/Unzip/system/guid/GuidEquals2/GuidEquals2.sh Timed Out
    
    
    Return code:      -100
    Raw output file:      /home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Work/0316fdb5-17c7-4801-9101-89b220f9360a/Unzip/Reports\\CoreMangLib.cti\\system\\guid\\GuidEquals2\\GuidEquals2.output.txt
    Raw output:
    BEGIN EXECUTION
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    in takeLock
    
    cmdLine:/home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Work/0316fdb5-17c7-4801-9101-89b220f9360a/Unzip/system/guid/GuidEquals2/GuidEquals2.sh Timed Out
    Test Harness Exitcode is : -100
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Payload
    > /home/helixbot/dotnetbuild/work/c0463900-787c-47e6-bdc5-f2cc35669145/Work/0316fdb5-17c7-4801-9101-89b220f9360a/Unzip/system/guid/GuidEquals2/GuidEquals2.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180712.06 (Ready-To-Run Tests)
Failing configurations:
- ubuntu.1710.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180712.06/workItem/CoreMangLib.cti.XUnitWrapper/analysis/xunit/CoreMangLib_cti._system_guid_GuidEquals2_GuidEquals2_~2F_system_guid_GuidEquals2_GuidEquals2_cmd",area-ReadyToRun,RussKeldorph,13/07/2018 17:16,24/05/2019 7:35
18895,[arm64] Assertion failed '(allRegs(theInterval->registerType) & mask) != 0',"Running JIT\HardwareIntrinsics\Arm64\Simd\Simd.cmd test:



e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm64_cross_debug_windows_nt_tst/566
","[arm64] Assertion failed '(allRegs(theInterval->registerType) & mask) != 0' Running JIT\HardwareIntrinsics\Arm64\Simd\Simd.cmd test:



e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm64_cross_debug_windows_nt_tst/566
",arch-arm64,sandreenko,,
18894,Investigate: can we improve docs or diagnostics when 64 bit .NET Core app fails on Azure App Service,"@noahfalk commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1670)

This issue is forked from #1622 where @joseclament reported that he was getting an unexplained BadImageFormatException. The limitation from Azure App Service is by design but perhaps we could offer better guidance in docs or diagnostic error messages so that developers will more quickly discover the right path forward. Thanks @joseclament for raising the issue!

> @noahfalk  and @nil4  I got the bottom of the problem. It took couple of days to get the bottom of the issue and made me bit nut. I was able to dig and find this link: https://tutel.me/c/programming/questions/42726350/how+to+change+azure+app+service+to+64bit
> 
> Your core should be built on x86 version even if the deploying server(Azure) is based on 64 bit architecture. Because the 64 bit .NET core processes using the .NET core runtime (as opposed to the .NET Framework runtime) are not yet supported on Azure but is planned to be coming in the future. You can verify this by go to the kudu and type  dotnet --info. You can see something like this below:
> 
> .NET Core SDK (reflecting any global.json):
>  Version:   2.1.300
>  Commit:    32f29b6eb9
> 
> Runtime Environment:
>  OS Name:     Windows
>  OS Version:  10.0.14393
>  OS Platform: Windows
>  RID:         win10-x86
>  _Base Path:   D:\Program Files (x86)\dotnet\sdk\2.1.300\_ [**You  can see only the x86 version here**]
> 
> Host (useful for support):
>   Version: 2.1.0
>   Commit:  caa7b7e2ba
> 
> .NET Core SDKs installed:
>   1.1.8 [D:\Program Files (x86)\dotnet\sdk]
>   2.1.101 [D:\Program Files (x86)\dotnet\sdk]
>   2.1.300 [D:\Program Files (x86)\dotnet\sdk]
> 
> You may be able to debug this locally ""Any CPU"" option as you might have x86 and x64 based libraries installed on your machine. I could not find any documentation on MSDN about this. I was assumed it would have been automatically support x64 version. Also make sure that the application setting is enabled for the ""32"" bit.
> 


---

@bcisnero commented on [Fri Jun 08 2018](https://github.com/dotnet/core/issues/1670#issuecomment-395922622)

Probably a fast solution to this will be to add a note in the document explaining just what are the Azure limitations and the the workaround at this point because and this is going to change at some point in the future.

","Investigate: can we improve docs or diagnostics when 64 bit .NET Core app fails on Azure App Service @noahfalk commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1670)

This issue is forked from #1622 where @joseclament reported that he was getting an unexplained BadImageFormatException. The limitation from Azure App Service is by design but perhaps we could offer better guidance in docs or diagnostic error messages so that developers will more quickly discover the right path forward. Thanks @joseclament for raising the issue!

> @noahfalk  and @nil4  I got the bottom of the problem. It took couple of days to get the bottom of the issue and made me bit nut. I was able to dig and find this link: https://tutel.me/c/programming/questions/42726350/how+to+change+azure+app+service+to+64bit
> 
> Your core should be built on x86 version even if the deploying server(Azure) is based on 64 bit architecture. Because the 64 bit .NET core processes using the .NET core runtime (as opposed to the .NET Framework runtime) are not yet supported on Azure but is planned to be coming in the future. You can verify this by go to the kudu and type  dotnet --info. You can see something like this below:
> 
> .NET Core SDK (reflecting any global.json):
>  Version:   2.1.300
>  Commit:    32f29b6eb9
> 
> Runtime Environment:
>  OS Name:     Windows
>  OS Version:  10.0.14393
>  OS Platform: Windows
>  RID:         win10-x86
>  _Base Path:   D:\Program Files (x86)\dotnet\sdk\2.1.300\_ [**You  can see only the x86 version here**]
> 
> Host (useful for support):
>   Version: 2.1.0
>   Commit:  caa7b7e2ba
> 
> .NET Core SDKs installed:
>   1.1.8 [D:\Program Files (x86)\dotnet\sdk]
>   2.1.101 [D:\Program Files (x86)\dotnet\sdk]
>   2.1.300 [D:\Program Files (x86)\dotnet\sdk]
> 
> You may be able to debug this locally ""Any CPU"" option as you might have x86 and x64 based libraries installed on your machine. I could not find any documentation on MSDN about this. I was assumed it would have been automatically support x64 version. Also make sure that the application setting is enabled for the ""32"" bit.
> 


---

@bcisnero commented on [Fri Jun 08 2018](https://github.com/dotnet/core/issues/1670#issuecomment-395922622)

Probably a fast solution to this will be to add a note in the document explaining just what are the Azure limitations and the the workaround at this point because and this is going to change at some point in the future.

",area-Diagnostics,noahfalk,13/07/2018 7:48,
18893,createdump is missing on ARM and ARM64,"X86 runtime has utility 
","createdump is missing on ARM and ARM64 X86 runtime has utility 
",arch-arm32,hoyosjs,,
18889,sosplugin is not working on ARM,"
I tested this in my RP3 as well as Ubuntu on Qemu. I'm not even  able to get list of commands. 


","sosplugin is not working on ARM 
I tested this in my RP3 as well as Ubuntu on Qemu. I'm not even  able to get list of commands. 


",arch-arm32,mikem8361,,
18886,ARM64 corefx test failures,"The following tests fail in corefx CI runs and have been disabled. There are some similar failures for ARM in #16001.

E.g. https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm64_cross_checked_windows_nt_corefx_baseline_tst_prtest/2/consoleText

","ARM64 corefx test failures The following tests fail in corefx CI runs and have been disabled. There are some similar failures for ARM in #16001.

E.g. https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm64_cross_checked_windows_nt_corefx_baseline_tst_prtest/2/consoleText

",arch-arm64,sandreenko,,
18885,ILDASM - Wrong exit code,"I'm using ILDASM to inspect all files in a folder (project build output) and in somes cases i have configuration/text files. In those edge cases i caught a bug although i received an exit code 0 the process output was ""Image is either too small or contains an invalid byte offset or count.\n"". According to the process output i was expecting to receive an exit 1.

I'm migrating to this version of ILDASM (before i was using https://docs.microsoft.com/en-us/dotnet/framework/tools/ildasm-exe-il-disassembler) because i couldn't run in Docker container with mono.","ILDASM - Wrong exit code I'm using ILDASM to inspect all files in a folder (project build output) and in somes cases i have configuration/text files. In those edge cases i caught a bug although i received an exit code 0 the process output was ""Image is either too small or contains an invalid byte offset or count.\n"". According to the process output i was expecting to receive an exit 1.

I'm migrating to this version of ILDASM (before i was using https://docs.microsoft.com/en-us/dotnet/framework/tools/ildasm-exe-il-disassembler) because i couldn't run in Docker container with mono.",area-CodeGen,AaronRobinsonMSFT,,
18884,RyuJIT fails to preserve variable allocated to RCX around shift on x64 in release,"On Linux the following example prints a weird result:


It repros on Windows as well (see next comment).","RyuJIT fails to preserve variable allocated to RCX around shift on x64 in release On Linux the following example prints a weird result:


It repros on Windows as well (see next comment).",area-CodeGen,CarolEidt,,
18877,[RyuJIT] Ensure all the VEX.vvvv instructions in IsDstDstSrc/DstSrcSrcAVXInstruction,"Logging the conversation https://github.com/dotnet/coreclr/pull/18876#pullrequestreview-136452081

We should double check that all the instructions that use .","[RyuJIT] Ensure all the VEX.vvvv instructions in IsDstDstSrc/DstSrcSrcAVXInstruction Logging the conversation https://github.com/dotnet/coreclr/pull/18876#pullrequestreview-136452081

We should double check that all the instructions that use .",area-CodeGen,CarolEidt,,
18873,Add prefix to DAC's PAL exports for alpine,"Added some cmake logic to create assembly include mapping files. One that maps the
prefixed name (DAC_foo) to the actual name (foo) which is included in the DAC module
and another that maps the actual name to the prefixed name that is included in the SOS
DBI and createdump modules.

The data exports like IID_IUnknown are not prefixed and don't need to be (immutable static data).

There were some C++ exports functions exported with their decorated names in
the CatchHardwareExceptionHolder and NativeExceptionHolderBase classes. Created
PAL_* style export functions that implements the code.

Fix lldb plugin cmake file to use LLDB_H/LLDB_LIB env vars to build it.","Add prefix to DAC's PAL exports for alpine Added some cmake logic to create assembly include mapping files. One that maps the
prefixed name (DAC_foo) to the actual name (foo) which is included in the DAC module
and another that maps the actual name to the prefixed name that is included in the SOS
DBI and createdump modules.

The data exports like IID_IUnknown are not prefixed and don't need to be (immutable static data).

There were some C++ exports functions exported with their decorated names in
the CatchHardwareExceptionHolder and NativeExceptionHolderBase classes. Created
PAL_* style export functions that implements the code.

Fix lldb plugin cmake file to use LLDB_H/LLDB_LIB env vars to build it.",area-Diagnostics,mikem8361,,
18872,Suspicious move possible use after move?,"I think there might be a use after move in  might have been moved just before its use.

category:implementation
theme:jit-coding-style
skill-level:beginner
cost:small","Suspicious move, possible use after move? I think there might be a use after move in  might have been moved just before its use.

category:implementation
theme:jit-coding-style
skill-level:beginner
cost:small",area-CodeGen,AaronRobinsonMSFT,12/07/2018 6:37,
18869,LclVar sorting throughput improvements,"Follow-up from #18504 discussion. There are a few inefficiencies around lclvar sorting ( lclvars need be. A partial sort algorithm could be beneficial in those cases where the JIT internally generates large number of lclvars (I think there was an issue with like 10000 lclvars). But such cases seem to be rare in corelib there are only a couple of methods with ~600 lclvars and the rest are below 512.
* Do we actually need to sort the lclvars? Or is it enough to just take the top 512 lclvars in no particular order? It's obvious that as far as liveness is concerned the order of the tracked variables is irrelevant. So far I only found a case (CSE heuristic) that appears to depend on the order.
","LclVar sorting throughput improvements Follow-up from #18504 discussion. There are a few inefficiencies around lclvar sorting ( lclvars need be. A partial sort algorithm could be beneficial in those cases where the JIT internally generates large number of lclvars (I think there was an issue with like 10000 lclvars). But such cases seem to be rare in corelib there are only a couple of methods with ~600 lclvars and the rest are below 512.
* Do we actually need to sort the lclvars? Or is it enough to just take the top 512 lclvars in no particular order? It's obvious that as far as liveness is concerned the order of the tracked variables is irrelevant. So far I only found a case (CSE heuristic) that appears to depend on the order.
",JitThroughput,AndyAyersMS,12/07/2018 4:03,14/09/2019 0:45
18867,RyuJIT spills 16 bit value but reloads as 32 bits in ARM32/x86 in release,"For ARM32 the example is:
","RyuJIT spills 16 bit value but reloads as 32 bits in ARM32/x86 in release For ARM32 the example is:
",area-CodeGen,RussKeldorph,11/07/2018 21:51,27/11/2018 11:31
18865,"""SIGSEGV: address access protected"" on Debian 9","Unfortunately I don't have a consistent repro of this problem and only have had this happen very rarely where the app aborted with no info. Last night I started it in lldb and left it running over night and it crashed with ""address access protected"".



Unfortunately it seems there's no debug symbols loaded so the stacktrace seems rather unhelpful. What would be my next step here?","""SIGSEGV: address access protected"" on Debian 9 Unfortunately I don't have a consistent repro of this problem and only have had this happen very rarely where the app aborted with no info. Last night I started it in lldb and left it running over night and it crashed with ""address access protected"".



Unfortunately it seems there's no debug symbols loaded so the stacktrace seems rather unhelpful. What would be my next step here?",area-CodeGen,AndyAyersMS,,
18864,Add no tiered compilation test jobs,"With the upcoming switch to make tiered compilation on by default we want to preserve some JIT testing that will not enable tiered compilation.
1) Add 'no_tiered_compilation_pri0' jit stress job logically the non-tiered variant of current 'Innerloop' jobs
   - This job runs on all PRs for Checked x (Windows x86 Windows x64 Ubuntu arm)
2) Add 'no_tiered_compilation' jit stress job logically the non-tiered variant of the current 'normal' job
   - This job has the same periodic schedule as other jit stress jobs
3) Add 'r2r_no_tiered_compilation' r2r stress job logically the non-tiered variant of the current 'r2r' job
   - This job has the same periodic schedule as other r2r stress jobs

Misc adjustments:
a) Added isPri0TestScenario because 'innerloop' is no longer the only scenario name which has this property + eliminated various comments that implied 'innerloop' IFF pri0
b) updated the contxtString generation for arm jobs to make it more consistent with the naming computed for other architectures

This is a continuation of the work that started in #18828","Add no tiered compilation test jobs With the upcoming switch to make tiered compilation on by default we want to preserve some JIT testing that will not enable tiered compilation.
1) Add 'no_tiered_compilation_pri0' jit stress job logically the non-tiered variant of current 'Innerloop' jobs
   - This job runs on all PRs for Checked x (Windows x86 Windows x64 Ubuntu arm)
2) Add 'no_tiered_compilation' jit stress job logically the non-tiered variant of the current 'normal' job
   - This job has the same periodic schedule as other jit stress jobs
3) Add 'r2r_no_tiered_compilation' r2r stress job logically the non-tiered variant of the current 'r2r' job
   - This job has the same periodic schedule as other r2r stress jobs

Misc adjustments:
a) Added isPri0TestScenario because 'innerloop' is no longer the only scenario name which has this property + eliminated various comments that implied 'innerloop' IFF pri0
b) updated the contxtString generation for arm jobs to make it more consistent with the naming computed for other architectures

This is a continuation of the work that started in #18828",area-TieredCompilation,kouvel,11/07/2018 14:31,17/07/2018 6:48
18863,JIT Hints- Parameter conditional inlining directives or improve call-site inlining of funcs with constant args feeding structs,"In dotnet/corefx#30934 we have this code:

 to give more nuance to the JIT hints.

category:cq
theme:inlining
skill-level:expert
cost:extra-large","JIT Hints- Parameter conditional inlining directives, or, improve call-site inlining of funcs with constant args feeding structs In dotnet/corefx#30934 we have this code:

 to give more nuance to the JIT hints.

category:cq
theme:inlining
skill-level:expert
cost:extra-large",area-CodeGen,AndyAyersMS,11/07/2018 14:24,
18859,GS cookie check fix for debugger stackwalks port,"This bug fix is a port from the equivalent fix in framework. The debugger tried performing a stackwalk in the epilog due to the JIT incorrectly reporting epilogue information. This caused an invalid GS cookie to be checked and caused the debugger to crash. A flag was added to allow debug stackwalks to skip the cookie check.

@noahfalk @sbomer","GS cookie check fix for debugger stackwalks port This bug fix is a port from the equivalent fix in framework. The debugger tried performing a stackwalk in the epilog due to the JIT incorrectly reporting epilogue information. This caused an invalid GS cookie to be checked and caused the debugger to crash. A flag was added to allow debug stackwalks to skip the cookie check.

@noahfalk @sbomer",area-Diagnostics,hoyosjs,,
18858,[OSX] JIT/HardwareIntrinsics/X86/Avx/Avx_ro Intermittent failures,"The following test failure

happened in different PRs over the last couple days
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4002/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4019/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4020/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4021/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4025/

The earlies I could track it was [Build #4002 (Jul 9 2018 8:10:43 PM)](https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4002/)


Seems that problem always occurs right after *Running Extract.Byte.1 test...* message","[OSX] JIT/HardwareIntrinsics/X86/Avx/Avx_ro Intermittent failures The following test failure

happened in different PRs over the last couple days
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4002/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4019/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4020/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4021/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4025/

The earlies I could track it was [Build #4002 (Jul 9 2018 8:10:43 PM)](https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_osx10.12_innerloop_tst_prtest/4002/)


Seems that problem always occurs right after *Running Extract.Byte.1 test...* message",arch-x64,echesakovMSFT,11/07/2018 7:26,21/07/2018 4:40
18855,The `perf.groovy` script is not escaping the PR title properly when it contains double-quotes,"This issue was causing failures in https://github.com/dotnet/coreclr/pull/18849

For example: https://ci2.dot.net/job/dotnet_coreclr/job/perf/job/master/job/perf_perflab_Windows_NT_x64_min_opt_ryujit_smoketest_prtest/2556/","The  script is not escaping the PR title properly when it contains double-quotes This issue was causing failures in https://github.com/dotnet/coreclr/pull/18849

For example: https://ci2.dot.net/job/dotnet_coreclr/job/perf/job/master/job/perf_perflab_Windows_NT_x64_min_opt_ryujit_smoketest_prtest/2556/",area-Infrastructure-coreclr,jorive,11/07/2018 5:52,24/05/2019 7:36
18852,coreclr Windows build broken in master branch with several compiler errors and MASM warnings,"Build of coreclr master branch dab0d7108e8b0091e1d7f526cab7dc9bcb71710a on Windows 10 x64 for Windows_NT x64 Checked target fails with the following errors:


Windows 10 Pro x64 PL with EN lang pack active version 1803","coreclr Windows build broken in master branch with several compiler errors and MASM warnings Build of coreclr master branch dab0d7108e8b0091e1d7f526cab7dc9bcb71710a on Windows 10 x64 for Windows_NT x64 Checked target fails with the following errors:


Windows 10 Pro x64 PL with EN lang pack active version 1803",area-Infrastructure-coreclr,AaronRobinsonMSFT,11/07/2018 2:29,11/07/2018 7:16
18850,Invalid value numbering when morphing casts that change signedness after global morph,"The example is


Details here: https://github.com/dotnet/coreclr/pull/18816#issuecomment-403649790","Invalid value numbering when morphing casts that change signedness after global morph The example is


Details here: https://github.com/dotnet/coreclr/pull/18816#issuecomment-403649790",area-CodeGen,erozenfeld,,
18847,Failed to initialize CoreCLR HRESULT: 0x80131500 (Ubuntu 18.04),"Error: 
[logfile.txt](https://github.com/dotnet/coreclr/files/2178758/logfile.txt)

Thanks.

# OS
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 18.04 LTS
Release:	18.04
Codename:	bionic
","Failed to initialize CoreCLR, HRESULT: 0x80131500 (Ubuntu 18.04) Error: 
[logfile.txt](https://github.com/dotnet/coreclr/files/2178758/logfile.txt)

Thanks.

# OS
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 18.04 LTS
Release:	18.04
Codename:	bionic
",os-linux,AaronRobinsonMSFT,10/07/2018 13:49,13/07/2018 2:16
18846,An assembly specified in the application dependencies manifest (Example.deps.json) was not found,"I am developing a web application using Asp.NET Core 2.1 on Visual Studio 17.7 the problem is when I publish the web app as a Framework-Dependent and I try to run the app on production machine I get this error message:



and I have also tried solutions in this github issue with no success:

https://github.com/dotnet/coreclr/issues/13542","An assembly specified in the application dependencies manifest (Example.deps.json) was not found I am developing a web application using Asp.NET Core 2.1 on Visual Studio 17.7 the problem is when I publish the web app as a Framework-Dependent and I try to run the app on production machine I get this error message:



and I have also tried solutions in this github issue with no success:

https://github.com/dotnet/coreclr/issues/13542",area-AssemblyLoader,AaronRobinsonMSFT,10/07/2018 13:47,12/07/2018 2:40
18843,Basic .NET client tests,"Adding basic testing for .NET client testing. see #18673. 

Removes some placeholder activation tests that will be added back in another PR.
Creates new native COM server - contract generated manually via TlbExp. See accompanying readme.md.
Creates a .NET client that tests marshaling of primitives (i.e. byte int array strings etc.)

Tests are only for Windows.
","Basic .NET client tests Adding basic testing for .NET client testing. see #18673. 

Removes some placeholder activation tests that will be added back in another PR.
Creates new native COM server - contract generated manually via TlbExp. See accompanying readme.md.
Creates a .NET client that tests marshaling of primitives (i.e. byte int array strings etc.)

Tests are only for Windows.
",area-Interop,AaronRobinsonMSFT,,
18842,Array bounds check is not eliminated if index passed by reference,"The x64 code generated for FastJsonParser.ReadNull using .NET Core v2.1.301 SDK generate following assembly instruction which include two almost identical array bound checks. If I modify program to pass offset parameter by value (not functionally correct) it will eliminate one of array bound checks correctly.



category:cq
theme:range-check
skill-level:expert
cost:medium","Array bounds check is not eliminated if index passed by reference The x64 code generated for FastJsonParser.ReadNull using .NET Core v2.1.301 SDK generate following assembly instruction which include two almost identical array bound checks. If I modify program to pass offset parameter by value (not functionally correct) it will eliminate one of array bound checks correctly.



category:cq
theme:range-check
skill-level:expert
cost:medium",area-CodeGen,AaronRobinsonMSFT,10/07/2018 9:21,
18841,Add Utf8String class,,Add Utf8String class ,area-System.Runtime,,,
18842,Array bounds check is not eliminated if index passed by reference,"The x64 code generated for FastJsonParser.ReadNull using .NET Core v2.1.301 SDK generate following assembly instruction which include two almost identical array bound checks. If I modify program to pass offset parameter by value (not functionally correct) it will eliminate one of array bound checks correctly.



category:cq
theme:range-check
skill-level:expert
cost:medium","Array bounds check is not eliminated if index passed by reference The x64 code generated for FastJsonParser.ReadNull using .NET Core v2.1.301 SDK generate following assembly instruction which include two almost identical array bound checks. If I modify program to pass offset parameter by value (not functionally correct) it will eliminate one of array bound checks correctly.



category:cq
theme:range-check
skill-level:expert
cost:medium",area-CodeGen,AaronRobinsonMSFT,10/07/2018 9:21,
18841,Add Utf8String class,,Add Utf8String class ,area-System.Runtime,,,
18842,Array bounds check is not eliminated if index passed by reference,"The x64 code generated for FastJsonParser.ReadNull using .NET Core v2.1.301 SDK generate following assembly instruction which include two almost identical array bound checks. If I modify program to pass offset parameter by value (not functionally correct) it will eliminate one of array bound checks correctly.



category:cq
theme:range-check
skill-level:expert
cost:medium","Array bounds check is not eliminated if index passed by reference The x64 code generated for FastJsonParser.ReadNull using .NET Core v2.1.301 SDK generate following assembly instruction which include two almost identical array bound checks. If I modify program to pass offset parameter by value (not functionally correct) it will eliminate one of array bound checks correctly.



category:cq
theme:range-check
skill-level:expert
cost:medium",area-CodeGen,AaronRobinsonMSFT,10/07/2018 9:21,
18841,Add Utf8String class,,Add Utf8String class ,area-System.Runtime,,,
18836,Consider adding a stress mode which prefers registers with different encoding characteristics,"On various architecturesthere exist registers that require different encoding characteristics. For example on x64 there are additional registers available () which require the use of the REX prefix (or a VEX-encoded instruction).

Given that these change how the instruction is encoded it would be beneficial if there was a stress-mode that would prefer these registers in order to help validate that the emitter has them properly handled.

category:testing
theme:emitter
skill-level:beginner
cost:small","Consider adding a stress mode which prefers registers with different encoding characteristics On various architecturesthere exist registers that require different encoding characteristics. For example on x64 there are additional registers available () which require the use of the REX prefix (or a VEX-encoded instruction).

Given that these change how the instruction is encoded it would be beneficial if there was a stress-mode that would prefer these registers in order to help validate that the emitter has them properly handled.

category:testing
theme:emitter
skill-level:beginner
cost:small",area-CodeGen,CarolEidt,10/07/2018 5:38,
18834,[WIP] Test build tools used in master,,[WIP] Test build tools used in master ,* NO MERGE *,BruceForstall,10/07/2018 4:09,7/08/2018 10:10
18833,Fix serialization type in NotFiniteNumberException,"Good news: This is the only serializable type that passes a different type than the value's type in.
Bad news: No bad news today :)","Fix serialization type in NotFiniteNumberException Good news: This is the only serializable type that passes a different type than the value's type in.
Bad news: No bad news today :)",area-System.Runtime,ViktorHofer,,
18831,HW intrinsics - PopCount() returns int/long while Leading/TrailingZeroCount() returns uint/ulong,"Is this difference in return type by design?
Also  when one has to shift the result obtained from 256-bit vector right for some reason","HW intrinsics - PopCount() returns int/long, while Leading/TrailingZeroCount() returns uint/ulong Is this difference in return type by design?
Also  when one has to shift the result obtained from 256-bit vector right for some reason",area-CodeGen,RussKeldorph,9/07/2018 18:21,18/09/2018 6:54
18829,[JIT] Redundant Span<> bounds check not elided for fields in ref structs,"From my review of various issues around bounds checks the length check here should be sufficient to elide the span's bounds check:


category:cq
theme:bounds-checks
skill-level:expert
cost:medium","[JIT] Redundant Span<> bounds check not elided for fields in ref structs From my review of various issues around bounds checks the length check here should be sufficient to elide the span's bounds check:


category:cq
theme:bounds-checks
skill-level:expert
cost:medium",area-CodeGen,AaronRobinsonMSFT,9/07/2018 11:17,
18827,Debugging Linux Apps - Dump Analysis Clarification,"I have hanging app on linux and was attempting to get take a memory dump... upon reading the docs for memory dump analysis I found nothing talking about mention **hung** **deadlocks** or **memory leaks**: they are mostly geared to crash analysis.

the way i see it there are 2 types of dumps: 
1. Crash (created by operating system/debugger event) for crash analysis
2. Live / On Demand (created by user) for memory lock hang analysis

I think this link needs to be updated to at least mention the second category of memory dump analysis is also possible  (and any deviation in steps required)

https://github.com/dotnet/coreclr/blob/master/Documentation/building/debugging-instructions.md

Example text from above link that should be modified:

 ?

The current wording seems to imply a 'separate utility' - but I can't find it in the (linux/arm) sdk

According to the following links it seems that it might be a seprate util or part of sos?

(Command Line Options)?
https://github.com/dotnet/coreclr/blob/master/Documentation/botr/xplat-minidump-generation.md

(SOS Plugin Command?)
https://github.com/dotnet/coreclr/blob/master/Documentation/building/debugging-instructions.md

Please Clarify the following:

1. Are dumps only able to be analyzed if they are created via lldb + sos ? 
2. What is 'create dump' utility and where is it?  (contradictory docs)
3. Update the above linked docs since they seem have no mention that memory dumps from 'live' processes are supported.
4. a quick how to guide for creating a dump of a live process would be nice if the steps vastly are different from crash dump analysis.

regarding item 1 - I attempted to create memory dumps using 'gcore' and load them in lldb but this just caused lldb to crash so i posted a bug with lldb and sought guidance on coreclr glitter for more input  

@karelz - also sent me the links above but I if you read my above notes: I think more clarity is needed to deal with the second class of dumps that I want to analyze on linux/arm hardware.



","Debugging Linux Apps - Dump Analysis Clarification I have hanging app on linux and was attempting to get take a memory dump... upon reading the docs for memory dump analysis I found nothing talking about mention **hung** **deadlocks** or **memory leaks**: they are mostly geared to crash analysis.

the way i see it there are 2 types of dumps: 
1. Crash (created by operating system/debugger event) for crash analysis
2. Live / On Demand (created by user) for memory lock hang analysis

I think this link needs to be updated to at least mention the second category of memory dump analysis is also possible  (and any deviation in steps required)

https://github.com/dotnet/coreclr/blob/master/Documentation/building/debugging-instructions.md

Example text from above link that should be modified:

 ?

The current wording seems to imply a 'separate utility' - but I can't find it in the (linux/arm) sdk

According to the following links it seems that it might be a seprate util or part of sos?

(Command Line Options)?
https://github.com/dotnet/coreclr/blob/master/Documentation/botr/xplat-minidump-generation.md

(SOS Plugin Command?)
https://github.com/dotnet/coreclr/blob/master/Documentation/building/debugging-instructions.md

Please Clarify the following:

1. Are dumps only able to be analyzed if they are created via lldb + sos ? 
2. What is 'create dump' utility and where is it?  (contradictory docs)
3. Update the above linked docs since they seem have no mention that memory dumps from 'live' processes are supported.
4. a quick how to guide for creating a dump of a live process would be nice if the steps vastly are different from crash dump analysis.

regarding item 1 - I attempted to create memory dumps using 'gcore' and load them in lldb but this just caused lldb to crash so i posted a bug with lldb and sought guidance on coreclr glitter for more input  

@karelz - also sent me the links above but I if you read my above notes: I think more clarity is needed to deal with the second class of dumps that I want to analyze on linux/arm hardware.



",area-Diagnostics,karelz,9/07/2018 6:46,23/02/2019 9:48
18826,LastIndexOf corner case fix when span is empty,"Fixes https://github.com/dotnet/corefx/pull/30896#discussion_r200843575

Thanks for spotting! I shouldn't have rushed fixing the initial issue.","LastIndexOf corner case fix when span is empty Fixes https://github.com/dotnet/corefx/pull/30896#discussion_r200843575

Thanks for spotting! I shouldn't have rushed fixing the initial issue.",area-System.Memory,ViktorHofer,,
18824,BinaryReader should also accept String as path filename for contructor,"Hello

following same comparison of 

Kind regards



https://github.com/dotnet/coreclr/blob/0fbd855e38bc3ec269479b5f6bf561dcfd67cbb6/src/System.Private.CoreLib/shared/System/IO/StreamReader.cs#L170

https://github.com/dotnet/coreclr/blob/26d4004e90f47036d6393222522cf529aa41c6bb/src/mscorlib/src/System/IO/BinaryReader.cs#L49

same for writer

https://github.com/dotnet/coreclr/blob/0fbd855e38bc3ec269479b5f6bf561dcfd67cbb6/src/System.Private.CoreLib/shared/System/IO/StreamWriter.cs#L132

https://github.com/dotnet/coreclr/blob/0fbd855e38bc3ec269479b5f6bf561dcfd67cbb6/src/System.Private.CoreLib/shared/System/IO/BinaryWriter.cs#L50","BinaryReader should also accept String as path filename for contructor Hello

following same comparison of 

Kind regards



https://github.com/dotnet/coreclr/blob/0fbd855e38bc3ec269479b5f6bf561dcfd67cbb6/src/System.Private.CoreLib/shared/System/IO/StreamReader.cs#L170

https://github.com/dotnet/coreclr/blob/26d4004e90f47036d6393222522cf529aa41c6bb/src/mscorlib/src/System/IO/BinaryReader.cs#L49

same for writer

https://github.com/dotnet/coreclr/blob/0fbd855e38bc3ec269479b5f6bf561dcfd67cbb6/src/System.Private.CoreLib/shared/System/IO/StreamWriter.cs#L132

https://github.com/dotnet/coreclr/blob/0fbd855e38bc3ec269479b5f6bf561dcfd67cbb6/src/System.Private.CoreLib/shared/System/IO/BinaryWriter.cs#L50",area-System.IO,AaronRobinsonMSFT,8/07/2018 5:25,10/07/2018 18:36
18823,Add EndOfStream property to BinaryReader,"Hello

I'm comparing saving/reading data using either 

Kind regards","Add EndOfStream property to BinaryReader Hello

I'm comparing saving/reading data using either 

Kind regards",area-System.IO,AaronRobinsonMSFT,8/07/2018 5:23,10/07/2018 18:57
18822,[RyuJIT] Seeing suboptimal codegen for various AVX HWIntrinsics,"The Windows calling convention marks the upper 128-bits of YMM6 through YMM15 as volatile/caller preserved. This can cause codegen issues when using 256-bit HWIntrinsics that are interspersed with other calls as the JIT must currently insert code to save/restore the upper bits.

It may be possible for the JIT to do something ""smart"" here to allow eliding the save/restore when the target call would not touch the registers.
* An example would be a general flag that indicates whether the method being called uses any XMM register which would allow the JIT to elide the save/restore entirely in some cases.
* A more complex example would be tracking individual XMM registers used.

However the JIT doing something ""smart"" may be expensive. This is also a case where simply refactoring the code may vastly improve codegen (if the calls can be made to no longer be interspersed). As such an analyzer may be able to help catch these cases as would profiling.

An example of this problem is the following code snippet:
* NOTE: This probably doesn't represent real world code where you would likely be operating on an entire array. A real world example of interspersed calls would likely involve helper methods that abstracts away the ARM vs x86 differences and which themselves use other hardware intrinsics


</details>

category:cq
theme:vector-codegen
skill-level:expert
cost:large","[RyuJIT] Seeing suboptimal codegen for various AVX HWIntrinsics The Windows calling convention marks the upper 128-bits of YMM6 through YMM15 as volatile/caller preserved. This can cause codegen issues when using 256-bit HWIntrinsics that are interspersed with other calls as the JIT must currently insert code to save/restore the upper bits.

It may be possible for the JIT to do something ""smart"" here to allow eliding the save/restore when the target call would not touch the registers.
* An example would be a general flag that indicates whether the method being called uses any XMM register which would allow the JIT to elide the save/restore entirely in some cases.
* A more complex example would be tracking individual XMM registers used.

However the JIT doing something ""smart"" may be expensive. This is also a case where simply refactoring the code may vastly improve codegen (if the calls can be made to no longer be interspersed). As such an analyzer may be able to help catch these cases as would profiling.

An example of this problem is the following code snippet:
* NOTE: This probably doesn't represent real world code where you would likely be operating on an entire array. A real world example of interspersed calls would likely involve helper methods that abstracts away the ARM vs x86 differences and which themselves use other hardware intrinsics


</details>

category:cq
theme:vector-codegen
skill-level:expert
cost:large",area-CodeGen,CarolEidt,8/07/2018 4:58,
18815,"[RyuJIT] Assert failure ""unexpected operand size"" when folding LCL_FLD into Avx.BlendVariable ","The assert failture happens


This bug is detected in the work of https://github.com/dotnet/coreclr/issues/17798 and .NET Core 2.1 works fine so it seems introduced by the recent containment change.

@tannergooding @CarolEidt ","[RyuJIT] Assert failure ""unexpected operand size"" when folding LCL_FLD into Avx.BlendVariable  The assert failture happens


This bug is detected in the work of https://github.com/dotnet/coreclr/issues/17798 and .NET Core 2.1 works fine so it seems introduced by the recent containment change.

@tannergooding @CarolEidt ",area-CodeGen,tannergooding,7/07/2018 9:45,11/07/2018 7:34
18810,Allow test projects to be SDK style,"This change updates the associated targets and props files in the test directory to allow the test csproj's to be built as SDK style projects alongside traditional style projects.

It does not yet upgrade any of the projects I'll submit a seperate batch of PRs for that so that these changes aren't lost in a ton of mechanical refactoring.

While these changes allow the csproj's to be upgraded there is still work to be done to allow depproj and ilproj's to be converted over to the new style. By allowing a mix of projects styles this change allows us to upgrade piece-meal rather than in a single big bang hopefully allowing us to easier figure out bugs if they arise. 

- Remove CodeTaskFactory:
  - Allows the projects to be built using the core version of msbuild/dotnet build
  - Converted to using msbuild property expansion instead
- Add directory.build.{propstargets}:
  - Currently we just import the dirs.props and targets but means SDK style projects don't need to explicitly include these files
   - We probably want to move all projects over to using these in the future but this keeps the changes smaller for now
- Specific code for SDK projects:
  - There are a several changes required to build an SDK project. This change guards them behind conditionals so that only the new style projects see them. When we get to the point that there are only new projects we can remove the guards (probably at the same time as ditching the dir.props)
- Reordered build targets:
  - Because SDK projects implicitly import the build targets we can no longer re-define the build targets unconditionally knowing they will likely be overwritten. 
  - Instead we move the overwritten targets to seperate files and include these conditionally based on properties. In this way there is always a build defined for SDK projects which can then be overwritten to do nothing as needed.","Allow test projects to be SDK style This change updates the associated targets and props files in the test directory to allow the test csproj's to be built as SDK style projects alongside traditional style projects.

It does not yet upgrade any of the projects I'll submit a seperate batch of PRs for that so that these changes aren't lost in a ton of mechanical refactoring.

While these changes allow the csproj's to be upgraded there is still work to be done to allow depproj and ilproj's to be converted over to the new style. By allowing a mix of projects styles this change allows us to upgrade piece-meal rather than in a single big bang hopefully allowing us to easier figure out bugs if they arise. 

- Remove CodeTaskFactory:
  - Allows the projects to be built using the core version of msbuild/dotnet build
  - Converted to using msbuild property expansion instead
- Add directory.build.{propstargets}:
  - Currently we just import the dirs.props and targets but means SDK style projects don't need to explicitly include these files
   - We probably want to move all projects over to using these in the future but this keeps the changes smaller for now
- Specific code for SDK projects:
  - There are a several changes required to build an SDK project. This change guards them behind conditionals so that only the new style projects see them. When we get to the point that there are only new projects we can remove the guards (probably at the same time as ditching the dir.props)
- Reordered build targets:
  - Because SDK projects implicitly import the build targets we can no longer re-define the build targets unconditionally knowing they will likely be overwritten. 
  - Instead we move the overwritten targets to seperate files and include these conditionally based on properties. In this way there is always a build defined for SDK projects which can then be overwritten to do nothing as needed.",test enhancement,chsienki,7/07/2018 5:11,20/07/2018 7:35
18809,Correct AssemblyLoadContext comment,#NAME?,"Correct AssemblyLoadContext comment - This existing comment appears to be incorrectly narrow.
- My testing validates this.",area-AssemblyLoader,jeffschwMSFT,7/07/2018 4:56,9/07/2018 7:56
18807,Remove System.Security.Cryptography.X509Certificates.Tests from exclusion list,"The troublesome machine  from Windows/arm tests exclusion list.

Closes #17801","Remove System.Security.Cryptography.X509Certificates.Tests from exclusion list The troublesome machine  from Windows/arm tests exclusion list.

Closes #17801",arch-arm32,echesakovMSFT,7/07/2018 2:30,14/07/2018 2:10
18791,Update certain Marshal APIs to match exception thrown on .NET Framework,See [corefx#30830](https://github.com/dotnet/corefx/issues/30830),Update certain Marshal APIs to match exception thrown on .NET Framework See [corefx#30830](https://github.com/dotnet/corefx/issues/30830),area-Interop,AaronRobinsonMSFT,6/07/2018 3:30,6/07/2018 7:29
18790,Enable COMPlus_GCHighMemPercent ENV,".NET Framework exposes COMPlus_GCHighMemPercent. This enables configuration of the GC for testing and other things. It is not enabled in Core but should be. Please expose it.

I was doing testing of Docker resource limits. This ENV could be used to determine if the current GC policy for Docker resource limits could be improved. The data suggests that this is the case.

Results of Docker resource limits experiment: https://gist.github.com/richlander/48bb0ad51a2406937b61bea01de7cf87

Please enable this in both 2.2 and 3.0 branches.","Enable COMPlus_GCHighMemPercent ENV .NET Framework exposes COMPlus_GCHighMemPercent. This enables configuration of the GC for testing and other things. It is not enabled in Core but should be. Please expose it.

I was doing testing of Docker resource limits. This ENV could be used to determine if the current GC policy for Docker resource limits could be improved. The data suggests that this is the case.

Results of Docker resource limits experiment: https://gist.github.com/richlander/48bb0ad51a2406937b61bea01de7cf87

Please enable this in both 2.2 and 3.0 branches.",area-GC,AaronRobinsonMSFT,6/07/2018 3:13,18/07/2018 8:13
18789,[Arm64/Linux] runtimeeventsource fails gcStress=0x2,"@brianrob The new test runtimeeventsource introduced recently is failing gcStress=0x2 consistently.  It also fails gcStress=0x1 occasionally.

Typical failure looks like this


","[Arm64/Linux] runtimeeventsource fails gcStress=0x2 @brianrob The new test runtimeeventsource introduced recently is failing gcStress=0x2 consistently.  It also fails gcStress=0x1 occasionally.

Typical failure looks like this


",area-Tracing,brianrob,6/07/2018 2:51,
18788,Core CLR Build-Tests definition is ignoring build failures,"There's a couple things going on here @RussKeldorph  @jashook FYI.

- ILAsm commands are (seemingly randomly) failing in the build
- Build-test.cmd does not successfully fail the VSTS Task phase it's in if it throws errors.

Build : Master - 20180705.05 (Product Build)
Failing configurations:
- Windows
  - Build-Tests-R2R-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180705.05/workItem/Orchestration/analysis/external/Link)","Core CLR Build-Tests definition is ignoring build failures There's a couple things going on here @RussKeldorph  @jashook FYI.

- ILAsm commands are (seemingly randomly) failing in the build
- Build-test.cmd does not successfully fail the VSTS Task phase it's in if it throws errors.

Build : Master - 20180705.05 (Product Build)
Failing configurations:
- Windows
  - Build-Tests-R2R-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180705.05/workItem/Orchestration/analysis/external/Link)",area-Infrastructure-coreclr,MattGal,6/07/2018 2:42,7/12/2018 6:08
18786,Sub-optimal codegen with C# `switch` statement handling for some simple cases,"The check for 


category:cq
theme:inlining
skill-level:intermediate
cost:medium","Sub-optimal codegen with C# 


category:cq
theme:inlining
skill-level:intermediate
cost:medium",area-CodeGen,RussKeldorph,5/07/2018 21:05,
18784,Add missing FlushInstructionCache to CommitGCStressInstructionUpdate,"It's my understanding that missing  and the issue is not reproducible anymore.

Fixes #17570","Add missing FlushInstructionCache to CommitGCStressInstructionUpdate It's my understanding that missing  and the issue is not reproducible anymore.

Fixes #17570",GCStress,echesakovMSFT,5/07/2018 13:48,24/07/2018 7:15
18780,RyuJIT incorrectly narrows value on ARM32/x86 in release,On ARM32 and x86 with .NET core 2.1 the following program prints  fixes it.,RyuJIT incorrectly narrows value on ARM32/x86 in release On ARM32 and x86 with .NET core 2.1 the following program prints  fixes it.,area-CodeGen,jakobbotsch,,
18779,General protection fault on Linux,"I'm running a pretty standard ASP.NET Core application in Kubernetes on the Google Cloud.  
I'm using self-contained deployment with the 

Which is expected under our current stress test but this should not cause the process to crash right?

How could I investigate what is causing this issue?","General protection fault on Linux I'm running a pretty standard ASP.NET Core application in Kubernetes on the Google Cloud.  
I'm using self-contained deployment with the 

Which is expected under our current stress test but this should not cause the process to crash right?

How could I investigate what is causing this issue?",area-Diagnostics,mikem8361,,
18777,"JIT alloc assert ""!s_pagePool.isPoolPage(page)"" running corefx tests in CI","https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_windows_nt_corefx_innerloop_prtest/388/consoleText
","JIT alloc assert ""!s_pagePool.isPoolPage(page)"" running corefx tests in CI https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_windows_nt_corefx_innerloop_prtest/388/consoleText
",area-CodeGen,mikedn,,
18772,Set ActivityId and RelatedActivityId on EventWrittenEventArgs for Native Events,,Set ActivityId and RelatedActivityId on EventWrittenEventArgs for Native Events ,area-Tracing,brianrob,4/07/2018 9:04,2/08/2018 4:41
18771,"Improve DateTime{Offset}.ParseExact{Multiple} performance for RFC1123 (""r"")","Significantly improves the performance of 

cc: @ahsonkhan @jkotas @pjanotti @joperezr 
Contributes to https://github.com/dotnet/corefx/issues/30612","Improve DateTime{Offset}.ParseExact{Multiple} performance for RFC1123 (""r"") Significantly improves the performance of 

cc: @ahsonkhan @jkotas @pjanotti @joperezr 
Contributes to https://github.com/dotnet/corefx/issues/30612",area-System.Runtime,ahsonkhan,4/07/2018 6:08,5/07/2018 11:38
18770,RyuJIT incorrectly reorders expression containing a CSE resulting in exception thrown in release,"The following example throws 

Some more information can be found in https://github.com/dotnet/coreclr/issues/18232#issuecomment-402198147.","RyuJIT incorrectly reorders expression containing a CSE, resulting in exception thrown in release The following example throws 

Some more information can be found in https://github.com/dotnet/coreclr/issues/18232#issuecomment-402198147.",area-CodeGen,RussKeldorph,4/07/2018 4:53,15/09/2018 9:58
18769,spmi: exclude methods using a file with saved md5 hashes.,Exclude methods are presented in a file with the same name as  length they should be separated with newlines or spaces if we find a value with incorrect length then we ignore this value.,spmi: exclude methods using a file with saved md5 hashes. Exclude methods are presented in a file with the same name as  length they should be separated with newlines or spaces if we find a value with incorrect length then we ignore this value.,area-Infrastructure-coreclr,sandreenko,4/07/2018 3:43,28/07/2018 11:44
18765,Regression in arm64 r2r jobs.  'defList.IsEmpty()' ,"Many x64_arm64_altjit_checked_windows_nt_r2r test are failing with:



The regression is caused by #18130 [ci example](https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_arm64_altjit_checked_windows_nt_r2r_prtest/13/testReport/baseservices_threading/_generics_threadstart_GThread18_GThread18_/_generics_threadstart_GThread18_GThread18_cmd/).

","Regression in arm64 r2r jobs.  'defList.IsEmpty()'  Many x64_arm64_altjit_checked_windows_nt_r2r test are failing with:



The regression is caused by #18130 [ci example](https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_arm64_altjit_checked_windows_nt_r2r_prtest/13/testReport/baseservices_threading/_generics_threadstart_GThread18_GThread18_/_generics_threadstart_GThread18_GThread18_cmd/).

",area-CodeGen,CarolEidt,,
18764,add missing files to package properly on FreeBSD,"This is my best guess based on existing Linux and OSX files. 
It creates missing packages expected by core-setup.","add missing files to package properly on FreeBSD This is my best guess based on existing Linux and OSX files. 
It creates missing packages expected by core-setup.",os-freebsd,wfurt,,
18762,Enable profiler attach on Windows,This is an ongoing work to enable profiler attach on CoreCLR. This PR enables the profiler attach feature on Windows. I am in process of working on Unix port. ,Enable profiler attach on Windows This is an ongoing work to enable profiler attach on CoreCLR. This PR enables the profiler attach feature on Windows. I am in process of working on Unix port. ,,sywhang,,
18759,Expose Thread ID and TimeStamp on EventWrittenEventArgs,Historically these could always be fetched when the event was dispatched because EventSource does direct dispatch in real-time.  However now that EventPipe can dispatch to EventListeners the Thread ID and TimeStamp aren't known for these events and needs to be plumbed through.,Expose Thread ID and TimeStamp on EventWrittenEventArgs Historically these could always be fetched when the event was dispatched because EventSource does direct dispatch in real-time.  However now that EventPipe can dispatch to EventListeners the Thread ID and TimeStamp aren't known for these events and needs to be plumbed through.,area-Tracing,brianrob,3/07/2018 8:14,4/08/2018 4:04
18758,Implement Efficient Dispatch Polling Mechanism for EventPipe,"Context: https://github.com/dotnet/coreclr/pull/18649#discussion_r199631486

We should consider replacing the polling loop when there are no new events with an AutoResetEvent to ensure that the CPU can go quiescent when there are no events.","Implement Efficient Dispatch Polling Mechanism for EventPipe Context: https://github.com/dotnet/coreclr/pull/18649#discussion_r199631486

We should consider replacing the polling loop when there are no new events with an AutoResetEvent to ensure that the CPU can go quiescent when there are no events.",EventPipe,davmason,,
18756,Port perf infrastructure to Azure Pipelines,,Port perf infrastructure to Azure Pipelines ,area-Infrastructure-coreclr,billwert,,
18755,Support Tracing and EventListener Dispatch Concurrently in EventPipe,"Right now it's only possible to do one of the following at any given time:

 - Collect a trace using EventPipe.
 - Dispatch events to EventListener.

This issue tracks making it possible to do these concurrently.","Support Tracing and EventListener Dispatch Concurrently in EventPipe Right now it's only possible to do one of the following at any given time:

 - Collect a trace using EventPipe.
 - Dispatch events to EventListener.

This issue tracks making it possible to do these concurrently.",EventPipe,brianrob,3/07/2018 6:49,16/04/2019 3:43
18754,Implement Efficient EventPipeBuffer Reading in Managed Code,EventPipeBuffers can be read when EventListener consumes events from EventPipe.  Right now this is done with a pinvoke per event.  This issue tracks improving this scheme.,Implement Efficient EventPipeBuffer Reading in Managed Code EventPipeBuffers can be read when EventListener consumes events from EventPipe.  Right now this is done with a pinvoke per event.  This issue tracks improving this scheme.,EventPipe,brianrob,3/07/2018 6:46,
18752,Merge EventPipePayloadDecoder.DecodePayload and EventProvider.DecodeObject,There are two event decoder paths in EventSource.  We should look to merge them.,Merge EventPipePayloadDecoder.DecodePayload and EventProvider.DecodeObject There are two event decoder paths in EventSource.  We should look to merge them.,EventPipe,sywhang,,
18748,RyuJIT sometimes drops volatile reads,"Morph issue:
?!

category:correctness
theme:volatile
skill-level:expert
cost:large","RyuJIT sometimes drops volatile reads Morph issue:
?!

category:correctness
theme:volatile
skill-level:expert
cost:large",area-CodeGen,RussKeldorph,3/07/2018 5:32,
18746,regressions in arm64_altjit r2r jobs: temp != nullptr,Some tests are failing after #18346 for example [b393481](https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_arm64_altjit_checked_windows_nt_r2r_prtest/12/testReport/junit/JIT_Regression/_CLR_x86_JIT_dev10_b393481_b393481_b393481_/_CLR_x86_JIT_dev10_b393481_b393481_b393481_cmd/) fails with .,regressions in arm64_altjit r2r jobs: temp != nullptr Some tests are failing after #18346 for example [b393481](https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_arm64_altjit_checked_windows_nt_r2r_prtest/12/testReport/junit/JIT_Regression/_CLR_x86_JIT_dev10_b393481_b393481_b393481_/_CLR_x86_JIT_dev10_b393481_b393481_b393481_cmd/) fails with .,area-CodeGen,CarolEidt,,
18744,Determine how to expose hwintrinsics that are only supported in 64-bit mode,"There are several hwintrinsics exposed that are only emittable in 64-bit mode and throw a PNSE exception if invoked in 32-bit mode (regardless of the fact that the general  check returns true).

We should have a deeper discussion on how to properly expose this data to the consumer of these APIs.","Determine how to expose hwintrinsics that are only supported in 64-bit mode There are several hwintrinsics exposed that are only emittable in 64-bit mode and throw a PNSE exception if invoked in 32-bit mode (regardless of the fact that the general  check returns true).

We should have a deeper discussion on how to properly expose this data to the consumer of these APIs.",Design Discussion,CarolEidt,3/07/2018 2:57,9/11/2018 15:35
18743,Ensure that the indirect call fallback for HWIntrinsics executes the same instructions as the inlined version,"There are a few ) which are emitting a managed software implementation rather than a switch table fallback.

These should be updated to use the switch table fallback instead.","Ensure that the indirect call fallback for HWIntrinsics executes the same instructions as the inlined version There are a few ) which are emitting a managed software implementation rather than a switch table fallback.

These should be updated to use the switch table fallback instead.",area-CodeGen,CarolEidt,3/07/2018 2:54,7/12/2018 7:00
18742,Add back DefinePInvokeMethod,https://github.com/dotnet/corefx/issues/30355,Add back DefinePInvokeMethod https://github.com/dotnet/corefx/issues/30355 ,area-System.Reflection,,,
18741,Question about software protection,There is a question about software protection. We used confusing software to compiling and then obscure the code and then deploying。we use hardware key to protection secret algorithms so that the software could be prevented from being copied. Now deployed in the container if a customer asks us to deploy a private cloud to them the file is easily copied by . Whether the container can be restricted can not be mounted or can not be copied.,Question about software protection There is a question about software protection. We used confusing software to compiling and then obscure the code and then deploying。we use hardware key to protection secret algorithms so that the software could be prevented from being copied. Now deployed in the container if a customer asks us to deploy a private cloud to them the file is easily copied by . Whether the container can be restricted can not be mounted or can not be copied.,question,jkotas,2/07/2018 20:49,3/07/2018 5:00
18739,CoreCLR Test Build Broken,"Opened on behalf of @RussKeldorph

Warnings: 1
Status Message: failed

Build : Master - 20180701.03 (Product Build)
Failing configurations:
- Alpine3.6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat 7
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- OSX
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
  - Build-Tests-R2R-Release
  - Build-Tests-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180701.03/workItem/Orchestration/analysis/external/Link)
","CoreCLR Test Build Broken Opened on behalf of @RussKeldorph

Warnings: 1
Status Message: failed

Build : Master - 20180701.03 (Product Build)
Failing configurations:
- Alpine3.6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat6
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- RedHat 7
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- OSX
  - Build-Tests-R2R-Release
  - Build-Tests-Release
- Windows
  - Build-Tests-R2R-Release-arm64
  - Build-Tests-Release-arm64
  - Build-Tests-R2R-Release
  - Build-Tests-Release
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180701.03/workItem/Orchestration/analysis/external/Link)
",area-Infrastructure-coreclr,A-And,,
18732,Create package for Raspbian OS (ARM32),"While there is a working binary download for dotnet (.NET Core) for ARM32 that works on a Raspberry Pi B 3+ with a current Raspbian OS there are no instructions how to install it. And there are no packages for the OS too. So it's a bit of a mystery how to actually make .NET Core work on a Raspi.

I think there should be a package for that OS. It should be as simple as that:

    sudo apt install dotnet

Maybe a custom package source needs to be added but definitely no manual tar file works. Mono was easier to install when it was current like 5 years ago.

Since the docker support on the Raspi with dotnet-runtime packages is very poor (multi-arch fails need to select arm32 image specifically can't get my app in a custom image) I need to install .NET Core on the Raspi OS itself.","Create package for Raspbian OS (ARM32) While there is a working binary download for dotnet (.NET Core) for ARM32 that works on a Raspberry Pi B 3+ with a current Raspbian OS there are no instructions how to install it. And there are no packages for the OS too. So it's a bit of a mystery how to actually make .NET Core work on a Raspi.

I think there should be a package for that OS. It should be as simple as that:

    sudo apt install dotnet

Maybe a custom package source needs to be added but definitely no manual tar file works. Mono was easier to install when it was current like 5 years ago.

Since the docker support on the Raspi with dotnet-runtime packages is very poor (multi-arch fails need to select arm32 image specifically can't get my app in a custom image) I need to install .NET Core on the Raspi OS itself.",,richlander,,
18727,JIT : PMI now failing on System.Private.CoreLib on an x64 AES intrinsic,"The x64 windows run of PMI over System.Private.Corelib is now failing when trying to jit  as this method exists in metadata and is marked as an intrinsic but the jit does not recognize it. This is relatively new (~ last few days) behavior.

Would be nice to fix this by (say) adding in the names to the recognizer and then (for now) just compiling in the not supported variant.

cc @dotnet/jit-contrib ","JIT : PMI now failing on System.Private.CoreLib on an x64 AES intrinsic The x64 windows run of PMI over System.Private.Corelib is now failing when trying to jit  as this method exists in metadata and is marked as an intrinsic but the jit does not recognize it. This is relatively new (~ last few days) behavior.

Would be nice to fix this by (say) adding in the names to the recognizer and then (for now) just compiling in the not supported variant.

cc @dotnet/jit-contrib ",arch-x64,AndyAyersMS,30/06/2018 10:11,3/08/2018 2:41
18723,Failure in arm32/arm64 corefx altjit tests,"I'm seeing:


Did something change in the corefx tools (msbuild etc.) that makes this syntax invalid now?

This syntax is constructed in coreclr: tests\scripts\run-corefx-tests.py

e.g.: https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_baseline/230/consoleFull#-165810470383554902-aff0-4799-9e92-0ada24ce2a06
","Failure in arm32/arm64 corefx altjit tests I'm seeing:


Did something change in the corefx tools (msbuild etc.) that makes this syntax invalid now?

This syntax is constructed in coreclr: tests\scripts\run-corefx-tests.py

e.g.: https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_baseline/230/consoleFull#-165810470383554902-aff0-4799-9e92-0ada24ce2a06
",,BruceForstall,,
18722,reenable fixed arm64 altjit tests,,reenable fixed arm64 altjit tests ,disabled-test,sandreenko,30/06/2018 9:19,3/07/2018 3:21
18721,SuperPMI: add ability to exclude failing method contexts from replays,"The first 3 commits are only refactoring.
The fourth adds a stub and ability to print number of excluded methods.","SuperPMI: add ability to exclude failing method contexts from replays The first 3 commits are only refactoring.
The fourth adds a stub and ability to print number of excluded methods.",area-Infrastructure-coreclr,sandreenko,30/06/2018 9:19,3/07/2018 10:32
18719,Proposal to add classification info to area-CodeGen issues,"There are currently 652 open are-CodeGen issues. To help with triage the jit team went through the issues and compiled classification info for each issue: category theme skill-level and cost. Each issue got one tag from each of the following sets:

category: {cq correctness implementation throughput proposal reach design. documentation testing engsys usability security portability}

theme: {basic-cq register-allocator arm64 jit-coding-style testing inlining optimization benchmarks ir loop-opt vector-codegen hw-intrinsics x86 importer first-class-structs arm32 throughput jit-stress intrinsics sysV helpers bounds-checks runtime flowgraph promotion gc-stress emitter gc-info big-bets large-methods value-numbering debug-dumps ilasm assertion-prop devirtualization block-opts ref-counts profile-feedback barriers msil cse eh ildasm tail-call super-pmi div-mod-rem zero-init stack-allocation type-intrinsics structs morph span<t> jit-ee-interface lower md-arrays invalid-il spmi ssa block-layout alignment range-check liveness copy-prop volatile delegates web-assembly pinning interpreter generics build class-init linux}

skill-level: {beginner intermediate expert}

cost: {small medium large extra-large}

This info is currently in an excel spreadsheet and we would like to propagate it to the issues.
We think adding a label for each of the tags above would be excessive. The proposal is to append this information to the end of the issue description e.g.

Any feedback on this plan is appreciated.

@dotnet/jit-contrib @karelz ","Proposal to add classification info to area-CodeGen issues There are currently 652 open are-CodeGen issues. To help with triage the jit team went through the issues and compiled classification info for each issue: category theme skill-level and cost. Each issue got one tag from each of the following sets:

category: {cq correctness implementation throughput proposal reach design. documentation testing engsys usability security portability}

theme: {basic-cq register-allocator arm64 jit-coding-style testing inlining optimization benchmarks ir loop-opt vector-codegen hw-intrinsics x86 importer first-class-structs arm32 throughput jit-stress intrinsics sysV helpers bounds-checks runtime flowgraph promotion gc-stress emitter gc-info big-bets large-methods value-numbering debug-dumps ilasm assertion-prop devirtualization block-opts ref-counts profile-feedback barriers msil cse eh ildasm tail-call super-pmi div-mod-rem zero-init stack-allocation type-intrinsics structs morph span<t> jit-ee-interface lower md-arrays invalid-il spmi ssa block-layout alignment range-check liveness copy-prop volatile delegates web-assembly pinning interpreter generics build class-init linux}

skill-level: {beginner intermediate expert}

cost: {small medium large extra-large}

This info is currently in an excel spreadsheet and we would like to propagate it to the issues.
We think adding a label for each of the tags above would be excessive. The proposal is to append this information to the end of the issue description e.g.

Any feedback on this plan is appreciated.

@dotnet/jit-contrib @karelz ",Design Discussion,karelz,30/06/2018 6:49,11/08/2018 9:37
18717,RyuJIT32 performs unnecessary round-trip through double when converting float to byte,"Given the following method



That makes for a 13% speed difference in this method.

I also just noticed the bounds check is not elided here just moved.  I can't seem to get it to elide the check.  Any ideas @mikedn?","RyuJIT32 performs unnecessary round-trip through double when converting float to byte Given the following method



That makes for a 13% speed difference in this method.

I also just noticed the bounds check is not elided here just moved.  I can't seem to get it to elide the check.  Any ideas @mikedn?",arch-x86,mikedn,30/06/2018 6:39,15/09/2018 3:47
18712,Implement BMI1 and BMI2 intrinsics,"Pending BMI1:
- [x] AndNot
- [ ] BitFieldExtract
- [x] ExtractLowestSetBit
- [x] GetMaskUptoLowestSetBit
- [x] ResetLowestSetBit
- [x] TrailingZeroCount

Pending BMI2:
- [ ] MultiplyNoFlags
- [x] ParallelBitDeposit
- [x] ParallelBitExtract
- [ ] ZeroHighBits","Implement BMI1 and BMI2 intrinsics Pending BMI1:
- [x] AndNot
- [ ] BitFieldExtract
- [x] ExtractLowestSetBit
- [x] GetMaskUptoLowestSetBit
- [x] ResetLowestSetBit
- [x] TrailingZeroCount

Pending BMI2:
- [ ] MultiplyNoFlags
- [x] ParallelBitDeposit
- [x] ParallelBitExtract
- [ ] ZeroHighBits",area-CodeGen,tannergooding,,
18710,Strange codegen with structure fields accesses,"The C# repro code below shows non-uniformity in .NET Core 2.1 JIT behavior regarding (de)optimization of memory accesses having potential side effects. In short test methods attempt to access all three fields of the structure instance of which only two first values are used.

 modifier to all three fields.","Strange codegen with structure fields accesses The C# repro code below shows non-uniformity in .NET Core 2.1 JIT behavior regarding (de)optimization of memory accesses having potential side effects. In short test methods attempt to access all three fields of the structure instance of which only two first values are used.

 modifier to all three fields.",area-CodeGen,erozenfeld,29/06/2018 21:53,14/07/2018 6:21
18709,Issue with large arrays,"Have some Machine Learning code which works on .NET and allocates a large array double[6553665536].
To make this working I had to enable gcAllowVeryLargeObjects .

How to do the same in .NET Core?

Right now getting following exception:
System.OutOfMemoryException: 'Array dimensions exceeded supported range.'

Thanks","Issue with large arrays Have some Machine Learning code which works on .NET and allocates a large array double[6553665536].
To make this working I had to enable gcAllowVeryLargeObjects .

How to do the same in .NET Core?

Right now getting following exception:
System.OutOfMemoryException: 'Array dimensions exceeded supported range.'

Thanks",area-GC,jkotas,29/06/2018 20:36,1/02/2019 13:40
18705,Huge slowdowns on threaded operations when debugger attached (macOS),"When debugging our application (with attached debugger no breakpoints) performance can drop to a point it becomes frustrating to do anything. On occasion we are also seeing OS level hard locking for seconds to minutes which *may* be related.

Reproducible in both VSCode and Jetbrains Rider. This is exclusive to netcore (2.0 and 2.1) – does not occur under mono or net471 runtime environments. It also seems limited to macOS as I have not been able to reproduce on windows.

This can easily be reproduced on our game framework project: https://github.com/ppy/osu-framework (building should require not extra steps beyond checking it out).

- Start in  flag. On removing this flag from hot paths ([#1](https://github.com/ppy/osu-framework/blob/2fb9404792f0d7c39bed1272419e53683d6cb747/osu.Framework/IO/Network/WebRequest.cs#L229) [#2](https://github.com/ppy/osu-framework/blob/5a4bbc322d7d7e334fc1056550d2e3943b24e9c9/osu.Framework/Graphics/Drawable.cs#L145)) performance will return to normal.

I've been trying to reproduce this with a more isolated test case but have not succeeded yet. Some pointers on moving forward in diagnosing this issue would be appreciated!

","Huge slowdowns on threaded operations when debugger attached (macOS) When debugging our application (with attached debugger no breakpoints) performance can drop to a point it becomes frustrating to do anything. On occasion we are also seeing OS level hard locking for seconds to minutes which *may* be related.

Reproducible in both VSCode and Jetbrains Rider. This is exclusive to netcore (2.0 and 2.1) – does not occur under mono or net471 runtime environments. It also seems limited to macOS as I have not been able to reproduce on windows.

This can easily be reproduced on our game framework project: https://github.com/ppy/osu-framework (building should require not extra steps beyond checking it out).

- Start in  flag. On removing this flag from hot paths ([#1](https://github.com/ppy/osu-framework/blob/2fb9404792f0d7c39bed1272419e53683d6cb747/osu.Framework/IO/Network/WebRequest.cs#L229) [#2](https://github.com/ppy/osu-framework/blob/5a4bbc322d7d7e334fc1056550d2e3943b24e9c9/osu.Framework/Graphics/Drawable.cs#L145)) performance will return to normal.

I've been trying to reproduce this with a more isolated test case but have not succeeded yet. Some pointers on moving forward in diagnosing this issue would be appreciated!

",area-Diagnostics,mikem8361,,
18704,System.Net.Primitives.Functional.Tests Failures,"The following tests fail in System.Net.Primitives.Functional.Tests with an EntryPointNotFoundException



","System.Net.Primitives.Functional.Tests Failures The following tests fail in System.Net.Primitives.Functional.Tests with an EntryPointNotFoundException



",arch-x64,A-And,29/06/2018 11:04,3/07/2018 14:35
18703,System.Net.Http.Functional.Tests Failures,"Three ""*Uppercased"" tests fail in System.Net.Http.Functional.Tests
Test:
    SocketsHttpHandler_HttpProtocolTests_Dribble.CustomMethod_SentUppercasedIfKnown
Error:
    Xunit.Sdk.StartsWithException Assert.StartsWith() Failure:\\r\\nExpected: GET \\r\\nActual:   get ..

Test:
    SocketsHttpHandler_HttpProtocolTests.CustomMethod_SentUppercasedIfKnown_Additional
Error:
    Xunit.Sdk.StartsWithException Assert.StartsWith() Failure:\\r\\nExpected: DELETE \\r\\nActual:   delete ...

Test:
    SocketsHttpHandler_HttpProtocolTests.CustomMethod_SentUppercasedIfKnown
Error:
    Xunit.Sdk.StartsWithException Assert.StartsWith() Failure:\\r\\nExpected: GET \\r\\nActual:   get ...


### To reproduce failing 

1. 
","System.Net.Http.Functional.Tests Failures Three ""*Uppercased"" tests fail in System.Net.Http.Functional.Tests
Test:
    SocketsHttpHandler_HttpProtocolTests_Dribble.CustomMethod_SentUppercasedIfKnown
Error:
    Xunit.Sdk.StartsWithException Assert.StartsWith() Failure:\\r\\nExpected: GET \\r\\nActual:   get ..

Test:
    SocketsHttpHandler_HttpProtocolTests.CustomMethod_SentUppercasedIfKnown_Additional
Error:
    Xunit.Sdk.StartsWithException Assert.StartsWith() Failure:\\r\\nExpected: DELETE \\r\\nActual:   delete ...

Test:
    SocketsHttpHandler_HttpProtocolTests.CustomMethod_SentUppercasedIfKnown
Error:
    Xunit.Sdk.StartsWithException Assert.StartsWith() Failure:\\r\\nExpected: GET \\r\\nActual:   get ...


### To reproduce failing 

1. 
",arch-x64,A-And,29/06/2018 10:56,3/07/2018 14:35
18702,System.Linq.Expressions.Tests Failures,"Multiple tests in Linq.Expressions.Tests fail. 

With all of the below only some elements in the collections don't pass the test.

","System.Linq.Expressions.Tests Failures Multiple tests in Linq.Expressions.Tests fail. 

With all of the below only some elements in the collections don't pass the test.

",arch-x64,A-And,29/06/2018 10:53,3/07/2018 14:35
18701,System.Security.Principal.Tests Failure,"The following error is hit when running System.Security.Principal.Tests - this also crashes the .NET Core Host running the XUnit runner. 
There is a substantial number of tests which fail with ","System.Security.Principal.Tests Failure The following error is hit when running System.Security.Principal.Tests - this also crashes the .NET Core Host running the XUnit runner. 
There is a substantial number of tests which fail with ",arch-x64,A-And,29/06/2018 10:49,3/07/2018 14:35
18700,System.Linq.Expressions.Tests TypeLoadException in System.Private.CoreLib,"A TypeLoadException is hit when running System.Linq.Expressions.
","System.Linq.Expressions.Tests TypeLoadException in System.Private.CoreLib A TypeLoadException is hit when running System.Linq.Expressions.
",arch-x64,A-And,29/06/2018 10:47,3/07/2018 14:35
18699,System.Drawing.Common.Tests Failures,"Some System.Drawing tests are failing with invalid Enum values. The disabled tests failing from the same cause are 

","System.Drawing.Common.Tests Failures Some System.Drawing tests are failing with invalid Enum values. The disabled tests failing from the same cause are 

",arch-x64,A-And,29/06/2018 10:45,24/05/2019 7:38
18698,Change CancellationTokenRegistration.Unregister visibility from internal to public,"Add a CancellationTokenRegistrationSupport to access CancellationTokenRegistration.Unregister(0 method.

After https://github.com/dotnet/corefx/issues/14903 is fixed  We can remove this public implementation

Corefx repro: https://github.com/dotnet/corefx/pull/30745","Change CancellationTokenRegistration.Unregister visibility from internal to public Add a CancellationTokenRegistrationSupport to access CancellationTokenRegistration.Unregister(0 method.

After https://github.com/dotnet/corefx/issues/14903 is fixed  We can remove this public implementation

Corefx repro: https://github.com/dotnet/corefx/pull/30745",area-Interop,luqunl,29/06/2018 10:07,30/06/2018 3:59
18692,Proposal: Re-introduce support for multi-module assemblies,"Is there a technical reason or downside to having multi-module assemblies in CoreCLR?

https://github.com/dotnet/coreclr/commit/1aa7d6b8796f7e28a63162117c5bb16a207a472b removed the code associated with FEATURE_MULTIMODULE_ASSEMBLIES since it was never defined.

If there isn't I'd like to propose we bring this feature back.","Proposal: Re-introduce support for multi-module assemblies Is there a technical reason or downside to having multi-module assemblies in CoreCLR?

https://github.com/dotnet/coreclr/commit/1aa7d6b8796f7e28a63162117c5bb16a207a472b removed the code associated with FEATURE_MULTIMODULE_ASSEMBLIES since it was never defined.

If there isn't I'd like to propose we bring this feature back.",area-AssemblyLoader,mjsabby,29/06/2018 7:11,9/05/2019 12:53
18691,Add public implementation CultureDataSupport,"WindowsRuntimeResourceManager  need to access CultureData to see whether a language is supported or not.
Add a public implementation CultureDataSupport for WindowsRuntimeResourceManager  ","Add public implementation CultureDataSupport WindowsRuntimeResourceManager  need to access CultureData to see whether a language is supported or not.
Add a public implementation CultureDataSupport for WindowsRuntimeResourceManager  ",area-Interop,luqunl,29/06/2018 6:09,30/06/2018 2:24
18690,SuperPmi: add ability to exclude failing methods,"SuperPMI is used to collect method context files and replay them using only JIT.
It is also possible to collect plain *.mc but replay with set of  will read method names from this file and skip these methods.","SuperPmi: add ability to exclude failing methods SuperPMI is used to collect method context files and replay them using only JIT.
It is also possible to collect plain *.mc but replay with set of  will read method names from this file and skip these methods.",area-Infrastructure-coreclr,sandreenko,,
18688,Bounds checks on array/span not eliminated after length check,"I've got code similar to the following repro:

but it’d be nice not to have to use Unsafe for cases like this.

cc: @AndyAyersMS 
Related: https://github.com/dotnet/coreclr/issues/12639

category:cq
theme:range-check
skill-level:intermediate
cost:medium","Bounds checks on array/span not eliminated after length check I've got code similar to the following repro:

but it’d be nice not to have to use Unsafe for cases like this.

cc: @AndyAyersMS 
Related: https://github.com/dotnet/coreclr/issues/12639

category:cq
theme:range-check
skill-level:intermediate
cost:medium",area-CodeGen,AndyAyersMS,29/06/2018 3:13,
18687,Port to 2.1: Fix alternate stack cleanup on MUSL,"The MUSL implementation of sigaltstack checks that the ss.ss_size is
larger or equal than the MINSIGSTKSZ even when the ss_flags is set
to SS_DISABLE even though Linux man page for sigaltstack states that
when this flag is set all other ss fields are ignored.

We were not setting the ss_size in this case and it was causing a memory
leak for each thread that has terminated on MUSL based Linux distros
like Alpine.

Glibc implementation doesn't check the ss_size when the SS_DISABLE is set
so the problem was really MUSL specific.","Port to 2.1: Fix alternate stack cleanup on MUSL The MUSL implementation of sigaltstack checks that the ss.ss_size is
larger or equal than the MINSIGSTKSZ even when the ss_flags is set
to SS_DISABLE even though Linux man page for sigaltstack states that
when this flag is set all other ss fields are ignored.

We were not setting the ss_size in this case and it was causing a memory
leak for each thread that has terminated on MUSL based Linux distros
like Alpine.

Glibc implementation doesn't check the ss_size when the SS_DISABLE is set
so the problem was really MUSL specific.",area-PAL,janvorli,,
18685,Fix alternate stack cleanup on MUSL,"The MUSL implementation of sigaltstack checks that the ss.ss_size is
larger or equal than the MINSIGSTKSZ even when the ss_flags is set
to SS_DISABLE even though Linux man page for sigaltstack states that
when this flag is set all other ss fields are ignored.

We were not setting the ss_size in this case and it was causing a memory
leak for each thread that has terminated on MUSL based Linux distros
like Alpine.

Glibc implementation doesn't check the ss_size when the SS_DISABLE is set
so the problem was really MUSL specific.","Fix alternate stack cleanup on MUSL The MUSL implementation of sigaltstack checks that the ss.ss_size is
larger or equal than the MINSIGSTKSZ even when the ss_flags is set
to SS_DISABLE even though Linux man page for sigaltstack states that
when this flag is set all other ss fields are ignored.

We were not setting the ss_size in this case and it was causing a memory
leak for each thread that has terminated on MUSL based Linux distros
like Alpine.

Glibc implementation doesn't check the ss_size when the SS_DISABLE is set
so the problem was really MUSL specific.",area-PAL,janvorli,,
18683,Option additionalProbingPaths is not working,"According to documentation this parameter should allow the placement of libraries in a different location for example a subdirectory. However the parameter fails to work as advised.

I'm running into the same behavior explained in this posting on StackOverflow: 
https://stackoverflow.com/questions/48650348/additionalprobingpaths-not-respected-after-dotnet-publish

Basically if you put the additional path into the json file it is ignored and moving a library to the new location will produce an error:
""An assembly specified in the application dependencies manifest ([referencedLibrary].deps.json) was not found""

This either does not work at all or it's documentation needs to be greatly improved.","Option additionalProbingPaths is not working According to documentation this parameter should allow the placement of libraries in a different location for example a subdirectory. However the parameter fails to work as advised.

I'm running into the same behavior explained in this posting on StackOverflow: 
https://stackoverflow.com/questions/48650348/additionalprobingpaths-not-respected-after-dotnet-publish

Basically if you put the additional path into the json file it is ignored and moving a library to the new location will produce an error:
""An assembly specified in the application dependencies manifest ([referencedLibrary].deps.json) was not found""

This either does not work at all or it's documentation needs to be greatly improved.",area-AssemblyLoader,jkotas,28/06/2018 17:03,4/07/2018 1:32
18682,ASP.NET Core application terminates with Segmentation fault on ARM.,I've published my ASP.NET Core application with ,ASP.NET Core application terminates with Segmentation fault on ARM. I've published my ASP.NET Core application with ,arch-arm32,jkotas,28/06/2018 13:16,18/06/2019 7:09
18681,Move Is AppDomainUnloadedException check from S.R.WR into S.P.Corelib,Type AppDomainUnloadedException in S.P.Corelib is internal only. Also I can't use public type AppDomainUnloadedException in System.Runtime.Extensions since Type AppDomainUnloadedException in S.P.Corelib and Type AppDomainUnloadedException in System.Runtime.Extensions are two different types.,Move Is AppDomainUnloadedException check from S.R.WR into S.P.Corelib Type AppDomainUnloadedException in S.P.Corelib is internal only. Also I can't use public type AppDomainUnloadedException in System.Runtime.Extensions since Type AppDomainUnloadedException in S.P.Corelib and Type AppDomainUnloadedException in System.Runtime.Extensions are two different types.,area-Interop,luqunl,28/06/2018 10:24,29/06/2018 4:50
18680,Hung .NET Core console app - F5 launch from VS ,"A .NET Core 2.1 console app hung (right after I pressed Ctrl+C which the console app handles) and inspection suggests the code required to exit the app never executed because the method could not be JITted.

[Dump file](https://microsoft-my.sharepoint.com/:u:/p/andarno/Eahy34c1IvpOgtMkgCPvKQAB2QNonNUbsvL3LcORNs62BQ?e=iA5Cop)

","Hung .NET Core console app - F5 launch from VS  A .NET Core 2.1 console app hung (right after I pressed Ctrl+C which the console app handles) and inspection suggests the code required to exit the app never executed because the method could not be JITted.

[Dump file](https://microsoft-my.sharepoint.com/:u:/p/andarno/Eahy34c1IvpOgtMkgCPvKQAB2QNonNUbsvL3LcORNs62BQ?e=iA5Cop)

",area-Diagnostics,AArnott,28/06/2018 9:42,26/02/2019 6:03
18679,JIT: look at cost impact of assertion dup detection,"More follow on from #18327.

When we generate new assertions we check to see if they're duplicates. If so we don't need to record them. Data from PMI shows that about 75% of generated assertions are duplicates.

The check does a linear scan against the existing assertion table which is potentially costly and this cost would grow if we start recording all or more assertions as proposed in #18678.

Profiling (crossgen x64 of Microsoft.CodeAnalysis.VisualBasic.dll) suggests  gets inlined and it currently represents perhaps ~1% of the time spent in the jit. (Assertion prop as whole is about 5%).

category:throughput
theme:assertion-prop
skill-level:intermediate
cost:medium","JIT: look at cost impact of assertion dup detection More follow on from #18327.

When we generate new assertions we check to see if they're duplicates. If so we don't need to record them. Data from PMI shows that about 75% of generated assertions are duplicates.

The check does a linear scan against the existing assertion table which is potentially costly and this cost would grow if we start recording all or more assertions as proposed in #18678.

Profiling (crossgen x64 of Microsoft.CodeAnalysis.VisualBasic.dll) suggests  gets inlined and it currently represents perhaps ~1% of the time spent in the jit. (Assertion prop as whole is about 5%).

category:throughput
theme:assertion-prop
skill-level:intermediate
cost:medium",area-CodeGen,AndyAyersMS,28/06/2018 8:55,
18678,JIT: possibly revisit how we set assertion prop table size,"Some data on how often we drop assertions (from investigations into #18327 via pmi over fx):

Table Size | Num Methods | Avg Assertion Count | Methods with Dropped Assertions 
----- | -------: | --------: | ----:
64 | 159493 | 4.6 | 222
128 | 1801 | 42.3 | 28
256 | 237 | 81.2 | 4

Overall this doesn't seem too bad -- only about 0.16% of methods lost assertions from table size limits. I unfortunately didn't track how many of the size 64 cases were ones where we deliberately limited the size for throughput reasons.

Table size is determined by looking at . So 551 of these were dropped.

There is obviously some consideration of the overall cost of the subsequent dataflow analysis too which is roughly proportional to max assertion size * number of blocks. So if we allow max assertion size to scale up with blocks we potentially see some quadratic behavior. But this seems perhaps solvable too -- we generate all (or more) assertions initially and then only limit the ones we use if we see bad scaling.

This might let us also try and prioritize which assertions should survive though I don't have any particular idea yet how to formulate that (something like the value number equivalent of weighted ref count usage ...?).

Note today we actually generate all assertions. Assertion gen doesn't early out once the table is full (though perhaps it should). It just stops recording assertions once the table fills up. So we are already paying the cost of finding all these assertions. And the table size itself is not a burden

So a rough proposal would be to find and record all assertions -- allowing the table to grow larger (with perhaps some size limit) and have a budget based on blocks * assertions and if over budget start trimming assertions somehow to get under budget.



category:implementation
theme:assertion-prop
skill-level:intermediate
cost:medium","JIT: possibly revisit how we set assertion prop table size Some data on how often we drop assertions (from investigations into #18327 via pmi over fx):

Table Size | Num Methods | Avg Assertion Count | Methods with Dropped Assertions 
----- | -------: | --------: | ----:
64 | 159493 | 4.6 | 222
128 | 1801 | 42.3 | 28
256 | 237 | 81.2 | 4

Overall this doesn't seem too bad -- only about 0.16% of methods lost assertions from table size limits. I unfortunately didn't track how many of the size 64 cases were ones where we deliberately limited the size for throughput reasons.

Table size is determined by looking at . So 551 of these were dropped.

There is obviously some consideration of the overall cost of the subsequent dataflow analysis too which is roughly proportional to max assertion size * number of blocks. So if we allow max assertion size to scale up with blocks we potentially see some quadratic behavior. But this seems perhaps solvable too -- we generate all (or more) assertions initially and then only limit the ones we use if we see bad scaling.

This might let us also try and prioritize which assertions should survive though I don't have any particular idea yet how to formulate that (something like the value number equivalent of weighted ref count usage ...?).

Note today we actually generate all assertions. Assertion gen doesn't early out once the table is full (though perhaps it should). It just stops recording assertions once the table fills up. So we are already paying the cost of finding all these assertions. And the table size itself is not a burden

So a rough proposal would be to find and record all assertions -- allowing the table to grow larger (with perhaps some size limit) and have a budget based on blocks * assertions and if over budget start trimming assertions somehow to get under budget.



category:implementation
theme:assertion-prop
skill-level:intermediate
cost:medium",area-CodeGen,AndyAyersMS,28/06/2018 8:28,
18677,Re-enable Test Logs and build only test host in CoreFX CI jobs,#18365 has been merged so logging can be reenabled. Additionally this builds only the components required to build CoreFX tests.,Re-enable Test Logs and build only test host in CoreFX CI jobs #18365 has been merged so logging can be reenabled. Additionally this builds only the components required to build CoreFX tests.,area-Infrastructure-coreclr,A-And,28/06/2018 7:43,28/06/2018 9:23
18676,[NO MERGE] Add crossgen_equivalence scenario to netci.groovy,**NO MERGE**,[NO MERGE] Add crossgen_equivalence scenario to netci.groovy **NO MERGE**,* NO MERGE *,echesakovMSFT,28/06/2018 7:42,12/07/2018 4:04
18675,Add additional PInvoke tests to coreclr,"The PInvoke scenario surface area is large and the coreclr repo doesn't have coverage that would be considered adequate. Missing areas (not exhaustive):

- Arrays
- SafeHandles
- CriticalHandles
- DllImport searching with UNICODE characters

","Add additional PInvoke tests to coreclr The PInvoke scenario surface area is large and the coreclr repo doesn't have coverage that would be considered adequate. Missing areas (not exhaustive):

- Arrays
- SafeHandles
- CriticalHandles
- DllImport searching with UNICODE characters

",area-Interop,jkoritzinsky,,
18674,.NET COM server tests,Testing for scenarios when a coreclr application is a COM server should exist,.NET COM server tests Testing for scenarios when a coreclr application is a COM server should exist,area-Interop,AaronRobinsonMSFT,28/06/2018 6:50,11/09/2018 10:25
18673,.NET COM client tests,Testing for scenarios when a coreclr application is a COM client should exist,.NET COM client tests Testing for scenarios when a coreclr application is a COM client should exist,area-Interop,AaronRobinsonMSFT,28/06/2018 6:48,19/07/2018 10:53
18672,Wrong constant propagation on Linux in release,"On Linux in release the following program outputs 

I'm not 100% sure that this isn't the same as #18259 however this only reproduces on Linux so there is definitely something different here.","Wrong constant propagation on Linux in release On Linux in release the following program outputs 

I'm not 100% sure that this isn't the same as #18259 however this only reproduces on Linux so there is definitely something different here.",area-CodeGen,briansull,,
18671,Add Public implementation RemoveEventHandler in EventRegistrationTokenTable,"Add a public implementation API GetEventHandlerFromEventRegistrationToken for System.runtime.WindowsRuntime to consume instead of using FriendAccessAllowed/InternalVisiable

Corefx PR:https://github.com/dotnet/corefx/pull/30699
","Add Public implementation RemoveEventHandler in EventRegistrationTokenTable Add a public implementation API GetEventHandlerFromEventRegistrationToken for System.runtime.WindowsRuntime to consume instead of using FriendAccessAllowed/InternalVisiable

Corefx PR:https://github.com/dotnet/corefx/pull/30699
",area-Interop,luqunl,28/06/2018 3:54,28/06/2018 9:13
18661,Remove Conditional Compilation of Generated DotNETRuntimeEventSource.cs,"Build scripts and/or project files need to be fixed so that the conditional compilation of DotNETRuntimeEventSource.cs can be replaced with an unconditional compilation.  Otherwise we risk ending up with a build System.Private.CoreLib.dll that doesn't contain the contents of DotNETRuntimeEventSource.cs.

The line of interest is here: https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/System.Private.CoreLib.csproj#L446.","Remove Conditional Compilation of Generated DotNETRuntimeEventSource.cs Build scripts and/or project files need to be fixed so that the conditional compilation of DotNETRuntimeEventSource.cs can be replaced with an unconditional compilation.  Otherwise we risk ending up with a build System.Private.CoreLib.dll that doesn't contain the contents of DotNETRuntimeEventSource.cs.

The line of interest is here: https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/System.Private.CoreLib.csproj#L446.",area-Tracing,brianrob,27/06/2018 9:01,28/06/2018 4:19
18659,Provide a Mechanism to Stream Events Out-of-Process from EventPipe,Provide a mechanism to consume events in real time from EventPipe out-of-process.,Provide a Mechanism to Stream Events Out-of-Process from EventPipe Provide a mechanism to consume events in real time from EventPipe out-of-process.,EventPipe,jorive,,
18658,Provide an Out-of-Process Control Mechanism for EventPipe,Right now EventPipe is only controllable via environment variables and private reflection.  We should add an out-of-process control mechanism to significantly improve usability.,Provide an Out-of-Process Control Mechanism for EventPipe Right now EventPipe is only controllable via environment variables and private reflection.  We should add an out-of-process control mechanism to significantly improve usability.,EventPipe,jorive,,
18656,Use IBC to Drive Partial NGEN and Tiered Compilation Behavior,"Now that we have tiered compilation in .NET Core we should look for ways to use it to get fast start-up great throughput at steady state and improvements to size-on-disk.

Consider this a tracking item that should be used to drive a plan here.","Use IBC to Drive Partial NGEN and Tiered Compilation Behavior Now that we have tiered compilation in .NET Core we should look for ways to use it to get fast start-up great throughput at steady state and improvements to size-on-disk.

Consider this a tracking item that should be used to drive a plan here.",area-ReadyToRun,brianrob,27/06/2018 8:11,
18655,Enable IBC Optimization on System.Private.CoreLib,,Enable IBC Optimization on System.Private.CoreLib ,area-Infrastructure-coreclr,brianrob,27/06/2018 8:05,1/05/2019 5:56
18654,Enable PGO Optimization for More Platforms / Architectures,"The following platforms currently don't get PGO optimized.

 - Windows arm32
 - Windows arm64
 - Linux arm32
 - Linux arm64
 - OSX x64","Enable PGO Optimization for More Platforms / Architectures The following platforms currently don't get PGO optimized.

 - Windows arm32
 - Windows arm64
 - Linux arm32
 - Linux arm64
 - OSX x64",area-Infrastructure-coreclr,brianrob,27/06/2018 8:04,
18652,Add LastIndexOf compareoptions overload,"Relates to https://github.com/dotnet/corefx/issues/30649

I mostly copied the existing implementations and changed to FIND_FROMEND. Please let me know if something is missing here.","Add LastIndexOf compareoptions overload Relates to https://github.com/dotnet/corefx/issues/30649

I mostly copied the existing implementations and changed to FIND_FROMEND. Please let me know if something is missing here.",area-System.Memory,ViktorHofer,,
18650,[NO MERGE] Dummy PR for testing,**NO MERGE**,[NO MERGE] Dummy PR for testing **NO MERGE**,* NO MERGE *,echesakovMSFT,27/06/2018 3:30,17/07/2018 13:49
18648,Misuse of optPrepareTreeForReplacement leads to incorrect exception thrown in release,"This example incorrectly throws an exception in release:
 is a COMMA where both op1 and op2 point to the same constant node
> 
> I'm surprised that this doesn't blow up more often and more spectacularly!","Misuse of optPrepareTreeForReplacement leads to incorrect exception thrown in release This example incorrectly throws an exception in release:
 is a COMMA where both op1 and op2 point to the same constant node
> 
> I'm surprised that this doesn't blow up more often and more spectacularly!",area-CodeGen,mikedn,27/06/2018 2:29,27/06/2018 7:38
18643,Community Slack engagement story needs work,"*[I'm writing this in story form as I believe it's important you look at this through the proper lens]*

# Story time
So put on your new user hat. 🤠 

You want to engage with the CoreCLR community and figure out why you can't debug CoreCLR. You hit the engagement documentation (https://github.com/dotnet/coreclr/blob/master/Documentation/workflow/IssuesFeedbackEngagement.md).

The CoreCLR repository documentation reels you in with a ""chat with the community"" heading and a badge that shows there's 6517 registered users on Slack. Wow! Sounds great! You click this badge.

Now you're whisked away to some random blog (tattoocoder) where it indicates 7091 users. Hm okay whatever. I'm daring I'll type my email into this random blog widget.

You continue through Slack's awful user flow where it notifies you that you're joining the .NET Slack. Great! But hosted at... aspnetcore.slack.com. You don't care about aspnet. But you continue anyway.

You join the slack and get plopped into the #general channel with no further guidance. You go through the Slack tutorial for the 100th time and remember there are channels. You join the CoreCLR channel and there's only 286 people. You begin to question if everything you did was for nothing ... 

And end scene. 🦑 

# Suggestions

* Make it clear the Slack is or isn't official (it's not clear)
* Set some expectations -- do core maintainers hang out in here? should I use Slack over Gitter for certain scenarios?
* Rename the Slack name/URLs to make sense (https://get.slack.help/hc/en-us/articles/201663443-Change-your-workspace-or-org-name-and-URL)
* Welcome users with a map ([perhaps with custom code](https://api.slack.com/best-practices/blueprints/new-user-notification) or a [simple bot](https://greetbot.io/))

# Dog Tax

![image](https://user-images.githubusercontent.com/475132/41888633-5501900a-78bb-11e8-803a-b66bd988117d.png)

cc: @spboyer 
","Community Slack engagement story needs work *[I'm writing this in story form as I believe it's important you look at this through the proper lens]*

# Story time
So put on your new user hat. 🤠 

You want to engage with the CoreCLR community and figure out why you can't debug CoreCLR. You hit the engagement documentation (https://github.com/dotnet/coreclr/blob/master/Documentation/workflow/IssuesFeedbackEngagement.md).

The CoreCLR repository documentation reels you in with a ""chat with the community"" heading and a badge that shows there's 6517 registered users on Slack. Wow! Sounds great! You click this badge.

Now you're whisked away to some random blog (tattoocoder) where it indicates 7091 users. Hm okay whatever. I'm daring I'll type my email into this random blog widget.

You continue through Slack's awful user flow where it notifies you that you're joining the .NET Slack. Great! But hosted at... aspnetcore.slack.com. You don't care about aspnet. But you continue anyway.

You join the slack and get plopped into the #general channel with no further guidance. You go through the Slack tutorial for the 100th time and remember there are channels. You join the CoreCLR channel and there's only 286 people. You begin to question if everything you did was for nothing ... 

And end scene. 🦑 

# Suggestions

* Make it clear the Slack is or isn't official (it's not clear)
* Set some expectations -- do core maintainers hang out in here? should I use Slack over Gitter for certain scenarios?
* Rename the Slack name/URLs to make sense (https://get.slack.help/hc/en-us/articles/201663443-Change-your-workspace-or-org-name-and-URL)
* Welcome users with a map ([perhaps with custom code](https://api.slack.com/best-practices/blueprints/new-user-notification) or a [simple bot](https://greetbot.io/))

# Dog Tax

![image](https://user-images.githubusercontent.com/475132/41888633-5501900a-78bb-11e8-803a-b66bd988117d.png)

cc: @spboyer 
",documentation,AaronRobinsonMSFT,26/06/2018 14:04,26/06/2018 23:52
18642,ARM: change reserved register (REG_OPT_RSVD) to LR,"Currently  is defined as R10. This is a preserved register which means if we need to reserve it we also need to save/restore it in the prolog/epilog.

Can we change this to scratch register LR instead to avoid this?

(We can't obviously use the other scratch register R12 because it is used in some special cases such as VSD dispatch.)
","ARM: change reserved register (REG_OPT_RSVD) to LR Currently  is defined as R10. This is a preserved register which means if we need to reserve it we also need to save/restore it in the prolog/epilog.

Can we change this to scratch register LR instead to avoid this?

(We can't obviously use the other scratch register R12 because it is used in some special cases such as VSD dispatch.)
",arch-arm32,BruceForstall,,
18641,Allow setting COR_PRF_ENABLE_REJIT after runtime startup,"It would useful to allow ReJIT on attach instead of it being restricted to scenarios where the profiler is loaded at startup.

This can be solved either such that only methods jitted after ReJIT is turned on are rejittable or make all jit compiled methods rejittable from the beginning of process startup. The former can be confusing but is probably easier to implement in the existing runtime with some error checking to fail on methods that are not rejittable.

If we go with the latter implementation calling SetEventMask with  will probably be a no-op and return success so that profilers don't have to change.","Allow setting COR_PRF_ENABLE_REJIT after runtime startup It would useful to allow ReJIT on attach instead of it being restricted to scenarios where the profiler is loaded at startup.

This can be solved either such that only methods jitted after ReJIT is turned on are rejittable or make all jit compiled methods rejittable from the beginning of process startup. The former can be confusing but is probably easier to implement in the existing runtime with some error checking to fail on methods that are not rejittable.

If we go with the latter implementation calling SetEventMask with  will probably be a no-op and return success so that profilers don't have to change.",area-TieredCompilation,davmason,,
18640,Cross-Platform COM Interop,"**Goal: enable interop with native libraries with COM ABI and a reasonable subset of COM features on all supported platforms.**

*Related issue with generic discussion: https://github.com/dotnet/coreclr/issues/11279*
This issue is to list specific work areas required to achieve the functionality:

* RCW (Runtime Callable Wrappers).
	* Managed proxy for a native VTable.
	* AddRef on native IUnknown until managed proxy is finalized (or Marshal Release/FinalRelease).
	* Turn managed casts into QI calls to native IUnknown.
	* Turn reflection/dynamic into IDispatch(Ex) calls to native object.

* CCW (COM Callable Wrappers).
	* Generate VTable expose native pointer to it.
	* Keep GC root until final release from native side.
	* Turn IDispatch calls into reflection/dynamic calls on the managed object.

* Marshalling.
	* Mostly the same as in PInvoke.
	* Non-preserve-sig handling:
		* HRESULT into Exception for RCW; Exception into HRESULT for CCW.
		* Out parameter vs. return value transform.
		* Pointer<->RCW and object<->CCW transform.
		
Supposedly most of the implementation should already be available from the .NET Framework code. WinAPI implementations should be substituted with crude fallbacks for trivial cases (no activation scenarios no cross-apartment call marshalling no proxy/stubs).
	
Activation: manual from a DLL file or possibly side-by-side scenarios. At first activation is out of scope suppose we create the first COM object with external means (e.g. Pinvoke + GetObjectForIUnknown).

Here are example scenarios for possible application of this functionality.
* CLR Debugger interfaces (ICorDebug et al). We have a success story of running the cross-platform implementation of debugger with native COM interop from C# with Mono on Linux and Mac. Mono has huge problems with correctness of the implementation yet if you're using only core features and trivial marshalling it's working enough to have a functioning debugger. The problems do not look fundamental just of the quality sort. Obviously we would now like to run the same code on CoreCLR.
* Visual Studio COM interfaces have proven a working example of a large-scale native-managed interop with native and managed parts mixed together with no clear separation. That's not exactly about porting but that's a good example of a multi-technology app with native/managed interop API.
* A few of our own helper libraries on Windows are exposing COM interfaces for object-oriented interaction with the app. This experience is nice to have on any platform.
","Cross-Platform COM Interop **Goal: enable interop with native libraries with COM ABI and a reasonable subset of COM features on all supported platforms.**

*Related issue with generic discussion: https://github.com/dotnet/coreclr/issues/11279*
This issue is to list specific work areas required to achieve the functionality:

* RCW (Runtime Callable Wrappers).
	* Managed proxy for a native VTable.
	* AddRef on native IUnknown until managed proxy is finalized (or Marshal Release/FinalRelease).
	* Turn managed casts into QI calls to native IUnknown.
	* Turn reflection/dynamic into IDispatch(Ex) calls to native object.

* CCW (COM Callable Wrappers).
	* Generate VTable expose native pointer to it.
	* Keep GC root until final release from native side.
	* Turn IDispatch calls into reflection/dynamic calls on the managed object.

* Marshalling.
	* Mostly the same as in PInvoke.
	* Non-preserve-sig handling:
		* HRESULT into Exception for RCW; Exception into HRESULT for CCW.
		* Out parameter vs. return value transform.
		* Pointer<->RCW and object<->CCW transform.
		
Supposedly most of the implementation should already be available from the .NET Framework code. WinAPI implementations should be substituted with crude fallbacks for trivial cases (no activation scenarios no cross-apartment call marshalling no proxy/stubs).
	
Activation: manual from a DLL file or possibly side-by-side scenarios. At first activation is out of scope suppose we create the first COM object with external means (e.g. Pinvoke + GetObjectForIUnknown).

Here are example scenarios for possible application of this functionality.
* CLR Debugger interfaces (ICorDebug et al). We have a success story of running the cross-platform implementation of debugger with native COM interop from C# with Mono on Linux and Mac. Mono has huge problems with correctness of the implementation yet if you're using only core features and trivial marshalling it's working enough to have a functioning debugger. The problems do not look fundamental just of the quality sort. Obviously we would now like to run the same code on CoreCLR.
* Visual Studio COM interfaces have proven a working example of a large-scale native-managed interop with native and managed parts mixed together with no clear separation. That's not exactly about porting but that's a good example of a multi-technology app with native/managed interop API.
* A few of our own helper libraries on Windows are exposing COM interfaces for object-oriented interaction with the app. This experience is nice to have on any platform.
",area-Interop,jkotas,26/06/2018 5:57,
18634,CoreCLR fails to run when mlock is unavailable,"CoreCLR uses  as something like:

    mmap(NULL 4096 PROT_READ|PROT_WRITE MAP_PRIVATE|MAP_ANONYMOUS -1 0) = 0x7fbd542bb000
    mlock(0x7fbd542bb000 4096)       = -1 EPERM (Operation not permitted)
    write(2 ""Failed to initialize CoreCLR HR""... 49) = 49

As a result this makes it basically impossible to build coreclr in some Linux distribution build systems.","CoreCLR fails to run when mlock is unavailable CoreCLR uses  as something like:

    mmap(NULL 4096 PROT_READ|PROT_WRITE MAP_PRIVATE|MAP_ANONYMOUS -1 0) = 0x7fbd542bb000
    mlock(0x7fbd542bb000 4096)       = -1 EPERM (Operation not permitted)
    write(2 ""Failed to initialize CoreCLR HR""... 49) = 49

As a result this makes it basically impossible to build coreclr in some Linux distribution build systems.",area-PAL,tmds,26/06/2018 1:56,21/11/2018 5:52
18632,Enable FEATURE_GDBJIT on default builds,On Linux/OSX it would be very nice if the default distributing has FEATURE_GDBJIT enabled so the debugging experience doesn't require manual building of SOS to have *some* debugging experience (presuming one sets the envvar needed for this),Enable FEATURE_GDBJIT on default builds On Linux/OSX it would be very nice if the default distributing has FEATURE_GDBJIT enabled so the debugging experience doesn't require manual building of SOS to have *some* debugging experience (presuming one sets the envvar needed for this),area-Diagnostics,mikem8361,,
18630,comcallablewrapper has very misleading commentary,"As part of the gutting of FEATURE_CORECLR ifdefs (https://github.com/dotnet/coreclr/commit/54891e0650e69f08832f75a40dc102efc6115d38#diff-ade4b3276f9a170febb781e66ab30039) appx-specific functionality got removed but this comment (https://github.com/dotnet/coreclr/blob/master/src/vm/comcallablewrapper.cpp#L1927-L1937) wasn't updated sending me on a wild goose chase for a few hours.

Was going to submit a PR but guidelines indicate bar wouldn't be met. I disagree hence this issue. Hope we can all agree this comment should be edited.

cc: @danmosemsft ","comcallablewrapper has very misleading commentary As part of the gutting of FEATURE_CORECLR ifdefs (https://github.com/dotnet/coreclr/commit/54891e0650e69f08832f75a40dc102efc6115d38#diff-ade4b3276f9a170febb781e66ab30039) appx-specific functionality got removed but this comment (https://github.com/dotnet/coreclr/blob/master/src/vm/comcallablewrapper.cpp#L1927-L1937) wasn't updated sending me on a wild goose chase for a few hours.

Was going to submit a PR but guidelines indicate bar wouldn't be met. I disagree hence this issue. Hope we can all agree this comment should be edited.

cc: @danmosemsft ",area-Interop,danmosemsft,25/06/2018 18:00,26/06/2018 6:13
18619,Add a memory budget to the GC,"As I understand it GC time is *very roughly* proportional to the number of object references alive. The total time an application spends in GC is also proportional to the number of (full) collections happening. It seems that on servers with a lot of memory there is an optimization opportunity: Collect less often. Simply allow huge amounts of garbage to build up. Allow 10 GBs of garbage to build up and blast it all away in a single G2 collection.

The .NET GC is very autotuning which is a great thing. For that reason by default the GC does not allow too much garbage to build up. This is a good thing because we don't want to impact other apps running on the server. Also this might not improve performance in all cases.

But the GC does not know what a developer is able to know. Developers can measure different GC settings and pick the best one. Developers also know their optimization goal (memory usage vs. CPU usage).

I therefore propose to add a simple tuning knob to the GC to tell it to use more memory than normal. I'm not sure what the best way to specify this would be. Maybe a setting . The developer can calculate an appropriate value at app startup based on the machine hardware. Or he can dynamically adjust this value based on free memory and based on the workload.

Use cases:

1. Server apps on servers with a lot of memory. My ASP.NET apps tend to use a few hundred MBs of memory on servers with many GBs of memory. A lot of memory ends up unused.
2. Console apps running GC heavy batch workloads.
3. Cloud apps where possibly total cost can be reduced by switching to a memory heavy instance. Pay more for memory and save on GC CPU cycles.
4. Games which want to experience less GC pauses on machines with ample memory.
","Add a memory budget to the GC As I understand it GC time is *very roughly* proportional to the number of object references alive. The total time an application spends in GC is also proportional to the number of (full) collections happening. It seems that on servers with a lot of memory there is an optimization opportunity: Collect less often. Simply allow huge amounts of garbage to build up. Allow 10 GBs of garbage to build up and blast it all away in a single G2 collection.

The .NET GC is very autotuning which is a great thing. For that reason by default the GC does not allow too much garbage to build up. This is a good thing because we don't want to impact other apps running on the server. Also this might not improve performance in all cases.

But the GC does not know what a developer is able to know. Developers can measure different GC settings and pick the best one. Developers also know their optimization goal (memory usage vs. CPU usage).

I therefore propose to add a simple tuning knob to the GC to tell it to use more memory than normal. I'm not sure what the best way to specify this would be. Maybe a setting . The developer can calculate an appropriate value at app startup based on the machine hardware. Or he can dynamically adjust this value based on free memory and based on the workload.

Use cases:

1. Server apps on servers with a lot of memory. My ASP.NET apps tend to use a few hundred MBs of memory on servers with many GBs of memory. A lot of memory ends up unused.
2. Console apps running GC heavy batch workloads.
3. Cloud apps where possibly total cost can be reduced by switching to a memory heavy instance. Pay more for memory and save on GC CPU cycles.
4. Games which want to experience less GC pauses on machines with ample memory.
",area-GC,luhenry,,
18617,macOS Mojave: Support for Hardened Runtime,"From https://github.com/xamarin/xamarin-macios/issues/4288 / https://github.com/mono/mono/issues/9210 :

In macOS Mojave Apple has introduced support for Hardened Runtime. (This is fully explained somewhere in the WWDC 2018 slides but I cannot right now find exactly where.) One of the hardening mechanisms is a limitation on JIT techniques. It is still fully possible and supported but the MAP_JIT flag must be passed to mmap() calls and a specific entitlement must also be present in the code signature. 

https://developer.apple.com/videos/play/wwdc2018/702/ 20 minute mark has details.","macOS Mojave: Support for Hardened Runtime From https://github.com/xamarin/xamarin-macios/issues/4288 / https://github.com/mono/mono/issues/9210 :

In macOS Mojave Apple has introduced support for Hardened Runtime. (This is fully explained somewhere in the WWDC 2018 slides but I cannot right now find exactly where.) One of the hardening mechanisms is a limitation on JIT techniques. It is still fully possible and supported but the MAP_JIT flag must be passed to mmap() calls and a specific entitlement must also be present in the code signature. 

https://developer.apple.com/videos/play/wwdc2018/702/ 20 minute mark has details.",area-VM,janvorli,,
18611,[WIP] Test with tiering,For https://github.com/dotnet/coreclr/pull/18610,[WIP] Test with tiering For https://github.com/dotnet/coreclr/pull/18610,* NO MERGE *,kouvel,,
18610,Apply tiering's call counting delay more broadly,"Issues
- When some time passes between process startup and first significant use of the app startup perf with tiering can be slower because the call counting delay is no longer in effect
- This is especially true when the process is affinitized to one cpu

Fixes
- Initiate and prolong the call counting delay upon tier 0 activity (jitting or r2r code lookup for a new method)
- Stop call counting for a called method when the delay is in effect
- Stop (and don't start) tier 1 jitting when the delay is in effect
- After the delay resume call counting and tier 1 jitting
- If the process is affinitized to one cpu at process startup multiply the delay by 10

No change in benchmarks.","Apply tiering's call counting delay more broadly Issues
- When some time passes between process startup and first significant use of the app startup perf with tiering can be slower because the call counting delay is no longer in effect
- This is especially true when the process is affinitized to one cpu

Fixes
- Initiate and prolong the call counting delay upon tier 0 activity (jitting or r2r code lookup for a new method)
- Stop call counting for a called method when the delay is in effect
- Stop (and don't start) tier 1 jitting when the delay is in effect
- After the delay resume call counting and tier 1 jitting
- If the process is affinitized to one cpu at process startup multiply the delay by 10

No change in benchmarks.",area-VM,kouvel,,
18609,Mirror changes from dotnet/corert,"This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**","Mirror changes from dotnet/corert This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**",,Anipik,,
18607,What is the proper way of doing incremental builds on Windows?,I am trying to make changes to native components (eg.  after configuring.,What is the proper way of doing incremental builds on Windows? I am trying to make changes to native components (eg.  after configuring.,area-Infrastructure-coreclr,jkotas,23/06/2018 0:01,
18603,RyuJIT and SIMD - suboptimal codegen when performing bitmask comparisons," which sets both _ZF_ and _CF_ (see http://www.felixcloutier.com/x86/PTEST.html).

category:cq
theme:vector-codegen
skill-level:expert
cost:medium","RyuJIT and SIMD - suboptimal codegen when performing bitmask comparisons  which sets both _ZF_ and _CF_ (see http://www.felixcloutier.com/x86/PTEST.html).

category:cq
theme:vector-codegen
skill-level:expert
cost:medium",area-CodeGen,jkotas,22/06/2018 15:29,
18602,"""Go to disassembly"" in VS aborts debugging session","Repro:

- Attach VS to CoreCLR process
- Find frame in System.Private.Corelib
- Select ""Go to disassembly""

Result: 

msvsmon.exe crashes
","""Go to disassembly"" in VS aborts debugging session Repro:

- Attach VS to CoreCLR process
- Find frame in System.Private.Corelib
- Select ""Go to disassembly""

Result: 

msvsmon.exe crashes
",area-Diagnostics,noahfalk,,
18599,Dllimport does not find libraries outside of system default (Linux),"@furoraest commented on [Sun May 20 2018](https://github.com/dotnet/core/issues/1575)

when doing PInvoke call like
[DllImport(""mylib"")]
        private static extern int some_external_func();
the dotnet does not find library unless in its some system default (like /usr/lib)
If to explicitly state the actual library name like ""libmylib.so.0.0.0"" it will find it 
ldconfig is finding the libraries correctly using ld.so.conf and stating custom library folder.
Temporary solution was to add LD_LIBRARY_PATH to the running environment  pointing to the library folder which should not be necessary if the ldconfig lists those libraries already.
If already linked library tries to use other library (outside the system default) when the dotnet program will get error:
dotnet: symbol lookup error: /usr/local/lib/libmylib.so: undefined symbol: _ZN2gr6some9awesome4functionEmmPcibi
Used platform: Ubuntu 18.04 and SDK 2.1 RC1
My current solution is to handload the all required libraries using this code:
[DllImport(""dl"")]
        private static extern IntPtr dlopen (string file int mode);
and then in the function somewhere before first call of the PInvoked function call out the libraries
dlopen(""libmyawesomelib-x.y.z.0.so.0.0.0"" RTLD_LAZY|RTLD_GLOBAL);
dlopen(""libmyawesomelib2-x.y.z.0.so.0.0.0"" RTLD_LAZY|RTLD_GLOBAL);


","Dllimport does not find libraries outside of system default (Linux) @furoraest commented on [Sun May 20 2018](https://github.com/dotnet/core/issues/1575)

when doing PInvoke call like
[DllImport(""mylib"")]
        private static extern int some_external_func();
the dotnet does not find library unless in its some system default (like /usr/lib)
If to explicitly state the actual library name like ""libmylib.so.0.0.0"" it will find it 
ldconfig is finding the libraries correctly using ld.so.conf and stating custom library folder.
Temporary solution was to add LD_LIBRARY_PATH to the running environment  pointing to the library folder which should not be necessary if the ldconfig lists those libraries already.
If already linked library tries to use other library (outside the system default) when the dotnet program will get error:
dotnet: symbol lookup error: /usr/local/lib/libmylib.so: undefined symbol: _ZN2gr6some9awesome4functionEmmPcibi
Used platform: Ubuntu 18.04 and SDK 2.1 RC1
My current solution is to handload the all required libraries using this code:
[DllImport(""dl"")]
        private static extern IntPtr dlopen (string file int mode);
and then in the function somewhere before first call of the PInvoked function call out the libraries
dlopen(""libmyawesomelib-x.y.z.0.so.0.0.0"" RTLD_LAZY|RTLD_GLOBAL);
dlopen(""libmyawesomelib2-x.y.z.0.so.0.0.0"" RTLD_LAZY|RTLD_GLOBAL);


",area-Interop,AaronRobinsonMSFT,,
18594,Consolidate testing guidelines,There are multiple documents under https://github.com/dotnet/coreclr/tree/master/Documentation/building that describe how testing can be accomplished. These docs include building and running tests. However since we are using platform agnostic tools the instructions should also be largely agnostic of platform. Minor command line differences but that are basically limited to use the .,Consolidate testing guidelines There are multiple documents under https://github.com/dotnet/coreclr/tree/master/Documentation/building that describe how testing can be accomplished. These docs include building and running tests. However since we are using platform agnostic tools the instructions should also be largely agnostic of platform. Minor command line differences but that are basically limited to use the .,area-Infrastructure-coreclr,AaronRobinsonMSFT,22/06/2018 2:57,
18586,Mirror changes from dotnet/corert,"This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**","Mirror changes from dotnet/corert This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**",,jkotas,,
18582,optimize fgMorphTree for GenTreeArgList,"We can't usually have deep trees because importer restricts trees depth:
https://github.com/dotnet/coreclr/blob/da40cb1ca8779566ca53ed6bd2fa67a926b29b38/src/jit/importer.cpp#L10173-L10178

However it doesn't restrict depth of .

Fixes DevDiv_635180.


No asm diffs no measurable instruction retired diff for System.Private.CoreLib.
","optimize fgMorphTree for GenTreeArgList We can't usually have deep trees because importer restricts trees depth:
https://github.com/dotnet/coreclr/blob/da40cb1ca8779566ca53ed6bd2fa67a926b29b38/src/jit/importer.cpp#L10173-L10178

However it doesn't restrict depth of .

Fixes DevDiv_635180.


No asm diffs no measurable instruction retired diff for System.Private.CoreLib.
",area-CodeGen,sandreenko,21/06/2018 9:45,30/06/2018 6:38
18580,Deadlock occuring after calling GetTypes() in visual studio,"First of all I'm new to this I'm not even sure I'm posting this at the right place. That being said here is my problem.

I have a C# application that lazy load a dll. In the constructor of a static class in that dll I have a call to GetTypes(). The problem seems to occur with a specific timming and only happens when running the application from visual studio. I'm running the .NET Framework 4.7.1.

To be clear:
MyExecutable.exe:
fffe1534
clr!DomainAssembly::DeliverAsyncEvents+0x40

I have a work around for now I simply construct my static class very soon the the application but I'm wondering if it's a known issue or if I'm doing something wrong.

Again the application works fine when not running it with visual studio.

Visual Studio Professional 2017
Version 15.6.1

.Net Framework
Version 4.7.02558","Deadlock occuring after calling GetTypes() in visual studio First of all I'm new to this I'm not even sure I'm posting this at the right place. That being said here is my problem.

I have a C# application that lazy load a dll. In the constructor of a static class in that dll I have a call to GetTypes(). The problem seems to occur with a specific timming and only happens when running the application from visual studio. I'm running the .NET Framework 4.7.1.

To be clear:
MyExecutable.exe:
fffe1534
clr!DomainAssembly::DeliverAsyncEvents+0x40

I have a work around for now I simply construct my static class very soon the the application but I'm wondering if it's a known issue or if I'm doing something wrong.

Again the application works fine when not running it with visual studio.

Visual Studio Professional 2017
Version 15.6.1

.Net Framework
Version 4.7.02558",area-AssemblyLoader,jkotas,21/06/2018 8:28,23/06/2018 3:37
18579,"DateTime.ToString(""d"") formats differently on Mac OS and Windows","When I have a DateTime that I call  I would expect that the formatted string would be the same on different platforms but for a date ""9/25/2017"" it produces 9/25/17 on MacOS and 9/25/2017 on windows.","DateTime.ToString(""d"") formats differently on Mac OS and Windows When I have a DateTime that I call  I would expect that the formatted string would be the same on different platforms but for a date ""9/25/2017"" it produces 9/25/17 on MacOS and 9/25/2017 on windows.",area-System.Globalization,jkotas,21/06/2018 6:10,21/06/2018 23:45
18577,ASP.NET core web API - OOM on Ubuntu after upgrade to 2.1.,"We have a .net core web API running on AWS Ubuntu 16.04 VM.
The API is using EF to query a relatively small DB and makes a lot of external requests due to integrations with other systems. After we upgraded to 2.1. we started to have serious OOM problems on production.  During the upgrade we haven't changed much in our execution logic aside from the changes needed to support the changes in the APIs. I made sure we are reusing HttpClients and that the DBContext objects are scoped honestly I don't think it is a memory leak from changes in our code. Moreover the app was running on the same environment with the same user load for roughly a year without problems. We make deployments regularly but let's say it could be running continuously for two weeks.

After the upgrade it consumes 6GB of ram for several hours and then crashes with OOM (actually the whole server crashes). The strange thing is that the memory used by the app goes up and barely goes down even in idle times. It's like barely anything gets released.

Looking at memory snapshots I can see a lot of memory cache collections growing big many of them used by entity framework and the Json.Net lib.

I'm sure that all that memory caching improves performance but my assumption is that the app should trade off performance for memory use based on the params of the system. Also it seems like the GC doesn't release memory but I'm not very familiar with how its implemented. I wonder why it used to work fine with 1.1. We are using supervisor to start and motor the service not sure if it matters but this is also not new.

Is there some important configuration I could be missing to tell the system how much in-memory caching it could do?

Checked a few issues which might be related but none seemed to offer a solution so far and I was not sure which is the 'most' related so I created this one. 

Possibly related:
https://github.com/dotnet/coreclr/issues/18044
https://github.com/dotnet/coreclr/issues/5551
https://github.com/aspnet/Home/issues/1976 (similar to what danports describes here and we are also considering downgrading after days of struggle) 

I noticed that most people reporting the problem are reporting it with web api projects. We have another dot net MVC app running on that machine which doesn't seem to have the problem but it has a significantly lower load the API is just faster to exhaust the memory.
","ASP.NET core web API - OOM on Ubuntu after upgrade to 2.1. We have a .net core web API running on AWS Ubuntu 16.04 VM.
The API is using EF to query a relatively small DB and makes a lot of external requests due to integrations with other systems. After we upgraded to 2.1. we started to have serious OOM problems on production.  During the upgrade we haven't changed much in our execution logic aside from the changes needed to support the changes in the APIs. I made sure we are reusing HttpClients and that the DBContext objects are scoped honestly I don't think it is a memory leak from changes in our code. Moreover the app was running on the same environment with the same user load for roughly a year without problems. We make deployments regularly but let's say it could be running continuously for two weeks.

After the upgrade it consumes 6GB of ram for several hours and then crashes with OOM (actually the whole server crashes). The strange thing is that the memory used by the app goes up and barely goes down even in idle times. It's like barely anything gets released.

Looking at memory snapshots I can see a lot of memory cache collections growing big many of them used by entity framework and the Json.Net lib.

I'm sure that all that memory caching improves performance but my assumption is that the app should trade off performance for memory use based on the params of the system. Also it seems like the GC doesn't release memory but I'm not very familiar with how its implemented. I wonder why it used to work fine with 1.1. We are using supervisor to start and motor the service not sure if it matters but this is also not new.

Is there some important configuration I could be missing to tell the system how much in-memory caching it could do?

Checked a few issues which might be related but none seemed to offer a solution so far and I was not sure which is the 'most' related so I created this one. 

Possibly related:
https://github.com/dotnet/coreclr/issues/18044
https://github.com/dotnet/coreclr/issues/5551
https://github.com/aspnet/Home/issues/1976 (similar to what danports describes here and we are also considering downgrading after days of struggle) 

I noticed that most people reporting the problem are reporting it with web api projects. We have another dot net MVC app running on that machine which doesn't seem to have the problem but it has a significantly lower load the API is just faster to exhaust the memory.
",area-GC,jkotas,21/06/2018 5:24,18/04/2019 10:33
18576,Mirror changes from Anipik/ corefx,"This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**","Mirror changes from Anipik/ corefx This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**",,Anipik,,
18572,Port Fix handling of generating relative path to parent (#18460),"Port of #18460

Fixes #30263","Port Fix handling of generating relative path to parent (#18460) Port of #18460

Fixes #30263",area-System.IO,JeremyKuhne,,
18565,Timeout build failures in 'prodcon/coreclr/release/2.1/' - '20180620.01',"There were a set of failures during this build. Here is a summary of these:
* https://devdiv.visualstudio.com/DefaultCollection/DevDiv/_build?_a=summary&buildId=1790648
  - **Agent:** DDVSOLINUXAGE003
  - **Error log:** The job running on agent DDVSOLINUXAGE003 has exceeded the maximum execution time of 90....

* https://devdiv.visualstudio.com/DefaultCollection/DevDiv/_build?_a=summary&buildId=1790650
  - **Agent:** DDVSOLINUXAGE005
  - **Error log:** The job running on agent DDVSOLINUXAGE005 has exceeded the maximum execution time of 90....

@mmitche @RussKeldorph
","Timeout build failures in 'prodcon/coreclr/release/2.1/' - '20180620.01' There were a set of failures during this build. Here is a summary of these:
* https://devdiv.visualstudio.com/DefaultCollection/DevDiv/_build?_a=summary&buildId=1790648
  - **Agent:** DDVSOLINUXAGE003
  - **Error log:** The job running on agent DDVSOLINUXAGE003 has exceeded the maximum execution time of 90....

* https://devdiv.visualstudio.com/DefaultCollection/DevDiv/_build?_a=summary&buildId=1790650
  - **Agent:** DDVSOLINUXAGE005
  - **Error log:** The job running on agent DDVSOLINUXAGE005 has exceeded the maximum execution time of 90....

@mmitche @RussKeldorph
",area-Infrastructure-coreclr,mmitche,20/06/2018 18:05,6/07/2018 6:50
18564,Segmentation fault in WKS::gc_heap::mark_object_simple on Linux,"On a linux machine running CentOS  7.5.1804 and Dotnet 2.1.300 I get the following segfault:



The program runs without problems in Windows. The only native library used is System.Data.SqlClient otherwise its all no-unsafe C# code. Unfortunately I have not been successful in reproducing the bug in a smaller program and I cannot share the original program.

It's possibly (likely?) a memory corruption bug and not a GC bug as I have also experienced some weird C# exceptions (stuff that should be logically impossible).","Segmentation fault in WKS::gc_heap::mark_object_simple on Linux On a linux machine running CentOS  7.5.1804 and Dotnet 2.1.300 I get the following segfault:



The program runs without problems in Windows. The only native library used is System.Data.SqlClient otherwise its all no-unsafe C# code. Unfortunately I have not been successful in reproducing the bug in a smaller program and I cannot share the original program.

It's possibly (likely?) a memory corruption bug and not a GC bug as I have also experienced some weird C# exceptions (stuff that should be logically impossible).",question,Maoni0,20/06/2018 17:06,12/01/2019 8:42
18562,R2R Dumper treats READYTORUN_SECTION_RUNTIME_FUNCTIONS as required,"Currently the dumper requires READYTORUN_SECTION_RUNTIME_FUNCTIONS section to be present. It is actually optional - see https://github.com/dotnet/coreclr/blob/master/src/vm/readytoruninfo.cpp#L551

We should handle the case where it's missing gracefully in r2rdump.","R2R Dumper treats READYTORUN_SECTION_RUNTIME_FUNCTIONS as required Currently the dumper requires READYTORUN_SECTION_RUNTIME_FUNCTIONS section to be present. It is actually optional - see https://github.com/dotnet/coreclr/blob/master/src/vm/readytoruninfo.cpp#L551

We should handle the case where it's missing gracefully in r2rdump.",area-ReadyToRun,acmyu,,
18560,GC.GetAllocatedBytesForCurrentThread always returns 0 when processor affinity is set to single proc,"When the processor affinity is set in explicit way 

@jkotas @Maoni0 is this expected behavior? am I doing something wrong? 

I am porting CoreCLR benchmarks from xunit-performance to BenchmarkDotNet and I have faced this issue today when I was comparing the results of some unstable benchmarks with affinity set and without.

/cc @jorive 
","GC.GetAllocatedBytesForCurrentThread always returns 0 when processor affinity is set to single proc When the processor affinity is set in explicit way 

@jkotas @Maoni0 is this expected behavior? am I doing something wrong? 

I am porting CoreCLR benchmarks from xunit-performance to BenchmarkDotNet and I have faced this issue today when I was comparing the results of some unstable benchmarks with affinity set and without.

/cc @jorive 
",area-GC,VSadov,,
18559,Mirror changes from Anipik/ corefx,"This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**","Mirror changes from Anipik/ corefx This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**",,Anipik,,
18558,Mirror changes from Anipik/ corefx,"This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**","Mirror changes from Anipik/ corefx This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**",,Anipik,,
18557,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,ViktorHofer,,
18554,Mirror changes from Anipik/ corefx,"This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**","Mirror changes from Anipik/ corefx This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**",,Anipik,,
18553,SSE2 Insert (pinsrw) has incorrect encoding on containment form,"SSE2 .

SSE4.1 Insert works fine and this bug seems introduced from the recent containment change.

I will look into this issue. cc @CarolEidt @tannergooding ","SSE2 Insert (pinsrw) has incorrect encoding on containment form SSE2 .

SSE4.1 Insert works fine and this bug seems introduced from the recent containment change.

I will look into this issue. cc @CarolEidt @tannergooding ",arch-x64,fiigii,,
18551,Avoid extra allocation in IDNA,Fixes #18545,Avoid extra allocation in IDNA Fixes #18545,area-System.Globalization,stephentoub,20/06/2018 4:30,20/06/2018 11:50
18549,Remove sbyte overloads of Intel AES intrinsics,Currently each ,Remove sbyte overloads of Intel AES intrinsics Currently each ,area-CodeGen,fiigii,,
18546,Avoid two unnecessary string.Substring calls in PunycodeDecode,cc: @tarekgh @krwq ,Avoid two unnecessary string.Substring calls in PunycodeDecode cc: @tarekgh @krwq ,area-System.Globalization,tarekgh,20/06/2018 2:24,20/06/2018 7:28
18545,GlobalizationMode.Invariant's PunycodeDecode repeatedly calling StringBuilder.ToString,"See all of these calls to  isn't changing in this region:
https://github.com/dotnet/coreclr/blob/473d9b09c7e000480f41021c94fbffeae27cb179/src/System.Private.CoreLib/shared/System/Globalization/IdnMapping.cs#L776-L806

Seems like this should either a) create the string once rather than repeatedly creating it or b) retrieve the char from the StringBuilder to test it rather than using a string and an index.  In other words worst case we should be allocating one string here best case zero.  Given the potential expense of indexing into a StringBuilder I'm not sure which ends up being faster.

cc: @tarekgh @krwq ","GlobalizationMode.Invariant's PunycodeDecode repeatedly calling StringBuilder.ToString See all of these calls to  isn't changing in this region:
https://github.com/dotnet/coreclr/blob/473d9b09c7e000480f41021c94fbffeae27cb179/src/System.Private.CoreLib/shared/System/Globalization/IdnMapping.cs#L776-L806

Seems like this should either a) create the string once rather than repeatedly creating it or b) retrieve the char from the StringBuilder to test it rather than using a string and an index.  In other words worst case we should be allocating one string here best case zero.  Given the potential expense of indexing into a StringBuilder I'm not sure which ends up being faster.

cc: @tarekgh @krwq ",area-System.Globalization,tarekgh,20/06/2018 2:16,20/06/2018 11:50
18544,[Linux/arm64]  GitHub_18497 fails with assert,"

@Caroleidt To track new failure introduced in #18499","[Linux/arm64]  GitHub_18497 fails with assert 

@Caroleidt To track new failure introduced in #18499",arch-arm64,CarolEidt,,
18543,Internal Error in the .NET Runtime,"Hi All
I'm not sure the right place to ask this but I could use some help.
It looks as though after an upgrade to .NET 4.7 we're having our apps randomly crash.
We're seeing errors like this:
Faulting module name: clr.dll version: 4.7.3110.0 time stamp: 0x5ae8c35b
Exception code: 0x800703e9
Fault offset: 0x002b15da
Faulting process id: 0x3110
Faulting application start time: 0x01d407cfc700c079
The process was terminated due to an internal error in the .NET Runtime at IP 72F215DA (72C70000) with exit code 800703e9.

What is the right process for getting this resolved?
","Internal Error in the .NET Runtime Hi All
I'm not sure the right place to ask this but I could use some help.
It looks as though after an upgrade to .NET 4.7 we're having our apps randomly crash.
We're seeing errors like this:
Faulting module name: clr.dll version: 4.7.3110.0 time stamp: 0x5ae8c35b
Exception code: 0x800703e9
Fault offset: 0x002b15da
Faulting process id: 0x3110
Faulting application start time: 0x01d407cfc700c079
The process was terminated due to an internal error in the .NET Runtime at IP 72F215DA (72C70000) with exit code 800703e9.

What is the right process for getting this resolved?
",question,RussKeldorph,20/06/2018 0:16,12/01/2019 8:39
18542,Inlined Struct wrapper .ctors are non-zero cost,"(Some now fixed by https://github.com/dotnet/coreclr/pull/19429)

This is problematic for example when adding formatting and/or buffering capabilities over 

category:cq
theme:structs
skill-level:expert
cost:medium","Inlined Struct wrapper .ctors are non-zero cost (Some now fixed by https://github.com/dotnet/coreclr/pull/19429)

This is problematic for example when adding formatting and/or buffering capabilities over 

category:cq
theme:structs
skill-level:expert
cost:medium",area-CodeGen,mikedn,19/06/2018 22:57,
18541,0xc0000005(Access violation) when StackOverflow happen in async path?,"Test with win10x64 netcoreapp2.1 vscode1.25(Insider)

Debug in vscode/vs. You can see app exited with 

</details>","0xc0000005(Access violation) when StackOverflow happen in async path? Test with win10x64 netcoreapp2.1 vscode1.25(Insider)

Debug in vscode/vs. You can see app exited with 

</details>",area-Diagnostics,jkotas,19/06/2018 22:47,
18539,Call native methods of the CLR itself from managed code,"Hi 
is it possible to call a c++ method of the program that hosts the CoreCLR from inside the loaded managed assembly?

I need to integrate a C# programm into my C++ simulation project. So I successfully set up my C++ Project to hosted the CoreCLR and I'm able to call functions from the C# Code.
Now the C# itself needs to call into the C++ Code.

I tried native calls using [DllImport] with some test library successfully. But the external method symbols should be looked up in the main programm instead of another lib like you can do with dlopen(NULL) on linux.

I have done that whole integration in mono a few month ago but as the C# code was origianaly build for .NET Core I want to go with it now.

In Mono you can use the __Internal keyword with the DllImport attribute to encounter this topic. Is there any possibility to do the same with .NETCore? 

Regards
Jens

PS: I cannot use LoadLibrary() since I'm on linux and hence cannot use the kernel32.dll","Call native methods of the CLR itself from managed code Hi 
is it possible to call a c++ method of the program that hosts the CoreCLR from inside the loaded managed assembly?

I need to integrate a C# programm into my C++ simulation project. So I successfully set up my C++ Project to hosted the CoreCLR and I'm able to call functions from the C# Code.
Now the C# itself needs to call into the C++ Code.

I tried native calls using [DllImport] with some test library successfully. But the external method symbols should be looked up in the main programm instead of another lib like you can do with dlopen(NULL) on linux.

I have done that whole integration in mono a few month ago but as the C# code was origianaly build for .NET Core I want to go with it now.

In Mono you can use the __Internal keyword with the DllImport attribute to encounter this topic. Is there any possibility to do the same with .NETCore? 

Regards
Jens

PS: I cannot use LoadLibrary() since I'm on linux and hence cannot use the kernel32.dll",area-Interop,jkotas,19/06/2018 21:23,4/01/2019 13:28
18537,Test failure: JIT_Regression._JitBlue_GitHub_18497_GitHub_18497_GitHub_18497_/_JitBlue_GitHub_18497_GitHub_18497_GitHub_18497_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/4ad925d1-68a5-4fb6-a02b-ec0e293a9d7b/Work/5adc0e71-0040-44e0-8eb2-8cc4d5380b66/Unzip/Reports\JIT.Regression\JitBlue\GitHub_18497\GitHub_18497\GitHub_18497.output.txt
    Raw output:
    BEGIN EXECUTION
    /home/helixbot/dotnetbuild/work/4ad925d1-68a5-4fb6-a02b-ec0e293a9d7b/Payload/corerun GitHub_18497.exe
    Failed: v = <1 1 236.1857 1 1 1 1 1>
    Expected: 100
    Actual: 255
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/4ad925d1-68a5-4fb6-a02b-ec0e293a9d7b/Payload
    > /home/helixbot/dotnetbuild/work/4ad925d1-68a5-4fb6-a02b-ec0e293a9d7b/Work/5adc0e71-0040-44e0-8eb2-8cc4d5380b66/Unzip/JitBlue/GitHub_18497/GitHub_18497/GitHub_18497.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

Details: 
https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180619.01/workItem/JIT.Regression.XUnitWrapper/analysis/xunit/JIT_Regression._JitBlue_GitHub_18497_GitHub_18497_GitHub_18497_~2F_JitBlue_GitHub_18497_GitHub_18497_GitHub_18497_cmd
        
Build : Master - 20180619.01 (Core Tests)
Failing configurations:
- redhat.69.amd64-x64
  - 
- ubuntu.1804.amd64-x64
  - 
- osx.1013.amd64-x64
  - 
- redhat.73.amd64-x64
  - 
- debian.82.amd64-x64
  -","Test failure: JIT_Regression._JitBlue_GitHub_18497_GitHub_18497_GitHub_18497_/_JitBlue_GitHub_18497_GitHub_18497_GitHub_18497_cmd Opened on behalf of @Sunny-pu

The test  has failed.


    
    Return code:      1
    Raw output file:      /home/helixbot/dotnetbuild/work/4ad925d1-68a5-4fb6-a02b-ec0e293a9d7b/Work/5adc0e71-0040-44e0-8eb2-8cc4d5380b66/Unzip/Reports\JIT.Regression\JitBlue\GitHub_18497\GitHub_18497\GitHub_18497.output.txt
    Raw output:
    BEGIN EXECUTION
    /home/helixbot/dotnetbuild/work/4ad925d1-68a5-4fb6-a02b-ec0e293a9d7b/Payload/corerun GitHub_18497.exe
    Failed: v = <1 1 236.1857 1 1 1 1 1>
    Expected: 100
    Actual: 255
    END EXECUTION - FAILED
    Test Harness Exitcode is : 1
    
    To run the test:
    > set CORE_ROOT=/home/helixbot/dotnetbuild/work/4ad925d1-68a5-4fb6-a02b-ec0e293a9d7b/Payload
    > /home/helixbot/dotnetbuild/work/4ad925d1-68a5-4fb6-a02b-ec0e293a9d7b/Work/5adc0e71-0040-44e0-8eb2-8cc4d5380b66/Unzip/JitBlue/GitHub_18497/GitHub_18497/GitHub_18497.sh
    
    Expected: True
    Actual:   False

        Stack Trace:

Details: 
https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180619.01/workItem/JIT.Regression.XUnitWrapper/analysis/xunit/JIT_Regression._JitBlue_GitHub_18497_GitHub_18497_GitHub_18497_~2F_JitBlue_GitHub_18497_GitHub_18497_GitHub_18497_cmd
        
Build : Master - 20180619.01 (Core Tests)
Failing configurations:
- redhat.69.amd64-x64
  - 
- ubuntu.1804.amd64-x64
  - 
- osx.1013.amd64-x64
  - 
- redhat.73.amd64-x64
  - 
- debian.82.amd64-x64
  -",test-run-core,RussKeldorph,,
18536,Adding types to R2R images using profiler metadata emit at ModuleLoadFinished triggers AV,"After the ModuleLoadFinished callback returns the runtime attempts to update a type loader cache called the 'AvailableClassHash'. Historically this cache was always created eagerly prior to ModuleLoadFinished being called but ReadyToRun changed the behavior to be lazy. Unfortunately the code path the profiler used to update that cache wasn't changed to account for the lazy creation so it attempts to insert into the non-existent cache and triggers an AV. I stumbled upon the issue accidentally while trying to test something else. My repro was adding a type forwarder to System.Runtime.dll but based on code review I think the issue also applies to adding new TypeDefs.
Currently 'Ready To Run' compilation is used for all framework images except System.Private.CoreLib.dll.

Callstack with the AV:

 	coreclr.dll!ClassLoader::AddExportedTypeHaveLock(Module * pManifestModule unsigned int cl AllocMemTracker * pamTracker) Line 4771	C++
 	[Inline Frame] coreclr.dll!ClassLoader::AddExportedTypeDontHaveLock(Module *) Line 4679	C++
	coreclr.dll!Assembly::AddExportedType(unsigned int cl) Line 2176	C++
 	coreclr.dll!Module::NotifyProfilerLoadFinished(HRESULT hr) Line 248	C++
 	coreclr.dll!DomainFile::PostLoadLibrary() Line 1035	C++
 	coreclr.dll!DomainFile::DoIncrementalLoad(FileLoadLevel level) Line 582	C++
 	coreclr.dll!AppDomain::TryIncrementalLoad(DomainFile * pFile FileLoadLevel workLevel Wrapper<FileLoadLock *&DoNothing<FileLoadLock *>&FileLoadLock::HolderLeave0&CompareDefault<FileLoadLock *>21> & lockHolder) Line 5841	C++
 	coreclr.dll!AppDomain::LoadDomainFile(FileLoadLock * pLock FileLoadLevel targetLevel) Line 5773	C++
 	coreclr.dll!AppDomain::LoadDomainAssemblyInternal(AssemblySpec * pIdentity PEAssembly * pFile FileLoadLevel targetLevel) Line 5603	C++
 	coreclr.dll!AppDomain::LoadDomainAssembly(AssemblySpec * pSpec PEAssembly * pFile FileLoadLevel targetLevel) Line 5490	C++
 	coreclr.dll!Module::LoadAssembly(AppDomain * pDomain unsigned int kAssemblyRef const char * szWinRtTypeNamespace const char * szWinRtTypeClassName) Line 5613	C++
 	coreclr.dll!Assembly::FindModuleByTypeRef(Module * pModule unsigned int tkType Loader::LoadFlag loadFlag int * pfNoResolutionScope) Line 1274	C++
 	coreclr.dll!ClassLoader::LoadTypeDefOrRefThrowing(Module * pModule unsigned int typeDefOrRef ClassLoader::NotFoundAction fNotFoundAction ClassLoader::PermitUninstantiatedFlag fUninstantiated unsigned int tokenNotToLoad ClassLoadLevel level) Line 3003	C++
 	coreclr.dll!ClassLoader::LoadApproxTypeThrowing(Module * pModule unsigned int tok SigPointer * pSigInst const SigTypeContext * pClassTypeContext) Line 3416	C++
 	[Inline Frame] coreclr.dll!ClassLoader::LoadApproxParentThrowing(Module *) Line 3462	C++
 	coreclr.dll!ClassLoader::CreateTypeHandleForTypeDefThrowing(Module * pModule unsigned int cl Instantiation inst AllocMemTracker * pamTracker) Line 11906	C++
 	coreclr.dll!ClassLoader::CreateTypeHandleForTypeKey(TypeKey * pKey AllocMemTracker * pamTracker) Line 3589	C++
 	coreclr.dll!ClassLoader::LoadTypeHandleForTypeKey_Body(TypeKey * pTypeKey TypeHandle typeHnd ClassLoadLevel targetLevel) Line 4325	C++
 	coreclr.dll!ClassLoader::LoadTypeHandleForTypeKey(TypeKey * pTypeKey TypeHandle typeHnd ClassLoadLevel targetLevel const InstantiationContext * pInstContext) Line 4044	C++
 	coreclr.dll!ClassLoader::LoadTypeDefThrowing(Module * pModule unsigned int typeDef ClassLoader::NotFoundAction fNotFoundAction ClassLoader::PermitUninstantiatedFlag fUninstantiated unsigned int tokenNotToLoad ClassLoadLevel level Instantiation * pTargetInstantiation) Line 2887	C++
 	coreclr.dll!ClassLoader::LoadTypeDefOrRefThrowing(Module * pModule unsigned int typeDefOrRef ClassLoader::NotFoundAction fNotFoundAction ClassLoader::PermitUninstantiatedFlag fUninstantiated unsigned int tokenNotToLoad ClassLoadLevel level) Line 3065	C++
 	coreclr.dll!Assembly::GetEntryPoint() Line 1918	C++
 	coreclr.dll!Assembly::ExecuteMainMethod(PtrArray * * stringArgs int) Line 1792	C++
 	coreclr.dll!CorHost2::ExecuteAssembly(unsigned long dwAppDomainId const wchar_t * pwzAssemblyPath int argc const wchar_t * * argv unsigned long * pReturnValue) Line 491	C++
 	coreclr.dll!coreclr_execute_assembly(void * hostHandle unsigned int domainId int argc const char * * argv const char * managedAssemblyPath unsigned int * exitCode) Line 407	C++
","Adding types to R2R images using profiler metadata emit at ModuleLoadFinished triggers AV After the ModuleLoadFinished callback returns the runtime attempts to update a type loader cache called the 'AvailableClassHash'. Historically this cache was always created eagerly prior to ModuleLoadFinished being called but ReadyToRun changed the behavior to be lazy. Unfortunately the code path the profiler used to update that cache wasn't changed to account for the lazy creation so it attempts to insert into the non-existent cache and triggers an AV. I stumbled upon the issue accidentally while trying to test something else. My repro was adding a type forwarder to System.Runtime.dll but based on code review I think the issue also applies to adding new TypeDefs.
Currently 'Ready To Run' compilation is used for all framework images except System.Private.CoreLib.dll.

Callstack with the AV:

 	coreclr.dll!ClassLoader::AddExportedTypeHaveLock(Module * pManifestModule unsigned int cl AllocMemTracker * pamTracker) Line 4771	C++
 	[Inline Frame] coreclr.dll!ClassLoader::AddExportedTypeDontHaveLock(Module *) Line 4679	C++
	coreclr.dll!Assembly::AddExportedType(unsigned int cl) Line 2176	C++
 	coreclr.dll!Module::NotifyProfilerLoadFinished(HRESULT hr) Line 248	C++
 	coreclr.dll!DomainFile::PostLoadLibrary() Line 1035	C++
 	coreclr.dll!DomainFile::DoIncrementalLoad(FileLoadLevel level) Line 582	C++
 	coreclr.dll!AppDomain::TryIncrementalLoad(DomainFile * pFile FileLoadLevel workLevel Wrapper<FileLoadLock *&DoNothing<FileLoadLock *>&FileLoadLock::HolderLeave0&CompareDefault<FileLoadLock *>21> & lockHolder) Line 5841	C++
 	coreclr.dll!AppDomain::LoadDomainFile(FileLoadLock * pLock FileLoadLevel targetLevel) Line 5773	C++
 	coreclr.dll!AppDomain::LoadDomainAssemblyInternal(AssemblySpec * pIdentity PEAssembly * pFile FileLoadLevel targetLevel) Line 5603	C++
 	coreclr.dll!AppDomain::LoadDomainAssembly(AssemblySpec * pSpec PEAssembly * pFile FileLoadLevel targetLevel) Line 5490	C++
 	coreclr.dll!Module::LoadAssembly(AppDomain * pDomain unsigned int kAssemblyRef const char * szWinRtTypeNamespace const char * szWinRtTypeClassName) Line 5613	C++
 	coreclr.dll!Assembly::FindModuleByTypeRef(Module * pModule unsigned int tkType Loader::LoadFlag loadFlag int * pfNoResolutionScope) Line 1274	C++
 	coreclr.dll!ClassLoader::LoadTypeDefOrRefThrowing(Module * pModule unsigned int typeDefOrRef ClassLoader::NotFoundAction fNotFoundAction ClassLoader::PermitUninstantiatedFlag fUninstantiated unsigned int tokenNotToLoad ClassLoadLevel level) Line 3003	C++
 	coreclr.dll!ClassLoader::LoadApproxTypeThrowing(Module * pModule unsigned int tok SigPointer * pSigInst const SigTypeContext * pClassTypeContext) Line 3416	C++
 	[Inline Frame] coreclr.dll!ClassLoader::LoadApproxParentThrowing(Module *) Line 3462	C++
 	coreclr.dll!ClassLoader::CreateTypeHandleForTypeDefThrowing(Module * pModule unsigned int cl Instantiation inst AllocMemTracker * pamTracker) Line 11906	C++
 	coreclr.dll!ClassLoader::CreateTypeHandleForTypeKey(TypeKey * pKey AllocMemTracker * pamTracker) Line 3589	C++
 	coreclr.dll!ClassLoader::LoadTypeHandleForTypeKey_Body(TypeKey * pTypeKey TypeHandle typeHnd ClassLoadLevel targetLevel) Line 4325	C++
 	coreclr.dll!ClassLoader::LoadTypeHandleForTypeKey(TypeKey * pTypeKey TypeHandle typeHnd ClassLoadLevel targetLevel const InstantiationContext * pInstContext) Line 4044	C++
 	coreclr.dll!ClassLoader::LoadTypeDefThrowing(Module * pModule unsigned int typeDef ClassLoader::NotFoundAction fNotFoundAction ClassLoader::PermitUninstantiatedFlag fUninstantiated unsigned int tokenNotToLoad ClassLoadLevel level Instantiation * pTargetInstantiation) Line 2887	C++
 	coreclr.dll!ClassLoader::LoadTypeDefOrRefThrowing(Module * pModule unsigned int typeDefOrRef ClassLoader::NotFoundAction fNotFoundAction ClassLoader::PermitUninstantiatedFlag fUninstantiated unsigned int tokenNotToLoad ClassLoadLevel level) Line 3065	C++
 	coreclr.dll!Assembly::GetEntryPoint() Line 1918	C++
 	coreclr.dll!Assembly::ExecuteMainMethod(PtrArray * * stringArgs int) Line 1792	C++
 	coreclr.dll!CorHost2::ExecuteAssembly(unsigned long dwAppDomainId const wchar_t * pwzAssemblyPath int argc const wchar_t * * argv unsigned long * pReturnValue) Line 491	C++
 	coreclr.dll!coreclr_execute_assembly(void * hostHandle unsigned int domainId int argc const char * * argv const char * managedAssemblyPath unsigned int * exitCode) Line 407	C++
",area-Diagnostics,sywhang,,
18533,EventSource ActivityIds not present in Release UWP (.NET Native) traces,"The attached UWP app ([ActivityIdUwp.zip](https://github.com/dotnet/coreclr/files/2113339/ActivityIdUwp.zip)) has a simple self-describing EventSource.



When you take a trace of a **debug** build of the app you will that ActivityIds are automatically computed for the stop and start events.

Event Name | Time MSec | Process Name | Rest
-- | -- | -- | --
TestEventSource/Test/Start | 13081.954 | ActivityIdUwp (10460) | ThreadID=""31964"" ProcessorNumber=""1"" ActivityID=""/#10460/1/1/""
TestEventSource/Test/Stop | 13237.359 | ActivityIdUwp (10460) | ThreadID=""31964"" ProcessorNumber=""1"" DURATION_MSEC=""155.405"" ActivityID=""/#10460/1/1/""

But when you take a trace of a **release** build of the app the activities are **not present**.

Event Name | Time MSec | Process Name | Rest
-- | -- | -- | --
TestEventSource/Test/Start | 9952.188 | ActivityIdUwp (25548) | ThreadID=""30972"" ProcessorNumber=""0""
TestEventSource/Test/Stop | 9958.760 | ActivityIdUwp (25548) | ThreadID=""30972"" ProcessorNumber=""0"" DURATION_MSEC=""6.573""

@brianrob since this could be related to issue [#18319 Classic EventSources don't work in Release builds using .NET Native (UWP)](https://github.com/dotnet/coreclr/issues/18319).

","EventSource ActivityIds not present in Release UWP (.NET Native) traces The attached UWP app ([ActivityIdUwp.zip](https://github.com/dotnet/coreclr/files/2113339/ActivityIdUwp.zip)) has a simple self-describing EventSource.



When you take a trace of a **debug** build of the app you will that ActivityIds are automatically computed for the stop and start events.

Event Name | Time MSec | Process Name | Rest
-- | -- | -- | --
TestEventSource/Test/Start | 13081.954 | ActivityIdUwp (10460) | ThreadID=""31964"" ProcessorNumber=""1"" ActivityID=""/#10460/1/1/""
TestEventSource/Test/Stop | 13237.359 | ActivityIdUwp (10460) | ThreadID=""31964"" ProcessorNumber=""1"" DURATION_MSEC=""155.405"" ActivityID=""/#10460/1/1/""

But when you take a trace of a **release** build of the app the activities are **not present**.

Event Name | Time MSec | Process Name | Rest
-- | -- | -- | --
TestEventSource/Test/Start | 9952.188 | ActivityIdUwp (25548) | ThreadID=""30972"" ProcessorNumber=""0""
TestEventSource/Test/Stop | 9958.760 | ActivityIdUwp (25548) | ThreadID=""30972"" ProcessorNumber=""0"" DURATION_MSEC=""6.573""

@brianrob since this could be related to issue [#18319 Classic EventSources don't work in Release builds using .NET Native (UWP)](https://github.com/dotnet/coreclr/issues/18319).

",area-Tracing,brianrob,19/06/2018 10:12,24/05/2019 7:40
18532,spmi doesn't report 'BAD_CODE`,"When spmi hits an assert it shows something like: 

","spmi doesn't report 'BAD_CODE
",area-Infrastructure-coreclr,sandreenko,19/06/2018 6:03,23/08/2018 9:25
18531,Mirror changes from dotnet/corert,"This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**","Mirror changes from dotnet/corert This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**",,jkotas,,
18528,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,jaredpar,,
18527,Mirror changes from Anipik/ corefx,"This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**","Mirror changes from Anipik/ corefx This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**",,Anipik,,
18525,Possible JIT \ cross-gen bug in xplat in 2.2.0-preview1-26614-02 of shared runtime,"We started seeing errors during runtime Razor view compilation once we upgraded to build 

We've usually seen these sort of errors on account due to bugs in cross-gen \ JIT.","Possible JIT \ cross-gen bug in xplat in 2.2.0-preview1-26614-02 of shared runtime We started seeing errors during runtime Razor view compilation once we upgraded to build 

We've usually seen these sort of errors on account due to bugs in cross-gen \ JIT.",area-CodeGen,jkotas,19/06/2018 3:04,19/06/2018 12:25
18522,Deterministic program outputs indeterministic results on Linux in release,"On Ubuntu 14.04 using current HEAD (71f4199) the following program outputs 0 in debug but seemingly random values in release. On Windows both debug and release output 0.
","Deterministic program outputs indeterministic results on Linux in release On Ubuntu 14.04 using current HEAD (71f4199) the following program outputs 0 in debug but seemingly random values in release. On Windows both debug and release output 0.
",area-CodeGen,AndyAyersMS,,
18521,Marshal.StructureToPtr() only marshals first element of an fixed-size buffer when structure is contained within a managed/non-blittable structure,"_From @kpreisser on June 17 2018 15:40_

Hi sorry if this isn't the right place to report this but I couldn't find other reports/explanations of this behavior.

I found that when using ) marshalling works correctly.

Thank you!

_Copied from original issue: dotnet/corefx#30473_","Marshal.StructureToPtr() only marshals first element of an fixed-size buffer when structure is contained within a managed/non-blittable structure _From @kpreisser on June 17 2018 15:40_

Hi sorry if this isn't the right place to report this but I couldn't find other reports/explanations of this behavior.

I found that when using ) marshalling works correctly.

Thank you!

_Copied from original issue: dotnet/corefx#30473_",area-Interop,jkotas,18/06/2018 3:56,4/10/2018 2:32
18517,Mirror changes from Anipik/ corefx,"This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**","Mirror changes from Anipik/ corefx This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**",,Anipik,,
18514,Mirror changes from Anipik/ corefx,"This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**","Mirror changes from Anipik/ corefx This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**",,Anipik,,
18513,Mirror changes from Anipik/ corefx,"This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**","Mirror changes from Anipik/ corefx This PR contains mirrored changes from Anipik/ corefx


**Please REBASE this PR when merging**",,Anipik,,
18501,Add an aggressively-clear GC mode,"There are workstreams which have higher than average requirements about being defensive against in-memory sniffing and heapdumps.  For those customers the clear-on-use behavior of the garbage collector may be a reason that they cannot use .NET or may cause them a lot of regulatory/compliance paperwork to use .NET.

While the primary responsibility of clearing sensitive data would fall on the application there's a fair amount of platform code which makes temporaries and leaves them to the GC.  Additionally immutable types (such as .","Add an aggressively-clear GC mode There are workstreams which have higher than average requirements about being defensive against in-memory sniffing and heapdumps.  For those customers the clear-on-use behavior of the garbage collector may be a reason that they cannot use .NET or may cause them a lot of regulatory/compliance paperwork to use .NET.

While the primary responsibility of clearing sensitive data would fall on the application there's a fair amount of platform code which makes temporaries and leaves them to the GC.  Additionally immutable types (such as .",area-GC,bartonjs,16/06/2018 11:20,
18498,x64 Ubuntu corefx jobs are broken,"Looks like there's a netci.groovy configuration problem where we have a flow job for the Linux corefx tests but don't need them. We have both of these jobs:



So they both get triggered e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_ubuntu_corefx_baseline_flow_prtest/31/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_ubuntu_corefx_baseline_prtest/342/

but the flow job fails.

Remove the flow/tst job for this case.
","x64 Ubuntu corefx jobs are broken Looks like there's a netci.groovy configuration problem where we have a flow job for the Linux corefx tests but don't need them. We have both of these jobs:



So they both get triggered e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_ubuntu_corefx_baseline_flow_prtest/31/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x64_checked_ubuntu_corefx_baseline_prtest/342/

but the flow job fails.

Remove the flow/tst job for this case.
",area-Infrastructure-coreclr,BruceForstall,,
18497,[PMI] Assertion failed 'tree->gtHasReg()' in System.Private.CoreLib.dll,,[PMI] Assertion failed 'tree->gtHasReg()' in System.Private.CoreLib.dll ,arch-x64,CarolEidt,,
18491,Logging errors on Linux similar to Windows Event Log,Logging unhandled exceptions to Windows Event Log was enabled with https://github.com/dotnet/coreclr/pull/16875 but currently we don't do anything on Linux. To match the diagnostics experience on Linux for .NET Core developers we should try to log exceptions to something like ,Logging errors on Linux similar to Windows Event Log Logging unhandled exceptions to Windows Event Log was enabled with https://github.com/dotnet/coreclr/pull/16875 but currently we don't do anything on Linux. To match the diagnostics experience on Linux for .NET Core developers we should try to log exceptions to something like ,area-Diagnostics,sywhang,16/06/2018 6:56,
18490,RegistrationServices support?,"Following the announcement that Windows Forms and WPF will be ported to .NET Core 3.0 I have a question about some complex (but necessary) COM interop that is currently not possible on .NET Core.

Suppose the following:

* I have an application developed in .NET Core 3 that will be distributed through the Windows Store.
* This application will include shell extensions (such as a preview handler) that are exposed through AppX Packaged COM.
* Due to restrictions inherent to Packaged COM these COM-visible types must be vended as an out-of-proc server rather than an in-proc handler.

On .NET Framework I can do this using [the  to be (re)introduced to CoreCLR or alternatively to document another technique for accomplishing this? Thanks!","RegistrationServices support? Following the announcement that Windows Forms and WPF will be ported to .NET Core 3.0 I have a question about some complex (but necessary) COM interop that is currently not possible on .NET Core.

Suppose the following:

* I have an application developed in .NET Core 3 that will be distributed through the Windows Store.
* This application will include shell extensions (such as a preview handler) that are exposed through AppX Packaged COM.
* Due to restrictions inherent to Packaged COM these COM-visible types must be vended as an out-of-proc server rather than an in-proc handler.

On .NET Framework I can do this using [the  to be (re)introduced to CoreCLR or alternatively to document another technique for accomplishing this? Thanks!",area-Interop,AaronRobinsonMSFT,,
18488,Profiler flag to ignore NGEN doesn't seem to be working,"/cc @noahfalk 

These [comments](https://github.com/dotnet/coreclr/pull/11040#issuecomment-298004449) indicate that the flag  in CoreFx with OpenCover which does specify the flag and works when the IL version of S.P.C.dll is used instead.

If this is something that can be changed on the short run I may be able to drop some work to restore CI coverage for S.P.C.dll (Windows only).","Profiler flag to ignore NGEN doesn't seem to be working /cc @noahfalk 

These [comments](https://github.com/dotnet/coreclr/pull/11040#issuecomment-298004449) indicate that the flag  in CoreFx with OpenCover which does specify the flag and works when the IL version of S.P.C.dll is used instead.

If this is something that can be changed on the short run I may be able to drop some work to restore CI coverage for S.P.C.dll (Windows only).",area-Diagnostics,noahfalk,16/06/2018 5:53,16/06/2018 11:49
18486,Double free or corruption on Raspbian,"After the move from .NETCore 2.0 to 2.1 this started happening very frequently.
PowerShell running on Raspberry Pi 3 Model B (""Raspbian GNU/Linux 9 (stretch)"")
crashes with:


Can share the core file with above stack.","Double free or corruption on Raspbian After the move from .NETCore 2.0 to 2.1 this started happening very frequently.
PowerShell running on Raspberry Pi 3 Model B (""Raspbian GNU/Linux 9 (stretch)"")
crashes with:


Can share the core file with above stack.",arch-arm32,janvorli,16/06/2018 4:14,29/08/2018 6:29
18485,Fix and re-enable StructABI test,This was disabled as part of #1928 but no issue was filed to track fixing and re-enabling it.,Fix and re-enable StructABI test This was disabled as part of #1928 but no issue was filed to track fixing and re-enabling it.,arch-x64,jashook,,
18482,Sequential structs with padding not passed correctly on Linux x64,"Repro:



Actual result:

0
3.880453E-39

Expected result:

1
10","Sequential structs with padding not passed correctly on Linux x64 Repro:



Actual result:

0
3.880453E-39

Expected result:

1
10",area-CodeGen,CarolEidt,,
18481,Investigate named mutexes on FreeBSD,"#18480 forced usage of flock() based implementation of named mutexes on FreeBSD. 
According to the detection phtread should work but following test was failing:

> threading/NamedMutex/test1/paltest_namedmutex_test1 test:
> 
> Child process: 'paltest_namedmutex_test1' failed at line 357. Expression: childRunningEvent.Release()
>  

this should be further investigated and understood. 
Note that there is libthr and libpthread on FreeBSD.

related to #18067
","Investigate named mutexes on FreeBSD #18480 forced usage of flock() based implementation of named mutexes on FreeBSD. 
According to the detection phtread should work but following test was failing:

> threading/NamedMutex/test1/paltest_namedmutex_test1 test:
> 
> Child process: 'paltest_namedmutex_test1' failed at line 357. Expression: childRunningEvent.Release()
>  

this should be further investigated and understood. 
Note that there is libthr and libpthread on FreeBSD.

related to #18067
",area-PAL,wfurt,15/06/2018 17:29,
18480,temporarily disable pthread based named mutexes on FreeBSD,"This should be further investigated.
With this change all PAL tests do pass now on FreeBSD.

related to #18067


","temporarily disable pthread based named mutexes on FreeBSD This should be further investigated.
With this change all PAL tests do pass now on FreeBSD.

related to #18067


",os-freebsd,wfurt,,
18479,fixes for  sos on FreeBSD,"add missing arch specific of libunwind so sos plugin can load.
Fix code for OS thread id so it does match with what lldb see. 

With this clrstack works on FreeBSD


","fixes for  sos on FreeBSD add missing arch specific of libunwind so sos plugin can load.
Fix code for OS thread id so it does match with what lldb see. 

With this clrstack works on FreeBSD


",os-freebsd,wfurt,,
18478,Question: Does profiling API support Linux?,"This was originally posted by @dotnetjt . To avoid pinging the subscribers to our announcement issue (#15136) with a potentially ongoing discussion I moved it here:

> Hi @noahfalk - just wondering if the profiling API support for Linux went out in 2.1. I've been coding off and on still working against a 2.1 preview.
> I fired up a new Ubuntu server and installed the 2.1 runtime and set up environment to point to my (portable) profiler library and it doesn't even attempt to load. I'm pretty sure it's not me as ldd shows that I'm not missing any libraries so all of my static linking is fine.
> Only other thing I can think of is that 2.1 doesn't support it yet.

Glad you reached out and sorry its causing you trouble! Linux is fully supported ([profiler status page](https://github.com/dotnet/coreclr/blob/master/Documentation/project-docs/profiling-api-status.md)) so this should work.

If you have a repro I could help diagnose the problem or if you are set up to [debug the runtime](https://github.com/dotnet/coreclr/blob/master/Documentation/building/debugging-instructions.md) (you don't need SOS regular C++ debugging is fine) you could set a breakpoint at https://github.com/dotnet/coreclr/blob/master/src/vm/profilinghelper.cpp#L690 and then see what fails.
","Question: Does profiling API support Linux? This was originally posted by @dotnetjt . To avoid pinging the subscribers to our announcement issue (#15136) with a potentially ongoing discussion I moved it here:

> Hi @noahfalk - just wondering if the profiling API support for Linux went out in 2.1. I've been coding off and on still working against a 2.1 preview.
> I fired up a new Ubuntu server and installed the 2.1 runtime and set up environment to point to my (portable) profiler library and it doesn't even attempt to load. I'm pretty sure it's not me as ldd shows that I'm not missing any libraries so all of my static linking is fine.
> Only other thing I can think of is that 2.1 doesn't support it yet.

Glad you reached out and sorry its causing you trouble! Linux is fully supported ([profiler status page](https://github.com/dotnet/coreclr/blob/master/Documentation/project-docs/profiling-api-status.md)) so this should work.

If you have a repro I could help diagnose the problem or if you are set up to [debug the runtime](https://github.com/dotnet/coreclr/blob/master/Documentation/building/debugging-instructions.md) (you don't need SOS regular C++ debugging is fine) you could set a breakpoint at https://github.com/dotnet/coreclr/blob/master/src/vm/profilinghelper.cpp#L690 and then see what fails.
",area-Diagnostics,noahfalk,,
18477,Ensure AdjustmentRule.DaylightDelta is within [-1212],"Fixes: https://github.com/dotnet/corefx/issues/29914

Unfortunately this is not ideal way to fix this - Linux currently lacks a good way to get BaseUtcOffset and getting it is purely heuristic. This PR ensures it is at least in the [-1212] range

cc: @jskeet","Ensure AdjustmentRule.DaylightDelta is within [-12,12] Fixes: https://github.com/dotnet/corefx/issues/29914

Unfortunately this is not ideal way to fix this - Linux currently lacks a good way to get BaseUtcOffset and getting it is purely heuristic. This PR ensures it is at least in the [-1212] range

cc: @jskeet",area-System.Runtime,krwq,,
18476,Enable unloading of AssemblyLoadContext,"This change is basically the work of @xoofx done some time ago rebased
to the current master and with added fixes. 

My contributions to it were:
* Extensive testing - running all 11753 coreclr Pri1 tests loaded into
AssemblyLoadContext including their dependencies and ensuring 
that they work (except the ones that use features not yet supported 
for unloading like thread local members COM interop).
That uncovered issues listed below.
* Fix few memory leaks
* Enable unloading of assemblies with PInvokes
* Fix virtual stub manager initialization
* Fix issue with unwind info regions reporting for stub linker
* Fix misplaced assert related to statics in collectible assemblies
* Fix issue with SOS domain enumeration.
* Fixed tests that were allocating but not freeing GCHandle that
was preventing the tests from unloading.

I recommend viewing the commits separately.

There is still a lot of work to do to enable e.g. unloading of assemblies
with classes having thread local members and other stuff. But it seems
worth merging these changes in.","Enable unloading of AssemblyLoadContext This change is basically the work of @xoofx done some time ago rebased
to the current master and with added fixes. 

My contributions to it were:
* Extensive testing - running all 11753 coreclr Pri1 tests loaded into
AssemblyLoadContext including their dependencies and ensuring 
that they work (except the ones that use features not yet supported 
for unloading like thread local members COM interop).
That uncovered issues listed below.
* Fix few memory leaks
* Enable unloading of assemblies with PInvokes
* Fix virtual stub manager initialization
* Fix issue with unwind info regions reporting for stub linker
* Fix misplaced assert related to statics in collectible assemblies
* Fix issue with SOS domain enumeration.
* Fixed tests that were allocating but not freeing GCHandle that
was preventing the tests from unloading.

I recommend viewing the commits separately.

There is still a lot of work to do to enable e.g. unloading of assemblies
with classes having thread local members and other stuff. But it seems
worth merging these changes in.",area-VM,janvorli,,
18475,fix the desktop build break,"Introduced by #18346.

.
After I merge PR #18318 I will try to sync the list of warnings enabled on desktop with CoreCLR to prevent such breaks.

PTAL @dotnet/jit-contrib ","fix the desktop build break Introduced by #18346.

.
After I merge PR #18318 I will try to sync the list of warnings enabled on desktop with CoreCLR to prevent such breaks.

PTAL @dotnet/jit-contrib ",area-CodeGen,sandreenko,15/06/2018 9:04,15/06/2018 10:44
18467,Intermittent failures in Fma test,"I have seen a couple of failures in this test that I can't repro even with various combinations of the  flags for the various ISAs. Not sure what's going on but there's no way that changing an ARM-only #define should cause this to fail. See https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_release_windows_nt_innerloop_prtest/4371/ and also https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_release_windows_nt_innerloop_prtest/4376/

The impacted test is Windows_NT.x86.Release\JIT\HardwareIntrinsics\X86\Fma_Vector256\Fma_ro\Fma_ro.cmd

It seems to pass on retry.","Intermittent failures in Fma test I have seen a couple of failures in this test that I can't repro even with various combinations of the  flags for the various ISAs. Not sure what's going on but there's no way that changing an ARM-only #define should cause this to fail. See https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_release_windows_nt_innerloop_prtest/4371/ and also https://ci.dot.net/job/dotnet_coreclr/job/master/job/x86_release_windows_nt_innerloop_prtest/4376/

The impacted test is Windows_NT.x86.Release\JIT\HardwareIntrinsics\X86\Fma_Vector256\Fma_ro\Fma_ro.cmd

It seems to pass on retry.",arch-x86,echesakovMSFT,,
18465,Linux performance problem,"Hello.

I've spotted a performance drop on ""Linux s4-srv 4.9.0-6-amd64 #1 SMP Debian 4.9.88-1+deb9u1 (2018-05-07) x86_64 GNU/Linux"" compared to Windows/MacOS.

Flame graphs:
![image](https://user-images.githubusercontent.com/3522038/41411837-de9a3232-6fe6-11e8-84f5-d340475951d4.png)

Debian PerfView view:
[deb.perfView.xml.zip](https://github.com/dotnet/coreclr/files/2102298/deb.perfView.xml.zip)


It looks like locale/encoding problem but changing system locale settings (as suggested in https://github.com/dotnet/coreclr/issues/5612) helps not.

Tried on .NET Core runtimes 2.0.7 and 2.1.0.
","Linux performance problem Hello.

I've spotted a performance drop on ""Linux s4-srv 4.9.0-6-amd64 #1 SMP Debian 4.9.88-1+deb9u1 (2018-05-07) x86_64 GNU/Linux"" compared to Windows/MacOS.

Flame graphs:
![image](https://user-images.githubusercontent.com/3522038/41411837-de9a3232-6fe6-11e8-84f5-d340475951d4.png)

Debian PerfView view:
[deb.perfView.xml.zip](https://github.com/dotnet/coreclr/files/2102298/deb.perfView.xml.zip)


It looks like locale/encoding problem but changing system locale settings (as suggested in https://github.com/dotnet/coreclr/issues/5612) helps not.

Tried on .NET Core runtimes 2.0.7 and 2.1.0.
",area-System.Runtime,mikem8361,14/06/2018 22:28,1/02/2019 7:15
18464,AssemblyBinding with codeBase and href : Support in CoreClr ?,"I wanted to solve problem of 

Here is sample project :

1. sf folder is console app that depends on sft library.
2. sft is strong signed.
3. sf has App.config referring to full location of sft library. Please update it to your local path.
4. hand craft sf.deps.json to remove references of sft.dll and move sft.dll to folder referred in (3).

[assemblybinding_codebase.zip](https://github.com/dotnet/coreclr/files/2101044/assemblybinding_codebase.zip)

","AssemblyBinding with codeBase and href : Support in CoreClr ? I wanted to solve problem of 

Here is sample project :

1. sf folder is console app that depends on sft library.
2. sft is strong signed.
3. sf has App.config referring to full location of sft library. Please update it to your local path.
4. hand craft sf.deps.json to remove references of sft.dll and move sft.dll to folder referred in (3).

[assemblybinding_codebase.zip](https://github.com/dotnet/coreclr/files/2101044/assemblybinding_codebase.zip)

",area-AssemblyLoader,jkotas,14/06/2018 16:24,2/11/2018 4:11
18463,Profiler rejit can break invariants in jit interface,"In CEEInfo::ScanToken we exit early if pModule is System.Private.CoreLib as a perf optimization since we expect that System.Private.CoreLib won't have any external references.

However profiler rejit can rewrite any IL including adding external references to IL in System.Private.CoreLib. In our profiler tests I observed the following chain of events.

1.  Profiler rejits System.Private.CoreLib code with calls to an external library that is not yet loaded
2.  When the code is rejitted the external library is not activated because CEEInfoScanToken exits early
3.  On the first call to the rejitted code the method from the external library is jitted and an assert fires because the module is not activated https://github.com/dotnet/coreclr/blob/6bf04a47badd74646e21e70f4e9267c71b7bfd08/src/vm/prestub.cpp#L1522

The test passes on retail but I'm afraid there may be some pathological case lurking here that can cause corruption or a crash.

Code for CEEInfo::ScanToken for reference
 https://github.com/dotnet/coreclr/blob/79b8f94cc52b6b79945074b748508a0b3cbb8be6/src/vm/jitinterface.cpp#L2801-L2884","Profiler rejit can break invariants in jit interface In CEEInfo::ScanToken we exit early if pModule is System.Private.CoreLib as a perf optimization since we expect that System.Private.CoreLib won't have any external references.

However profiler rejit can rewrite any IL including adding external references to IL in System.Private.CoreLib. In our profiler tests I observed the following chain of events.

1.  Profiler rejits System.Private.CoreLib code with calls to an external library that is not yet loaded
2.  When the code is rejitted the external library is not activated because CEEInfoScanToken exits early
3.  On the first call to the rejitted code the method from the external library is jitted and an assert fires because the module is not activated https://github.com/dotnet/coreclr/blob/6bf04a47badd74646e21e70f4e9267c71b7bfd08/src/vm/prestub.cpp#L1522

The test passes on retail but I'm afraid there may be some pathological case lurking here that can cause corruption or a crash.

Code for CEEInfo::ScanToken for reference
 https://github.com/dotnet/coreclr/blob/79b8f94cc52b6b79945074b748508a0b3cbb8be6/src/vm/jitinterface.cpp#L2801-L2884",area-Diagnostics,davmason,14/06/2018 15:32,16/06/2018 8:16
18460,Fix handling of generating relative path to parent,"Addresses https://github.com/dotnet/corefx/issues/30263

Test change in CoreFX will be linked in as soon as I post the PR.","Fix handling of generating relative path to parent Addresses https://github.com/dotnet/corefx/issues/30263

Test change in CoreFX will be linked in as soon as I post the PR.",area-System.IO,JeremyKuhne,,
18459,Intrinsic for the rdpmc instruction," intrinsic to the JIT so that it can be accessed in an efficient way. To access this functionality today the cheapest way would be to have a native function that wraps the intrinsic and pinvoke into that which for certain measurements perturbs what is being measured. But more annoyingly a new native dependency is required to achieve this.

This feature would be very valuable in getting crisp performance data from managed code directly.

category:design
theme:intrinsics
skill-level:intermediate
cost:large","Intrinsic for the rdpmc instruction  intrinsic to the JIT so that it can be accessed in an efficient way. To access this functionality today the cheapest way would be to have a native function that wraps the intrinsic and pinvoke into that which for certain measurements perturbs what is being measured. But more annoyingly a new native dependency is required to achieve this.

This feature would be very valuable in getting crisp performance data from managed code directly.

category:design
theme:intrinsics
skill-level:intermediate
cost:large",area-CodeGen,mjsabby,14/06/2018 7:20,
18458,Add Path.Join string overloads,"coreclr part of https://github.com/dotnet/corefx/issues/30049
corefx PR are ready to go https://github.com/dotnet/corefx/compare/master...MarcoRossignoli:joinoverloads

/cc @JeremyKuhne ","Add Path.Join string overloads coreclr part of https://github.com/dotnet/corefx/issues/30049
corefx PR are ready to go https://github.com/dotnet/corefx/compare/master...MarcoRossignoli:joinoverloads

/cc @JeremyKuhne ",area-System.IO,JeremyKuhne,14/06/2018 6:32,15/06/2018 3:30
18457,Fix allocation methods at few places in PAL,"In the utf8.cpp and process.cpp PAL was incorectly using the
global new operator. This results in calling this operator's
definition in coreclr runtime which is wrong. In the case
of the utf8 stuff a customer has reported a crash happening
due to that when the path from which the PAL was initialized
contained chinese characters.

The fix is to use InternalNew / InternalDelete functions instead.

I have also found that we were missing deletions of the DecoderFallbackBuffer
and EncoderFallbackBuffer so I have added them.","Fix allocation methods at few places in PAL In the utf8.cpp and process.cpp PAL was incorectly using the
global new operator. This results in calling this operator's
definition in coreclr runtime which is wrong. In the case
of the utf8 stuff a customer has reported a crash happening
due to that when the path from which the PAL was initialized
contained chinese characters.

The fix is to use InternalNew / InternalDelete functions instead.

I have also found that we were missing deletions of the DecoderFallbackBuffer
and EncoderFallbackBuffer so I have added them.",area-PAL,janvorli,,
18456,Added ISOWeek to System.Globalization,"Part of https://github.com/dotnet/corefx/issues/28933

// @tarekgh","Added ISOWeek to System.Globalization Part of https://github.com/dotnet/corefx/issues/28933

// @tarekgh",Hackathon,khellang,,
18455,Adds original error info to NotSupportedException during FileStream initialization,"Fixes #18454 

A couple of notes:
- I originally thought of throwing a Win32Exception but Win32Exception is not part of System.Private.Corelib;
- As I understand throwing a new exception type is a breaking change so instead I'm adding the error info to the current exception's InnerException
","Adds original error info to NotSupportedException during FileStream initialization Fixes #18454 

A couple of notes:
- I originally thought of throwing a Win32Exception but Win32Exception is not part of System.Private.Corelib;
- As I understand throwing a new exception type is a breaking change so instead I'm adding the error info to the current exception's InnerException
",area-System.IO,jkotas,13/06/2018 21:10,15/06/2018 1:09
18454,File.ReadAllBytes throws exception with a misleading message,"# TL;DR;
The application calls 

And here's the equivalent code on .NET Core: 
https://github.com/dotnet/coreclr/blob/f4e09d1898a8eb172e5c286102ef9d1269b38666/src/System.Private.CoreLib/shared/System/IO/FileStream.Windows.cs#L57-L66

The thing is any error returned from [GetFileType](https://msdn.microsoft.com/en-us/library/windows/desktop/aa364960.aspx) is ignored. In it's place a NotSupportedException with a fixed (and possibly misleading) message is thrown making it harder to troubleshoot real cause of the exception.
","File.ReadAllBytes throws exception with a misleading message # TL;DR;
The application calls 

And here's the equivalent code on .NET Core: 
https://github.com/dotnet/coreclr/blob/f4e09d1898a8eb172e5c286102ef9d1269b38666/src/System.Private.CoreLib/shared/System/IO/FileStream.Windows.cs#L57-L66

The thing is any error returned from [GetFileType](https://msdn.microsoft.com/en-us/library/windows/desktop/aa364960.aspx) is ignored. In it's place a NotSupportedException with a fixed (and possibly misleading) message is thrown making it harder to troubleshoot real cause of the exception.
",area-System.IO,jkotas,13/06/2018 20:57,15/06/2018 1:09
18453,JIT: don't track arg and local and temp ref classes in minopts or debug mode,"If the jit is not optimizing it doesn't need to ask the runtime for the declared types for ref class arguments and locals. Just knowing they are of  can become no-ops in minopts and debug modes.

category:throughput
theme:minopts
skill-level:expert
cost:large","JIT: don't track arg and local and temp ref classes in minopts or debug mode If the jit is not optimizing it doesn't need to ask the runtime for the declared types for ref class arguments and locals. Just knowing they are of  can become no-ops in minopts and debug modes.

category:throughput
theme:minopts
skill-level:expert
cost:large",JitThroughput,AndyAyersMS,13/06/2018 18:26,
18452,Perfcollect issue while executing perf script (kubernetes engine),"Hi

First of all my workload is on Kubernetes engine. We run our pods on  

Does anyone has faced this issue ?

Thank you.","Perfcollect issue while executing perf script (kubernetes engine) Hi

First of all my workload is on Kubernetes engine. We run our pods on  

Does anyone has faced this issue ?

Thank you.",area-Tracing,brianrob,13/06/2018 16:05,5/04/2019 10:05
18451,moving ARM HW Intrinsics files to shared partition,"As requested in https://github.com/dotnet/coreclr/pull/18427#discussion_r194609717 moving arm64 HWIntrinsics to shared partition.

Related to: #15922

cc: @eerhardt @tannergooding @sdmaclea @CarolEidt","moving ARM HW Intrinsics files to shared partition As requested in https://github.com/dotnet/coreclr/pull/18427#discussion_r194609717 moving arm64 HWIntrinsics to shared partition.

Related to: #15922

cc: @eerhardt @tannergooding @sdmaclea @CarolEidt",,maryamariyan,,
18450,Binding duplicated handle to ThreadPool fails?,"When I run the following code I get a System.ArgumentException: ''handle' has already been bound to the thread pool or was not opened for asynchronous I/O.'

This seems weird since it is a copy of the handle bound and it is definitely opened for async I/O. From a glance it looks like the error ultimately comes from CreateIoCompletionPort but that is weird because the documentation implies that you can use DuplicateHandle to share a handle registered to an IO completion port:

> It is best not to share a file handle associated with an I/O completion port by using either handle inheritance or a call to the DuplicateHandle function. Operations performed with such duplicate handles generate completion notifications. Careful consideration is advised.

Is the framework doing something funky here or is the reality more complicated than the documentation for CreateIoCompletionPort would lead you to think?



This is tested on dotnet core 2.1.30 and Windows 10.0.17686.1003.","Binding duplicated handle to ThreadPool fails? When I run the following code I get a System.ArgumentException: ''handle' has already been bound to the thread pool or was not opened for asynchronous I/O.'

This seems weird since it is a copy of the handle bound and it is definitely opened for async I/O. From a glance it looks like the error ultimately comes from CreateIoCompletionPort but that is weird because the documentation implies that you can use DuplicateHandle to share a handle registered to an IO completion port:

> It is best not to share a file handle associated with an I/O completion port by using either handle inheritance or a call to the DuplicateHandle function. Operations performed with such duplicate handles generate completion notifications. Careful consideration is advised.

Is the framework doing something funky here or is the reality more complicated than the documentation for CreateIoCompletionPort would lead you to think?



This is tested on dotnet core 2.1.30 and Windows 10.0.17686.1003.",area-System.IO,jkotas,13/06/2018 14:06,1/02/2019 3:51
18448,System.BadImageFormatException: 'Bad IL format.',"@atpyk commented on [Wed May 30 2018](https://github.com/dotnet/core/issues/1622)


I've upgraded dotnetcore2.0 to 2.1 and upgraded all packages too.
When I startup my web application the exception prompts.

StackTrace:
   at Microsoft.AspNetCore.Hosting.WebHostBuilder.BuildCommonServices(AggregateException& hostingStartupErrors)
   at Microsoft.AspNetCore.Hosting.WebHostBuilder.Build()
   at GrapeLEAF.AdminService.Program.BuildWebHost(String[] args) in E:\workspace\dotnet\XXX\XXX.AdminService\XXX.AdminService\Program.cs:line 16
   at GrapeLEAF.AdminService.Program.Main(String[] args) in E:\workspace\dotnet\XXX\XXX.AdminService\XXX.AdminService\Program.cs:line 12


---

@atpyk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393436939)

I uninstall original .net core sdk and runtime; and reinstall VS2017 and 2.1 sdk. 
I create a new webapi application by scaffold it doesn't work.


---

@VladislavAntonyuk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393459163)

https://blogs.msdn.microsoft.com/webdev/2018/05/07/asp-net-core-2-1-0-rc1-now-available/

---

@atpyk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393465743)

So sad it doesn't work too.

---

@VladislavAntonyuk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393482909)

Make sure you have installed the latest VS and try to reinstall .net core.
Roolback your changes to .net core 2.0 and follow the instruction I have sent you

---

@atpyk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393746933)

I debug into Microsoft.AspNetCore.Hosting and find out the error line:
 var hostingServices = BuildCommonServices(out var hostingStartupErrors);

It will throw the exception: 'Bad IL format.'

But if I rename this method to BuildCommonServices111 or other It works.
So weird~
It seems like the namespace ""Microsoft.AspNetCore.Hosting""  conflicts with others the .net runtime involves dlls of different version at same time.

---

@VladislavAntonyuk commented on [Fri Jun 01 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393803561)

make sure you have installed version 2.1.300 and try to uninstall all previous versions. Also doublecheck you have finished all steps in the instruction I've sent you 

---

@atpyk commented on [Fri Jun 01 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393810220)

I have reinstall my OS it works.
Thanks.

---

@mangod3 commented on [Sat Jun 02 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394127431)

Did you have NewRelic monitoring your .net app by any chance when you ran into the issue?

---

@Merurino commented on [Sun Jun 03 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394201129)

@mangod3 I was about to comment here. My issue seemed to be Newrelic. Was returning the IL issue. I was building it and running it on docker.



---

@mangod3 commented on [Sun Jun 03 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394224256)

@Merurino Thanks for responding. After debugging the issue it looks like the 2.1 changes related to code versioning (https://github.com/dotnet/coreclr/blob/master/Documentation/design-docs/code-versioning-profiler-breaking-changes.md) are causing issues with profiling APIs. @noahfalk who should we follow up with to get this investigated looks like the ILHeader is not getting initialized correctly after updating a method IL using SetILFunctionBody

---

@noahfalk commented on [Mon Jun 04 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394493650)

 Sorry you are running into trouble! Feel free to start with me as the investigator and I can pull in others as needed. To help get us started:
1) Could you post steps I can follow to try reproducing the problem?
2) Can you let me know what you observed while debugging that lead you to your conclusions?

---

@mangod3 commented on [Mon Jun 04 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394511301)

Thanks for your response @noahfalk. Will package up a repro and send over email. 

---

@joseclament commented on [Wed Jun 06 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395119603)

I have a web job built on netcoreapp2.1 console application targeting the win10-x64 and getting the  ""Unhandled Exception: System.BadImageFormatException: Could not load file or assembly exception"". 
I haven't had any issue with locally. Deployed using the visual studio directly to the app service. Any thoughts?

---

@noahfalk commented on [Wed Jun 06 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395221204)

@joseclament - Are you aware of any .NET profiler or monitoring agent being used in your deployment environment? If not we should probably a open a new issue because there would be a decent chance that the root cause for you will be unrelated to the root cause here.

---

@joseclament commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395337310)

@noahfalk  I am using AppInsight to push the logs other than no profiling or tooling.
Let me know if I need to open a new issue.


---

@nil4 commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395442460)

@noahfalk I am seeing a similar issue using the [AppDynamics .NET Core profiler agent](https://docs.appdynamics.com/display/PRO44/Install+the+.NET+Core+Microservices+Agent+for+Windows) on a netcoreapp2.1 application and .NET Core SDK 2.1.300. 

When the application starts the following exception is thrown:



---

@noahfalk commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395550918)

@joseclament - Glad you were able to get the bottom of it and very appreciated that you came back to post your findings in case others hit the same issue in the future! Indeed it looks like your issue had a similar symptom but different root cause than the other ones here. I created #1670 to track any further work there.

@nil4 - Thanks for the repro! Let me try repro your issue so we can figure out if this is the same root cause or something else. 

---

@noahfalk commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395614005)

@nil4 - Thanks I was able to reproduce the problem easily using your excellent instructions! Although the AppDynamics issue is slighly different than the NewRelic one (AppDynamics does not call ICorProfilerInfo::SetILFunctionBody or ICorProfilerFunctionControl::SetILFunctionBody)  the fix I submitted earlier today (#18322) does solve both issues at the same time.

I wasn't sure if you were an employee with AppDynamics or a customer of AppDynamics? For potential short term resolutions to the issue you could either continue to use .Net Core 2.0 or use a daily build of .Net Core that has this fix as soon as the installers are ready for download (I'll write back again when they are). A little further in the future I'm attempting to get this fix into the official servicing releases for 2.1. I can also try to reach out to AppDynamics to see if there are any additional solutions available for the issue.

Let me know if you've got any other questions or concerns?

---

@nil4 commented on [Fri Jun 08 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395689332)

@noahfalk glad I could help and thank you for the update much appreciated! I am a customer and have opened an AppDynamics support ticket about this; will update it shortly with a link to this issue.

","System.BadImageFormatException: 'Bad IL format.' @atpyk commented on [Wed May 30 2018](https://github.com/dotnet/core/issues/1622)


I've upgraded dotnetcore2.0 to 2.1 and upgraded all packages too.
When I startup my web application the exception prompts.

StackTrace:
   at Microsoft.AspNetCore.Hosting.WebHostBuilder.BuildCommonServices(AggregateException& hostingStartupErrors)
   at Microsoft.AspNetCore.Hosting.WebHostBuilder.Build()
   at GrapeLEAF.AdminService.Program.BuildWebHost(String[] args) in E:\workspace\dotnet\XXX\XXX.AdminService\XXX.AdminService\Program.cs:line 16
   at GrapeLEAF.AdminService.Program.Main(String[] args) in E:\workspace\dotnet\XXX\XXX.AdminService\XXX.AdminService\Program.cs:line 12


---

@atpyk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393436939)

I uninstall original .net core sdk and runtime; and reinstall VS2017 and 2.1 sdk. 
I create a new webapi application by scaffold it doesn't work.


---

@VladislavAntonyuk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393459163)

https://blogs.msdn.microsoft.com/webdev/2018/05/07/asp-net-core-2-1-0-rc1-now-available/

---

@atpyk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393465743)

So sad it doesn't work too.

---

@VladislavAntonyuk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393482909)

Make sure you have installed the latest VS and try to reinstall .net core.
Roolback your changes to .net core 2.0 and follow the instruction I have sent you

---

@atpyk commented on [Thu May 31 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393746933)

I debug into Microsoft.AspNetCore.Hosting and find out the error line:
 var hostingServices = BuildCommonServices(out var hostingStartupErrors);

It will throw the exception: 'Bad IL format.'

But if I rename this method to BuildCommonServices111 or other It works.
So weird~
It seems like the namespace ""Microsoft.AspNetCore.Hosting""  conflicts with others the .net runtime involves dlls of different version at same time.

---

@VladislavAntonyuk commented on [Fri Jun 01 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393803561)

make sure you have installed version 2.1.300 and try to uninstall all previous versions. Also doublecheck you have finished all steps in the instruction I've sent you 

---

@atpyk commented on [Fri Jun 01 2018](https://github.com/dotnet/core/issues/1622#issuecomment-393810220)

I have reinstall my OS it works.
Thanks.

---

@mangod3 commented on [Sat Jun 02 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394127431)

Did you have NewRelic monitoring your .net app by any chance when you ran into the issue?

---

@Merurino commented on [Sun Jun 03 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394201129)

@mangod3 I was about to comment here. My issue seemed to be Newrelic. Was returning the IL issue. I was building it and running it on docker.



---

@mangod3 commented on [Sun Jun 03 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394224256)

@Merurino Thanks for responding. After debugging the issue it looks like the 2.1 changes related to code versioning (https://github.com/dotnet/coreclr/blob/master/Documentation/design-docs/code-versioning-profiler-breaking-changes.md) are causing issues with profiling APIs. @noahfalk who should we follow up with to get this investigated looks like the ILHeader is not getting initialized correctly after updating a method IL using SetILFunctionBody

---

@noahfalk commented on [Mon Jun 04 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394493650)

 Sorry you are running into trouble! Feel free to start with me as the investigator and I can pull in others as needed. To help get us started:
1) Could you post steps I can follow to try reproducing the problem?
2) Can you let me know what you observed while debugging that lead you to your conclusions?

---

@mangod3 commented on [Mon Jun 04 2018](https://github.com/dotnet/core/issues/1622#issuecomment-394511301)

Thanks for your response @noahfalk. Will package up a repro and send over email. 

---

@joseclament commented on [Wed Jun 06 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395119603)

I have a web job built on netcoreapp2.1 console application targeting the win10-x64 and getting the  ""Unhandled Exception: System.BadImageFormatException: Could not load file or assembly exception"". 
I haven't had any issue with locally. Deployed using the visual studio directly to the app service. Any thoughts?

---

@noahfalk commented on [Wed Jun 06 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395221204)

@joseclament - Are you aware of any .NET profiler or monitoring agent being used in your deployment environment? If not we should probably a open a new issue because there would be a decent chance that the root cause for you will be unrelated to the root cause here.

---

@joseclament commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395337310)

@noahfalk  I am using AppInsight to push the logs other than no profiling or tooling.
Let me know if I need to open a new issue.


---

@nil4 commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395442460)

@noahfalk I am seeing a similar issue using the [AppDynamics .NET Core profiler agent](https://docs.appdynamics.com/display/PRO44/Install+the+.NET+Core+Microservices+Agent+for+Windows) on a netcoreapp2.1 application and .NET Core SDK 2.1.300. 

When the application starts the following exception is thrown:



---

@noahfalk commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395550918)

@joseclament - Glad you were able to get the bottom of it and very appreciated that you came back to post your findings in case others hit the same issue in the future! Indeed it looks like your issue had a similar symptom but different root cause than the other ones here. I created #1670 to track any further work there.

@nil4 - Thanks for the repro! Let me try repro your issue so we can figure out if this is the same root cause or something else. 

---

@noahfalk commented on [Thu Jun 07 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395614005)

@nil4 - Thanks I was able to reproduce the problem easily using your excellent instructions! Although the AppDynamics issue is slighly different than the NewRelic one (AppDynamics does not call ICorProfilerInfo::SetILFunctionBody or ICorProfilerFunctionControl::SetILFunctionBody)  the fix I submitted earlier today (#18322) does solve both issues at the same time.

I wasn't sure if you were an employee with AppDynamics or a customer of AppDynamics? For potential short term resolutions to the issue you could either continue to use .Net Core 2.0 or use a daily build of .Net Core that has this fix as soon as the installers are ready for download (I'll write back again when they are). A little further in the future I'm attempting to get this fix into the official servicing releases for 2.1. I can also try to reach out to AppDynamics to see if there are any additional solutions available for the issue.

Let me know if you've got any other questions or concerns?

---

@nil4 commented on [Fri Jun 08 2018](https://github.com/dotnet/core/issues/1622#issuecomment-395689332)

@noahfalk glad I could help and thank you for the update much appreciated! I am a customer and have opened an AppDynamics support ticket about this; will update it shortly with a link to this issue.

",area-TieredCompilation,noahfalk,,
18447,.Net Core and Native dll's always throw BadImageFormat,"@SharperC commented on [Sun Jun 10 2018](https://github.com/dotnet/core/issues/1678)

# BadImageFormatException everytime...

After a LOT of times trying to load native code or rather call a native method using  to switch architectures (when launching a sub-process) but until then it's a bit of a pain - https://github.com/dotnet/sdk/issues/1905

---

@SharperC commented on [Mon Jun 11 2018](https://github.com/dotnet/core/issues/1678#issuecomment-396254074)

@markusschaber I know that you mean but i tried both using a 32bit and a 64bit for c++ and dotnet and yes a already noticed that dotnet tends to totaly ignore if you set the assembly in vs to 32 bit

",".Net Core and Native dll's always throw BadImageFormat @SharperC commented on [Sun Jun 10 2018](https://github.com/dotnet/core/issues/1678)

# BadImageFormatException everytime...

After a LOT of times trying to load native code or rather call a native method using  to switch architectures (when launching a sub-process) but until then it's a bit of a pain - https://github.com/dotnet/sdk/issues/1905

---

@SharperC commented on [Mon Jun 11 2018](https://github.com/dotnet/core/issues/1678#issuecomment-396254074)

@markusschaber I know that you mean but i tried both using a 32bit and a 64bit for c++ and dotnet and yes a already noticed that dotnet tends to totaly ignore if you set the assembly in vs to 32 bit

",area-AssemblyLoader,,,
18446,SUSE dotnet 2.0.3 Description: Infinite recursion during resource lookup within System.Private.CoreLib.,"@iga1976 commented on [Tue Jun 12 2018](https://github.com/dotnet/core/issues/1687)

SUSE dotnet 2.0.3 Description: Infinite recursion during resource lookup within System.Private.CoreLib. This may be a bug in System.Private.CoreLib or potentially in certain extensibility points such as assembly resolve events or CultureInfo names. Resource name: ArgumentNull_Generic 
https://github.com/dotnet/corefx/issues/30208



","SUSE dotnet 2.0.3 Description: Infinite recursion during resource lookup within System.Private.CoreLib. @iga1976 commented on [Tue Jun 12 2018](https://github.com/dotnet/core/issues/1687)

SUSE dotnet 2.0.3 Description: Infinite recursion during resource lookup within System.Private.CoreLib. This may be a bug in System.Private.CoreLib or potentially in certain extensibility points such as assembly resolve events or CultureInfo names. Resource name: ArgumentNull_Generic 
https://github.com/dotnet/corefx/issues/30208



",area-AssemblyLoader,kouvel,13/06/2018 13:12,27/10/2018 6:56
18445,EEJitManager::SetCpuInfo is not exactly matching the ISA hierarchy described by the architecture manuals,"SSE/SSE2 support requires:
* Check for CPUID support
* Check the SSE and/or SSE2 flag

SSE3 support requires:
* Check for SSE/SSE2 support
* Check the SSE3 flag

SSSE3 support requires:
* Check for SSE/SSE2 support
* Check the SSSE3 flag

SSE4.1 support requires:
* Check for SSE/SSE2 Support
* Check for SSE3 Support
* Check for SSSE3 Support
* Check the SSE4.1 flag

SSE4.2 support requires:
* Check for SSE/SSE2 Support
* Check for SSSE3 Support
* Check for SSE4.1 Support
* Check the SSE4.2 flag

etc...","EEJitManager::SetCpuInfo is not exactly matching the ISA hierarchy described by the architecture manuals SSE/SSE2 support requires:
* Check for CPUID support
* Check the SSE and/or SSE2 flag

SSE3 support requires:
* Check for SSE/SSE2 support
* Check the SSE3 flag

SSSE3 support requires:
* Check for SSE/SSE2 support
* Check the SSSE3 flag

SSE4.1 support requires:
* Check for SSE/SSE2 Support
* Check for SSE3 Support
* Check for SSSE3 Support
* Check the SSE4.1 flag

SSE4.2 support requires:
* Check for SSE/SSE2 Support
* Check for SSSE3 Support
* Check for SSE4.1 Support
* Check the SSE4.2 flag

etc...",area-CodeGen,tannergooding,,
18444,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,Anipik,,
18443,[arm/Ubuntu] JIT/Methodical/ELEMENT_TYPE_IU/_il_relu_fld/_il_relu_fld.sh failed in gcstress,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_zapdisable_heapverify1_tst/12/consoleFull#-8536224876a086b3e-df04-41d2-bc4d-43e8f9406d07



I could not reproduce this failure.","[arm/Ubuntu] JIT/Methodical/ELEMENT_TYPE_IU/_il_relu_fld/_il_relu_fld.sh failed in gcstress https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_zapdisable_heapverify1_tst/12/consoleFull#-8536224876a086b3e-df04-41d2-bc4d-43e8f9406d07



I could not reproduce this failure.",GCStress,BruceForstall,13/06/2018 8:55,13/06/2018 8:55
18441,[arm/Ubuntu] crash under GCStress in test b65423.exe,"E.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_zapdisable_tst/12/consoleFull#-5931779914b7730ef-150b-4be7-a00f-82ba6c50792b

. I've never seen it take more than 4 runs in a row to reproduce. I can't reproduce the crash under GDB.
","[arm/Ubuntu] crash under GCStress in test b65423.exe E.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_zapdisable_tst/12/consoleFull#-5931779914b7730ef-150b-4be7-a00f-82ba6c50792b

. I've never seen it take more than 4 runs in a row to reproduce. I can't reproduce the crash under GDB.
",GCStress,BruceForstall,,
18439,Crash in coreclr when muxer/apphost path contains valid UTF-8 sequence,"## Steps to reproduce

On macOS 10.13 (with brew installed 

","Crash in coreclr when muxer/apphost path contains valid UTF-8 sequence ## Steps to reproduce

On macOS 10.13 (with brew installed 

",area-PAL,janvorli,,
18437,GC KeepAlive test incorrectly assumes GC activity,"tests\src\GC\API\GC\keepalive.cs is testing  function is made fully interruptible which allows for more GCStress-caused GC events.
","GC KeepAlive test incorrectly assumes GC activity tests\src\GC\API\GC\keepalive.cs is testing  function is made fully interruptible which allows for more GCStress-caused GC events.
",GCStress,BruceForstall,13/06/2018 4:53,14/06/2018 8:04
18436,Move SSE/SSE2 Set[All]Vector128 helpers to JIT implementation,"The current managed implementation of SSE/SSE2 ). I will look into moving them to JIT-inside implementation.

cc @CarolEidt @tannergooding ","Move SSE/SSE2 Set[All]Vector128 helpers to JIT implementation The current managed implementation of SSE/SSE2 ). I will look into moving them to JIT-inside implementation.

cc @CarolEidt @tannergooding ",area-CodeGen,fiigii,,
18434,Make Line numbers work for crossgened DLLs when profiling with EventPipe ,"Useing the 2.1 version of .NET Core you profile a simple app .NET Core App o (e.g. a spin loop like)

Using EventPipe (e.g. set COMPlus_EnableEventPipe=1 and run the app) and then open the resulting *.netperf file you will find that PerfView's 'Goto Source' feature works in the main program attributing the cost to the correct source line.  

However if you open up frames that are inside the framework (e.g. System.TimeZoneInfo.GetLocalTimeZoneFromTzFile) you will find that while PerfView can open the source code (it can correctly find the PDBS for System.Private.Corelib.pdb and the source files on Github) but it will attribute all the cost the the first line in the method.

This is because PerfView lacks the Native->IL mapping needed to map to a particular IL instruction (which in turn can be mapped to a particular line).     These normally given to perfView by the ILToNativeMap events in the runtime.  (Normally PerfView hides these events when you look at a trace but if you pass PerfView the /keepAllEvents when the trace is converted you can see them).  

What you will find is that the mappings exist for all JIT compiled methods (at the time of JIT as well as during rundown) but there are no ILToNativeMap rundown events for DLLs that have been precompiled with Crossgen (which is most of the framework). 

We do force the rundown of all methods (DCStopVerbose) that are precompiled (that is how we know the method) but we do currently do this for the ILToNativeMap.   

Thus the most straightforward solution is to simply log the ILToNativeMap during this rundown as well.  

This will be alot of data and it may not be needed for simple investigations but I think it is best to do the simple thing (always include it) and we can talk about having options for turning it off for advanced scenarios that care about file size.   

@brianrob 


","Make Line numbers work for crossgened DLLs when profiling with EventPipe  Useing the 2.1 version of .NET Core you profile a simple app .NET Core App o (e.g. a spin loop like)

Using EventPipe (e.g. set COMPlus_EnableEventPipe=1 and run the app) and then open the resulting *.netperf file you will find that PerfView's 'Goto Source' feature works in the main program attributing the cost to the correct source line.  

However if you open up frames that are inside the framework (e.g. System.TimeZoneInfo.GetLocalTimeZoneFromTzFile) you will find that while PerfView can open the source code (it can correctly find the PDBS for System.Private.Corelib.pdb and the source files on Github) but it will attribute all the cost the the first line in the method.

This is because PerfView lacks the Native->IL mapping needed to map to a particular IL instruction (which in turn can be mapped to a particular line).     These normally given to perfView by the ILToNativeMap events in the runtime.  (Normally PerfView hides these events when you look at a trace but if you pass PerfView the /keepAllEvents when the trace is converted you can see them).  

What you will find is that the mappings exist for all JIT compiled methods (at the time of JIT as well as during rundown) but there are no ILToNativeMap rundown events for DLLs that have been precompiled with Crossgen (which is most of the framework). 

We do force the rundown of all methods (DCStopVerbose) that are precompiled (that is how we know the method) but we do currently do this for the ILToNativeMap.   

Thus the most straightforward solution is to simply log the ILToNativeMap during this rundown as well.  

This will be alot of data and it may not be needed for simple investigations but I think it is best to do the simple thing (always include it) and we can talk about having options for turning it off for advanced scenarios that care about file size.   

@brianrob 


",EventPipe,brianrob,13/06/2018 4:34,
18432,Mirror changes from dotnet/corert,"This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**","Mirror changes from dotnet/corert This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**",,MichalStrehovsky,,
18430,ArgumentException.Message and ParamName,"When an execption of type System.ArgumentException (or any inheritors) is thrown with paramName set it appends the text ""Parameter Name: <paramName>"" to the ArgumentException.Message (Ref [this](https://github.com/dotnet/coreclr/blob/1b32b2b795d52bd4bc00fd37efd528ef56b9d7af/src/System.Private.CoreLib/shared/System/ArgumentException.cs#L84)).

My opinion is that this ""Parameter Name"" addition has nothing to do in the Message property that one should only contain what's . If people want this it is possible to retrieve this using the ParamName property. Stripping it away when reading the exception is not an option since this text is localizable (e.g. ""Parameternavn"" in Norwegian) and thus impossible to extract in all translation variants.

So it should be removed from ArgumentException.Message however. It should be added to .ToString() override since the intention of this is to display the whole argument exception information including all parameters.

If someone really requires parameter name as a part of the ArgumentExeption.Message they should append this themselves when creating the exception.

I know that this is legacy from before .NET Core and exists in .NET Framework but I can't see why it couldn't be fixed. I suspect that this code is more copy/pasted from the .NET Framework source.
","ArgumentException.Message and ParamName When an execption of type System.ArgumentException (or any inheritors) is thrown with paramName set it appends the text ""Parameter Name: <paramName>"" to the ArgumentException.Message (Ref [this](https://github.com/dotnet/coreclr/blob/1b32b2b795d52bd4bc00fd37efd528ef56b9d7af/src/System.Private.CoreLib/shared/System/ArgumentException.cs#L84)).

My opinion is that this ""Parameter Name"" addition has nothing to do in the Message property that one should only contain what's . If people want this it is possible to retrieve this using the ParamName property. Stripping it away when reading the exception is not an option since this text is localizable (e.g. ""Parameternavn"" in Norwegian) and thus impossible to extract in all translation variants.

So it should be removed from ArgumentException.Message however. It should be added to .ToString() override since the intention of this is to display the whole argument exception information including all parameters.

If someone really requires parameter name as a part of the ArgumentExeption.Message they should append this themselves when creating the exception.

I know that this is legacy from before .NET Core and exists in .NET Framework but I can't see why it couldn't be fixed. I suspect that this code is more copy/pasted from the .NET Framework source.
",area-System.Runtime,RussKeldorph,12/06/2018 22:53,1/02/2019 7:14
18429,Enable Tiered Compilation by default,"1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.


@kouvel @adiaaida @adamsitnik @jorive - This isn't going to work just yet (if nothing else I think a bunch of jit tests will be improperly disabled) but I hope its in the ballpark.

I've marked this NO_MERGE to ensure nobody submits it prematurely but I do plan to remove the marking and merge once the PR is green I've given broader heads up to the team that this change is incoming and everyone is ready for it.
","Enable Tiered Compilation by default 1) Changes the default state of the tiered compilation feature check to be ON BY DEFAULT
2) Removed comments about the source about this being a work in progress. Although it will surely continue to evolve and improve remaining issues would be better tracked in our issue tracking system with the same default presumption as other runtime features - assume it works unless noted otherwise.
3) Adjusts a number of tests and automated scripts that made assumptions that the default setting of this feature is off.
4) Stop accepting the deprecated env var COMPLUS_EXPERIMENTAL_TieredCompilation. I'm not aware it has any remaining usage but if so we're going to find out.


@kouvel @adiaaida @adamsitnik @jorive - This isn't going to work just yet (if nothing else I think a bunch of jit tests will be improperly disabled) but I hope its in the ballpark.

I've marked this NO_MERGE to ensure nobody submits it prematurely but I do plan to remove the marking and merge once the PR is green I've given broader heads up to the team that this change is incoming and everyone is ready for it.
",* NO MERGE *,kouvel,12/06/2018 19:03,26/07/2018 0:44
18428,Add profiling events to describe stub code generated by the runtime,"One example of the issue came up when doing some investigation on tiered jitting here: https://github.com/dotnet/coreclr/issues/18361#issuecomment-396495131
In that case we were analyzing sampled instructions and trying to attribute them to code. Several of the instructions were within Precodes and there is no ETW information that correlates this.

At a broader scope as far as I know there aren't profiling events that describe any of our generated code that doesn't come from the JIT. 

This is potentially overlapped with #12070 but that one appears to focus on missing unwind information that would be emitted for the OS to use. This issue covers names and other descriptive information that would be useful for diagnostics tools to show in the UI or to do analysis with.","Add profiling events to describe stub code generated by the runtime One example of the issue came up when doing some investigation on tiered jitting here: https://github.com/dotnet/coreclr/issues/18361#issuecomment-396495131
In that case we were analyzing sampled instructions and trying to attribute them to code. Several of the instructions were within Precodes and there is no ETW information that correlates this.

At a broader scope as far as I know there aren't profiling events that describe any of our generated code that doesn't come from the JIT. 

This is potentially overlapped with #12070 but that one appears to focus on missing unwind information that would be emitted for the OS to use. This issue covers names and other descriptive information that would be useful for diagnostics tools to show in the UI or to do analysis with.",area-TieredCompilation,noahfalk,12/06/2018 17:54,
18427, Move x86 HW intrinsics files to shared,"Fixes: #15922
"," Move x86 HW intrinsics files to shared Fixes: #15922
",,maryamariyan,,
18426,[WIP][test pr] find cases when the cold part does not adjust the hot part.,,[WIP][test pr] find cases when the cold part does not adjust the hot part. ,* NO MERGE *,sandreenko,12/06/2018 11:16,13/06/2018 3:35
18423,Add public implementation FrameworkEventSourceSupport,"Add class FrameworkEventSourceSupport for S.P.WindowsRuntime to use.

corefx PR:https://github.com/dotnet/corefx/pull/30297","Add public implementation FrameworkEventSourceSupport Add class FrameworkEventSourceSupport for S.P.WindowsRuntime to use.

corefx PR:https://github.com/dotnet/corefx/pull/30297",area-Interop,luqunl,12/06/2018 7:56,28/06/2018 12:55
18422,"Revert ""Temporarily disable package signing in 2.0.0""","Reverts dotnet/coreclr#18421

Don't merge until the 2.0.0 Publish job has signing permissions

CC @weshaggard ","Revert ""Temporarily disable package signing in 2.0.0"" Reverts dotnet/coreclr#18421

Don't merge until the 2.0.0 Publish job has signing permissions

CC @weshaggard ",* NO MERGE *,wtgodbe,,
18420,Make a pass to remove dead strings from mscorrc.rc,"Some strings in [mscorrc.rc](https://github.com/dotnet/coreclr/blob/master/src/dlls/mscorrc/mscorrc.rc) seem to be dead. eg
","Make a pass to remove dead strings from mscorrc.rc Some strings in [mscorrc.rc](https://github.com/dotnet/coreclr/blob/master/src/dlls/mscorrc/mscorrc.rc) seem to be dead. eg
",easy,danmosemsft,12/06/2018 7:40,27/06/2018 13:41
18415,skip empty regMask in verifyRegistersUsed,"Fixes #18367.

To repro this issue we need to call . It means that we need an attached profiler to hit this issue.

Because the cost of the repro is higher that its expected value I have decided to push only the fix.","skip empty regMask in verifyRegistersUsed Fixes #18367.

To repro this issue we need to call . It means that we need an attached profiler to hit this issue.

Because the cost of the repro is higher that its expected value I have decided to push only the fix.",area-CodeGen,sandreenko,12/06/2018 5:25,12/06/2018 7:29
18410,FileNotFoundException being thrown for assemblies that are in fact present or even when loaded into AppDomain,"I have a small .NET Core app I am writing which reads all types from an assembly and the XML comments from the corresponding XML comments file. I am facing a problem with loads of **FileNotFoundException**s being thrown when a method constructor or whatever is using a type that comes from another assembly (example:  and confirmed that those assemblies were now in fact loaded into the running app... but unfortunately that also did not work... and exact the same errors were thrown.

So what do I do here?

I have extracted the important parts of the app I am writing and put them info a small demo project here: [LoadAssembliesProblem](https://github.com/gordon-matt/LoadAssembliesProblem)
> **NOTE:** There are some comments in the **Program.cs** file as well.

Is this some kind of a bug or am I doing something wrong here?","FileNotFoundException being thrown for assemblies that are in fact present or even when loaded into AppDomain I have a small .NET Core app I am writing which reads all types from an assembly and the XML comments from the corresponding XML comments file. I am facing a problem with loads of **FileNotFoundException**s being thrown when a method constructor or whatever is using a type that comes from another assembly (example:  and confirmed that those assemblies were now in fact loaded into the running app... but unfortunately that also did not work... and exact the same errors were thrown.

So what do I do here?

I have extracted the important parts of the app I am writing and put them info a small demo project here: [LoadAssembliesProblem](https://github.com/gordon-matt/LoadAssembliesProblem)
> **NOTE:** There are some comments in the **Program.cs** file as well.

Is this some kind of a bug or am I doing something wrong here?",area-AssemblyLoader,jkotas,11/06/2018 22:56,13/06/2018 1:19
18408,Bad codegen + Assertion failed 'varDsc->lvIsParam',"Repro:

Compile with ","Bad codegen + Assertion failed 'varDsc->lvIsParam' Repro:

Compile with ",area-CodeGen,CarolEidt,,
18407,Move the HWIntrinsic Load/Store operations to use GenTreeIndir nodes,"Currently the x86 Hardware Intrinsics handle the load/store operations directly. This was done both for quick bring up and in order to easily represent the various new memory operation types.

However it would be ideal if we could merge this functionality back in with the normal Indir handling that already exists.

category:implementation
theme:vector-codegen
skill-level:expert
cost:extra-large","Move the HWIntrinsic Load/Store operations to use GenTreeIndir nodes Currently the x86 Hardware Intrinsics handle the load/store operations directly. This was done both for quick bring up and in order to easily represent the various new memory operation types.

However it would be ideal if we could merge this functionality back in with the normal Indir handling that already exists.

category:implementation
theme:vector-codegen
skill-level:expert
cost:extra-large",area-CodeGen,tannergooding,11/06/2018 11:01,
18406,Inlining and explicit tail calls,"We should re-examine the logic the jit uses for inlining in the presence of explicit tail calls (calls with a  prefix). Currently the jit won't inline any method that is explicitly tail called

https://github.com/dotnet/coreclr/blob/7e215941c8d6a68fa52f98bb8fd2a419d8a1ef5d/src/jit/importer.cpp#L18943-L18949

or any method that makes an explicit tail call:

https://github.com/dotnet/coreclr/blob/7e215941c8d6a68fa52f98bb8fd2a419d8a1ef5d/src/jit/flowgraph.cpp#L5434-L5442

Both of these should be allowed provided with reasonable checks (former: callee frame is not overly huge; latter: call site is in tail position).

category:cq
theme:tail-call
skill-level:intermediate
cost:medium","Inlining and explicit tail calls We should re-examine the logic the jit uses for inlining in the presence of explicit tail calls (calls with a  prefix). Currently the jit won't inline any method that is explicitly tail called

https://github.com/dotnet/coreclr/blob/7e215941c8d6a68fa52f98bb8fd2a419d8a1ef5d/src/jit/importer.cpp#L18943-L18949

or any method that makes an explicit tail call:

https://github.com/dotnet/coreclr/blob/7e215941c8d6a68fa52f98bb8fd2a419d8a1ef5d/src/jit/flowgraph.cpp#L5434-L5442

Both of these should be allowed provided with reasonable checks (former: callee frame is not overly huge; latter: call site is in tail position).

category:cq
theme:tail-call
skill-level:intermediate
cost:medium",area-CodeGen,AndyAyersMS,11/06/2018 2:03,
18405,Transition from .Net Framework to Coreclr : Moving from GACed Dlls,"We are porting our SDK from .NET Framework to Coreclr.

As a platform we have SDK and runtime c# dlls. Most of them are nicely segregated. However the bridge library between SDK and Runtime: A.dll is GACed in .Net Framework. Apps from SDK version X can run on cluster version Y where Y >=X. So we get latest (Y) version of Dlls A always on cluster’s platform.

Problem:
There are classes in sdk dlls like SDK_A.dll which inherit from types in A.dll. So before even Main method is called A.dll is searched and found in GAC in .Net Framework. Since there is no GAC in coreclr we get FileNotFoundException for A.dll in coreclr. 

What we have tried:
1. We have tried adding AssemblyResolver to load these A.dll from Runtime folder. That does not help as exception is thrown before any code (Program’s Main) is executed.
2. We have looked at . It breaks development and packaging workflow for many developers.

What are the guidelines for library and platform writers to move there Dlls from GAC when transitioning form .Net Framework to CoreClr?
","Transition from .Net Framework to Coreclr : Moving from GACed Dlls We are porting our SDK from .NET Framework to Coreclr.

As a platform we have SDK and runtime c# dlls. Most of them are nicely segregated. However the bridge library between SDK and Runtime: A.dll is GACed in .Net Framework. Apps from SDK version X can run on cluster version Y where Y >=X. So we get latest (Y) version of Dlls A always on cluster’s platform.

Problem:
There are classes in sdk dlls like SDK_A.dll which inherit from types in A.dll. So before even Main method is called A.dll is searched and found in GAC in .Net Framework. Since there is no GAC in coreclr we get FileNotFoundException for A.dll in coreclr. 

What we have tried:
1. We have tried adding AssemblyResolver to load these A.dll from Runtime folder. That does not help as exception is thrown before any code (Program’s Main) is executed.
2. We have looked at . It breaks development and packaging workflow for many developers.

What are the guidelines for library and platform writers to move there Dlls from GAC when transitioning form .Net Framework to CoreClr?
",area-AssemblyLoader,jkotas,11/06/2018 0:18,9/05/2019 12:55
18404,Added CallerArgumentExpressionAttribute (corefx issue 21809),"Adding System.Runtime.CompilerServices.CallerArgumentExpressionAttribute to System.Private.CoreLib for [CoreFX issue 21809](https://github.com/dotnet/corefx/issues/21809).

After this addition is reflected to the System.Private.CoreLib.dll then I will expose it from System.Runtime.dll in corefx. I believe this is the proper place to add this as all other CompilerServices attributes live here but if that is not the case then please let me know.

@karelz @danmosemsft","Added CallerArgumentExpressionAttribute (corefx issue 21809) Adding System.Runtime.CompilerServices.CallerArgumentExpressionAttribute to System.Private.CoreLib for [CoreFX issue 21809](https://github.com/dotnet/corefx/issues/21809).

After this addition is reflected to the System.Private.CoreLib.dll then I will expose it from System.Runtime.dll in corefx. I believe this is the proper place to add this as all other CompilerServices attributes live here but if that is not the case then please let me know.

@karelz @danmosemsft",Hackathon,jswolf19,,
18403,Associating threadpool queues with CPU cores.,"New implementation of ThreadPool work queues as lock-free queues softly associated with CPU cores.

The implementation avoids 1:1 strict mapping between work queues and working threads which is often a far greater number than the number of cores.

This implementation improves handling of cases where the number of workers needs to exceeds the number of cores. It avoids precipitous performance drops because:
- the cost of snooping/stealing does not grow with the number of workers.
- the local queues tend to be deeper (since there are fewer of them) and thus stealing is less frequent and less contentious with enqueuing/popping.
- blocking or preempting a worker does not result in its entire work queue be only accessible through stealing.
- reduced likelihood that the workitem will have to execute on a core different from where it was scheduled.

Fixes:#19088

Also may alleviate issues as described in http://labs.criteo.com/2018/10/net-threadpool-starvation-and-how-queuing-makes-it-worse/","Associating threadpool queues with CPU cores. New implementation of ThreadPool work queues as lock-free queues softly associated with CPU cores.

The implementation avoids 1:1 strict mapping between work queues and working threads which is often a far greater number than the number of cores.

This implementation improves handling of cases where the number of workers needs to exceeds the number of cores. It avoids precipitous performance drops because:
- the cost of snooping/stealing does not grow with the number of workers.
- the local queues tend to be deeper (since there are fewer of them) and thus stealing is less frequent and less contentious with enqueuing/popping.
- blocking or preempting a worker does not result in its entire work queue be only accessible through stealing.
- reduced likelihood that the workitem will have to execute on a core different from where it was scheduled.

Fixes:#19088

Also may alleviate issues as described in http://labs.criteo.com/2018/10/net-threadpool-starvation-and-how-queuing-makes-it-worse/",* NO MERGE *,VSadov,10/06/2018 14:02,
18402,Removed length restrictions on named synchronization primitives lengths on Windows,"Fixes https://github.com/dotnet/coreclr/issues/18370
Tests PR :- https://github.com/dotnet/corefx/pull/30243

we're letting the API kick back names that are too long rather than pre-validating them.","Removed length restrictions on named synchronization primitives lengths on Windows Fixes https://github.com/dotnet/coreclr/issues/18370
Tests PR :- https://github.com/dotnet/corefx/pull/30243

we're letting the API kick back names that are too long rather than pre-validating them.",area-System.Threading,Anipik,,
18401,C# `in` parameter modifier: Should I be able to create a delegate for a method with non-matching signature?,"While working on Moq (https://github.com/moq/moq4/pull/625) I've run into something strange: It appears that the runtime does not match signatures properly when creating delegates through e.g. 
</details>
<br>

/cc @zvirja","C# 
</details>
<br>

/cc @zvirja",area-System.Reflection,stakx,10/06/2018 4:33,12/06/2018 8:38
18400,Optimize placement of VZEROUPPER,"Which rules CLR JIT uses to place VZEROUPPER and how do I opt-out ?

The live example is - one flavor of distribution sorting algorithm uses insertion sort subroutine for basic case sorting of small buckets and it gets called quite often esp. for of 2- and 3-record cases.  The insertion sort subroutine itself is highly optimized - it uses SIMD registers (XMMs in my case) HW intrinsics and just basic RSP-based stack frame for couple values. Still VZEROUPPER is generated at the beginning and at the end of subroutine which adds some perfmormance hit. There is natural desire to avoid such penalty knowing that caller will always be other CLR JITted code and all nested method invocations are inlined (checked this manually).

category:cq
theme:vector-codegen
skill-level:expert
cost:medium","Optimize placement of VZEROUPPER Which rules CLR JIT uses to place VZEROUPPER and how do I opt-out ?

The live example is - one flavor of distribution sorting algorithm uses insertion sort subroutine for basic case sorting of small buckets and it gets called quite often esp. for of 2- and 3-record cases.  The insertion sort subroutine itself is highly optimized - it uses SIMD registers (XMMs in my case) HW intrinsics and just basic RSP-based stack frame for couple values. Still VZEROUPPER is generated at the beginning and at the end of subroutine which adds some perfmormance hit. There is natural desire to avoid such penalty knowing that caller will always be other CLR JITted code and all nested method invocations are inlined (checked this manually).

category:cq
theme:vector-codegen
skill-level:expert
cost:medium",area-CodeGen,jkotas,9/06/2018 21:15,
18399,StringBuidler  support Offset(int length),"New API:
","StringBuidler  support Offset(int length) New API:
",question,jkotas,9/06/2018 18:20,10/06/2018 13:57
18396,Build fails when using enable sanitizers script,"Disclaimer:  The reason I am trying to do this is so I can run an ASAN enabled native library that I heavily use with P/Invoke.  However it seems if I don't compile coreclr with the same ASAN enabled the arguments from C# get turned into garbage on their way into C++.  If this should not the case then please inform me.

Building against the v2.1.0 tag

I'm running following the instructions I found [here](https://github.com/dotnet/coreclr/blob/master/Documentation/building/linux-instructions.md) verbatim in an ubuntu:14.04 docker container.  The build succeeds using 

(Similar error for coreconsole)","Build fails when using enable sanitizers script Disclaimer:  The reason I am trying to do this is so I can run an ASAN enabled native library that I heavily use with P/Invoke.  However it seems if I don't compile coreclr with the same ASAN enabled the arguments from C# get turned into garbage on their way into C++.  If this should not the case then please inform me.

Building against the v2.1.0 tag

I'm running following the instructions I found [here](https://github.com/dotnet/coreclr/blob/master/Documentation/building/linux-instructions.md) verbatim in an ubuntu:14.04 docker container.  The build succeeds using 

(Similar error for coreconsole)",area-Infrastructure-coreclr,jkotas,9/06/2018 15:44,
18389,Fix fragility in setup-stress-dependencies infra,"E.g. https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_ubuntu_innerloop_tst_prtest/3663/consoleText


","Fix fragility in setup-stress-dependencies infra E.g. https://ci.dot.net/job/dotnet_coreclr/job/master/job/x64_checked_ubuntu_innerloop_tst_prtest/3663/consoleText


",area-Infrastructure-coreclr,RussKeldorph,9/06/2018 10:24,
18387,Fix UTF8 encoding fallback index,"When falling back in UTF8 decoding we’ll call the DecoderFallbackBuffer.InternalFallback method which takes a pointer to the source bytes pointer which points to where we have progressed inside the source bytes. The problem is before calling DecoderFallbackBuffer.InternalFallback we call GetBytesUnknown which can adjust the source byte pointer and DecoderFallbackBuffer.InternalFallback needs to be called with the pointer before the adjustment. The fix is simply storing the original pointer value of the source byte pointer before calling GetBytesUnknown and then pass the stored original pointer to DecoderFallbackBuffer.InternalFallback instead of the adjusted source byte pointer

Fixes https://github.com/dotnet/corefx/issues/29898","Fix UTF8 encoding fallback index When falling back in UTF8 decoding we’ll call the DecoderFallbackBuffer.InternalFallback method which takes a pointer to the source bytes pointer which points to where we have progressed inside the source bytes. The problem is before calling DecoderFallbackBuffer.InternalFallback we call GetBytesUnknown which can adjust the source byte pointer and DecoderFallbackBuffer.InternalFallback needs to be called with the pointer before the adjustment. The fix is simply storing the original pointer value of the source byte pointer before calling GetBytesUnknown and then pass the stored original pointer to DecoderFallbackBuffer.InternalFallback instead of the adjusted source byte pointer

Fixes https://github.com/dotnet/corefx/issues/29898",,tarekgh,,
18386,GC Heap Compaction should clear the source data,"During GC heap compaction a copy of data is made.  In cases where there was no practical way to pin data (e.g. a returned  fields would need to use GCHandle and add a finalizer to ensure that the handle got cleared.
* A temporary copy of a secret must be cleared by the creator/owner (e.g. addition/removal of symmetric encryption padding)

If the GC can guarantee that pinning is no longer required to ensure that Span.Clear() removes the data from the heap then a good amount of defensive pinning can be eliminated from current BCL security code (theoretically reducing heap fragmentation?).","GC Heap Compaction should clear the source data During GC heap compaction a copy of data is made.  In cases where there was no practical way to pin data (e.g. a returned  fields would need to use GCHandle and add a finalizer to ensure that the handle got cleared.
* A temporary copy of a secret must be cleared by the creator/owner (e.g. addition/removal of symmetric encryption padding)

If the GC can guarantee that pinning is no longer required to ensure that Span.Clear() removes the data from the heap then a good amount of defensive pinning can be eliminated from current BCL security code (theoretically reducing heap fragmentation?).",area-GC,Maoni0,,
18384,[release/2.1] JIT: Fix bug in finally cloning caused by unsound callfinally reordering,"Port of #18348 to release 2.1.

Related issue #18332. Not a regression. This optimization was introduced
in 2.0 and the bug has been there from the beginning.

We need to make sure that if we reorder a callfinally during finally cloning
that the callfinally is actually the one being targeted by the last block in
the try range.

Linked issue has some more detailed notes.","[release/2.1] JIT: Fix bug in finally cloning caused by unsound callfinally reordering Port of #18348 to release 2.1.

Related issue #18332. Not a regression. This optimization was introduced
in 2.0 and the bug has been there from the beginning.

We need to make sure that if we reorder a callfinally during finally cloning
that the callfinally is actually the one being targeted by the last block in
the try range.

Linked issue has some more detailed notes.",area-CodeGen,AndyAyersMS,,
18381,One CoreCLR 2.1 unit test is failing due to missing ThreadStartBool.sh file,"Hi

CoreCLR 2.1 unit tests are failing due to missing ThreadStartBool.sh file

> How to reproduce:
> 
> Build the repos and the tests (release/2.1 branch)
> - ./build.sh x64 release msbuildonunsupportedplatform
> - ./build-test.sh release
> 
> Running the tests:
> - tests/runtest.sh --testRootDir=/build/coreclr/bin/tests/Linux.x64.Release --testNativeBinDir=/build/coreclr/bin/obj/Linux.x64.Release/tests --coreClrBinDir=/build/coreclr/bin/Product/Linux.x64.Release --mscorlibDir=/build/coreclr/bin/Product/Linux.x64.Release --coreFxBinDir=/build/corefx/bin/runtime/netcoreapp-Linux-Release-x64



Hamza.","One CoreCLR 2.1 unit test is failing due to missing ThreadStartBool.sh file Hi

CoreCLR 2.1 unit tests are failing due to missing ThreadStartBool.sh file

> How to reproduce:
> 
> Build the repos and the tests (release/2.1 branch)
> - ./build.sh x64 release msbuildonunsupportedplatform
> - ./build-test.sh release
> 
> Running the tests:
> - tests/runtest.sh --testRootDir=/build/coreclr/bin/tests/Linux.x64.Release --testNativeBinDir=/build/coreclr/bin/obj/Linux.x64.Release/tests --coreClrBinDir=/build/coreclr/bin/Product/Linux.x64.Release --mscorlibDir=/build/coreclr/bin/Product/Linux.x64.Release --coreFxBinDir=/build/corefx/bin/runtime/netcoreapp-Linux-Release-x64



Hamza.",area-Infrastructure-coreclr,RussKeldorph,,
18377,Initial thoughts on Native Vararg support on Unix platforms for RyuJit,"PR #18373 will re-enable __arglist (native vararg support) for coreclr; however currently only Windows platforms support the ABI. This ""issue"" is more of a brain dump to help any future work to allow native varargs on other currently unsupported/untested platforms. It is platform and arch specific if there are gaps in my familiarity with other platform's/arch's ABIs please let me know I will update the issue.

#
#### Unix Amd64
x64 Unix should only require using RAX to pass the number of floating point arguments passed in registers for setting up the caller function. Change the prolog to spill all the General purpose registers and FP registers. ArgIterator would need to get the next arg based on type from the stack offset.

#
#### Unix Arm64
Currently there are a fair amount of example of where we mangle the vararg type for all arm arches. See https://github.com/dotnet/coreclr/blob/master/src/jit/compiler.hpp#L2607. This and other instances of forcing the argument types away from floating point types such as https://github.com/dotnet/coreclr/blob/master/src/jit/morph.cpp#L3322 need to also be restricted to windows. In addition the prolog ([here](https://github.com/dotnet/coreclr/blob/master/src/jit/codegencommon.cpp#L3302) also assumes all arguments are passing in the general purpose registers. 

#
#### Unix arm32
Everything for Unix arm64 applies. The only difference I can see is that non-fixed args (args in the ... varargs) that are TYP_FLOAT will need to be retyped and used as if they were TYP_DOUBLE. This will require annotating the arguments with new additional information isFixedArg.

#
#### Windows arm32
This is the same ABI as arm64 varargs. Investigation needs to be done to determine if back-filling is supported.

category:reach
theme:varargs
skill-level:expert
cost:medium","Initial thoughts on Native Vararg support on Unix platforms for RyuJit PR #18373 will re-enable __arglist (native vararg support) for coreclr; however currently only Windows platforms support the ABI. This ""issue"" is more of a brain dump to help any future work to allow native varargs on other currently unsupported/untested platforms. It is platform and arch specific if there are gaps in my familiarity with other platform's/arch's ABIs please let me know I will update the issue.

#
#### Unix Amd64
x64 Unix should only require using RAX to pass the number of floating point arguments passed in registers for setting up the caller function. Change the prolog to spill all the General purpose registers and FP registers. ArgIterator would need to get the next arg based on type from the stack offset.

#
#### Unix Arm64
Currently there are a fair amount of example of where we mangle the vararg type for all arm arches. See https://github.com/dotnet/coreclr/blob/master/src/jit/compiler.hpp#L2607. This and other instances of forcing the argument types away from floating point types such as https://github.com/dotnet/coreclr/blob/master/src/jit/morph.cpp#L3322 need to also be restricted to windows. In addition the prolog ([here](https://github.com/dotnet/coreclr/blob/master/src/jit/codegencommon.cpp#L3302) also assumes all arguments are passing in the general purpose registers. 

#
#### Unix arm32
Everything for Unix arm64 applies. The only difference I can see is that non-fixed args (args in the ... varargs) that are TYP_FLOAT will need to be retyped and used as if they were TYP_DOUBLE. This will require annotating the arguments with new additional information isFixedArg.

#
#### Windows arm32
This is the same ABI as arm64 varargs. Investigation needs to be done to determine if back-filling is supported.

category:reach
theme:varargs
skill-level:expert
cost:medium",area-CodeGen,jashook,9/06/2018 4:33,
18375,Enable versioning bubbles that span multiple assemblies,"The concept of versioning bubbles is described in https://github.com/dotnet/coreclr/blob/master/Documentation/botr/readytorun-overview.md#version-bubbles

The current implementation is hardcoded to each assembly being its own versioning bubble. This issue is about adding an option for larger versioning bubbles:

- [ ] Add command line option to crossgen to allow specifying versioning bubbles
- [ ] Update ZapImportTable::TryEncodeModule). This is required to allow cross-module inlining of non-leaf methods within the version bubble.","Enable versioning bubbles that span multiple assemblies The concept of versioning bubbles is described in https://github.com/dotnet/coreclr/blob/master/Documentation/botr/readytorun-overview.md#version-bubbles

The current implementation is hardcoded to each assembly being its own versioning bubble. This issue is about adding an option for larger versioning bubbles:

- [ ] Add command line option to crossgen to allow specifying versioning bubbles
- [ ] Update ZapImportTable::TryEncodeModule). This is required to allow cross-module inlining of non-leaf methods within the version bubble.",area-ReadyToRun,janvorli,,
18374,Fix coredistools download script now that Packages layout has changed,Fixes #18321,Fix coredistools download script now that Packages layout has changed Fixes #18321,area-Infrastructure-coreclr,dotnet-bot,9/06/2018 4:01,9/06/2018 8:27
18371,Large Page Support in memory allocated by the GC,"Large Pages (a.k.a Huge Pages on Linux) is a feature where the operating system is able to establish memory regions larger than the native page size (often 4K) to improve performance of the application requesting these large pages.

When a virtual-to-physical address translation occurs a cache called the  privelege. Large Pages can also significantly increase the chance of a memory allocation failure because now the OS has to find physically contiguous memory.

What this means for coreclr and the GC is that when the GC does a VirtualReserve at the beginning of the program it must now commit this memory as well.","Large Page Support in memory allocated by the GC Large Pages (a.k.a Huge Pages on Linux) is a feature where the operating system is able to establish memory regions larger than the native page size (often 4K) to improve performance of the application requesting these large pages.

When a virtual-to-physical address translation occurs a cache called the  privelege. Large Pages can also significantly increase the chance of a memory allocation failure because now the OS has to find physically contiguous memory.

What this means for coreclr and the GC is that when the GC does a VirtualReserve at the beginning of the program it must now commit this memory as well.",area-GC,Maoni0,9/06/2018 2:31,9/04/2019 6:48
18370,Remove length restrictions on named synchronization primitives lengths on Windows,"From https://github.com/dotnet/coreclr/pull/18320#issuecomment-395603647

If the OS allows creating mutex with the long name we should allow it too. We are just getting into way by blocking the longer names for no good reason.","Remove length restrictions on named synchronization primitives lengths on Windows From https://github.com/dotnet/coreclr/pull/18320#issuecomment-395603647

If the OS allows creating mutex with the long name we should allow it too. We are just getting into way by blocking the longer names for no good reason.",area-System.Threading,Anipik,9/06/2018 1:45,12/06/2018 0:29
18367,[Regression] Assertion failed 'mask != RBM_NONE',"
The regression was introduced by #18230.

cc @dotnet/jit-contrib ","[Regression] Assertion failed 'mask != RBM_NONE' 
The regression was introduced by #18230.

cc @dotnet/jit-contrib ",area-CodeGen,sandreenko,,
18362,[Windows/arm][JitStress] Assertion failed 'defList.IsEmpty()' in System.Numerics.Tests.ComplexTests:Conjugate,"Hit this is in PR #18347 during [Windows_NT arm Cross Checked corefx_jitstress1 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress1_tst_prtest/3/consoleText) and [Windows_NT arm Cross Checked corefx_jitstress2 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress2_tst_prtest/3/consoleText)


The issue was introduces sometime between now and May 8 2018
I am going to disable System.Runtime.Numerics.Tests in #18347 
When the issue is resolved please remove corresponding line in tests/arm/corefx_test_exclusions.txt ","[Windows/arm][JitStress] Assertion failed 'defList.IsEmpty()' in System.Numerics.Tests.ComplexTests:Conjugate Hit this is in PR #18347 during [Windows_NT arm Cross Checked corefx_jitstress1 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress1_tst_prtest/3/consoleText) and [Windows_NT arm Cross Checked corefx_jitstress2 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress2_tst_prtest/3/consoleText)


The issue was introduces sometime between now and May 8 2018
I am going to disable System.Runtime.Numerics.Tests in #18347 
When the issue is resolved please remove corresponding line in tests/arm/corefx_test_exclusions.txt ",JitStress,CarolEidt,,
18361,Performance degradation dotnet core 2.1.300 TieredCompilation,"I am very excited about Tiered Compilation in dotnet core so I decided to take it for a spin. Unfortunately in my case I found a performance degradation from 370 ms to 540 ms

## My dotnet version:


","Performance degradation dotnet core 2.1.300 TieredCompilation I am very excited about Tiered Compilation in dotnet core so I decided to take it for a spin. Unfortunately in my case I found a performance degradation from 370 ms to 540 ms

## My dotnet version:


",area-TieredCompilation,noahfalk,8/06/2018 8:49,18/12/2018 11:29
18359,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,brianrob,,
18353,JIT: make sure finally cloning isn't cloning along EH only paths,"Need to re-examine the selection of which finally clause to clone as I suspect in #18332 that the jit makes a poor choice and clones a finally that can only be reached when an exception is thrown.

Current algorithm is to walk the try region from back to front and picks the finally associated with the ""last"" exit point in the try hoping that this is the normal try region exit. Perhaps more checks are warranted here -- for instance I think we may also want to screen out blocks that are within some nested handler region.

This is a potential perf enhancement not a correctness issue.","JIT: make sure finally cloning isn't cloning along EH only paths Need to re-examine the selection of which finally clause to clone as I suspect in #18332 that the jit makes a poor choice and clones a finally that can only be reached when an exception is thrown.

Current algorithm is to walk the try region from back to front and picks the finally associated with the ""last"" exit point in the try hoping that this is the normal try region exit. Perhaps more checks are warranted here -- for instance I think we may also want to screen out blocks that are within some nested handler region.

This is a potential perf enhancement not a correctness issue.",area-CodeGen,AndyAyersMS,8/06/2018 5:53,13/06/2018 2:49
18347,Disable CoreFx tests on Windows/arm and Linux/arm,Disable  failing on Windows/arm due to #18362,Disable CoreFx tests on Windows/arm and Linux/arm Disable  failing on Windows/arm due to #18362,arch-arm32,dotnet-bot,8/06/2018 2:14,9/06/2018 2:32
18342,Debugging : The libcoreclr.so module is not loaded yet in the target process : when different build id of dotnet,"I have a crash dump from command  of dotnet changed ? Is this our problem ? Or problem in process of dotnet publishing to apt-repos.

","Debugging : The libcoreclr.so module is not loaded yet in the target process : when different build id of dotnet I have a crash dump from command  of dotnet changed ? Is this our problem ? Or problem in process of dotnet publishing to apt-repos.

",area-Diagnostics,mikem8361,,
18341,JIT: disasm assert on OSX,Build checked coreclr on OSX. Set ,JIT: disasm assert on OSX Build checked coreclr on OSX. Set ,area-CodeGen,BruceForstall,,
18339,JIT Performance regression between 1.1 and 2.0 and between 2.0 and 2.1,"I've been trying to come up with a simple repro for a perf regression I've been fighting and I think I have it trimmed down as much as possible while still showing the real-world impact.  What I have [here](https://github.com/saucecontrol/Blake2Fast/tree/master/tests/JitRegression) is a stripped-down version of my [Blake2b](http://blake2.net/) hashing algorithm implementation.  The main work is driven through a single CPU-intensive mixing function and I've set up benchmarks with 3 variants of that function to show the problem.

1) is a [no-op version](https://github.com/saucecontrol/Blake2Fast/blob/master/tests/JitRegression/Blake2bMixNoop.cs) that simply runs all the outer loop code as a baseline for determining time spent in the inner loop.
2) is the version I'd like to use with the mixing math in a [separate method](https://github.com/saucecontrol/Blake2Fast/blob/master/tests/JitRegression/Blake2bMixPreferred.cs) marked with 

Method |           Job | Platform | IsBaseline |       Mean |      Error |     StdDev |     Median | Scaled | ScaledSD |
---------------- |-------------- |--------- |----------- |-----------:|-----------:|-----------:|-----------:|-------:|---------:|
MixNoop | netcoreapp1.1 |      X64 |       True |   1.326 ms |  0.1071 ms |  0.3158 ms |   1.331 ms |   1.00 |     0.00 |
MixNoop | netcoreapp2.0 |      X64 |    Default |   1.288 ms |  0.1003 ms |  0.2957 ms |   1.285 ms |   1.03 |     0.36 |
MixNoop | netcoreapp2.1 |      X64 |    Default |   1.352 ms |  0.0928 ms |  0.2735 ms |   1.358 ms |   1.08 |     0.36 |
|               |          |            |            |            |            |            |        |          |
MixNoop | netcoreapp1.1 |      X86 |       True |   2.738 ms |  0.2200 ms |  0.6486 ms |   2.701 ms |   1.00 |     0.00 |
MixNoop | netcoreapp2.0 |      X86 |    Default |   2.673 ms |  0.2034 ms |  0.5998 ms |   2.826 ms |   1.04 |     0.36 |
MixNoop | netcoreapp2.1 |      X86 |    Default |   2.776 ms |  0.2096 ms |  0.6181 ms |   2.740 ms |   1.08 |     0.37 |
|               |          |            |            |            |            |            |        |          |
MixPreferred | netcoreapp1.1 |      X64 |       True |  31.926 ms |  2.2443 ms |  6.6172 ms |  32.740 ms |   1.00 |     0.00 |
MixPreferred | netcoreapp2.0 |      X64 |    Default |  31.898 ms |  2.1440 ms |  6.3216 ms |  31.735 ms |   1.05 |     0.33 |
MixPreferred | netcoreapp2.1 |      X64 |    Default |  27.419 ms |  2.4213 ms |  7.1393 ms |  25.538 ms |   0.90 |     0.32 |
|               |          |            |            |            |            |            |        |          |
MixPreferred | netcoreapp1.1 |      X86 |       True | 341.759 ms | 13.1190 ms | 38.4759 ms | 331.234 ms |   1.00 |     0.00 |
MixPreferred | netcoreapp2.0 |      X86 |    Default | 251.373 ms | 13.1463 ms | 38.3484 ms | 239.499 ms |   0.74 |     0.14 |
MixPreferred | netcoreapp2.1 |      X86 |    Default | 291.564 ms | 10.3316 ms | 29.6434 ms | 285.206 ms |   0.86 |     0.13 |
|               |          |            |            |            |            |            |        |          |
MixManualInline | netcoreapp1.1 |      X64 |       True |  33.165 ms |  2.2903 ms |  6.7529 ms |  33.426 ms |   1.00 |     0.00 |
MixManualInline | netcoreapp2.0 |      X64 |    Default |  33.819 ms |  2.4410 ms |  7.1973 ms |  34.340 ms |   1.07 |     0.34 |
MixManualInline | netcoreapp2.1 |      X64 |    Default |  20.601 ms |  0.1490 ms |  0.1394 ms |  20.606 ms |   0.65 |     0.15 |
|               |          |            |            |            |            |            |        |          |
MixManualInline | netcoreapp1.1 |      X86 |       True | 163.629 ms |  7.6584 ms | 22.3398 ms | 160.224 ms |   1.00 |     0.00 |
MixManualInline | netcoreapp2.0 |      X86 |    Default | 249.708 ms | 11.3452 ms | 32.7336 ms | 240.169 ms |   1.55 |     0.28 |
MixManualInline | netcoreapp2.1 |      X86 |    Default | 285.367 ms |  9.0883 ms | 25.6337 ms | 278.039 ms |   1.77 |     0.27 |

Here there are a few more outliers but it's the same general story.

Full code for the benchmarks is [here](https://github.com/saucecontrol/Blake2Fast/tree/master/tests/JitRegression) if anyone wants to try on different hardware.

category:cq
theme:optimization
skill-level:expert
cost:large","JIT Performance regression between 1.1 and 2.0 and between 2.0 and 2.1 I've been trying to come up with a simple repro for a perf regression I've been fighting and I think I have it trimmed down as much as possible while still showing the real-world impact.  What I have [here](https://github.com/saucecontrol/Blake2Fast/tree/master/tests/JitRegression) is a stripped-down version of my [Blake2b](http://blake2.net/) hashing algorithm implementation.  The main work is driven through a single CPU-intensive mixing function and I've set up benchmarks with 3 variants of that function to show the problem.

1) is a [no-op version](https://github.com/saucecontrol/Blake2Fast/blob/master/tests/JitRegression/Blake2bMixNoop.cs) that simply runs all the outer loop code as a baseline for determining time spent in the inner loop.
2) is the version I'd like to use with the mixing math in a [separate method](https://github.com/saucecontrol/Blake2Fast/blob/master/tests/JitRegression/Blake2bMixPreferred.cs) marked with 

Method |           Job | Platform | IsBaseline |       Mean |      Error |     StdDev |     Median | Scaled | ScaledSD |
---------------- |-------------- |--------- |----------- |-----------:|-----------:|-----------:|-----------:|-------:|---------:|
MixNoop | netcoreapp1.1 |      X64 |       True |   1.326 ms |  0.1071 ms |  0.3158 ms |   1.331 ms |   1.00 |     0.00 |
MixNoop | netcoreapp2.0 |      X64 |    Default |   1.288 ms |  0.1003 ms |  0.2957 ms |   1.285 ms |   1.03 |     0.36 |
MixNoop | netcoreapp2.1 |      X64 |    Default |   1.352 ms |  0.0928 ms |  0.2735 ms |   1.358 ms |   1.08 |     0.36 |
|               |          |            |            |            |            |            |        |          |
MixNoop | netcoreapp1.1 |      X86 |       True |   2.738 ms |  0.2200 ms |  0.6486 ms |   2.701 ms |   1.00 |     0.00 |
MixNoop | netcoreapp2.0 |      X86 |    Default |   2.673 ms |  0.2034 ms |  0.5998 ms |   2.826 ms |   1.04 |     0.36 |
MixNoop | netcoreapp2.1 |      X86 |    Default |   2.776 ms |  0.2096 ms |  0.6181 ms |   2.740 ms |   1.08 |     0.37 |
|               |          |            |            |            |            |            |        |          |
MixPreferred | netcoreapp1.1 |      X64 |       True |  31.926 ms |  2.2443 ms |  6.6172 ms |  32.740 ms |   1.00 |     0.00 |
MixPreferred | netcoreapp2.0 |      X64 |    Default |  31.898 ms |  2.1440 ms |  6.3216 ms |  31.735 ms |   1.05 |     0.33 |
MixPreferred | netcoreapp2.1 |      X64 |    Default |  27.419 ms |  2.4213 ms |  7.1393 ms |  25.538 ms |   0.90 |     0.32 |
|               |          |            |            |            |            |            |        |          |
MixPreferred | netcoreapp1.1 |      X86 |       True | 341.759 ms | 13.1190 ms | 38.4759 ms | 331.234 ms |   1.00 |     0.00 |
MixPreferred | netcoreapp2.0 |      X86 |    Default | 251.373 ms | 13.1463 ms | 38.3484 ms | 239.499 ms |   0.74 |     0.14 |
MixPreferred | netcoreapp2.1 |      X86 |    Default | 291.564 ms | 10.3316 ms | 29.6434 ms | 285.206 ms |   0.86 |     0.13 |
|               |          |            |            |            |            |            |        |          |
MixManualInline | netcoreapp1.1 |      X64 |       True |  33.165 ms |  2.2903 ms |  6.7529 ms |  33.426 ms |   1.00 |     0.00 |
MixManualInline | netcoreapp2.0 |      X64 |    Default |  33.819 ms |  2.4410 ms |  7.1973 ms |  34.340 ms |   1.07 |     0.34 |
MixManualInline | netcoreapp2.1 |      X64 |    Default |  20.601 ms |  0.1490 ms |  0.1394 ms |  20.606 ms |   0.65 |     0.15 |
|               |          |            |            |            |            |            |        |          |
MixManualInline | netcoreapp1.1 |      X86 |       True | 163.629 ms |  7.6584 ms | 22.3398 ms | 160.224 ms |   1.00 |     0.00 |
MixManualInline | netcoreapp2.0 |      X86 |    Default | 249.708 ms | 11.3452 ms | 32.7336 ms | 240.169 ms |   1.55 |     0.28 |
MixManualInline | netcoreapp2.1 |      X86 |    Default | 285.367 ms |  9.0883 ms | 25.6337 ms | 278.039 ms |   1.77 |     0.27 |

Here there are a few more outliers but it's the same general story.

Full code for the benchmarks is [here](https://github.com/saucecontrol/Blake2Fast/tree/master/tests/JitRegression) if anyone wants to try on different hardware.

category:cq
theme:optimization
skill-level:expert
cost:large",arch-x86,pgavlin,7/06/2018 13:58,
18338,CoreCLR failed when build with msvc on windows,"CoreCLR failed with warning C4644  when build with msvc on Windows I use latest source on master branch. The source code is ill-formed could you please help take a look at this?
Noted that this issue only found when compiles with unreleased vctoolset that next release of MSVC will have this behavior.

The probably fix: the project either needs to build with /wd4644 pragma push/pop the warning or do as the warning says and use the STL’s offsetof

You can repro this issue as the steps below:
1.git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2.Open a clean x86 prompt (C:\windows\syswow64\cmd.exe) and browse to D:\CoreCLR\src
3.build x86 release -Rebuild -- /clp:ShowCommandLine

Failures:
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): warning C4644:  usage of the macro-based offsetof pattern in constant expressions is non-standard; use offsetof defined in the C++ standard library instead [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): warning C4644:     case offsetof(ArgumentRegisters ECX): [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): warning C4644:          ^ [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17410): warning C4644:  usage of the macro-based offsetof pattern in constant expressions is non-standard; use offsetof defined in the C++ standard library instead [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17410): warning C4644:     case offsetof(ArgumentRegisters EDX): [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17410): warning C4644:          ^ [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
<snip>
[D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): error C2220:  warning treated as error - no 'object' file generated [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): error C2220:     case offsetof(ArgumentRegisters ECX): [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): error C2220:          ^ [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
","CoreCLR failed when build with msvc on windows CoreCLR failed with warning C4644  when build with msvc on Windows I use latest source on master branch. The source code is ill-formed could you please help take a look at this?
Noted that this issue only found when compiles with unreleased vctoolset that next release of MSVC will have this behavior.

The probably fix: the project either needs to build with /wd4644 pragma push/pop the warning or do as the warning says and use the STL’s offsetof

You can repro this issue as the steps below:
1.git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2.Open a clean x86 prompt (C:\windows\syswow64\cmd.exe) and browse to D:\CoreCLR\src
3.build x86 release -Rebuild -- /clp:ShowCommandLine

Failures:
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): warning C4644:  usage of the macro-based offsetof pattern in constant expressions is non-standard; use offsetof defined in the C++ standard library instead [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): warning C4644:     case offsetof(ArgumentRegisters ECX): [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): warning C4644:          ^ [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17410): warning C4644:  usage of the macro-based offsetof pattern in constant expressions is non-standard; use offsetof defined in the C++ standard library instead [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17410): warning C4644:     case offsetof(ArgumentRegisters EDX): [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17410): warning C4644:          ^ [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
<snip>
[D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): error C2220:  warning treated as error - no 'object' file generated [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): error C2220:     case offsetof(ArgumentRegisters ECX): [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
d:\coreclr\src\src\vm\i386\profiler.cpp(17210): error C2220:          ^ [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
",area-Infrastructure-coreclr,RussKeldorph,,
18337,Moves CurrentSystemTimeZone ICastable RegistryView and RegistryValueKind to shared,"1) As recommended in the comment [here](https://github.com/dotnet/coreclr/issues/17904#issuecomment-391056322) now that Hashtable is available in CoreLib we can undo the split on  changes were done by moving some Win32Native enums to Interop.Kernel32

Related to https://github.com/dotnet/corert/pull/5906

cc: @jkotas ","Moves CurrentSystemTimeZone, ICastable, RegistryView and RegistryValueKind to shared 1) As recommended in the comment [here](https://github.com/dotnet/coreclr/issues/17904#issuecomment-391056322) now that Hashtable is available in CoreLib we can undo the split on  changes were done by moving some Win32Native enums to Interop.Kernel32

Related to https://github.com/dotnet/corert/pull/5906

cc: @jkotas ",,maryamariyan,,
18332,Function erroneously returns null when compiled in release mode,"@leecow commented on [Wed Jun 06 2018](https://github.com/dotnet/corefx/issues/30173)

@jlwSL commented on [Wed Jun 06 2018](https://github.com/dotnet/core/issues/1663)

I've discovered a bug that causes a function to return null even if every possible return value is non-null. The issue does not happen if the project is compiled in debug mode. Please see the code attached that reproduces this issue.

. Going to move this to the CoreFX to start. 



---

@0xd4d commented on [Wed Jun 06 2018](https://github.com/dotnet/corefx/issues/30173#issuecomment-395183992)

Looks like a jitter bug so coreclr is a better repo.

> I ran your code on Mac Fedora 28 and a clean CentOS 7 image and all return false

Did you try Release builds?

","Function erroneously returns null when compiled in release mode @leecow commented on [Wed Jun 06 2018](https://github.com/dotnet/corefx/issues/30173)

@jlwSL commented on [Wed Jun 06 2018](https://github.com/dotnet/core/issues/1663)

I've discovered a bug that causes a function to return null even if every possible return value is non-null. The issue does not happen if the project is compiled in debug mode. Please see the code attached that reproduces this issue.

. Going to move this to the CoreFX to start. 



---

@0xd4d commented on [Wed Jun 06 2018](https://github.com/dotnet/corefx/issues/30173#issuecomment-395183992)

Looks like a jitter bug so coreclr is a better repo.

> I ran your code on Mac Fedora 28 and a clean CentOS 7 image and all return false

Did you try Release builds?

",area-CodeGen,AndyAyersMS,,
18330,"Metrics ""framework"" for JIT","While hacking the JIT quite often I end up with a simple question - ""how many time does X happen?"":
* How many JCC instructions are generated?
* How many side effects trees are extracted?
* How many range checks are encountered/removed?

So I end up adding variables 
pretty much anywhere in the JIT code and have such counters dumped to the console like mem stats are. Or included in disassembly comments so that they show up in diffs and maybe be used by jit-analyze.

Counters should be collected per method and if possible per phase as well. And of course some basic aggregations should be included as well.

The API should be as easy to use as possible - the above example shows the use of a string as a counter identifier (so I guess the implementation would be using these strings as a hashtable key). This would avoid the need to add a new enum member - such an enum typically resides in a header that when changed triggers the compilation of all JIT files.  Of course an enum based overload could also provided that would be useful for counters that are useful long term.

@dotnet/jit-contrib Thoughts?

category:implementation
theme:jit-coding-style
skill-level:beginner
cost:medium","Metrics ""framework"" for JIT While hacking the JIT quite often I end up with a simple question - ""how many time does X happen?"":
* How many JCC instructions are generated?
* How many side effects trees are extracted?
* How many range checks are encountered/removed?

So I end up adding variables 
pretty much anywhere in the JIT code and have such counters dumped to the console like mem stats are. Or included in disassembly comments so that they show up in diffs and maybe be used by jit-analyze.

Counters should be collected per method and if possible per phase as well. And of course some basic aggregations should be included as well.

The API should be as easy to use as possible - the above example shows the use of a string as a counter identifier (so I guess the implementation would be using these strings as a hashtable key). This would avoid the need to add a new enum member - such an enum typically resides in a header that when changed triggers the compilation of all JIT files.  Of course an enum based overload could also provided that would be useful for counters that are useful long term.

@dotnet/jit-contrib Thoughts?

category:implementation
theme:jit-coding-style
skill-level:beginner
cost:medium",area-CodeGen,pgavlin,7/06/2018 5:48,
18328,Fix issue in Compiler::impImportStaticFieldAccess,"When CORINFO_FIELD_STATIC_SHARED_STATIC_HELPER accessor is being processed for
structs the method creates a GT_IND node instead of GT_OBJ node. For structs
that can be normalized to a specific type (like TYP_SIMD8) it causes an assert
in Compiler::impNormStructVal in the switch case for GT_IND.

This change modifies the node creation to work the same way as in the default
case for accessors creating GT_OBJ for structs and GT_IND otherwise.","Fix issue in Compiler::impImportStaticFieldAccess When CORINFO_FIELD_STATIC_SHARED_STATIC_HELPER accessor is being processed for
structs the method creates a GT_IND node instead of GT_OBJ node. For structs
that can be normalized to a specific type (like TYP_SIMD8) it causes an assert
in Compiler::impNormStructVal in the switch case for GT_IND.

This change modifies the node creation to work the same way as in the default
case for accessors creating GT_OBJ for structs and GT_IND otherwise.",area-CodeGen,janvorli,,
18327,Excessive/strange null reference checks after method inlining,"Consider the following repro example (this is actually from the live system just narrowed down significantly):

 and all references to it from structure.

category:cq
theme:value-numbering
skill-level:expert
cost:medium","Excessive/strange null reference checks after method inlining Consider the following repro example (this is actually from the live system just narrowed down significantly):

 and all references to it from structure.

category:cq
theme:value-numbering
skill-level:expert
cost:medium",area-CodeGen,RussKeldorph,7/06/2018 4:27,
18324,JIT has run out of instruction bits in instrDesc,"We have 9 bits for the instruction field and  is probably only used with the ""align loops"" option.
","JIT has run out of instruction bits in instrDesc We have 9 bits for the instruction field and  is probably only used with the ""align loops"" option.
",area-CodeGen,pgavlin,7/06/2018 1:06,8/06/2018 9:58
18323,Unreproducible InvalidProgramExceptions at random places,"Our .NET Core Web Apps running on Azure App Service occasionally start throwing InvalidProgramExceptions at seemly random places in code. For example see the following stack traces:

On .NET Core 2.0:

* https://gist.github.com/chrarnoldus/bc4362ff1b4df11b34d2407f0131a607
* https://gist.github.com/chrarnoldus/f7ceab63117c33a3be8c6128815b7cdb (see inner exception)
* https://gist.github.com/chrarnoldus/101c99d0b14f5ad7e572670ffe913f74

On .NET Core 2.1 so the issue doesn't seem toe be fixed:

* https://gist.github.com/chrarnoldus/d4da9436c575f453e46043aa9b062353 (see inner exception)

Due to the unpredictable nature of these exceptions I suspect the problem is in the runtime and not in the ASP.NET Core libraries used. In all of the cases the exception continued to be thrown every time the affected code was executed. The problem disappears after restarting the process so I don't have steps to reproduce it. I do have memory dumps that were captured by the Application Insights Snapshot Collector. If a Microsoft employee is interested in analysing those in the understanding that they probably contain sensitive data please contact me using the email in my profile.
","Unreproducible InvalidProgramExceptions at random places Our .NET Core Web Apps running on Azure App Service occasionally start throwing InvalidProgramExceptions at seemly random places in code. For example see the following stack traces:

On .NET Core 2.0:

* https://gist.github.com/chrarnoldus/bc4362ff1b4df11b34d2407f0131a607
* https://gist.github.com/chrarnoldus/f7ceab63117c33a3be8c6128815b7cdb (see inner exception)
* https://gist.github.com/chrarnoldus/101c99d0b14f5ad7e572670ffe913f74

On .NET Core 2.1 so the issue doesn't seem toe be fixed:

* https://gist.github.com/chrarnoldus/d4da9436c575f453e46043aa9b062353 (see inner exception)

Due to the unpredictable nature of these exceptions I suspect the problem is in the runtime and not in the ASP.NET Core libraries used. In all of the cases the exception continued to be thrown every time the affected code was executed. The problem disappears after restarting the process so I don't have steps to reproduce it. I do have memory dumps that were captured by the Application Insights Snapshot Collector. If a Microsoft employee is interested in analysing those in the understanding that they probably contain sensitive data please contact me using the email in my profile.
",,leculver,,
18321,setup-stress-dependencies.cmd failing,"This is causing x86 GCStress testing to fail.

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_gcstress0xc/

e.g.

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_gcstress0xc/83/consoleText

","setup-stress-dependencies.cmd failing This is causing x86 GCStress testing to fail.

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_gcstress0xc/

e.g.

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/x86_checked_windows_nt_gcstress0xc/83/consoleText

",arch-x86,BruceForstall,6/06/2018 10:59,9/06/2018 8:27
18319,Classic EventSources don't work in Release builds using .NET Native (UWP),"Michael Taron  reported this on 6/5/2018 via E-mail to @vancem and @brianrob 

To repro using VS create the 'Blank UWP app' and add the following EventSource

To make the EventSource use self-describing events but that causes a Exception to be thrown (**this seems like an independent but that is also worth fixing**).  

This bug is meant to track this issue (Note it is a .NET Native issue not a .NET Core issue
@brianrob 

","Classic EventSources don't work in Release builds using .NET Native (UWP) Michael Taron  reported this on 6/5/2018 via E-mail to @vancem and @brianrob 

To repro using VS create the 'Blank UWP app' and add the following EventSource

To make the EventSource use self-describing events but that causes a Exception to be thrown (**this seems like an independent but that is also worth fixing**).  

This bug is meant to track this issue (Note it is a .NET Native issue not a .NET Core issue
@brianrob 

",area-Tracing,vancem,6/06/2018 10:07,
18316,Force short date pattern to use yyyy on Linux,The default pattern we get is using yy which causes the years to be displayed as 2 digits. This is not acceptable for many users. The fix here is to force 4-digit year as a default and still keep the original pattern which has 2-digit year in the optional list,Force short date pattern to use yyyy on Linux The default pattern we get is using yy which causes the years to be displayed as 2 digits. This is not acceptable for many users. The fix here is to force 4-digit year as a default and still keep the original pattern which has 2-digit year in the optional list,,tarekgh,,
18315,Assertion failed 'killMask == getKillSetForNode(tree)' lsrabuild.cpp,"Was caused by #16517.
","Assertion failed 'killMask == getKillSetForNode(tree)' lsrabuild.cpp Was caused by #16517.
",area-CodeGen,CarolEidt,,
18312,Increase timeout and log the result for some WaitAny tests that expect AbandonedMutexException,Follow-up to https://github.com/dotnet/coreclr/pull/13298 missed a few cases.,Increase timeout and log the result for some WaitAny tests that expect AbandonedMutexException Follow-up to https://github.com/dotnet/coreclr/pull/13298 missed a few cases.,area-System.Threading,kouvel,,
18309,[release/2.1] Use WChar instead of char,"Use WCHAR to avoid truncate -- pTarget is WCHAR*.

This PR is for 2.1 servicing.

Fix: #18269","[release/2.1] Use WChar instead of char Use WCHAR to avoid truncate -- pTarget is WCHAR*.

This PR is for 2.1 servicing.

Fix: #18269",,luqunl,,
18307,Alpine Linux coreclr dac dbi not honoring PAL symbol versions,"The loader on Alpine links the libmscordbi.so PAL references to libvsbaseservices.so (which contains VS's debug engine PAL) instead of the the PAL in libmscordaccore.so.

On Alpine Linux the export PAL APIs from the DAC need to have a module specific prefix added so the loader links to the right module/PAL.","Alpine Linux coreclr, dac, dbi not honoring PAL symbol versions The loader on Alpine links the libmscordbi.so PAL references to libvsbaseservices.so (which contains VS's debug engine PAL) instead of the the PAL in libmscordaccore.so.

On Alpine Linux the export PAL APIs from the DAC need to have a module specific prefix added so the loader links to the right module/PAL.",area-Diagnostics,mikem8361,,
18305,Skip old time zones adjustments with offsets higher than 14h,"Fixes: https://github.com/dotnet/corefx/issues/29820
Tested locally with original repro.

Some old time zones (i.e. Asia/Manilla - see comment in the code for more examples) had adjustment higher than our max expected value 14h. Because of compatibility with SQL server concerns we cannot change the max value (i.e. Windows does not have that data at all). Last known adjustment with offset larger than 14h is in year 1900.","Skip old time zones adjustments with offsets higher than 14h Fixes: https://github.com/dotnet/corefx/issues/29820
Tested locally with original repro.

Some old time zones (i.e. Asia/Manilla - see comment in the code for more examples) had adjustment higher than our max expected value 14h. Because of compatibility with SQL server concerns we cannot change the max value (i.e. Windows does not have that data at all). Last known adjustment with offset larger than 14h is in year 1900.",,tarekgh,,
18300,Sse2.Set[All]Vector128([u]long [u]long) crashes with PNSE when run in 32-bit process,"My guess is - these method have managed implementation behind them involving ) unavailable in 32-bit mode.
Since these are all just helper methods not necessarily mapped to some specific HW intrinsic directly my understanding is that the implementation should behave considering current process bitness - eg. use set of 32-bit HW intrinsics to setup the result when in 32-bit mode.","Sse2.Set[All]Vector128([u]long, [u]long) crashes with PNSE when run in 32-bit process My guess is - these method have managed implementation behind them involving ) unavailable in 32-bit mode.
Since these are all just helper methods not necessarily mapped to some specific HW intrinsic directly my understanding is that the implementation should behave considering current process bitness - eg. use set of 32-bit HW intrinsics to setup the result when in 32-bit mode.",area-CodeGen,CarolEidt,6/06/2018 1:34,7/12/2018 6:50
18299,Methods with operations on pointers to unmanaged type (T* where T: unmanaged) not getting inlined,"VS 15.7.3 .NET Framework 4.7.2


| Method |     Mean |     Error |    StdDev |
|------- |---------:|----------:|----------:|
|   Run1 | 80.98 ms | 0.9829 ms | 0.8713 ms |
|   Run2 | 20.79 ms | 0.0431 ms | 0.0337 ms |
","Methods with operations on pointers to unmanaged type (T*, where T: unmanaged) not getting inlined VS 15.7.3 .NET Framework 4.7.2


| Method |     Mean |     Error |    StdDev |
|------- |---------:|----------:|----------:|
|   Run1 | 80.98 ms | 0.9829 ms | 0.8713 ms |
|   Run2 | 20.79 ms | 0.0431 ms | 0.0337 ms |
",area-CodeGen,AndyAyersMS,5/06/2018 22:22,6/06/2018 2:18
18296,Avoid marking the frame pointer is used in genFuncletProlog,"This pull request is a follow up of the pull request (#18230) I made earlier.

Initially I followed the advice to mark the frame pointer as modified in  the frame pointer but not really ...

In some sense the original code did pretty much that same but it brackets a much larger region. This change narrowed down the region to just emitting one instruction in the large frame case.","Avoid marking the frame pointer is used in genFuncletProlog This pull request is a follow up of the pull request (#18230) I made earlier.

Initially I followed the advice to mark the frame pointer as modified in  the frame pointer but not really ...

In some sense the original code did pretty much that same but it brackets a much larger region. This change narrowed down the region to just emitting one instruction in the large frame case.",area-CodeGen,cshung,,
18295,[arm32] Assertion failed 'genIsValidIntReg(dstReg)',"It seems that this has been broken for a while. I recently caught this during PR #18289 testing
But the regression was introduced earlier - sometime between  [Build #18 (May 17 2018 4:32:43 AM) ](https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/18/) and [Build #19 (May 24 2018 4:27:51 AM)](https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/19/)

**Update:** The issue is also reproducible on Windows/ARM (e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/21/consoleText)

When the issue is resolved enable back tests disabled in PR #18347","[arm32] Assertion failed 'genIsValidIntReg(dstReg)' It seems that this has been broken for a while. I recently caught this during PR #18289 testing
But the regression was introduced earlier - sometime between  [Build #18 (May 17 2018 4:32:43 AM) ](https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/18/) and [Build #19 (May 24 2018 4:27:51 AM)](https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/19/)

**Update:** The issue is also reproducible on Windows/ARM (e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/21/consoleText)

When the issue is resolved enable back tests disabled in PR #18347",arch-arm32,CarolEidt,,
18294,Use WChar instead of char,"Use WCHAR to avoid truncate -- pTarget  is WCHAR*.

Fix: https://github.com/dotnet/coreclr/issues/18269","Use WChar instead of char Use WCHAR to avoid truncate -- pTarget  is WCHAR*.

Fix: https://github.com/dotnet/coreclr/issues/18269",,luqunl,,
18292,Workaround for  compiler.hpp (1848) - Assertion failed 'lvRefCnt',"The description is in #18291.

The fix is to replace  could receive a statement that was already removed still exists.","Workaround for  compiler.hpp (1848) - Assertion failed 'lvRefCnt' The description is in #18291.

The fix is to replace  could receive a statement that was already removed still exists.",bug,sandreenko,5/06/2018 8:57,9/06/2018 3:30
18291,optVNConstantPropOnJTrue with uncondition throw removes the tree twice,"An example:
.

Affects all targets affects 2.1 but it does not generate bad code in release however I think it is possible to cause it with this issue.

category:testing
theme:basic-cq
skill-level:expert
cost:small","optVNConstantPropOnJTrue with uncondition throw removes the tree twice An example:
.

Affects all targets affects 2.1 but it does not generate bad code in release however I think it is possible to cause it with this issue.

category:testing
theme:basic-cq
skill-level:expert
cost:small",area-CodeGen,sandreenko,,
18286,[Arm64/Linux] gcStress=1/2/3 intermittent failures,"This issue is for tracking intermittent gcGtress failures which are not threading related..

While the occurrence rate of these failures is low it is worth tracking them here to help detect patterns.","[Arm64/Linux] gcStress=1/2/3 intermittent failures This issue is for tracking intermittent gcGtress failures which are not threading related..

While the occurrence rate of these failures is low it is worth tracking them here to help detect patterns.",arch-arm64,Maoni0,5/06/2018 3:29,11/04/2019 3:00
18285,[Arm64/Linux] gcServer intermittent failures,"These have been a few intermittent failures in gcServer modes

Opening this issue to track these intermittent failures.

@Maoni0 ","[Arm64/Linux] gcServer intermittent failures These have been a few intermittent failures in gcServer modes

Opening this issue to track these intermittent failures.

@Maoni0 ",arch-arm64,VSadov,,
18284,Working folder when debugging a .NET Core app changing bizarrely,"_From @adamralph on June 1 2018 22:33_

_Continuing from [Twitter](https://twitter.com/davkean/status/1002675512399970304)._

Note that the breakpoint is _before_ the call to !

![working-dir](https://user-images.githubusercontent.com/677704/40866148-6f48d7b0-65fc-11e8-9e9b-498bae7e57c2.gif)


_Copied from original issue: dotnet/project-system#3609_","Working folder when debugging a .NET Core app changing bizarrely _From @adamralph on June 1 2018 22:33_

_Continuing from [Twitter](https://twitter.com/davkean/status/1002675512399970304)._

Note that the breakpoint is _before_ the call to !

![working-dir](https://user-images.githubusercontent.com/677704/40866148-6f48d7b0-65fc-11e8-9e9b-498bae7e57c2.gif)


_Copied from original issue: dotnet/project-system#3609_",area-Meta-corelib,danmosemsft,,
18283,Moves FastResourceComparer and TaskAwaiter to shared,"cc: @jkotas 

Related to corert PR: https://github.com/dotnet/corert/pull/5893","Moves FastResourceComparer and TaskAwaiter to shared cc: @jkotas 

Related to corert PR: https://github.com/dotnet/corert/pull/5893",,maryamariyan,,
18280,Interpretation of ByRefLikeAttribute in .NET Core 2.1 is a breaking change and a standard violation,"As a matter of facts it is possible in .NET Core 2.0 to use a ref struct as an argument of a generic parameter if you're generating MSIL but this same MSIL code no longer runs in .NET Core 2.1. We used this compilation pattern in PostSharp and did all the testing in .NET Core 2.0 just to see it's breaking in .NET Core 2.1.

I understand why you guys have taken this approach as this is a pragmatic way but I think it is my role as a third-party tool developer to respectfully complain.

Giving a runtime meaning to a custom attribute (ByRefLikeAttribute) is non-standard-compliant (ECMA-335) so the least I would expect is that you document an extension or violation of the standard. An orthodox approach would have been to define a new TypeAttribute and to cope with the problem that the compiler will need a specific version of the runtime. 

The concrete impact for this change and as far as PostSharp is concerned is minimal because support for C# 7.2 in PostSharp wasn't made RTW yet.

However as a policy breaking standards and relying on ""tricks"" (like ObsoleteAttribute) to minimize their impact is unhealthy and warrants this complain.

It seems there's a need for a well-thought solution to this problem. Like .NET Standard is the API-level answer to this issue should it be some CLR Standard? Maybe the compiler could emit a list of non-standard-compliant extensions marked as MUST UNDERSTAND or OPTIONAL that all members of the MSIL pipeline (therefore including the compiler PostSharp and the CLR) would respect.




","Interpretation of ByRefLikeAttribute in .NET Core 2.1 is a breaking change and a standard violation As a matter of facts it is possible in .NET Core 2.0 to use a ref struct as an argument of a generic parameter if you're generating MSIL but this same MSIL code no longer runs in .NET Core 2.1. We used this compilation pattern in PostSharp and did all the testing in .NET Core 2.0 just to see it's breaking in .NET Core 2.1.

I understand why you guys have taken this approach as this is a pragmatic way but I think it is my role as a third-party tool developer to respectfully complain.

Giving a runtime meaning to a custom attribute (ByRefLikeAttribute) is non-standard-compliant (ECMA-335) so the least I would expect is that you document an extension or violation of the standard. An orthodox approach would have been to define a new TypeAttribute and to cope with the problem that the compiler will need a specific version of the runtime. 

The concrete impact for this change and as far as PostSharp is concerned is minimal because support for C# 7.2 in PostSharp wasn't made RTW yet.

However as a policy breaking standards and relying on ""tricks"" (like ObsoleteAttribute) to minimize their impact is unhealthy and warrants this complain.

It seems there's a need for a well-thought solution to this problem. Like .NET Standard is the API-level answer to this issue should it be some CLR Standard? Maybe the compiler could emit a list of non-standard-compliant extensions marked as MUST UNDERSTAND or OPTIONAL that all members of the MSIL pipeline (therefore including the compiler PostSharp and the CLR) would respect.




",area-TypeSystem,RussKeldorph,5/06/2018 0:02,
18278,Build failure: src\vm\codeversion.cpp(2523): warning C4101: 'hr': unreferenced local variable,"Opened on behalf of @RussKeldorph

Warnings: 2
Status Message: failed

Build : Master - 20180604.03 (Product Build)
Failing configurations:
- Windows
  - PortableBuild-Checked-arm
  - PortableBuild-Checked-arm64
  - PortableBuild-Debug-arm
  - PortableBuild-Debug-arm64
  - PortableBuild-Release-arm
  - PortableBuild-Release-arm64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180604.03/workItem/Orchestration/analysis/external/Link)
","Build failure: src\vm\codeversion.cpp(2523): warning C4101: 'hr': unreferenced local variable Opened on behalf of @RussKeldorph

Warnings: 2
Status Message: failed

Build : Master - 20180604.03 (Product Build)
Failing configurations:
- Windows
  - PortableBuild-Checked-arm
  - PortableBuild-Checked-arm64
  - PortableBuild-Debug-arm
  - PortableBuild-Debug-arm64
  - PortableBuild-Release-arm
  - PortableBuild-Release-arm64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180604.03/workItem/Orchestration/analysis/external/Link)
",area-Infrastructure-coreclr,RussKeldorph,4/06/2018 23:04,5/06/2018 1:11
18277,"Consider using SIMD registers for ""hot"" local variables instead of placing them on stack when out of free GP registers","The idea is intuitive though I'm not sure it was ever sounded in context of CLR JIT - why not use X/Y/ZMM registers for ""hot"" local variables to avoid stack memory accesses just like common GP registers are used to load/store the values? (I'm not talking here about operations other than load/store  because it's much deeper topic which may include auto-vectorization and other funny stuff.)

There are always up to at least 6 volatile SIMD registers and the number of regs used may be increased up to the size of SIMD register file. With more complex techniques this may provide up to 8 regs for x86/SSE+ up to 16 regs for x64/SSE+ up to 32 regs for x64/AVX-512 (future). These numbers may be achievable in the context of CLR due to the fact that at the moment few code in system assemblies uses vectors and to my understanding SIMD ops are now only used for FP operations otherwise.

Even taking into account the store forwarding mechanisms implemented in modern CPUs when accessing memory the significant speed-up could be achieved. One extra point is that on HyperThreaded CPUs the register files are independent on each other whereas memory access circuitry is mostly shared by (sub-)cores.

category:design
theme:register-allocator
skill-level:expert
cost:large","Consider using SIMD registers for ""hot"" local variables instead of placing them on stack when out of free GP registers The idea is intuitive though I'm not sure it was ever sounded in context of CLR JIT - why not use X/Y/ZMM registers for ""hot"" local variables to avoid stack memory accesses just like common GP registers are used to load/store the values? (I'm not talking here about operations other than load/store  because it's much deeper topic which may include auto-vectorization and other funny stuff.)

There are always up to at least 6 volatile SIMD registers and the number of regs used may be increased up to the size of SIMD register file. With more complex techniques this may provide up to 8 regs for x86/SSE+ up to 16 regs for x64/SSE+ up to 32 regs for x64/AVX-512 (future). These numbers may be achievable in the context of CLR due to the fact that at the moment few code in system assemblies uses vectors and to my understanding SIMD ops are now only used for FP operations otherwise.

Even taking into account the store forwarding mechanisms implemented in modern CPUs when accessing memory the significant speed-up could be achieved. One extra point is that on HyperThreaded CPUs the register files are independent on each other whereas memory access circuitry is mostly shared by (sub-)cores.

category:design
theme:register-allocator
skill-level:expert
cost:large",Design Discussion,tannergooding,4/06/2018 22:33,
18272,Fix error during compilation with /permissive-,Closes #17944 ,Fix error during compilation with /permissive- Closes #17944 ,Hackathon,kant2002,,
18270,Unsafe.AsRef is not getting inlined in Span.GetPinnableReference,"Repro:

 is not inlined","Unsafe.AsRef is not getting inlined in Span.GetPinnableReference Repro:

 is not inlined",area-CodeGen,AndyAyersMS,4/06/2018 10:24,5/06/2018 9:02
18269,Regression in 2.1.300: AssemblyName parsing with unicode/emoji crashes,"I found a regression in 2.1.300 when trying to upgrade [Xamarin Workbooks](https://github.com/Microsoft/workbooks) to 

_1. If you're interested in _why_ we have assembly names with this particular sequence of emoji feel free to ask!_","Regression in 2.1.300: AssemblyName parsing with unicode/emoji crashes I found a regression in 2.1.300 when trying to upgrade [Xamarin Workbooks](https://github.com/Microsoft/workbooks) to 

_1. If you're interested in _why_ we have assembly names with this particular sequence of emoji feel free to ask!_",area-AssemblyLoader,luqunl,4/06/2018 9:43,18/07/2018 2:23
18264,Set GTF_RELOP_QMARK in gtNewQmarkNode,"Add/Set  GTF_RELOP_QMARK in gtNewQmarkNode

Fix https://github.com/dotnet/coreclr/issues/18192
","Set GTF_RELOP_QMARK in gtNewQmarkNode Add/Set  GTF_RELOP_QMARK in gtNewQmarkNode

Fix https://github.com/dotnet/coreclr/issues/18192
",Hackathon,luqunl,,
18260,Warnings cleanup,"- Reenables all warnings that do not trigger
- Fixes two of the easier warnings and reenables them too.

contributes to #18128 ","Warnings cleanup - Reenables all warnings that do not trigger
- Fixes two of the easier warnings and reenables them too.

contributes to #18128 ",Hackathon,Suchiman,,
18259,Wrong value passed to generic interface method in release,On .NET core 2.1.0 and .NET framework 4.7.1 the following program prints ,Wrong value passed to generic interface method in release On .NET core 2.1.0 and .NET framework 4.7.1 the following program prints ,area-CodeGen,briansull,,
18258,Cleanup and remove unused parameters from genCreateAddrMode,fixes #18177,Cleanup and remove unused parameters from genCreateAddrMode fixes #18177,Hackathon,CarolEidt,,
18257,Change gtExtractSideEffList to use GenTreeVisitor,"This changes  slows down things a bit - around 0.05% instructions retired. But I don't think such a small regression can justify keeping the custom/duplicate tree traversal logic especially if it can lead to bugs. Besides there are plenty of places in the JIT where one can recover 0.05% without compromising code reliability and clarity.

Fixes #18232","Change gtExtractSideEffList to use GenTreeVisitor This changes  slows down things a bit - around 0.05% instructions retired. But I don't think such a small regression can justify keeping the custom/duplicate tree traversal logic especially if it can lead to bugs. Besides there are plenty of places in the JIT where one can recover 0.05% without compromising code reliability and clarity.

Fixes #18232",area-CodeGen,mikedn,3/06/2018 5:38,24/07/2018 5:21
18256,Share more of the HWIntrinsic base code between ARM and XArch if possible,"https://github.com/dotnet/coreclr/pull/18255 did a fairly big refactoring of the XArch HWIntrinsic code.

There are likely several functions which could be shared between Arm64 and XArch. This issue tracks the initial investigation and any work required.

category:design
theme:intrinsics
skill-level:expert
cost:medium","Share more of the HWIntrinsic base code between ARM and XArch, if possible https://github.com/dotnet/coreclr/pull/18255 did a fairly big refactoring of the XArch HWIntrinsic code.

There are likely several functions which could be shared between Arm64 and XArch. This issue tracks the initial investigation and any work required.

category:design
theme:intrinsics
skill-level:expert
cost:medium",area-CodeGen,tannergooding,3/06/2018 5:25,17/10/2019 8:55
18253,Implement corefx/#16619: Add FormattableString.CurrentCulture,Implement https://github.com/dotnet/corefx/issues/16619: Add FormattableString.CurrentCulture,Implement corefx/#16619: Add FormattableString.CurrentCulture Implement https://github.com/dotnet/corefx/issues/16619: Add FormattableString.CurrentCulture,Hackathon,mikhailshilkov,,
18252,Setting breakpoint in managed function using lldb,"I want to set breakpoint on my function 
","Setting breakpoint in managed function using lldb I want to set breakpoint on my function 
",area-Diagnostics,jkotas,2/06/2018 21:54,7/06/2018 21:13
18249,Convert Decimal to all-managed implementation,"CoreCLR's is in
https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/src/System/Decimal.cs
https://github.com/dotnet/coreclr/blob/master/src/classlibnative/bcltype/decimal.cpp

The place to start is by grabbing the code verbatim from CoreRT and measuring performance then optimizing to fix any regression:

https://github.com/dotnet/corert/blob/master/src/System.Private.CoreLib/src/System/Decimal.cs
https://github.com/dotnet/corert/blob/master/src/System.Private.CoreLib/src/System/Decimal.DecCalc.cs

Ensuring tests have good coverage of course.","Convert Decimal to all-managed implementation CoreCLR's is in
https://github.com/dotnet/coreclr/blob/master/src/System.Private.CoreLib/src/System/Decimal.cs
https://github.com/dotnet/coreclr/blob/master/src/classlibnative/bcltype/decimal.cpp

The place to start is by grabbing the code verbatim from CoreRT and measuring performance then optimizing to fix any regression:

https://github.com/dotnet/corert/blob/master/src/System.Private.CoreLib/src/System/Decimal.cs
https://github.com/dotnet/corert/blob/master/src/System.Private.CoreLib/src/System/Decimal.DecCalc.cs

Ensuring tests have good coverage of course.",Hackathon,pentp,,
18247,Fix PCODE not having thumb bit set when comparing two addresses,,Fix PCODE not having thumb bit set when comparing two addresses ,area-Diagnostics,chsienki,2/06/2018 8:44,12/06/2018 4:12
18246,Enable tailcall_v4\smallFrame\smallFrame,PR #11316  removed the bad IL sequences from this test but left these tests disabled for arm/arm64.,Enable tailcall_v4\smallFrame\smallFrame PR #11316  removed the bad IL sequences from this test but left these tests disabled for arm/arm64.,arch-arm32,sandreenko,2/06/2018 8:35,3/06/2018 8:40
18245,Replace some sizeof-s with target specific constants,"The goal of this PR is to identify all places in VM using sizeof operator that should be made target-specific in order to support cross-bitness scenario #16513. <s>The proposal is to introduce CrossBitness_SizeOf operator to make such places *explicit*.

CrossBitness_SizeOf operator satisfies the following conditions:
1. CrossBitness_SizeOf(X) == sizeof(X) in non-crossbitness scenarios;
2. CrossBitness_SizeOf(X) == sizeof(Y) where Y is a ""fake"" structure created to describe layout of X on the target platform in crossbitness scenarios (i.e. x64_arm). Note that usually sizeof(X) != sizeof(Y).</s>

It's been proven experimentally that this subset of changes is needed in order to get outputs of x64_arm and arm_arm crossgens to be binary identical for S.P.C.dll and CoreFx assemblies.</s>

This PR also includes other related changes:
1.  expressions with target-specifics constants

@jkotas PTAL","Replace some sizeof-s with target specific constants The goal of this PR is to identify all places in VM using sizeof operator that should be made target-specific in order to support cross-bitness scenario #16513. <s>The proposal is to introduce CrossBitness_SizeOf operator to make such places *explicit*.

CrossBitness_SizeOf operator satisfies the following conditions:
1. CrossBitness_SizeOf(X) == sizeof(X) in non-crossbitness scenarios;
2. CrossBitness_SizeOf(X) == sizeof(Y) where Y is a ""fake"" structure created to describe layout of X on the target platform in crossbitness scenarios (i.e. x64_arm). Note that usually sizeof(X) != sizeof(Y).</s>

It's been proven experimentally that this subset of changes is needed in order to get outputs of x64_arm and arm_arm crossgens to be binary identical for S.P.C.dll and CoreFx assemblies.</s>

This PR also includes other related changes:
1.  expressions with target-specifics constants

@jkotas PTAL",area-VM,jkotas,2/06/2018 8:34,5/06/2018 3:08
18244,Exception when trying to GCHandle.Alloc(new ValueTuple<ulong ulong>[1] GCHandleType.Pinned),"I'm getting exception when I try to pin array of s using this statement with .NET Core 2.1 release:

> GCHandle.Alloc(new ValueTuple<ulong ulong>[1] GCHandleType.Pinned)

The exception tells:
> System.ArgumentException
>   HResult=0x80070057
>   Message=Object contains non-primitive or non-blittable data.
>   Source=System.Private.CoreLib
>   StackTrace:
>    at System.Runtime.InteropServices.GCHandle.InternalAlloc(Object value GCHandleType type)
>    at System.Runtime.InteropServices.GCHandle.Alloc(Object value GCHandleType type) in E:\A\_work\31\s\src\mscorlib\src\System\Runtime\InteropServices\GcHandle.cs:line 94
","Exception when trying to GCHandle.Alloc(new ValueTuple<ulong, ulong>[1], GCHandleType.Pinned) I'm getting exception when I try to pin array of s using this statement with .NET Core 2.1 release:

> GCHandle.Alloc(new ValueTuple<ulong ulong>[1] GCHandleType.Pinned)

The exception tells:
> System.ArgumentException
>   HResult=0x80070057
>   Message=Object contains non-primitive or non-blittable data.
>   Source=System.Private.CoreLib
>   StackTrace:
>    at System.Runtime.InteropServices.GCHandle.InternalAlloc(Object value GCHandleType type)
>    at System.Runtime.InteropServices.GCHandle.Alloc(Object value GCHandleType type) in E:\A\_work\31\s\src\mscorlib\src\System\Runtime\InteropServices\GcHandle.cs:line 94
",area-Interop,jkotas,2/06/2018 7:37,
18242,Mirror changes from dotnet/corert,"This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**","Mirror changes from dotnet/corert This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**",,jkotas,,
18238,Cast to ushort is dropped in release,"The following program gives different outputs for release and debug:
.
@mikedn has analyzed the cause [here](https://github.com/dotnet/coreclr/issues/18235#issuecomment-393915294).

This issue repros on .NET framework as well with 64-bit JIT (it does not repro with 32-bit JIT).","Cast to ushort is dropped in release The following program gives different outputs for release and debug:
.
@mikedn has analyzed the cause [here](https://github.com/dotnet/coreclr/issues/18235#issuecomment-393915294).

This issue repros on .NET framework as well with 64-bit JIT (it does not repro with 32-bit JIT).",area-CodeGen,erozenfeld,,
18235,Wrong integer promotion in release,"For .NET core 2.1 the following program outputs 1023 in debug but 255 in release.


This issue repros on .NET framework 4.6.1 as well with 64-bit JIT (it does not repro with 32-bit JIT). The compiler used is csc.exe 2.8.3.62923 (7aafab56).","Wrong integer promotion in release For .NET core 2.1 the following program outputs 1023 in debug but 255 in release.


This issue repros on .NET framework 4.6.1 as well with 64-bit JIT (it does not repro with 32-bit JIT). The compiler used is csc.exe 2.8.3.62923 (7aafab56).",area-CodeGen,jakobbotsch,,
18234,Enable Alpine cross build for arm and arm64,"This change enables cross build and rootfs creation for
Alpine Linux ARM / ARM64 targets.

Besides that I've cleaned up the toolchain.cmake and got rid
of the explicit specification of GCC version specific include
and lib folders for all targets except of Tizen. Clang is able
to figure that out on its own the same way as it does when doing
regular non-cross builds but it needed one more option for that.

I've also fixed a bug in the  would do nothing.
","Enable Alpine cross build for arm and arm64 This change enables cross build and rootfs creation for
Alpine Linux ARM / ARM64 targets.

Besides that I've cleaned up the toolchain.cmake and got rid
of the explicit specification of GCC version specific include
and lib folders for all targets except of Tizen. Clang is able
to figure that out on its own the same way as it does when doing
regular non-cross builds but it needed one more option for that.

I've also fixed a bug in the  would do nothing.
",area-Infrastructure-coreclr,janvorli,,
18232,NullReferenceException thrown for multi-dimensional arrays in release,The following program runs successfully in debug but throws a  is used.,NullReferenceException thrown for multi-dimensional arrays in release The following program runs successfully in debug but throws a  is used.,area-CodeGen,mikedn,,
18230,JIT: Eliminate RegTracker (#18179),"https://github.com/dotnet/coreclr/issues/18179
@BruceForstall 
@CarolEidt ","JIT: Eliminate RegTracker (#18179) https://github.com/dotnet/coreclr/issues/18179
@BruceForstall 
@CarolEidt ",Hackathon,cshung,,
18229,x64 JIT crash 'Compiler::implResolveToken' for typeof(ValueType) containing array of self,"The following program crashes the **x64** JIT.

    using System;

    public struct StructTree
    {
        public Double P;
        public StructTree[] rg;
    };

    class Program
    {
        static void Main() => T = typeof(StructTree);      // <-- EETypeLoadException

        static Type T; // (not important that 'T' be a non-local variable; only done here to
                       // prevent the above assignment from being fully optimized-out)
    }

The exception:

>Exception thrown at 0x00007FFDFD13F218 in ConsoleApp23.exe: Microsoft C++ exception: EETypeLoadException at memory location 0x0000003F1433A450.

Stack trace:

	RaiseException()
	_CxxThrowException()
	Compiler::impResolveToken() Line 277          <--- EETypeLoadException
	Compiler::impImportBlockCode() Line 14293
	Compiler::impImportBlock() Line 16079
	Compiler::impImport() Line 17163
	[Inline Frame] Compiler::fgImport() Line 6800
	Compiler::compCompile() Line 4386
	Compiler::compCompileHelper() Line 6025
	Compiler::compCompile() Line 5359
	jitNativeCode() Line 6666
	CILJit::compileMethod() Line 315
	_CorExeMain()
	_CorExeMain_Exported()
	BaseThreadInitThunk()
	RtlUserThreadStart()

Here's a link to the throwing source code form the [coreclr repo](https://github.com/dotnet/coreclr):

https://github.com/dotnet/coreclr/blob/86c438de4043359942f3e0f46c55fdaa98dc5b2f/src/jit/importer.cpp#L262-L277

As best as I can tell that would be here:

![asm](https://user-images.githubusercontent.com/5589855/40815819-f5e8d6c6-64fd-11e8-9901-98adcc270f9b.png)

The **IL** code for the problematic **C#** JIT target method () is essentially the same for *Debug* and *Release* builds and both exhibit the crash.

	L_0000: ldtoken StructTree
	L_0005: call class [mscorlib]Type [mscorlib]Type::GetTypeFromHandle(valuetype [mscorlib]RuntimeTypeHandle)
	L_000a: stsfld class [mscorlib]Type Program::T
	L_000f: ret 

To Reproduce
----

To reproduce this crash create a new **C#** project for .NET 4.7.2 in the latest VS2017. Enter the code shown at the top. Alternatively [here's a zip](https://github.com/dotnet/coreclr/files/2060673/jit-crash-resolve-token-recursive.zip) of the whole project.

Next on the *Project Properties* pane enable **Native Code Debugging**:

![app-properties](https://user-images.githubusercontent.com/5589855/40815912-a3573802-64fe-11e8-9d48-b0b8c86e142d.png)

On the *Exception Settings* pane enable exceptions as shown here:

![ex-settings](https://user-images.githubusercontent.com/5589855/40815934-cd6d1526-64fe-11e8-8929-2b773df0df56.png)

Here are the debugger settings I used. In the case of **Suppress JIT optimization on module load** it does not have any effect on the issue (the crash occurs in both modes).


![dbg-opts](https://user-images.githubusercontent.com/5589855/40816102-d3693878-64ff-11e8-82e0-16dfaa56e038.png)
","x64 JIT crash 'Compiler::implResolveToken' for typeof(ValueType) containing array of self The following program crashes the **x64** JIT.

    using System;

    public struct StructTree
    {
        public Double P;
        public StructTree[] rg;
    };

    class Program
    {
        static void Main() => T = typeof(StructTree);      // <-- EETypeLoadException

        static Type T; // (not important that 'T' be a non-local variable; only done here to
                       // prevent the above assignment from being fully optimized-out)
    }

The exception:

>Exception thrown at 0x00007FFDFD13F218 in ConsoleApp23.exe: Microsoft C++ exception: EETypeLoadException at memory location 0x0000003F1433A450.

Stack trace:

	RaiseException()
	_CxxThrowException()
	Compiler::impResolveToken() Line 277          <--- EETypeLoadException
	Compiler::impImportBlockCode() Line 14293
	Compiler::impImportBlock() Line 16079
	Compiler::impImport() Line 17163
	[Inline Frame] Compiler::fgImport() Line 6800
	Compiler::compCompile() Line 4386
	Compiler::compCompileHelper() Line 6025
	Compiler::compCompile() Line 5359
	jitNativeCode() Line 6666
	CILJit::compileMethod() Line 315
	_CorExeMain()
	_CorExeMain_Exported()
	BaseThreadInitThunk()
	RtlUserThreadStart()

Here's a link to the throwing source code form the [coreclr repo](https://github.com/dotnet/coreclr):

https://github.com/dotnet/coreclr/blob/86c438de4043359942f3e0f46c55fdaa98dc5b2f/src/jit/importer.cpp#L262-L277

As best as I can tell that would be here:

![asm](https://user-images.githubusercontent.com/5589855/40815819-f5e8d6c6-64fd-11e8-9901-98adcc270f9b.png)

The **IL** code for the problematic **C#** JIT target method () is essentially the same for *Debug* and *Release* builds and both exhibit the crash.

	L_0000: ldtoken StructTree
	L_0005: call class [mscorlib]Type [mscorlib]Type::GetTypeFromHandle(valuetype [mscorlib]RuntimeTypeHandle)
	L_000a: stsfld class [mscorlib]Type Program::T
	L_000f: ret 

To Reproduce
----

To reproduce this crash create a new **C#** project for .NET 4.7.2 in the latest VS2017. Enter the code shown at the top. Alternatively [here's a zip](https://github.com/dotnet/coreclr/files/2060673/jit-crash-resolve-token-recursive.zip) of the whole project.

Next on the *Project Properties* pane enable **Native Code Debugging**:

![app-properties](https://user-images.githubusercontent.com/5589855/40815912-a3573802-64fe-11e8-9d48-b0b8c86e142d.png)

On the *Exception Settings* pane enable exceptions as shown here:

![ex-settings](https://user-images.githubusercontent.com/5589855/40815934-cd6d1526-64fe-11e8-8929-2b773df0df56.png)

Here are the debugger settings I used. In the case of **Suppress JIT optimization on module load** it does not have any effect on the issue (the crash occurs in both modes).


![dbg-opts](https://user-images.githubusercontent.com/5589855/40816102-d3693878-64ff-11e8-82e0-16dfaa56e038.png)
",area-TypeSystem,jkotas,1/06/2018 11:45,
18228,[arm32][JitStressRegs=3] Assertion failed 'farthestRefPhysRegRecord != nullptr',"https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_jitstressregs3_tst/9/consoleFull



Possibly related: https://github.com/dotnet/coreclr/issues/18153
","[arm32][JitStressRegs=3] Assertion failed 'farthestRefPhysRegRecord != nullptr' https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_jitstressregs3_tst/9/consoleFull



Possibly related: https://github.com/dotnet/coreclr/issues/18153
",arch-arm32,CarolEidt,,
18210,Fix GitHub_16041 test.,"This was doing a cpblk of 28 bytes (size of StructY) from StructX but StructX was only 12 bytes big. Change StructY size to 12.

The discussion was in #16090.
cc @dotnet/jit-contrib.

I have checked that with the new size it still repro the original issue (but only on the old version now It doesn't create necessary  for some reasons).","Fix GitHub_16041 test. This was doing a cpblk of 28 bytes (size of StructY) from StructX but StructX was only 12 bytes big. Change StructY size to 12.

The discussion was in #16090.
cc @dotnet/jit-contrib.

I have checked that with the new size it still repro the original issue (but only on the old version now It doesn't create necessary  for some reasons).",test bug,sandreenko,31/05/2018 9:36,2/06/2018 4:08
18209,Support new Japanese calendar eras,"Japan is going to introduce the new era next year 2019 this new era will be added to the Japanese calendar. This new era would affect anyone converting formatting or parsing dates using the Japanese calendar.
Users who formatted future dates before introducing the new era and then try to parse these dates after introducing the new era will fail and get parsing exception. The reason is the year number will not be valid in the old era anymore because the new era set a year limit to the old era.

Here is an example:

Format a date like ""平成 32年2月1日"" which saying year 32 in the era ""平成"". after we introduce the new era the old era ""平成"" will be limited up to and including year 31 so year 32 is exceeding the era end.

The fix is to allow the parser succeeds with such dates and have a config switch which can be used to for anyone want the old behavior.","Support new Japanese calendar eras Japan is going to introduce the new era next year 2019 this new era will be added to the Japanese calendar. This new era would affect anyone converting formatting or parsing dates using the Japanese calendar.
Users who formatted future dates before introducing the new era and then try to parse these dates after introducing the new era will fail and get parsing exception. The reason is the year number will not be valid in the old era anymore because the new era set a year limit to the old era.

Here is an example:

Format a date like ""平成 32年2月1日"" which saying year 32 in the era ""平成"". after we introduce the new era the old era ""平成"" will be limited up to and including year 31 so year 32 is exceeding the era end.

The fix is to allow the parser succeeds with such dates and have a config switch which can be used to for anyone want the old behavior.",area-System.Globalization,tarekgh,,
18208,Optimize Encoding.ASCII," checks and so on.

(This is a nice-to-have. This isn't blocking anything as I know.)","Optimize Encoding.ASCII  checks and so on.

(This is a nice-to-have. This isn't blocking anything as I know.)",area-System.Runtime,GrabYourPitchforks,,
18207,Moving MissingFieldException (fully) and MissingMethodException (partially) to shared,"- **[First 5 commits explained]**: Reduce diff of StackTrace with coreclr version by (1) moving StackFrameHelper class to its own file (2) renaming and (3) cleaning up documentation
- Reduces diff in MemoryFailPoint by renaming private field
- Reduces diff in TypeLoadException by changing String to string
- Reduces diff in ThrowHelper by sorting using
- **[Last 4 commits explained]**: Moving MissingFieldException and MissingMethodException partially to shared

CoreRT PR: https://github.com/dotnet/corert/pull/5868

cc: @jkotas ","Moving MissingFieldException (fully) and MissingMethodException (partially) to shared - **[First 5 commits explained]**: Reduce diff of StackTrace with coreclr version by (1) moving StackFrameHelper class to its own file (2) renaming and (3) cleaning up documentation
- Reduces diff in MemoryFailPoint by renaming private field
- Reduces diff in TypeLoadException by changing String to string
- Reduces diff in ThrowHelper by sorting using
- **[Last 4 commits explained]**: Moving MissingFieldException and MissingMethodException partially to shared

CoreRT PR: https://github.com/dotnet/corert/pull/5868

cc: @jkotas ",,maryamariyan,,
18206,[arm64] Disable `a % b = a & (b - 1);` optimization.,"Morph can't relay on Lower optimization that it can't guarantee.

In this test case we have such tree:


The fix is similar to #17338.

Fixes #17968.

PR #15690 can help to return this optimization back.","[arm64] Disable 

The fix is similar to #17338.

Fixes #17968.

PR #15690 can help to return this optimization back.",arch-arm64,sandreenko,31/05/2018 7:42,2/06/2018 9:19
18205,Remove some GT_ASG_op leftovers,,Remove some GT_ASG_op leftovers ,area-CodeGen,RussKeldorph,31/05/2018 5:31,26/08/2018 8:30
18204,Expose SpinWait.SpinOnce(int sleep1Threshold) overload,"To allow customizing the spin count threshold for Sleep(1) usage and to allow disabling the use of Sleep(1).

API review: https://github.com/dotnet/corefx/issues/29623
Part of fix for https://github.com/dotnet/corefx/issues/29595","Expose SpinWait.SpinOnce(int sleep1Threshold) overload To allow customizing the spin count threshold for Sleep(1) usage and to allow disabling the use of Sleep(1).

API review: https://github.com/dotnet/corefx/issues/29623
Part of fix for https://github.com/dotnet/corefx/issues/29595",area-System.Threading,kouvel,,
18203,Expose Exception.set_HResult as Public,"This is to change Excetion.set_HResult from protected to public so that others can set HResult value for a given exception.

Approved API: https://github.com/dotnet/corefx/issues/29696
Related Corefx Change(ref assembly): https://github.com/dotnet/corefx/pull/29986","Expose Exception.set_HResult as Public This is to change Excetion.set_HResult from protected to public so that others can set HResult value for a given exception.

Approved API: https://github.com/dotnet/corefx/issues/29696
Related Corefx Change(ref assembly): https://github.com/dotnet/corefx/pull/29986",area-Interop,luqunl,31/05/2018 4:54,31/05/2018 12:37
18202,Is Multi-Core JIT ProfileOptimization possible with CoreCLR?,"Hey 

This is a question regarding the API . It doesn't seem to be available through .NET CoreCLR (and almost no issues apart #17124) there is a bit of multi-core JIT in [multicorejit.h](https://github.com/dotnet/coreclr/blob/master/src/vm/multicorejit.h) with actually the internal calls declared for both SetProfileRoot/StartProfile... but no C# version of it...

So just wondering if it could be available? If not what were the reason? (Not really used? Not compatible with CoreCLR?...etc.)

Thanks!","Is Multi-Core JIT, ProfileOptimization possible with CoreCLR? Hey 

This is a question regarding the API . It doesn't seem to be available through .NET CoreCLR (and almost no issues apart #17124) there is a bit of multi-core JIT in [multicorejit.h](https://github.com/dotnet/coreclr/blob/master/src/vm/multicorejit.h) with actually the internal calls declared for both SetProfileRoot/StartProfile... but no C# version of it...

So just wondering if it could be available? If not what were the reason? (Not really used? Not compatible with CoreCLR?...etc.)

Thanks!",area-VM,brianrob,31/05/2018 4:47,31/05/2018 12:51
18201,Eliminate GenTreeRegVar and GT_REG_VAR,"These are no longer used with the removal of .

category:design
theme:ir
skill-level:intermediate
cost:small","Eliminate GenTreeRegVar and GT_REG_VAR These are no longer used with the removal of .

category:design
theme:ir
skill-level:intermediate
cost:small",Hackathon,CarolEidt,31/05/2018 4:22,5/01/2019 2:41
18198,Clean up threading tests to make them deterministic and not rely on timing,,Clean up threading tests to make them deterministic and not rely on timing ,area-System.Threading,kouvel,31/05/2018 2:34,
18196,JIT: Implement or eliminate GTF_REG_BIRTH,"This flag is no longer used after the removal of  over using ""birth"" and ""death"" terminology.

category:design
theme:liveness
skill-level:expert
cost:medium","JIT: Implement or eliminate GTF_REG_BIRTH This flag is no longer used after the removal of  over using ""birth"" and ""death"" terminology.

category:design
theme:liveness
skill-level:expert
cost:medium",area-CodeGen,CarolEidt,31/05/2018 2:12,
18192,Set GTF_RELOP_QMARK in gtNewQmarkNode,Each caller of  rather than at each call site.,Set GTF_RELOP_QMARK in gtNewQmarkNode Each caller of  rather than at each call site.,Hackathon,luqunl,,
18190,[arm64] Implement compRsvdRegCheck,".

category:design
theme:basic-cq
skill-level:intermediate
cost:small
","[arm64] Implement compRsvdRegCheck .

category:design
theme:basic-cq
skill-level:intermediate
cost:small
",arch-arm64,BruceForstall,30/05/2018 10:13,
18187,[arm32arm64] Stop setting EMIT_TRACK_STACK_DEPTH to 1,"In target.h:

Is this a ""workaround"" that can be fixed?

category:design
theme:gc-info
skill-level:expert
cost:small","[arm32,arm64] Stop setting EMIT_TRACK_STACK_DEPTH to 1 In target.h:

Is this a ""workaround"" that can be fixed?

category:design
theme:gc-info
skill-level:expert
cost:small",arch-arm32,BruceForstall,30/05/2018 9:53,
18186,[WIP]Add DllImport Charset UTF8,"The purpose is to enable Charset.UTF8 support for DllImport which will help customer to write cross-platform PInvoke.

Partial Fix https://github.com/dotnet/coreclr/issues/1012

Remaining problems:
1. UTF8 Array isn't support yet. 
2. Update roslyn to support Charset UTF8
3. There are couple shift/reduce reduce/reduce conflict for ilasm yy file
4. More testing

Open problems:
1. What's the native type for default char marshalling with [DllImport(CharSet = CharSet.UTF8)]
Currently use U2 instead.
2. Whether UnmanagedType.LPTSTR should support UTF8? 
Currently LPTSTR only supports ANSI/Unicode
3. Whether UnmanagedType.AsAny should support UTF8?  
Currently AsAny doesn't support UTF8.
4. Ongoing support for UTF16(LE/BE) UTF32?


","[WIP]Add DllImport Charset UTF8 The purpose is to enable Charset.UTF8 support for DllImport which will help customer to write cross-platform PInvoke.

Partial Fix https://github.com/dotnet/coreclr/issues/1012

Remaining problems:
1. UTF8 Array isn't support yet. 
2. Update roslyn to support Charset UTF8
3. There are couple shift/reduce reduce/reduce conflict for ilasm yy file
4. More testing

Open problems:
1. What's the native type for default char marshalling with [DllImport(CharSet = CharSet.UTF8)]
Currently use U2 instead.
2. Whether UnmanagedType.LPTSTR should support UTF8? 
Currently LPTSTR only supports ANSI/Unicode
3. Whether UnmanagedType.AsAny should support UTF8?  
Currently AsAny doesn't support UTF8.
4. Ongoing support for UTF16(LE/BE) UTF32?


",area-Interop,luqunl,,
18185,JIT: Eliminate RegTracker,Now that ,JIT: Eliminate RegTracker Now that ,area-CodeGen,CarolEidt,30/05/2018 9:22,30/05/2018 9:36
18182,[arm32 arm64] Build framework with IBC data and hot/cold splitting,"Apparently the official builds for arm32 and arm64 do not implement IBC data optimization. We should implement this to gain those benefits.

This issue should probably be in some other repo but putting it here for tracking for now.

Related: https://github.com/dotnet/coreclr/issues/18181
","[arm32, arm64] Build framework with IBC data and hot/cold splitting Apparently the official builds for arm32 and arm64 do not implement IBC data optimization. We should implement this to gain those benefits.

This issue should probably be in some other repo but putting it here for tracking for now.

Related: https://github.com/dotnet/coreclr/issues/18181
",arch-arm32,BruceForstall,30/05/2018 7:53,
18181,[arm64] Implement hot/cold splitting,"From 


category:cq
theme:optimization
skill-level:expert
cost:large","[arm64] Implement hot/cold splitting From 


category:cq
theme:optimization
skill-level:expert
cost:large",arch-arm64,BruceForstall,30/05/2018 7:40,
18179,JIT: Eliminate RegTracker,"Now that  is gone do we still need RegTracker?
","JIT: Eliminate RegTracker Now that  is gone do we still need RegTracker?
",Hackathon,cshung,,
18178,[arm64] Implement/remove NYI_ARM64,"The following are the remaining . They should either be removed if not needed or implemented or split into a separate issue for each related unimplemented feature.

| File | NYI |
| --- | --- |
| codegenarmarch.cpp | NYI_ARM64(""CodeGen::genJmpMethod with multireg HFA arg"") |
| ~~codegencommon.cpp~~ | ~~NYI_ARM64(""Unsupported JMP indirection"")~~ |
| ~~emit.cpp~~ | ~~NYI_ARM64(""Need to handle fix-up to data from cold code."")~~ |
| ~~emitarm64.cpp~~ | ~~NYI_ARM64(""Relocation Support for long address"")~~ |
| ~~morph.cpp~~ | ~~NYI_ARM64(""Tail calls via stub are unsupported on this platform."")~~ |
| ~~register_arg_convention.cpp~~ | ~~NYI_ARM64(""alignReg"")~~ |

category:correctness
theme:testing
skill-level:expert
cost:small","[arm64] Implement/remove NYI_ARM64 The following are the remaining . They should either be removed if not needed or implemented or split into a separate issue for each related unimplemented feature.

| File | NYI |
| --- | --- |
| codegenarmarch.cpp | NYI_ARM64(""CodeGen::genJmpMethod with multireg HFA arg"") |
| ~~codegencommon.cpp~~ | ~~NYI_ARM64(""Unsupported JMP indirection"")~~ |
| ~~emit.cpp~~ | ~~NYI_ARM64(""Need to handle fix-up to data from cold code."")~~ |
| ~~emitarm64.cpp~~ | ~~NYI_ARM64(""Relocation Support for long address"")~~ |
| ~~morph.cpp~~ | ~~NYI_ARM64(""Tail calls via stub are unsupported on this platform."")~~ |
| ~~register_arg_convention.cpp~~ | ~~NYI_ARM64(""alignReg"")~~ |

category:correctness
theme:testing
skill-level:expert
cost:small",arch-arm64,BruceForstall,,
18177,JIT: Remove unused parameters from genCreateAddrMode,Now that the  and it would be good to clean up this header to follow the format here: https://github.com/dotnet/coreclr/blob/master/Documentation/coding-guidelines/clr-jit-coding-conventions.md#94-function-header-comment,JIT: Remove unused parameters from genCreateAddrMode Now that the  and it would be good to clean up this header to follow the format here: https://github.com/dotnet/coreclr/blob/master/Documentation/coding-guidelines/clr-jit-coding-conventions.md#94-function-header-comment,Hackathon,Suchiman,,
18176,JIT: x86 assertion failed 'header->gsCookieOffset != INVALID_GS_COOKIE_OFFSET',"Regression caused by #17996.

If the jit sees a zero-sized stackalloc it will push a null unmanaged pointer. Unfortunately the jit may have already decided it needs a GS cookie and without a proper stackalloc it never sets a slot for the GS cookie hence the assert.

Recent CSCs fold away computations leading to zero-sized stackallocs and do this optimization directly in IL. But older CSCs will leave the computations around:

 and so the jit now folds the size computation to zero.","JIT: x86 assertion failed 'header->gsCookieOffset != INVALID_GS_COOKIE_OFFSET' Regression caused by #17996.

If the jit sees a zero-sized stackalloc it will push a null unmanaged pointer. Unfortunately the jit may have already decided it needs a GS cookie and without a proper stackalloc it never sets a slot for the GS cookie hence the assert.

Recent CSCs fold away computations leading to zero-sized stackallocs and do this optimization directly in IL. But older CSCs will leave the computations around:

 and so the jit now folds the size computation to zero.",arch-x86,AndyAyersMS,,
18175,[Arm64] Enable HW intrinsics for Windows,"It appears arm64 HW intrinsics capabilities are enabled for Linux via  and not via a cross-platform mechanism used by Windows.

Enable Windows/Linux parity by enabling (and testing) the HW intrinsics for Windows as well.
","[Arm64] Enable HW intrinsics for Windows It appears arm64 HW intrinsics capabilities are enabled for Linux via  and not via a cross-platform mechanism used by Windows.

Enable Windows/Linux parity by enabling (and testing) the HW intrinsics for Windows as well.
",arch-arm64,CarolEidt,,
18174,[arm64/Linux] Enable 'jitnosimd' testing?,"Arm64/Linux is missing the netci.groovy 'jitnosimd' testing job ().

It doesn't make sense (or is duplicative) for arm32. But arm64 does support SIMD so should support this mode.
","[arm64/Linux] Enable 'jitnosimd' testing? Arm64/Linux is missing the netci.groovy 'jitnosimd' testing job ().

It doesn't make sense (or is duplicative) for arm32. But arm64 does support SIMD so should support this mode.
",arch-arm64,BruceForstall,,
18172,Fix CI views to only include top-level flow jobs,"Jobs that are only executed as part of flow jobs should not be included in the per-architecture Jenkins views.

E.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm64/ should not include ""_tst"" jobs.
","Fix CI views to only include top-level flow jobs Jobs that are only executed as part of flow jobs should not be included in the per-architecture Jenkins views.

E.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm64/ should not include ""_tst"" jobs.
",area-Infrastructure-coreclr,BruceForstall,,
18170,[arm64/Windows] Add corefx testing to CI,"We have arm32 Windows and Ubuntu arm64 altjit and arm64 Ubuntu corefx testing in CI. Add arm64 Windows (hardware) corefx testing.
","[arm64/Windows] Add corefx testing to CI We have arm32 Windows and Ubuntu arm64 altjit and arm64 Ubuntu corefx testing in CI. Add arm64 Windows (hardware) corefx testing.
",arch-arm64,BruceForstall,,
18162,Remove unsafe code from number parsing,"There is heavy use of unsafe code in number.parsing.cs and calling code (eg at https://github.com/dotnet/corefx/blob/master/src/Common/src/CoreLib/System/Number.Parsing.cs#L399). This could be rewritten with  resulting in safer code that is also easier to read.

Relates to https://github.com/dotnet/coreclr/pull/17808","Remove unsafe code from number parsing There is heavy use of unsafe code in number.parsing.cs and calling code (eg at https://github.com/dotnet/corefx/blob/master/src/Common/src/CoreLib/System/Number.Parsing.cs#L399). This could be rewritten with  resulting in safer code that is also easier to read.

Relates to https://github.com/dotnet/coreclr/pull/17808",area-System.Runtime,RussKeldorph,30/05/2018 3:32,
18157, An assembly specified in the application dependencies manifest was not found,"I got the following error when I am trying to start asp.net core server not on my dev system:

	  An assembly specified in the application dependencies manifest (PublishError.deps.json) was not found:
		package: 'HtmlAgilityPack' version: '1.8.4'
		path: 'lib/netstandard2.0/HtmlAgilityPack.dll'

Now server is Win 10  but I got this error both on Windows and Linux. On Windows I got not only runtime but also an sdk - doesnt help .

Sample project can be [found here](https://drive.google.com/open?id=1H0ecF5kqkbSCkPM6_Bi9CGX6DlBf9ApS
)."," An assembly specified in the application dependencies manifest was not found I got the following error when I am trying to start asp.net core server not on my dev system:

	  An assembly specified in the application dependencies manifest (PublishError.deps.json) was not found:
		package: 'HtmlAgilityPack' version: '1.8.4'
		path: 'lib/netstandard2.0/HtmlAgilityPack.dll'

Now server is Win 10  but I got this error both on Windows and Linux. On Windows I got not only runtime but also an sdk - doesnt help .

Sample project can be [found here](https://drive.google.com/open?id=1H0ecF5kqkbSCkPM6_Bi9CGX6DlBf9ApS
).",area-AssemblyLoader,jkotas,29/05/2018 22:11,1/05/2019 5:59
18156,Run CoreFX tests as default PR-triggered CI jobs ,"# CoreFX CI Testing Scenario for CoreCLR #

## Current State of CoreFX testing in CoreCLR
Currently the CoreCLR repos runs CoreFX tests by checking out the CoreFX repository at a specified commit (or HEAD by default) building the repo on top of the runtime to test building all tests and subsequently running them.  These jobs run post-check-in in multiple different stress configurations.
While this approach is flexible a few details make it less suited to be used in CI. Firstly breaking changes can creep in due to CoreFX version mismatches. Secondly this process is time-consuming and storage-heavy which is not ideal for quick PR runs. Thirdly in the current state the way to skip running tests is by annotating the test code itself with XUnit annotations requiring changes to be made in both repos and slowing down development 

## Current State of CoreFX testing in CoreRT (Proof of Concept)
When Helix runs CoreFX tests the produced project and test binaries are saved and kept for a limited time. A Test List is produced on every build with the URLs of the binaries. These built test assemblies can be reused for CI jobs allowing a quicker and less resource-intensive way to test changes made to the runtime.
In CoreRT a small subset of framework tests run for every PR. These tests are not built locally but instead an already built set of tests is saved in blob storage and downloaded on request. Each test project includes a XUnit test runner eliminating the need to build it independently.
A minimal test “harness” (in the form of a dummy ) as well as which tests should be excluded – defined either by fully-qualified name their class or namespace with a required reason for exclusion (validated on every test run). The feature will allow CI checks to pass even if a breaking change is propagating - the failing test(s) can be added to the exclusion list with a link to the associated issue or other reason for skipping during test runs avoiding the need to make any modifications to CoreFX-side test code. 

This gives a large degree of flexibility in defining test runs – each definition can be created as an easily extensible JSON file. Utilizing the enforced JSON schema additional tooling can be built around the framework – for example validity of exclusions can be tracked by an associated link to a GitHub issue. The validity of issues can be checked on each test run – using a library/tool similar to [Octokit.NET]( https://github.com/octokit/octokit.net ) .

## Proposal
The approach taken in CoreRT will be extended to cover CoreCLR. The CoreCLR components to be tested will be laid out such that they can be run with the dotnet cli mirroring the [binplacing approach](https://github.com/dotnet/corefx/blob/master/dir.props) in the CoreFX repo 

The established infrastructure pattern will be modified for better integration with the existing codebase – the test harness defining dependencies will be removed and instead the repo's XUnit version will be reused. The Core_Root folder built for current testing scenarios contains most components necessary to run tests and will therefore be reused. 

A test list will sit in the root of the blob storage instance with URL values of each test for supported configurations (e.g. Windows_NT x64). Once tests are run with a specified configuration the test list will be read and the test suites at the relevant URLs downloaded.

Each test flight’s included test assemblies and method/class/namespace exclusions will be defined via a JSON file. The test assemblies can be automatically updated and replaced in blob storage by running a full CoreFX build for each respective configuration. For the current work built CoreFX test assemblies will be copied into separate blob storage to be used by the CI setup. 

Outside of the scope of this proposal binary management can be automated by adding features to dotnet-maestro-bot updating the test assemblies on every update to the current CoreFX version.

","Run CoreFX tests as default PR-triggered CI jobs  # CoreFX CI Testing Scenario for CoreCLR #

## Current State of CoreFX testing in CoreCLR
Currently the CoreCLR repos runs CoreFX tests by checking out the CoreFX repository at a specified commit (or HEAD by default) building the repo on top of the runtime to test building all tests and subsequently running them.  These jobs run post-check-in in multiple different stress configurations.
While this approach is flexible a few details make it less suited to be used in CI. Firstly breaking changes can creep in due to CoreFX version mismatches. Secondly this process is time-consuming and storage-heavy which is not ideal for quick PR runs. Thirdly in the current state the way to skip running tests is by annotating the test code itself with XUnit annotations requiring changes to be made in both repos and slowing down development 

## Current State of CoreFX testing in CoreRT (Proof of Concept)
When Helix runs CoreFX tests the produced project and test binaries are saved and kept for a limited time. A Test List is produced on every build with the URLs of the binaries. These built test assemblies can be reused for CI jobs allowing a quicker and less resource-intensive way to test changes made to the runtime.
In CoreRT a small subset of framework tests run for every PR. These tests are not built locally but instead an already built set of tests is saved in blob storage and downloaded on request. Each test project includes a XUnit test runner eliminating the need to build it independently.
A minimal test “harness” (in the form of a dummy ) as well as which tests should be excluded – defined either by fully-qualified name their class or namespace with a required reason for exclusion (validated on every test run). The feature will allow CI checks to pass even if a breaking change is propagating - the failing test(s) can be added to the exclusion list with a link to the associated issue or other reason for skipping during test runs avoiding the need to make any modifications to CoreFX-side test code. 

This gives a large degree of flexibility in defining test runs – each definition can be created as an easily extensible JSON file. Utilizing the enforced JSON schema additional tooling can be built around the framework – for example validity of exclusions can be tracked by an associated link to a GitHub issue. The validity of issues can be checked on each test run – using a library/tool similar to [Octokit.NET]( https://github.com/octokit/octokit.net ) .

## Proposal
The approach taken in CoreRT will be extended to cover CoreCLR. The CoreCLR components to be tested will be laid out such that they can be run with the dotnet cli mirroring the [binplacing approach](https://github.com/dotnet/corefx/blob/master/dir.props) in the CoreFX repo 

The established infrastructure pattern will be modified for better integration with the existing codebase – the test harness defining dependencies will be removed and instead the repo's XUnit version will be reused. The Core_Root folder built for current testing scenarios contains most components necessary to run tests and will therefore be reused. 

A test list will sit in the root of the blob storage instance with URL values of each test for supported configurations (e.g. Windows_NT x64). Once tests are run with a specified configuration the test list will be read and the test suites at the relevant URLs downloaded.

Each test flight’s included test assemblies and method/class/namespace exclusions will be defined via a JSON file. The test assemblies can be automatically updated and replaced in blob storage by running a full CoreFX build for each respective configuration. For the current work built CoreFX test assemblies will be copied into separate blob storage to be used by the CI setup. 

Outside of the scope of this proposal binary management can be automated by adding features to dotnet-maestro-bot updating the test assemblies on every update to the current CoreFX version.

",area-Infrastructure-coreclr,A-And,,
18155,Generate native image from IL the same way as produced by JIT,"Question:
Is there any way I could get a dump of native executable code that .NET Core JIT creates with some additional custom markup? It is not required to be runnable when transferred to different PC.

I'd like to try to run the tool called ""Intel Architecture Code Analyzer"" (https://software.intel.com/en-us/articles/intel-architecture-code-analyzer) to analyze the performance of my tool which is currently under development in context of different CPUs - this is what the IACA tool does but it normally accepts compiled native binary file with ""magic"" byte sequences inserted telling the region of code which is subject for the analysis.
Thanks.
category:design
theme:ngen
skill-level:expert
cost:large","Generate native image from IL the same way as produced by JIT Question:
Is there any way I could get a dump of native executable code that .NET Core JIT creates with some additional custom markup? It is not required to be runnable when transferred to different PC.

I'd like to try to run the tool called ""Intel Architecture Code Analyzer"" (https://software.intel.com/en-us/articles/intel-architecture-code-analyzer) to analyze the performance of my tool which is currently under development in context of different CPUs - this is what the IACA tool does but it normally accepts compiled native binary file with ""magic"" byte sequences inserted telling the region of code which is subject for the analysis.
Thanks.
category:design
theme:ngen
skill-level:expert
cost:large",area-CodeGen,RussKeldorph,29/05/2018 3:46,
18154,[WIP] Upload perf artifacts to Azure Blob Storage using AzCopy,,[WIP] Upload perf artifacts to Azure Blob Storage using AzCopy ,* NO MERGE *,dotnet-bot,28/05/2018 22:54,9/10/2018 2:43
18153,Assertion failed 'farthestRefPhysRegRecord != nullptr' /dotnet/coreclr/src/jit/lsra.cpp:3637 ,"I'm using the x86 version of the CoreCLR to run CoreRT and compile tests for ARM.

After the commit:
> b39a5b2cfad4620ae23cda84186a36ffb463cd5a 

compilation fails (for all tests) with message

> cd /overlay.arm.Debug && ./corerun ilc.dll --codegenopt ""AltJitNgen=*"" @/overlay.arm.Debug/pow3/base.ilc.rsp
/dotnet/coreclr/src/jit/lsra.cpp:3637
Assertion failed 'farthestRefPhysRegRecord != nullptr' in 'Sys:DoubleToString(doubleintintint):int' (IL size 14)

The folder /overlay.arm.Debug/ contains necessary parts from CoreRT CoreCLR and CoreFX to 
cross-compile IL binary to native ARM code.  I've followed the following guide: [https://github.com/dotnet/corert/blob/master/Documentation/cross-building.md](url)
The 

I've checked with the following versions of the CoreCRL CoreRT and CoreFX:

CoreCLR: 6bf04a47badd74646e21e70f4e9267c71b7bfd08
CoreFX: ccdb5a48a49d3e932aa00d02749777464f4c8d5b
CoreRT: a028615abe80057e413d632a7c9257208b7c6865


","Assertion failed 'farthestRefPhysRegRecord != nullptr' /dotnet/coreclr/src/jit/lsra.cpp:3637  I'm using the x86 version of the CoreCLR to run CoreRT and compile tests for ARM.

After the commit:
> b39a5b2cfad4620ae23cda84186a36ffb463cd5a 

compilation fails (for all tests) with message

> cd /overlay.arm.Debug && ./corerun ilc.dll --codegenopt ""AltJitNgen=*"" @/overlay.arm.Debug/pow3/base.ilc.rsp
/dotnet/coreclr/src/jit/lsra.cpp:3637
Assertion failed 'farthestRefPhysRegRecord != nullptr' in 'Sys:DoubleToString(doubleintintint):int' (IL size 14)

The folder /overlay.arm.Debug/ contains necessary parts from CoreRT CoreCLR and CoreFX to 
cross-compile IL binary to native ARM code.  I've followed the following guide: [https://github.com/dotnet/corert/blob/master/Documentation/cross-building.md](url)
The 

I've checked with the following versions of the CoreCRL CoreRT and CoreFX:

CoreCLR: 6bf04a47badd74646e21e70f4e9267c71b7bfd08
CoreFX: ccdb5a48a49d3e932aa00d02749777464f4c8d5b
CoreRT: a028615abe80057e413d632a7c9257208b7c6865


",arch-arm32,CarolEidt,,
18151,Test failure: GC_Coverage._delete_next_card_table_delete_next_card_table_/_delete_next_card_table_delete_next_card_table_cmd,"Opened on behalf of @Sunny-pu

The test  has failed.

Test Infrastructure Failure: Could not load file or assembly 'System.Memory Version=4.1.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. The system cannot find the file specified.
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180528.01 (Ready-To-Run Tests)
Failing configurations:
- ubuntu.1604.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180528.01/workItem/GC.Coverage.XUnitWrapper/analysis/xunit/GC_Coverage._delete_next_card_table_delete_next_card_table_~2F_delete_next_card_table_delete_next_card_table_cmd","Test failure: GC_Coverage._delete_next_card_table_delete_next_card_table_/_delete_next_card_table_delete_next_card_table_cmd Opened on behalf of @Sunny-pu

The test  has failed.

Test Infrastructure Failure: Could not load file or assembly 'System.Memory Version=4.1.0.0 Culture=neutral PublicKeyToken=cc7b13ffcd2ddd51'. The system cannot find the file specified.
    
    Expected: True
    Actual:   False

        Stack Trace:

        
Build : Master - 20180528.01 (Ready-To-Run Tests)
Failing configurations:
- ubuntu.1604.amd64
  - x64

Details: https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fr2r~2Fcli~2F/build/20180528.01/workItem/GC.Coverage.XUnitWrapper/analysis/xunit/GC_Coverage._delete_next_card_table_delete_next_card_table_~2F_delete_next_card_table_delete_next_card_table_cmd",test-run-uwp-coreclr,RussKeldorph,28/05/2018 17:27,31/05/2018 4:19
18149,Multiple restart of runtime host within the same process,"We have requirement to restart the runtime host within the same process. We are using following sequence of calls with ICLRRuntimeHost4 interface as listed in https://docs.microsoft.com/en-us/dotnet/core/tutorials/netcore-hosting

1. Load coreclr library and get m_runtimehost (of type ICLRRuntimeHost4) by calling GetCLRRuntimeHost
2. m_runtimehost->Start()
3. m_runtimehost->CreateAppDomainwithManager() => using SINGLE_APP_DOMAIN
4. m_runtimehost->CreateDelegate()
5. Call delegates
6. m_runtimehost->UnloadAppDomain2()
7. m_runtimehost->Stop()
8. Unload the coreclr library

When we try to repeat the above sequence without restart of the process we get access violation exception at step 2 above with following call stack

        coreclr.dll!SystemDomain::LoadBaseSystemClasses() Line 2715	C++
 	coreclr.dll!SystemDomain::Init() Line 2460	C++
 	coreclr.dll!EEStartupHelper(tagCOINITEE) Line 1058	C++
 	coreclr.dll!EEStartup(tagCOINITEE) Line 1237	C++
 	coreclr.dll!EnsureEEStarted(tagCOINITEE) Line 375	C++
 	coreclr.dll!CorHost2::Start() Line 189	C++

1. Is this known issue? Is there any workaround to restart the runtime host multiple times without restarting the process? We see similar issue with Linux hosts throwing exception in coreclr_initialize method.
2. We are also seeing managed assemblies not being unloaded with UnloadAppDomain2 call mentioned in the step 6 above. Also we expect memory to be released when we call m_runtimehost->Stop() mentioned in the step 7 above.
","Multiple restart of runtime host within the same process We have requirement to restart the runtime host within the same process. We are using following sequence of calls with ICLRRuntimeHost4 interface as listed in https://docs.microsoft.com/en-us/dotnet/core/tutorials/netcore-hosting

1. Load coreclr library and get m_runtimehost (of type ICLRRuntimeHost4) by calling GetCLRRuntimeHost
2. m_runtimehost->Start()
3. m_runtimehost->CreateAppDomainwithManager() => using SINGLE_APP_DOMAIN
4. m_runtimehost->CreateDelegate()
5. Call delegates
6. m_runtimehost->UnloadAppDomain2()
7. m_runtimehost->Stop()
8. Unload the coreclr library

When we try to repeat the above sequence without restart of the process we get access violation exception at step 2 above with following call stack

        coreclr.dll!SystemDomain::LoadBaseSystemClasses() Line 2715	C++
 	coreclr.dll!SystemDomain::Init() Line 2460	C++
 	coreclr.dll!EEStartupHelper(tagCOINITEE) Line 1058	C++
 	coreclr.dll!EEStartup(tagCOINITEE) Line 1237	C++
 	coreclr.dll!EnsureEEStarted(tagCOINITEE) Line 375	C++
 	coreclr.dll!CorHost2::Start() Line 189	C++

1. Is this known issue? Is there any workaround to restart the runtime host multiple times without restarting the process? We see similar issue with Linux hosts throwing exception in coreclr_initialize method.
2. We are also seeing managed assemblies not being unloaded with UnloadAppDomain2 call mentioned in the step 6 above. Also we expect memory to be released when we call m_runtimehost->Stop() mentioned in the step 7 above.
",question,jkotas,28/05/2018 14:00,1/06/2018 0:13
18148,Question: How do I diagnose an IPE?,I am running code on .NET Core that is ported over from mono. The same compiler was used in both instances. Mono runs the IL fine but .NET Core is complaining about invalid IL in a particular method. Is there a debug flag that will make .NET Core spit out the exact instruction that it finds invalid? As the author of said compiler I could fix the bug pointed out by the CLR if I had the instruction pointed out.,Question: How do I diagnose an IPE? I am running code on .NET Core that is ported over from mono. The same compiler was used in both instances. Mono runs the IL fine but .NET Core is complaining about invalid IL in a particular method. Is there a debug flag that will make .NET Core spit out the exact instruction that it finds invalid? As the author of said compiler I could fix the bug pointed out by the CLR if I had the instruction pointed out.,area-Diagnostics,jkotas,28/05/2018 6:05,23/02/2019 9:51
18147,Report a better error message when assembly version conflict is encountered,"The simplest possible .NET Core 1.0 console application throws a 

[ConsoleApp20.zip](https://github.com/dotnet/coreclr/files/2042920/ConsoleApp20.zip)
","Report a better error message when assembly version conflict is encountered The simplest possible .NET Core 1.0 console application throws a 

[ConsoleApp20.zip](https://github.com/dotnet/coreclr/files/2042920/ConsoleApp20.zip)
",area-AssemblyLoader,jkotas,28/05/2018 4:59,
18145,Some integer scalar and vectored methods/overloads are not exposed in HW intrinsics API,"1. Currently the intrinsics are exposed for signed int -> signed int and for unsigned int -> signed int upconversion when both src and dest are 128-bit vector. But no such API method is directly exposed for **unsigned int -> unsigned int** so one has to either use  - merge single element from [m] into xmm. There is special issue open on API for INSERTPS ( #18143 ).

category:testing
theme:intrinsics
skill-level:intermediate
cost:medium","Some integer scalar and vectored methods/overloads are not exposed in HW intrinsics API 1. Currently the intrinsics are exposed for signed int -> signed int and for unsigned int -> signed int upconversion when both src and dest are 128-bit vector. But no such API method is directly exposed for **unsigned int -> unsigned int** so one has to either use  - merge single element from [m] into xmm. There is special issue open on API for INSERTPS ( #18143 ).

category:testing
theme:intrinsics
skill-level:intermediate
cost:medium",Design Discussion,RussKeldorph,28/05/2018 2:27,22/03/2019 3:15
18144,Sub-optimal performance when saving/restoring upper parts of YMM regs on AVX+ before/after invoking nested methods,"Currently 
category:cq
theme:register-allocator
skill-level:expert
cost:medium
","Sub-optimal performance when saving/restoring upper parts of YMM regs on AVX+ before/after invoking nested methods Currently 
category:cq
theme:register-allocator
skill-level:expert
cost:medium
",arch-x64,CarolEidt,,
18143,HW intrinsics API declaration is incorrect for Sse41.Insert() that operates on vector of 32-bit floats,The ,HW intrinsics API declaration is incorrect for Sse41.Insert() that operates on vector of 32-bit floats The ,area-CodeGen,CarolEidt,27/05/2018 22:33,19/06/2018 6:17
18137,Create a profiler API that appends to the TPA list,"This is a more distilled design proposal that solves issues raised in #3894. The idea is to add a new profiler API such as:

    ICorProfilerInfo10::AddAssemblyPath(AppDomainID appDomainId const WCHAR* pAssemblyPath)

which will add a path to list of assemblies that the runtime probes to resolve assembly references. This allows profilers to instrument managed code and include assembly references to a new assembly that was deployed by the profiler rather than being deployed as part of the application.


**Background info to assist implementors**

Probably the hardest part of the problem is creating a testable repro scenario (assuming you don't already have your own IL instrumenting profiler handy). There is an example instrumenting profiler here: https://github.com/Microsoft/clr-samples/tree/master/ProfilingAPI/ReJITEnterLeaveHooks that has most of what is necessary. However this example instruments using a CALLI instruction:
https://github.com/Microsoft/clr-samples/blob/master/ProfilingAPI/ReJITEnterLeaveHooks/ILRewriter.cpp#L746

To reproduce the problem here the profiler instead needs to:
1) Include with the profiler a new managed assembly that has the implementation of some simple callback within it. Lets call this ManagedInstrumentation.dll.



2) Use IMetaDataAssemblyEmit::DefineAssemblyRef to create an AssemblyRef token that refers to the ManagedInstrumentation.dll assembly.
https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/metadata/imetadataassemblyemit-defineassemblyref-method
3) Use IMetaDataEmit::DefineTypeRefByName and DefineMemberRef 
https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/metadata/imetadataemit-definetyperefbyname-method
https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/metadata/imetadataemit-definememberref-method
to create a MemberRef token that refers to ManagedCallbackFunctions.OnMethodEnter
4) Change the instrumentation to use an IL CALL opcode with the ManagedCallbackFunctions.OnMethodEnter token

Running an application with this profiler should fail because ManagedInstrumentation.dll can't be located.

5) To test the new API you will need to handle the AppDomainCreationFinished callback. In the handler QI for ICorProfilerInfo10 and then invoke AddTrustedAssemblyPath(domainId path_to_ManagedInstrumentation.dll). Initially the QI will fail but once the feature is implemented this call should succeed at modifying the assembly list. Later the compilation of instrumented methods should also succeed because the runtime will find ManagedInstrumentation.dll and load it.

To implement the feature:
1) Add the new API to https://github.com/dotnet/coreclr/blob/master/src/inc/corprof.idl
2) Add an implementation to 
https://github.com/dotnet/coreclr/blob/master/src/vm/proftoeeinterfaceimpl.h
https://github.com/dotnet/coreclr/blob/master/src/vm/proftoeeinterfaceimpl.cpp

The implementation of the method needs to change the TPA list which is stored here: 
https://github.com/dotnet/coreclr/blob/32f0f9721afb584b4a14d69135bea7ddc129f755/src/binder/inc/applicationcontext.inl#L74

Navigating to that datastructure should be something like:

    BaseDomain* pDomain = (BaseDomain *) appDomainId;
    pDomain->GetTPABinderContext()->GetAppContext()->GetTpaList();


More background docs about CLR and profiling:
https://github.com/dotnet/coreclr/tree/master/Documentation/botr
https://github.com/dotnet/coreclr/blob/master/Documentation/botr/profiling.md
https://github.com/dotnet/coreclr/blob/master/Documentation/botr/profilability.md

Where the TPA list normally gets set from without using a profiler:
https://github.com/dotnet/coreclr/blob/ef88a92215a8f90fe0bd8b0327c16bb889902105/src/vm/corhost.cpp#L820
Inside the pProfilerNames/Values there is a property named TRUSTED_PLATFORM_ASSEMBLIES with a list of assembly paths. The runtime host constructs this list however they want (dotnet.exe assembles it from some .json configuration files like app.deps.json) and then the runtime stores it.

","Create a profiler API that appends to the TPA list This is a more distilled design proposal that solves issues raised in #3894. The idea is to add a new profiler API such as:

    ICorProfilerInfo10::AddAssemblyPath(AppDomainID appDomainId const WCHAR* pAssemblyPath)

which will add a path to list of assemblies that the runtime probes to resolve assembly references. This allows profilers to instrument managed code and include assembly references to a new assembly that was deployed by the profiler rather than being deployed as part of the application.


**Background info to assist implementors**

Probably the hardest part of the problem is creating a testable repro scenario (assuming you don't already have your own IL instrumenting profiler handy). There is an example instrumenting profiler here: https://github.com/Microsoft/clr-samples/tree/master/ProfilingAPI/ReJITEnterLeaveHooks that has most of what is necessary. However this example instruments using a CALLI instruction:
https://github.com/Microsoft/clr-samples/blob/master/ProfilingAPI/ReJITEnterLeaveHooks/ILRewriter.cpp#L746

To reproduce the problem here the profiler instead needs to:
1) Include with the profiler a new managed assembly that has the implementation of some simple callback within it. Lets call this ManagedInstrumentation.dll.



2) Use IMetaDataAssemblyEmit::DefineAssemblyRef to create an AssemblyRef token that refers to the ManagedInstrumentation.dll assembly.
https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/metadata/imetadataassemblyemit-defineassemblyref-method
3) Use IMetaDataEmit::DefineTypeRefByName and DefineMemberRef 
https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/metadata/imetadataemit-definetyperefbyname-method
https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/metadata/imetadataemit-definememberref-method
to create a MemberRef token that refers to ManagedCallbackFunctions.OnMethodEnter
4) Change the instrumentation to use an IL CALL opcode with the ManagedCallbackFunctions.OnMethodEnter token

Running an application with this profiler should fail because ManagedInstrumentation.dll can't be located.

5) To test the new API you will need to handle the AppDomainCreationFinished callback. In the handler QI for ICorProfilerInfo10 and then invoke AddTrustedAssemblyPath(domainId path_to_ManagedInstrumentation.dll). Initially the QI will fail but once the feature is implemented this call should succeed at modifying the assembly list. Later the compilation of instrumented methods should also succeed because the runtime will find ManagedInstrumentation.dll and load it.

To implement the feature:
1) Add the new API to https://github.com/dotnet/coreclr/blob/master/src/inc/corprof.idl
2) Add an implementation to 
https://github.com/dotnet/coreclr/blob/master/src/vm/proftoeeinterfaceimpl.h
https://github.com/dotnet/coreclr/blob/master/src/vm/proftoeeinterfaceimpl.cpp

The implementation of the method needs to change the TPA list which is stored here: 
https://github.com/dotnet/coreclr/blob/32f0f9721afb584b4a14d69135bea7ddc129f755/src/binder/inc/applicationcontext.inl#L74

Navigating to that datastructure should be something like:

    BaseDomain* pDomain = (BaseDomain *) appDomainId;
    pDomain->GetTPABinderContext()->GetAppContext()->GetTpaList();


More background docs about CLR and profiling:
https://github.com/dotnet/coreclr/tree/master/Documentation/botr
https://github.com/dotnet/coreclr/blob/master/Documentation/botr/profiling.md
https://github.com/dotnet/coreclr/blob/master/Documentation/botr/profilability.md

Where the TPA list normally gets set from without using a profiler:
https://github.com/dotnet/coreclr/blob/ef88a92215a8f90fe0bd8b0327c16bb889902105/src/vm/corhost.cpp#L820
Inside the pProfilerNames/Values there is a property named TRUSTED_PLATFORM_ASSEMBLIES with a list of assembly paths. The runtime host constructs this list however they want (dotnet.exe assembles it from some .json configuration files like app.deps.json) and then the runtime stores it.

",area-Diagnostics,noahfalk,,
18133,Improve SOS to display current profiler state,"**Issue description**
Add a command to SOS to display the profiler's state in a process (whether it is attached and what configuration flags it was set up with). 

The task should be fairly straightforward as all the information that SOS needs to display is already stored in the g_profControlBlock struct. My estimation is roughly 3-4 hours for someone who's not already familiar with the codebase.

This issue is originally from: https://github.com/dotnet/coreclr/issues/12719 (partially)

**A little bit of background**
SOS (Son of Strike) is a debugging extension that allows us to debug managed applications running on top of CLR. You can find the source in the ).

You can follow the code path for other SOS commands that are already implemented (i.e. DumpHeap ClrStack) to see how they are implemented as a reference.

CC @mikem8361 @noahfalk ","Improve SOS to display current profiler state **Issue description**
Add a command to SOS to display the profiler's state in a process (whether it is attached and what configuration flags it was set up with). 

The task should be fairly straightforward as all the information that SOS needs to display is already stored in the g_profControlBlock struct. My estimation is roughly 3-4 hours for someone who's not already familiar with the codebase.

This issue is originally from: https://github.com/dotnet/coreclr/issues/12719 (partially)

**A little bit of background**
SOS (Son of Strike) is a debugging extension that allows us to debug managed applications running on top of CLR. You can find the source in the ).

You can follow the code path for other SOS commands that are already implemented (i.e. DumpHeap ClrStack) to see how they are implemented as a reference.

CC @mikem8361 @noahfalk ",area-Diagnostics,mikem8361,26/05/2018 9:46,
18131,Enhance ABI and ISA support in altjits,"It would be desirable when an altjit is being used to have the full ABI information available plus a default setting for the ISA support (for hardware intrinsics). This might be easier to accomplish with a cleaner refactored .

category:design
theme:calling-convention
skill-level:expert
cost:medium","Enhance ABI and ISA support in altjits It would be desirable when an altjit is being used to have the full ABI information available plus a default setting for the ISA support (for hardware intrinsics). This might be easier to accomplish with a cleaner refactored .

category:design
theme:calling-convention
skill-level:expert
cost:medium",area-CodeGen,CarolEidt,26/05/2018 6:27,
18130,[Arm64] JIT generate LSE Atomics,"When ARMv8.1 LSE Atomics are available use them to implement
Interlocked operations.

@briansull @BruceForstall @CarolEidt @dotnet/jit-contrib ","[Arm64] JIT generate LSE Atomics When ARMv8.1 LSE Atomics are available use them to implement
Interlocked operations.

@briansull @BruceForstall @CarolEidt @dotnet/jit-contrib ",area-CodeGen,briansull,26/05/2018 5:51,28/06/2018 2:51
18128,Clean the list of disabled warnings for CoreCLR,"[\src\inc\warningcontrol.h](https://github.com/dotnet/coreclr/blob/master/src/inc/warningcontrol.h) has list of disabled warning for all CoreCLR projects many of them came from the desktop and do not fire on CoreCLR (like 4053 4056 4100 etc) some of them need small fixed (4430) so the task is to:
1. delete all warnings that do not fire;
2. delete warning that needs simple small fixes (and fix them);","Clean the list of disabled warnings for CoreCLR [\src\inc\warningcontrol.h](https://github.com/dotnet/coreclr/blob/master/src/inc/warningcontrol.h) has list of disabled warning for all CoreCLR projects many of them came from the desktop and do not fire on CoreCLR (like 4053 4056 4100 etc) some of them need small fixed (4430) so the task is to:
1. delete all warnings that do not fire;
2. delete warning that needs simple small fixes (and fix them);",Hackathon,sandreenko,26/05/2018 4:07,5/03/2019 5:40
18123,CoreCLR failed when build in conformance mode (/permissive-)  ,"I build CoreCLR with Visual studio 15.7.1 in conformance mode (/permissive-) on Windows it failed with error C4596 The changes involved by
https://github.com/dotnet/coreclr/commit/b39a5b2cfad4620ae23cda84186a36ffb463cd5a#diff-7844842ffbae44d891b5170d2a229d4bR1590

Could you help remove the redundant ""LinearScan::"" on BuildRMWUses. The compiler complains about this in conformance mode (/permissive-)

Failures:
d:\coreclr\src\src\jit\lsra.h(1590): error C4596: 'BuildRMWUses': illegal qualified name in member declaration ","CoreCLR failed when build in conformance mode (/permissive-)   I build CoreCLR with Visual studio 15.7.1 in conformance mode (/permissive-) on Windows it failed with error C4596 The changes involved by
https://github.com/dotnet/coreclr/commit/b39a5b2cfad4620ae23cda84186a36ffb463cd5a#diff-7844842ffbae44d891b5170d2a229d4bR1590

Could you help remove the redundant ""LinearScan::"" on BuildRMWUses. The compiler complains about this in conformance mode (/permissive-)

Failures:
d:\coreclr\src\src\jit\lsra.h(1590): error C4596: 'BuildRMWUses': illegal qualified name in member declaration ",area-Infrastructure-coreclr,jkotas,25/05/2018 16:03,5/06/2018 3:10
18121,delete unused variables from jit,Delete unused variables after the  death.,delete unused variables from jit Delete unused variables after the  death.,area-CodeGen,sandreenko,25/05/2018 9:07,26/05/2018 8:02
18117,[JitStress] Crossgen JIT/Regression/JitBlue/GitHub_18056/Bool_And_Op_cs_do Jit Assert,"Hit this during crossgen in [ 
Ubuntu arm Cross Checked r2r_jitstress1 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_r2r_jitstress1_tst_prtest/6/consoleText) when testing #18053
","[JitStress] Crossgen JIT/Regression/JitBlue/GitHub_18056/Bool_And_Op_cs_do Jit Assert Hit this during crossgen in [ 
Ubuntu arm Cross Checked r2r_jitstress1 Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_r2r_jitstress1_tst_prtest/6/consoleText) when testing #18053
",arch-arm32,echesakovMSFT,,
18114,Collecting StackTrace performance,"Why can't I collect stack information?
Currently in the slow tracking details or error details the stack information corresponding to the .NET Core code method cannot be consulted.

The root cause is the poor performance of collecting StackTrace on the .NET Core 2.0 platform. After evaluation each execution of StackTrace will result in millisecond CPU usage.

Technically speaking we can collect the stack but due to performance issues releasing this feature will result in serious impact on user application performance so at present we have not yet opened the stack.

To solve this problem you must expect the .NET Core kernel team to develop a more efficient StackTrace approach.","Collecting StackTrace performance Why can't I collect stack information?
Currently in the slow tracking details or error details the stack information corresponding to the .NET Core code method cannot be consulted.

The root cause is the poor performance of collecting StackTrace on the .NET Core 2.0 platform. After evaluation each execution of StackTrace will result in millisecond CPU usage.

Technically speaking we can collect the stack but due to performance issues releasing this feature will result in serious impact on user application performance so at present we have not yet opened the stack.

To solve this problem you must expect the .NET Core kernel team to develop a more efficient StackTrace approach.",area-Diagnostics,RussKeldorph,24/05/2018 19:26,25/05/2018 3:52
18113,dynamic keyword takes too much time.,"We found that 

[Program.cs.zip](https://github.com/dotnet/coreclr/files/2034454/Program.cs.zip)

","dynamic keyword takes too much time. We found that 

[Program.cs.zip](https://github.com/dotnet/coreclr/files/2034454/Program.cs.zip)

",tenet-performance,janvorli,24/05/2018 18:51,31/05/2018 3:17
18112,Add additional preds checks to flowgraph.,,Add additional preds checks to flowgraph. ,area-CodeGen,sandreenko,24/05/2018 17:38,2/06/2018 5:05
18111,Add managed views of the EE datastructures like MethodTable ,"CoreRT CoreLib does this already. Related https://github.com/dotnet/coreclr/issues/9474.

It can be used for performance optimizations like https://github.com/dotnet/coreclr/pull/18101#discussion_r190346937","Add managed views of the EE datastructures like MethodTable  CoreRT CoreLib does this already. Related https://github.com/dotnet/coreclr/issues/9474.

It can be used for performance optimizations like https://github.com/dotnet/coreclr/pull/18101#discussion_r190346937",area-Meta-corelib,jkotas,24/05/2018 17:23,
18106,[Ignore] Testing some issue editing automation.,"Please ignore this issue. I'm using it to test some issue editing  automation. It will be deleted.

   category:somecategory1
 theme:sometheme1
     skill-level:beginner
  cost:medium","[Ignore] Testing some issue editing automation. Please ignore this issue. I'm using it to test some issue editing  automation. It will be deleted.

   category:somecategory1
 theme:sometheme1
     skill-level:beginner
  cost:medium",arch-arm32,erozenfeld,24/05/2018 9:52,12/08/2018 5:21
18104,[Arm64] Crypto assertion failure,"Recent regression 
JIT/HardwareIntrinsics/Arm64/Crypto/Crypto.sh


Failing on 6185b9af8
Passing on fa3e66ea42

@dotnet/arm64-contrib @CarolEidt ","[Arm64] Crypto assertion failure Recent regression 
JIT/HardwareIntrinsics/Arm64/Crypto/Crypto.sh


Failing on 6185b9af8
Passing on fa3e66ea42

@dotnet/arm64-contrib @CarolEidt ",arch-arm64,CarolEidt,24/05/2018 8:16,2/06/2018 7:06
18102,sharing SerializationInfo for corert and coreclr,"I tested locally on corert and on corefx and ran tests to make sure there is nothing is breaking.

I did multiple commits so that it's easier to review. Overall there was not much implementation difference more so it was code styles or renamings in the diff than anything else.

I had to add CORECLR condition in two places only.

I added  method and seems like the api is only public for corefx access. Let me know if we would like to keep it public. It was public in both repos anyway. I did however end up merging the comment contents for this method.

cc: @jkotas @danmosemsft ","sharing SerializationInfo for corert and coreclr I tested locally on corert and on corefx and ran tests to make sure there is nothing is breaking.

I did multiple commits so that it's easier to review. Overall there was not much implementation difference more so it was code styles or renamings in the diff than anything else.

I had to add CORECLR condition in two places only.

I added  method and seems like the api is only public for corefx access. Let me know if we would like to keep it public. It was public in both repos anyway. I did however end up merging the comment contents for this method.

cc: @jkotas @danmosemsft ",area-System.Runtime,maryamariyan,,
18100,[JIT] Allow the developer to instruct the JIT to do not reorder goto based blocks.,"When manually rearranging blocks you end up in situations where you know best what the arrangement is. I hit one of those cases when optimizing memory diffing. Example: https://youtu.be/DD3w66Ff8Ms?t=20859

Give the JIT a hint could help. 



Details on all the tricks can be found at: https://www.youtube.com/watch?time_continue=18053&v=DD3w66Ff8Ms

cc @AndyAyersMS ","[JIT] Allow the developer to instruct the JIT to do not reorder goto based blocks. When manually rearranging blocks you end up in situations where you know best what the arrangement is. I hit one of those cases when optimizing memory diffing. Example: https://youtu.be/DD3w66Ff8Ms?t=20859

Give the JIT a hint could help. 



Details on all the tricks can be found at: https://www.youtube.com/watch?time_continue=18053&v=DD3w66Ff8Ms

cc @AndyAyersMS ",Design Discussion,AndyAyersMS,24/05/2018 2:25,25/05/2018 6:09
18098,Cancel CTS immediately if delay is zero.,"The intended behaviour on specifying a delay of zero is that the CancellationTokenSource is cancelled immediately - before this change it would depend on the scheduling of the timer callback which could lead to seeing a non-cancelled token. Now it marks itself as cancelled immediately without invoking any callbacks (as this method is called only from within the constructor of the object before any callbacks could have been registered.

I can't find any tests for this code so I'm not in a position to update those apologies if I've missed them.","Cancel CTS immediately if delay is zero. The intended behaviour on specifying a delay of zero is that the CancellationTokenSource is cancelled immediately - before this change it would depend on the scheduling of the timer callback which could lead to seeing a non-cancelled token. Now it marks itself as cancelled immediately without invoking any callbacks (as this method is called only from within the constructor of the object before any callbacks could have been registered.

I can't find any tests for this code so I'm not in a position to update those apologies if I've missed them.",,stephentoub,,
18097,Which dependencies are runtime dependencies and which ones are build dependencies?,"I have a question about the dependencies listed in [the coreclr instructions](https://github.com/dotnet/coreclr/blob/release/2.1/Documentation/building/linux-instructions.md) and [the corefx instructions](https://github.com/dotnet/corefx/blob/master/Documentation/building/unix-instructions.md).
Which dependencies are for runtime and which ones are for build-time only?

Also if I install the SDK and run ldd on all the .so files included and all the dependencies resolve correctly does that mean I have everything I need for runtime installed on the box?
In other words are there any DllImports in the C# for shared libraries other than the ones included in the SDK?","Which dependencies are runtime dependencies and which ones are build dependencies? I have a question about the dependencies listed in [the coreclr instructions](https://github.com/dotnet/coreclr/blob/release/2.1/Documentation/building/linux-instructions.md) and [the corefx instructions](https://github.com/dotnet/corefx/blob/master/Documentation/building/unix-instructions.md).
Which dependencies are for runtime and which ones are for build-time only?

Also if I install the SDK and run ldd on all the .so files included and all the dependencies resolve correctly does that mean I have everything I need for runtime installed on the box?
In other words are there any DllImports in the C# for shared libraries other than the ones included in the SDK?",area-PAL,RussKeldorph,24/05/2018 0:38,24/05/2018 7:45
18093,Fix parallel spmi return code.,"Sort and merge children return codes for the parallel spmi runs.
Found after #17997; our internal system reports exit code 0x3 (missing values) even if there are actual errors (0x1).

cc @dotnet/jit-contrib ","Fix parallel spmi return code. Sort and merge children return codes for the parallel spmi runs.
Found after #17997; our internal system reports exit code 0x3 (missing values) even if there are actual errors (0x1).

cc @dotnet/jit-contrib ",area-Infrastructure-coreclr,sandreenko,23/05/2018 11:36,24/05/2018 3:23
18091,Unexplained ref count sorting for ARM only,"The following code in Compiler::WtdRefCntCmp() (and also in the currently-unused Compiler::RefCntCmp) is only for non-ARM targets. This seems strange and unexplained. Should the 
category:cq
theme:basic-cq
skill-level:intermediate
cost:small","Unexplained ref count sorting for ARM only The following code in Compiler::WtdRefCntCmp() (and also in the currently-unused Compiler::RefCntCmp) is only for non-ARM targets. This seems strange and unexplained. Should the 
category:cq
theme:basic-cq
skill-level:intermediate
cost:small",area-CodeGen,BruceForstall,23/05/2018 8:44,
18088,Add -Wthread-safety to CoreCLR build,"This found a real issue for us at least on BSD with Clang3.9 and may be more useful as headers are updated. It has no effect on the generated binaries so probably reasonable for us to enable for CoreCLR.

See https://github.com/dotnet/corefx/pull/29850
https://clang.llvm.org/docs/ThreadSafetyAnalysis.html

@janvorli ","Add -Wthread-safety to CoreCLR build This found a real issue for us at least on BSD with Clang3.9 and may be more useful as headers are updated. It has no effect on the generated binaries so probably reasonable for us to enable for CoreCLR.

See https://github.com/dotnet/corefx/pull/29850
https://clang.llvm.org/docs/ThreadSafetyAnalysis.html

@janvorli ",Hackathon,janvorli,23/05/2018 7:37,
18084,Basic block moved out of the loop flow after JIT optimization,"Sometimes JITter moves basic block away from the loop giving two extra 
category:cq
theme:basic-cq
skill-level:intermediate
cost:small","Basic block moved out of the loop flow after JIT optimization Sometimes JITter moves basic block away from the loop giving two extra 
category:cq
theme:basic-cq
skill-level:intermediate
cost:small",area-CodeGen,RussKeldorph,22/05/2018 21:59,
18082,Refactor fgDebugCheckBBlist,"No Spmi diffs.

This is a preparation PR before the fix for #18056 .","Refactor fgDebugCheckBBlist No Spmi diffs.

This is a preparation PR before the fix for #18056 .",area-CodeGen,sandreenko,22/05/2018 15:49,24/05/2018 6:52
18081,Implement the HWIntrinsics for FMA,,Implement the HWIntrinsics for FMA ,area-CodeGen,tannergooding,,
18076,Build failure: Link,"Opened on behalf of @RussKeldorph

Warnings: 6
Status Message: failed

Build : Master - 20180518.01 (Product Build)
Failing configurations:
- Linux
  - PortableCrossBuild-Checked-arm
  - PortableCrossBuild-Debug-arm64
  - PortableCrossBuild-Release-arm64
  - PortableCrossBuild-Release-arm
  - PortableCrossBuild-Debug-arm
  - Debug-x64
  - Release-x64
  - Checked-x64
  - PortableCrossBuild-Checked-arm64
- Linux-musl
  - Release-x64
  - Checked-x64
  - Debug-x64
- RedHat6
  - Checked-x64
  - Release-x64
  - Debug-x64
- OSX
  - PortableBuild-Release-x64
  - PortableBuild-Debug-x64
  - PortableBuild-Checked-x64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180518.01/workItem/Orchestration/analysis/external/Link)
","Build failure: Link Opened on behalf of @RussKeldorph

Warnings: 6
Status Message: failed

Build : Master - 20180518.01 (Product Build)
Failing configurations:
- Linux
  - PortableCrossBuild-Checked-arm
  - PortableCrossBuild-Debug-arm64
  - PortableCrossBuild-Release-arm64
  - PortableCrossBuild-Release-arm
  - PortableCrossBuild-Debug-arm
  - Debug-x64
  - Release-x64
  - Checked-x64
  - PortableCrossBuild-Checked-arm64
- Linux-musl
  - Release-x64
  - Checked-x64
  - Debug-x64
- RedHat6
  - Checked-x64
  - Release-x64
  - Debug-x64
- OSX
  - PortableBuild-Release-x64
  - PortableBuild-Debug-x64
  - PortableBuild-Checked-x64
[Mission Control Build Info](https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/build~2Fproduct~2F/build/20180518.01/workItem/Orchestration/analysis/external/Link)
",area-Tracing,brianrob,,
18071,coreclr.lib,"Copying from Dotnet: https://github.com/Microsoft/dotnet/issues/753


daoqiang commented 9 hours ago • edited  
I want to add coreclr to my project. I must introduce it in a static way. What should I do?
There can be no dynamic reference，thank you","coreclr.lib Copying from Dotnet: https://github.com/Microsoft/dotnet/issues/753


daoqiang commented 9 hours ago • edited  
I want to add coreclr to my project. I must introduce it in a static way. What should I do?
There can be no dynamic reference，thank you",area-AssemblyLoader,jeffschwMSFT,22/05/2018 3:45,
18069,Sub-optimal codegen when using Sse.StaticCast<TFromTTo>() with non-VEX encoded HW intrinsics,"Below is the source code (basically this is an example of partial vector update code trimmed down for repro):

            // Setup constants
            Vector128<ushort> valuesIncrement = Sse2.SetAllVector128((ushort)0x0001U); // <== no. 1
            Vector128<ushort> opCookie = Sse.StaticCast<ulong ushort>( //<== no. 2
                Sse2.SetVector128(
                    0x0001_0002_0003_0004UL
                    0x0005_0006_0007_0008UL));

            // Setup initial condition
            Vector128<ushort> values = Sse2.SetVector128(
                (ushort)0x1111U (ushort)0x2222U (ushort)0x3333U (ushort)0x4444U
                (ushort)0x5555U (ushort)0x6666U (ushort)0x7777U (ushort)0x8888U);

            // Simulate op
            Vector128<ushort> updateSelector = Sse2.SetAllVector128((ushort)0x0004U);
            Vector128<ushort> updateMask = Sse2.CompareEqual(updateSelector opCookie);
            Vector128<ushort> newValues = Sse2.AddSaturate(values valuesIncrement);

            // Generate codegen issue
            values =
                Sse.StaticCast<byte ushort>(
                    Sse41.BlendVariable(
                        Sse.StaticCast<ushort byte>(values)
                        Sse.StaticCast<ushort byte>(newValues)
                        Sse.StaticCast<ushort byte>(updateMask)));

            Console.WriteLine(values);

With  my i5-750 CPU (Nehalem uarch) which does not support VEX encoding I've got the following asm code with .NET Core 2.1 RC1 JITter (look for the 

(Just checked with Haswell CPU - no major issues appear when VEX-encoded)","Sub-optimal codegen when using Sse.StaticCast<TFrom,TTo>() with non-VEX encoded HW intrinsics Below is the source code (basically this is an example of partial vector update code trimmed down for repro):

            // Setup constants
            Vector128<ushort> valuesIncrement = Sse2.SetAllVector128((ushort)0x0001U); // <== no. 1
            Vector128<ushort> opCookie = Sse.StaticCast<ulong ushort>( //<== no. 2
                Sse2.SetVector128(
                    0x0001_0002_0003_0004UL
                    0x0005_0006_0007_0008UL));

            // Setup initial condition
            Vector128<ushort> values = Sse2.SetVector128(
                (ushort)0x1111U (ushort)0x2222U (ushort)0x3333U (ushort)0x4444U
                (ushort)0x5555U (ushort)0x6666U (ushort)0x7777U (ushort)0x8888U);

            // Simulate op
            Vector128<ushort> updateSelector = Sse2.SetAllVector128((ushort)0x0004U);
            Vector128<ushort> updateMask = Sse2.CompareEqual(updateSelector opCookie);
            Vector128<ushort> newValues = Sse2.AddSaturate(values valuesIncrement);

            // Generate codegen issue
            values =
                Sse.StaticCast<byte ushort>(
                    Sse41.BlendVariable(
                        Sse.StaticCast<ushort byte>(values)
                        Sse.StaticCast<ushort byte>(newValues)
                        Sse.StaticCast<ushort byte>(updateMask)));

            Console.WriteLine(values);

With  my i5-750 CPU (Nehalem uarch) which does not support VEX encoding I've got the following asm code with .NET Core 2.1 RC1 JITter (look for the 

(Just checked with Haswell CPU - no major issues appear when VEX-encoded)",area-CodeGen,mikedn,22/05/2018 1:31,12/07/2018 13:36
18068,Excess MOVAPS on some non-VEX encoded SSE HW intrinsics having the same 1st and 2nd operand,"Codegen for some HW intrinsics on pre-AVX CPU provides result which is obviously too verbose.
Here is sample code:

                Vector128<ulong> vU64 = Sse2.ConvertScalarToVector128UInt64(1UL);
                vU64 = Sse2.UnpackHigh(vU64 vU64);
                Console.WriteLine(vU64);

Here is asm code generated on my i5-750 (Nehalem uarch):

> 000007FE650F5D20  mov         rsircx  
> 000007FE650F5D23  mov         ecx1  
> 000007FE650F5D28  movq        xmm6rcx  
>                 vU64 = Sse2.UnpackHigh(vU64 vU64);
> 000007FE650F5D2D  movaps      xmm0xmm6        ; <==========
> 000007FE650F5D30  punpckhqdq  xmm0xmm6     ; <==========
> 000007FE650F5D34  movaps      xmm6xmm0  
>                 Console.WriteLine(vU64);
> 000007FE650F5D37  mov         rcx7FE650E6750h  
> 000007FE650F5D41  call        000007FEC4BB1940  
> 000007FE650F5D46  mov         rcxrax  
> 000007FE650F5D49  movups      xmmword ptr [rcx+8]xmm6  
> 000007FE650F5D4D  call        000007FE650F2558

 generated - tested with i7-4790K (Haswell uarch w/ AVX & AVX2).

UPD: I'm using .NET Core 2.1 RC1

category:cq
theme:register-allocator
skill-level:intermediate
cost:small","Excess MOVAPS on some non-VEX encoded SSE HW intrinsics having the same 1st and 2nd operand Codegen for some HW intrinsics on pre-AVX CPU provides result which is obviously too verbose.
Here is sample code:

                Vector128<ulong> vU64 = Sse2.ConvertScalarToVector128UInt64(1UL);
                vU64 = Sse2.UnpackHigh(vU64 vU64);
                Console.WriteLine(vU64);

Here is asm code generated on my i5-750 (Nehalem uarch):

> 000007FE650F5D20  mov         rsircx  
> 000007FE650F5D23  mov         ecx1  
> 000007FE650F5D28  movq        xmm6rcx  
>                 vU64 = Sse2.UnpackHigh(vU64 vU64);
> 000007FE650F5D2D  movaps      xmm0xmm6        ; <==========
> 000007FE650F5D30  punpckhqdq  xmm0xmm6     ; <==========
> 000007FE650F5D34  movaps      xmm6xmm0  
>                 Console.WriteLine(vU64);
> 000007FE650F5D37  mov         rcx7FE650E6750h  
> 000007FE650F5D41  call        000007FEC4BB1940  
> 000007FE650F5D46  mov         rcxrax  
> 000007FE650F5D49  movups      xmmword ptr [rcx+8]xmm6  
> 000007FE650F5D4D  call        000007FE650F2558

 generated - tested with i7-4790K (Haswell uarch w/ AVX & AVX2).

UPD: I'm using .NET Core 2.1 RC1

category:cq
theme:register-allocator
skill-level:intermediate
cost:small",area-CodeGen,CarolEidt,,
18067,On porting .NET Core to FreeBSD,"Hello

I'm working on a [project](https://wiki.freebsd.org/SummerOfCode2018Projects/PortingPowerShellPorting) with Google Summer of Code and FreeBSD to port the .NET Core runtime and SDK as well as PowerShell over to the FreeBSD platform. Right now I'm gathering information on how to build and put together the tooling and runtime since the components are pretty scattered around in different repositories.

I've started with CoreCLR and CoreFX to build a working runtime which I'm basing on the 2.1.0 RC1 release -- commit hash [ folder I tried executing a little HelloWorld.dll program I created and built elsewhere on my own built-from-source runtime and it complained about a missing Microsoft.NETCore.App.deps.json file. In what step should it get built and how do I build it?

cc @Petermarcu @jkotas 

I should mention this project is being mentored by @DragonSA (FreeBSD) and @davidchisnall (Microsoft Research and FreeBSD)","On porting .NET Core to FreeBSD Hello

I'm working on a [project](https://wiki.freebsd.org/SummerOfCode2018Projects/PortingPowerShellPorting) with Google Summer of Code and FreeBSD to port the .NET Core runtime and SDK as well as PowerShell over to the FreeBSD platform. Right now I'm gathering information on how to build and put together the tooling and runtime since the components are pretty scattered around in different repositories.

I've started with CoreCLR and CoreFX to build a working runtime which I'm basing on the 2.1.0 RC1 release -- commit hash [ folder I tried executing a little HelloWorld.dll program I created and built elsewhere on my own built-from-source runtime and it complained about a missing Microsoft.NETCore.App.deps.json file. In what step should it get built and how do I build it?

cc @Petermarcu @jkotas 

I should mention this project is being mentored by @DragonSA (FreeBSD) and @davidchisnall (Microsoft Research and FreeBSD)",area-PAL,bartonjs,,
18063,Fix ARM cast codegen,"ARM cast codegen is rather convoluted and sometimes does the wrong thing by applying  to the destination type even though this flag is only about the source type.

Fixes #18040","Fix ARM cast codegen ARM cast codegen is rather convoluted and sometimes does the wrong thing by applying  to the destination type even though this flag is only about the source type.

Fixes #18040",arch-arm32,mikedn,20/05/2018 0:38,7/06/2018 15:19
18060,Don't close the JIT func info file on shutdown,During shutdown there can be a race between closing/nulling  and a background thread trying to write to it after checking that it was not null. This was found with tiering enabled but it looks like it can happen normally with unlucky timing because background threads aren't torn down on the shutdown path after main exits.,Don't close the JIT func info file on shutdown During shutdown there can be a race between closing/nulling  and a background thread trying to write to it after checking that it was not null. This was found with tiering enabled but it looks like it can happen normally with unlucky timing because background threads aren't torn down on the shutdown path after main exits.,area-CodeGen,kouvel,,
18057,add repro for #18056 ,"Link #18056.

Note: if you change file names then it will change methods hashes and the bug stops to repro.","add repro for #18056  Link #18056.

Note: if you change file names then it will change methods hashes and the bug stops to repro.",area-CodeGen,sandreenko,19/05/2018 9:43,22/05/2018 14:08
18056,[RyuJit/STRESS_BB_PROFILE] flowgraph.cpp  noway_assert(blockPred->bbTraversalStamp == curTraversalStamp) fails,"1. .

Repro: #18057 

category:correctness
theme:testing
skill-level:intermediate
cost:medium","[RyuJit/STRESS_BB_PROFILE] flowgraph.cpp  noway_assert(blockPred->bbTraversalStamp == curTraversalStamp) fails 1. .

Repro: #18057 

category:correctness
theme:testing
skill-level:intermediate
cost:medium",JitStress,sandreenko,,
18055,[Release/2.1] Use sysconf(_SC_NPROCESSORS_ONLN) in PAL_GetLogicalCpuCountFromOS (#18053),"This is #18053 ifdef-d under  only as suggested in https://github.com/dotnet/coreclr/pull/18053#issuecomment-390349093

/cc @RussKeldorph @dotnet/arm32-contrib @dotnet/arm64-contrib ","[Release/2.1] Use sysconf(_SC_NPROCESSORS_ONLN) in PAL_GetLogicalCpuCountFromOS (#18053) This is #18053 ifdef-d under  only as suggested in https://github.com/dotnet/coreclr/pull/18053#issuecomment-390349093

/cc @RussKeldorph @dotnet/arm32-contrib @dotnet/arm64-contrib ",arch-arm32,RussKeldorph,19/05/2018 8:56,23/05/2018 3:06
18054,.NET Core console app hangs,"I have a simple ASP.NET Core app with a background service. This background service perform batch data loading. On my dev machine I log these executed SQL commands to the console with EF Core this is a lot of output.
Sometimes in the middle of a batch load the app hangs. Web server is not responding.
OS: Windows 10 Enterprise
.NET Core version 2.1 preview2

I took  dump of the app when it hung. Here is the interesting thread's stack:

Thread   8
Current frame: ntdll!NtWaitForSingleObject + 0x14
Child-SP         RetAddr          Caller Callee
000000554eb3ee90 00007ff97c3e3b7f KERNELBASE!WaitForSingleObjectEx + 0x9f calling ntdll!NtWaitForSingleObject
000000554eb3eea0 00007ff93e320f3b coreclr!Thread::DoAppropriateWaitWorker + 0x2c3 [e:\a\_work\37\s\src\vm\threads.cpp:3780] calling coreclr!ThreadStateNCStackHolder::~ThreadStateNCStackHolder [e:\a\_work\37\s\src\vm\threads.h:7442]
000000554eb3eec0 00007ff93e3bf756 coreclr!EnterMonitorForRestore + 0x5e [e:\a\_work\37\s\src\vm\threads.cpp:4166] calling coreclr!CLRException::HandlerState::CleanupTry [e:\a\_work\37\s\src\vm\clrex.cpp:901]
000000554eb3ef30 00007ff93e37b530 coreclr!CLREventWaitHelper + 0x20 [e:\a\_work\37\s\src\vm\synch.cpp:411] calling kernel32!WaitForSingleObjectEx
000000554eb3ef90 00007ff93e5fb6dd coreclr!SVR::GCHeap::WaitUntilGCComplete + 0x3d [e:\a\_work\37\s\src\gc\gcee.cpp:402] calling coreclr!CLREventBase::WaitEx [e:\a\_work\37\s\src\vm\synch.cpp:431]
000000554eb3efc0 00007ff93e31f74d coreclr!Thread::RareDisablePreemptiveGC + 0x145 [e:\a\_work\37\s\src\vm\threadsuspend.cpp:3065]
000000554eb3f010 00007ff93e3c78e8 coreclr!JIT_RareDisableHelperWorker + 0x68 [e:\a\_work\37\s\src\vm\jithelpers.cpp:5560] calling coreclr!Thread::RareDisablePreemptiveGC [e:\a\_work\37\s\src\vm\threadsuspend.cpp:2981]
000000554eb3f070 00007ff97c42840a KERNELBASE!WideCharToMultiByte + 0x3ca calling KERNELBASE!GetMBNoDefault
000000554eb3f0b0 00007ff97c3febd9 KERNELBASE!ConsoleCallServerGeneric + 0x119 calling KERNELBASE!_security_check_cookie
000000554eb3f110 00007ff8df304b8b (MethodDesc 00007ff8df419f38 + 0xab DomainBoundILStubClass.IL_STUB_PInvoke(UInt32 UInt32 Char* Int32 Byte* Int32 IntPtr IntPtr))
000000554eb3f120 00007ff97fd516d0 ntdll!RtlSetLastWin32Error + 0x40 calling ntdll!_security_check_cookie
000000554eb3f130 00007ff97c412a3a KERNELBASE!WriteFile + 0x7a calling ntdll!NtWriteFile
000000554eb3f160 00007ff93e3cec54 coreclr!JIT_RareDisableHelper + 0x14 [E:\A\_work\37\s\src\vm\amd64\AsmHelpers.asm:234] calling coreclr!JIT_RareDisableHelperWorker [e:\a\_work\37\s\src\vm\jithelpers.cpp:5523]
000000554eb3f1a0 00007ff8df303fff (MethodDesc 00007ff8df4186d8 + 0xbf DomainBoundILStubClass.IL_STUB_PInvoke(IntPtr Byte* Int32 Int32 ByRef IntPtr))
000000554eb3f200 00007ff8df303fdf (MethodDesc 00007ff8df4186d8 + 0x9f DomainBoundILStubClass.IL_STUB_PInvoke(IntPtr Byte* Int32 Int32 ByRef IntPtr))
000000554eb3f260 00007ff9581391b8 (MethodDesc 00007ff8df418520 + 0x68 System.ConsolePal+WindowsConsoleStream.WriteFileNative(IntPtr Byte[] Int32 Int32 Boolean)) calling 00007ff8df303238 (stub for Interop+Kernel32.WriteFile(IntPtr Byte* Int32 Int32 ByRef IntPtr))
000000554eb3f270 00007ff97c445274 KERNELBASE!SetConsoleTextAttribute + 0x24 calling KERNELBASE!ConsoleCallServer
000000554eb3f2c0 00007ff958138f59 (MethodDesc 00007ff8df418500 + 0x49 System.ConsolePal+WindowsConsoleStream.Write(Byte[] Int32 Int32)) calling (MethodDesc 00007ff8df418520 + 0 System.ConsolePal+WindowsConsoleStream.WriteFileNative(IntPtr Byte[] Int32 Int32 Boolean))
000000554eb3f310 00007ff93de6b600 (MethodDesc 00007ff93d7ed5e8 + 0xe0 System.IO.StreamWriter.Flush(Boolean Boolean))
000000554eb3f390 00007ff93de6bed9 (MethodDesc 00007ff93d7ed668 + 0xf9 System.IO.StreamWriter.Write(System.String)) calling (MethodDesc 00007ff93d7ed5e8 + 0 System.IO.StreamWriter.Flush(Boolean Boolean))
000000554eb3f400 00007ff95813e4f0 (MethodDesc 00007ff8df419b30 + 0x50 System.IO.SyncTextWriter.Write(System.String)) calling 00007ff8de7ed300
000000554eb3f420 00007ff9581345fb (MethodDesc 00007ff8df415fb0 + 0xb System.Console.ResetColor()) calling (MethodDesc 00007ff8df4167e0 + 0 System.ConsolePal.ResetColor())
000000554eb3f450 00007ff93bcca77d (MethodDesc 00007ff8deb0b7b0 + 0x3d Microsoft.Extensions.Logging.Console.Internal.WindowsLogConsole.Write(System.String System.Nullable1<System.ConsoleColor>)) calling 00007ff8de7ed340
000000554eb3f480 00007ff93bcca4ad (MethodDesc 00007ff8deafba48 + 0x4d Microsoft.Extensions.Logging.Console.Internal.ConsoleLoggerProcessor.WriteMessage(Microsoft.Extensions.Logging.Console.Internal.LogMessageEntry)) calling 00007ff8de7ed320
000000554eb3f4c0 00007ff93bcca58b (MethodDesc 00007ff8deafba50 + 0xbb Microsoft.Extensions.Logging.Console.Internal.ConsoleLoggerProcessor.ProcessLogQueue()) calling 00007ff8de7ed880
000000554eb3f560 00007ff963236fc0 (MethodDesc 00007ff8deaff048 + 0x40 System.Threading.Thread.ThreadMain_ThreadStart())
000000554eb3f590 00007ff93dc5a4f9 (MethodDesc 00007ff93d7b1d28 + 0x89 System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext System.Threading.ContextCallback System.Object))
000000554eb3f610 00007ff93e3cfa83 coreclr!CallDescrWorkerInternal + 0x83 [E:\A\_work\37\s\src\vm\amd64\CallDescrWorkerAMD64.asm:101]
000000554eb3f628 00007ff93e31733e coreclr!MethodDesc::GetSingleCallableAddrOfVirtualizedCode + 0x92 [e:\a\_work\37\s\src\vm\method.cpp:2010] calling coreclr!MethodTable::GetRestoredSlot [e:\a\_work\37\s\src\vm\methodtable.cpp:9650]
000000554eb3f650 00007ff93e335a39 coreclr!MethodDescCallSite::CallTargetWorker + 0x2b5 [e:\a\_work\37\s\src\vm\callhelpers.cpp:628] calling coreclr!CallDescrWorkerInternal [E:\A\_work\37\s\src\vm\amd64\CallDescrWorkerAMD64.asm:38]
000000554eb3f680 00007ff93e332b0b coreclr!GCToCLREventSink::FirePrvDestroyGCHandle + 0x6b [e:\a\_work\37\s\src\vm\gctoclreventsink.cpp:329] calling coreclr!__security_check_cookie
000000554eb3f6d0 00007ff93e31733e coreclr!MethodDesc::GetSingleCallableAddrOfVirtualizedCode + 0x92 [e:\a\_work\37\s\src\vm\method.cpp:2010] calling coreclr!MethodTable::GetRestoredSlot [e:\a\_work\37\s\src\vm\methodtable.cpp:9650]
000000554eb3f7a0 00007ff93e3a1283 coreclr!ThreadNative::KickOffThread_Worker + 0x143 [e:\a\_work\37\s\src\vm\comsynchronizable.cpp:260] calling coreclr!MethodDescCallSite::CallTargetWorker [e:\a\_work\37\s\src\vm\callhelpers.cpp:333]
000000554eb3f7d0 00007ff97ed99f67 combase!CoVrfNotifyCoInit + 0xf [onecore\com\combase\verifier\threadstate.cxx:490] calling combase!ComVerifierSettings::VerifyThreadStateEnabled [onecore\com\combase\inc\verify.hxx:208]
000000554eb3f830 00007ff97fd4fa44 ntdll!LdrpDropLastInProgressCount + 0x38 calling ntdll!RtlLeaveCriticalSection
000000554eb3f900 00007ff97ed98df6 combase!CoInitializeEx + 0x36 [onecore\com\combase\class\compobj.cxx:3905] calling combase!_CoInitializeEx [onecore\com\combase\class\compobj.cxx:3668]
000000554eb3f910 00007ff93e334ba2 coreclr!ManagedThreadBase_DispatchInner + 0x5a [e:\a\_work\37\s\src\vm\threads.cpp:8852]
000000554eb3f950 00007ff93e3349fe coreclr!ManagedThreadBase_DispatchMiddle + 0x76 [e:\a\_work\37\s\src\vm\threads.cpp:8901] calling coreclr!ManagedThreadBase_DispatchInner [e:\a\_work\37\s\src\vm\threads.cpp:8808]
000000554eb3f960 00007ff93e2d7549 coreclr!EEHeapAllocInProcessHeap + 0x29 [e:\a\_work\37\s\src\vm\hosting.cpp:463] calling ntdll!RtlAllocateHeap
000000554eb3f970 00007ff93e3a8e81 coreclr!ClrFlsIncrementValue + 0x29 [e:\a\_work\37\s\src\inc\clrhost.h:99]
000000554eb3fa50 00007ff93e3348fd coreclr!ManagedThreadBase_DispatchOuter + 0x91 [e:\a\_work\37\s\src\vm\threads.cpp:9140] calling coreclr!ManagedThreadBase_DispatchMiddle [e:\a\_work\37\s\src\vm\threads.cpp:8855]
000000554eb3fac0 00007ff93e3c8573 coreclr!ManagedThreadBase_FullTransitionWithAD + 0x2f [e:\a\_work\37\s\src\vm\threads.cpp:9200] calling coreclr!ManagedThreadBase_DispatchOuter [e:\a\_work\37\s\src\vm\threads.cpp:9092]
000000554eb3fb20 00007ff93e38568a coreclr!ThreadNative::KickOffThread + 0x10a [e:\a\_work\37\s\src\vm\comsynchronizable.cpp:380] calling coreclr!ManagedThreadBase_FullTransitionWithAD [e:\a\_work\37\s\src\vm\threads.cpp:9189]
000000554eb3fc00 00007ff93e385558 coreclr!Thread::intermediateThreadProc + 0x88 [e:\a\_work\37\s\src\vm\threads.cpp:2255]
000000554eb3fe80 00007ff93e385533 coreclr!Thread::intermediateThreadProc + 0x63 [e:\a\_work\37\s\src\vm\threads.cpp:2250] calling coreclr!__chkstk
000000554eb3fec0 00007ff97f6e1fe4 kernel32!BaseThreadInitThunk + 0x14 calling ntdll!LdrpDispatchUserCallTarget
000000554eb3fef0 00007ff97fd7f061 ntdll!RtlUserThreadStart + 0x21 calling ntdll!LdrpDispatchUserCallTarget

Is this a known issue?

",".NET Core console app hangs I have a simple ASP.NET Core app with a background service. This background service perform batch data loading. On my dev machine I log these executed SQL commands to the console with EF Core this is a lot of output.
Sometimes in the middle of a batch load the app hangs. Web server is not responding.
OS: Windows 10 Enterprise
.NET Core version 2.1 preview2

I took  dump of the app when it hung. Here is the interesting thread's stack:

Thread   8
Current frame: ntdll!NtWaitForSingleObject + 0x14
Child-SP         RetAddr          Caller Callee
000000554eb3ee90 00007ff97c3e3b7f KERNELBASE!WaitForSingleObjectEx + 0x9f calling ntdll!NtWaitForSingleObject
000000554eb3eea0 00007ff93e320f3b coreclr!Thread::DoAppropriateWaitWorker + 0x2c3 [e:\a\_work\37\s\src\vm\threads.cpp:3780] calling coreclr!ThreadStateNCStackHolder::~ThreadStateNCStackHolder [e:\a\_work\37\s\src\vm\threads.h:7442]
000000554eb3eec0 00007ff93e3bf756 coreclr!EnterMonitorForRestore + 0x5e [e:\a\_work\37\s\src\vm\threads.cpp:4166] calling coreclr!CLRException::HandlerState::CleanupTry [e:\a\_work\37\s\src\vm\clrex.cpp:901]
000000554eb3ef30 00007ff93e37b530 coreclr!CLREventWaitHelper + 0x20 [e:\a\_work\37\s\src\vm\synch.cpp:411] calling kernel32!WaitForSingleObjectEx
000000554eb3ef90 00007ff93e5fb6dd coreclr!SVR::GCHeap::WaitUntilGCComplete + 0x3d [e:\a\_work\37\s\src\gc\gcee.cpp:402] calling coreclr!CLREventBase::WaitEx [e:\a\_work\37\s\src\vm\synch.cpp:431]
000000554eb3efc0 00007ff93e31f74d coreclr!Thread::RareDisablePreemptiveGC + 0x145 [e:\a\_work\37\s\src\vm\threadsuspend.cpp:3065]
000000554eb3f010 00007ff93e3c78e8 coreclr!JIT_RareDisableHelperWorker + 0x68 [e:\a\_work\37\s\src\vm\jithelpers.cpp:5560] calling coreclr!Thread::RareDisablePreemptiveGC [e:\a\_work\37\s\src\vm\threadsuspend.cpp:2981]
000000554eb3f070 00007ff97c42840a KERNELBASE!WideCharToMultiByte + 0x3ca calling KERNELBASE!GetMBNoDefault
000000554eb3f0b0 00007ff97c3febd9 KERNELBASE!ConsoleCallServerGeneric + 0x119 calling KERNELBASE!_security_check_cookie
000000554eb3f110 00007ff8df304b8b (MethodDesc 00007ff8df419f38 + 0xab DomainBoundILStubClass.IL_STUB_PInvoke(UInt32 UInt32 Char* Int32 Byte* Int32 IntPtr IntPtr))
000000554eb3f120 00007ff97fd516d0 ntdll!RtlSetLastWin32Error + 0x40 calling ntdll!_security_check_cookie
000000554eb3f130 00007ff97c412a3a KERNELBASE!WriteFile + 0x7a calling ntdll!NtWriteFile
000000554eb3f160 00007ff93e3cec54 coreclr!JIT_RareDisableHelper + 0x14 [E:\A\_work\37\s\src\vm\amd64\AsmHelpers.asm:234] calling coreclr!JIT_RareDisableHelperWorker [e:\a\_work\37\s\src\vm\jithelpers.cpp:5523]
000000554eb3f1a0 00007ff8df303fff (MethodDesc 00007ff8df4186d8 + 0xbf DomainBoundILStubClass.IL_STUB_PInvoke(IntPtr Byte* Int32 Int32 ByRef IntPtr))
000000554eb3f200 00007ff8df303fdf (MethodDesc 00007ff8df4186d8 + 0x9f DomainBoundILStubClass.IL_STUB_PInvoke(IntPtr Byte* Int32 Int32 ByRef IntPtr))
000000554eb3f260 00007ff9581391b8 (MethodDesc 00007ff8df418520 + 0x68 System.ConsolePal+WindowsConsoleStream.WriteFileNative(IntPtr Byte[] Int32 Int32 Boolean)) calling 00007ff8df303238 (stub for Interop+Kernel32.WriteFile(IntPtr Byte* Int32 Int32 ByRef IntPtr))
000000554eb3f270 00007ff97c445274 KERNELBASE!SetConsoleTextAttribute + 0x24 calling KERNELBASE!ConsoleCallServer
000000554eb3f2c0 00007ff958138f59 (MethodDesc 00007ff8df418500 + 0x49 System.ConsolePal+WindowsConsoleStream.Write(Byte[] Int32 Int32)) calling (MethodDesc 00007ff8df418520 + 0 System.ConsolePal+WindowsConsoleStream.WriteFileNative(IntPtr Byte[] Int32 Int32 Boolean))
000000554eb3f310 00007ff93de6b600 (MethodDesc 00007ff93d7ed5e8 + 0xe0 System.IO.StreamWriter.Flush(Boolean Boolean))
000000554eb3f390 00007ff93de6bed9 (MethodDesc 00007ff93d7ed668 + 0xf9 System.IO.StreamWriter.Write(System.String)) calling (MethodDesc 00007ff93d7ed5e8 + 0 System.IO.StreamWriter.Flush(Boolean Boolean))
000000554eb3f400 00007ff95813e4f0 (MethodDesc 00007ff8df419b30 + 0x50 System.IO.SyncTextWriter.Write(System.String)) calling 00007ff8de7ed300
000000554eb3f420 00007ff9581345fb (MethodDesc 00007ff8df415fb0 + 0xb System.Console.ResetColor()) calling (MethodDesc 00007ff8df4167e0 + 0 System.ConsolePal.ResetColor())
000000554eb3f450 00007ff93bcca77d (MethodDesc 00007ff8deb0b7b0 + 0x3d Microsoft.Extensions.Logging.Console.Internal.WindowsLogConsole.Write(System.String System.Nullable1<System.ConsoleColor>)) calling 00007ff8de7ed340
000000554eb3f480 00007ff93bcca4ad (MethodDesc 00007ff8deafba48 + 0x4d Microsoft.Extensions.Logging.Console.Internal.ConsoleLoggerProcessor.WriteMessage(Microsoft.Extensions.Logging.Console.Internal.LogMessageEntry)) calling 00007ff8de7ed320
000000554eb3f4c0 00007ff93bcca58b (MethodDesc 00007ff8deafba50 + 0xbb Microsoft.Extensions.Logging.Console.Internal.ConsoleLoggerProcessor.ProcessLogQueue()) calling 00007ff8de7ed880
000000554eb3f560 00007ff963236fc0 (MethodDesc 00007ff8deaff048 + 0x40 System.Threading.Thread.ThreadMain_ThreadStart())
000000554eb3f590 00007ff93dc5a4f9 (MethodDesc 00007ff93d7b1d28 + 0x89 System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext System.Threading.ContextCallback System.Object))
000000554eb3f610 00007ff93e3cfa83 coreclr!CallDescrWorkerInternal + 0x83 [E:\A\_work\37\s\src\vm\amd64\CallDescrWorkerAMD64.asm:101]
000000554eb3f628 00007ff93e31733e coreclr!MethodDesc::GetSingleCallableAddrOfVirtualizedCode + 0x92 [e:\a\_work\37\s\src\vm\method.cpp:2010] calling coreclr!MethodTable::GetRestoredSlot [e:\a\_work\37\s\src\vm\methodtable.cpp:9650]
000000554eb3f650 00007ff93e335a39 coreclr!MethodDescCallSite::CallTargetWorker + 0x2b5 [e:\a\_work\37\s\src\vm\callhelpers.cpp:628] calling coreclr!CallDescrWorkerInternal [E:\A\_work\37\s\src\vm\amd64\CallDescrWorkerAMD64.asm:38]
000000554eb3f680 00007ff93e332b0b coreclr!GCToCLREventSink::FirePrvDestroyGCHandle + 0x6b [e:\a\_work\37\s\src\vm\gctoclreventsink.cpp:329] calling coreclr!__security_check_cookie
000000554eb3f6d0 00007ff93e31733e coreclr!MethodDesc::GetSingleCallableAddrOfVirtualizedCode + 0x92 [e:\a\_work\37\s\src\vm\method.cpp:2010] calling coreclr!MethodTable::GetRestoredSlot [e:\a\_work\37\s\src\vm\methodtable.cpp:9650]
000000554eb3f7a0 00007ff93e3a1283 coreclr!ThreadNative::KickOffThread_Worker + 0x143 [e:\a\_work\37\s\src\vm\comsynchronizable.cpp:260] calling coreclr!MethodDescCallSite::CallTargetWorker [e:\a\_work\37\s\src\vm\callhelpers.cpp:333]
000000554eb3f7d0 00007ff97ed99f67 combase!CoVrfNotifyCoInit + 0xf [onecore\com\combase\verifier\threadstate.cxx:490] calling combase!ComVerifierSettings::VerifyThreadStateEnabled [onecore\com\combase\inc\verify.hxx:208]
000000554eb3f830 00007ff97fd4fa44 ntdll!LdrpDropLastInProgressCount + 0x38 calling ntdll!RtlLeaveCriticalSection
000000554eb3f900 00007ff97ed98df6 combase!CoInitializeEx + 0x36 [onecore\com\combase\class\compobj.cxx:3905] calling combase!_CoInitializeEx [onecore\com\combase\class\compobj.cxx:3668]
000000554eb3f910 00007ff93e334ba2 coreclr!ManagedThreadBase_DispatchInner + 0x5a [e:\a\_work\37\s\src\vm\threads.cpp:8852]
000000554eb3f950 00007ff93e3349fe coreclr!ManagedThreadBase_DispatchMiddle + 0x76 [e:\a\_work\37\s\src\vm\threads.cpp:8901] calling coreclr!ManagedThreadBase_DispatchInner [e:\a\_work\37\s\src\vm\threads.cpp:8808]
000000554eb3f960 00007ff93e2d7549 coreclr!EEHeapAllocInProcessHeap + 0x29 [e:\a\_work\37\s\src\vm\hosting.cpp:463] calling ntdll!RtlAllocateHeap
000000554eb3f970 00007ff93e3a8e81 coreclr!ClrFlsIncrementValue + 0x29 [e:\a\_work\37\s\src\inc\clrhost.h:99]
000000554eb3fa50 00007ff93e3348fd coreclr!ManagedThreadBase_DispatchOuter + 0x91 [e:\a\_work\37\s\src\vm\threads.cpp:9140] calling coreclr!ManagedThreadBase_DispatchMiddle [e:\a\_work\37\s\src\vm\threads.cpp:8855]
000000554eb3fac0 00007ff93e3c8573 coreclr!ManagedThreadBase_FullTransitionWithAD + 0x2f [e:\a\_work\37\s\src\vm\threads.cpp:9200] calling coreclr!ManagedThreadBase_DispatchOuter [e:\a\_work\37\s\src\vm\threads.cpp:9092]
000000554eb3fb20 00007ff93e38568a coreclr!ThreadNative::KickOffThread + 0x10a [e:\a\_work\37\s\src\vm\comsynchronizable.cpp:380] calling coreclr!ManagedThreadBase_FullTransitionWithAD [e:\a\_work\37\s\src\vm\threads.cpp:9189]
000000554eb3fc00 00007ff93e385558 coreclr!Thread::intermediateThreadProc + 0x88 [e:\a\_work\37\s\src\vm\threads.cpp:2255]
000000554eb3fe80 00007ff93e385533 coreclr!Thread::intermediateThreadProc + 0x63 [e:\a\_work\37\s\src\vm\threads.cpp:2250] calling coreclr!__chkstk
000000554eb3fec0 00007ff97f6e1fe4 kernel32!BaseThreadInitThunk + 0x14 calling ntdll!LdrpDispatchUserCallTarget
000000554eb3fef0 00007ff97fd7f061 ntdll!RtlUserThreadStart + 0x21 calling ntdll!LdrpDispatchUserCallTarget

Is this a known issue?

",area-GC,jkotas,19/05/2018 8:32,22/05/2018 23:01
18053,Use sysconf(_SC_NPROCESSORS_CONF) in PAL_GetLogicalCpuCountFromOS,As we found in #17851  and https://github.com/seanmonstar/num_cpus/issues/34 should be used instead.,Use sysconf(_SC_NPROCESSORS_CONF) in PAL_GetLogicalCpuCountFromOS As we found in #17851  and https://github.com/seanmonstar/num_cpus/issues/34 should be used instead.,arch-arm32,echesakovMSFT,19/05/2018 8:12,25/05/2018 6:57
18052,[Arm64] jitStressRegs=3 failures,"The following tests fail with jitStressRegs=3 when run on x64/windows using the arm64 altjit:

CoreMangLib\cti\system\mathf\MathFSign\MathFSign.cmd
JIT\Generics\Locals\static_assignment_class01\static_assignment_class01.cmd
JIT\Generics\Constraints\convert_static01\convert_static01.cmd
JIT\IL_Conformance\Old\Conformance_Base\add_ovf_u2\add_ovf_u2.cmd
JIT\jit64\opt\regress\vswhidbey\481244\foo_opt\foo_opt.cmd

Note that this test leg was last run in the CI system on 16 Feb.","[Arm64] jitStressRegs=3 failures The following tests fail with jitStressRegs=3 when run on x64/windows using the arm64 altjit:

CoreMangLib\cti\system\mathf\MathFSign\MathFSign.cmd
JIT\Generics\Locals\static_assignment_class01\static_assignment_class01.cmd
JIT\Generics\Constraints\convert_static01\convert_static01.cmd
JIT\IL_Conformance\Old\Conformance_Base\add_ovf_u2\add_ovf_u2.cmd
JIT\jit64\opt\regress\vswhidbey\481244\foo_opt\foo_opt.cmd

Note that this test leg was last run in the CI system on 16 Feb.",JitStress,CarolEidt,19/05/2018 8:09,19/05/2018 23:47
18051,Mirror changes from dotnet/corert,"This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**","Mirror changes from dotnet/corert This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**",,jkotas,,
18049,Move InsufficientMemory OutOfMemory and ThreadInterrupted exceptions,"Moving InsufficientMemoryException OutOfMemoryException and ThreadInterruptedException to shared

The diff shows the difference between the coreclr and corert files.

GetMessageFromNativeResources() is available in Exception.cs. Click [here](https://github.com/dotnet/coreclr/blame/85374ceaed177f71472cc4c23c69daf7402e5048/src/System.Private.CoreLib/src/System/Exception.cs#L731-L757) to view:



cc: @jkotas @danmosemsft should I instead keep using the GetMessageFromNativeResources() (shown above) as I move these exception classes to shared?

Related to: dotnet/coreclr#17904","Move InsufficientMemory, OutOfMemory and ThreadInterrupted exceptions Moving InsufficientMemoryException OutOfMemoryException and ThreadInterruptedException to shared

The diff shows the difference between the coreclr and corert files.

GetMessageFromNativeResources() is available in Exception.cs. Click [here](https://github.com/dotnet/coreclr/blame/85374ceaed177f71472cc4c23c69daf7402e5048/src/System.Private.CoreLib/src/System/Exception.cs#L731-L757) to view:



cc: @jkotas @danmosemsft should I instead keep using the GetMessageFromNativeResources() (shown above) as I move these exception classes to shared?

Related to: dotnet/coreclr#17904",,maryamariyan,,
18048,[arm64/Windows] Build using public SDK,"Arm64/Windows is currently built in the CI (and locally) using a private Microsoft SDK. With Windows 10 SDK 10.0.17134.0 (shipped with VS 2017 15.7.1) I believe all required arm64 files are public. Also Visual Studio has (since 15.4?) public arm64 Windows compilers. And recent cmake versions supposedly support these new tools.

Thus we should change the build infrastructure including CI and official builds to build arm64/Windows with all public tools and stop using the private toolset.
","[arm64/Windows] Build using public SDK Arm64/Windows is currently built in the CI (and locally) using a private Microsoft SDK. With Windows 10 SDK 10.0.17134.0 (shipped with VS 2017 15.7.1) I believe all required arm64 files are public. Also Visual Studio has (since 15.4?) public arm64 Windows compilers. And recent cmake versions supposedly support these new tools.

Thus we should change the build infrastructure including CI and official builds to build arm64/Windows with all public tools and stop using the private toolset.
",arch-arm64,BruceForstall,,
18047,[Arm64/Linux] Intermittent thread failures,"There are occasional intermittent failures in thread related tests.

In an effort to fix #18026 it seems worthwhile to track and investigate these.
","[Arm64/Linux] Intermittent thread failures There are occasional intermittent failures in thread related tests.

In an effort to fix #18026 it seems worthwhile to track and investigate these.
",area-System.Threading,kouvel,19/05/2018 4:24,
18045,Intel Hardware Intrinsics test framework design deficiences,"A while ago we have had a long discussion about the scope of testing which should be done during Intel Hardware Intrinsics development (for details see https://github.com/dotnet/coreclr/pull/15771).

There were two proposals put forward:
1. Test as little as possible concentrating on a check if expected assembly instruction is emitted;
2. Test for wider range of values including known problematic ones

Currently we use approach from point 1 which IMO opinion is deficient since it led to several missed implementation bugs i.e.:

https://github.com/dotnet/coreclr/issues/17957
https://github.com/dotnet/coreclr/issues/18039
https://github.com/dotnet/coreclr/issues/18041
https://github.com/dotnet/coreclr/issues/18043

It seems that using small set of problematic values for each numeric type would solve that problem without need for creating complex test scenarios i.e.:

1) for integral types: min max -1 0 1
2) for unsigned integral types: min max 1
3) for floating types: +/- infinity +/- max/min +/- 0 subnormal

@AndyAyersMS  @CarolEidt @fiigii @sdmaclea @tannergooding

category:testing
theme:intrinsics
skill-level:intermediate
cost:small
","Intel Hardware Intrinsics test framework design deficiences A while ago we have had a long discussion about the scope of testing which should be done during Intel Hardware Intrinsics development (for details see https://github.com/dotnet/coreclr/pull/15771).

There were two proposals put forward:
1. Test as little as possible concentrating on a check if expected assembly instruction is emitted;
2. Test for wider range of values including known problematic ones

Currently we use approach from point 1 which IMO opinion is deficient since it led to several missed implementation bugs i.e.:

https://github.com/dotnet/coreclr/issues/17957
https://github.com/dotnet/coreclr/issues/18039
https://github.com/dotnet/coreclr/issues/18041
https://github.com/dotnet/coreclr/issues/18043

It seems that using small set of problematic values for each numeric type would solve that problem without need for creating complex test scenarios i.e.:

1) for integral types: min max -1 0 1
2) for unsigned integral types: min max 1
3) for floating types: +/- infinity +/- max/min +/- 0 subnormal

@AndyAyersMS  @CarolEidt @fiigii @sdmaclea @tannergooding

category:testing
theme:intrinsics
skill-level:intermediate
cost:small
",area-CodeGen,AndyAyersMS,19/05/2018 2:29,
18044,.NET Core application running in docker gets OOMKilled if swapping is disabled,"We are running .NET Core applications inside docker containers on a kubernetes cluster. Docker containers get OOMKilled because GC is not executed.

To test this we created a test program which allocates arrays in a loop. These arrays should get deleted by the GC. The program is executed in a docker container with 100Mb memory limit. Kubernetes is not involved in the tests.

When running the test with **swap enabled** everything works as expected and the GC gets triggered when the total memory reaches 100Mb. The test never gets killed.

When running the test with **swap disabled** the test gets OOMKilled when the total memory reaches 100Mb. We have tested this behaviour with ServerGC=true|false and with .NET Core 2.0 and 2.1

Enabling swap is not an option cause it's neither recommended nor supported by Kubernetes.

# Code
you can find out test program here: https://github.com/devKlausS/dotnet_mem_allocator
      
    var rand = new Random();
    List<byte[]> m_arrays = new List<byte[]>();
    
    int iLoop = 0;
    while (true)
    {
        var array = new byte[iAllocBytes];
        var value = (byte)rand.Next();
        Parallel.ForEach(array (item) =>
        {
            item = value;
        });
        rand.NextBytes(array);
    
        if(!bFree)
            m_arrays.Add(array);
    
        if(iCollect > 0 && iLoop % iCollect == 0)
        {
            Console.WriteLine(""run GC"");
            GC.Collect();
        }
    
        Console.Write(""AllocatedBytesForCurrentThread: "" + GC.GetAllocatedBytesForCurrentThread() / 1000000 + ""Mb "" +
            ""TotalMemory: "" + GC.GetTotalMemory(bForceFullCollection) / 1000000 + ""Mb "");
    
        for(int i = 0; i < GC.MaxGeneration; i++)
        {
            Console.Write(""CollectionCount(""+i+""): "" + GC.CollectionCount(i) + "" "");
        }
    
        Console.WriteLine("""");
    
        Thread.Sleep(iSleepMs);
        iLoop++;
    }
# Docker images 

### ServerGC=false alloc/free .NET CORE 2.0
    docker run -ti -m 100M schaefferlinkbit/dotnet_mem_allocator:1.0.3895_20_client_GC /alloc_mb=20 /free=false
### ServerGC=true alloc/free .NET CORE 2.0
    docker run -ti -m 100M schaefferlinkbit/dotnet_mem_allocator:1.0.3895_20_server_GC /alloc_mb=20
### ServerGC=false alloc/free .NET CORE 2.1
    docker run -ti -m 100M schaefferlinkbit/dotnet_mem_allocator:1.0.3895_21_client_GC /alloc_mb=20 /free=false
### ServerGC=true alloc/free .NET CORE 2.1
    docker run -ti -m 100M schaefferlinkbit/dotnet_mem_allocator:1.0.3895_21_server_GC /alloc_mb=20

# cgroup limits
After reading multiple issues according to .NET Core GC and docker limits we started to dig into the cgroup limits. We compiled https://github.com/dotnet/coreclr/blob/master/src/gc/unix/cgroup.cpp and executed the program inside the docker container. As shown in the following screenshot the the path of the memory.limit_in_bytes file is pointing to the directory of the host machine and the file open operation fails.
![screenshot from 2018-05-18 11-27-29](https://user-images.githubusercontent.com/13675575/40230729-f77807ba-5a98-11e8-9740-7da4217a4777.png)
The next screenshot shows the volume mounts of the container. The host machine path is mounted to /sys/fs/memory inside the container. When reading memory.limit_in_bytes we see ~300MB (we pass -m 300M to the docker container)
![screenshot from 2018-05-18 11-27-40](https://user-images.githubusercontent.com/13675575/40230855-64052d4a-5a99-11e8-854f-c5751ab2f56b.png)

It seems like CLR is not able to read the physical memory limits from cgroup and therefore the GC is not triggered correctly. As a result the process is killed because of OOM. We guess that CLR is triggering GC when it has to do swapping and this is the reason why our process is not killed when swapping is enabled.
",".NET Core application running in docker gets OOMKilled if swapping is disabled We are running .NET Core applications inside docker containers on a kubernetes cluster. Docker containers get OOMKilled because GC is not executed.

To test this we created a test program which allocates arrays in a loop. These arrays should get deleted by the GC. The program is executed in a docker container with 100Mb memory limit. Kubernetes is not involved in the tests.

When running the test with **swap enabled** everything works as expected and the GC gets triggered when the total memory reaches 100Mb. The test never gets killed.

When running the test with **swap disabled** the test gets OOMKilled when the total memory reaches 100Mb. We have tested this behaviour with ServerGC=true|false and with .NET Core 2.0 and 2.1

Enabling swap is not an option cause it's neither recommended nor supported by Kubernetes.

# Code
you can find out test program here: https://github.com/devKlausS/dotnet_mem_allocator
      
    var rand = new Random();
    List<byte[]> m_arrays = new List<byte[]>();
    
    int iLoop = 0;
    while (true)
    {
        var array = new byte[iAllocBytes];
        var value = (byte)rand.Next();
        Parallel.ForEach(array (item) =>
        {
            item = value;
        });
        rand.NextBytes(array);
    
        if(!bFree)
            m_arrays.Add(array);
    
        if(iCollect > 0 && iLoop % iCollect == 0)
        {
            Console.WriteLine(""run GC"");
            GC.Collect();
        }
    
        Console.Write(""AllocatedBytesForCurrentThread: "" + GC.GetAllocatedBytesForCurrentThread() / 1000000 + ""Mb "" +
            ""TotalMemory: "" + GC.GetTotalMemory(bForceFullCollection) / 1000000 + ""Mb "");
    
        for(int i = 0; i < GC.MaxGeneration; i++)
        {
            Console.Write(""CollectionCount(""+i+""): "" + GC.CollectionCount(i) + "" "");
        }
    
        Console.WriteLine("""");
    
        Thread.Sleep(iSleepMs);
        iLoop++;
    }
# Docker images 

### ServerGC=false alloc/free .NET CORE 2.0
    docker run -ti -m 100M schaefferlinkbit/dotnet_mem_allocator:1.0.3895_20_client_GC /alloc_mb=20 /free=false
### ServerGC=true alloc/free .NET CORE 2.0
    docker run -ti -m 100M schaefferlinkbit/dotnet_mem_allocator:1.0.3895_20_server_GC /alloc_mb=20
### ServerGC=false alloc/free .NET CORE 2.1
    docker run -ti -m 100M schaefferlinkbit/dotnet_mem_allocator:1.0.3895_21_client_GC /alloc_mb=20 /free=false
### ServerGC=true alloc/free .NET CORE 2.1
    docker run -ti -m 100M schaefferlinkbit/dotnet_mem_allocator:1.0.3895_21_server_GC /alloc_mb=20

# cgroup limits
After reading multiple issues according to .NET Core GC and docker limits we started to dig into the cgroup limits. We compiled https://github.com/dotnet/coreclr/blob/master/src/gc/unix/cgroup.cpp and executed the program inside the docker container. As shown in the following screenshot the the path of the memory.limit_in_bytes file is pointing to the directory of the host machine and the file open operation fails.
![screenshot from 2018-05-18 11-27-29](https://user-images.githubusercontent.com/13675575/40230729-f77807ba-5a98-11e8-9740-7da4217a4777.png)
The next screenshot shows the volume mounts of the container. The host machine path is mounted to /sys/fs/memory inside the container. When reading memory.limit_in_bytes we see ~300MB (we pass -m 300M to the docker container)
![screenshot from 2018-05-18 11-27-40](https://user-images.githubusercontent.com/13675575/40230855-64052d4a-5a99-11e8-854f-c5751ab2f56b.png)

It seems like CLR is not able to read the physical memory limits from cgroup and therefore the GC is not triggered correctly. As a result the process is killed because of OOM. We guess that CLR is triggering GC when it has to do swapping and this is the reason why our process is not killed when swapping is enabled.
",area-GC,janvorli,,
18043,JIT: assert in test with call to Array<T>.IndexOf with Vector type,,"JIT: assert in test with call to Array<T>.IndexOf with Vector type 
",area-CodeGen,AndyAyersMS,18/05/2018 18:40,19/05/2018 6:00
18042,CoreCLR failed when build with MSVC on Windows,"Hello

I tried to build CoreCLR on Windows with VS2017 Update2. It failed to build due to the error CS2001: Source file 'D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\System.Private.CoreLib\..\eventing\DotNETRuntimeEventSource.cs' could not be found. This issue is caused by master branch revision [0fbd0f5](https://github.com/dotnet/coreclr/commit/0fbd0f535e566bcde591701adc2de51ee0f020af). Could you please help take a look at this? Thank you!

**You can repro this issue as the steps below:**
1. git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2. Open a clean x86 prompt (C:\windows\syswow64\cmd.exe) and browse to D:\CoreCLR\src
3. build x86 release -Rebuild -- /clp:ShowCommandLine

**Error info:**
CSC : error CS2001: Source file 'D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\System.Private.CoreLib\..\eventing\DotNETRuntimeEventSource.cs' could not be found. [D:\CoreCLR\src\src\System.Private.CoreLib\System.Private.CoreLib.csproj]","CoreCLR failed when build with MSVC on Windows Hello

I tried to build CoreCLR on Windows with VS2017 Update2. It failed to build due to the error CS2001: Source file 'D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\System.Private.CoreLib\..\eventing\DotNETRuntimeEventSource.cs' could not be found. This issue is caused by master branch revision [0fbd0f5](https://github.com/dotnet/coreclr/commit/0fbd0f535e566bcde591701adc2de51ee0f020af). Could you please help take a look at this? Thank you!

**You can repro this issue as the steps below:**
1. git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2. Open a clean x86 prompt (C:\windows\syswow64\cmd.exe) and browse to D:\CoreCLR\src
3. build x86 release -Rebuild -- /clp:ShowCommandLine

**Error info:**
CSC : error CS2001: Source file 'D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\System.Private.CoreLib\..\eventing\DotNETRuntimeEventSource.cs' could not be found. [D:\CoreCLR\src\src\System.Private.CoreLib\System.Private.CoreLib.csproj]",area-Infrastructure-coreclr,brianrob,,
18041,JIT: assert when jitting Sse2.ConvertToInt32WithTruncation,,JIT: assert when jitting Sse2.ConvertToInt32WithTruncation ,area-CodeGen,4creators,,
18040,Broken conv.ovf.i8.un decomposition,"IL sample:
 hides the issue since is sign extends again the byte previously loaded.

Found while adding tests for #12676. Test coverage for casts seems to be lacking I keep running into bugs (either existing or of my own doing) and existing tests fail to catch them so I generated some. This case failed on ARM32 but not on x86.","Broken conv.ovf.i8.un decomposition IL sample:
 hides the issue since is sign extends again the byte previously loaded.

Found while adding tests for #12676. Test coverage for casts seems to be lacking I keep running into bugs (either existing or of my own doing) and existing tests fail to catch them so I generated some. This case failed on ARM32 but not on x86.",area-CodeGen,AndyAyersMS,18/05/2018 16:37,7/06/2018 15:19
18039,JIT: assert when jitting Sse2.MoveScalar(Vector128<long>),,"JIT: assert when jitting Sse2.MoveScalar(Vector128<long>) 
",area-CodeGen,AndyAyersMS,18/05/2018 10:39,2/06/2018 9:57
18037,Extra stloc and ldloc in switch statement compared to if statement,"I noticed an extra stloc and ldloc in the following switch statement compared to the equivalent if statement (this is just a shortened version of a longer and nested statement).
The il and disassembly looks pretty much the same except for the 
</details>
category:cq
theme:basic-cq
skill-level:beginner
cost:small","Extra stloc and ldloc in switch statement compared to if statement I noticed an extra stloc and ldloc in the following switch statement compared to the equivalent if statement (this is just a shortened version of a longer and nested statement).
The il and disassembly looks pretty much the same except for the 
</details>
category:cq
theme:basic-cq
skill-level:beginner
cost:small",area-CodeGen,RussKeldorph,18/05/2018 8:12,
18034,[Arm64] System.Reflection.Emit.Tests.TypeBuilderIsGenericTypeDefinition.IsGenericTypeDefinition_GenericType_ReturnsTrue [FAIL],"This is a recent regression on tip.
         
","[Arm64] System.Reflection.Emit.Tests.TypeBuilderIsGenericTypeDefinition.IsGenericTypeDefinition_GenericType_ReturnsTrue [FAIL] This is a recent regression on tip.
         
",area-System.Reflection,,,
18033,JIT: examine need for canInlineTypeCheckWithObjectVTable,"When the jit is optimizing type equality and inequality tests it may run into the following case:
 to identify the cases where the optimization is valid.

https://github.com/dotnet/coreclr/blob/3c01252879f2d2223f63d5b222b6584c28fc07f4/src/jit/gentree.cpp#L13141-L13147

Per Jan's comments in #18005 it seems in CoreCLR this optimization is likely always valid and the check is no longer needed.

category:cq
theme:basic-cq
skill-level:intermediate
cost:small","JIT: examine need for canInlineTypeCheckWithObjectVTable When the jit is optimizing type equality and inequality tests it may run into the following case:
 to identify the cases where the optimization is valid.

https://github.com/dotnet/coreclr/blob/3c01252879f2d2223f63d5b222b6584c28fc07f4/src/jit/gentree.cpp#L13141-L13147

Per Jan's comments in #18005 it seems in CoreCLR this optimization is likely always valid and the check is no longer needed.

category:cq
theme:basic-cq
skill-level:intermediate
cost:small",area-CodeGen,AndyAyersMS,18/05/2018 3:50,
18031,[JIT/ARM] Fix Compiler::lvaFrameAddress,"Use sp-based offset only if r10 reserved or offset is lower than encoding limit.

Fixes https://github.com/dotnet/coreclr/issues/17882","[JIT/ARM] Fix Compiler::lvaFrameAddress Use sp-based offset only if r10 reserved or offset is lower than encoding limit.

Fixes https://github.com/dotnet/coreclr/issues/17882",area-CodeGen,alpencolt,18/05/2018 0:45,22/06/2018 1:57
18030,Possible Bug: Complete lock-up in ASP.NET Core startup due to StubHelpers?,"Hi all

This is potentially a difficult issue to track down. I have been developing with ASP.NET Core for a few months now and (very) rarely the application locks-up completely during start up. I am currently running version 2.1.101 but don't recall which version I was running when I first encountered this issue. The time between manifestations is measured in weeks. I assume this is some kind of unlucky race condition.

I captured this screenshot from the latest occurrence. The lock-up always occurs within WebHostBuilder.Build(). The rest of the stack trace might be variable because this is the first time I've had a proper look at it.

In this instance the code appears to be stuck in StubHelpers.AddToCleanupList (hence why I am posting this here). Resuming the application has no effect. We remain stuck in the same place. I need to restart the application to get past this point. 

![image](https://user-images.githubusercontent.com/16805881/40167385-cecbed26-59b8-11e8-8b6c-e57aef1681ac.png)","Possible Bug: Complete lock-up in ASP.NET Core startup due to StubHelpers? Hi all

This is potentially a difficult issue to track down. I have been developing with ASP.NET Core for a few months now and (very) rarely the application locks-up completely during start up. I am currently running version 2.1.101 but don't recall which version I was running when I first encountered this issue. The time between manifestations is measured in weeks. I assume this is some kind of unlucky race condition.

I captured this screenshot from the latest occurrence. The lock-up always occurs within WebHostBuilder.Build(). The rest of the stack trace might be variable because this is the first time I've had a proper look at it.

In this instance the code appears to be stuck in StubHelpers.AddToCleanupList (hence why I am posting this here). Resuming the application has no effect. We remain stuck in the same place. I need to restart the application to get past this point. 

![image](https://user-images.githubusercontent.com/16805881/40167385-cecbed26-59b8-11e8-8b6c-e57aef1681ac.png)",area-Diagnostics,cshung,,
18026,[Arm64/Linux] Stabilize SDK,"#17933 will be fixed by #17991 

Using a variant of the patch in #17991 I was able to bootstrap build a linux-arm64 cli/sdk based on 2.1.300-rtm-008820.  To check stability I tried to use it to build coreclr natively.



","[Arm64/Linux] Stabilize SDK #17933 will be fixed by #17991 

Using a variant of the patch in #17991 I was able to bootstrap build a linux-arm64 cli/sdk based on 2.1.300-rtm-008820.  To check stability I tried to use it to build coreclr natively.



",arch-arm64,kouvel,17/05/2018 6:50,
18025,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,stephentoub,,
18024,Making IProducerConsumerCollectionDebugView APIs public,"Moving ConcurrentQueue to shared

Applying code review feedbacks: 

1- Making IProducerConsumerCollectionDebugView apis public

2- Renaming 
- Segment to ConcurrentQueueSegment. 
- ProducerConsumerCollectionDebugView  to IProducerConsumerCollectionDebugView 

Fixes: #17751

cc: @jkotas @stephentoub @danmosemsft @safern ","Making IProducerConsumerCollectionDebugView APIs public Moving ConcurrentQueue to shared

Applying code review feedbacks: 

1- Making IProducerConsumerCollectionDebugView apis public

2- Renaming 
- Segment to ConcurrentQueueSegment. 
- ProducerConsumerCollectionDebugView  to IProducerConsumerCollectionDebugView 

Fixes: #17751

cc: @jkotas @stephentoub @danmosemsft @safern ",area-System.Collections,maryamariyan,,
18022,Suboptimal codegen when comparing sbyte and 16-bit values,"I have the following two repro methods along with their x64 codegen using the latest RyuJIT.


category:cq
theme:basic-cq
skill-level:intermediate
cost:small
","Suboptimal codegen when comparing sbyte and 16-bit values I have the following two repro methods along with their x64 codegen using the latest RyuJIT.


category:cq
theme:basic-cq
skill-level:intermediate
cost:small
",area-CodeGen,jkotas,17/05/2018 3:53,
18019,Proposal - Incorporate deadlock detection into the CLR.,"Given that the simply freeze.

The ultimate benefit is not that deadlocks would be eliminated but that they could be detected at the instant they arise and used during testing or when attempting to reproduce a deadlock that has been reported in an app or class library.

Thoughts?","Proposal - Incorporate deadlock detection into the CLR. Given that the simply freeze.

The ultimate benefit is not that deadlocks would be eliminated but that they could be detected at the instant they arise and used during testing or when attempting to reproduce a deadlock that has been reported in an app or class library.

Thoughts?",Design Discussion,RussKeldorph,17/05/2018 1:25,
18016,Allow partial loop-unrolling for JIT(optUnrollLoops),"https://github.com/dotnet/coreclr/issues/11606

following methods will be fixed.
1. Support non-vector unrolling.
2. Support partial unrolling. and threshold.
3. Support unsafe array access unrolling.","Allow partial loop-unrolling for JIT(optUnrollLoops) https://github.com/dotnet/coreclr/issues/11606

following methods will be fixed.
1. Support non-vector unrolling.
2. Support partial unrolling. and threshold.
3. Support unsafe array access unrolling.",area-CodeGen,AndyAyersMS,16/05/2018 13:52,25/06/2018 17:22
18014,Add mixed-mode Book of the Runtime entry,"Adds a Book of the Runtime entry to document how mixed-mode assemblies are specified and work in general. This is not a design for how it will be integrated into .NET Core (that will be done separately). 

Progress toward #18013 ","Add mixed-mode Book of the Runtime entry Adds a Book of the Runtime entry to document how mixed-mode assemblies are specified and work in general. This is not a design for how it will be integrated into .NET Core (that will be done separately). 

Progress toward #18013 ",documentation,morganbr,,
18013,Support mixed-mode assemblies on Windows,"This issue will track progress toward supporting loading and running mixed-mode assemblies on CoreCLR. The main goal is to provide support for WPF and other existing C++/CLI code on .NET Core. Some of the work will be dependent on updates to the MSVC compiler.

Steps include:
- [x] Documenting how mixed-mode assemblies work in general
- [x] Proposing a .NET Core design
- [x] Loading mixed-mode assemblies into running managed code
- [x] Starting the runtime from native code in mixed-mode assemblies

This is related to #659 but cross-platform support is outside of the scope of this issue as it's a compiler feature not a runtime feature.","Support mixed-mode assemblies on Windows This issue will track progress toward supporting loading and running mixed-mode assemblies on CoreCLR. The main goal is to provide support for WPF and other existing C++/CLI code on .NET Core. Some of the work will be dependent on updates to the MSVC compiler.

Steps include:
- [x] Documenting how mixed-mode assemblies work in general
- [x] Proposing a .NET Core design
- [x] Loading mixed-mode assemblies into running managed code
- [x] Starting the runtime from native code in mixed-mode assemblies

This is related to #659 but cross-platform support is outside of the scope of this issue as it's a compiler feature not a runtime feature.",area-Interop,jkoritzinsky,,
18005,ReadOnlySpan.CopyTo is surprisingly (relatively) expensive and doesn't inline,"Its mostly a wrapper on BufferMemmove with some checks
","ReadOnlySpan.CopyTo is surprisingly (relatively) expensive and doesn't inline Its mostly a wrapper on BufferMemmove with some checks
",area-CodeGen,jkotas,16/05/2018 3:55,31/05/2018 4:03
18004,Publish master branch symbols to symweb and MSDL endpoints,"Right now the official builds of .

Docs on how to do this correctly aren't currently available tracked by https://github.com/dotnet/core-eng/issues/3382.","Publish master branch symbols to symweb and MSDL endpoints Right now the official builds of .

Docs on how to do this correctly aren't currently available tracked by https://github.com/dotnet/core-eng/issues/3382.",area-Infrastructure-coreclr,dagood,16/05/2018 3:50,16/05/2018 4:07
18003,format spmi sources,,format spmi sources ,area-Infrastructure-coreclr,sandreenko,16/05/2018 3:22,16/05/2018 4:17
18002,ignore .tail opcode on arm64,"when Jit can't do a fast tail call.

Fixes #18001.","ignore .tail opcode on arm64 when Jit can't do a fast tail call.

Fixes #18001.",arch-arm64,sandreenko,16/05/2018 3:10,16/05/2018 12:02
18001,[Arm64] Tailcall regression,"Tailcode opcode should be treated as a hint to the JIT.  When it is not supported it should not assert.

The following tests have recently regressed 


This was probably introduced as a diagnostic by @sandreenko as mentioned in here 
https://github.com/dotnet/coreclr/issues/6675#issuecomment-388917599

@janvorli @dotnet/arm64-contrib ","[Arm64] Tailcall regression Tailcode opcode should be treated as a hint to the JIT.  When it is not supported it should not assert.

The following tests have recently regressed 


This was probably introduced as a diagnostic by @sandreenko as mentioned in here 
https://github.com/dotnet/coreclr/issues/6675#issuecomment-388917599

@janvorli @dotnet/arm64-contrib ",arch-arm64,sandreenko,,
17997,Tolerate spmi misses,"before:
 failure notifications.

PTAL @BruceForstall 
cc @dotnet/jit-contrib ","Tolerate spmi misses before:
 failure notifications.

PTAL @BruceForstall 
cc @dotnet/jit-contrib ",area-Infrastructure-coreclr,sandreenko,15/05/2018 16:41,16/05/2018 9:29
17992,[Linux/arm] baseservices/compilerservices/FixedAddressValueType failure,,[Linux/arm] baseservices/compilerservices/FixedAddressValueType failure ,arch-arm32,BruceForstall,,
17986,Reflection.Emit: Assertion failure in SignatureHelper.AddOneArgTypeHelper. Missing argument validation in public API?,I've come across a failing  should actively check for empty arrays and correct them.,Reflection.Emit: Assertion failure in SignatureHelper.AddOneArgTypeHelper. Missing argument validation in public API? I've come across a failing  should actively check for empty arrays and correct them.,area-System.Reflection,jkotas,14/05/2018 17:54,16/05/2018 8:39
17984,Odd side-effect check code generation with fixed keyword,"There is something wired side-effect check code generation on fixed pointers.
I don't know its because Roslyn generates wrong MSIL. but first. I am writing here.

Example here.

category:cq
theme:basic-cq
skill-level:intermediate
cost:small","Odd side-effect check code generation with fixed keyword There is something wired side-effect check code generation on fixed pointers.
I don't know its because Roslyn generates wrong MSIL. but first. I am writing here.

Example here.

category:cq
theme:basic-cq
skill-level:intermediate
cost:small",area-CodeGen,mikedn,14/05/2018 14:11,
17980,What's data stored in method handle?,"

I know the lower bits is the order number of a method but I don't know which position is the first bit.

What's the meaning of all the bits?","What's data stored in method handle? 

I know the lower bits is the order number of a method but I don't know which position is the first bit.

What's the meaning of all the bits?",question,RussKeldorph,13/05/2018 20:12,14/05/2018 5:56
17977,Reflection: Allow ParameterBuilder.SetConstant(nonNullValue) for nullable enum parameters,"This is a fix for #17893.

* Makes it possible to call 

/cc @AtsushiKan","Reflection: Allow ParameterBuilder.SetConstant(nonNullValue) for nullable enum parameters This is a fix for #17893.

* Makes it possible to call 

/cc @AtsushiKan",netfx-port-consider,,,
17969,Don't eliminate a cpblk when offsets are different,When the JIT encounters a cpblk between two different offsets of the same local if both fields are not recognizable to the JIT (i.e. the ) it will incorrectly optimize away the cpblk.,Don't eliminate a cpblk when offsets are different When the JIT encounters a cpblk between two different offsets of the same local if both fields are not recognizable to the JIT (i.e. the ) it will incorrectly optimize away the cpblk.,area-CodeGen,CarolEidt,,
17968,"[arm64/RyuJit] assert(!""Shouldn't see an integer typed GT_MOD node in ARM64"");","It was found in our internal test runs I have added an IL test for this issue: tests/src/JIT/Regression/JitBlue/DevDiv_590772/DevDiv_590772.il  (#17759)
To repro crossgen this test with altjit_arm64 or on arm64 itself.
Once it fixed delete change tests/arm64/Tests.lst to enable the test.","[arm64/RyuJit] assert(!""Shouldn't see an integer typed GT_MOD node in ARM64""); It was found in our internal test runs I have added an IL test for this issue: tests/src/JIT/Regression/JitBlue/DevDiv_590772/DevDiv_590772.il  (#17759)
To repro crossgen this test with altjit_arm64 or on arm64 itself.
Once it fixed delete change tests/arm64/Tests.lst to enable the test.",arch-arm64,sandreenko,,
17967,"[arm64/RyuJit] assert(!""We should never encounter a reference to a lclVar that has a zero refCnt."");","It was found in our internal test runs I have added an IL test for this issue: tests/src/JIT/Regression/JitBlue/DevDiv_590771/DevDiv_590771.il  (#17759)

To repro crossgen this test with altjit_arm64 or on arm64 itself.

Once it fixed delete change  to enable the test.","[arm64/RyuJit] assert(!""We should never encounter a reference to a lclVar that has a zero refCnt.""); It was found in our internal test runs I have added an IL test for this issue: tests/src/JIT/Regression/JitBlue/DevDiv_590771/DevDiv_590771.il  (#17759)

To repro crossgen this test with altjit_arm64 or on arm64 itself.

Once it fixed delete change  to enable the test.",arch-arm64,AndyAyersMS,,
17966,"[arm64/RyuJit] NYI(""Initialize floating-point register to zero"");","It was found in our internal test runs I have added an IL test for this issue: tests/src/JIT/Regression/JitBlue/DevDiv_605447/DevDiv_605447.il (#17759)

To repro crossgen this test with altjit_arm64 or on arm64 itself.

Once it fixed delete change  to enable the test.","[arm64/RyuJit] NYI(""Initialize floating-point register to zero""); It was found in our internal test runs I have added an IL test for this issue: tests/src/JIT/Regression/JitBlue/DevDiv_605447/DevDiv_605447.il (#17759)

To repro crossgen this test with altjit_arm64 or on arm64 itself.

Once it fixed delete change  to enable the test.",arch-arm64,sdmaclea,,
17963,Jit can generate pointless movs,"e.g.

category:cq
theme:basic-cq
skill-level:intermediate
cost:medium","Jit can generate pointless movs e.g.

category:cq
theme:basic-cq
skill-level:intermediate
cost:medium",area-CodeGen,RussKeldorph,11/05/2018 13:53,
17962,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,stephentoub,,
17960,Add explicit null check for VSD via tail call stub.,"Always add explicit null check before calling tail call stub that calls VSD.

Fixes #17585.

For arm64 it hits #6675.","Add explicit null check for VSD via tail call stub. Always add explicit null check before calling tail call stub that calls VSD.

Fixes #17585.

For arm64 it hits #6675.",arch-arm32,sandreenko,11/05/2018 10:57,14/05/2018 2:58
17959,LoopCloneContext::EvaluateConditions need to evaluate for const init limit condition. ,"current EvaluateConditions should evaluate const-init const-limit for not cloning very natural loops
this is **actually** statically known as true. (always taken)

this makes loop to clone(evaluate as not statically known as true or false) which causes not to unroll general natural loops (flagged as   which that doesn't really need to be cloned.

category:cq
theme:loop-opt
skill-level:expert
cost:medium","LoopCloneContext::EvaluateConditions need to evaluate for const init, limit condition.  current EvaluateConditions should evaluate const-init const-limit for not cloning very natural loops
this is **actually** statically known as true. (always taken)

this makes loop to clone(evaluate as not statically known as true or false) which causes not to unroll general natural loops (flagged as   which that doesn't really need to be cloned.

category:cq
theme:loop-opt
skill-level:expert
cost:medium",area-CodeGen,AndyAyersMS,11/05/2018 10:31,
17958,[Arm64] System.Linq.Expressions.Tests.ArrayBoundsTests.SingleNegativeBoundErrorMessage regression,"This test case was passing near 2.1 fork.


@dotnet/arm64-contrib @VSadov @OmarTawfik  FYI","[Arm64] System.Linq.Expressions.Tests.ArrayBoundsTests.SingleNegativeBoundErrorMessage regression This test case was passing near 2.1 fork.


@dotnet/arm64-contrib @VSadov @OmarTawfik  FYI",arch-arm64,VSadov,11/05/2018 8:27,21/09/2019 4:43
17956,Moving ConcurrentQueue to shared folder,"corefx PR: dotnet/corefx#29643

Fixes coreclr issue: #17751 

Related to this [comment](https://github.com/dotnet/coreclr/pull/17800#issuecomment-385092192) made by @stephentoub:
> That just leaves ConcurrentQueue which is used by ThreadPool. I agree that one is reasonable to move down.

cc: @stephentoub @jkotas @safern @danmosemsft ","Moving ConcurrentQueue to shared folder corefx PR: dotnet/corefx#29643

Fixes coreclr issue: #17751 

Related to this [comment](https://github.com/dotnet/coreclr/pull/17800#issuecomment-385092192) made by @stephentoub:
> That just leaves ConcurrentQueue which is used by ThreadPool. I agree that one is reasonable to move down.

cc: @stephentoub @jkotas @safern @danmosemsft ",area-System.Collections,maryamariyan,,
17950,Build error: PE file is already strong-name signed,"Hello.

Next errors happen during build of current master:


Do you know what could be the reason of this?

cc @alpencolt @Dmitri-Botcharnikov ","Build error: PE file is already strong-name signed Hello.

Next errors happen during build of current master:


Do you know what could be the reason of this?

cc @alpencolt @Dmitri-Botcharnikov ",area-Infrastructure-coreclr,alpencolt,11/05/2018 4:16,11/05/2018 8:46
17949,JIT: track more information about variable definitions in the importer,"In many cases the use of a variable has a single reaching definition. We should consider tracking this information in the importer and using it to drive early optimizations.

The idea for now is to look at only the simplest cases ones where a variable has:
* a single definition and all uses are clearly dominated by the definition
  * arguments that are not exposed or redefined
  * a subset of the temps introduced by the jit like the  temps for ref types. But likely the full expression would be cheap enough to track.

The tracking mechanism needs to be robust in the presence of reimportation and should have some kind of post-importer sanity check.

It would also be good if this information remained viable through the early phases of the jit -- for instance it could be used and maintained during inlining.

category:cq
theme:basic-cq
skill-level:expert
cost:medium","JIT: track more information about variable definitions in the importer In many cases the use of a variable has a single reaching definition. We should consider tracking this information in the importer and using it to drive early optimizations.

The idea for now is to look at only the simplest cases ones where a variable has:
* a single definition and all uses are clearly dominated by the definition
  * arguments that are not exposed or redefined
  * a subset of the temps introduced by the jit like the  temps for ref types. But likely the full expression would be cheap enough to track.

The tracking mechanism needs to be robust in the presence of reimportation and should have some kind of post-importer sanity check.

It would also be good if this information remained viable through the early phases of the jit -- for instance it could be used and maintained during inlining.

category:cq
theme:basic-cq
skill-level:expert
cost:medium",area-CodeGen,AndyAyersMS,11/05/2018 2:00,
17947,Add reporting exception from ResolveEHClause,"When an exception like EEFileLoadException happens in the
ResolveEHClause it was not caught by the runtime and so it caused exit
with 
message without any additional details.

This change adds catching the exception reporting its details and call
stack and then failing fast.

Close #16438","Add reporting exception from ResolveEHClause When an exception like EEFileLoadException happens in the
ResolveEHClause it was not caught by the runtime and so it caused exit
with 
message without any additional details.

This change adds catching the exception reporting its details and call
stack and then failing fast.

Close #16438",area-VM,janvorli,,
17946,ResourceReader Cannot Read Resource File,"We are in the process of migrating an application from the .NET Framework to .NET Core 2 but it looks like the ResourceReader cannot process a valid resx file.

When I create the ResourceReader I get 




Here is a [gist](https://gist.github.com/zeus82/e45838a029f58784ebe2e118b11f21cf) to the contents of the resx file.","ResourceReader Cannot Read Resource File We are in the process of migrating an application from the .NET Framework to .NET Core 2 but it looks like the ResourceReader cannot process a valid resx file.

When I create the ResourceReader I get 




Here is a [gist](https://gist.github.com/zeus82/e45838a029f58784ebe2e118b11f21cf) to the contents of the resx file.",question,jkotas,10/05/2018 22:38,11/05/2018 4:47
17944,CoreCLR failures when build permissive- + msvc on windows,"Hi
We found 3 failures when build CoreCLR with permissive- by msvc on windows could you help take a look?

You can repro this issue as the steps below:
1.	git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2.	Open VS2017 x86 command prompt and browse to D:\CoreCLR\src
3.	Set  _CL_=/wd5043 /permissive-
4.	build x86 release -Rebuild -- /clp:ShowCommandLine
5.	build-test.cmd x86 release -- /clp:ShowCommandLine

See the issue as following:
Issue #1: 
d:\coreclr\src\src\classlibnative\bcltype\grisu3.h(36): error C4596: 'BiggestPowerTenLessThanOrEqualTo': illegal qualified name in member declaration
Probably fix:
Change
   static void Grisu3::BiggestPowerTenLessThanOrEqualTo(UINT32 number int bits UINT32 *power int *exponent);
To
static void BiggestPowerTenLessThanOrEqualTo(UINT32 number int bits UINT32 *power int *exponent);

Issue #2
d:\coreclr\src\src\vm\dllimport.cpp(6098): error C2664: 'BOOL SString::Find(SString::CIterator &WCHAR) const': cannot convert argument 1 from 'SString::CIterator' to 'SString::CIterator &' [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
  d:\coreclr\src\src\vm\dllimport.cpp(6098): note: A non-const reference may only be bound to an lvalue
Probably fix:
Needs to change from:
if (!libNameIsRelativePath ||
!libName.Find(libName.Begin() W('.')) ||

To:
auto it = libName.Begin();
if (!libNameIsRelativePath ||
!libName.Find(it W('.')) ||

Issue #3 
d:\coreclr\src\src\inc\winrt\paraminstanceapi.h(422): error C3861: '_size': identifier not found (compiling source file D:\CoreCLR\src\src\vm\interoputil.cpp
Probably fix:
Change
for (size_t i = 0; i != _size; ++i) 
To
for (size_t i = 0; i != size; ++i)
","CoreCLR failures when build permissive- + msvc on windows Hi
We found 3 failures when build CoreCLR with permissive- by msvc on windows could you help take a look?

You can repro this issue as the steps below:
1.	git clone https://github.com/dotnet/coreclr D:\CoreCLR\src
2.	Open VS2017 x86 command prompt and browse to D:\CoreCLR\src
3.	Set  _CL_=/wd5043 /permissive-
4.	build x86 release -Rebuild -- /clp:ShowCommandLine
5.	build-test.cmd x86 release -- /clp:ShowCommandLine

See the issue as following:
Issue #1: 
d:\coreclr\src\src\classlibnative\bcltype\grisu3.h(36): error C4596: 'BiggestPowerTenLessThanOrEqualTo': illegal qualified name in member declaration
Probably fix:
Change
   static void Grisu3::BiggestPowerTenLessThanOrEqualTo(UINT32 number int bits UINT32 *power int *exponent);
To
static void BiggestPowerTenLessThanOrEqualTo(UINT32 number int bits UINT32 *power int *exponent);

Issue #2
d:\coreclr\src\src\vm\dllimport.cpp(6098): error C2664: 'BOOL SString::Find(SString::CIterator &WCHAR) const': cannot convert argument 1 from 'SString::CIterator' to 'SString::CIterator &' [D:\CoreCLR\src\bin\obj\Windows_NT.x86.Release\src\vm\wks\cee_wks.vcxproj]
  d:\coreclr\src\src\vm\dllimport.cpp(6098): note: A non-const reference may only be bound to an lvalue
Probably fix:
Needs to change from:
if (!libNameIsRelativePath ||
!libName.Find(libName.Begin() W('.')) ||

To:
auto it = libName.Begin();
if (!libNameIsRelativePath ||
!libName.Find(it W('.')) ||

Issue #3 
d:\coreclr\src\src\inc\winrt\paraminstanceapi.h(422): error C3861: '_size': identifier not found (compiling source file D:\CoreCLR\src\src\vm\interoputil.cpp
Probably fix:
Change
for (size_t i = 0; i != _size; ++i) 
To
for (size_t i = 0; i != size; ++i)
",Hackathon,kant2002,,
17943,Reliability - Watson crash in AssemblySpec::Bind  ,"We have a failure during EEStartup tracked by this internal Watson bucket:
https://watson/Failure?FailureSearchText=4a3aff04-3ef6-bbbe-2ae8-2cffa0b278c3

This accounts for 91.6% of reported external failures in coreclr.dll:

    0 coreclr!AssemblySpec::Bind  0x0000000000000183    coreassemblyspec.cpp 
    1 coreclr!AppDomain::BindAssemblySpec  0x0000000000000126    appdomain.cpp 
    2 coreclr!PEFile::LoadAssembly  0x000000000000010C    pefile.cpp 
    3 coreclr!Module::LoadAssembly  0x00000000000000F6    ceeload.cpp 
    4 coreclr!Assembly::FindModuleByTypeRef  0x00000000000001F9    assembly.cpp 
    5 coreclr!ClassLoader::LoadTypeDefOrRefThrowing  0x00000000000002AE    clsload.cpp 
    6 coreclr!SigPointer::GetTypeHandleThrowing  0x000000000000021F    siginfo.cpp 
    7 coreclr!MemberLoader::GetDescFromMemberRef  0x000000000000039B    memberload.cpp 
    8 coreclr!CEEInfo::resolveToken  0x00000000000005A6    jitinterface.cpp 
    9 clrjit!Compiler::impImportBlockCode  0x0000000000000927    importer.cpp 
    10 clrjit!Compiler::impImportBlock  0x0000000000000093    importer.cpp 
    11 clrjit!Compiler::impImport  0x00000000000002DB    importer.cpp 
    12 clrjit!Compiler::compCompile  0x00000000000000A4    compiler.cpp 
    13 clrjit!Compiler::compCompileHelper  0x0000000000000299    compiler.cpp 
    14 clrjit!Compiler::compCompile  0x000000000000025D    compiler.cpp 
    15 clrjit!jitNativeCode  0x000000000000026E    compiler.cpp 
    16 clrjit!CILJit::compileMethod  0x00000000000000A2    ee_il_dll.cpp 
    17 coreclr!invokeCompileMethod  0x00000000000000E5    jitinterface.cpp 
    18 coreclr!CallCompileMethodWithSEHWrapper  0x0000000000000052    jitinterface.cpp 
    19 coreclr!UnsafeJitFunction  0x00000000000004F5    jitinterface.cpp 
    20 coreclr!MethodDesc::JitCompileCodeLocked  0x00000000000001FE    prestub.cpp 
    21 coreclr!MethodDesc::JitCompileCodeLockedEventWrapper  0x00000000001313C1    prestub.cpp 
    22 coreclr!MethodDesc::JitCompileCode  0x0000000000000399    prestub.cpp 
    23 coreclr!MethodDesc::DoPrestub  0x000000000000059E    prestub.cpp 
    24 coreclr!PreStubWorker  0x000000000000037A    prestub.cpp 
    25 coreclr!ThePreStub  0x0000000000000055    ThePreStubAMD64.asm 
    26 coreclr!CallDescrWorkerInternal  0x0000000000000083    CallDescrWorkerAMD64.asm 
    27 coreclr!MethodDescCallSite::CallTargetWorker  0x00000000000002B5    callhelpers.cpp 
    28 coreclr!AppDomain::InitializeDomainContext  0x0000000000000105    appdomain.cpp 
    29 coreclr!SystemDomain::InitializeDefaultDomain  0x000000000000004E    appdomain.cpp 
    30 coreclr!SystemDomain::SetupDefaultDomain  0x0000000000000199    appdomain.cpp 
    31 coreclr!SystemDomain::SetupDefaultDomainNoThrow  0x000000000000004D    appdomain.cpp 
    32 coreclr!EEStartup  0x000000000000006E    ceemain.cpp 
","Reliability - Watson crash in AssemblySpec::Bind   We have a failure during EEStartup tracked by this internal Watson bucket:
https://watson/Failure?FailureSearchText=4a3aff04-3ef6-bbbe-2ae8-2cffa0b278c3

This accounts for 91.6% of reported external failures in coreclr.dll:

    0 coreclr!AssemblySpec::Bind  0x0000000000000183    coreassemblyspec.cpp 
    1 coreclr!AppDomain::BindAssemblySpec  0x0000000000000126    appdomain.cpp 
    2 coreclr!PEFile::LoadAssembly  0x000000000000010C    pefile.cpp 
    3 coreclr!Module::LoadAssembly  0x00000000000000F6    ceeload.cpp 
    4 coreclr!Assembly::FindModuleByTypeRef  0x00000000000001F9    assembly.cpp 
    5 coreclr!ClassLoader::LoadTypeDefOrRefThrowing  0x00000000000002AE    clsload.cpp 
    6 coreclr!SigPointer::GetTypeHandleThrowing  0x000000000000021F    siginfo.cpp 
    7 coreclr!MemberLoader::GetDescFromMemberRef  0x000000000000039B    memberload.cpp 
    8 coreclr!CEEInfo::resolveToken  0x00000000000005A6    jitinterface.cpp 
    9 clrjit!Compiler::impImportBlockCode  0x0000000000000927    importer.cpp 
    10 clrjit!Compiler::impImportBlock  0x0000000000000093    importer.cpp 
    11 clrjit!Compiler::impImport  0x00000000000002DB    importer.cpp 
    12 clrjit!Compiler::compCompile  0x00000000000000A4    compiler.cpp 
    13 clrjit!Compiler::compCompileHelper  0x0000000000000299    compiler.cpp 
    14 clrjit!Compiler::compCompile  0x000000000000025D    compiler.cpp 
    15 clrjit!jitNativeCode  0x000000000000026E    compiler.cpp 
    16 clrjit!CILJit::compileMethod  0x00000000000000A2    ee_il_dll.cpp 
    17 coreclr!invokeCompileMethod  0x00000000000000E5    jitinterface.cpp 
    18 coreclr!CallCompileMethodWithSEHWrapper  0x0000000000000052    jitinterface.cpp 
    19 coreclr!UnsafeJitFunction  0x00000000000004F5    jitinterface.cpp 
    20 coreclr!MethodDesc::JitCompileCodeLocked  0x00000000000001FE    prestub.cpp 
    21 coreclr!MethodDesc::JitCompileCodeLockedEventWrapper  0x00000000001313C1    prestub.cpp 
    22 coreclr!MethodDesc::JitCompileCode  0x0000000000000399    prestub.cpp 
    23 coreclr!MethodDesc::DoPrestub  0x000000000000059E    prestub.cpp 
    24 coreclr!PreStubWorker  0x000000000000037A    prestub.cpp 
    25 coreclr!ThePreStub  0x0000000000000055    ThePreStubAMD64.asm 
    26 coreclr!CallDescrWorkerInternal  0x0000000000000083    CallDescrWorkerAMD64.asm 
    27 coreclr!MethodDescCallSite::CallTargetWorker  0x00000000000002B5    callhelpers.cpp 
    28 coreclr!AppDomain::InitializeDomainContext  0x0000000000000105    appdomain.cpp 
    29 coreclr!SystemDomain::InitializeDefaultDomain  0x000000000000004E    appdomain.cpp 
    30 coreclr!SystemDomain::SetupDefaultDomain  0x0000000000000199    appdomain.cpp 
    31 coreclr!SystemDomain::SetupDefaultDomainNoThrow  0x000000000000004D    appdomain.cpp 
    32 coreclr!EEStartup  0x000000000000006E    ceemain.cpp 
",area-AssemblyLoader,jeffschwMSFT,10/05/2018 11:50,14/06/2018 2:35
17936,Fix alternate stack for Alpine docker on SELinux,"For some reason the Alpine docker container running on a SELinux host maps
heap as RWX. When we allocate alternate stack from the heap we also
change the protection of the first page to PROT_NONE so that it can
serve as a guard page to catch stack overflow. And when we free the
alternate stack we restore the protection back to PROT_READ |
PROT_WRITE. The restoration fails in Alpine docker container running on
a SELinux host with EPROT failure and the SELinux log reports that an
attempt to change heap to executable was made. So it looks like the
kernel has added the PERM_EXEC to the permissions we have passed to the
mprotect call. There is a code in the mprotect implementation that can
do that although I don't fully understand the exact conditions under which it
happens yet. This is driven by the VM_MAYEXEC flag in the internal VMA block
structure. 
To fix that I've modified the alternate stack allocation to use mmap /
munmap instead of C heap allocation.

Close #17931","Fix alternate stack for Alpine docker on SELinux For some reason the Alpine docker container running on a SELinux host maps
heap as RWX. When we allocate alternate stack from the heap we also
change the protection of the first page to PROT_NONE so that it can
serve as a guard page to catch stack overflow. And when we free the
alternate stack we restore the protection back to PROT_READ |
PROT_WRITE. The restoration fails in Alpine docker container running on
a SELinux host with EPROT failure and the SELinux log reports that an
attempt to change heap to executable was made. So it looks like the
kernel has added the PERM_EXEC to the permissions we have passed to the
mprotect call. There is a code in the mprotect implementation that can
do that although I don't fully understand the exact conditions under which it
happens yet. This is driven by the VM_MAYEXEC flag in the internal VMA block
structure. 
To fix that I've modified the alternate stack allocation to use mmap /
munmap instead of C heap allocation.

Close #17931",area-PAL,janvorli,,
17935,JIT: have inlining heuristics look for cases where inlining might enable devirtualization,"When a caller argument is an exact type and feeds a virtual or interface call in the callee we might want to inline more aggressively.

A toy example of this can be found in [this BenchmarkDotNet sample](https://github.com/dotnet/BenchmarkDotNet/blob/master/samples/BenchmarkDotNet.Samples/JIT/Jit_InterfaceMethod.cs). Here 

Likely we would not give a ~3.65x boost to inlining benefit based on one argument reaching one call site. But if we also realized the call site was in a loop perhaps the net effect would be enough to justify an inline.

Currently we don't know when observing arg uses whether that use is in a loop or not. But if we were to associate uses with callee IL offsets we could circle back after finding all the branch targets and develop a crude estimator for loop depth then sum up the weighted observations.

It would also be nice to tabulate a few more opportunities of this kind. The basic observational part change is simple enough to prototype that perhaps just building it is one way to make forward progress.

category:cq
theme:inlining
skill-level:intermediate
cost:medium","JIT: have inlining heuristics look for cases where inlining might enable devirtualization When a caller argument is an exact type and feeds a virtual or interface call in the callee we might want to inline more aggressively.

A toy example of this can be found in [this BenchmarkDotNet sample](https://github.com/dotnet/BenchmarkDotNet/blob/master/samples/BenchmarkDotNet.Samples/JIT/Jit_InterfaceMethod.cs). Here 

Likely we would not give a ~3.65x boost to inlining benefit based on one argument reaching one call site. But if we also realized the call site was in a loop perhaps the net effect would be enough to justify an inline.

Currently we don't know when observing arg uses whether that use is in a loop or not. But if we were to associate uses with callee IL offsets we could circle back after finding all the branch targets and develop a crude estimator for loop depth then sum up the weighted observations.

It would also be nice to tabulate a few more opportunities of this kind. The basic observational part change is simple enough to prototype that perhaps just building it is one way to make forward progress.

category:cq
theme:inlining
skill-level:intermediate
cost:medium",area-CodeGen,AndyAyersMS,10/05/2018 8:06,
17934,[arm/arm64] fix semicolon and priorities for new excluded tests,Small fix for #17855.,[arm/arm64] fix semicolon and priorities for new excluded tests Small fix for #17855.,test enhancement,sandreenko,10/05/2018 7:48,10/05/2018 10:14
17933,[Arm64/Linux] SDK fails to build hello world,"@richlander @dotnet/arm64-contrib @Petermarcu 

As noted in various places the 2.1 arm64-linux SDK is failing during the build of Hello World with either an assertion or a segmentation fault","[Arm64/Linux] SDK fails to build hello world @richlander @dotnet/arm64-contrib @Petermarcu 

As noted in various places the 2.1 arm64-linux SDK is failing during the build of Hello World with either an assertion or a segmentation fault",arch-arm64,richlander,10/05/2018 3:20,19/05/2018 4:11
17932,Possible Performance Regression from 2.0.7 to 2.1-RC1 on Windows Server 2016 w/ Hyper-V Role,"@Mike-EEE commented on [Wed May 09 2018](https://github.com/dotnet/core/issues/1524)

Hello .NET Core Team and Community

I have a very interesting performance issue for you here.  I have produced some code that demonstrates a regressing difference in performance when switching from the .NET Core 2.0.x runtime to 2.1-RC1 on my Windows Server 2016 machine that I am using as a Hyper-V server.  Please note that I am also using Visual Studio 2017 15.7.1 in producing my output here.

To start this issue has context that is most recently rooted in a Benchmark.NET issue that you [can view here](https://github.com/dotnet/BenchmarkDotNet/issues/739).  I have created a series of five benchmarks using the exact same underlying test code.  Each have a slight modification that produce different results in 2.0.7 when run on my Windows Server host machine (note: the host machine and not a VM instance).  You can see an [overview of this information here](https://github.com/dotnet/BenchmarkDotNet/issues/739#issuecomment-386811232).

I took the code that is in the 3rd example and by simply rebuilding it and running it in the 2.1 runtime it produced slower results.  I have [created this 2.1 branch here](https://github.com/Mike-EEE/BenchmarkDotNet.InProcess/tree/TheWeird_03a) for your convenience.

(Please do note that the results of each scenario are found in the README.md of their respective branches.)

Additionally with a small change I was once again able to produce the faster result times as seen in 2.0.7 but within the 2.1 runtime.  I have published this [branch here](https://github.com/Mike-EEE/BenchmarkDotNet.InProcess/tree/TheWeird_03b).  This is consistent with the bizarre behavior referenced in the five earlier examples but seen here in a different form (or configuration for lack of a better term) in 2.1.

I feel it's worthy to note that I believe that this is a gremlin of a problem that I have been chasing in .NET Core tooling since 1.1.  I have encountered the most weird of circumstances around this behavior while trying to benchmark code using Benchmark.NET.  You can see previous iterations of my previous more complicated attempts at wrestling this beast here for your reference:
https://github.com/dotnet/BenchmarkDotNet/issues/330
https://github.com/dotnet/BenchmarkDotNet/issues/433

Now that I have been able to show a (regressing) discrepancy in performance between 2.0.7 and 2.1 RC1 with a simple recompile I believe this could be due to a tooling/SDK problem that has been around for some time now.  Fortunately I have been able to capture it using a very simple project this time and am more than happy to share it now in hopes to finally tracking down this very weird issue. 😄 

Finally I will provide an overview of my Windows Server specifications here.



Please let me know if you require any further information around this issue or my environment and I will be happy to get it for you.

Thank you for any assistance you can provide towards solving this issue!

","Possible Performance Regression from 2.0.7 to 2.1-RC1 on Windows Server 2016 w/ Hyper-V Role @Mike-EEE commented on [Wed May 09 2018](https://github.com/dotnet/core/issues/1524)

Hello .NET Core Team and Community

I have a very interesting performance issue for you here.  I have produced some code that demonstrates a regressing difference in performance when switching from the .NET Core 2.0.x runtime to 2.1-RC1 on my Windows Server 2016 machine that I am using as a Hyper-V server.  Please note that I am also using Visual Studio 2017 15.7.1 in producing my output here.

To start this issue has context that is most recently rooted in a Benchmark.NET issue that you [can view here](https://github.com/dotnet/BenchmarkDotNet/issues/739).  I have created a series of five benchmarks using the exact same underlying test code.  Each have a slight modification that produce different results in 2.0.7 when run on my Windows Server host machine (note: the host machine and not a VM instance).  You can see an [overview of this information here](https://github.com/dotnet/BenchmarkDotNet/issues/739#issuecomment-386811232).

I took the code that is in the 3rd example and by simply rebuilding it and running it in the 2.1 runtime it produced slower results.  I have [created this 2.1 branch here](https://github.com/Mike-EEE/BenchmarkDotNet.InProcess/tree/TheWeird_03a) for your convenience.

(Please do note that the results of each scenario are found in the README.md of their respective branches.)

Additionally with a small change I was once again able to produce the faster result times as seen in 2.0.7 but within the 2.1 runtime.  I have published this [branch here](https://github.com/Mike-EEE/BenchmarkDotNet.InProcess/tree/TheWeird_03b).  This is consistent with the bizarre behavior referenced in the five earlier examples but seen here in a different form (or configuration for lack of a better term) in 2.1.

I feel it's worthy to note that I believe that this is a gremlin of a problem that I have been chasing in .NET Core tooling since 1.1.  I have encountered the most weird of circumstances around this behavior while trying to benchmark code using Benchmark.NET.  You can see previous iterations of my previous more complicated attempts at wrestling this beast here for your reference:
https://github.com/dotnet/BenchmarkDotNet/issues/330
https://github.com/dotnet/BenchmarkDotNet/issues/433

Now that I have been able to show a (regressing) discrepancy in performance between 2.0.7 and 2.1 RC1 with a simple recompile I believe this could be due to a tooling/SDK problem that has been around for some time now.  Fortunately I have been able to capture it using a very simple project this time and am more than happy to share it now in hopes to finally tracking down this very weird issue. 😄 

Finally I will provide an overview of my Windows Server specifications here.



Please let me know if you require any further information around this issue or my environment and I will be happy to get it for you.

Thank you for any assistance you can provide towards solving this issue!

",area-CodeGen,Petermarcu,10/05/2018 1:26,23/10/2018 7:52
17931,Using Alpine docker image from system w/ SELinux execheap enforcement triggers segfault,"@petejohanson commented on [Sun May 06 2018](https://github.com/dotnet/core/issues/1503)

# Alpine docker image segfault when run from a host system w/ SELinux execheap enforcement

From my Fedora laptop attempting to use the  so that should just work.

---

@janvorli commented on [Wed May 09 2018](https://github.com/dotnet/core/issues/1503#issuecomment-387766924)

So my assumption is that kernel adds PROT_EXEC as a result of VM_MAYEXEC being set for mprotect in the memory allocated from the heap. I've noticed that when running in the alpine docker container on the SELinux enabled Fedora 28 the heap has all three RWX flags set. 

I've tried to fix it by allocating the alternate stack using mmap instead of getting it from the heap and it worked fine. I am going to create a PR for this fix.


---

@Petermarcu commented on [Wed May 09 2018](https://github.com/dotnet/core/issues/1503#issuecomment-387770480)

Is this Alpine specific or SE Linux? Is this a regression from 2.0?

","Using Alpine docker image from system w/ SELinux execheap enforcement triggers segfault @petejohanson commented on [Sun May 06 2018](https://github.com/dotnet/core/issues/1503)

# Alpine docker image segfault when run from a host system w/ SELinux execheap enforcement

From my Fedora laptop attempting to use the  so that should just work.

---

@janvorli commented on [Wed May 09 2018](https://github.com/dotnet/core/issues/1503#issuecomment-387766924)

So my assumption is that kernel adds PROT_EXEC as a result of VM_MAYEXEC being set for mprotect in the memory allocated from the heap. I've noticed that when running in the alpine docker container on the SELinux enabled Fedora 28 the heap has all three RWX flags set. 

I've tried to fix it by allocating the alternate stack using mmap instead of getting it from the heap and it worked fine. I am going to create a PR for this fix.


---

@Petermarcu commented on [Wed May 09 2018](https://github.com/dotnet/core/issues/1503#issuecomment-387770480)

Is this Alpine specific or SE Linux? Is this a regression from 2.0?

",area-PAL,janvorli,,
17929,Unexpected coredumps,"I notice my system was creating coredumps for .NET Core processes.

Repro:

I didn't expect this program to generate a coredump.","Unexpected coredumps I notice my system was creating coredumps for .NET Core processes.

Repro:

I didn't expect this program to generate a coredump.",area-Diagnostics,mikedn,,
17926,Rename mscorlib to System.Private.Corelib,"cc: @jkotas @safern @danmosemsft 

Fixes: #17905","Rename mscorlib to System.Private.Corelib cc: @jkotas @safern @danmosemsft 

Fixes: #17905",area-Meta-corelib,maryamariyan,,
17924,Following build/test instructions doesn't build any tests,"I'm trying to build coreclr release/2.1 on Amazon Linux 2017.03 and can't get the tests to build.  (I have the same issue on Ubuntu)
Here are the instructions I'm following:
https://github.com/dotnet/coreclr/blob/release/2.1/Documentation/building/linux-instructions.md
https://github.com/dotnet/coreclr/blob/release/2.1/Documentation/building/unix-test-instructions.md

Here's my script:

Then when I run my runtest.sh command from above the test is run.

How do I get the tests to build?

","Following build/test instructions doesn't build any tests I'm trying to build coreclr release/2.1 on Amazon Linux 2017.03 and can't get the tests to build.  (I have the same issue on Ubuntu)
Here are the instructions I'm following:
https://github.com/dotnet/coreclr/blob/release/2.1/Documentation/building/linux-instructions.md
https://github.com/dotnet/coreclr/blob/release/2.1/Documentation/building/unix-test-instructions.md

Here's my script:

Then when I run my runtest.sh command from above the test is run.

How do I get the tests to build?

",area-Infrastructure-coreclr,jashook,,
17922,Mirror changes from dotnet/corert,"This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**","Mirror changes from dotnet/corert This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**",,jkotas,,
17917,Reflection: Fix FormatException when querying ParameterInfo.DefaultValue of optional (closed generic) enum parameter,"This is similar to #17877 but about enums instead of  constant in metadata which isn't usually the case for enums.)

/cc @AtsushiKan","Reflection: Fix FormatException when querying ParameterInfo.DefaultValue of optional (closed generic) enum parameter This is similar to #17877 but about enums instead of  constant in metadata which isn't usually the case for enums.)

/cc @AtsushiKan",netfx-port-consider,,,
17915,[WIP] Fix failing System.Reflection.Emit tests,Commit fceac03e82 removed a test from .,[WIP] Fix failing System.Reflection.Emit tests Commit fceac03e82 removed a test from .,netfx-port-consider,jkotas,8/05/2018 21:28,9/05/2018 0:39
17909,Remove ConcurrentStack from System.Private.CoreLib ,"This issue is opened to track removing ConcurrentStack from System.Private.CoreLib 

Referring to [comment](https://github.com/dotnet/coreclr/pull/17800#issuecomment-385092192) _From @stephentoub on Apr 27 2018 1:57 PM PDT_:

> ConcurrentStack is to my knowledge used in only one place in corelib by PinnableBufferCache which is in turn only used by Overlapped as a way to cache OverlappedData instances and I think we could come up with something better than ConcurrentStack for this use case in particular since every Push ends up allocating a Node in ConcurrentStack.

Related to issue: https://github.com/dotnet/coreclr/issues/17751

cc: @stephentoub @danmosemsft @jkotas ","Remove ConcurrentStack from System.Private.CoreLib  This issue is opened to track removing ConcurrentStack from System.Private.CoreLib 

Referring to [comment](https://github.com/dotnet/coreclr/pull/17800#issuecomment-385092192) _From @stephentoub on Apr 27 2018 1:57 PM PDT_:

> ConcurrentStack is to my knowledge used in only one place in corelib by PinnableBufferCache which is in turn only used by Overlapped as a way to cache OverlappedData instances and I think we could come up with something better than ConcurrentStack for this use case in particular since every Push ends up allocating a Node in ConcurrentStack.

Related to issue: https://github.com/dotnet/coreclr/issues/17751

cc: @stephentoub @danmosemsft @jkotas ",area-System.Collections,stephentoub,8/05/2018 3:04,10/06/2018 6:40
17842,Add better portable PDB caching to System.Diagnostics.StackTrace,"Issue #17701

Add portable PDB caching to StackTrace.

This is the mscorlib/System.Private.Corelib side of the change.","Add better portable PDB caching to System.Diagnostics.StackTrace Issue #17701

Add portable PDB caching to StackTrace.

This is the mscorlib/System.Private.Corelib side of the change.",,mikem8361,,
17841,[Arm64] GitHub_17777  - Assertion failed 'emitCurIG != emitPrologIG' in ,"JIT/Regression/JitBlue/GitHub_17777/GitHub_17777/GitHub_17777.sh

","[Arm64] GitHub_17777  - Assertion failed 'emitCurIG != emitPrologIG' in  JIT/Regression/JitBlue/GitHub_17777/GitHub_17777/GitHub_17777.sh

",arch-arm64,briansull,,
17840,[master] Add runtimeconfig.json support for tiered compilation,cc @kouvel @4creators ,[master] Add runtimeconfig.json support for tiered compilation cc @kouvel @4creators ,area-TieredCompilation,kouvel,1/05/2018 7:00,1/05/2018 8:51
17839,Add runtimeconfig.json support for tiered compilation,,Add runtimeconfig.json support for tiered compilation ,area-TieredCompilation,noahfalk,,
17838,JIT: volatile compares should not be foldable,"
Folding the compare is unsafe in general.

See also the somewhat related #6172.

category:correctness
theme:basic-cq
skill-level:intermediate
cost:small","JIT: volatile compares should not be foldable 
Folding the compare is unsafe in general.

See also the somewhat related #6172.

category:correctness
theme:basic-cq
skill-level:intermediate
cost:small",area-CodeGen,AndyAyersMS,1/05/2018 6:29,
17837,GC env vars,Remove CORECLR_SERVER_GC and CORECLR_CONCURRENT_GC and make COMPlus_gcServer and COMPlus_gcConcurrent available on Windows.,GC env vars Remove CORECLR_SERVER_GC and CORECLR_CONCURRENT_GC and make COMPlus_gcServer and COMPlus_gcConcurrent available on Windows.,,sywhang,,
17835,[arm/corefx] System.Tests.TypedReferenceTests.NegativeMakeTypedReference fails,"[ci run](https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/13/consoleText) shows:


link  https://github.com/dotnet/coreclr/issues/16001#issuecomment-385319873.

Probably it will fix #17585.","[arm/corefx] System.Tests.TypedReferenceTests.NegativeMakeTypedReference fails [ci run](https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/13/consoleText) shows:


link  https://github.com/dotnet/coreclr/issues/16001#issuecomment-385319873.

Probably it will fix #17585.",arch-arm32,sandreenko,,
17833,PropertyInfo.SetValue on ref-returning members,"https://github.com/dotnet/corefx/issues/15960

This invokes the getter and writes the argument
value into the reference. InvalidOpException
if the property is readonly ref.","PropertyInfo.SetValue on ref-returning members https://github.com/dotnet/corefx/issues/15960

This invokes the getter and writes the argument
value into the reference. InvalidOpException
if the property is readonly ref.",area-System.Reflection,,,
17831,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,jkotas,,
17828,[JIT]: Stack allocation to Span,"I looked at what IL and x86 code is generated for different ways of allocating memory on stack
and think there is room for optimizations. 

1. Roslyn could generate better IL for 
</p>
</details>



","[JIT]: Stack allocation to Span I looked at what IL and x86 code is generated for different ways of allocating memory on stack
and think there is room for optimizations. 

1. Roslyn could generate better IL for 
</p>
</details>



",area-CodeGen,VSadov,29/04/2018 0:10,7/05/2018 4:27
17827,Should FEATURE_APPX be enabled in coreclr builds?,"
/cc @jkotas @danmosemsft ","Should FEATURE_APPX be enabled in coreclr builds? 
/cc @jkotas @danmosemsft ",area-Interop,jkotas,28/04/2018 22:57,28/04/2018 23:44
17825,SEHException occurs VS 2017 Remote Debugging on Windows  to debug Linux ASP.NET Core application,"Application Environment: Oracle Linux 7.4 (RedHat 7.4)
Debugging Environment: Visual Studio Enterprise 2017 v15.6.6 on Windows
.NET Core SDK Version on both Windows and Linux: 2.1.101

VS is able to attach the Linux ASP .NET Core process in the debugger.  However when trying to step over or continue the execution SEHException occurs.  Here is the exception information:
 - Data: System.Collections.ListDictionaryInternal
 - ErrorCode/HResult: -2147467259
 - Message: ""External component has thrown an exception.""

We have Microsoft sessions on site to talk about VS remote debugging for ASP.NET Core on Linux  and have documentation to describe how to do that.  However the documentation is based on ubuntu Linux.    We follow similar steps in Oracle Linux v7.4 and encountered SEHException.  We also tried Console Application and also encountered exception.

We need to know if VS Remote debugging on Window can debug .NET Core process in  Oracle Linux v7.1 or above.    
","SEHException occurs VS 2017 Remote Debugging on Windows  to debug Linux ASP.NET Core application Application Environment: Oracle Linux 7.4 (RedHat 7.4)
Debugging Environment: Visual Studio Enterprise 2017 v15.6.6 on Windows
.NET Core SDK Version on both Windows and Linux: 2.1.101

VS is able to attach the Linux ASP .NET Core process in the debugger.  However when trying to step over or continue the execution SEHException occurs.  Here is the exception information:
 - Data: System.Collections.ListDictionaryInternal
 - ErrorCode/HResult: -2147467259
 - Message: ""External component has thrown an exception.""

We have Microsoft sessions on site to talk about VS remote debugging for ASP.NET Core on Linux  and have documentation to describe how to do that.  However the documentation is based on ubuntu Linux.    We follow similar steps in Oracle Linux v7.4 and encountered SEHException.  We also tried Console Application and also encountered exception.

We need to know if VS Remote debugging on Window can debug .NET Core process in  Oracle Linux v7.1 or above.    
",area-Diagnostics,jkotas,28/04/2018 11:18,2/05/2018 5:13
17824,Concurrent GC enabled with multiple env vars,"Concurrent GC can be enabled by setting environment variable COMPlus_gcConcurrent=1

There is another variable that sets this: CORECLR_CONCURRENT_GC.

We should only have one variable that sets concurrent GC instead of having multiple of them.

Similar issue to https://github.com/dotnet/coreclr/issues/17760","Concurrent GC enabled with multiple env vars Concurrent GC can be enabled by setting environment variable COMPlus_gcConcurrent=1

There is another variable that sets this: CORECLR_CONCURRENT_GC.

We should only have one variable that sets concurrent GC instead of having multiple of them.

Similar issue to https://github.com/dotnet/coreclr/issues/17760",area-GC,sywhang,,
17823,Ensure that any byrefs created in genCodeForIndexAddr cannot point outside of the array,"For Arm/arm64 in  we need to insure that we don't create a byref that might point outside of the array object.

","Ensure that any byrefs created in genCodeForIndexAddr cannot point outside of the array For Arm/arm64 in  we need to insure that we don't create a byref that might point outside of the array object.

",area-CodeGen,briansull,,
17822,Main thread is not CoInitializeEx'ed to MTA by default,"When the attribute is not present. Forked from https://github.com/dotnet/coreclr/issues/17787. Fixes for both issues would be breaking changes and should be fixed for the next major version release (3.0).

https://github.com/dotnet/coreclr/blob/53450d7cd4f3d73aa976d2d6be96a3bfe6c028c9/src/vm/assembly.cpp#L1804 and  at this point).

[Milestone = 3.0]","Main thread is not CoInitializeEx'ed to MTA by default When the attribute is not present. Forked from https://github.com/dotnet/coreclr/issues/17787. Fixes for both issues would be breaking changes and should be fixed for the next major version release (3.0).

https://github.com/dotnet/coreclr/blob/53450d7cd4f3d73aa976d2d6be96a3bfe6c028c9/src/vm/assembly.cpp#L1804 and  at this point).

[Milestone = 3.0]",area-System.Threading,kouvel,,
17821,Adding back test for windows event log,This test was added with https://github.com/dotnet/coreclr/pull/17401 but had to be removed in https://github.com/dotnet/coreclr/pull/17482 because the tests were failing. Fixed it by allowing more leeway in checking for timestamps in the event log entries and moving the test dependency into Common directory instead of the test itself.,Adding back test for windows event log This test was added with https://github.com/dotnet/coreclr/pull/17401 but had to be removed in https://github.com/dotnet/coreclr/pull/17482 because the tests were failing. Fixed it by allowing more leeway in checking for timestamps in the event log entries and moving the test dependency into Common directory instead of the test itself.,,sywhang,,
17818,Post-2.1 plan of Intel hardware intrinsic,"1. Refine the API design of Intel hardware intrinsic
    - related issues/PRs: https://github.com/dotnet/coreclr/pull/17637 https://github.com/dotnet/corefx/issues/29247
2. Implement remaining AVX2 intrinsic [rely on (1)]
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/16653
3. Implement remaining SSE4.2 intrinsic [rely on (1)]
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/16270
4. Enable containment analysis on more hardware intrinsic forms (e.g. imm 1-arg 3-arg etc.)
5. Implement FMA intrinsic [rely on (4)]
    - FMA intrinsic codegen is different from other ISAs whose instruction selection depends on the operator's position (e.g. in registers or memory?)
6. Implement other ISA classes ()
    - fully support all the Intel hardware intrinsic of existing APIs 
7. Create non-trivial benchmarks for Intel hardware intrinsic
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/17798
8. Improve the CQ of Intel hardware intrinsic base-on key scenarios [partially rely on (7)]
    - especially when intrinsics are used in combination or with things like Vectors and identify areas that need work.
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/17073 https://github.com/dotnet/coreclr/issues/17108
9. Investigate the JIT throughput impact from hardware intrinsic recognition [rely on (7)]
    - related discussion: https://github.com/dotnet/coreclr/pull/14020#issuecomment-331611668
10. Identify candidates that can be optimized using HW intrinsics and implement them using intrinsics (CoreFX mscorlib HPC ML etc.)
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/15506 https://github.com/dotnet/corefx/issues/25386
11. more...

category:cq
theme:intrinsics
skill-level:intermediate
cost:extra-large","Post-2.1 plan of Intel hardware intrinsic 1. Refine the API design of Intel hardware intrinsic
    - related issues/PRs: https://github.com/dotnet/coreclr/pull/17637 https://github.com/dotnet/corefx/issues/29247
2. Implement remaining AVX2 intrinsic [rely on (1)]
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/16653
3. Implement remaining SSE4.2 intrinsic [rely on (1)]
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/16270
4. Enable containment analysis on more hardware intrinsic forms (e.g. imm 1-arg 3-arg etc.)
5. Implement FMA intrinsic [rely on (4)]
    - FMA intrinsic codegen is different from other ISAs whose instruction selection depends on the operator's position (e.g. in registers or memory?)
6. Implement other ISA classes ()
    - fully support all the Intel hardware intrinsic of existing APIs 
7. Create non-trivial benchmarks for Intel hardware intrinsic
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/17798
8. Improve the CQ of Intel hardware intrinsic base-on key scenarios [partially rely on (7)]
    - especially when intrinsics are used in combination or with things like Vectors and identify areas that need work.
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/17073 https://github.com/dotnet/coreclr/issues/17108
9. Investigate the JIT throughput impact from hardware intrinsic recognition [rely on (7)]
    - related discussion: https://github.com/dotnet/coreclr/pull/14020#issuecomment-331611668
10. Identify candidates that can be optimized using HW intrinsics and implement them using intrinsics (CoreFX mscorlib HPC ML etc.)
    - related issues/PRs: https://github.com/dotnet/coreclr/issues/15506 https://github.com/dotnet/corefx/issues/25386
11. more...

category:cq
theme:intrinsics
skill-level:intermediate
cost:extra-large",Design Discussion,CarolEidt,28/04/2018 4:10,11/01/2019 21:24
17816,ResourceManager doesn't take the SatelliteContractVersion attribute into account,"I have a third-party .NET Standard 2.0 class library built with MSBuild via VisualStudio. The library has the SatelliteContractVersion attribute. The corresponding satellite assembly with localization resources has an assembly version that differs from the main library's assembly version.
The main assembly is loaded successfully by the .NET Framework 4.6.1 and .NET Core framework. But the satellite assembly is loaded only if an application that uses the library is built with .NET Framework 4.6.1. 
 
The issue occurs in .NET Core because the ResourceManager.GetSatelliteContractVersion() method always returns the 'null' value. So the ResourceManager in .NET Core ignores the version of the satellite assembly which is specified in the SatelliteContractVersion attribute of the main assembly. Instead the ResourceManager tries to load the satellite assembly with the version specified in the AssemblyVersion attribute of the main assembly.

For example the following attributes are applied to the assembly:
- [assembly: AssemblyVersion(""1.2.3.4"")]
- [assembly: SatelliteContractVersion(""1.2.0.0"")]

After building using MSBuild the following assemblies are created:
- a main assembly ""A.dll"" with version 1.2.3.4;
- a satellite assembly ""A.resources.dll"" with version 1.2.0.0.

.NET Core framework loads assembly ""A.dll"" with version 1.2.3.4 and tries to load the ""A.resource.dll"" assembly with version 1.2.3.4.

.NET Framework 4.6.1 loads assembly ""A.dll"" with version 1.2.3.4 and tries to load the ""A.resouces.dll"" assembly with version 1.2.0.0.

The issue leads to different behavior if the existing libraries with the SatelliteContractVersionAttribute are built by MSBuild in .NET Framework applications and .NET Core applications.","ResourceManager doesn't take the SatelliteContractVersion attribute into account I have a third-party .NET Standard 2.0 class library built with MSBuild via VisualStudio. The library has the SatelliteContractVersion attribute. The corresponding satellite assembly with localization resources has an assembly version that differs from the main library's assembly version.
The main assembly is loaded successfully by the .NET Framework 4.6.1 and .NET Core framework. But the satellite assembly is loaded only if an application that uses the library is built with .NET Framework 4.6.1. 
 
The issue occurs in .NET Core because the ResourceManager.GetSatelliteContractVersion() method always returns the 'null' value. So the ResourceManager in .NET Core ignores the version of the satellite assembly which is specified in the SatelliteContractVersion attribute of the main assembly. Instead the ResourceManager tries to load the satellite assembly with the version specified in the AssemblyVersion attribute of the main assembly.

For example the following attributes are applied to the assembly:
- [assembly: AssemblyVersion(""1.2.3.4"")]
- [assembly: SatelliteContractVersion(""1.2.0.0"")]

After building using MSBuild the following assemblies are created:
- a main assembly ""A.dll"" with version 1.2.3.4;
- a satellite assembly ""A.resources.dll"" with version 1.2.0.0.

.NET Core framework loads assembly ""A.dll"" with version 1.2.3.4 and tries to load the ""A.resource.dll"" assembly with version 1.2.3.4.

.NET Framework 4.6.1 loads assembly ""A.dll"" with version 1.2.3.4 and tries to load the ""A.resouces.dll"" assembly with version 1.2.0.0.

The issue leads to different behavior if the existing libraries with the SatelliteContractVersionAttribute are built by MSBuild in .NET Framework applications and .NET Core applications.",area-AssemblyLoader,jkotas,28/04/2018 1:38,16/03/2019 15:30
17815,HW intrinsics shouldn't assert for unsupported,"For example here:
https://github.com/dotnet/coreclr/blob/master/src/jit/hwintrinsicxarch.cpp#L816
As described in the comments for https://github.com/dotnet/coreclr/pull/17737 this can lead to an assert in the case where the user knows the path will not be taken. Such cases should simply return  so that the IL method will be invoked.

category:correctness
theme:intrinsics
skill-level:beginner
cost:small","HW intrinsics shouldn't assert for unsupported For example here:
https://github.com/dotnet/coreclr/blob/master/src/jit/hwintrinsicxarch.cpp#L816
As described in the comments for https://github.com/dotnet/coreclr/pull/17737 this can lead to an assert in the case where the user knows the path will not be taken. Such cases should simply return  so that the IL method will be invoked.

category:correctness
theme:intrinsics
skill-level:beginner
cost:small",arch-x64,CarolEidt,,
17812,Whether to support.Net native and how to use it,"Whether to support.Net native and how to use the .net native，
thank you","Whether to support.Net native and how to use it Whether to support.Net native and how to use the .net native，
thank you",question,jkotas,27/04/2018 22:10,27/04/2018 22:37
17810,Test failure: Interop_StructPacking._StructPacking_StructPacking_/_StructPacking_StructPacking_cmd,"Opened on behalf of @Sunny-pu

The test 
        
Build : Master - 20180427.01 (Core Tests)
Failing configurations:
- redhat.69.amd64-x64
  - 

Details:
https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180427.01/workItem/Interop.StructPacking.XUnitWrapper/analysis/xunit/Interop_StructPacking._StructPacking_StructPacking_~2F_StructPacking_StructPacking_cmd","Test failure: Interop_StructPacking._StructPacking_StructPacking_/_StructPacking_StructPacking_cmd Opened on behalf of @Sunny-pu

The test 
        
Build : Master - 20180427.01 (Core Tests)
Failing configurations:
- redhat.69.amd64-x64
  - 

Details:
https://mc.dot.net/#/product/netcore/master/source/official~2Fcoreclr~2Fmaster~2F/type/test~2Ffunctional~2Fcli~2F/build/20180427.01/workItem/Interop.StructPacking.XUnitWrapper/analysis/xunit/Interop_StructPacking._StructPacking_StructPacking_~2F_StructPacking_StructPacking_cmd",area-Infrastructure-coreclr,RussKeldorph,27/04/2018 18:49,23/05/2019 4:09
17809,Request safe non-allocation bit converter between value type and byte array,"I always face some needs like write some value type to a chunk of memory (and read back) byte by byte.
But there is no way to write a struct or struct array to an existing byte array for now except the unsafe pointer way.

Add APIs like below will be a big help:

public static void Write< T >(Span< T > elem Span< byte >)where T:struct
public static void Read< T >(Span< T > elem Span< byte >)where T:struct","Request safe non-allocation bit converter between value type and byte array I always face some needs like write some value type to a chunk of memory (and read back) byte by byte.
But there is no way to write a struct or struct array to an existing byte array for now except the unsafe pointer way.

Add APIs like below will be a big help:

public static void Write< T >(Span< T > elem Span< byte >)where T:struct
public static void Read< T >(Span< T > elem Span< byte >)where T:struct",area-System.Memory,jkotas,27/04/2018 17:02,27/04/2018 22:44
17807,Add runtimeconfig.json support for tiered compilation,Previously this feature could only be enabled via COMPLUS_TieredCompilation variable. Now it can also be enabled from configProperties in the runtimeconfig.json.,Add runtimeconfig.json support for tiered compilation Previously this feature could only be enabled via COMPLUS_TieredCompilation variable. Now it can also be enabled from configProperties in the runtimeconfig.json.,area-TieredCompilation,dotnet-bot,27/04/2018 14:36,1/05/2018 6:40
17805,Floating point formatting changed 2.0 -> 2.1,"Repro:



.NET Core 2.0: -122.194458007813
.NET Core 2.1: -122.194458007812

Reported by @mjsabby @ Bing","Floating point formatting changed 2.0 -> 2.1 Repro:



.NET Core 2.0: -122.194458007813
.NET Core 2.1: -122.194458007812

Reported by @mjsabby @ Bing",area-System.Runtime,mjsabby,27/04/2018 11:42,28/04/2018 3:24
17804,Add better portable PDB caching to System.Diagnostics.StackTrace.,This is the mscorlib/System.Private.CoreLib side of the change.,Add better portable PDB caching to System.Diagnostics.StackTrace. This is the mscorlib/System.Private.CoreLib side of the change.,area-Diagnostics,mikem8361,,
17801,[arm32] corefx System.Security.Cryptography.X509Certificates.Tests failures,"Windows/arm32 corefx System.Security.Cryptography.X509Certificates.Tests failure with COMPlus_JitStressRegs=0x1000 or COMPlus_JitStressRegs=3 or COMPlus_JitMinOpts=1

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstressregs0x1000_tst/12/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstressregs3_tst/12/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_minopts_tst/11/consoleText


","[arm32] corefx System.Security.Cryptography.X509Certificates.Tests failures Windows/arm32 corefx System.Security.Cryptography.X509Certificates.Tests failure with COMPlus_JitStressRegs=0x1000 or COMPlus_JitStressRegs=3 or COMPlus_JitMinOpts=1

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstressregs0x1000_tst/12/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstressregs3_tst/12/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_minopts_tst/11/consoleText


",arch-arm32,echesakovMSFT,,
17800,[WIP] Move Concurrent collections into shared,"cc: @safern @danmosemsft @jkotas 

corefx PR: dotnet/corefx#29356

Fixes coreclr issue: #17751 ","[WIP] Move Concurrent collections into shared cc: @safern @danmosemsft @jkotas 

corefx PR: dotnet/corefx#29356

Fixes coreclr issue: #17751 ",area-System.Collections,maryamariyan,,
17799,[arm32] corefx System.Diagnostics.PerformanceCounter.Tests failure,"arm32/Windows corefx test System.Diagnostics.PerformanceCounter.Tests fails:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/14/consoleText

","[arm32] corefx System.Diagnostics.PerformanceCounter.Tests failure arm32/Windows corefx test System.Diagnostics.PerformanceCounter.Tests fails:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/14/consoleText

",arch-arm32,BruceForstall,27/04/2018 9:08,28/04/2018 5:51
17798,Port RayTracer benchmark to SoA algorithm using Vector128/256<T>,"The current SIMD benchmark [RayTracer](https://github.com/dotnet/coreclr/tree/master/tests/src/JIT/Performance/CodeQuality/SIMD/RayTracer) is using .

cc @CarolEidt @tannergooding @AndyAyersMS @jkotas 
","Port RayTracer benchmark to SoA algorithm using Vector128/256<T> The current SIMD benchmark [RayTracer](https://github.com/dotnet/coreclr/tree/master/tests/src/JIT/Performance/CodeQuality/SIMD/RayTracer) is using .

cc @CarolEidt @tannergooding @AndyAyersMS @jkotas 
",arch-x64,fiigii,,
17797,RyuJIT: Add side effect flag checking to LIR::Range::CheckLIR(),"We check for correctness of side effect flags in fgDebugCheckFlags. We should do that for LIR as well in LIR::Range::CheckLIR().

There is a fundamental difference between side-effects in HIR and LIR in that the flags on a node do not need to be a summary of that node's side effects along with those of its operands: instead the flags for a node should reflect only that node's side effects.

category:correctness
theme:ir
skill-level:intermediate
cost:medium","RyuJIT: Add side effect flag checking to LIR::Range::CheckLIR() We check for correctness of side effect flags in fgDebugCheckFlags. We should do that for LIR as well in LIR::Range::CheckLIR().

There is a fundamental difference between side-effects in HIR and LIR in that the flags on a node do not need to be a summary of that node's side effects along with those of its operands: instead the flags for a node should reflect only that node's side effects.

category:correctness
theme:ir
skill-level:intermediate
cost:medium",area-CodeGen,erozenfeld,,
17796,RyuJIT: Improve checking of GTF_ORDER_SIDEEFF flags,"#13668 enabled strict checking of GTF_EXCEPT and GTF_ASG flags in fgDebugCheckFlags.
The same should be done for GTF_ORDER_SIDEEFF flags.

category:correctness
theme:ir
skill-level:intermediate
cost:medium","RyuJIT: Improve checking of GTF_ORDER_SIDEEFF flags #13668 enabled strict checking of GTF_EXCEPT and GTF_ASG flags in fgDebugCheckFlags.
The same should be done for GTF_ORDER_SIDEEFF flags.

category:correctness
theme:ir
skill-level:intermediate
cost:medium",area-CodeGen,erozenfeld,,
17795,RyuJIT: Improve checking of GTF_GLOB_REF flags,"#13668 enabled strict checking of GTF_EXCEPT and GTF_ASG flags in fgDebugCheckFlags.
The same should be done for GTF_GLOB_REF flags.

category:correctness
theme:ir
skill-level:intermediate
cost:medium","RyuJIT: Improve checking of GTF_GLOB_REF flags #13668 enabled strict checking of GTF_EXCEPT and GTF_ASG flags in fgDebugCheckFlags.
The same should be done for GTF_GLOB_REF flags.

category:correctness
theme:ir
skill-level:intermediate
cost:medium",area-CodeGen,erozenfeld,,
17794,RyuJIT: Improve checking of GTF_CALL flag,"#13668 enabled strict checking of GTF_EXCEPT and GTF_ASG flags in fgDebugCheckFlags.
The same should be done for GTF_CALL flags.
","RyuJIT: Improve checking of GTF_CALL flag #13668 enabled strict checking of GTF_EXCEPT and GTF_ASG flags in fgDebugCheckFlags.
The same should be done for GTF_CALL flags.
",area-CodeGen,erozenfeld,,
17790,ICLRRuntimeHost2，is it multithread  safe？,"ICLRRuntimeHost2，is it multithread  safe？
thank you","ICLRRuntimeHost2，is it multithread  safe？ ICLRRuntimeHost2，is it multithread  safe？
thank you",question,RussKeldorph,26/04/2018 23:03,27/04/2018 22:35
17789,[local gc] fix com interop issues on local gc,See https://github.com/dotnet/coreclr/blob/54bdc1681c08cf9230561733d4728bc13cbc494e/src/gc/objecthandle.cpp#L451-L467 ,[local gc] fix com interop issues on local gc See https://github.com/dotnet/coreclr/blob/54bdc1681c08cf9230561733d4728bc13cbc494e/src/gc/objecthandle.cpp#L451-L467 ,area-GC,davmason,,
17787,AF: WaitAll for multiple handles on a STA thread,"Example:
.

Is it something expected? Found during work on #17585.
","AF: WaitAll for multiple handles on a STA thread Example:
.

Is it something expected? Found during work on #17585.
",area-System.Threading,kouvel,,
17783,Publish release/uwp6.0 and release/uwp6.1 symbols Publish symbols using Microsoft.SymbolUploader.Build.Task package,See https://github.com/dotnet/coreclr/issues/16482. This tracks porting infrastructure to the  branches.,Publish release/uwp6.0 and release/uwp6.1 symbols Publish symbols using Microsoft.SymbolUploader.Build.Task package See https://github.com/dotnet/coreclr/issues/16482. This tracks porting infrastructure to the  branches.,area-Infrastructure-coreclr,RussKeldorph,26/04/2018 7:38,
17782,XPlat C# Debugger is failing to show Async Callstack frames,Found by @chuckries during scenario testing.,XPlat C# Debugger is failing to show Async Callstack frames Found by @chuckries during scenario testing.,area-Diagnostics,chuckries,,
17778,release/uwp6.0 and release/uwp6.1 long-name DAC/SOS have incorrect version,"See https://github.com/dotnet/coreclr/issues/17619. The long-name DAC/SOS aren't indexed properly because the DLLs have the wrong name in the symbol packages.

~~The same~~ A similar problem to  (expected)

https://github.com/dotnet/coreclr/blob/9afe551aa13b52d7ebca9aeed1da97edc51b843f/src/.nuget/Microsoft.NETCore.Runtime.CoreCLR/runtime.Windows_NT.Microsoft.NETCore.Runtime.CoreCLR.props#L9-L10

https://github.com/dotnet/coreclr/blob/25c45ac5da9e2f709be7b8fb115e116d3ae44ac4/src/.nuget/Microsoft.NETCore.Runtime.CoreCLR/runtime.Windows_NT.Microsoft.NETCore.Runtime.CoreCLR.props#L9-L10

These branches should be fixed before they're next released or there will have to be more manual fix-ups on the symbol packages for the long-name DAC/SOS files. @nattress @zamont do you know the status of these CoreCLR branches?

/cc @lt72 @mikem8361 @leculver @weshaggard ","release/uwp6.0 and release/uwp6.1 long-name DAC/SOS have incorrect version See https://github.com/dotnet/coreclr/issues/17619. The long-name DAC/SOS aren't indexed properly because the DLLs have the wrong name in the symbol packages.

~~The same~~ A similar problem to  (expected)

https://github.com/dotnet/coreclr/blob/9afe551aa13b52d7ebca9aeed1da97edc51b843f/src/.nuget/Microsoft.NETCore.Runtime.CoreCLR/runtime.Windows_NT.Microsoft.NETCore.Runtime.CoreCLR.props#L9-L10

https://github.com/dotnet/coreclr/blob/25c45ac5da9e2f709be7b8fb115e116d3ae44ac4/src/.nuget/Microsoft.NETCore.Runtime.CoreCLR/runtime.Windows_NT.Microsoft.NETCore.Runtime.CoreCLR.props#L9-L10

These branches should be fixed before they're next released or there will have to be more manual fix-ups on the symbol packages for the long-name DAC/SOS files. @nattress @zamont do you know the status of these CoreCLR branches?

/cc @lt72 @mikem8361 @leculver @weshaggard ",area-Diagnostics,nattress,26/04/2018 6:01,
17777,Fix IMPL_LIMITATION on Struct LclVar Offsets for 64-bit targets,"The emitter has a  which has  a limitation on offset values for large LclVars numbers (above 32767)   For our 64-bit targets we can use some extra bits to eliminate this limiation.
","Fix IMPL_LIMITATION on Struct LclVar Offsets for 64-bit targets The emitter has a  which has  a limitation on offset values for large LclVars numbers (above 32767)   For our 64-bit targets we can use some extra bits to eliminate this limiation.
",area-CodeGen,briansull,,
17775,Fix instruction groups offset on the border between cold/hot code.,"Fixes DevDiv_601045; assert while generating diffs:
https://github.com/dotnet/coreclr/blob/71f4199f7dd043c4901a187b9bd88ab40e2b87e2/src/jit/emit.cpp#L7185

I was not able to repro the original issue on Core and it did not allow me to go back and find when the desktop issue appeared. The new checks show that the problem exists in CoreCLR as well.

The fix doesn't change the generated code (it changes only unused allocated parts) and doesn't cause any diffs.

The important changes are in the fourth commit.","Fix instruction groups offset on the border between cold/hot code. Fixes DevDiv_601045; assert while generating diffs:
https://github.com/dotnet/coreclr/blob/71f4199f7dd043c4901a187b9bd88ab40e2b87e2/src/jit/emit.cpp#L7185

I was not able to repro the original issue on Core and it did not allow me to go back and find when the desktop issue appeared. The new checks show that the problem exists in CoreCLR as well.

The fix doesn't change the generated code (it changes only unused allocated parts) and doesn't cause any diffs.

The important changes are in the fourth commit.",area-CodeGen,sandreenko,26/04/2018 4:13,20/06/2018 11:02
17772,Use of created nested types in dynamic assembly builders cause TypeLoadExceptions,"When attempting to generate a dynamic type that contains a nested type use of the type to generate fields on the parent type fails with a [TypeLoadException][exception] if the type has been realized using 

[repro-project]: https://github.com/dotnet/core/files/1947057/Scratchpad.zip
[exception]: https://gist.github.com/Nihlus/63eb35f3ee3a2f38456002c60bb5d057","Use of created nested types in dynamic assembly builders cause TypeLoadExceptions When attempting to generate a dynamic type that contains a nested type use of the type to generate fields on the parent type fails with a [TypeLoadException][exception] if the type has been realized using 

[repro-project]: https://github.com/dotnet/core/files/1947057/Scratchpad.zip
[exception]: https://gist.github.com/Nihlus/63eb35f3ee3a2f38456002c60bb5d057",area-System.Reflection,RussKeldorph,25/04/2018 23:12,
17771,[local gc] enable AnalyzeSurvivorsRequested and DACNotifyGcMarkEnd ,AnalyzeSurvivorsRequested and DACNotifyGcMarkEnd are disabled for local gc because they require GCnotifications which doesn't currently work across the GC interface,[local gc] enable AnalyzeSurvivorsRequested and DACNotifyGcMarkEnd  AnalyzeSurvivorsRequested and DACNotifyGcMarkEnd are disabled for local gc because they require GCnotifications which doesn't currently work across the GC interface,area-GC,davmason,,
17770,[local gc] enable use of NumaNodeInfo for local gc and PAL,Right now we skip NumaNodeInfo for local gc and pal. See virtual_alloc_commit_for_heap in gc.cpp.,[local gc] enable use of NumaNodeInfo for local gc and PAL Right now we skip NumaNodeInfo for local gc and pal. See virtual_alloc_commit_for_heap in gc.cpp.,area-GC,davmason,25/04/2018 17:46,
17768,Delete InternalsVisibleTo attributes from S.P.CoreLib,"https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/mscorlib.Friends.cs

There attributes are needed for WinRT interop on Windows today. They prevent ILLinker from stripping unreachable code from S.P.CoreLib.

Fixing this should reduce size of S.P.CoreLib IL image by ~80kB.","Delete InternalsVisibleTo attributes from S.P.CoreLib https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/mscorlib.Friends.cs

There attributes are needed for WinRT interop on Windows today. They prevent ILLinker from stripping unreachable code from S.P.CoreLib.

Fixing this should reduce size of S.P.CoreLib IL image by ~80kB.",area-Meta-corelib,jkotas,25/04/2018 13:19,17/07/2018 3:27
17767,Fix AsyncLocal<class> changed event to not be raised multiple times for one change in value,Functional fix for https://github.com/dotnet/coreclr/issues/17758,Fix AsyncLocal<class> changed event to not be raised multiple times for one change in value Functional fix for https://github.com/dotnet/coreclr/issues/17758,area-System.Threading,kouvel,,
17760,Server GC is set with different env vars across platforms,"On Unix we set server gc by setting 

We should try to make these into one variable that works across all platforms. ","Server GC is set with different env vars across platforms On Unix we set server gc by setting 

We should try to make these into one variable that works across all platforms. ",area-GC,sywhang,,
17759,Add tests for arm64 il issues.,"The PR adds tests that are failing in our internal test system with arm64 altjit.
Failures are:

","Add tests for arm64 il issues. The PR adds tests that are failing in our internal test system with arm64 altjit.
Failures are:

",arch-arm64,sandreenko,25/04/2018 7:36,15/05/2018 6:29
17758,AsyncLocal<class> changed event can be raised multiple times for one change in value," the key not existing means it will add a new change notification. So each transition of an AsyncLocal<class>'s value from null to non-null will add an additional change notification. The fix would probably be to keep the key in the IAsyncLocalValueMap despite its value becoming null.

The issue currently requires two AsyncLocals to reproduce because [for the first AsyncLocal](https://github.com/dotnet/coreclr/blob/master/src/mscorlib/shared/System/Threading/ExecutionContext.cs#L337) it does not consider whether the new value is null as opposed to AsyncLocalValueMap's implementation.

CC @stephentoub ","AsyncLocal<class> changed event can be raised multiple times for one change in value  the key not existing means it will add a new change notification. So each transition of an AsyncLocal<class>'s value from null to non-null will add an additional change notification. The fix would probably be to keep the key in the IAsyncLocalValueMap despite its value becoming null.

The issue currently requires two AsyncLocals to reproduce because [for the first AsyncLocal](https://github.com/dotnet/coreclr/blob/master/src/mscorlib/shared/System/Threading/ExecutionContext.cs#L337) it does not consider whether the new value is null as opposed to AsyncLocalValueMap's implementation.

CC @stephentoub ",area-System.Threading,kouvel,,
17756,[arm32/Ubuntu][JitStressRegs] corefx System.Net.NameResolution.Functional.Tests failures,"With JitStressRegs=0x10

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x10_tst_prtest/1/consoleText


","[arm32/Ubuntu][JitStressRegs] corefx System.Net.NameResolution.Functional.Tests failures With JitStressRegs=0x10

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstressregs0x10_tst_prtest/1/consoleText


",JitStress,CarolEidt,,
17755,[arm32/Ubuntu][JitStress] corefx System.Runtime.Tests times out,"With JitStress=1 or JitStress=2 the test times out (or hangs):



https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress1_tst_prtest/1/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress2_tst_prtest/1/consoleText","[arm32/Ubuntu][JitStress] corefx System.Runtime.Tests times out With JitStress=1 or JitStress=2 the test times out (or hangs):



https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress1_tst_prtest/1/consoleText
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_jitstress2_tst_prtest/1/consoleText",JitStress,echesakovMSFT,,
17754,[arm32/Ubuntu] corefx test timeouts,"The following tests time out (with 10 minute default timeout) in a corefx test run:



e.g.

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/1/consoleText
","[arm32/Ubuntu] corefx test timeouts The following tests time out (with 10 minute default timeout) in a corefx test run:



e.g.

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/1/consoleText
",arch-arm32,echesakovMSFT,,
17753,[arm32/Ubuntu] corefx test failures: System.Net.NetworkInformation.Functional.Tests System.Net.Sockets.Tests,"These tests:


have segmentation faults in the corefx test run e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/1/consoleText
","[arm32/Ubuntu] corefx test failures: System.Net.NetworkInformation.Functional.Tests, System.Net.Sockets.Tests These tests:


have segmentation faults in the corefx test run e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/1/consoleText
",arch-arm32,echesakovMSFT,,
17751,Move Concurrent collections into shared,"These seem like they can be reconciled 


Usual procedure is 
1. Upgrade CoreCLR versions to have functionality of CoreFX ones. This may mean just copying over the CoreFX ones. Move to C:\git\coreclr\src\mscorlib\shared\System\Collections\Concurrent
1. Prepare a PR in CoreFX that deletes the 4 files there and instead pulls them from C:\git\corefx\src\Common\src\CoreLib\System\Collections\Concurrent
1. When mirror brings those files merge the PR.

@maryamariyan ","Move Concurrent collections into shared These seem like they can be reconciled 


Usual procedure is 
1. Upgrade CoreCLR versions to have functionality of CoreFX ones. This may mean just copying over the CoreFX ones. Move to C:\git\coreclr\src\mscorlib\shared\System\Collections\Concurrent
1. Prepare a PR in CoreFX that deletes the 4 files there and instead pulls them from C:\git\corefx\src\Common\src\CoreLib\System\Collections\Concurrent
1. When mirror brings those files merge the PR.

@maryamariyan ",area-System.Collections,maryamariyan,,
17748,WIP NO MERGE dummy change,,WIP NO MERGE dummy change ,* NO MERGE *,BruceForstall,24/04/2018 11:04,26/04/2018 2:02
17745,Delete unused tests\arm64\fails.testlist,The original issue #9481 was closed long time ago.,Delete unused tests\arm64\fails.testlist The original issue #9481 was closed long time ago.,arch-arm64,sandreenko,24/04/2018 10:19,25/04/2018 8:42
17744,GC test failures in checked outerloop job,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/checked_windows_nt/9461/consoleText

Looks like these started failing after #17680.

@sywhang 

","GC test failures in checked outerloop job https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/checked_windows_nt/9461/consoleText

Looks like these started failing after #17680.

@sywhang 

",test bug,sywhang,,
17741,ICorProfiler retrieve function arguments in JitCompilationStarted,"I've seen this done before but for the life of me I'm having trouble finding a function's arguments when my ICorProfiler profiler's JitCompilationStarted event is called. I've got the  but I don't have the actual arguments being passed in the function.

Is there an interface method I can call to get them?

thanks.","ICorProfiler retrieve function arguments in JitCompilationStarted I've seen this done before but for the life of me I'm having trouble finding a function's arguments when my ICorProfiler profiler's JitCompilationStarted event is called. I've got the  but I don't have the actual arguments being passed in the function.

Is there an interface method I can call to get them?

thanks.",area-Diagnostics,RussKeldorph,24/04/2018 8:37,3/01/2019 9:54
17740,[arm32] corefx System.Net.NameResolution.Pal.Tests fails,"https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/3/consoleText


","[arm32] corefx System.Net.NameResolution.Pal.Tests fails https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/3/consoleText


",arch-arm32,BruceForstall,24/04/2018 7:46,24/04/2018 9:47
17739,[arm32] corefx System.Net.Http.Functional.Tests fails,"60 failures in this test suite:

https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/3/consoleText

Some seem like timeout (which is probably just too tight):

","[arm32] corefx System.Net.Http.Functional.Tests fails 60 failures in this test suite:

https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/3/consoleText

Some seem like timeout (which is probably just too tight):

",arch-arm32,BruceForstall,24/04/2018 7:44,24/04/2018 9:47
17738,[arm32] Compiler optimization assumption invalid: FAILED: pMgr != 0,"In the corefx tests System.Linq.Expressions.Tests:

https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/3/consoleText


","[arm32] Compiler optimization assumption invalid: FAILED: pMgr != 0 In the corefx tests System.Linq.Expressions.Tests:

https://ci.dot.net/job/dotnet_coreclr/job/dev_unix_test_workflow/job/jitstress/job/arm_cross_checked_ubuntu_corefx_baseline_tst_prtest/3/consoleText


",arch-arm32,BruceForstall,,
17736,headers to use when porting Profiler from windows to linux,"I have a CLR profiler that supports dotnet core 2.0 on Windows. Now i wish to port it to build and work on  Linux. I think i need some guidance on what are the best practices and/or an relatively realistic example.

I had started my research based on a sample dotnet core profiler written by MS folks:
https://github.com/Microsoft/clr-samples/tree/master/ProfilingAPI/ReJITEnterLeaveHooks
(recommended starting point as is stated in this issue: https://github.com/dotnet/coreclr/issues/14786). 

This Sample Profiler uses **PAL** and uses ). what headers/Compilation flags should i use  so the types of the Profiler can be the same as in the CoreCLR. It feels like the Profiler writer has to carefully arrange those include headers but i have no clue how?  OR i guess it might be helpful if someone explains in general how the Profiling Interface piece in CLR is built if the Profiler should be doing the same?

","headers to use when porting Profiler from windows to linux I have a CLR profiler that supports dotnet core 2.0 on Windows. Now i wish to port it to build and work on  Linux. I think i need some guidance on what are the best practices and/or an relatively realistic example.

I had started my research based on a sample dotnet core profiler written by MS folks:
https://github.com/Microsoft/clr-samples/tree/master/ProfilingAPI/ReJITEnterLeaveHooks
(recommended starting point as is stated in this issue: https://github.com/dotnet/coreclr/issues/14786). 

This Sample Profiler uses **PAL** and uses ). what headers/Compilation flags should i use  so the types of the Profiler can be the same as in the CoreCLR. It feels like the Profiler writer has to carefully arrange those include headers but i have no clue how?  OR i guess it might be helpful if someone explains in general how the Profiling Interface piece in CLR is built if the Profiler should be doing the same?

",area-Diagnostics,RussKeldorph,24/04/2018 2:28,24/04/2018 23:58
17735,[Question] R2R and version bubbles,"As I understand the main motivation to create Ready To Run mode of crossgen is making native images are more independent from runtime change. What is the current state of it? Should we regenerate application native images in case of updating runtime or system libraries (of course I mean case when API isn't changed)?

Second question is about version bubbles. As I see from source code (https://github.com/dotnet/coreclr/blob/master/src/vm/jitinterface.cpp#L654) . Are there any plans to implement this concept?
What projects will needed changes to support this? Except CoreCLR I think compiler should know about bubbles. Are there any other projects?

cc @jkotas @BruceForstall @gbalykov ","[Question] R2R and version bubbles As I understand the main motivation to create Ready To Run mode of crossgen is making native images are more independent from runtime change. What is the current state of it? Should we regenerate application native images in case of updating runtime or system libraries (of course I mean case when API isn't changed)?

Second question is about version bubbles. As I see from source code (https://github.com/dotnet/coreclr/blob/master/src/vm/jitinterface.cpp#L654) . Are there any plans to implement this concept?
What projects will needed changes to support this? Except CoreCLR I think compiler should know about bubbles. Are there any other projects?

cc @jkotas @BruceForstall @gbalykov ",area-ReadyToRun,jkotas,24/04/2018 2:05,5/05/2018 2:36
17733,Expand GT_JCC/SETCC condition support,"Currently GT_JCC/SETCC nodes use relops as condition codes and this prevents the use of flag specific conditions (e.g. S NS P NP) and floating point conditions. Additionally the code used by GT_JTRUE and relop codegen is rather convoluted and not very easy to reuse for GT_JCC/SETCC codegen.

This changes GT_JCC/SETCC's condition to  can be removed.

Contributes to #17073","Expand GT_JCC/SETCC condition support Currently GT_JCC/SETCC nodes use relops as condition codes and this prevents the use of flag specific conditions (e.g. S NS P NP) and floating point conditions. Additionally the code used by GT_JTRUE and relop codegen is rather convoluted and not very easy to reuse for GT_JCC/SETCC codegen.

This changes GT_JCC/SETCC's condition to  can be removed.

Contributes to #17073",area-CodeGen,dotnet-bot,24/04/2018 1:18,11/01/2019 11:29
17732,Enable Invoke and GetValue for ref-returning members,"https://github.com/dotnet/corefx/issues/15960

(Attempt #2)

Returned magic object is the object pointed to by
the ref. If the ref is null NullReferenceException.

","Enable Invoke and GetValue for ref-returning members https://github.com/dotnet/corefx/issues/15960

(Attempt #2)

Returned magic object is the object pointed to by
the ref. If the ref is null NullReferenceException.

",area-System.Reflection,,,
26685,Requesting support for Linux-ARM w/ 16 FPU registers,"Hi

Our Business Units widely use ARM based CPU to develop hardware solutions for automation and energy management.

We appreciate Microsoft’s decision to support native .Net Core deployment for linux-arm target. We have positive results of self-contained deployments for Cortex-A9 based devices. It’ll really speed up development-to-deployment-to-market process.

During one of our POC projects we’ve identified that some of chips (e.q. RZ/N1D) extensively used by our BU aren’t compatible with current linux-arm runtime and generate “Illegal Instruction” exception.

Further investigation revealed very simple but critical incompatibility: this chip’s FPU includes only 16 double-precision registers. Seems like simple change of cross-compiler option from vfpv3 to vfpv3-d16 [or vfpv4-d16] to generate runtime libraries should solve this problem. 

An alternative solution would be to support linux-armel target i.e. do not use Floating Point Unit at all though the previously outlined solution would be preferable.

Would you please consider building and including runtime specific packages for linux-arm-VFPv4-d16 and/or linux-armel devices. 

","Requesting support for Linux-ARM w/ 16 FPU registers Hi

Our Business Units widely use ARM based CPU to develop hardware solutions for automation and energy management.

We appreciate Microsoft’s decision to support native .Net Core deployment for linux-arm target. We have positive results of self-contained deployments for Cortex-A9 based devices. It’ll really speed up development-to-deployment-to-market process.

During one of our POC projects we’ve identified that some of chips (e.q. RZ/N1D) extensively used by our BU aren’t compatible with current linux-arm runtime and generate “Illegal Instruction” exception.

Further investigation revealed very simple but critical incompatibility: this chip’s FPU includes only 16 double-precision registers. Seems like simple change of cross-compiler option from vfpv3 to vfpv3-d16 [or vfpv4-d16] to generate runtime libraries should solve this problem. 

An alternative solution would be to support linux-armel target i.e. do not use Floating Point Unit at all though the previously outlined solution would be preferable.

Would you please consider building and including runtime specific packages for linux-arm-VFPv4-d16 and/or linux-armel devices. 

",area-CodeGen,richlander,23/04/2018 22:49,
17731,C++ calls.Netcore through coreclr,"Hi
https://docs.microsoft.com/en-us/dotnet/core/tutorials/netcore-hosting
In accordance with this document I call the.Netcore class library through the coreclr host when I execute it.
CreateDelegate function times error error: the given assembly name or base code is invalid.","C++ calls.Netcore through coreclr Hi
https://docs.microsoft.com/en-us/dotnet/core/tutorials/netcore-hosting
In accordance with this document I call the.Netcore class library through the coreclr host when I execute it.
CreateDelegate function times error error: the given assembly name or base code is invalid.",area-AssemblyLoader,jkotas,23/04/2018 14:25,2/05/2018 1:49
17724,Fix FakePromote assert,"This assert was firing when there was a struct with explicit layout and
two byref fields overlapping each other. The assert was checking that
the respective location on the stack was not reported yet.
To fix that I have changed the assert to fire only if the already
reported kind of reference was different from the current one. That
enables overlapping of two byref fields or two ref fields but not a
byref and ref fields.

Close #17565","Fix FakePromote assert This assert was firing when there was a struct with explicit layout and
two byref fields overlapping each other. The assert was checking that
the respective location on the stack was not reported yet.
To fix that I have changed the assert to fire only if the already
reported kind of reference was different from the current one. That
enables overlapping of two byref fields or two ref fields but not a
byref and ref fields.

Close #17565",area-CrossGen/NGEN,janvorli,,
17716,GC crash in Kestrel Libuv and Sockets FunctionalTests/netcoreapp2.1,"_From @mikeharder on April 18 2018 18:42_

Kestrel FunctionalTests are hanging frequently on CI:

# KestrelHttpServer

http://aspnetci/viewLog.html?buildId=449994&tab=buildLog&buildTypeId=Lite_KestrelStressTest&logTab=tail

_Copied from original issue: aspnet/KestrelHttpServer#2503_","GC crash in Kestrel Libuv and Sockets FunctionalTests/netcoreapp2.1 _From @mikeharder on April 18 2018 18:42_

Kestrel FunctionalTests are hanging frequently on CI:

# KestrelHttpServer

http://aspnetci/viewLog.html?buildId=449994&tab=buildLog&buildTypeId=Lite_KestrelStressTest&logTab=tail

_Copied from original issue: aspnet/KestrelHttpServer#2503_",area-GC,jkotas,,
17714,[release/2.1] Port Preserve pinned flag in {ReadOnly}Memory<T>.Slice,"Fixes https://github.com/dotnet/corefx/issues/29239 (from https://github.com/dotnet/coreclr/pull/17712)

cc @joshfree @GrabYourPitchforks @geoffkizer @stephentoub @benaadams @davidfowl  ","[release/2.1] Port Preserve pinned flag in {ReadOnly}Memory<T>.Slice Fixes https://github.com/dotnet/corefx/issues/29239 (from https://github.com/dotnet/coreclr/pull/17712)

cc @joshfree @GrabYourPitchforks @geoffkizer @stephentoub @benaadams @davidfowl  ",area-System.Memory,ahsonkhan,,
17712,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,ahsonkhan,,
17711,Fix getting the Absolute path while looking up the TZ files,"We used to call Path.Combine and passing 2 file paths (and not really a directory paths) which always produced a wrong full path. This causes us to always go and enumerate TZ files and compare the content of each file to the current TZ data we have. So this should speed up the TZ creation on Linux as we'll not enumerate the TZ files. 

Also this will fix getting the correct Id of the TZ. for example when trying to get the Iran time zone currently we'll get the Id= ""Iran"" as this is the TZ file name. while after the fix we'll get the correct Id= ""Asia/Tehran"" ","Fix getting the Absolute path while looking up the TZ files We used to call Path.Combine and passing 2 file paths (and not really a directory paths) which always produced a wrong full path. This causes us to always go and enumerate TZ files and compare the content of each file to the current TZ data we have. So this should speed up the TZ creation on Linux as we'll not enumerate the TZ files. 

Also this will fix getting the correct Id of the TZ. for example when trying to get the Iran time zone currently we'll get the Id= ""Iran"" as this is the TZ file name. while after the fix we'll get the correct Id= ""Asia/Tehran"" ",area-System.Runtime,tarekgh,,
17709,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,ahsonkhan,,
17706,[x86|Windows|Full Framework|NativeVararg] Passing an eight byte struct of long,"c#


","[x86|Windows|Full Framework|NativeVararg] Passing an eight byte struct of long c#


",area-CodeGen,pgavlin,21/04/2018 5:08,21/04/2018 12:31
17704,[x86|Windows|Full Framework| NativeVararg] Passing a double after an int/long results in bad codegen,"C#


","[x86|Windows|Full Framework| NativeVararg] Passing a double after an int/long results in bad codegen C#


",area-CodeGen,jashook,21/04/2018 5:04,21/04/2018 12:31
17703,[x64|Windows|Full Framework] Passing 32 byte struct of four doubles with native varargs results in bad codegen,"c#



Note this is may be related to #17702.
","[x64|Windows|Full Framework] Passing 32 byte struct of four doubles with native varargs results in bad codegen c#



Note this is may be related to #17702.
",area-CodeGen,jashook,21/04/2018 4:40,21/04/2018 5:10
17702,[x86|x64|Windows|Full Framework|NativeVararg] Passing 16 byte struct of two longs results in bad codegen,"C#



Note this fails on x86 as well as x64 but may be two separate issues.","[x86|x64|Windows|Full Framework|NativeVararg] Passing 16 byte struct of two longs results in bad codegen C#



Note this fails on x86 as well as x64 but may be two separate issues.",area-CodeGen,pgavlin,21/04/2018 4:30,2/05/2018 8:26
17701,System.Diagnostics.StackTrace slow on .NET Core,"Consider the following program:


","System.Diagnostics.StackTrace slow on .NET Core Consider the following program:


",area-Diagnostics,mikem8361,,
17698,"corefx test failure: Assert failure: !""You cannot use this function for arbitrary value types. You must preallocate a box object and copy the value in yourself.""","https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/462/consoleText

many tests fail with:


Also seen on ARM.
","corefx test failure: Assert failure: !""You cannot use this function for arbitrary value types. You must preallocate a box object and copy the value in yourself."" https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_corefx_baseline/462/consoleText

many tests fail with:


Also seen on ARM.
",bug,BruceForstall,21/04/2018 2:43,21/04/2018 3:24
17695,Question about typeforwarding public types,"I have an executable named .


","Question about typeforwarding public types I have an executable named .


",area-TypeSystem,jkotas,20/04/2018 17:17,21/04/2018 3:19
17694,Account for copied bytes in struct copy loop when generating GT_PUTARG_STK code [ARM64],"When generating code for a GT_PUTARG_STK where there's an HFA struct being passed on the stack we have a loop that copies the struct 16 bytes at a time with ldp/stp. However in the case where we have a var node for the struct we weren't increasing the offset of the ldp to account for the portion of the struct we've already copied. Thus a struct with size 16*_n_ would just end up having _n_ copies of its first 16 bytes.

The fix is simple: instead of hardcoding the offset to 0 when we emit the ldp we set it to be the number of bytes we've copied which is conveniently already captured for us in .

@BruceForstall @jkotas @janvorli ","Account for copied bytes in struct copy loop when generating GT_PUTARG_STK code [ARM64] When generating code for a GT_PUTARG_STK where there's an HFA struct being passed on the stack we have a loop that copies the struct 16 bytes at a time with ldp/stp. However in the case where we have a var node for the struct we weren't increasing the offset of the ldp to account for the portion of the struct we've already copied. Thus a struct with size 16*_n_ would just end up having _n_ copies of its first 16 bytes.

The fix is simple: instead of hardcoding the offset to 0 when we emit the ldp we set it to be the number of bytes we've copied which is conveniently already captured for us in .

@BruceForstall @jkotas @janvorli ",arch-arm64,BruceForstall,20/04/2018 12:23,27/04/2018 3:40
17693,[clrdbg] Add support for inline values,"VSCode Debugger Protocol now supports inline values for variables when debugging. It would be great if vsdbg/vsdbg-ui adds support for this.

Debugger Protocol:
[https://github.com/Microsoft/vscode-debugadapter-node/issues/78](url)
[https://github.com/Microsoft/vscode-debugadapter-node/blob/896566e0be3f48e5cf90fb715b3b3ffbfa777888/protocol/src/debugProtocol.ts#L1329-L1337](url)

VSCode Support:
[https://github.com/Microsoft/vscode/pull/16129](url)","[clrdbg] Add support for inline values VSCode Debugger Protocol now supports inline values for variables when debugging. It would be great if vsdbg/vsdbg-ui adds support for this.

Debugger Protocol:
[https://github.com/Microsoft/vscode-debugadapter-node/issues/78](url)
[https://github.com/Microsoft/vscode-debugadapter-node/blob/896566e0be3f48e5cf90fb715b3b3ffbfa777888/protocol/src/debugProtocol.ts#L1329-L1337](url)

VSCode Support:
[https://github.com/Microsoft/vscode/pull/16129](url)",area-Diagnostics,RussKeldorph,20/04/2018 12:12,21/04/2018 10:53
17692,Mscordbi uses incorrect layout for MDInternalRW.,Mscordbi uses incorrect layout for MDInternalRW when marshaling to Target_MDInternalRW in a couple of places. Specifically for Target_RecordPool (aligned to 4 bytes on Linux rather than 8) and Target_MapSHash (don't need to skip a byte at the beginning of struct on Linux). The mismatch causes CordbModule::GetMetadataInterface to fail for dump debugging on Linux.,Mscordbi uses incorrect layout for MDInternalRW. Mscordbi uses incorrect layout for MDInternalRW when marshaling to Target_MDInternalRW in a couple of places. Specifically for Target_RecordPool (aligned to 4 bytes on Linux rather than 8) and Target_MapSHash (don't need to skip a byte at the beginning of struct on Linux). The mismatch causes CordbModule::GetMetadataInterface to fail for dump debugging on Linux.,area-Diagnostics,mikem8361,,
17691,Fix SSE2 SetZeroVector128 on float type,"fix https://github.com/dotnet/coreclr/issues/17689

@CarolEidt PTAL","Fix SSE2 SetZeroVector128 on float type fix https://github.com/dotnet/coreclr/issues/17689

@CarolEidt PTAL",area-CodeGen,CarolEidt,20/04/2018 10:42,6/08/2018 18:40
17689,[RyuJIT] SSE2 SetZeroVector128 does not support float base type ,. ,[RyuJIT] SSE2 SetZeroVector128 does not support float base type  . ,area-CodeGen,fiigii,,
17687,Lower memory usage expected?,"On the reliability testing we are doing in the aspnet team I noticed a drop in memory usage around April 11-12. Is this something that could be explained by Server GC changes?

| OS | Before (MB) | After (MB) | Delta |
| -- | -- | -- | -- |
| Linux | 430 | 360 |  -27% |
| Windows | 345 | 245 | -29% |

This graph show the Windows consumption overtime. The application was the same the load constant. Only ASP.NET and the runtime were updated. (MVC + EF + Razor). CPU usage remained constant.

![image](https://user-images.githubusercontent.com/1165805/39024187-0436c0d8-43f4-11e8-82ff-6d30b7e07985.png)

If this is not expected I might be able to run the app with the version that were used and get some dumps/traces. It can also be related to changes in other repos but I am trying here first.","Lower memory usage, expected? On the reliability testing we are doing in the aspnet team I noticed a drop in memory usage around April 11-12. Is this something that could be explained by Server GC changes?

| OS | Before (MB) | After (MB) | Delta |
| -- | -- | -- | -- |
| Linux | 430 | 360 |  -27% |
| Windows | 345 | 245 | -29% |

This graph show the Windows consumption overtime. The application was the same the load constant. Only ASP.NET and the runtime were updated. (MVC + EF + Razor). CPU usage remained constant.

![image](https://user-images.githubusercontent.com/1165805/39024187-0436c0d8-43f4-11e8-82ff-6d30b7e07985.png)

If this is not expected I might be able to run the app with the version that were used and get some dumps/traces. It can also be related to changes in other repos but I am trying here first.",area-GC,RussKeldorph,20/04/2018 10:17,21/04/2018 5:14
17684,Updating coreclr toolset,"For non-Windows builds we generally build with clang 3.9 though for arm32 we build with clang 5.0 and at least in the CI arm64 builds with clang 3.8.

Should these all be updated to something consistent and newer e.g. clang 6.0?

What is the process for making this decision and making it happen?

@RussKeldorph @janvorli @jkotas ","Updating coreclr toolset For non-Windows builds we generally build with clang 3.9 though for arm32 we build with clang 5.0 and at least in the CI arm64 builds with clang 3.8.

Should these all be updated to something consistent and newer e.g. clang 6.0?

What is the process for making this decision and making it happen?

@RussKeldorph @janvorli @jkotas ",area-Infrastructure-coreclr,RussKeldorph,20/04/2018 8:33,12/11/2019 4:57
17682,Make intra-build containers private,,Make intra-build containers private ,,weshaggard,,
17680,Fix GC tests that contain GC.Collect() used in wrong scope,This same fix has been made in #17656 and #17594. I went through all the GC tests and fixed places where we observe a similar issue. Note that most of these tests don't necessarily depend on this fix since the JIT won't inline methods / extend lifetime of temps for most of these tests but wanted to fix these before we see more test failures coming from the various scenarios these tests will be running against. ,Fix GC tests that contain GC.Collect() used in wrong scope This same fix has been made in #17656 and #17594. I went through all the GC tests and fixed places where we observe a similar issue. Note that most of these tests don't necessarily depend on this fix since the JIT won't inline methods / extend lifetime of temps for most of these tests but wanted to fix these before we see more test failures coming from the various scenarios these tests will be running against. ,,sywhang,,
17679,Fatal error reporting deadlocks with GC,"Found while investigating https://github.com/aspnet/KestrelHttpServer/issues/2503

From Maoni:

This is an age old problem…managed heap corruption causes exception triggered on the GC thread which then needs to wait for GC so deadlock…looping in Noah. He did some work to accommodate I believe.

","Fatal error reporting deadlocks with GC Found while investigating https://github.com/aspnet/KestrelHttpServer/issues/2503

From Maoni:

This is an age old problem…managed heap corruption causes exception triggered on the GC thread which then needs to wait for GC so deadlock…looping in Noah. He did some work to accommodate I believe.

",area-Diagnostics,sywhang,,
17678,WIP Test all jitting at tier 1,,WIP Test all jitting at tier 1 ,* NO MERGE *,kouvel,,
17677,Fix nested spin locks in thread pool etw firing,"

Nesting spin locks is not allowed moved the ETW firing outside the lock.","Fix nested spin locks in thread pool etw firing 

Nesting spin locks is not allowed moved the ETW firing outside the lock.",area-System.Threading,kouvel,,
17676,[arm] Warnings with crossgen generating S.P.C.dll,"The following warnings are seen in the build:

","[arm] Warnings with crossgen generating S.P.C.dll The following warnings are seen in the build:

",arch-arm32,BruceForstall,20/04/2018 4:20,20/04/2018 8:35
17674,LSRA: Don't change register assignments for def/use conflicts,"Currently  that remains live (e.g. a lclVar) it will be unnecessarily killed. 

category:correctness
theme:register-allocator
skill-level:expert
cost:small","LSRA: Don't change register assignments for def/use conflicts Currently  that remains live (e.g. a lclVar) it will be unnecessarily killed. 

category:correctness
theme:register-allocator
skill-level:expert
cost:small",area-CodeGen,RussKeldorph,20/04/2018 3:20,
17673,Treat EDI as killed by MaskMove,It should really only be a fixed reference not a kill but if the reference is changed by  it can fail to cause the value in EDI to be killed.,Treat EDI as killed by MaskMove It should really only be a fixed reference not a kill but if the reference is changed by  it can fail to cause the value in EDI to be killed.,area-CodeGen,dotnet-bot,20/04/2018 3:15,21/04/2018 14:10
17670,Undoing boxing doesn't work with C# 7 pattern matching,"Short version: I was reading @stephentoub's article [*Performance Improvements in .NET Core 2.1*](https://blogs.msdn.microsoft.com/dotnet/2018/04/18/performance-improvements-in-net-core-2-1/). I noticed that his example for avoiding boxing allocations thanks to https://github.com/dotnet/coreclr/pull/14698 uses .

The two versions of the code do the same thing so I think they should have comparable performance. Especially since the pattern matching version is more readable and I suspect it's also going to be more common in new code than the other version.

How hard would it be to make this optimization work even in the pattern matching version?

If it would be too hard to perform this optimization in the JIT is there a reasonable way for the C# compiler to emit IL that would be optmized?

cc (?): @AndyAyersMS @benaadams @justinvp

category:cq
theme:importer
skill-level:expert
cost:medium","Undoing boxing doesn't work with C# 7 pattern matching Short version: I was reading @stephentoub's article [*Performance Improvements in .NET Core 2.1*](https://blogs.msdn.microsoft.com/dotnet/2018/04/18/performance-improvements-in-net-core-2-1/). I noticed that his example for avoiding boxing allocations thanks to https://github.com/dotnet/coreclr/pull/14698 uses .

The two versions of the code do the same thing so I think they should have comparable performance. Especially since the pattern matching version is more readable and I suspect it's also going to be more common in new code than the other version.

How hard would it be to make this optimization work even in the pattern matching version?

If it would be too hard to perform this optimization in the JIT is there a reasonable way for the C# compiler to emit IL that would be optmized?

cc (?): @AndyAyersMS @benaadams @justinvp

category:cq
theme:importer
skill-level:expert
cost:medium",area-CodeGen,stephentoub,20/04/2018 1:44,
17669,There is something fishy going on with CLRVectoredExceptionHandler/DontCallDirectlyForceStackOverflow,"At the ISV I work for we have been getting some strange crashes from our C++ application recently with the following ""signature"": our process crashed because of a (recursive) stack overflow but the actual exception was an access violation and not a stack overflow.

This suggests that the guard area on the stack was committed and that extra stack space provided by the guard area also ran out. I confirmed this by looking at some minidumps with the  again
- this causes an unrecoverable access violation

I have the following questions:

1. What are you trying to achieve with committing the guard area?
Are you trying to make more space for handling the exception? What kind of handling? This might be a bit stubborn on my side but I'd think that if you reach the point on the stack when the guard area ""can't slide upwards anymore"" that's a stack overflow by definition and you shouldn't be doing anything other than maybe reporting and tearing down the process.
2. Do you know of any scenario where you commit the guard area but swallow/survive the exception?
I'm looking for an explanation of our ""original"" scenario where the stack overflow manifests in an access violation with no apparent sight of a 3rd party module/component (such as clr.dll).
3. Are there any guidelines/recommendations on living together with a mixed DLL in the same process?

I don't know if this is relevant but on all of our threads we set the stack guarantee to 5 pages (20'480).

If you'd like to have a closer look at this I can provide you with minidumps (on some private channel).

Thanks!","There is something fishy going on with CLRVectoredExceptionHandler/DontCallDirectlyForceStackOverflow At the ISV I work for we have been getting some strange crashes from our C++ application recently with the following ""signature"": our process crashed because of a (recursive) stack overflow but the actual exception was an access violation and not a stack overflow.

This suggests that the guard area on the stack was committed and that extra stack space provided by the guard area also ran out. I confirmed this by looking at some minidumps with the  again
- this causes an unrecoverable access violation

I have the following questions:

1. What are you trying to achieve with committing the guard area?
Are you trying to make more space for handling the exception? What kind of handling? This might be a bit stubborn on my side but I'd think that if you reach the point on the stack when the guard area ""can't slide upwards anymore"" that's a stack overflow by definition and you shouldn't be doing anything other than maybe reporting and tearing down the process.
2. Do you know of any scenario where you commit the guard area but swallow/survive the exception?
I'm looking for an explanation of our ""original"" scenario where the stack overflow manifests in an access violation with no apparent sight of a 3rd party module/component (such as clr.dll).
3. Are there any guidelines/recommendations on living together with a mixed DLL in the same process?

I don't know if this is relevant but on all of our threads we set the stack guarantee to 5 pages (20'480).

If you'd like to have a closer look at this I can provide you with minidumps (on some private channel).

Thanks!",area-ExceptionHandling,RussKeldorph,20/04/2018 1:03,9/05/2018 19:32
17666,Azure Sphere Support,Understanding [Azure Sphere](https://azure.microsoft.com/en-us/blog/introducing-microsoft-azure-sphere-secure-and-power-the-intelligent-edge/) has not even been released yet I was wondering if .NET Core will be supported?,Azure Sphere Support Understanding [Azure Sphere](https://azure.microsoft.com/en-us/blog/introducing-microsoft-azure-sphere-secure-and-power-the-intelligent-edge/) has not even been released yet I was wondering if .NET Core will be supported?,area-Meta,richlander,,
17665,[Arm64] Use proper lowering for TYP_SIMD8/TYP_LONG type,"Not sure if this function call (FixupIfSIMDLocal) is needed for ARM64.
@CarolEidt @sdmaclea PTAL.

Removing the FixupIfSIMDLocal() in Rationalizer  fixes the SIMD assertion error seen with JITMinOpts=1 (Ref #17111 ) for type TYP_SIMD8 below.

Assert failure(PID 9366 [0x00002496] Thread: 9366 [0x2496]): Assertion failed '(consume > 1) || (regType(store->gtOp1->TypeGet()) == regType(store->TypeGet()))' in 'Arm64intrisicsTest.Program:testBinOp(refrefref)' (IL size 408)
File: /home/debayan/coreclr/src/jit/lsrabuild.cpp Line: 1383

","[Arm64] Use proper lowering for TYP_SIMD8/TYP_LONG type Not sure if this function call (FixupIfSIMDLocal) is needed for ARM64.
@CarolEidt @sdmaclea PTAL.

Removing the FixupIfSIMDLocal() in Rationalizer  fixes the SIMD assertion error seen with JITMinOpts=1 (Ref #17111 ) for type TYP_SIMD8 below.

Assert failure(PID 9366 [0x00002496] Thread: 9366 [0x2496]): Assertion failed '(consume > 1) || (regType(store->gtOp1->TypeGet()) == regType(store->TypeGet()))' in 'Arm64intrisicsTest.Program:testBinOp(refrefref)' (IL size 408)
File: /home/debayan/coreclr/src/jit/lsrabuild.cpp Line: 1383

",arch-arm64,CarolEidt,19/04/2018 20:49,30/07/2019 4:27
17663,Remove debug/checked builds,The debug/checked builds don't publish and aren't submitted for testing currently.  To reduce resource usage during the build do not build these pipelines for now.,Remove debug/checked builds The debug/checked builds don't publish and aren't submitted for testing currently.  To reduce resource usage during the build do not build these pipelines for now.,area-Infrastructure-coreclr,mmitche,19/04/2018 13:30,20/04/2018 5:55
17661,MediaType.GetHashCode() throws System.ExecutionEngineException,"_From @austindrenski on April 17 2018 20:49_



_Copied from original issue: aspnet/Mvc#7673_","MediaType.GetHashCode() throws System.ExecutionEngineException _From @austindrenski on April 17 2018 20:49_



_Copied from original issue: aspnet/Mvc#7673_",,jkotas,,
17657,Port to 2.1: Fix ephemeral limits checks in write barrier for ARM64,"The code was incorrectly using signed conditions which doesn't work for
server GC where the high ephemeral limit is 0xffffffffffffffff and so it
was checking if the address is less than -1 which is never the case. So
the card table was never updated.","Port to 2.1: Fix ephemeral limits checks in write barrier for ARM64 The code was incorrectly using signed conditions which doesn't work for
server GC where the high ephemeral limit is 0xffffffffffffffff and so it
was checking if the address is less than -1 which is never the case. So
the card table was never updated.",arch-arm64,janvorli,,
17656,Fix GC leakwheel scenario test,Related to #16061 - JIT may extend the lifetime of the object causing some objects to not get added to finalizer queue. This should at least stabilize the CI part but I'm not sure why calling GC.Collect(2) and GC.WaitForPendingFinalizers() 3 times instead of 2 should do any change in behavior. Will look into that part and follow up with subsequent fixes if I find anything.,Fix GC leakwheel scenario test Related to #16061 - JIT may extend the lifetime of the object causing some objects to not get added to finalizer queue. This should at least stabilize the CI part but I'm not sure why calling GC.Collect(2) and GC.WaitForPendingFinalizers() 3 times instead of 2 should do any change in behavior. Will look into that part and follow up with subsequent fixes if I find anything.,,sywhang,,
17654,[Arm64/Linux] #16962 Broke arm64 crosscomponent build,#NAME?,"[Arm64/Linux] #16962 Broke arm64 crosscomponent build @CarolEidt 
cc/ @weshaggard ",arch-arm64,CarolEidt,,
17653,GCStress: force fully interruptible GC info,"Does the JIT have a stress mode that forces fully interruptible GC info?

An interesting stress mode would be:
1. GCStress=4
2. ZapDisable=1
3. force fully interruptible GC info


category:correctness
theme:testing
skill-level:beginner
cost:small","GCStress: force fully interruptible GC info Does the JIT have a stress mode that forces fully interruptible GC info?

An interesting stress mode would be:
1. GCStress=4
2. ZapDisable=1
3. force fully interruptible GC info


category:correctness
theme:testing
skill-level:beginner
cost:small",GCStress,BruceForstall,19/04/2018 5:49,
17651,GCStress: instrumented instructions only force a GC once,"One possible limitation of GCStress today is that each instruction is instrumented and stressed only once. After GC is run on an instrumented instruction that instrumented instruction is replaced by its original instruction so it never triggers a GC again. This means if a hole exists at an instruction but isn't triggered by the first run of the instruction we will miss it. This was potentially the case with the JIT creating illegal byrefs fixed by https://github.com/dotnet/coreclr/pull/17524.

Possibly introduce a (super slow) mode where we don't replace the instrumented instructions by their original instructions or not immediately. Or periodically re-instrument functions.","GCStress: instrumented instructions only force a GC once One possible limitation of GCStress today is that each instruction is instrumented and stressed only once. After GC is run on an instrumented instruction that instrumented instruction is replaced by its original instruction so it never triggers a GC again. This means if a hole exists at an instruction but isn't triggered by the first run of the instruction we will miss it. This was potentially the case with the JIT creating illegal byrefs fixed by https://github.com/dotnet/coreclr/pull/17524.

Possibly introduce a (super slow) mode where we don't replace the instrumented instructions by their original instructions or not immediately. Or periodically re-instrument functions.",GCStress,BruceForstall,19/04/2018 5:48,
17650,[Arm64/Linux] Enable crosscomponent build in CI,#16962 Broke arm64 crosscomponent build.  It would be better to catch these earlier during build.  This would also provide some JIT testing as the S.P.C.dll will be crossgened,[Arm64/Linux] Enable crosscomponent build in CI #16962 Broke arm64 crosscomponent build.  It would be better to catch these earlier during build.  This would also provide some JIT testing as the S.P.C.dll will be crossgened,,sdmaclea,,
17649,GCStress: ensure every object moves on a GC,"At least every object that is legal to move should move.

One problem with GCStress today is that when a GC occurs most of the time (in some measurement I've done) objects don't actually move. This means that bad GC info doesn't get noticed.
","GCStress: ensure every object moves on a GC At least every object that is legal to move should move.

One problem with GCStress today is that when a GC occurs most of the time (in some measurement I've done) objects don't actually move. This means that bad GC info doesn't get noticed.
",GCStress,BruceForstall,19/04/2018 4:46,
17647,GcStress: need some way to verify that all expected methods get instrumented,"In the instrumenting GC stress modes we should introduce some mechanism to verify that all the methods we expect to get instrumented actually do end up getting instrumented. Otherwise we risk losing stress coverage.

Because un-instrumented methods won't provoke additional GCs the fact that they are not instrumented tends to be hard to observe.","GcStress: need some way to verify that all expected methods get instrumented In the instrumenting GC stress modes we should introduce some mechanism to verify that all the methods we expect to get instrumented actually do end up getting instrumented. Otherwise we risk losing stress coverage.

Because un-instrumented methods won't provoke additional GCs the fact that they are not instrumented tends to be hard to observe.",GCStress,AndyAyersMS,19/04/2018 4:34,
17646,GcStress: handle rejitting ,"Rejitted code is currently not getting instrumented for GC stress.

Since the original code is still viable we can't simply clear/clobber the  field in the MethodDescriptor on a rejit -- instead we need a way of having a code version specific set of GcCover infos for a method.

Similar issues likely apply to profiler-initiated rejitting.

cc @noahfalk 

","GcStress: handle rejitting  Rejitted code is currently not getting instrumented for GC stress.

Since the original code is still viable we can't simply clear/clobber the  field in the MethodDescriptor on a rejit -- instead we need a way of having a code version specific set of GcCover infos for a method.

Similar issues likely apply to profiler-initiated rejitting.

cc @noahfalk 

",GCStress,kouvel,,
17645,GcStress: choose strategy for instrumenting prejitted code,"GcStress currently tries to instrument NGEN precompiled methods twice: once during  (with a twist for prejitted IL stubs).

R2R precompiled methods are never instrumented currently.

Seems like we should have only one strategy and it should apply to all cases of prejitted code.

Early instrumentation during module load is nice because it avoids race conditions that can plague on-demand instrumentation. But there is an upfront cost as potentially thousands of methods need to be instrumented but only a few of them will ever be executed.

Late instrumentation is more pay for play but must be done carefully so that no thread can see a partially instrumented method.","GcStress: choose strategy for instrumenting prejitted code GcStress currently tries to instrument NGEN precompiled methods twice: once during  (with a twist for prejitted IL stubs).

R2R precompiled methods are never instrumented currently.

Seems like we should have only one strategy and it should apply to all cases of prejitted code.

Early instrumentation during module load is nice because it avoids race conditions that can plague on-demand instrumentation. But there is an upfront cost as potentially thousands of methods need to be instrumented but only a few of them will ever be executed.

Late instrumentation is more pay for play but must be done carefully so that no thread can see a partially instrumented method.",GCStress,AndyAyersMS,19/04/2018 4:26,
17644,port #17618 to the 2.1 branch (Disable timeout test),"disable DevDiv_255294 in stress modes. (PR to master #17618 issue #17605) 

It is a test only change.","port #17618 to the 2.1 branch (Disable timeout test) disable DevDiv_255294 in stress modes. (PR to master #17618 issue #17605) 

It is a test only change.",disabled-test,sandreenko,19/04/2018 4:26,22/04/2018 0:14
17641,Fix ephemeral limits checks in write barrier for ARM64,"The code was incorrectly using signed conditions which doesn't work for
server GC where the high ephemeral limit is 0xffffffffffffffff and so it
was checking if the address is less than -1 which is never the case. So
the card table was never updated.

Close #17640","Fix ephemeral limits checks in write barrier for ARM64 The code was incorrectly using signed conditions which doesn't work for
server GC where the high ephemeral limit is 0xffffffffffffffff and so it
was checking if the address is less than -1 which is never the case. So
the card table was never updated.

Close #17640",arch-arm64,janvorli,,
17640,Wrong check of ephemeral limits in JIT_WriteBarrier for ARM64,"The code is incorrectly using signed comparison which doesn't work for
server GC where the high ephemeral limit is 0xffffffffffffffff and so it
is checking if the address is less than -1 which is never the case. So
the card table is never updated.","Wrong check of ephemeral limits in JIT_WriteBarrier for ARM64 The code is incorrectly using signed comparison which doesn't work for
server GC where the high ephemeral limit is 0xffffffffffffffff and so it
is checking if the address is less than -1 which is never the case. So
the card table is never updated.",arch-arm64,janvorli,,
17639,Enable Invoke and GetValue for ref-returning members,"https://github.com/dotnet/corefx/issues/15960

Returned magic object is the object pointed to by
the ref. If the ref is null NullReferenceException.","Enable Invoke and GetValue for ref-returning members https://github.com/dotnet/corefx/issues/15960

Returned magic object is the object pointed to by
the ref. If the ref is null NullReferenceException.",area-System.Reflection,,,
17637,Improve Intel hardware intrinsic APIs,"This PR
1. fixes https://github.com/dotnet/coreclr/issues/17058 and temporarily disables AVX MaskLoad test cases.
2. <del>encodes the result flags in the names of certain SSE4.2 string processing intrinsic. That provides more stable runtime behaviors and simplifies JIT implementation discussed in https://github.com/dotnet/coreclr/issues/16270</del>
3. Fixes SSE4.1  return type to reflect the underlying instruction behavior closes https://github.com/dotnet/coreclr/issues/17957

@CarolEidt @tannergooding @eerhardt ","Improve Intel hardware intrinsic APIs This PR
1. fixes https://github.com/dotnet/coreclr/issues/17058 and temporarily disables AVX MaskLoad test cases.
2. <del>encodes the result flags in the names of certain SSE4.2 string processing intrinsic. That provides more stable runtime behaviors and simplifies JIT implementation discussed in https://github.com/dotnet/coreclr/issues/16270</del>
3. Fixes SSE4.1  return type to reflect the underlying instruction behavior closes https://github.com/dotnet/coreclr/issues/17957

@CarolEidt @tannergooding @eerhardt ",area-CodeGen,CarolEidt,18/04/2018 19:17,19/06/2018 6:17
17634,[x86/Windows] Failure in jitstress=2 jitstressregs=3 job,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_jitstress2_jitstressregs3/473/consoleText

BEGIN EXECUTION
         ""D:\j\workspace\x86_checked_w---508bfa85\tests\..\bin\tests\Windows_NT.x86.Checked\Tests\Core_Root\corerun.exe"" MaskMove_r.exe 
        Expected: 100
        Actual: 73294136
        END EXECUTION - FAILED
        FAILED
        Test Harness Exitcode is : 1
        
  To run the test:
  > set CORE_ROOT=D:\j\workspace\x86_checked_w---508bfa85\bin\tests\Windows_NT.x86.Checked\Tests\Core_Root
  > D:\j\workspace\x86_checked_w---508bfa85\bin\tests\Windows_NT.x86.Checked\JIT\HardwareIntrinsics\X86\Sse2\MaskMove_r\MaskMove_r.cmd
  
        Expected: True
        Actual:   False","[x86/Windows] Failure in jitstress=2 jitstressregs=3 job https://ci.dot.net/job/dotnet_coreclr/job/master/view/x86/job/jitstress/job/x86_checked_windows_nt_jitstress2_jitstressregs3/473/consoleText

BEGIN EXECUTION
         ""D:\j\workspace\x86_checked_w---508bfa85\tests\..\bin\tests\Windows_NT.x86.Checked\Tests\Core_Root\corerun.exe"" MaskMove_r.exe 
        Expected: 100
        Actual: 73294136
        END EXECUTION - FAILED
        FAILED
        Test Harness Exitcode is : 1
        
  To run the test:
  > set CORE_ROOT=D:\j\workspace\x86_checked_w---508bfa85\bin\tests\Windows_NT.x86.Checked\Tests\Core_Root
  > D:\j\workspace\x86_checked_w---508bfa85\bin\tests\Windows_NT.x86.Checked\JIT\HardwareIntrinsics\X86\Sse2\MaskMove_r\MaskMove_r.cmd
  
        Expected: True
        Actual:   False",JitStress,CarolEidt,,
17632,[x64/Windows] waitone2 test failures,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_windows_nt_jitstress1/491/consoleText

BEGIN EXECUTION
         ""D:\j\workspace\x64_checked_w---02832afb\tests\..\bin\tests\Windows_NT.x64.Checked\Tests\Core_Root\corerun.exe"" waitone2.exe 
        Beginning test case MutexWaitOne2 at 4/16/2018 7:33:49 PM
        Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
        
        [Positive]
        Beginning scenario: PosTest1: Wait Infinite
        Beginning scenario: PosTest2: Wait some finite time
        Beginning scenario: PosTest3: Wait some finite time will quit for timeout
        ERROR!!!-004: WaitOne returns true when wait time out
        Beginning scenario: PosTest4: Wait some finite time will quit for timeout when another thread is in nondefault managed context
        Beginning scenario: PosTest5: Wait some finite time will quit for timeout when another thread is in nondefault managed context
        Beginning scenario: PosTest6: Wait infinite time when another thread is in nondefault managed context
        Beginning scenario: PosTest7: Wait infinite time when another thread is in nondefault managed context
        [Negative]
        Beginning scenario: NegTest1: AbandonedMutexException should be thrown if a thread exited without releasing a mutex
        Beginning scenario: NegTest2: ObjectDisposedException should be thrown if current instance has already been disposed
        Beginning scenario: NegTest3: Check ArgumentOutOfRangeException will be thrown if millisecondsTimeout is a negative number other than -1
        
        Ending test case at 4/16/2018 7:34:22 PM
        FAIL
        Expected: 100
        Actual: 0
        END EXECUTION - FAILED
        FAILED
        Test Harness Exitcode is : 1
        
  To run the test:
  > set CORE_ROOT=D:\j\workspace\x64_checked_w---02832afb\bin\tests\Windows_NT.x64.Checked\Tests\Core_Root
  > D:\j\workspace\x64_checked_w---02832afb\bin\tests\Windows_NT.x64.Checked\baseservices\threading\mutex\misc\waitone2\waitone2.cmd
  
        Expected: True
        Actual:   False","[x64/Windows] waitone2 test failures https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_windows_nt_jitstress1/491/consoleText

BEGIN EXECUTION
         ""D:\j\workspace\x64_checked_w---02832afb\tests\..\bin\tests\Windows_NT.x64.Checked\Tests\Core_Root\corerun.exe"" waitone2.exe 
        Beginning test case MutexWaitOne2 at 4/16/2018 7:33:49 PM
        Random seed: 20010415; set environment variable CORECLR_SEED to this value to repro
        
        [Positive]
        Beginning scenario: PosTest1: Wait Infinite
        Beginning scenario: PosTest2: Wait some finite time
        Beginning scenario: PosTest3: Wait some finite time will quit for timeout
        ERROR!!!-004: WaitOne returns true when wait time out
        Beginning scenario: PosTest4: Wait some finite time will quit for timeout when another thread is in nondefault managed context
        Beginning scenario: PosTest5: Wait some finite time will quit for timeout when another thread is in nondefault managed context
        Beginning scenario: PosTest6: Wait infinite time when another thread is in nondefault managed context
        Beginning scenario: PosTest7: Wait infinite time when another thread is in nondefault managed context
        [Negative]
        Beginning scenario: NegTest1: AbandonedMutexException should be thrown if a thread exited without releasing a mutex
        Beginning scenario: NegTest2: ObjectDisposedException should be thrown if current instance has already been disposed
        Beginning scenario: NegTest3: Check ArgumentOutOfRangeException will be thrown if millisecondsTimeout is a negative number other than -1
        
        Ending test case at 4/16/2018 7:34:22 PM
        FAIL
        Expected: 100
        Actual: 0
        END EXECUTION - FAILED
        FAILED
        Test Harness Exitcode is : 1
        
  To run the test:
  > set CORE_ROOT=D:\j\workspace\x64_checked_w---02832afb\bin\tests\Windows_NT.x64.Checked\Tests\Core_Root
  > D:\j\workspace\x64_checked_w---02832afb\bin\tests\Windows_NT.x64.Checked\baseservices\threading\mutex\misc\waitone2\waitone2.cmd
  
        Expected: True
        Actual:   False",area-System.Threading,erozenfeld,18/04/2018 10:06,
17631,[x64/Windows] Failure in heapverify=1 job,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_windows_nt_heapverify1/73/consoleText

BEGIN EXECUTION
         ""D:\j\workspace\x64_checked_w---facfb6a0\tests\..\bin\tests\Windows_NT.x64.Checked\Tests\Core_Root\corerun.exe"" unregister03.exe 
        Test Failed
        Expected: 100
        Actual: 0
        END EXECUTION - FAILED
        FAILED
        Test Harness Exitcode is : 1
        
  To run the test:
  > set CORE_ROOT=D:\j\workspace\x64_checked_w---facfb6a0\bin\tests\Windows_NT.x64.Checked\Tests\Core_Root
  > D:\j\workspace\x64_checked_w---facfb6a0\bin\tests\Windows_NT.x64.Checked\baseservices\threading\threadpool\unregister\unregister03\unregister03.cmd
  
        Expected: True
        Actual:   False
","[x64/Windows] Failure in heapverify=1 job https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_windows_nt_heapverify1/73/consoleText

BEGIN EXECUTION
         ""D:\j\workspace\x64_checked_w---facfb6a0\tests\..\bin\tests\Windows_NT.x64.Checked\Tests\Core_Root\corerun.exe"" unregister03.exe 
        Test Failed
        Expected: 100
        Actual: 0
        END EXECUTION - FAILED
        FAILED
        Test Harness Exitcode is : 1
        
  To run the test:
  > set CORE_ROOT=D:\j\workspace\x64_checked_w---facfb6a0\bin\tests\Windows_NT.x64.Checked\Tests\Core_Root
  > D:\j\workspace\x64_checked_w---facfb6a0\bin\tests\Windows_NT.x64.Checked\baseservices\threading\threadpool\unregister\unregister03\unregister03.cmd
  
        Expected: True
        Actual:   False
",arch-x64,briansull,,
17630,Feature Request: During a profiler walk of the GC heap reference graph distinguish references that aren't backed by metadata fields,"This is a request from https://github.com/dotnet/coreclr/issues/16274#issuecomment-381434436

> Well could you please add the markers for virtual references in ICorProfilerCallback? I need to know that the reference to LoaderAllocator is virtual. I have the list of classes where the reference to LoaderAllocator isn't virtual. How can I understand after CLR/CoreCLR update that I have to add the new type in the list?


FWIW I don't think that the information needs to be directly provided as an argument of the ICorProfilerCallback::ObjectReferences API (or a numbered extension of the API) but there would need to be some not too complicated and reasonably performant mechanism for a profiler to learn the information. This is part of a broader ask that the profiler wants to understand not just what references an object has but specifically how those references correlate to its fields nested fields array elements etc. Right now profilers are using heuristics because the APIs to access types and type layouts have difficulties in some cases. The implicit references created by collectible assemblies add an additional layer of complexity.","Feature Request: During a profiler walk of the GC heap reference graph, distinguish references that aren't backed by metadata fields This is a request from https://github.com/dotnet/coreclr/issues/16274#issuecomment-381434436

> Well could you please add the markers for virtual references in ICorProfilerCallback? I need to know that the reference to LoaderAllocator is virtual. I have the list of classes where the reference to LoaderAllocator isn't virtual. How can I understand after CLR/CoreCLR update that I have to add the new type in the list?


FWIW I don't think that the information needs to be directly provided as an argument of the ICorProfilerCallback::ObjectReferences API (or a numbered extension of the API) but there would need to be some not too complicated and reasonably performant mechanism for a profiler to learn the information. This is part of a broader ask that the profiler wants to understand not just what references an object has but specifically how those references correlate to its fields nested fields array elements etc. Right now profilers are using heuristics because the APIs to access types and type layouts have difficulties in some cases. The implicit references created by collectible assemblies add an additional layer of complexity.",area-Diagnostics,RussKeldorph,18/04/2018 10:00,
17629, [x64/Ubuntu] Failures in tailcallstress job,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_ubuntu_tailcallstress_tst/323/consoleText

FAILED   - tracing/tracevalidation/tracelogging/tracelogging/tracelogging.sh
               BEGIN EXECUTION
               /mnt/j/workspace/dotnet_coreclr/master/jitstress/x64_checked_ubuntu_tailcallstress_tst/bin/tests/Linux.x64.Checked/Tests/Core_Root/corerun tracelogging.exe
               
               Unhandled Exception: System.TypeLoadException: Could not find type Microsoft.Diagnostics.Tracing.Etlx.TraceCodeAddresses+ILToNativeMap
                  at FastSerialization.Deserializer.GetFactory(String fullName)
                  at FastSerialization.SerializationType.FastSerialization.IFastSerializable.FromStream(Deserializer deserializer)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceCodeAddresses.<>c__DisplayClass42_0.<FastSerialization.IFastSerializable.FromStream>b__0()
                  at FastSerialization.DeferedRegion.FinishReadHelper(Boolean preserveStreamPosition)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceLog.FastSerialization.IFastSerializable.FromStream(Deserializer deserializer)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.GetEntryObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceLog.InitializeFromFile(String etlxFilePath)
                  at Tracing.Tests.Common.EventSourceTestSuite.RunTests()
                  at Tracing.Tests.TraceLogging.Main(String[] args)
               ./tracelogging.sh: line 244: 64297 Aborted                 (core dumped) $_DebuggerFullPath ""$CORE_ROOT/corerun"" $ExePath $CLRTestExecutionArguments
               Expected: 100
               Actual: 134
               END EXECUTION - FAILED

FAILED   - tracing/eventsourcetrace/eventsourcetrace/eventsourcetrace.sh
               BEGIN EXECUTION
               /mnt/j/workspace/dotnet_coreclr/master/jitstress/x64_checked_ubuntu_tailcallstress_tst/bin/tests/Linux.x64.Checked/Tests/Core_Root/corerun eventsourcetrace.exe
               	Start: Enable tracing.
               	End: Enable tracing.
               
               	Start: Messaging.
               	End: Messaging.
               
               	Start: Disable tracing.
               	End: Disable tracing.
               
               	Start: Processing events from file.
               
               Unhandled Exception: System.TypeLoadException: Could not find type Microsoft.Diagnostics.Tracing.Etlx.TraceCodeAddresses+ILToNativeMap
                  at FastSerialization.Deserializer.GetFactory(String fullName)
                  at FastSerialization.SerializationType.FastSerialization.IFastSerializable.FromStream(Deserializer deserializer)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceCodeAddresses.<>c__DisplayClass42_0.<FastSerialization.IFastSerializable.FromStream>b__0()
                  at FastSerialization.DeferedRegion.FinishReadHelper(Boolean preserveStreamPosition)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceLog.FastSerialization.IFastSerializable.FromStream(Deserializer deserializer)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.GetEntryObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceLog.InitializeFromFile(String etlxFilePath)
                  at Tracing.Tests.EventSourceTrace.Main(String[] args)
               ./eventsourcetrace.sh: line 244: 64063 Aborted                 (core dumped) $_DebuggerFullPath ""$CORE_ROOT/corerun"" $ExePath $CLRTestExecutionArguments
               Expected: 100
               Actual: 134
               END EXECUTION - FAILED"," [x64/Ubuntu] Failures in tailcallstress job https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_ubuntu_tailcallstress_tst/323/consoleText

FAILED   - tracing/tracevalidation/tracelogging/tracelogging/tracelogging.sh
               BEGIN EXECUTION
               /mnt/j/workspace/dotnet_coreclr/master/jitstress/x64_checked_ubuntu_tailcallstress_tst/bin/tests/Linux.x64.Checked/Tests/Core_Root/corerun tracelogging.exe
               
               Unhandled Exception: System.TypeLoadException: Could not find type Microsoft.Diagnostics.Tracing.Etlx.TraceCodeAddresses+ILToNativeMap
                  at FastSerialization.Deserializer.GetFactory(String fullName)
                  at FastSerialization.SerializationType.FastSerialization.IFastSerializable.FromStream(Deserializer deserializer)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceCodeAddresses.<>c__DisplayClass42_0.<FastSerialization.IFastSerializable.FromStream>b__0()
                  at FastSerialization.DeferedRegion.FinishReadHelper(Boolean preserveStreamPosition)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceLog.FastSerialization.IFastSerializable.FromStream(Deserializer deserializer)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.GetEntryObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceLog.InitializeFromFile(String etlxFilePath)
                  at Tracing.Tests.Common.EventSourceTestSuite.RunTests()
                  at Tracing.Tests.TraceLogging.Main(String[] args)
               ./tracelogging.sh: line 244: 64297 Aborted                 (core dumped) $_DebuggerFullPath ""$CORE_ROOT/corerun"" $ExePath $CLRTestExecutionArguments
               Expected: 100
               Actual: 134
               END EXECUTION - FAILED

FAILED   - tracing/eventsourcetrace/eventsourcetrace/eventsourcetrace.sh
               BEGIN EXECUTION
               /mnt/j/workspace/dotnet_coreclr/master/jitstress/x64_checked_ubuntu_tailcallstress_tst/bin/tests/Linux.x64.Checked/Tests/Core_Root/corerun eventsourcetrace.exe
               	Start: Enable tracing.
               	End: Enable tracing.
               
               	Start: Messaging.
               	End: Messaging.
               
               	Start: Disable tracing.
               	End: Disable tracing.
               
               	Start: Processing events from file.
               
               Unhandled Exception: System.TypeLoadException: Could not find type Microsoft.Diagnostics.Tracing.Etlx.TraceCodeAddresses+ILToNativeMap
                  at FastSerialization.Deserializer.GetFactory(String fullName)
                  at FastSerialization.SerializationType.FastSerialization.IFastSerializable.FromStream(Deserializer deserializer)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceCodeAddresses.<>c__DisplayClass42_0.<FastSerialization.IFastSerializable.FromStream>b__0()
                  at FastSerialization.DeferedRegion.FinishReadHelper(Boolean preserveStreamPosition)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.ReadObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceLog.FastSerialization.IFastSerializable.FromStream(Deserializer deserializer)
                  at FastSerialization.Deserializer.ReadObjectDefinition(Tags tag StreamLabel objectLabel)
                  at FastSerialization.Deserializer.GetEntryObject()
                  at Microsoft.Diagnostics.Tracing.Etlx.TraceLog.InitializeFromFile(String etlxFilePath)
                  at Tracing.Tests.EventSourceTrace.Main(String[] args)
               ./eventsourcetrace.sh: line 244: 64063 Aborted                 (core dumped) $_DebuggerFullPath ""$CORE_ROOT/corerun"" $ExePath $CLRTestExecutionArguments
               Expected: 100
               Actual: 134
               END EXECUTION - FAILED",arch-x64,erozenfeld,,
17628,[x64/Ubuntu] Failure in JitStress=2 JitStressRegs=4 job,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_ubuntu_jitstress2_jitstressregs4_tst/438/consoleText

FAILED   - baseservices/threading/waithandle/waitany/waitanyex5a/waitanyex5a.sh
               BEGIN EXECUTION
               /mnt/j/workspace/dotnet_coreclr/master/jitstress/x64_checked_ubuntu_jitstress2_jitstressregs4_tst/bin/tests/Linux.x64.Checked/Tests/Core_Root/corerun waitanyex5a.exe
               Abandoning only one Mutex in array with other WaitHandles signaling other mutexes
               Waiting...
               WaitAny did not throw AbandonedMutexExcpetion
               Test Failed
               Expected: 100
               Actual: 255
               END EXECUTION - FAILED","[x64/Ubuntu] Failure in JitStress=2 JitStressRegs=4 job https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64/job/jitstress/job/x64_checked_ubuntu_jitstress2_jitstressregs4_tst/438/consoleText

FAILED   - baseservices/threading/waithandle/waitany/waitanyex5a/waitanyex5a.sh
               BEGIN EXECUTION
               /mnt/j/workspace/dotnet_coreclr/master/jitstress/x64_checked_ubuntu_jitstress2_jitstressregs4_tst/bin/tests/Linux.x64.Checked/Tests/Core_Root/corerun waitanyex5a.exe
               Abandoning only one Mutex in array with other WaitHandles signaling other mutexes
               Waiting...
               WaitAny did not throw AbandonedMutexExcpetion
               Test Failed
               Expected: 100
               Actual: 255
               END EXECUTION - FAILED",JitStress,erozenfeld,18/04/2018 9:44,
17627,increase timeout for debug jobs,"Allow to get results from arm32 debug ubuntu build.

[arm_cross_debug_ubuntu_tst_prtest](https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_debug_ubuntu_tst_prtest/) fails with timeout it is not a single test that hangs because it can be aborted during different tests.

Our current timeout is 420 minutes and it allows to run ~10000 tests so we need to be able to finish another 1000 test to make this green. 2 hours should be enough.","increase timeout for debug jobs Allow to get results from arm32 debug ubuntu build.

[arm_cross_debug_ubuntu_tst_prtest](https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_debug_ubuntu_tst_prtest/) fails with timeout it is not a single test that hangs because it can be aborted during different tests.

Our current timeout is 420 minutes and it allows to run ~10000 tests so we need to be able to finish another 1000 test to make this green. 2 hours should be enough.",area-Infrastructure-coreclr,sandreenko,18/04/2018 9:27,19/04/2018 3:58
17626,Cannot get light-up technique of assembly load to work with .NET Core 2.0,"First of all please let me know if this type of issue should be addressed in another repo. I did see some mention of this light-up technique here so that's why I chose this repo.

I recently learned about the light-up technique that Application Insights uses to get their assemblies loaded into any ASP.NET app. [Here](https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/platform-specific-configuration?view=aspnetcore-2.1) is a link to it.

I've implemented an IHostingStartup class in an assembly.  I'm using a target of 

The Main() entrypoint is to make the compiler happy -- apparently I cannot use that interface without having a Main entrypoint? All I do for my configuration is simply use a logger class to tell me if it gets loaded.

I could use some additional tips on troubleshooting this or if you think there's a bug. Thanks Bob
","Cannot get light-up technique of assembly load to work with .NET Core 2.0 First of all please let me know if this type of issue should be addressed in another repo. I did see some mention of this light-up technique here so that's why I chose this repo.

I recently learned about the light-up technique that Application Insights uses to get their assemblies loaded into any ASP.NET app. [Here](https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/platform-specific-configuration?view=aspnetcore-2.1) is a link to it.

I've implemented an IHostingStartup class in an assembly.  I'm using a target of 

The Main() entrypoint is to make the compiler happy -- apparently I cannot use that interface without having a Main entrypoint? All I do for my configuration is simply use a logger class to tell me if it gets loaded.

I could use some additional tips on troubleshooting this or if you think there's a bug. Thanks Bob
",question,RussKeldorph,18/04/2018 9:26,19/04/2018 1:32
17625,[TEST] Test GC/HeapExpansion/bestfit test on ARM64,This is just a test of whether the bestfit tests works on arm64 or not,[TEST] Test GC/HeapExpansion/bestfit test on ARM64 This is just a test of whether the bestfit tests works on arm64 or not,* NO MERGE *,janvorli,,
17622,WIP Test tier 1 in CI,,WIP Test tier 1 in CI ,* NO MERGE *,kouvel,,
17619,1.1.8 long-name DAC/SOS has incorrect version (001 expected 01),"I ran some basic symbol validation on the recent 1.1.8 release and found that the long-name DAC/SOS has incorrect versions:

 * ..._4.6.26328.**001**.dll
 * ..._4.6.26328.**01**.dll (expected)

This was fixed in ?
Should the 1.1.8 build in particular be manually fixed by renaming the dll and republishing symbols?

/cc @lt72 @mikem8361 @leculver @weshaggard ","1.1.8 long-name DAC/SOS has incorrect version (001, expected 01) I ran some basic symbol validation on the recent 1.1.8 release and found that the long-name DAC/SOS has incorrect versions:

 * ..._4.6.26328.**001**.dll
 * ..._4.6.26328.**01**.dll (expected)

This was fixed in ?
Should the 1.1.8 build in particular be manually fixed by renaming the dll and republishing symbols?

/cc @lt72 @mikem8361 @leculver @weshaggard ",area-Diagnostics,mikem8361,18/04/2018 7:14,23/03/2019 10:39
17618,disable DevDiv_255294 in stress modes.,"Closes #17605.

cc @dotnet/jit-contrib ","disable DevDiv_255294 in stress modes. Closes #17605.

cc @dotnet/jit-contrib ",disabled-test,sandreenko,18/04/2018 7:14,18/04/2018 17:24
17614,fix build.cmd generateLayout,"output before:


PTAL @tannergooding @jashook.
cc @dotnet/jit-contrib 

@tannergooding Is it a typo? Did it work in #15673?","fix build.cmd generateLayout output before:


PTAL @tannergooding @jashook.
cc @dotnet/jit-contrib 

@tannergooding Is it a typo? Did it work in #15673?",area-Infrastructure-coreclr,tannergooding,18/04/2018 4:23,18/04/2018 16:25
17613,Port #17594 to the 2.1 branch (Fix GC tests),"Port #17594 to the release branch. 
Fixes #17588.","Port #17594 to the 2.1 branch (Fix GC tests) Port #17594 to the release branch. 
Fixes #17588.",test bug,sandreenko,18/04/2018 3:49,18/04/2018 16:25
17612,About 10% performance regression for Perf_BigInteger tests,"Ctor_ByteArray
![capture04](https://user-images.githubusercontent.com/5897654/38886242-355e249c-422a-11e8-87a5-c2af03d8c409.PNG)

Ctor_ByteSpan
![capture05](https://user-images.githubusercontent.com/5897654/38886356-92c6bb58-422a-11e8-9819-39a0eb4424d5.PNG)

ToByteArray
![capture06](https://user-images.githubusercontent.com/5897654/38886484-efe301e8-422a-11e8-8db6-b2a38acb5bd1.PNG)

TryWriteBytes
![capture07](https://user-images.githubusercontent.com/5897654/38886552-23aa80be-422b-11e8-90fe-4a9b2dd512d7.PNG)

[Updated]:
For all of the above the corefx diff below is causing the regression increase: 
dotnet/corefx@7ec7367

Check [benchview ](https://benchview/trendline?build_selector=latest&count=2000&aggregate=arithmeticMean&filterTail=one&filterVal=100&interval=INTERVAL_MIN_MAX&rtids=[957]&archids=[23]&mpids=[1292]&cfgids=[2706]&testids=[642966429564297643056430464306642996429864300643086430764309]&jobgroup=CoreFX&jobtype=rolling&branchId=42&) for more detail.

cc: @kouvel @danmosemsft ","About 10% performance regression for Perf_BigInteger tests Ctor_ByteArray
![capture04](https://user-images.githubusercontent.com/5897654/38886242-355e249c-422a-11e8-87a5-c2af03d8c409.PNG)

Ctor_ByteSpan
![capture05](https://user-images.githubusercontent.com/5897654/38886356-92c6bb58-422a-11e8-9819-39a0eb4424d5.PNG)

ToByteArray
![capture06](https://user-images.githubusercontent.com/5897654/38886484-efe301e8-422a-11e8-8db6-b2a38acb5bd1.PNG)

TryWriteBytes
![capture07](https://user-images.githubusercontent.com/5897654/38886552-23aa80be-422b-11e8-90fe-4a9b2dd512d7.PNG)

[Updated]:
For all of the above the corefx diff below is causing the regression increase: 
dotnet/corefx@7ec7367

Check [benchview ](https://benchview/trendline?build_selector=latest&count=2000&aggregate=arithmeticMean&filterTail=one&filterVal=100&interval=INTERVAL_MIN_MAX&rtids=[957]&archids=[23]&mpids=[1292]&cfgids=[2706]&testids=[642966429564297643056430464306642996429864300643086430764309]&jobgroup=CoreFX&jobtype=rolling&branchId=42&) for more detail.

cc: @kouvel @danmosemsft ",area-System.Runtime,kouvel,18/04/2018 3:41,18/04/2018 11:05
17610,[arm32/Ubuntu] Assert failure: Consistency check failed: hit privileged instruction!,"In GCStress=0xc

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_tst/2/consoleText



Related to https://github.com/dotnet/coreclr/issues/17585 and/or https://github.com/dotnet/coreclr/issues/17598?

","[arm32/Ubuntu] Assert failure: Consistency check failed: hit privileged instruction! In GCStress=0xc

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_gcstress0xc_tst/2/consoleText



Related to https://github.com/dotnet/coreclr/issues/17585 and/or https://github.com/dotnet/coreclr/issues/17598?

",GCStress,AndyAyersMS,,
17609,[x86/x64|Windows|Full Framework] Native vararg generates bad code.,"C#
","[x86/x64|Windows|Full Framework] Native vararg generates bad code. C#
",area-CodeGen,jashook,,
17608,[1.1] Fix Debian packaging bug.,#NAME?,"[1.1] Fix Debian packaging bug. - Fixes packaging for Debian8 and Debian9
- Further narrows down the scope of tool-runtime replacement with restored dotnetcli to only Debian9 and only the x509certififactes assembly.",area-Infrastructure-coreclr,ianhays,,
17605,[arm32/Ubuntu] Failure in R2R JitStress=1 job,"https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_r2r_jitstress1_flow/

It appears to fail with a hang in this test:


This is consistent in multiple runs e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_r2r_jitstress1_tst/3/consoleText

","[arm32/Ubuntu] Failure in R2R JitStress=1 job https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_r2r_jitstress1_flow/

It appears to fail with a hang in this test:


This is consistent in multiple runs e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_ubuntu_r2r_jitstress1_tst/3/consoleText

",arch-arm32,sandreenko,,
17604,"Incorrect prefix appended when the native library lives in ""relative"" directory in Unix","_From @luqunl on April 17 2018 6:3_

The issue is found by Jkotas:

https://github.com/dotnet/coreclr/blob/9d45401c6056a5b9c92d036e25c34ad34c03385e/src/vm/dllimport.cpp#L6054

libNameIsRelativePath is going to be true for a paths like:
XXX\YYY\library
or
\XXX\YYY\library.

On Unix we will end up trying paths like:
**lib**XXX\YYY\library.so
or
**lib**\XXX\YYY\library.so.

_Copied from original issue: dotnet/corert#5719_","Incorrect prefix appended when the native library lives in ""relative"" directory in Unix _From @luqunl on April 17 2018 6:3_

The issue is found by Jkotas:

https://github.com/dotnet/coreclr/blob/9d45401c6056a5b9c92d036e25c34ad34c03385e/src/vm/dllimport.cpp#L6054

libNameIsRelativePath is going to be true for a paths like:
XXX\YYY\library
or
\XXX\YYY\library.

On Unix we will end up trying paths like:
**lib**XXX\YYY\library.so
or
**lib**\XXX\YYY\library.so.

_Copied from original issue: dotnet/corert#5719_",area-Interop,AaronRobinsonMSFT,,
17603,About 20% performance regression for OrderBy() and OrderByThenBy() on windows,"Here are the graphs showing timings from Aug to now for these tests.

<img width=""1060"" alt=""screen shot 2018-04-16 at 11 07 19 pm"" src=""https://user-images.githubusercontent.com/5897654/38851560-08d96c2e-41cb-11e8-8154-4730865ce439.png"">

<img width=""1063"" alt=""screen shot 2018-04-16 at 11 17 43 pm"" src=""https://user-images.githubusercontent.com/5897654/38851868-6f25fda2-41cc-11e8-9884-ea79f7e50ed1.png"">


There was a noticeable jump in October for OrderBy() and OrderByThenBy() tests that does not seem to have been corrected since.

For Windows:
The corefx commit related to this regression is https://github.com/dotnet/corefx/commit/2b25c6c739ada3e8da8b8783e008f48f9078fb33 which in turn points to code changes are in CoreCLR. 
Here's the coreclr commit bd7493440cefe9cdfb3648de99178e208f8df5df  and here's a [github diff](https://github.com/dotnet/coreclr/commit/bd7493440cefe9cdfb3648de99178e208f8df5df) 

Refer to [benchview](https://benchview/trendline?build_selector=latest&count=2000&aggregate=arithmeticMean&filterTail=one&filterVal=100&interval=INTERVAL_MIN_MAX&rtids=[957]&archids=[23]&mpids=[1292]&cfgids=[2706]&testids=[6030360301603026030060319603176031860316]&jobgroup=CoreFX&jobtype=rolling&branchId=42&) for more details.

cc: @kouvel @danmosemsft

category:cq
theme:benchmarks
skill-level:expert
cost:small","About 20% performance regression for OrderBy() and OrderByThenBy() on windows Here are the graphs showing timings from Aug to now for these tests.

<img width=""1060"" alt=""screen shot 2018-04-16 at 11 07 19 pm"" src=""https://user-images.githubusercontent.com/5897654/38851560-08d96c2e-41cb-11e8-8154-4730865ce439.png"">

<img width=""1063"" alt=""screen shot 2018-04-16 at 11 17 43 pm"" src=""https://user-images.githubusercontent.com/5897654/38851868-6f25fda2-41cc-11e8-9884-ea79f7e50ed1.png"">


There was a noticeable jump in October for OrderBy() and OrderByThenBy() tests that does not seem to have been corrected since.

For Windows:
The corefx commit related to this regression is https://github.com/dotnet/corefx/commit/2b25c6c739ada3e8da8b8783e008f48f9078fb33 which in turn points to code changes are in CoreCLR. 
Here's the coreclr commit bd7493440cefe9cdfb3648de99178e208f8df5df  and here's a [github diff](https://github.com/dotnet/coreclr/commit/bd7493440cefe9cdfb3648de99178e208f8df5df) 

Refer to [benchview](https://benchview/trendline?build_selector=latest&count=2000&aggregate=arithmeticMean&filterTail=one&filterVal=100&interval=INTERVAL_MIN_MAX&rtids=[957]&archids=[23]&mpids=[1292]&cfgids=[2706]&testids=[6030360301603026030060319603176031860316]&jobgroup=CoreFX&jobtype=rolling&branchId=42&) for more details.

cc: @kouvel @danmosemsft

category:cq
theme:benchmarks
skill-level:expert
cost:small",area-CodeGen,CarolEidt,,
17602,Clean up FlushInstructionCache for precodes and interlocked target change operations,"Updated based on discussion below

~~Add missing FlushInstructionCache to ResetTargetInterlocked~~

~~Not sure if it's necessary considering the interlocked operation but it's there in Precode::SetTargetInterlocked so I assume it's necessary. Probably no issue anyway it's unlikely that call counting won't be done as a result of the instruction cache. No change to perf on JitBench with tiering enabled. On arm32 and arm64 executable code is not changed so no need for the flush there.~~","Clean up FlushInstructionCache for precodes and interlocked target change operations Updated based on discussion below

~~Add missing FlushInstructionCache to ResetTargetInterlocked~~

~~Not sure if it's necessary considering the interlocked operation but it's there in Precode::SetTargetInterlocked so I assume it's necessary. Probably no issue anyway it's unlikely that call counting won't be done as a result of the instruction cache. No change to perf on JitBench with tiering enabled. On arm32 and arm64 executable code is not changed so no need for the flush there.~~",area-VM,kouvel,,
17600,Bug in CodeGen::getFirstArgWithStackSlot(),"There is a typo in 
","Bug in CodeGen::getFirstArgWithStackSlot() There is a typo in 
",arch-x64,CarolEidt,,
17598,"[arm32/Ubuntu] GCStress failures: ""Consistency check failed: FAILED: !pThread->HasPendingGCStressInstructionUpdate()""","When I run GCStress=0xc on Ubuntu arm32 the most common failure is:


which in at least one of my runs required 5 retries to pass.

This is https://github.com/dotnet/coreclr/issues/5310.
","[arm32/Ubuntu] GCStress failures: ""Consistency check failed: FAILED: !pThread->HasPendingGCStressInstructionUpdate()"" When I run GCStress=0xc on Ubuntu arm32 the most common failure is:


which in at least one of my runs required 5 retries to pass.

This is https://github.com/dotnet/coreclr/issues/5310.
",arch-arm32,BruceForstall,17/04/2018 8:11,31/05/2018 8:21
17597,[Arm64] Add memory barrier after interlocked operations,"Port of https://github.com/dotnet/coreclr/pull/17595 to release/2.1
Fixes https://github.com/dotnet/coreclr/issues/17591

CC @sdmaclea ","[Arm64] Add memory barrier after interlocked operations Port of https://github.com/dotnet/coreclr/pull/17595 to release/2.1
Fixes https://github.com/dotnet/coreclr/issues/17591

CC @sdmaclea ",arch-arm64,kouvel,,
17596,[1.1] Add missing fed28 and deb9 requirements,"- Adds some tags necessary to produce managed components of the build for fed28 and deb9
- Makes the tool-runtime CLI override only happen on platforms where it's required.","[1.1] Add missing fed28 and deb9 requirements - Adds some tags necessary to produce managed components of the build for fed28 and deb9
- Makes the tool-runtime CLI override only happen on platforms where it's required.",area-Infrastructure-coreclr,ianhays,,
17595,[Arm64] Add memory barrier after interlocked operations,Fixes https://github.com/dotnet/coreclr/issues/17591,[Arm64] Add memory barrier after interlocked operations Fixes https://github.com/dotnet/coreclr/issues/17591,arch-arm64,kouvel,,
17594,Fix GC tests.,"Jit can extend lifetime of temp objects after call to GC.Collect() so we should not have any temp in the same scope with final 





Fixes #17588.

The same problem as #15156.","Fix GC tests. Jit can extend lifetime of temp objects after call to GC.Collect() so we should not have any temp in the same scope with final 





Fixes #17588.

The same problem as #15156.",test bug,sandreenko,17/04/2018 5:26,18/04/2018 2:44
17593,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,ahsonkhan,,
17592,Handle getTailCallCopyArgsThunk returning NULL in the JIT,This saves the JIT from hardcoding the logic on where getTailCallCopyArgsThunk is implemented,Handle getTailCallCopyArgsThunk returning NULL in the JIT This saves the JIT from hardcoding the logic on where getTailCallCopyArgsThunk is implemented,area-CodeGen,dotnet-bot,17/04/2018 4:34,18/04/2018 10:06
17591,[Arm64] Interlocked operations in the runtime need an additional memory barrier,"The issue is explained in the discussion of PR https://github.com/dotnet/coreclr/pull/17508:
- https://github.com/dotnet/coreclr/pull/17508#issuecomment-381305227
- https://github.com/dotnet/coreclr/pull/17508#issuecomment-381405138

The extra memory barrier is necessary to guarantee that the store from the interlocked operation occurs before a load following the interlocked operation.

https://github.com/dotnet/coreclr/pull/17567 fixes the issue in the JIT which was seen in https://github.com/dotnet/coreclr/issues/17178.

This issue is to track a similar change to the runtime.","[Arm64] Interlocked operations in the runtime need an additional memory barrier The issue is explained in the discussion of PR https://github.com/dotnet/coreclr/pull/17508:
- https://github.com/dotnet/coreclr/pull/17508#issuecomment-381305227
- https://github.com/dotnet/coreclr/pull/17508#issuecomment-381405138

The extra memory barrier is necessary to guarantee that the store from the interlocked operation occurs before a load following the interlocked operation.

https://github.com/dotnet/coreclr/pull/17567 fixes the issue in the JIT which was seen in https://github.com/dotnet/coreclr/issues/17178.

This issue is to track a similar change to the runtime.",arch-arm64,kouvel,,
17588,[arm32/Ubuntu] Failures in R2R JitStressRegs3,"These may occur in the baseline but I haven't seen results there due to infrastructure issues.

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_r2r_jitstressregs3_tst/2/consoleText

Tests:

","[arm32/Ubuntu] Failures in R2R JitStressRegs3 These may occur in the baseline but I haven't seen results there due to infrastructure issues.

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_ubuntu_r2r_jitstressregs3_tst/2/consoleText

Tests:

",JitStress,sandreenko,,
17587,.NET Core assembly cannot be found when assembly loaded through dynamic IL injected-code," I have a profiler that injects IL into some methods so that they can call into my managed assembly. Since my assembly is in the GAC it works fine for .NET Framework but when I tried it in .NET Core the assembly could not be found. Although this may be a duplicate of https://github.com/dotnet/coreclr/issues/3894 I would like to hear what you think are the best options for accomplishing this assembly load. I do not want to modify the application being profiled (I don't have control over its source) so the solution needs to be something I can do with the profiler or a simplified environment setting.
",".NET Core assembly cannot be found when assembly loaded through dynamic IL injected-code  I have a profiler that injects IL into some methods so that they can call into my managed assembly. Since my assembly is in the GAC it works fine for .NET Framework but when I tried it in .NET Core the assembly could not be found. Although this may be a duplicate of https://github.com/dotnet/coreclr/issues/3894 I would like to hear what you think are the best options for accomplishing this assembly load. I do not want to modify the application being profiled (I don't have control over its source) so the solution needs to be something I can do with the profiler or a simplified environment setting.
",area-Diagnostics,noahfalk,17/04/2018 3:50,19/04/2018 1:58
17585,[arm32] Assert failure: ExecutionManager::IsManagedCode(adrRedirectedIP),"Consistent failure in Windows arm32 corefx test System.Runtime.Tests with COMPlus_JitStress=2:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress2_tst/10/consoleText


","[arm32] Assert failure: ExecutionManager::IsManagedCode(adrRedirectedIP) Consistent failure in Windows arm32 corefx test System.Runtime.Tests with COMPlus_JitStress=2:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress2_tst/10/consoleText


",arch-arm32,sandreenko,,
17584,[arm32/Windows] Test Failed: Failure in corefx System.Net.HttpListener.Tests,"Consistent failure in Windows arm32 corefx System.Net.HttpListener.Tests with COMPlus_JitStress=2:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress2_tst/10/consoleText


","[arm32/Windows] Test Failed: Failure in corefx System.Net.HttpListener.Tests Consistent failure in Windows arm32 corefx System.Net.HttpListener.Tests with COMPlus_JitStress=2:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress2_tst/10/consoleText


",JitStress,BruceForstall,17/04/2018 3:14,21/09/2019 4:39
17583,Failure in corefx System.Diagnostics.StackTrace.Tests,"Consistent failure in COMPlus_JitStress=2 runs of corefx tests in System.Diagnostics.StackTrace.Tests:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress2_tst/10/consoleText


","Failure in corefx System.Diagnostics.StackTrace.Tests Consistent failure in COMPlus_JitStress=2 runs of corefx tests in System.Diagnostics.StackTrace.Tests:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress2_tst/10/consoleText


",JitStress,sandreenko,,
17582,[arm32/Windows] Hang in corefx Microsoft.Win32.SystemEvents.Tests,"Many arm32 Windows corefx jobs in the CI are hanging apparently on Microsoft.Win32.SystemEvents.Tests e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/11/console
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress1_tst/11/console
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstressregs2_tst/9/console
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstressregs0x1000_tst/10/console

They also show failures before the hang.

Sample output:

","[arm32/Windows] Hang in corefx Microsoft.Win32.SystemEvents.Tests Many arm32 Windows corefx jobs in the CI are hanging apparently on Microsoft.Win32.SystemEvents.Tests e.g.:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_baseline_tst/11/console
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstress1_tst/11/console
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstressregs2_tst/9/console
https://ci.dot.net/job/dotnet_coreclr/job/master/view/arm/job/jitstress/job/arm_cross_checked_windows_nt_corefx_jitstressregs0x1000_tst/10/console

They also show failures before the hang.

Sample output:

",arch-arm32,BruceForstall,17/04/2018 3:05,18/04/2018 11:24
17577, Updating the HWIntrinsic APIs to use the unmanaged constraint,"FYI. @CarolEidt @fiigii @sdmaclea @eerhardt @jkotas 

This is mostly just for discussion right now since the actual change can't be merged until after the branch opens again.

This is a new (and unshipped API) so back-compat should not be a concern here. However there are some potential other issues with this change:
* The 
  * Examples of things not possible with a shim API include stackalloc and bypassing definite assignment rules"," Updating the HWIntrinsic APIs to use the unmanaged constraint FYI. @CarolEidt @fiigii @sdmaclea @eerhardt @jkotas 

This is mostly just for discussion right now since the actual change can't be merged until after the branch opens again.

This is a new (and unshipped API) so back-compat should not be a concern here. However there are some potential other issues with this change:
* The 
  * Examples of things not possible with a shim API include stackalloc and bypassing definite assignment rules",area-CodeGen,CarolEidt,16/04/2018 4:03,26/05/2018 2:16
17576,Port JIT and GC to C#,Is it possible?,Port JIT and GC to C# Is it possible?,Design Discussion,jkotas,15/04/2018 18:52,
17575,[Arm64] Disable SIMD in crossgen (added as part of #14633),"Disable SIMD feature in crossgen for ARM64 for now as decided in #17543

This will let the following arm64 crossgen tests to pass. (#16541 #16542)","[Arm64] Disable SIMD in crossgen (added as part of #14633) Disable SIMD feature in crossgen for ARM64 for now as decided in #17543

This will let the following arm64 crossgen tests to pass. (#16541 #16542)",area-CodeGen,dotnet-bot,15/04/2018 14:42,17/04/2018 23:45
17574,[arm64] Assertion failed 'varDsc->lvOnFrame && !varDsc->lvRegister',"x64_arm64_altjit corefx assertion:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_baseline/157/consoleFull#-102414311f66db340-b3cd-4e23-8190-9b52cb916333



also: https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_jitstress2/154/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_jitstressregs3/158/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_jitstressregs4/156/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_jitstressregs8/155/

and probably others.

","[arm64] Assertion failed 'varDsc->lvOnFrame && !varDsc->lvRegister' x64_arm64_altjit corefx assertion:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_baseline/157/consoleFull#-102414311f66db340-b3cd-4e23-8190-9b52cb916333



also: https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_jitstress2/154/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_jitstressregs3/158/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_jitstressregs4/156/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_corefx_jitstressregs8/155/

and probably others.

",arch-arm64,BruceForstall,15/04/2018 8:11,16/04/2018 1:49
17573,[arm64] Assertion failed '(candidates & allRegs(srcInterval->registerType)) != 0',"x64_arm64_altjit job failures:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_jitstress1/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_jitstress2/


","[arm64] Assertion failed '(candidates & allRegs(srcInterval->registerType)) != 0' x64_arm64_altjit job failures:

https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_jitstress1/
https://ci.dot.net/job/dotnet_coreclr/job/master/view/x64_arm64_altjit/job/jitstress/job/x64_arm64_altjit_checked_windows_nt_jitstress2/


",arch-arm64,BruceForstall,15/04/2018 8:00,16/04/2018 1:50
17572,[arm32/Ubuntu] Enable R2R jobs as periodic/cron jobs,"The Ubuntu arm32 R2R jobs exist but are not scheduled periodically. Now that they work they should be added to the set of periodic jobs.
","[arm32/Ubuntu] Enable R2R jobs as periodic/cron jobs The Ubuntu arm32 R2R jobs exist but are not scheduled periodically. Now that they work they should be added to the set of periodic jobs.
",arch-arm32,BruceForstall,,
17571,Enable `FEATURE_PREVENT_BAD_BYREFS` for all platforms and remove ifdefs,"https://github.com/dotnet/coreclr/pull/17524 introduced the  and make the code all-platform after testing all platforms and investigating the (significant number of) asm diffs.


category:correctness
theme:jit-coding-style
skill-level:intermediate
cost:small","Enable  and make the code all-platform after testing all platforms and investigating the (significant number of) asm diffs.


category:correctness
theme:jit-coding-style
skill-level:intermediate
cost:small",area-CodeGen,BruceForstall,,
17570,Windows ARM32 GCStress=0xc failures in baseservices\threading\generics\WaitCallback thread tests,"The 
","Windows ARM32 GCStress=0xc failures in baseservices\threading\generics\WaitCallback thread tests The 
",GCStress,echesakovMSFT,,
17569,Don't use runtesttilstable script for Ubuntu arm jobs,Testing in #17274 ,Don't use runtesttilstable script for Ubuntu arm jobs Testing in #17274 ,arch-arm32,echesakovMSFT,15/04/2018 2:10,15/04/2018 6:30
17568,Revisit the handling of SIMD types during crossgen,"See the comments on PR #17543.

During crossgen the JIT sets  seemed to fix that issue.

We should consider whether to add support for fixed- or known- size SIMD types during crossgen across architectures.

category:cq
theme:vector-codegen
skill-level:intermediate
cost:small","Revisit the handling of SIMD types during crossgen See the comments on PR #17543.

During crossgen the JIT sets  seemed to fix that issue.

We should consider whether to add support for fixed- or known- size SIMD types during crossgen across architectures.

category:cq
theme:vector-codegen
skill-level:intermediate
cost:small",Design Discussion,CarolEidt,,
17567,[Arm64] Add full barrier after locking operations,"Per discussion with @kouvel in #17508 Interlocked operations should all act as a fully ordering barrier.

Fixes #14346 because we will have have come to a consensus

@jkotas @kouvel @stephentoub @tarekgh 
","[Arm64] Add full barrier after locking operations Per discussion with @kouvel in #17508 Interlocked operations should all act as a fully ordering barrier.

Fixes #14346 because we will have have come to a consensus

@jkotas @kouvel @stephentoub @tarekgh 
",area-CodeGen,kouvel,14/04/2018 19:52,16/04/2018 7:36
17566,Suprising sliced ReadOnlySpan Equality with strings,"If a 
</details>","Suprising sliced ReadOnlySpan Equality with strings If a 
</details>",area-System.Memory,stephentoub,14/04/2018 18:09,20/04/2018 12:34
17565,[Linux/arm] Crossgen SlowTailCallArgs assert failure,"Fails here [Ubuntu arm Cross Checked r2r Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_checked_ubuntu_r2r_tst_prtest/2/consoleText) with the following output

","[Linux/arm] Crossgen SlowTailCallArgs assert failure Fails here [Ubuntu arm Cross Checked r2r Build and Test](https://ci.dot.net/job/dotnet_coreclr/job/master/job/arm_cross_checked_ubuntu_r2r_tst_prtest/2/consoleText) with the following output

",arch-arm32,janvorli,,
17564,[Arm64] Harder Acquire Release cases,"#12087 implemented the simplest volatile cases as loadAcquire and storeRelease.  There is room for a more complete set to be implemented.  Signed load cases is one example.

category:cq
theme:barriers
skill-level:expert
cost:medium","[Arm64] Harder Acquire Release cases #12087 implemented the simplest volatile cases as loadAcquire and storeRelease.  There is room for a more complete set to be implemented.  Signed load cases is one example.

category:cq
theme:barriers
skill-level:expert
cost:medium",arch-arm64,RussKeldorph,14/04/2018 16:29,
17563,Optimize ThreadPool WorkStealingQueue,"While analyzing for #17508 it became apparent that the use of  to be lockless.
","Optimize ThreadPool WorkStealingQueue While analyzing for #17508 it became apparent that the use of  to be lockless.
",area-System.Threading,RussKeldorph,14/04/2018 16:24,
17561,[1.1] Replace tool-runtime binaries with portable linux binaries,"When we restore the portable runtime on 1.1 we should also use those portable binaries for the tool-runtime. Otherwise we can run into conflicts between the native binaries expected by the portable-cli and the tool-runtime dependencies.

Also removes some platform specific CLI usages that I tested and verified with the portable CLI instead.

@janvorli this resolves the issues you were seeing with the x509certificates dll. Our tools were using an older version of the managed dll instead of the one in your portable CLi resulting in failed attempted loads of native functions in the System.Security.Cryptography.Native .so.","[1.1] Replace tool-runtime binaries with portable linux binaries When we restore the portable runtime on 1.1 we should also use those portable binaries for the tool-runtime. Otherwise we can run into conflicts between the native binaries expected by the portable-cli and the tool-runtime dependencies.

Also removes some platform specific CLI usages that I tested and verified with the portable CLI instead.

@janvorli this resolves the issues you were seeing with the x509certificates dll. Our tools were using an older version of the managed dll instead of the one in your portable CLi resulting in failed attempted loads of native functions in the System.Security.Cryptography.Native .so.",area-Infrastructure-coreclr,ianhays,,
17558,JitStress=2 failure in corefx System.Diagnostics.StackTrace.Tests,"We get the following failure in x64_checked_windows_nt_corefx_jitstress2 jobs (e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/Windows_NT/job/jitstress/job/x64_checked_windows_nt_corefx_jitstress2/484/consoleText)



Two other failures from that run are the same as in #17557.","JitStress=2 failure in corefx System.Diagnostics.StackTrace.Tests We get the following failure in x64_checked_windows_nt_corefx_jitstress2 jobs (e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/Windows_NT/job/jitstress/job/x64_checked_windows_nt_corefx_jitstress2/484/consoleText)



Two other failures from that run are the same as in #17557.",JitStress,erozenfeld,14/04/2018 8:48,17/06/2018 12:54
17557,Failures in x64_checked_windows_nt_corefx_jitstress1 jobs,"We get the following failures in  x64_checked_windows_nt_corefx_jitstress1 jobs (e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/Windows_NT/job/jitstress/job/x64_checked_windows_nt_corefx_jitstress1/lastBuild/consoleText)

","Failures in x64_checked_windows_nt_corefx_jitstress1 jobs We get the following failures in  x64_checked_windows_nt_corefx_jitstress1 jobs (e.g. https://ci.dot.net/job/dotnet_coreclr/job/master/view/Windows_NT/job/jitstress/job/x64_checked_windows_nt_corefx_jitstress1/lastBuild/consoleText)

",JitStress,briansull,,
17556,Fix default style argument to Double/Single/Decimal.Parse,"Contributes to https://github.com/dotnet/coreclr/issues/17553
cc: @jkotas ","Fix default style argument to Double/Single/Decimal.Parse Contributes to https://github.com/dotnet/coreclr/issues/17553
cc: @jkotas ",area-System.Runtime,jkotas,14/04/2018 6:35,14/04/2018 9:07
17555,WIP Test tiering in CI,,WIP Test tiering in CI ,* NO MERGE *,kouvel,,
17554,[Perf] Span/IndexerBench/KnownSizeArray(length:1024) regression of ~277% on x86,"**[Perf] Span/IndexerBench/KnownSizeArray(length:1024) regression of ~277% on x86**

Regression can be seen in Benchview - CoreCLR/Master branch from [commit](https://github.com/dotnet/coreclr/compare/94ab205d5545699a49cc54d72e9d3d07a454f10a...dotnet:4456cc99ba0fbe3c02be3a9f54c34282caeb7218). Orange dotted line is the Release v2.0 baseline. This is affecting x86 only.

![image](https://user-images.githubusercontent.com/19602715/38752900-8f1c9aac-3f11-11e8-90ca-8393cdf46a74.png)
","[Perf] Span/IndexerBench/KnownSizeArray(length:1024) regression of ~277% on x86 **[Perf] Span/IndexerBench/KnownSizeArray(length:1024) regression of ~277% on x86**

Regression can be seen in Benchview - CoreCLR/Master branch from [commit](https://github.com/dotnet/coreclr/compare/94ab205d5545699a49cc54d72e9d3d07a454f10a...dotnet:4456cc99ba0fbe3c02be3a9f54c34282caeb7218). Orange dotted line is the Release v2.0 baseline. This is affecting x86 only.

![image](https://user-images.githubusercontent.com/19602715/38752900-8f1c9aac-3f11-11e8-90ca-8393cdf46a74.png)
",arch-x86,erozenfeld,,
17553,Default NumberStyle in float.Parse and double.Parse is Integer for Span,"The default NumberStyle in 
This appears to be the case even in the original PR from @stephentoub  in #13389 and looks to be a copy/paste error from the integer types.","Default NumberStyle in float.Parse and double.Parse is Integer for Span The default NumberStyle in 
This appears to be the case even in the original PR from @stephentoub  in #13389 and looks to be a copy/paste error from the integer types.",area-System.Runtime,stephentoub,,
17552,[Perf] SIMD/RayTracerBench regression of ~7% on x86,"**[Perf] SIMD/RayTracerBench regression of ~7% on x86**

Regression can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/0c9e96e1c2c484e7c80bf7f7a7765e6650cbdf73...dotnet:bd7493440cefe9cdfb3648de99178e208f8df5df). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38752109-e943cca6-3f0e-11e8-9f64-f5ee1acd9e90.png)
","[Perf] SIMD/RayTracerBench regression of ~7% on x86 **[Perf] SIMD/RayTracerBench regression of ~7% on x86**

Regression can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/0c9e96e1c2c484e7c80bf7f7a7765e6650cbdf73...dotnet:bd7493440cefe9cdfb3648de99178e208f8df5df). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38752109-e943cca6-3f0e-11e8-9f64-f5ee1acd9e90.png)
",arch-x86,CarolEidt,,
17551,Fix OpenVirtualProcess on Linux issue.,Fix DataTargetReader::GetRemotePointerSize to work on Linux/MacOS platforms so VS's new Linux core dump support works.,Fix OpenVirtualProcess on Linux issue. Fix DataTargetReader::GetRemotePointerSize to work on Linux/MacOS platforms so VS's new Linux core dump support works.,,mikem8361,,
17550,[Perf] ByteMark/BenchLUDecomp regression of ~67% on x86,"**[Perf] ByteMark/BenchLUDecomp regression of ~67% on x86**

A regression of ~19% can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/367d9b1dd1b542f3d391d0b9111d5914602db2d9...dotnet:312e4486adc4eb8062caa67d4aa9be5411524996) and a regression of ~27% between [commits](https://github.com/dotnet/coreclr/compare/3657a8cab68cdbf9990d98ba4e078f444f5fee82...dotnet:bb36f051ca1dd5be7c998f9c26fa010c3b8c4051).

![image](https://user-images.githubusercontent.com/19602715/38751230-43d0e396-3f0c-11e8-9d9a-3fb9dbb294c2.png)


category:cq
theme:benchmarks
skill-level:expert
cost:small","[Perf] ByteMark/BenchLUDecomp regression of ~67% on x86 **[Perf] ByteMark/BenchLUDecomp regression of ~67% on x86**

A regression of ~19% can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/367d9b1dd1b542f3d391d0b9111d5914602db2d9...dotnet:312e4486adc4eb8062caa67d4aa9be5411524996) and a regression of ~27% between [commits](https://github.com/dotnet/coreclr/compare/3657a8cab68cdbf9990d98ba4e078f444f5fee82...dotnet:bb36f051ca1dd5be7c998f9c26fa010c3b8c4051).

![image](https://user-images.githubusercontent.com/19602715/38751230-43d0e396-3f0c-11e8-9d9a-3fb9dbb294c2.png)


category:cq
theme:benchmarks
skill-level:expert
cost:small",arch-x86,AndyAyersMS,,
17549,WIP Test tiered compilation in CI,,WIP Test tiered compilation in CI ,* NO MERGE *,kouvel,,
17548,[Perf] ByteMark/BenchEmFloatClass improvement of ~3% on x86,"**[Perf] ByteMark/BenchEmFloatClass improvement of ~3% on x86**

Improvement can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/89e85cfff719bc743ad53fdc702b0379c5286087...dotnet:e45a895df6b4cc50347daafed05cefa59af511a2). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38750595-4892d6a2-3f0a-11e8-9bcb-33e8ccc8cb88.png)
","[Perf] ByteMark/BenchEmFloatClass improvement of ~3% on x86 **[Perf] ByteMark/BenchEmFloatClass improvement of ~3% on x86**

Improvement can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/89e85cfff719bc743ad53fdc702b0379c5286087...dotnet:e45a895df6b4cc50347daafed05cefa59af511a2). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38750595-4892d6a2-3f0a-11e8-9bcb-33e8ccc8cb88.png)
",arch-x86,AndyAyersMS,,
17547,[Perf] Benchstone/BenchI/BenchE improvement of ~5% on x86,"**[Perf] Benchstone/BenchI/AddArray improvement of ~5% on x86**

Improvement can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/367d9b1dd1b542f3d391d0b9111d5914602db2d9...dotnet:312e4486adc4eb8062caa67d4aa9be5411524996). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38750257-42b12438-3f09-11e8-802e-f46787a6c8fb.png)
","[Perf] Benchstone/BenchI/BenchE improvement of ~5% on x86 **[Perf] Benchstone/BenchI/AddArray improvement of ~5% on x86**

Improvement can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/367d9b1dd1b542f3d391d0b9111d5914602db2d9...dotnet:312e4486adc4eb8062caa67d4aa9be5411524996). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38750257-42b12438-3f09-11e8-802e-f46787a6c8fb.png)
",arch-x86,erozenfeld,,
17545,[Perf] Benchstone/BenchI/AddArray improvement of ~8% on x86,"**[Perf] Benchstone/BenchI/AddArray improvement of ~8% on x86**

Improvement can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/099e24486977ef4930692aa2c122f572e3d09d01...dotnet:52be8c187c9edbaaa2c8a775800bedad112bc6c6). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38749963-3b46b538-3f08-11e8-8bc2-c4ce538a2d2b.png)
","[Perf] Benchstone/BenchI/AddArray improvement of ~8% on x86 **[Perf] Benchstone/BenchI/AddArray improvement of ~8% on x86**

Improvement can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/099e24486977ef4930692aa2c122f572e3d09d01...dotnet:52be8c187c9edbaaa2c8a775800bedad112bc6c6). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38749963-3b46b538-3f08-11e8-8bc2-c4ce538a2d2b.png)
",arch-x86,CarolEidt,,
17544,[Perf] Benchstone/BenchF/BenchMrk regression of ~15% on x86,"**[Perf] Benchstone/BenchF/BenchMrk regression of ~15% on x86**

Regression can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/0c9e96e1c2c484e7c80bf7f7a7765e6650cbdf73...dotnet:bd7493440cefe9cdfb3648de99178e208f8df5df). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38749646-392b7320-3f07-11e8-963c-882cb035d3be.png)




","[Perf] Benchstone/BenchF/BenchMrk regression of ~15% on x86 **[Perf] Benchstone/BenchF/BenchMrk regression of ~15% on x86**

Regression can be seen in Benchview - CoreCLR/Master branch between [commits](https://github.com/dotnet/coreclr/compare/0c9e96e1c2c484e7c80bf7f7a7765e6650cbdf73...dotnet:bd7493440cefe9cdfb3648de99178e208f8df5df). Orange dotted line is the Release v2.0 baseline.

![image](https://user-images.githubusercontent.com/19602715/38749646-392b7320-3f07-11e8-963c-882cb035d3be.png)




",arch-x86,CarolEidt,,
17543,Allow TYP_SIMD normalization for GT_IND in importer (#16542),"
Fix for #16542

Increasing the scope of the assertion to include TYP_SIMD allows the test to pass.

PTAL @sdmaclea @CarolEidt ","Allow TYP_SIMD normalization for GT_IND in importer (#16542) 
Fix for #16542

Increasing the scope of the assertion to include TYP_SIMD allows the test to pass.

PTAL @sdmaclea @CarolEidt ",area-CodeGen,sdmaclea,13/04/2018 22:29,15/04/2018 14:44
17542,Update KoreanLunisolarCalendar.cs,"Corrects two issues with the conversion table for Gregorian to Korean lunisolar dates.
See: https://github.com/dotnet/coreclr/issues/17510.

**Issue 1: tables use Julian month/day instead of Gregorian month/day for entries prior to 1583.**
Lmon and Lday have been converted from Julian month and day to Gregorian month and day for years prior to 1583.  This also required a new value for MIN_GREGORIAN_DAY (now 19) so the minimum date now supported by this class is 19 Feb 0918 Gregorian. 

**Issue 2: data discrepancy in years 1586 1587 1648 1659 1692 1753 and 1754.**
Table entries for 1586 1587 1648 1659 1692 1753 and 1754 have been corrected to match [Korea Astronomy and Space Science Institute (KASI)](https://astro.kasi.re.kr:444/life/pageView/5) data.  Specifically:

- for years 1587 1648 and 1754 the first day of year has been corrected
- for years 1586 1587 1659 1692 1753 and 1754 the lengths of each month have been corrected

**Notes**
The DaysPerMonth flag uses the binary literal for ease of readability.","Update KoreanLunisolarCalendar.cs Corrects two issues with the conversion table for Gregorian to Korean lunisolar dates.
See: https://github.com/dotnet/coreclr/issues/17510.

**Issue 1: tables use Julian month/day instead of Gregorian month/day for entries prior to 1583.**
Lmon and Lday have been converted from Julian month and day to Gregorian month and day for years prior to 1583.  This also required a new value for MIN_GREGORIAN_DAY (now 19) so the minimum date now supported by this class is 19 Feb 0918 Gregorian. 

**Issue 2: data discrepancy in years 1586 1587 1648 1659 1692 1753 and 1754.**
Table entries for 1586 1587 1648 1659 1692 1753 and 1754 have been corrected to match [Korea Astronomy and Space Science Institute (KASI)](https://astro.kasi.re.kr:444/life/pageView/5) data.  Specifically:

- for years 1587 1648 and 1754 the first day of year has been corrected
- for years 1586 1587 1659 1692 1753 and 1754 the lengths of each month have been corrected

**Notes**
The DaysPerMonth flag uses the binary literal for ease of readability.",area-System.Globalization,tarekgh,,
17541,[Jit] Recognize FMA pattern and Emit Fused Multiply Add (when available),"e.g.



Its a bit of a mine field on x86 https://en.wikipedia.org/wiki/FMA_instruction_set

> The incompatibility between Intel's FMA3 and AMD's FMA4 is due to both companies changing plans without coordinating coding details with each other. AMD changed their plans from FMA3 to FMA4 while Intel changed their plans from FMA4 to FMA3 almost at the same time. The history can be summarized as follows:
>
> * August 2007: AMD announces the SSE5 instruction set which includes 3-operand FMA instructions. A new coding scheme (DREX) is introduced for allowing instructions to have three operands.[11]
> * April 2008: Intel announces their AVX and FMA instruction sets including 4-operand FMA instructions. The coding of these instructions uses the new VEX coding scheme[12] which is more flexible than AMD's DREX scheme.
> * December 2008: Intel changes the specification for their FMA instructions from 4-operand to 3-operand instructions. The VEX coding scheme is still used.[13]
> * May 2009: AMD changes the specification of their FMA instructions from the 3-operand DREX form to the 4-operand VEX form compatible with the April 2008 Intel specification rather than the December 2008 Intel specification.[14]
> * October 2011: AMD Bulldozer processor supports FMA4.[15]
> * January 2012: AMD announces FMA3 support in future processors codenamed Trinity and Vishera; they are based on the Piledriver architecture.[16]
> * May 2012: AMD Piledriver processor supports both FMA3 and FMA4.[15]
> * June 2013: Intel Haswell processor supports FMA3.[17]
> * February 2017 The first generation of AMD Ryzen processors officially supports FMA3 but not FMA4 according to the CPUID instruction.[18] There has been confusion regarding whether FMA4 was implemented or not on this processor due to errata in the initial patch to the GNU Binutils package that has since been rectified.[19][20] While the FMA4 instructions seem to work according to some tests they can also give wrong results.[7] Additionally the initial Ryzen CPUs could be crashed by a particular sequence of FMA3 instructions. It has since been resolved by an updated CPU microcode.[21]

category:cq
theme:basic-cq
skill-level:expert
cost:medium","[Jit] Recognize FMA pattern and Emit Fused Multiply Add (when available) e.g.



Its a bit of a mine field on x86 https://en.wikipedia.org/wiki/FMA_instruction_set

> The incompatibility between Intel's FMA3 and AMD's FMA4 is due to both companies changing plans without coordinating coding details with each other. AMD changed their plans from FMA3 to FMA4 while Intel changed their plans from FMA4 to FMA3 almost at the same time. The history can be summarized as follows:
>
> * August 2007: AMD announces the SSE5 instruction set which includes 3-operand FMA instructions. A new coding scheme (DREX) is introduced for allowing instructions to have three operands.[11]
> * April 2008: Intel announces their AVX and FMA instruction sets including 4-operand FMA instructions. The coding of these instructions uses the new VEX coding scheme[12] which is more flexible than AMD's DREX scheme.
> * December 2008: Intel changes the specification for their FMA instructions from 4-operand to 3-operand instructions. The VEX coding scheme is still used.[13]
> * May 2009: AMD changes the specification of their FMA instructions from the 3-operand DREX form to the 4-operand VEX form compatible with the April 2008 Intel specification rather than the December 2008 Intel specification.[14]
> * October 2011: AMD Bulldozer processor supports FMA4.[15]
> * January 2012: AMD announces FMA3 support in future processors codenamed Trinity and Vishera; they are based on the Piledriver architecture.[16]
> * May 2012: AMD Piledriver processor supports both FMA3 and FMA4.[15]
> * June 2013: Intel Haswell processor supports FMA3.[17]
> * February 2017 The first generation of AMD Ryzen processors officially supports FMA3 but not FMA4 according to the CPUID instruction.[18] There has been confusion regarding whether FMA4 was implemented or not on this processor due to errata in the initial patch to the GNU Binutils package that has since been rectified.[19][20] While the FMA4 instructions seem to work according to some tests they can also give wrong results.[7] Additionally the initial Ryzen CPUs could be crashed by a particular sequence of FMA3 instructions. It has since been resolved by an updated CPU microcode.[21]

category:cq
theme:basic-cq
skill-level:expert
cost:medium",area-CodeGen,RussKeldorph,13/04/2018 18:57,
17540,Update CoreClr CoreFx PgoData to preview3-26416-01 preview3-26416-01 master-20180415-0051 respectively (master),/cc @dotnet/coreclr-auto-update-notify,"Update CoreClr, CoreFx, PgoData to preview3-26416-01, preview3-26416-01, master-20180415-0051, respectively (master) /cc @dotnet/coreclr-auto-update-notify",area-Meta,AlexGhiondea,13/04/2018 18:07,16/04/2018 16:43
17539,Mirror changes from dotnet/corefx,"This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**","Mirror changes from dotnet/corefx This PR contains mirrored changes from dotnet/corefx


**Please REBASE this PR when merging**",,ahsonkhan,,
17537,[Arm64/Windows] Simplify JIT_MemSet & JIT_MemCpy,"JIT_Memset alignment code was definitly broken for some
unaligned cases

JIT_MemCpy likely had the same issue

Simplify implementation to reduce maintenance burden

@janvorli @jkotas PTAL
@dotnet/arm64-contrib FYI

This is the Windows equivalent of #17536 

Should be required to fix probable issues on windows like #17167 #17168 & #17169 
","[Arm64/Windows] Simplify JIT_MemSet & JIT_MemCpy JIT_Memset alignment code was definitly broken for some
unaligned cases

JIT_MemCpy likely had the same issue

Simplify implementation to reduce maintenance burden

@janvorli @jkotas PTAL
@dotnet/arm64-contrib FYI

This is the Windows equivalent of #17536 

Should be required to fix probable issues on windows like #17167 #17168 & #17169 
",area-VM,janvorli,13/04/2018 11:31,14/04/2018 2:46
17535,Insert int3 after non-returning calls at the end of basic blocks.,"This is a follow-up to #17501 that fixed #17398.

#17398 was caused by a break in implicit contract between codegen and
gc pointer reporting in fully-interruptible mode: the latter assumed that
register gc pointer liveness doesn't change across calls while #6103 introduced
codegen where it wasn't true.

#17501 changed gc pointer reporting not to expect that register gc pointer liveness
doesn't change across calls.

This change inserts int3 after non-returning calls at the end of basic blocks
so that gc pointer liveness doesn't change across calls. This is additional
insurance in case any other place in runtime is dependent on that contract.","Insert int3 after non-returning calls at the end of basic blocks. This is a follow-up to #17501 that fixed #17398.

#17398 was caused by a break in implicit contract between codegen and
gc pointer reporting in fully-interruptible mode: the latter assumed that
register gc pointer liveness doesn't change across calls while #6103 introduced
codegen where it wasn't true.

#17501 changed gc pointer reporting not to expect that register gc pointer liveness
doesn't change across calls.

This change inserts int3 after non-returning calls at the end of basic blocks
so that gc pointer liveness doesn't change across calls. This is additional
insurance in case any other place in runtime is dependent on that contract.",area-CodeGen,dotnet-bot,13/04/2018 11:08,14/04/2018 9:29
17534,The crossgen tool should accept Portable PDBs as input,On Windows crossgen only accepts Windows PDBs as input when creating the crossgen PDB (/CreatePDB option).,The crossgen tool should accept Portable PDBs as input On Windows crossgen only accepts Windows PDBs as input when creating the crossgen PDB (/CreatePDB option).,area-CrossGen/NGEN,mikem8361,13/04/2018 9:30,
17533,Make Windows builds always portable,"Apparently there is little or no need for a non-portable Windows build so
rather than trying to figure out which version of Windows we are building
on just ignore -PortableBuild=false.  We can add a warning or refuse to
accept the switch later if necessary but for now we need to continue
accepting it to avoid build breaks.

Fixes #14291","Make Windows builds always portable Apparently there is little or no need for a non-portable Windows build so
rather than trying to figure out which version of Windows we are building
on just ignore -PortableBuild=false.  We can add a warning or refuse to
accept the switch later if necessary but for now we need to continue
accepting it to avoid build breaks.

Fixes #14291",area-Infrastructure-coreclr,RussKeldorph,13/04/2018 9:18,15/04/2018 0:21
17532,Remove CreateFromPinnedArray from Memory (moved to MemoryMarshal),"Part of https://github.com/dotnet/corefx/issues/28954

Corefx side (remove from ref): https://github.com/dotnet/corefx/pull/29077

Related PR: https://github.com/dotnet/coreclr/pull/17500","Remove CreateFromPinnedArray from Memory (moved to MemoryMarshal) Part of https://github.com/dotnet/corefx/issues/28954

Corefx side (remove from ref): https://github.com/dotnet/corefx/pull/29077

Related PR: https://github.com/dotnet/coreclr/pull/17500",area-System.Memory,ahsonkhan,,
17531,Protect SuperPMI from crashes calling jitStartup,"When we call jitStartup we pass a JitHost interface that the JIT
calls to query for data. These queries look up in the recorded
MCH data and could fail (and throw an exception) if data is
missing which it can be for running non-matching altjit against
a collection. Protect these calls with exception handling.","Protect SuperPMI from crashes calling jitStartup When we call jitStartup we pass a JitHost interface that the JIT
calls to query for data. These queries look up in the recorded
MCH data and could fail (and throw an exception) if data is
missing which it can be for running non-matching altjit against
a collection. Protect these calls with exception handling.",area-CodeGen,dotnet-bot,13/04/2018 6:57,14/04/2018 7:02
17530,Adding GetChunks which allow efficient scanning of a StringBuilder,"This change is the start of addressing the issue  CoreFX issue 

https://github.com/dotnet/corefx/issues/21248

which wants to have an efficient way of reading the characters of a StringBuilder.      However it has morphed alot since then (from a callback to an iterator model).   The API review part of this is the following issue. 

https://github.com/dotnet/corefx/issues/29770

This PR is an implementation of that spec.  In particular we implement the following new method on StringBuilder. 

The PR contains the actual implementation.    Note that ChunkEnumerable does not actually implement IEnumerable<ReadOnlyMemory<char>>.  

We considered having it return ReadOnlySpan but decided that it was too fragile in that Span can't be used across 'await' calls and can't be passed to methods that MAY be async.   ReadOnlyMemory does not have this problem (but is a bit less efficient) but does require you to convert it to a Span before accessing the characters (and notice you need to cache the span in a local variable to keep span creation out of the inner loop).    

This is not ideal but is this issue will resurface other places (whenever we want to return chunks) and so it is likely we will invest in JIT optimization to optimize away any inefficiency of using ReadOnlyMemory and converting immediately to Span (which is what would happen in the synchronous case).  
 
At this point it is ready for API review.    This amounts to signing off on using ReadOnlyMemory instead of ReadOnlySpan and the names (is 'Chunks' the right suffix?) and the fact that ChunkEnumerable does not actually implement IEnumerable<ReadOnlyMemory<char>> (It could it is just more code (which we can add later)).  

I have tests however there seems to be a chicken and egg problem in that you need to have an implementation before CoreFX can expose it (and have tests for it).    I have tested the code (all code paths are covered) but I will need to check in tests as a separate PR.  ","Adding GetChunks which allow efficient scanning of a StringBuilder This change is the start of addressing the issue  CoreFX issue 

https://github.com/dotnet/corefx/issues/21248

which wants to have an efficient way of reading the characters of a StringBuilder.      However it has morphed alot since then (from a callback to an iterator model).   The API review part of this is the following issue. 

https://github.com/dotnet/corefx/issues/29770

This PR is an implementation of that spec.  In particular we implement the following new method on StringBuilder. 

The PR contains the actual implementation.    Note that ChunkEnumerable does not actually implement IEnumerable<ReadOnlyMemory<char>>.  

We considered having it return ReadOnlySpan but decided that it was too fragile in that Span can't be used across 'await' calls and can't be passed to methods that MAY be async.   ReadOnlyMemory does not have this problem (but is a bit less efficient) but does require you to convert it to a Span before accessing the characters (and notice you need to cache the span in a local variable to keep span creation out of the inner loop).    

This is not ideal but is this issue will resurface other places (whenever we want to return chunks) and so it is likely we will invest in JIT optimization to optimize away any inefficiency of using ReadOnlyMemory and converting immediately to Span (which is what would happen in the synchronous case).  
 
At this point it is ready for API review.    This amounts to signing off on using ReadOnlyMemory instead of ReadOnlySpan and the names (is 'Chunks' the right suffix?) and the fact that ChunkEnumerable does not actually implement IEnumerable<ReadOnlyMemory<char>> (It could it is just more code (which we can add later)).  

I have tests however there seems to be a chicken and egg problem in that you need to have an implementation before CoreFX can expose it (and have tests for it).    I have tested the code (all code paths are covered) but I will need to check in tests as a separate PR.  ",area-System.Runtime,vancem,13/04/2018 1:00,23/05/2018 9:07
17529,unable to run after upgrading to .net 2.0 => 2.1 [terminating with uncaught exception of type EEFileLoadException*],"# terminating with uncaught exception of type EEFileLoadException*

when in ( visual studio code [mac os x] ) I go debug -->  run
It never runs everything fails with:  terminating with uncaught exception of type EEFileLoadException*

All I have done is upgraded 2.0 -> 2.1   changed launch.json  to the following:

""program"": ""${workspaceFolder}/bin/Debug/netcoreapp2.1/NetSo.dll""

Update nuget

removed DotNetCliToolReference  as they are no longer needed   ( now part of SDK )

Run  dotnet build  ( success )

and then run  

# General

dotnet --version
2.1.300-preview2-008530


I get no other output as this seems to be more of a fail to launch issue than a code issue
especially as no code changes have taken place  and no code exceptions are thrown.   This seems more like that MACOS  wont run the new core framework.

I have attached the output from OSX  for clarity.  Any advice would be much appreciated.

[core-crash.mac.txt](https://github.com/dotnet/coreclr/files/1903405/core-crash.mac.txt)


","unable to run after upgrading to .net 2.0 => 2.1 [terminating with uncaught exception of type EEFileLoadException*] # terminating with uncaught exception of type EEFileLoadException*

when in ( visual studio code [mac os x] ) I go debug -->  run
It never runs everything fails with:  terminating with uncaught exception of type EEFileLoadException*

All I have done is upgraded 2.0 -> 2.1   changed launch.json  to the following:

""program"": ""${workspaceFolder}/bin/Debug/netcoreapp2.1/NetSo.dll""

Update nuget

removed DotNetCliToolReference  as they are no longer needed   ( now part of SDK )

Run  dotnet build  ( success )

and then run  

# General

dotnet --version
2.1.300-preview2-008530


I get no other output as this seems to be more of a fail to launch issue than a code issue
especially as no code changes have taken place  and no code exceptions are thrown.   This seems more like that MACOS  wont run the new core framework.

I have attached the output from OSX  for clarity.  Any advice would be much appreciated.

[core-crash.mac.txt](https://github.com/dotnet/coreclr/files/1903405/core-crash.mac.txt)


",area-ExceptionHandling,janvorli,,
17528,Add Path.TryGetRandomFileName(),"clr part of  https://github.com/dotnet/corefx/issues/28256
test for corefx are [ready](https://github.com/dotnet/corefx/compare/master...MarcoRossignoli:trygetrandomfilename)
cc: @JeremyKuhne @jkotas  @Anipik ","Add Path.TryGetRandomFileName() clr part of  https://github.com/dotnet/corefx/issues/28256
test for corefx are [ready](https://github.com/dotnet/corefx/compare/master...MarcoRossignoli:trygetrandomfilename)
cc: @JeremyKuhne @jkotas  @Anipik ",* NO MERGE *,JeremyKuhne,12/04/2018 21:19,20/06/2018 4:15
17524,Avoid creating illegal byref pointers,"Byref pointers need to point within their ""host"" object -- thus
the alternate name ""interior pointers"". If the JIT creates and
reports a pointer as a ""byref"" but it points outside the host
object and a GC occurs that moves the host object the byref
pointer will not be updated. If a subsequent calculation puts
the byref ""back"" into the host object it will actually be pointing
to garbage since the host object has moved.

This occurred on ARM with array index calculations in particular
because ARM doesn't have a single-instruction ""base + scale*index + offset""
addressing mode. Thus we were generating for the jaggedarr_cs_do
test case . This
optimization creates ""incorrect"" byrefs that don't necessarily point within
the host object.

These fixes are all-platform.

Fixes #17517.

There are many many diffs. They perhaps surprisingly overwhelmingly positive.

For AMD64 SuperPMI the diffs are a 7.6% size win for 5194 functions! This
appears to be due to less code cloning and sometimes better optimization.

For ARM32 ngen-based desktop asm diffs it is a 0.30% improvement across all
framework assemblies. A lot of the diffs seem to be because we CSE the entire
array address offset expression not just the index expression.","Avoid creating illegal byref pointers Byref pointers need to point within their ""host"" object -- thus
the alternate name ""interior pointers"". If the JIT creates and
reports a pointer as a ""byref"" but it points outside the host
object and a GC occurs that moves the host object the byref
pointer will not be updated. If a subsequent calculation puts
the byref ""back"" into the host object it will actually be pointing
to garbage since the host object has moved.

This occurred on ARM with array index calculations in particular
because ARM doesn't have a single-instruction ""base + scale*index + offset""
addressing mode. Thus we were generating for the jaggedarr_cs_do
test case . This
optimization creates ""incorrect"" byrefs that don't necessarily point within
the host object.

These fixes are all-platform.

Fixes #17517.

There are many many diffs. They perhaps surprisingly overwhelmingly positive.

For AMD64 SuperPMI the diffs are a 7.6% size win for 5194 functions! This
appears to be due to less code cloning and sometimes better optimization.

For ARM32 ngen-based desktop asm diffs it is a 0.30% improvement across all
framework assemblies. A lot of the diffs seem to be because we CSE the entire
array address offset expression not just the index expression.",area-CodeGen,dotnet-bot,12/04/2018 13:59,15/04/2018 4:11
17523,Fix random Segfaults on Ubuntu arm,"Fixes #17449 #16963

/cc @sandreenko","Fix random Segfaults on Ubuntu arm Fixes #17449 #16963

/cc @sandreenko",area-PAL,sandreenko,12/04/2018 11:33,14/04/2018 17:24
17522,[WIP] test Egor's arm fix,,[WIP] test Egor's arm fix ,* NO MERGE *,sandreenko,12/04/2018 10:43,17/04/2018 6:12
17521,Preserve VASigCookieReg across PInvokeStubWorker call,"I noticed something risky in this stub. We don't ensure that VASigCookieReg is preserved (if it's a temporary register we don't know what may happen to it in the call to the PInvokeStubWorker). Let's save it in a callee-saved register so that when we come back after stub generation we still have the correct value for the VASigCookie.

@janvorli PTAL","Preserve VASigCookieReg across PInvokeStubWorker call I noticed something risky in this stub. We don't ensure that VASigCookieReg is preserved (if it's a temporary register we don't know what may happen to it in the call to the PInvokeStubWorker). Let's save it in a callee-saved register so that when we come back after stub generation we still have the correct value for the VASigCookie.

@janvorli PTAL",arch-arm64,janvorli,12/04/2018 8:35,13/04/2018 22:25
17519,[RyuJit] Allow TYP_BYREF folding.,"Right now  has such code:
https://github.com/dotnet/coreclr/blob/b800f37c504d30c25bda3bdf148966fa91d17381/src/jit/valuenum.cpp#L1100-L1105

but there are no reasons why we can't support it it looks like we should just change this part:
https://github.com/dotnet/coreclr/blob/b800f37c504d30c25bda3bdf148966fa91d17381/src/jit/valuenum.cpp#L1812

From discussion in #17506 .



category:cq
theme:value-numbering
skill-level:intermediate
cost:small","[RyuJit] Allow TYP_BYREF folding. Right now  has such code:
https://github.com/dotnet/coreclr/blob/b800f37c504d30c25bda3bdf148966fa91d17381/src/jit/valuenum.cpp#L1100-L1105

but there are no reasons why we can't support it it looks like we should just change this part:
https://github.com/dotnet/coreclr/blob/b800f37c504d30c25bda3bdf148966fa91d17381/src/jit/valuenum.cpp#L1812

From discussion in #17506 .



category:cq
theme:value-numbering
skill-level:intermediate
cost:small",area-CodeGen,sandreenko,12/04/2018 6:59,
17517,[RyuJIT/arm32][GCStress=C] jaggedarr_cs_do.cmd failure,"https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_gcstress0xc_tst/18/artifact/bin/tests/Windows_NT.arm.Checked/Smarty.run.0/Smarty.0.fail.smrt/*view*/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_gcstress0xc_jitstress1_tst/16/artifact/bin/tests/Windows_NT.arm.Checked/Smarty.run.0/Smarty.0.fail.smrt/*view*/

This failure is fairly consistent. I can reproduce it locally most of the time. Note that the test is seeded with a random number which doesn't help reproducibility.
","[RyuJIT/arm32][GCStress=C] jaggedarr_cs_do.cmd failure https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_gcstress0xc_tst/18/artifact/bin/tests/Windows_NT.arm.Checked/Smarty.run.0/Smarty.0.fail.smrt/*view*/
https://ci.dot.net/job/dotnet_coreclr/job/master/job/jitstress/job/arm_cross_checked_windows_nt_gcstress0xc_jitstress1_tst/16/artifact/bin/tests/Windows_NT.arm.Checked/Smarty.run.0/Smarty.0.fail.smrt/*view*/

This failure is fairly consistent. I can reproduce it locally most of the time. Note that the test is seeded with a random number which doesn't help reproducibility.
",arch-arm32,BruceForstall,,
17516,[1.1] Add packaging for Fedora28 and Debian9,cc: @weshaggard @janvorli ,[1.1] Add packaging for Fedora28 and Debian9 cc: @weshaggard @janvorli ,,ianhays,,
17515,Mirror changes from dotnet/corert,"This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**","Mirror changes from dotnet/corert This PR contains mirrored changes from dotnet/corert


**Please REBASE this PR when merging**",,jkotas,,
17513,[X86] Fix cross toolchain library paths,"	- fix internal tests building

@dotnet/arm32-contrib please review","[X86] Fix cross toolchain library paths 	- fix internal tests building

@dotnet/arm32-contrib please review",area-Infrastructure-coreclr,sergign60,11/04/2018 23:11,17/04/2018 11:14
17512,Use string.IsNullOrEmpty to eliminate bounds check to first char,,Use string.IsNullOrEmpty to eliminate bounds check to first char ,area-System.Runtime,AndyAyersMS,11/04/2018 21:35,13/04/2018 7:08
17510,Korean Lunisolar Calendar conversion table incorrectly mixes Julian and Gregorian date information,"The [Korean Lunisolar Calendar](https://github.com/dotnet/coreclr/blob/da8b7181dbe362fbfe64c7ef72ff3a4a7db68f24/src/mscorlib/shared/System/Globalization/KoreanLunisolarCalendar.cs) uses a table of data for conversion between Korean lunisolar dates and Gregorian dates.  The table contains a mixture of Julian and Gregorian date information but should only contain Gregorian date information.

On such entry is:


This is interpreted by the code as:
Y1391-M1-D1 of Korean lunisolar calendar began on 5 Feb 1391 (Gregorian).

However Y1391-M1-D1 (lunisolar) began on 13 Feb 1391 (**Gregorian**) or 05 Feb 1391 (Julian).  The entry incorrectly uses the day and month from the Julian date and it should use day and month from the Gregorian one.

Further analysis shows that all lines in the table prior to 1582 incorrectly give the first day of the lunisolar year in the **Julian** calendar _rather than the Gregorian calendar_.  Since the conversion routine takes a Gregorian day month and year for conversion into the lunisolar day month and year any conversions to dates with a solar year before 1583 are incorrect.

The discrepancy likely arises due to the fact that many reference tables switch from using the Julian calendar to the Gregorian calendar in year 1582 (04 Oct 1582 (Julian) was followed by 15 Oct 1582 (Gregorian)).  One such table is provided by the [Korea Astronomy and Space Science In-
stitute (KASI)](https://astro.kasi.re.kr:444/life/pageView/5).  Here dates prior to Y1582-M09-D18 (lunisolar) are indexed using the Julian calendar and those after Y1582-M09-D19 (lunisolar) are indexed using the Gregorian calendar.

There are also anomalous entries in the .NET table when compared to KASI.
The first day of the year is incorrect for 1587 1648 and 1754.  Most notably the entry for 1587 gives 09 Mar 1587 (Gregorian) as the start date of lunisolar year (this is the first day Y1587-M02-D01 (lunisolar) instead of Y1587-M01-D01 (lunisolar)).  The individual month lengths differ from KASI in 1586 1587 1659 1692 1753 and 1754.

The table used in the .NET class has been corrected here:
[correct Korean lunisolar .NET table.txt](https://github.com/dotnet/coreclr/files/1898816/correct.Korean.lunisolar.NET.table.txt)

Reference data: 
[Korea Astronomy and Space Science In-
stitute (KASI)](https://astro.kasi.re.kr:444/life/pageView/5).
[VERIFICATION OF THE CALENDAR DAYS OF THE JOSEON DYNASTY](http://dx.doi.org/10.5303/JKAS.2012.45.4.85)
[KoreanLunisolarCalendar.cs](https://github.com/dotnet/coreclr/blob/da8b7181dbe362fbfe64c7ef72ff3a4a7db68f24/src/mscorlib/shared/System/Globalization/KoreanLunisolarCalendar.cs)","Korean Lunisolar Calendar conversion table incorrectly mixes Julian and Gregorian date information The [Korean Lunisolar Calendar](https://github.com/dotnet/coreclr/blob/da8b7181dbe362fbfe64c7ef72ff3a4a7db68f24/src/mscorlib/shared/System/Globalization/KoreanLunisolarCalendar.cs) uses a table of data for conversion between Korean lunisolar dates and Gregorian dates.  The table contains a mixture of Julian and Gregorian date information but should only contain Gregorian date information.

On such entry is:


This is interpreted by the code as:
Y1391-M1-D1 of Korean lunisolar calendar began on 5 Feb 1391 (Gregorian).

However Y1391-M1-D1 (lunisolar) began on 13 Feb 1391 (**Gregorian**) or 05 Feb 1391 (Julian).  The entry incorrectly uses the day and month from the Julian date and it should use day and month from the Gregorian one.

Further analysis shows that all lines in the table prior to 1582 incorrectly give the first day of the lunisolar year in the **Julian** calendar _rather than the Gregorian calendar_.  Since the conversion routine takes a Gregorian day month and year for conversion into the lunisolar day month and year any conversions to dates with a solar year before 1583 are incorrect.

The discrepancy likely arises due to the fact that many reference tables switch from using the Julian calendar to the Gregorian calendar in year 1582 (04 Oct 1582 (Julian) was followed by 15 Oct 1582 (Gregorian)).  One such table is provided by the [Korea Astronomy and Space Science In-
stitute (KASI)](https://astro.kasi.re.kr:444/life/pageView/5).  Here dates prior to Y1582-M09-D18 (lunisolar) are indexed using the Julian calendar and those after Y1582-M09-D19 (lunisolar) are indexed using the Gregorian calendar.

There are also anomalous entries in the .NET table when compared to KASI.
The first day of the year is incorrect for 1587 1648 and 1754.  Most notably the entry for 1587 gives 09 Mar 1587 (Gregorian) as the start date of lunisolar year (this is the first day Y1587-M02-D01 (lunisolar) instead of Y1587-M01-D01 (lunisolar)).  The individual month lengths differ from KASI in 1586 1587 1659 1692 1753 and 1754.

The table used in the .NET class has been corrected here:
[correct Korean lunisolar .NET table.txt](https://github.com/dotnet/coreclr/files/1898816/correct.Korean.lunisolar.NET.table.txt)

Reference data: 
[Korea Astronomy and Space Science In-
stitute (KASI)](https://astro.kasi.re.kr:444/life/pageView/5).
[VERIFICATION OF THE CALENDAR DAYS OF THE JOSEON DYNASTY](http://dx.doi.org/10.5303/JKAS.2012.45.4.85)
[KoreanLunisolarCalendar.cs](https://github.com/dotnet/coreclr/blob/da8b7181dbe362fbfe64c7ef72ff3a4a7db68f24/src/mscorlib/shared/System/Globalization/KoreanLunisolarCalendar.cs)",area-System.Globalization,tarekgh,11/04/2018 20:05,17/04/2018 4:06
17508,[Arm64] Fix WorkStealingQueue memory ordering,"Fixes #17178

Audited and reworked WorkStealingQueue to take into account multi-threaded memory ordering issues encountered on high core count arm64 testing.

This fixes easily reproducible errors in  if this is deemed too risky for other platforms.  (I suspect arm32 needs a similar/identical patch).

@BruceForstall FYI","[Arm64] Fix WorkStealingQueue memory ordering Fixes #17178

Audited and reworked WorkStealingQueue to take into account multi-threaded memory ordering issues encountered on high core count arm64 testing.

This fixes easily reproducible errors in  if this is deemed too risky for other platforms.  (I suspect arm32 needs a similar/identical patch).

@BruceForstall FYI",* NO MERGE *,dotnet-bot,11/04/2018 13:11,16/04/2018 9:28
17506,Fix Valuenum:EvalFuncForConstantArgs,"For such tree:


The original code was added in CS 946058 with other assert fixes and looks like we were lucky not to hit this issue for several years because CoreCLR doesn't produce constants with 'TYP_BYREF' (I think).

> // We don't want to fold expressions that produce TYP_BYREF 

I do not see any reasons why we should not fold them but right now this code:
https://github.com/dotnet/coreclr/blob/master/src/jit/valuenum.cpp#L1813-L1817

doesn't not expect LONG add that produces BYREF and because our VN is very fragile we do not want to change it before the release **do we want to have an issue to fix that later?**

The change will fix (some text to prevent closing this issue right after the merge) dotnet/corert#5661 after RyuJit version update.
","Fix Valuenum:EvalFuncForConstantArgs For such tree:


The original code was added in CS 946058 with other assert fixes and looks like we were lucky not to hit this issue for several years because CoreCLR doesn't produce constants with 'TYP_BYREF' (I think).

> // We don't want to fold expressions that produce TYP_BYREF 

I do not see any reasons why we should not fold them but right now this code:
https://github.com/dotnet/coreclr/blob/master/src/jit/valuenum.cpp#L1813-L1817

doesn't not expect LONG add that produces BYREF and because our VN is very fragile we do not want to change it before the release **do we want to have an issue to fix that later?**

The change will fix (some text to prevent closing this issue right after the merge) dotnet/corert#5661 after RyuJit version update.
",area-CodeGen,sandreenko,11/04/2018 9:34,12/04/2018 6:16
17505,Enable support DllImport a native assembly whose name contains '.',"Currently In Windows if the name your native dll specified in DllImport contains '.' such as Test.Foo DllImport will only search for file Test.Foo and it won't search for file Test.Foo.dll

The fix is to append "".dll"" if the native dll name specified in DllImport doesn't contain "".dll"" .

Fix #17150","Enable support DllImport a native assembly whose name contains '.' Currently In Windows if the name your native dll specified in DllImport contains '.' such as Test.Foo DllImport will only search for file Test.Foo and it won't search for file Test.Foo.dll

The fix is to append "".dll"" if the native dll name specified in DllImport doesn't contain "".dll"" .

Fix #17150",area-Interop,dotnet-bot,11/04/2018 9:33,17/04/2018 15:10
